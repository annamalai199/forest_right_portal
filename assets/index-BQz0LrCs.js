var jhe=Object.defineProperty;var xz=e=>{throw TypeError(e)};var Rhe=(e,t,r)=>t in e?jhe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var _t=(e,t,r)=>Rhe(e,typeof t!="symbol"?t+"":t,r),Kk=(e,t,r)=>t.has(e)||xz("Cannot "+r);var Br=(e,t,r)=>(Kk(e,t,"read from private field"),r?r.call(e):t.get(e)),oa=(e,t,r)=>t.has(e)?xz("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),to=(e,t,r,n)=>(Kk(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),mu=(e,t,r)=>(Kk(e,t,"access private method"),r);var HT=(e,t,r,n)=>({set _(i){to(e,t,i,r)},get _(){return Br(e,t,n)}});function Fhe(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const o=Object.getOwnPropertyDescriptor(n,i);o&&Object.defineProperty(e,i,o.get?o:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();var Fv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function sa(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var lZ={exports:{}},YC={},cZ={exports:{}},No={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iS=Symbol.for("react.element"),zhe=Symbol.for("react.portal"),Bhe=Symbol.for("react.fragment"),Uhe=Symbol.for("react.strict_mode"),Vhe=Symbol.for("react.profiler"),Whe=Symbol.for("react.provider"),Ghe=Symbol.for("react.context"),qhe=Symbol.for("react.forward_ref"),Hhe=Symbol.for("react.suspense"),Khe=Symbol.for("react.memo"),Zhe=Symbol.for("react.lazy"),wz=Symbol.iterator;function Xhe(e){return e===null||typeof e!="object"?null:(e=wz&&e[wz]||e["@@iterator"],typeof e=="function"?e:null)}var uZ={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},dZ=Object.assign,hZ={};function Ab(e,t,r){this.props=e,this.context=t,this.refs=hZ,this.updater=r||uZ}Ab.prototype.isReactComponent={};Ab.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ab.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function fZ(){}fZ.prototype=Ab.prototype;function e4(e,t,r){this.props=e,this.context=t,this.refs=hZ,this.updater=r||uZ}var t4=e4.prototype=new fZ;t4.constructor=e4;dZ(t4,Ab.prototype);t4.isPureReactComponent=!0;var Mz=Array.isArray,pZ=Object.prototype.hasOwnProperty,r4={current:null},mZ={key:!0,ref:!0,__self:!0,__source:!0};function gZ(e,t,r){var n,i={},o=null,s=null;if(t!=null)for(n in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(o=""+t.key),t)pZ.call(t,n)&&!mZ.hasOwnProperty(n)&&(i[n]=t[n]);var a=arguments.length-2;if(a===1)i.children=r;else if(1<a){for(var u=Array(a),d=0;d<a;d++)u[d]=arguments[d+2];i.children=u}if(e&&e.defaultProps)for(n in a=e.defaultProps,a)i[n]===void 0&&(i[n]=a[n]);return{$$typeof:iS,type:e,key:o,ref:s,props:i,_owner:r4.current}}function Yhe(e,t){return{$$typeof:iS,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function n4(e){return typeof e=="object"&&e!==null&&e.$$typeof===iS}function Qhe(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Sz=/\/+/g;function Zk(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Qhe(""+e.key):t.toString(36)}function lE(e,t,r,n,i){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case iS:case zhe:s=!0}}if(s)return s=e,i=i(s),e=n===""?"."+Zk(s,0):n,Mz(i)?(r="",e!=null&&(r=e.replace(Sz,"$&/")+"/"),lE(i,t,r,"",function(d){return d})):i!=null&&(n4(i)&&(i=Yhe(i,r+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(Sz,"$&/")+"/")+e)),t.push(i)),1;if(s=0,n=n===""?".":n+":",Mz(e))for(var a=0;a<e.length;a++){o=e[a];var u=n+Zk(o,a);s+=lE(o,t,r,u,i)}else if(u=Xhe(e),typeof u=="function")for(e=u.call(e),a=0;!(o=e.next()).done;)o=o.value,u=n+Zk(o,a++),s+=lE(o,t,r,u,i);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function KT(e,t,r){if(e==null)return e;var n=[],i=0;return lE(e,n,"","",function(o){return t.call(r,o,i++)}),n}function Jhe(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ku={current:null},cE={transition:null},efe={ReactCurrentDispatcher:Ku,ReactCurrentBatchConfig:cE,ReactCurrentOwner:r4};function _Z(){throw Error("act(...) is not supported in production builds of React.")}No.Children={map:KT,forEach:function(e,t,r){KT(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return KT(e,function(){t++}),t},toArray:function(e){return KT(e,function(t){return t})||[]},only:function(e){if(!n4(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};No.Component=Ab;No.Fragment=Bhe;No.Profiler=Vhe;No.PureComponent=e4;No.StrictMode=Uhe;No.Suspense=Hhe;No.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=efe;No.act=_Z;No.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=dZ({},e.props),i=e.key,o=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,s=r4.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(u in t)pZ.call(t,u)&&!mZ.hasOwnProperty(u)&&(n[u]=t[u]===void 0&&a!==void 0?a[u]:t[u])}var u=arguments.length-2;if(u===1)n.children=r;else if(1<u){a=Array(u);for(var d=0;d<u;d++)a[d]=arguments[d+2];n.children=a}return{$$typeof:iS,type:e.type,key:i,ref:o,props:n,_owner:s}};No.createContext=function(e){return e={$$typeof:Ghe,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Whe,_context:e},e.Consumer=e};No.createElement=gZ;No.createFactory=function(e){var t=gZ.bind(null,e);return t.type=e,t};No.createRef=function(){return{current:null}};No.forwardRef=function(e){return{$$typeof:qhe,render:e}};No.isValidElement=n4;No.lazy=function(e){return{$$typeof:Zhe,_payload:{_status:-1,_result:e},_init:Jhe}};No.memo=function(e,t){return{$$typeof:Khe,type:e,compare:t===void 0?null:t}};No.startTransition=function(e){var t=cE.transition;cE.transition={};try{e()}finally{cE.transition=t}};No.unstable_act=_Z;No.useCallback=function(e,t){return Ku.current.useCallback(e,t)};No.useContext=function(e){return Ku.current.useContext(e)};No.useDebugValue=function(){};No.useDeferredValue=function(e){return Ku.current.useDeferredValue(e)};No.useEffect=function(e,t){return Ku.current.useEffect(e,t)};No.useId=function(){return Ku.current.useId()};No.useImperativeHandle=function(e,t,r){return Ku.current.useImperativeHandle(e,t,r)};No.useInsertionEffect=function(e,t){return Ku.current.useInsertionEffect(e,t)};No.useLayoutEffect=function(e,t){return Ku.current.useLayoutEffect(e,t)};No.useMemo=function(e,t){return Ku.current.useMemo(e,t)};No.useReducer=function(e,t,r){return Ku.current.useReducer(e,t,r)};No.useRef=function(e){return Ku.current.useRef(e)};No.useState=function(e){return Ku.current.useState(e)};No.useSyncExternalStore=function(e,t,r){return Ku.current.useSyncExternalStore(e,t,r)};No.useTransition=function(){return Ku.current.useTransition()};No.version="18.3.1";cZ.exports=No;var oe=cZ.exports;const ct=sa(oe),i4=Fhe({__proto__:null,default:ct},[oe]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tfe=oe,rfe=Symbol.for("react.element"),nfe=Symbol.for("react.fragment"),ife=Object.prototype.hasOwnProperty,ofe=tfe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,afe={key:!0,ref:!0,__self:!0,__source:!0};function yZ(e,t,r){var n,i={},o=null,s=null;r!==void 0&&(o=""+r),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(s=t.ref);for(n in t)ife.call(t,n)&&!afe.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:rfe,type:e,key:o,ref:s,props:i,_owner:ofe.current}}YC.Fragment=nfe;YC.jsx=yZ;YC.jsxs=yZ;lZ.exports=YC;var F=lZ.exports,vZ={exports:{}},nh={},bZ={exports:{}},xZ={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ue,fe){var De=ue.length;ue.push(fe);e:for(;0<De;){var pe=De-1>>>1,K=ue[pe];if(0<i(K,fe))ue[pe]=fe,ue[De]=K,De=pe;else break e}}function r(ue){return ue.length===0?null:ue[0]}function n(ue){if(ue.length===0)return null;var fe=ue[0],De=ue.pop();if(De!==fe){ue[0]=De;e:for(var pe=0,K=ue.length,te=K>>>1;pe<te;){var ve=2*(pe+1)-1,$e=ue[ve],Ce=ve+1,Ge=ue[Ce];if(0>i($e,De))Ce<K&&0>i(Ge,$e)?(ue[pe]=Ge,ue[Ce]=De,pe=Ce):(ue[pe]=$e,ue[ve]=De,pe=ve);else if(Ce<K&&0>i(Ge,De))ue[pe]=Ge,ue[Ce]=De,pe=Ce;else break e}}return fe}function i(ue,fe){var De=ue.sortIndex-fe.sortIndex;return De!==0?De:ue.id-fe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();e.unstable_now=function(){return s.now()-a}}var u=[],d=[],m=1,g=null,_=3,y=!1,M=!1,x=!1,E=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(ue){for(var fe=r(d);fe!==null;){if(fe.callback===null)n(d);else if(fe.startTime<=ue)n(d),fe.sortIndex=fe.expirationTime,t(u,fe);else break;fe=r(d)}}function D(ue){if(x=!1,C(ue),!M)if(r(u)!==null)M=!0,ye(L);else{var fe=r(d);fe!==null&&_e(D,fe.startTime-ue)}}function L(ue,fe){M=!1,x&&(x=!1,T($),$=-1),y=!0;var De=_;try{for(C(fe),g=r(u);g!==null&&(!(g.expirationTime>fe)||ue&&!H());){var pe=g.callback;if(typeof pe=="function"){g.callback=null,_=g.priorityLevel;var K=pe(g.expirationTime<=fe);fe=e.unstable_now(),typeof K=="function"?g.callback=K:g===r(u)&&n(u),C(fe)}else n(u);g=r(u)}if(g!==null)var te=!0;else{var ve=r(d);ve!==null&&_e(D,ve.startTime-fe),te=!1}return te}finally{g=null,_=De,y=!1}}var N=!1,j=null,$=-1,U=5,G=-1;function H(){return!(e.unstable_now()-G<U)}function X(){if(j!==null){var ue=e.unstable_now();G=ue;var fe=!0;try{fe=j(!0,ue)}finally{fe?ee():(N=!1,j=null)}}else N=!1}var ee;if(typeof P=="function")ee=function(){P(X)};else if(typeof MessageChannel<"u"){var ae=new MessageChannel,de=ae.port2;ae.port1.onmessage=X,ee=function(){de.postMessage(null)}}else ee=function(){E(X,0)};function ye(ue){j=ue,N||(N=!0,ee())}function _e(ue,fe){$=E(function(){ue(e.unstable_now())},fe)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ue){ue.callback=null},e.unstable_continueExecution=function(){M||y||(M=!0,ye(L))},e.unstable_forceFrameRate=function(ue){0>ue||125<ue?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):U=0<ue?Math.floor(1e3/ue):5},e.unstable_getCurrentPriorityLevel=function(){return _},e.unstable_getFirstCallbackNode=function(){return r(u)},e.unstable_next=function(ue){switch(_){case 1:case 2:case 3:var fe=3;break;default:fe=_}var De=_;_=fe;try{return ue()}finally{_=De}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ue,fe){switch(ue){case 1:case 2:case 3:case 4:case 5:break;default:ue=3}var De=_;_=ue;try{return fe()}finally{_=De}},e.unstable_scheduleCallback=function(ue,fe,De){var pe=e.unstable_now();switch(typeof De=="object"&&De!==null?(De=De.delay,De=typeof De=="number"&&0<De?pe+De:pe):De=pe,ue){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=De+K,ue={id:m++,callback:fe,priorityLevel:ue,startTime:De,expirationTime:K,sortIndex:-1},De>pe?(ue.sortIndex=De,t(d,ue),r(u)===null&&ue===r(d)&&(x?(T($),$=-1):x=!0,_e(D,De-pe))):(ue.sortIndex=K,t(u,ue),M||y||(M=!0,ye(L))),ue},e.unstable_shouldYield=H,e.unstable_wrapCallback=function(ue){var fe=_;return function(){var De=_;_=fe;try{return ue.apply(this,arguments)}finally{_=De}}}})(xZ);bZ.exports=xZ;var sfe=bZ.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lfe=oe,rh=sfe;function fn(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var wZ=new Set,A2={};function E0(e,t){F1(e,t),F1(e+"Capture",t)}function F1(e,t){for(A2[e]=t,e=0;e<t.length;e++)wZ.add(t[e])}var zm=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),rL=Object.prototype.hasOwnProperty,cfe=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Tz={},Pz={};function ufe(e){return rL.call(Pz,e)?!0:rL.call(Tz,e)?!1:cfe.test(e)?Pz[e]=!0:(Tz[e]=!0,!1)}function dfe(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function hfe(e,t,r,n){if(t===null||typeof t>"u"||dfe(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Zu(e,t,r,n,i,o,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var au={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){au[e]=new Zu(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];au[t]=new Zu(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){au[e]=new Zu(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){au[e]=new Zu(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){au[e]=new Zu(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){au[e]=new Zu(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){au[e]=new Zu(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){au[e]=new Zu(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){au[e]=new Zu(e,5,!1,e.toLowerCase(),null,!1,!1)});var o4=/[\-:]([a-z])/g;function a4(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(o4,a4);au[t]=new Zu(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(o4,a4);au[t]=new Zu(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(o4,a4);au[t]=new Zu(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){au[e]=new Zu(e,1,!1,e.toLowerCase(),null,!1,!1)});au.xlinkHref=new Zu("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){au[e]=new Zu(e,1,!1,e.toLowerCase(),null,!0,!0)});function s4(e,t,r,n){var i=au.hasOwnProperty(t)?au[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(hfe(t,r,i,n)&&(r=null),n||i===null?ufe(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Jm=lfe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ZT=Symbol.for("react.element"),zv=Symbol.for("react.portal"),Bv=Symbol.for("react.fragment"),l4=Symbol.for("react.strict_mode"),nL=Symbol.for("react.profiler"),MZ=Symbol.for("react.provider"),SZ=Symbol.for("react.context"),c4=Symbol.for("react.forward_ref"),iL=Symbol.for("react.suspense"),oL=Symbol.for("react.suspense_list"),u4=Symbol.for("react.memo"),zg=Symbol.for("react.lazy"),TZ=Symbol.for("react.offscreen"),Ez=Symbol.iterator;function aw(e){return e===null||typeof e!="object"?null:(e=Ez&&e[Ez]||e["@@iterator"],typeof e=="function"?e:null)}var Ks=Object.assign,Xk;function Bw(e){if(Xk===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Xk=t&&t[1]||""}return`
`+Xk+e}var Yk=!1;function Qk(e,t){if(!e||Yk)return"";Yk=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var n=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){n=d}e.call(t.prototype)}else{try{throw Error()}catch(d){n=d}e()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),o=n.stack.split(`
`),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(s!==1||a!==1)do if(s--,a--,0>a||i[s]!==o[a]){var u=`
`+i[s].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=s&&0<=a);break}}}finally{Yk=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Bw(e):""}function ffe(e){switch(e.tag){case 5:return Bw(e.type);case 16:return Bw("Lazy");case 13:return Bw("Suspense");case 19:return Bw("SuspenseList");case 0:case 2:case 15:return e=Qk(e.type,!1),e;case 11:return e=Qk(e.type.render,!1),e;case 1:return e=Qk(e.type,!0),e;default:return""}}function aL(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Bv:return"Fragment";case zv:return"Portal";case nL:return"Profiler";case l4:return"StrictMode";case iL:return"Suspense";case oL:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case SZ:return(e.displayName||"Context")+".Consumer";case MZ:return(e._context.displayName||"Context")+".Provider";case c4:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case u4:return t=e.displayName||null,t!==null?t:aL(e.type)||"Memo";case zg:t=e._payload,e=e._init;try{return aL(e(t))}catch{}}return null}function pfe(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return aL(t);case 8:return t===l4?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function b_(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function PZ(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function mfe(e){var t=PZ(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,o=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(s){n=""+s,o.call(this,s)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function XT(e){e._valueTracker||(e._valueTracker=mfe(e))}function EZ(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=PZ(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function VE(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function sL(e,t){var r=t.checked;return Ks({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Az(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=b_(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function AZ(e,t){t=t.checked,t!=null&&s4(e,"checked",t,!1)}function lL(e,t){AZ(e,t);var r=b_(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?cL(e,t.type,r):t.hasOwnProperty("defaultValue")&&cL(e,t.type,b_(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Cz(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function cL(e,t,r){(t!=="number"||VE(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Uw=Array.isArray;function d1(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+b_(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function uL(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(fn(91));return Ks({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function kz(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(fn(92));if(Uw(r)){if(1<r.length)throw Error(fn(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:b_(r)}}function CZ(e,t){var r=b_(t.value),n=b_(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Iz(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function kZ(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function dL(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?kZ(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var YT,IZ=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(YT=YT||document.createElement("div"),YT.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=YT.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function C2(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var t2={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},gfe=["Webkit","ms","Moz","O"];Object.keys(t2).forEach(function(e){gfe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),t2[t]=t2[e]})});function OZ(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||t2.hasOwnProperty(e)&&t2[e]?(""+t).trim():t+"px"}function LZ(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=OZ(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var _fe=Ks({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function hL(e,t){if(t){if(_fe[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(fn(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(fn(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(fn(61))}if(t.style!=null&&typeof t.style!="object")throw Error(fn(62))}}function fL(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var pL=null;function d4(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var mL=null,h1=null,f1=null;function Oz(e){if(e=sS(e)){if(typeof mL!="function")throw Error(fn(280));var t=e.stateNode;t&&(t=r5(t),mL(e.stateNode,e.type,t))}}function DZ(e){h1?f1?f1.push(e):f1=[e]:h1=e}function $Z(){if(h1){var e=h1,t=f1;if(f1=h1=null,Oz(e),t)for(e=0;e<t.length;e++)Oz(t[e])}}function NZ(e,t){return e(t)}function jZ(){}var Jk=!1;function RZ(e,t,r){if(Jk)return e(t,r);Jk=!0;try{return NZ(e,t,r)}finally{Jk=!1,(h1!==null||f1!==null)&&(jZ(),$Z())}}function k2(e,t){var r=e.stateNode;if(r===null)return null;var n=r5(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(fn(231,t,typeof r));return r}var gL=!1;if(zm)try{var sw={};Object.defineProperty(sw,"passive",{get:function(){gL=!0}}),window.addEventListener("test",sw,sw),window.removeEventListener("test",sw,sw)}catch{gL=!1}function yfe(e,t,r,n,i,o,s,a,u){var d=Array.prototype.slice.call(arguments,3);try{t.apply(r,d)}catch(m){this.onError(m)}}var r2=!1,WE=null,GE=!1,_L=null,vfe={onError:function(e){r2=!0,WE=e}};function bfe(e,t,r,n,i,o,s,a,u){r2=!1,WE=null,yfe.apply(vfe,arguments)}function xfe(e,t,r,n,i,o,s,a,u){if(bfe.apply(this,arguments),r2){if(r2){var d=WE;r2=!1,WE=null}else throw Error(fn(198));GE||(GE=!0,_L=d)}}function A0(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function FZ(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Lz(e){if(A0(e)!==e)throw Error(fn(188))}function wfe(e){var t=e.alternate;if(!t){if(t=A0(e),t===null)throw Error(fn(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var o=i.alternate;if(o===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===r)return Lz(i),e;if(o===n)return Lz(i),t;o=o.sibling}throw Error(fn(188))}if(r.return!==n.return)r=i,n=o;else{for(var s=!1,a=i.child;a;){if(a===r){s=!0,r=i,n=o;break}if(a===n){s=!0,n=i,r=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===r){s=!0,r=o,n=i;break}if(a===n){s=!0,n=o,r=i;break}a=a.sibling}if(!s)throw Error(fn(189))}}if(r.alternate!==n)throw Error(fn(190))}if(r.tag!==3)throw Error(fn(188));return r.stateNode.current===r?e:t}function zZ(e){return e=wfe(e),e!==null?BZ(e):null}function BZ(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=BZ(e);if(t!==null)return t;e=e.sibling}return null}var UZ=rh.unstable_scheduleCallback,Dz=rh.unstable_cancelCallback,Mfe=rh.unstable_shouldYield,Sfe=rh.unstable_requestPaint,Al=rh.unstable_now,Tfe=rh.unstable_getCurrentPriorityLevel,h4=rh.unstable_ImmediatePriority,VZ=rh.unstable_UserBlockingPriority,qE=rh.unstable_NormalPriority,Pfe=rh.unstable_LowPriority,WZ=rh.unstable_IdlePriority,QC=null,$p=null;function Efe(e){if($p&&typeof $p.onCommitFiberRoot=="function")try{$p.onCommitFiberRoot(QC,e,void 0,(e.current.flags&128)===128)}catch{}}var $f=Math.clz32?Math.clz32:kfe,Afe=Math.log,Cfe=Math.LN2;function kfe(e){return e>>>=0,e===0?32:31-(Afe(e)/Cfe|0)|0}var QT=64,JT=4194304;function Vw(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function HE(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,o=e.pingedLanes,s=r&268435455;if(s!==0){var a=s&~i;a!==0?n=Vw(a):(o&=s,o!==0&&(n=Vw(o)))}else s=r&~i,s!==0?n=Vw(s):o!==0&&(n=Vw(o));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,o=t&-t,i>=o||i===16&&(o&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-$f(t),i=1<<r,n|=e[r],t&=~i;return n}function Ife(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ofe(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var s=31-$f(o),a=1<<s,u=i[s];u===-1?(!(a&r)||a&n)&&(i[s]=Ife(a,t)):u<=t&&(e.expiredLanes|=a),o&=~a}}function yL(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function GZ(){var e=QT;return QT<<=1,!(QT&4194240)&&(QT=64),e}function eI(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function oS(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-$f(t),e[t]=r}function Lfe(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-$f(r),o=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~o}}function f4(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-$f(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var Sa=0;function qZ(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var HZ,p4,KZ,ZZ,XZ,vL=!1,eP=[],a_=null,s_=null,l_=null,I2=new Map,O2=new Map,Vg=[],Dfe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function $z(e,t){switch(e){case"focusin":case"focusout":a_=null;break;case"dragenter":case"dragleave":s_=null;break;case"mouseover":case"mouseout":l_=null;break;case"pointerover":case"pointerout":I2.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":O2.delete(t.pointerId)}}function lw(e,t,r,n,i,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:o,targetContainers:[i]},t!==null&&(t=sS(t),t!==null&&p4(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function $fe(e,t,r,n,i){switch(t){case"focusin":return a_=lw(a_,e,t,r,n,i),!0;case"dragenter":return s_=lw(s_,e,t,r,n,i),!0;case"mouseover":return l_=lw(l_,e,t,r,n,i),!0;case"pointerover":var o=i.pointerId;return I2.set(o,lw(I2.get(o)||null,e,t,r,n,i)),!0;case"gotpointercapture":return o=i.pointerId,O2.set(o,lw(O2.get(o)||null,e,t,r,n,i)),!0}return!1}function YZ(e){var t=Ey(e.target);if(t!==null){var r=A0(t);if(r!==null){if(t=r.tag,t===13){if(t=FZ(r),t!==null){e.blockedOn=t,XZ(e.priority,function(){KZ(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function uE(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=bL(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);pL=n,r.target.dispatchEvent(n),pL=null}else return t=sS(r),t!==null&&p4(t),e.blockedOn=r,!1;t.shift()}return!0}function Nz(e,t,r){uE(e)&&r.delete(t)}function Nfe(){vL=!1,a_!==null&&uE(a_)&&(a_=null),s_!==null&&uE(s_)&&(s_=null),l_!==null&&uE(l_)&&(l_=null),I2.forEach(Nz),O2.forEach(Nz)}function cw(e,t){e.blockedOn===t&&(e.blockedOn=null,vL||(vL=!0,rh.unstable_scheduleCallback(rh.unstable_NormalPriority,Nfe)))}function L2(e){function t(i){return cw(i,e)}if(0<eP.length){cw(eP[0],e);for(var r=1;r<eP.length;r++){var n=eP[r];n.blockedOn===e&&(n.blockedOn=null)}}for(a_!==null&&cw(a_,e),s_!==null&&cw(s_,e),l_!==null&&cw(l_,e),I2.forEach(t),O2.forEach(t),r=0;r<Vg.length;r++)n=Vg[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Vg.length&&(r=Vg[0],r.blockedOn===null);)YZ(r),r.blockedOn===null&&Vg.shift()}var p1=Jm.ReactCurrentBatchConfig,KE=!0;function jfe(e,t,r,n){var i=Sa,o=p1.transition;p1.transition=null;try{Sa=1,m4(e,t,r,n)}finally{Sa=i,p1.transition=o}}function Rfe(e,t,r,n){var i=Sa,o=p1.transition;p1.transition=null;try{Sa=4,m4(e,t,r,n)}finally{Sa=i,p1.transition=o}}function m4(e,t,r,n){if(KE){var i=bL(e,t,r,n);if(i===null)uI(e,t,n,ZE,r),$z(e,n);else if($fe(i,e,t,r,n))n.stopPropagation();else if($z(e,n),t&4&&-1<Dfe.indexOf(e)){for(;i!==null;){var o=sS(i);if(o!==null&&HZ(o),o=bL(e,t,r,n),o===null&&uI(e,t,n,ZE,r),o===i)break;i=o}i!==null&&n.stopPropagation()}else uI(e,t,n,null,r)}}var ZE=null;function bL(e,t,r,n){if(ZE=null,e=d4(n),e=Ey(e),e!==null)if(t=A0(e),t===null)e=null;else if(r=t.tag,r===13){if(e=FZ(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ZE=e,null}function QZ(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Tfe()){case h4:return 1;case VZ:return 4;case qE:case Pfe:return 16;case WZ:return 536870912;default:return 16}default:return 16}}var Jg=null,g4=null,dE=null;function JZ(){if(dE)return dE;var e,t=g4,r=t.length,n,i="value"in Jg?Jg.value:Jg.textContent,o=i.length;for(e=0;e<r&&t[e]===i[e];e++);var s=r-e;for(n=1;n<=s&&t[r-n]===i[o-n];n++);return dE=i.slice(e,1<n?1-n:void 0)}function hE(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function tP(){return!0}function jz(){return!1}function ih(e){function t(r,n,i,o,s){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(r=e[a],this[a]=r?r(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?tP:jz,this.isPropagationStopped=jz,this}return Ks(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=tP)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=tP)},persist:function(){},isPersistent:tP}),t}var Cb={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_4=ih(Cb),aS=Ks({},Cb,{view:0,detail:0}),Ffe=ih(aS),tI,rI,uw,JC=Ks({},aS,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:y4,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==uw&&(uw&&e.type==="mousemove"?(tI=e.screenX-uw.screenX,rI=e.screenY-uw.screenY):rI=tI=0,uw=e),tI)},movementY:function(e){return"movementY"in e?e.movementY:rI}}),Rz=ih(JC),zfe=Ks({},JC,{dataTransfer:0}),Bfe=ih(zfe),Ufe=Ks({},aS,{relatedTarget:0}),nI=ih(Ufe),Vfe=Ks({},Cb,{animationName:0,elapsedTime:0,pseudoElement:0}),Wfe=ih(Vfe),Gfe=Ks({},Cb,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),qfe=ih(Gfe),Hfe=Ks({},Cb,{data:0}),Fz=ih(Hfe),Kfe={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Zfe={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Xfe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Yfe(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Xfe[e])?!!t[e]:!1}function y4(){return Yfe}var Qfe=Ks({},aS,{key:function(e){if(e.key){var t=Kfe[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=hE(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Zfe[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:y4,charCode:function(e){return e.type==="keypress"?hE(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?hE(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Jfe=ih(Qfe),epe=Ks({},JC,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),zz=ih(epe),tpe=Ks({},aS,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:y4}),rpe=ih(tpe),npe=Ks({},Cb,{propertyName:0,elapsedTime:0,pseudoElement:0}),ipe=ih(npe),ope=Ks({},JC,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),ape=ih(ope),spe=[9,13,27,32],v4=zm&&"CompositionEvent"in window,n2=null;zm&&"documentMode"in document&&(n2=document.documentMode);var lpe=zm&&"TextEvent"in window&&!n2,eX=zm&&(!v4||n2&&8<n2&&11>=n2),Bz=" ",Uz=!1;function tX(e,t){switch(e){case"keyup":return spe.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rX(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Uv=!1;function cpe(e,t){switch(e){case"compositionend":return rX(t);case"keypress":return t.which!==32?null:(Uz=!0,Bz);case"textInput":return e=t.data,e===Bz&&Uz?null:e;default:return null}}function upe(e,t){if(Uv)return e==="compositionend"||!v4&&tX(e,t)?(e=JZ(),dE=g4=Jg=null,Uv=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return eX&&t.locale!=="ko"?null:t.data;default:return null}}var dpe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vz(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!dpe[e.type]:t==="textarea"}function nX(e,t,r,n){DZ(n),t=XE(t,"onChange"),0<t.length&&(r=new _4("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var i2=null,D2=null;function hpe(e){pX(e,0)}function e5(e){var t=Gv(e);if(EZ(t))return e}function fpe(e,t){if(e==="change")return t}var iX=!1;if(zm){var iI;if(zm){var oI="oninput"in document;if(!oI){var Wz=document.createElement("div");Wz.setAttribute("oninput","return;"),oI=typeof Wz.oninput=="function"}iI=oI}else iI=!1;iX=iI&&(!document.documentMode||9<document.documentMode)}function Gz(){i2&&(i2.detachEvent("onpropertychange",oX),D2=i2=null)}function oX(e){if(e.propertyName==="value"&&e5(D2)){var t=[];nX(t,D2,e,d4(e)),RZ(hpe,t)}}function ppe(e,t,r){e==="focusin"?(Gz(),i2=t,D2=r,i2.attachEvent("onpropertychange",oX)):e==="focusout"&&Gz()}function mpe(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return e5(D2)}function gpe(e,t){if(e==="click")return e5(t)}function _pe(e,t){if(e==="input"||e==="change")return e5(t)}function ype(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Bf=typeof Object.is=="function"?Object.is:ype;function $2(e,t){if(Bf(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!rL.call(t,i)||!Bf(e[i],t[i]))return!1}return!0}function qz(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Hz(e,t){var r=qz(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=qz(r)}}function aX(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?aX(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function sX(){for(var e=window,t=VE();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=VE(e.document)}return t}function b4(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function vpe(e){var t=sX(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&aX(r.ownerDocument.documentElement,r)){if(n!==null&&b4(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,o=Math.min(n.start,i);n=n.end===void 0?o:Math.min(n.end,i),!e.extend&&o>n&&(i=n,n=o,o=i),i=Hz(r,o);var s=Hz(r,n);i&&s&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),o>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var bpe=zm&&"documentMode"in document&&11>=document.documentMode,Vv=null,xL=null,o2=null,wL=!1;function Kz(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;wL||Vv==null||Vv!==VE(n)||(n=Vv,"selectionStart"in n&&b4(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),o2&&$2(o2,n)||(o2=n,n=XE(xL,"onSelect"),0<n.length&&(t=new _4("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Vv)))}function rP(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Wv={animationend:rP("Animation","AnimationEnd"),animationiteration:rP("Animation","AnimationIteration"),animationstart:rP("Animation","AnimationStart"),transitionend:rP("Transition","TransitionEnd")},aI={},lX={};zm&&(lX=document.createElement("div").style,"AnimationEvent"in window||(delete Wv.animationend.animation,delete Wv.animationiteration.animation,delete Wv.animationstart.animation),"TransitionEvent"in window||delete Wv.transitionend.transition);function t5(e){if(aI[e])return aI[e];if(!Wv[e])return e;var t=Wv[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in lX)return aI[e]=t[r];return e}var cX=t5("animationend"),uX=t5("animationiteration"),dX=t5("animationstart"),hX=t5("transitionend"),fX=new Map,Zz="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function C_(e,t){fX.set(e,t),E0(t,[e])}for(var sI=0;sI<Zz.length;sI++){var lI=Zz[sI],xpe=lI.toLowerCase(),wpe=lI[0].toUpperCase()+lI.slice(1);C_(xpe,"on"+wpe)}C_(cX,"onAnimationEnd");C_(uX,"onAnimationIteration");C_(dX,"onAnimationStart");C_("dblclick","onDoubleClick");C_("focusin","onFocus");C_("focusout","onBlur");C_(hX,"onTransitionEnd");F1("onMouseEnter",["mouseout","mouseover"]);F1("onMouseLeave",["mouseout","mouseover"]);F1("onPointerEnter",["pointerout","pointerover"]);F1("onPointerLeave",["pointerout","pointerover"]);E0("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));E0("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));E0("onBeforeInput",["compositionend","keypress","textInput","paste"]);E0("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));E0("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));E0("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ww="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mpe=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ww));function Xz(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,xfe(n,t,void 0,e),e.currentTarget=null}function pX(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var o=void 0;if(t)for(var s=n.length-1;0<=s;s--){var a=n[s],u=a.instance,d=a.currentTarget;if(a=a.listener,u!==o&&i.isPropagationStopped())break e;Xz(i,a,d),o=u}else for(s=0;s<n.length;s++){if(a=n[s],u=a.instance,d=a.currentTarget,a=a.listener,u!==o&&i.isPropagationStopped())break e;Xz(i,a,d),o=u}}}if(GE)throw e=_L,GE=!1,_L=null,e}function _s(e,t){var r=t[EL];r===void 0&&(r=t[EL]=new Set);var n=e+"__bubble";r.has(n)||(mX(t,e,2,!1),r.add(n))}function cI(e,t,r){var n=0;t&&(n|=4),mX(r,e,n,t)}var nP="_reactListening"+Math.random().toString(36).slice(2);function N2(e){if(!e[nP]){e[nP]=!0,wZ.forEach(function(r){r!=="selectionchange"&&(Mpe.has(r)||cI(r,!1,e),cI(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[nP]||(t[nP]=!0,cI("selectionchange",!1,t))}}function mX(e,t,r,n){switch(QZ(t)){case 1:var i=jfe;break;case 4:i=Rfe;break;default:i=m4}r=i.bind(null,t,r,e),i=void 0,!gL||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function uI(e,t,r,n,i){var o=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var a=n.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(s===4)for(s=n.return;s!==null;){var u=s.tag;if((u===3||u===4)&&(u=s.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;s=s.return}for(;a!==null;){if(s=Ey(a),s===null)return;if(u=s.tag,u===5||u===6){n=o=s;continue e}a=a.parentNode}}n=n.return}RZ(function(){var d=o,m=d4(r),g=[];e:{var _=fX.get(e);if(_!==void 0){var y=_4,M=e;switch(e){case"keypress":if(hE(r)===0)break e;case"keydown":case"keyup":y=Jfe;break;case"focusin":M="focus",y=nI;break;case"focusout":M="blur",y=nI;break;case"beforeblur":case"afterblur":y=nI;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":y=Rz;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":y=Bfe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":y=rpe;break;case cX:case uX:case dX:y=Wfe;break;case hX:y=ipe;break;case"scroll":y=Ffe;break;case"wheel":y=ape;break;case"copy":case"cut":case"paste":y=qfe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":y=zz}var x=(t&4)!==0,E=!x&&e==="scroll",T=x?_!==null?_+"Capture":null:_;x=[];for(var P=d,C;P!==null;){C=P;var D=C.stateNode;if(C.tag===5&&D!==null&&(C=D,T!==null&&(D=k2(P,T),D!=null&&x.push(j2(P,D,C)))),E)break;P=P.return}0<x.length&&(_=new y(_,M,null,r,m),g.push({event:_,listeners:x}))}}if(!(t&7)){e:{if(_=e==="mouseover"||e==="pointerover",y=e==="mouseout"||e==="pointerout",_&&r!==pL&&(M=r.relatedTarget||r.fromElement)&&(Ey(M)||M[Bm]))break e;if((y||_)&&(_=m.window===m?m:(_=m.ownerDocument)?_.defaultView||_.parentWindow:window,y?(M=r.relatedTarget||r.toElement,y=d,M=M?Ey(M):null,M!==null&&(E=A0(M),M!==E||M.tag!==5&&M.tag!==6)&&(M=null)):(y=null,M=d),y!==M)){if(x=Rz,D="onMouseLeave",T="onMouseEnter",P="mouse",(e==="pointerout"||e==="pointerover")&&(x=zz,D="onPointerLeave",T="onPointerEnter",P="pointer"),E=y==null?_:Gv(y),C=M==null?_:Gv(M),_=new x(D,P+"leave",y,r,m),_.target=E,_.relatedTarget=C,D=null,Ey(m)===d&&(x=new x(T,P+"enter",M,r,m),x.target=C,x.relatedTarget=E,D=x),E=D,y&&M)t:{for(x=y,T=M,P=0,C=x;C;C=wv(C))P++;for(C=0,D=T;D;D=wv(D))C++;for(;0<P-C;)x=wv(x),P--;for(;0<C-P;)T=wv(T),C--;for(;P--;){if(x===T||T!==null&&x===T.alternate)break t;x=wv(x),T=wv(T)}x=null}else x=null;y!==null&&Yz(g,_,y,x,!1),M!==null&&E!==null&&Yz(g,E,M,x,!0)}}e:{if(_=d?Gv(d):window,y=_.nodeName&&_.nodeName.toLowerCase(),y==="select"||y==="input"&&_.type==="file")var L=fpe;else if(Vz(_))if(iX)L=_pe;else{L=mpe;var N=ppe}else(y=_.nodeName)&&y.toLowerCase()==="input"&&(_.type==="checkbox"||_.type==="radio")&&(L=gpe);if(L&&(L=L(e,d))){nX(g,L,r,m);break e}N&&N(e,_,d),e==="focusout"&&(N=_._wrapperState)&&N.controlled&&_.type==="number"&&cL(_,"number",_.value)}switch(N=d?Gv(d):window,e){case"focusin":(Vz(N)||N.contentEditable==="true")&&(Vv=N,xL=d,o2=null);break;case"focusout":o2=xL=Vv=null;break;case"mousedown":wL=!0;break;case"contextmenu":case"mouseup":case"dragend":wL=!1,Kz(g,r,m);break;case"selectionchange":if(bpe)break;case"keydown":case"keyup":Kz(g,r,m)}var j;if(v4)e:{switch(e){case"compositionstart":var $="onCompositionStart";break e;case"compositionend":$="onCompositionEnd";break e;case"compositionupdate":$="onCompositionUpdate";break e}$=void 0}else Uv?tX(e,r)&&($="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&($="onCompositionStart");$&&(eX&&r.locale!=="ko"&&(Uv||$!=="onCompositionStart"?$==="onCompositionEnd"&&Uv&&(j=JZ()):(Jg=m,g4="value"in Jg?Jg.value:Jg.textContent,Uv=!0)),N=XE(d,$),0<N.length&&($=new Fz($,e,null,r,m),g.push({event:$,listeners:N}),j?$.data=j:(j=rX(r),j!==null&&($.data=j)))),(j=lpe?cpe(e,r):upe(e,r))&&(d=XE(d,"onBeforeInput"),0<d.length&&(m=new Fz("onBeforeInput","beforeinput",null,r,m),g.push({event:m,listeners:d}),m.data=j))}pX(g,t)})}function j2(e,t,r){return{instance:e,listener:t,currentTarget:r}}function XE(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=k2(e,r),o!=null&&n.unshift(j2(e,o,i)),o=k2(e,t),o!=null&&n.push(j2(e,o,i))),e=e.return}return n}function wv(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Yz(e,t,r,n,i){for(var o=t._reactName,s=[];r!==null&&r!==n;){var a=r,u=a.alternate,d=a.stateNode;if(u!==null&&u===n)break;a.tag===5&&d!==null&&(a=d,i?(u=k2(r,o),u!=null&&s.unshift(j2(r,u,a))):i||(u=k2(r,o),u!=null&&s.push(j2(r,u,a)))),r=r.return}s.length!==0&&e.push({event:t,listeners:s})}var Spe=/\r\n?/g,Tpe=/\u0000|\uFFFD/g;function Qz(e){return(typeof e=="string"?e:""+e).replace(Spe,`
`).replace(Tpe,"")}function iP(e,t,r){if(t=Qz(t),Qz(e)!==t&&r)throw Error(fn(425))}function YE(){}var ML=null,SL=null;function TL(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var PL=typeof setTimeout=="function"?setTimeout:void 0,Ppe=typeof clearTimeout=="function"?clearTimeout:void 0,Jz=typeof Promise=="function"?Promise:void 0,Epe=typeof queueMicrotask=="function"?queueMicrotask:typeof Jz<"u"?function(e){return Jz.resolve(null).then(e).catch(Ape)}:PL;function Ape(e){setTimeout(function(){throw e})}function dI(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),L2(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);L2(t)}function c_(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function eB(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var kb=Math.random().toString(36).slice(2),Ap="__reactFiber$"+kb,R2="__reactProps$"+kb,Bm="__reactContainer$"+kb,EL="__reactEvents$"+kb,Cpe="__reactListeners$"+kb,kpe="__reactHandles$"+kb;function Ey(e){var t=e[Ap];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Bm]||r[Ap]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=eB(e);e!==null;){if(r=e[Ap])return r;e=eB(e)}return t}e=r,r=e.parentNode}return null}function sS(e){return e=e[Ap]||e[Bm],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Gv(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(fn(33))}function r5(e){return e[R2]||null}var AL=[],qv=-1;function k_(e){return{current:e}}function xs(e){0>qv||(e.current=AL[qv],AL[qv]=null,qv--)}function rs(e,t){qv++,AL[qv]=e.current,e.current=t}var x_={},Au=k_(x_),fd=k_(!1),t0=x_;function z1(e,t){var r=e.type.contextTypes;if(!r)return x_;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in r)i[o]=t[o];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function pd(e){return e=e.childContextTypes,e!=null}function QE(){xs(fd),xs(Au)}function tB(e,t,r){if(Au.current!==x_)throw Error(fn(168));rs(Au,t),rs(fd,r)}function gX(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(fn(108,pfe(e)||"Unknown",i));return Ks({},r,n)}function JE(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||x_,t0=Au.current,rs(Au,e),rs(fd,fd.current),!0}function rB(e,t,r){var n=e.stateNode;if(!n)throw Error(fn(169));r?(e=gX(e,t,t0),n.__reactInternalMemoizedMergedChildContext=e,xs(fd),xs(Au),rs(Au,e)):xs(fd),rs(fd,r)}var Pm=null,n5=!1,hI=!1;function _X(e){Pm===null?Pm=[e]:Pm.push(e)}function Ipe(e){n5=!0,_X(e)}function I_(){if(!hI&&Pm!==null){hI=!0;var e=0,t=Sa;try{var r=Pm;for(Sa=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Pm=null,n5=!1}catch(i){throw Pm!==null&&(Pm=Pm.slice(e+1)),UZ(h4,I_),i}finally{Sa=t,hI=!1}}return null}var Hv=[],Kv=0,eA=null,tA=0,Th=[],Ph=0,r0=null,Im=1,Om="";function my(e,t){Hv[Kv++]=tA,Hv[Kv++]=eA,eA=e,tA=t}function yX(e,t,r){Th[Ph++]=Im,Th[Ph++]=Om,Th[Ph++]=r0,r0=e;var n=Im;e=Om;var i=32-$f(n)-1;n&=~(1<<i),r+=1;var o=32-$f(t)+i;if(30<o){var s=i-i%5;o=(n&(1<<s)-1).toString(32),n>>=s,i-=s,Im=1<<32-$f(t)+i|r<<i|n,Om=o+e}else Im=1<<o|r<<i|n,Om=e}function x4(e){e.return!==null&&(my(e,1),yX(e,1,0))}function w4(e){for(;e===eA;)eA=Hv[--Kv],Hv[Kv]=null,tA=Hv[--Kv],Hv[Kv]=null;for(;e===r0;)r0=Th[--Ph],Th[Ph]=null,Om=Th[--Ph],Th[Ph]=null,Im=Th[--Ph],Th[Ph]=null}var Xd=null,qd=null,Is=!1,If=null;function vX(e,t){var r=kh(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function nB(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Xd=e,qd=c_(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Xd=e,qd=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=r0!==null?{id:Im,overflow:Om}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=kh(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Xd=e,qd=null,!0):!1;default:return!1}}function CL(e){return(e.mode&1)!==0&&(e.flags&128)===0}function kL(e){if(Is){var t=qd;if(t){var r=t;if(!nB(e,t)){if(CL(e))throw Error(fn(418));t=c_(r.nextSibling);var n=Xd;t&&nB(e,t)?vX(n,r):(e.flags=e.flags&-4097|2,Is=!1,Xd=e)}}else{if(CL(e))throw Error(fn(418));e.flags=e.flags&-4097|2,Is=!1,Xd=e}}}function iB(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Xd=e}function oP(e){if(e!==Xd)return!1;if(!Is)return iB(e),Is=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!TL(e.type,e.memoizedProps)),t&&(t=qd)){if(CL(e))throw bX(),Error(fn(418));for(;t;)vX(e,t),t=c_(t.nextSibling)}if(iB(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(fn(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){qd=c_(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}qd=null}}else qd=Xd?c_(e.stateNode.nextSibling):null;return!0}function bX(){for(var e=qd;e;)e=c_(e.nextSibling)}function B1(){qd=Xd=null,Is=!1}function M4(e){If===null?If=[e]:If.push(e)}var Ope=Jm.ReactCurrentBatchConfig;function dw(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(fn(309));var n=r.stateNode}if(!n)throw Error(fn(147,e));var i=n,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(s){var a=i.refs;s===null?delete a[o]:a[o]=s},t._stringRef=o,t)}if(typeof e!="string")throw Error(fn(284));if(!r._owner)throw Error(fn(290,e))}return e}function aP(e,t){throw e=Object.prototype.toString.call(t),Error(fn(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function oB(e){var t=e._init;return t(e._payload)}function xX(e){function t(T,P){if(e){var C=T.deletions;C===null?(T.deletions=[P],T.flags|=16):C.push(P)}}function r(T,P){if(!e)return null;for(;P!==null;)t(T,P),P=P.sibling;return null}function n(T,P){for(T=new Map;P!==null;)P.key!==null?T.set(P.key,P):T.set(P.index,P),P=P.sibling;return T}function i(T,P){return T=f_(T,P),T.index=0,T.sibling=null,T}function o(T,P,C){return T.index=C,e?(C=T.alternate,C!==null?(C=C.index,C<P?(T.flags|=2,P):C):(T.flags|=2,P)):(T.flags|=1048576,P)}function s(T){return e&&T.alternate===null&&(T.flags|=2),T}function a(T,P,C,D){return P===null||P.tag!==6?(P=vI(C,T.mode,D),P.return=T,P):(P=i(P,C),P.return=T,P)}function u(T,P,C,D){var L=C.type;return L===Bv?m(T,P,C.props.children,D,C.key):P!==null&&(P.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===zg&&oB(L)===P.type)?(D=i(P,C.props),D.ref=dw(T,P,C),D.return=T,D):(D=vE(C.type,C.key,C.props,null,T.mode,D),D.ref=dw(T,P,C),D.return=T,D)}function d(T,P,C,D){return P===null||P.tag!==4||P.stateNode.containerInfo!==C.containerInfo||P.stateNode.implementation!==C.implementation?(P=bI(C,T.mode,D),P.return=T,P):(P=i(P,C.children||[]),P.return=T,P)}function m(T,P,C,D,L){return P===null||P.tag!==7?(P=Ky(C,T.mode,D,L),P.return=T,P):(P=i(P,C),P.return=T,P)}function g(T,P,C){if(typeof P=="string"&&P!==""||typeof P=="number")return P=vI(""+P,T.mode,C),P.return=T,P;if(typeof P=="object"&&P!==null){switch(P.$$typeof){case ZT:return C=vE(P.type,P.key,P.props,null,T.mode,C),C.ref=dw(T,null,P),C.return=T,C;case zv:return P=bI(P,T.mode,C),P.return=T,P;case zg:var D=P._init;return g(T,D(P._payload),C)}if(Uw(P)||aw(P))return P=Ky(P,T.mode,C,null),P.return=T,P;aP(T,P)}return null}function _(T,P,C,D){var L=P!==null?P.key:null;if(typeof C=="string"&&C!==""||typeof C=="number")return L!==null?null:a(T,P,""+C,D);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case ZT:return C.key===L?u(T,P,C,D):null;case zv:return C.key===L?d(T,P,C,D):null;case zg:return L=C._init,_(T,P,L(C._payload),D)}if(Uw(C)||aw(C))return L!==null?null:m(T,P,C,D,null);aP(T,C)}return null}function y(T,P,C,D,L){if(typeof D=="string"&&D!==""||typeof D=="number")return T=T.get(C)||null,a(P,T,""+D,L);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case ZT:return T=T.get(D.key===null?C:D.key)||null,u(P,T,D,L);case zv:return T=T.get(D.key===null?C:D.key)||null,d(P,T,D,L);case zg:var N=D._init;return y(T,P,C,N(D._payload),L)}if(Uw(D)||aw(D))return T=T.get(C)||null,m(P,T,D,L,null);aP(P,D)}return null}function M(T,P,C,D){for(var L=null,N=null,j=P,$=P=0,U=null;j!==null&&$<C.length;$++){j.index>$?(U=j,j=null):U=j.sibling;var G=_(T,j,C[$],D);if(G===null){j===null&&(j=U);break}e&&j&&G.alternate===null&&t(T,j),P=o(G,P,$),N===null?L=G:N.sibling=G,N=G,j=U}if($===C.length)return r(T,j),Is&&my(T,$),L;if(j===null){for(;$<C.length;$++)j=g(T,C[$],D),j!==null&&(P=o(j,P,$),N===null?L=j:N.sibling=j,N=j);return Is&&my(T,$),L}for(j=n(T,j);$<C.length;$++)U=y(j,T,$,C[$],D),U!==null&&(e&&U.alternate!==null&&j.delete(U.key===null?$:U.key),P=o(U,P,$),N===null?L=U:N.sibling=U,N=U);return e&&j.forEach(function(H){return t(T,H)}),Is&&my(T,$),L}function x(T,P,C,D){var L=aw(C);if(typeof L!="function")throw Error(fn(150));if(C=L.call(C),C==null)throw Error(fn(151));for(var N=L=null,j=P,$=P=0,U=null,G=C.next();j!==null&&!G.done;$++,G=C.next()){j.index>$?(U=j,j=null):U=j.sibling;var H=_(T,j,G.value,D);if(H===null){j===null&&(j=U);break}e&&j&&H.alternate===null&&t(T,j),P=o(H,P,$),N===null?L=H:N.sibling=H,N=H,j=U}if(G.done)return r(T,j),Is&&my(T,$),L;if(j===null){for(;!G.done;$++,G=C.next())G=g(T,G.value,D),G!==null&&(P=o(G,P,$),N===null?L=G:N.sibling=G,N=G);return Is&&my(T,$),L}for(j=n(T,j);!G.done;$++,G=C.next())G=y(j,T,$,G.value,D),G!==null&&(e&&G.alternate!==null&&j.delete(G.key===null?$:G.key),P=o(G,P,$),N===null?L=G:N.sibling=G,N=G);return e&&j.forEach(function(X){return t(T,X)}),Is&&my(T,$),L}function E(T,P,C,D){if(typeof C=="object"&&C!==null&&C.type===Bv&&C.key===null&&(C=C.props.children),typeof C=="object"&&C!==null){switch(C.$$typeof){case ZT:e:{for(var L=C.key,N=P;N!==null;){if(N.key===L){if(L=C.type,L===Bv){if(N.tag===7){r(T,N.sibling),P=i(N,C.props.children),P.return=T,T=P;break e}}else if(N.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===zg&&oB(L)===N.type){r(T,N.sibling),P=i(N,C.props),P.ref=dw(T,N,C),P.return=T,T=P;break e}r(T,N);break}else t(T,N);N=N.sibling}C.type===Bv?(P=Ky(C.props.children,T.mode,D,C.key),P.return=T,T=P):(D=vE(C.type,C.key,C.props,null,T.mode,D),D.ref=dw(T,P,C),D.return=T,T=D)}return s(T);case zv:e:{for(N=C.key;P!==null;){if(P.key===N)if(P.tag===4&&P.stateNode.containerInfo===C.containerInfo&&P.stateNode.implementation===C.implementation){r(T,P.sibling),P=i(P,C.children||[]),P.return=T,T=P;break e}else{r(T,P);break}else t(T,P);P=P.sibling}P=bI(C,T.mode,D),P.return=T,T=P}return s(T);case zg:return N=C._init,E(T,P,N(C._payload),D)}if(Uw(C))return M(T,P,C,D);if(aw(C))return x(T,P,C,D);aP(T,C)}return typeof C=="string"&&C!==""||typeof C=="number"?(C=""+C,P!==null&&P.tag===6?(r(T,P.sibling),P=i(P,C),P.return=T,T=P):(r(T,P),P=vI(C,T.mode,D),P.return=T,T=P),s(T)):r(T,P)}return E}var U1=xX(!0),wX=xX(!1),rA=k_(null),nA=null,Zv=null,S4=null;function T4(){S4=Zv=nA=null}function P4(e){var t=rA.current;xs(rA),e._currentValue=t}function IL(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function m1(e,t){nA=e,S4=Zv=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(cd=!0),e.firstContext=null)}function jh(e){var t=e._currentValue;if(S4!==e)if(e={context:e,memoizedValue:t,next:null},Zv===null){if(nA===null)throw Error(fn(308));Zv=e,nA.dependencies={lanes:0,firstContext:e}}else Zv=Zv.next=e;return t}var Ay=null;function E4(e){Ay===null?Ay=[e]:Ay.push(e)}function MX(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,E4(t)):(r.next=i.next,i.next=r),t.interleaved=r,Um(e,n)}function Um(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Bg=!1;function A4(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function SX(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Nm(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function u_(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Qo&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Um(e,r)}return i=n.interleaved,i===null?(t.next=t,E4(n)):(t.next=i.next,i.next=t),n.interleaved=t,Um(e,r)}function fE(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,f4(e,r)}}function aB(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,o=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};o===null?i=o=s:o=o.next=s,r=r.next}while(r!==null);o===null?i=o=t:o=o.next=t}else i=o=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function iA(e,t,r,n){var i=e.updateQueue;Bg=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var u=a,d=u.next;u.next=null,s===null?o=d:s.next=d,s=u;var m=e.alternate;m!==null&&(m=m.updateQueue,a=m.lastBaseUpdate,a!==s&&(a===null?m.firstBaseUpdate=d:a.next=d,m.lastBaseUpdate=u))}if(o!==null){var g=i.baseState;s=0,m=d=u=null,a=o;do{var _=a.lane,y=a.eventTime;if((n&_)===_){m!==null&&(m=m.next={eventTime:y,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var M=e,x=a;switch(_=t,y=r,x.tag){case 1:if(M=x.payload,typeof M=="function"){g=M.call(y,g,_);break e}g=M;break e;case 3:M.flags=M.flags&-65537|128;case 0:if(M=x.payload,_=typeof M=="function"?M.call(y,g,_):M,_==null)break e;g=Ks({},g,_);break e;case 2:Bg=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,_=i.effects,_===null?i.effects=[a]:_.push(a))}else y={eventTime:y,lane:_,tag:a.tag,payload:a.payload,callback:a.callback,next:null},m===null?(d=m=y,u=g):m=m.next=y,s|=_;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;_=a,a=_.next,_.next=null,i.lastBaseUpdate=_,i.shared.pending=null}}while(!0);if(m===null&&(u=g),i.baseState=u,i.firstBaseUpdate=d,i.lastBaseUpdate=m,t=i.shared.interleaved,t!==null){i=t;do s|=i.lane,i=i.next;while(i!==t)}else o===null&&(i.shared.lanes=0);i0|=s,e.lanes=s,e.memoizedState=g}}function sB(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(fn(191,i));i.call(n)}}}var lS={},Np=k_(lS),F2=k_(lS),z2=k_(lS);function Cy(e){if(e===lS)throw Error(fn(174));return e}function C4(e,t){switch(rs(z2,t),rs(F2,e),rs(Np,lS),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:dL(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=dL(t,e)}xs(Np),rs(Np,t)}function V1(){xs(Np),xs(F2),xs(z2)}function TX(e){Cy(z2.current);var t=Cy(Np.current),r=dL(t,e.type);t!==r&&(rs(F2,e),rs(Np,r))}function k4(e){F2.current===e&&(xs(Np),xs(F2))}var Gs=k_(0);function oA(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var fI=[];function I4(){for(var e=0;e<fI.length;e++)fI[e]._workInProgressVersionPrimary=null;fI.length=0}var pE=Jm.ReactCurrentDispatcher,pI=Jm.ReactCurrentBatchConfig,n0=0,Hs=null,dc=null,Nc=null,aA=!1,a2=!1,B2=0,Lpe=0;function gu(){throw Error(fn(321))}function O4(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Bf(e[r],t[r]))return!1;return!0}function L4(e,t,r,n,i,o){if(n0=o,Hs=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,pE.current=e===null||e.memoizedState===null?jpe:Rpe,e=r(n,i),a2){o=0;do{if(a2=!1,B2=0,25<=o)throw Error(fn(301));o+=1,Nc=dc=null,t.updateQueue=null,pE.current=Fpe,e=r(n,i)}while(a2)}if(pE.current=sA,t=dc!==null&&dc.next!==null,n0=0,Nc=dc=Hs=null,aA=!1,t)throw Error(fn(300));return e}function D4(){var e=B2!==0;return B2=0,e}function Sp(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Nc===null?Hs.memoizedState=Nc=e:Nc=Nc.next=e,Nc}function Rh(){if(dc===null){var e=Hs.alternate;e=e!==null?e.memoizedState:null}else e=dc.next;var t=Nc===null?Hs.memoizedState:Nc.next;if(t!==null)Nc=t,dc=e;else{if(e===null)throw Error(fn(310));dc=e,e={memoizedState:dc.memoizedState,baseState:dc.baseState,baseQueue:dc.baseQueue,queue:dc.queue,next:null},Nc===null?Hs.memoizedState=Nc=e:Nc=Nc.next=e}return Nc}function U2(e,t){return typeof t=="function"?t(e):t}function mI(e){var t=Rh(),r=t.queue;if(r===null)throw Error(fn(311));r.lastRenderedReducer=e;var n=dc,i=n.baseQueue,o=r.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}n.baseQueue=i=o,r.pending=null}if(i!==null){o=i.next,n=n.baseState;var a=s=null,u=null,d=o;do{var m=d.lane;if((n0&m)===m)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var g={lane:m,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(a=u=g,s=n):u=u.next=g,Hs.lanes|=m,i0|=m}d=d.next}while(d!==null&&d!==o);u===null?s=n:u.next=a,Bf(n,t.memoizedState)||(cd=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=u,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do o=i.lane,Hs.lanes|=o,i0|=o,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function gI(e){var t=Rh(),r=t.queue;if(r===null)throw Error(fn(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,o=t.memoizedState;if(i!==null){r.pending=null;var s=i=i.next;do o=e(o,s.action),s=s.next;while(s!==i);Bf(o,t.memoizedState)||(cd=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),r.lastRenderedState=o}return[o,n]}function PX(){}function EX(e,t){var r=Hs,n=Rh(),i=t(),o=!Bf(n.memoizedState,i);if(o&&(n.memoizedState=i,cd=!0),n=n.queue,$4(kX.bind(null,r,n,e),[e]),n.getSnapshot!==t||o||Nc!==null&&Nc.memoizedState.tag&1){if(r.flags|=2048,V2(9,CX.bind(null,r,n,i,t),void 0,null),zc===null)throw Error(fn(349));n0&30||AX(r,t,i)}return i}function AX(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Hs.updateQueue,t===null?(t={lastEffect:null,stores:null},Hs.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function CX(e,t,r,n){t.value=r,t.getSnapshot=n,IX(t)&&OX(e)}function kX(e,t,r){return r(function(){IX(t)&&OX(e)})}function IX(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Bf(e,r)}catch{return!0}}function OX(e){var t=Um(e,1);t!==null&&Nf(t,e,1,-1)}function lB(e){var t=Sp();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:U2,lastRenderedState:e},t.queue=e,e=e.dispatch=Npe.bind(null,Hs,e),[t.memoizedState,e]}function V2(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Hs.updateQueue,t===null?(t={lastEffect:null,stores:null},Hs.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function LX(){return Rh().memoizedState}function mE(e,t,r,n){var i=Sp();Hs.flags|=e,i.memoizedState=V2(1|t,r,void 0,n===void 0?null:n)}function i5(e,t,r,n){var i=Rh();n=n===void 0?null:n;var o=void 0;if(dc!==null){var s=dc.memoizedState;if(o=s.destroy,n!==null&&O4(n,s.deps)){i.memoizedState=V2(t,r,o,n);return}}Hs.flags|=e,i.memoizedState=V2(1|t,r,o,n)}function cB(e,t){return mE(8390656,8,e,t)}function $4(e,t){return i5(2048,8,e,t)}function DX(e,t){return i5(4,2,e,t)}function $X(e,t){return i5(4,4,e,t)}function NX(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function jX(e,t,r){return r=r!=null?r.concat([e]):null,i5(4,4,NX.bind(null,t,e),r)}function N4(){}function RX(e,t){var r=Rh();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&O4(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function FX(e,t){var r=Rh();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&O4(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function zX(e,t,r){return n0&21?(Bf(r,t)||(r=GZ(),Hs.lanes|=r,i0|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,cd=!0),e.memoizedState=r)}function Dpe(e,t){var r=Sa;Sa=r!==0&&4>r?r:4,e(!0);var n=pI.transition;pI.transition={};try{e(!1),t()}finally{Sa=r,pI.transition=n}}function BX(){return Rh().memoizedState}function $pe(e,t,r){var n=h_(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},UX(e))VX(t,r);else if(r=MX(e,t,r,n),r!==null){var i=qu();Nf(r,e,n,i),WX(r,t,n)}}function Npe(e,t,r){var n=h_(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(UX(e))VX(t,i);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var s=t.lastRenderedState,a=o(s,r);if(i.hasEagerState=!0,i.eagerState=a,Bf(a,s)){var u=t.interleaved;u===null?(i.next=i,E4(t)):(i.next=u.next,u.next=i),t.interleaved=i;return}}catch{}finally{}r=MX(e,t,i,n),r!==null&&(i=qu(),Nf(r,e,n,i),WX(r,t,n))}}function UX(e){var t=e.alternate;return e===Hs||t!==null&&t===Hs}function VX(e,t){a2=aA=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function WX(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,f4(e,r)}}var sA={readContext:jh,useCallback:gu,useContext:gu,useEffect:gu,useImperativeHandle:gu,useInsertionEffect:gu,useLayoutEffect:gu,useMemo:gu,useReducer:gu,useRef:gu,useState:gu,useDebugValue:gu,useDeferredValue:gu,useTransition:gu,useMutableSource:gu,useSyncExternalStore:gu,useId:gu,unstable_isNewReconciler:!1},jpe={readContext:jh,useCallback:function(e,t){return Sp().memoizedState=[e,t===void 0?null:t],e},useContext:jh,useEffect:cB,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,mE(4194308,4,NX.bind(null,t,e),r)},useLayoutEffect:function(e,t){return mE(4194308,4,e,t)},useInsertionEffect:function(e,t){return mE(4,2,e,t)},useMemo:function(e,t){var r=Sp();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Sp();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=$pe.bind(null,Hs,e),[n.memoizedState,e]},useRef:function(e){var t=Sp();return e={current:e},t.memoizedState=e},useState:lB,useDebugValue:N4,useDeferredValue:function(e){return Sp().memoizedState=e},useTransition:function(){var e=lB(!1),t=e[0];return e=Dpe.bind(null,e[1]),Sp().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Hs,i=Sp();if(Is){if(r===void 0)throw Error(fn(407));r=r()}else{if(r=t(),zc===null)throw Error(fn(349));n0&30||AX(n,t,r)}i.memoizedState=r;var o={value:r,getSnapshot:t};return i.queue=o,cB(kX.bind(null,n,o,e),[e]),n.flags|=2048,V2(9,CX.bind(null,n,o,r,t),void 0,null),r},useId:function(){var e=Sp(),t=zc.identifierPrefix;if(Is){var r=Om,n=Im;r=(n&~(1<<32-$f(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=B2++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Lpe++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Rpe={readContext:jh,useCallback:RX,useContext:jh,useEffect:$4,useImperativeHandle:jX,useInsertionEffect:DX,useLayoutEffect:$X,useMemo:FX,useReducer:mI,useRef:LX,useState:function(){return mI(U2)},useDebugValue:N4,useDeferredValue:function(e){var t=Rh();return zX(t,dc.memoizedState,e)},useTransition:function(){var e=mI(U2)[0],t=Rh().memoizedState;return[e,t]},useMutableSource:PX,useSyncExternalStore:EX,useId:BX,unstable_isNewReconciler:!1},Fpe={readContext:jh,useCallback:RX,useContext:jh,useEffect:$4,useImperativeHandle:jX,useInsertionEffect:DX,useLayoutEffect:$X,useMemo:FX,useReducer:gI,useRef:LX,useState:function(){return gI(U2)},useDebugValue:N4,useDeferredValue:function(e){var t=Rh();return dc===null?t.memoizedState=e:zX(t,dc.memoizedState,e)},useTransition:function(){var e=gI(U2)[0],t=Rh().memoizedState;return[e,t]},useMutableSource:PX,useSyncExternalStore:EX,useId:BX,unstable_isNewReconciler:!1};function Sf(e,t){if(e&&e.defaultProps){t=Ks({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function OL(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Ks({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var o5={isMounted:function(e){return(e=e._reactInternals)?A0(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=qu(),i=h_(e),o=Nm(n,i);o.payload=t,r!=null&&(o.callback=r),t=u_(e,o,i),t!==null&&(Nf(t,e,i,n),fE(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=qu(),i=h_(e),o=Nm(n,i);o.tag=1,o.payload=t,r!=null&&(o.callback=r),t=u_(e,o,i),t!==null&&(Nf(t,e,i,n),fE(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=qu(),n=h_(e),i=Nm(r,n);i.tag=2,t!=null&&(i.callback=t),t=u_(e,i,n),t!==null&&(Nf(t,e,n,r),fE(t,e,n))}};function uB(e,t,r,n,i,o,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,o,s):t.prototype&&t.prototype.isPureReactComponent?!$2(r,n)||!$2(i,o):!0}function GX(e,t,r){var n=!1,i=x_,o=t.contextType;return typeof o=="object"&&o!==null?o=jh(o):(i=pd(t)?t0:Au.current,n=t.contextTypes,o=(n=n!=null)?z1(e,i):x_),t=new t(r,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=o5,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function dB(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&o5.enqueueReplaceState(t,t.state,null)}function LL(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},A4(e);var o=t.contextType;typeof o=="object"&&o!==null?i.context=jh(o):(o=pd(t)?t0:Au.current,i.context=z1(e,o)),i.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(OL(e,t,o,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&o5.enqueueReplaceState(i,i.state,null),iA(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function W1(e,t){try{var r="",n=t;do r+=ffe(n),n=n.return;while(n);var i=r}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:i,digest:null}}function _I(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function DL(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var zpe=typeof WeakMap=="function"?WeakMap:Map;function qX(e,t,r){r=Nm(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){cA||(cA=!0,WL=n),DL(e,t)},r}function HX(e,t,r){r=Nm(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){DL(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(r.callback=function(){DL(e,t),typeof n!="function"&&(d_===null?d_=new Set([this]):d_.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),r}function hB(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new zpe;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=eme.bind(null,e,t,r),t.then(e,e))}function fB(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function pB(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Nm(-1,1),t.tag=2,u_(r,t,1))),r.lanes|=1),e)}var Bpe=Jm.ReactCurrentOwner,cd=!1;function Ru(e,t,r,n){t.child=e===null?wX(t,null,r,n):U1(t,e.child,r,n)}function mB(e,t,r,n,i){r=r.render;var o=t.ref;return m1(t,i),n=L4(e,t,r,n,o,i),r=D4(),e!==null&&!cd?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Vm(e,t,i)):(Is&&r&&x4(t),t.flags|=1,Ru(e,t,n,i),t.child)}function gB(e,t,r,n,i){if(e===null){var o=r.type;return typeof o=="function"&&!W4(o)&&o.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=o,KX(e,t,o,n,i)):(e=vE(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&i)){var s=o.memoizedProps;if(r=r.compare,r=r!==null?r:$2,r(s,n)&&e.ref===t.ref)return Vm(e,t,i)}return t.flags|=1,e=f_(o,n),e.ref=t.ref,e.return=t,t.child=e}function KX(e,t,r,n,i){if(e!==null){var o=e.memoizedProps;if($2(o,n)&&e.ref===t.ref)if(cd=!1,t.pendingProps=n=o,(e.lanes&i)!==0)e.flags&131072&&(cd=!0);else return t.lanes=e.lanes,Vm(e,t,i)}return $L(e,t,r,n,i)}function ZX(e,t,r){var n=t.pendingProps,i=n.children,o=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},rs(Yv,Bd),Bd|=r;else{if(!(r&1073741824))return e=o!==null?o.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,rs(Yv,Bd),Bd|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=o!==null?o.baseLanes:r,rs(Yv,Bd),Bd|=n}else o!==null?(n=o.baseLanes|r,t.memoizedState=null):n=r,rs(Yv,Bd),Bd|=n;return Ru(e,t,i,r),t.child}function XX(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function $L(e,t,r,n,i){var o=pd(r)?t0:Au.current;return o=z1(t,o),m1(t,i),r=L4(e,t,r,n,o,i),n=D4(),e!==null&&!cd?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Vm(e,t,i)):(Is&&n&&x4(t),t.flags|=1,Ru(e,t,r,i),t.child)}function _B(e,t,r,n,i){if(pd(r)){var o=!0;JE(t)}else o=!1;if(m1(t,i),t.stateNode===null)gE(e,t),GX(t,r,n),LL(t,r,n,i),n=!0;else if(e===null){var s=t.stateNode,a=t.memoizedProps;s.props=a;var u=s.context,d=r.contextType;typeof d=="object"&&d!==null?d=jh(d):(d=pd(r)?t0:Au.current,d=z1(t,d));var m=r.getDerivedStateFromProps,g=typeof m=="function"||typeof s.getSnapshotBeforeUpdate=="function";g||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==n||u!==d)&&dB(t,s,n,d),Bg=!1;var _=t.memoizedState;s.state=_,iA(t,n,s,i),u=t.memoizedState,a!==n||_!==u||fd.current||Bg?(typeof m=="function"&&(OL(t,r,m,n),u=t.memoizedState),(a=Bg||uB(t,r,a,n,_,u,d))?(g||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=u),s.props=n,s.state=u,s.context=d,n=a):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,SX(e,t),a=t.memoizedProps,d=t.type===t.elementType?a:Sf(t.type,a),s.props=d,g=t.pendingProps,_=s.context,u=r.contextType,typeof u=="object"&&u!==null?u=jh(u):(u=pd(r)?t0:Au.current,u=z1(t,u));var y=r.getDerivedStateFromProps;(m=typeof y=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==g||_!==u)&&dB(t,s,n,u),Bg=!1,_=t.memoizedState,s.state=_,iA(t,n,s,i);var M=t.memoizedState;a!==g||_!==M||fd.current||Bg?(typeof y=="function"&&(OL(t,r,y,n),M=t.memoizedState),(d=Bg||uB(t,r,d,n,_,M,u)||!1)?(m||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,M,u),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,M,u)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===e.memoizedProps&&_===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&_===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=M),s.props=n,s.state=M,s.context=u,n=d):(typeof s.componentDidUpdate!="function"||a===e.memoizedProps&&_===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&_===e.memoizedState||(t.flags|=1024),n=!1)}return NL(e,t,r,n,o,i)}function NL(e,t,r,n,i,o){XX(e,t);var s=(t.flags&128)!==0;if(!n&&!s)return i&&rB(t,r,!1),Vm(e,t,o);n=t.stateNode,Bpe.current=t;var a=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&s?(t.child=U1(t,e.child,null,o),t.child=U1(t,null,a,o)):Ru(e,t,a,o),t.memoizedState=n.state,i&&rB(t,r,!0),t.child}function YX(e){var t=e.stateNode;t.pendingContext?tB(e,t.pendingContext,t.pendingContext!==t.context):t.context&&tB(e,t.context,!1),C4(e,t.containerInfo)}function yB(e,t,r,n,i){return B1(),M4(i),t.flags|=256,Ru(e,t,r,n),t.child}var jL={dehydrated:null,treeContext:null,retryLane:0};function RL(e){return{baseLanes:e,cachePool:null,transitions:null}}function QX(e,t,r){var n=t.pendingProps,i=Gs.current,o=!1,s=(t.flags&128)!==0,a;if((a=s)||(a=e!==null&&e.memoizedState===null?!1:(i&2)!==0),a?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),rs(Gs,i&1),e===null)return kL(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=n.children,e=n.fallback,o?(n=t.mode,o=t.child,s={mode:"hidden",children:s},!(n&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=l5(s,n,0,null),e=Ky(e,n,r,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=RL(r),t.memoizedState=jL,e):j4(t,s));if(i=e.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return Upe(e,t,s,n,a,i,r);if(o){o=n.fallback,s=t.mode,i=e.child,a=i.sibling;var u={mode:"hidden",children:n.children};return!(s&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=u,t.deletions=null):(n=f_(i,u),n.subtreeFlags=i.subtreeFlags&14680064),a!==null?o=f_(a,o):(o=Ky(o,s,r,null),o.flags|=2),o.return=t,n.return=t,n.sibling=o,t.child=n,n=o,o=t.child,s=e.child.memoizedState,s=s===null?RL(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=e.childLanes&~r,t.memoizedState=jL,n}return o=e.child,e=o.sibling,n=f_(o,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function j4(e,t){return t=l5({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function sP(e,t,r,n){return n!==null&&M4(n),U1(t,e.child,null,r),e=j4(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Upe(e,t,r,n,i,o,s){if(r)return t.flags&256?(t.flags&=-257,n=_I(Error(fn(422))),sP(e,t,s,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=n.fallback,i=t.mode,n=l5({mode:"visible",children:n.children},i,0,null),o=Ky(o,i,s,null),o.flags|=2,n.return=t,o.return=t,n.sibling=o,t.child=n,t.mode&1&&U1(t,e.child,null,s),t.child.memoizedState=RL(s),t.memoizedState=jL,o);if(!(t.mode&1))return sP(e,t,s,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var a=n.dgst;return n=a,o=Error(fn(419)),n=_I(o,n,void 0),sP(e,t,s,n)}if(a=(s&e.childLanes)!==0,cd||a){if(n=zc,n!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,Um(e,i),Nf(n,e,i,-1))}return V4(),n=_I(Error(fn(421))),sP(e,t,s,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=tme.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,qd=c_(i.nextSibling),Xd=t,Is=!0,If=null,e!==null&&(Th[Ph++]=Im,Th[Ph++]=Om,Th[Ph++]=r0,Im=e.id,Om=e.overflow,r0=t),t=j4(t,n.children),t.flags|=4096,t)}function vB(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),IL(e.return,t,r)}function yI(e,t,r,n,i){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=r,o.tailMode=i)}function JX(e,t,r){var n=t.pendingProps,i=n.revealOrder,o=n.tail;if(Ru(e,t,n.children,r),n=Gs.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&vB(e,r,t);else if(e.tag===19)vB(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(rs(Gs,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&oA(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),yI(t,!1,i,r,o);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&oA(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}yI(t,!0,r,null,o);break;case"together":yI(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function gE(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Vm(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),i0|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(fn(153));if(t.child!==null){for(e=t.child,r=f_(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=f_(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Vpe(e,t,r){switch(t.tag){case 3:YX(t),B1();break;case 5:TX(t);break;case 1:pd(t.type)&&JE(t);break;case 4:C4(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;rs(rA,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(rs(Gs,Gs.current&1),t.flags|=128,null):r&t.child.childLanes?QX(e,t,r):(rs(Gs,Gs.current&1),e=Vm(e,t,r),e!==null?e.sibling:null);rs(Gs,Gs.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return JX(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),rs(Gs,Gs.current),n)break;return null;case 22:case 23:return t.lanes=0,ZX(e,t,r)}return Vm(e,t,r)}var eY,FL,tY,rY;eY=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};FL=function(){};tY=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,Cy(Np.current);var o=null;switch(r){case"input":i=sL(e,i),n=sL(e,n),o=[];break;case"select":i=Ks({},i,{value:void 0}),n=Ks({},n,{value:void 0}),o=[];break;case"textarea":i=uL(e,i),n=uL(e,n),o=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=YE)}hL(r,n);var s;r=null;for(d in i)if(!n.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var a=i[d];for(s in a)a.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(A2.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in n){var u=n[d];if(a=i!=null?i[d]:void 0,n.hasOwnProperty(d)&&u!==a&&(u!=null||a!=null))if(d==="style")if(a){for(s in a)!a.hasOwnProperty(s)||u&&u.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in u)u.hasOwnProperty(s)&&a[s]!==u[s]&&(r||(r={}),r[s]=u[s])}else r||(o||(o=[]),o.push(d,r)),r=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,a=a?a.__html:void 0,u!=null&&a!==u&&(o=o||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(o=o||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(A2.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&_s("scroll",e),o||a===u||(o=[])):(o=o||[]).push(d,u))}r&&(o=o||[]).push("style",r);var d=o;(t.updateQueue=d)&&(t.flags|=4)}};rY=function(e,t,r,n){r!==n&&(t.flags|=4)};function hw(e,t){if(!Is)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function _u(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Wpe(e,t,r){var n=t.pendingProps;switch(w4(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _u(t),null;case 1:return pd(t.type)&&QE(),_u(t),null;case 3:return n=t.stateNode,V1(),xs(fd),xs(Au),I4(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(oP(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,If!==null&&(HL(If),If=null))),FL(e,t),_u(t),null;case 5:k4(t);var i=Cy(z2.current);if(r=t.type,e!==null&&t.stateNode!=null)tY(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(fn(166));return _u(t),null}if(e=Cy(Np.current),oP(t)){n=t.stateNode,r=t.type;var o=t.memoizedProps;switch(n[Ap]=t,n[R2]=o,e=(t.mode&1)!==0,r){case"dialog":_s("cancel",n),_s("close",n);break;case"iframe":case"object":case"embed":_s("load",n);break;case"video":case"audio":for(i=0;i<Ww.length;i++)_s(Ww[i],n);break;case"source":_s("error",n);break;case"img":case"image":case"link":_s("error",n),_s("load",n);break;case"details":_s("toggle",n);break;case"input":Az(n,o),_s("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!o.multiple},_s("invalid",n);break;case"textarea":kz(n,o),_s("invalid",n)}hL(r,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="children"?typeof a=="string"?n.textContent!==a&&(o.suppressHydrationWarning!==!0&&iP(n.textContent,a,e),i=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&iP(n.textContent,a,e),i=["children",""+a]):A2.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&_s("scroll",n)}switch(r){case"input":XT(n),Cz(n,o,!0);break;case"textarea":XT(n),Iz(n);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(n.onclick=YE)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=kZ(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=s.createElement(r,{is:n.is}):(e=s.createElement(r),r==="select"&&(s=e,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):e=s.createElementNS(e,r),e[Ap]=t,e[R2]=n,eY(e,t,!1,!1),t.stateNode=e;e:{switch(s=fL(r,n),r){case"dialog":_s("cancel",e),_s("close",e),i=n;break;case"iframe":case"object":case"embed":_s("load",e),i=n;break;case"video":case"audio":for(i=0;i<Ww.length;i++)_s(Ww[i],e);i=n;break;case"source":_s("error",e),i=n;break;case"img":case"image":case"link":_s("error",e),_s("load",e),i=n;break;case"details":_s("toggle",e),i=n;break;case"input":Az(e,n),i=sL(e,n),_s("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=Ks({},n,{value:void 0}),_s("invalid",e);break;case"textarea":kz(e,n),i=uL(e,n),_s("invalid",e);break;default:i=n}hL(r,i),a=i;for(o in a)if(a.hasOwnProperty(o)){var u=a[o];o==="style"?LZ(e,u):o==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&IZ(e,u)):o==="children"?typeof u=="string"?(r!=="textarea"||u!=="")&&C2(e,u):typeof u=="number"&&C2(e,""+u):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(A2.hasOwnProperty(o)?u!=null&&o==="onScroll"&&_s("scroll",e):u!=null&&s4(e,o,u,s))}switch(r){case"input":XT(e),Cz(e,n,!1);break;case"textarea":XT(e),Iz(e);break;case"option":n.value!=null&&e.setAttribute("value",""+b_(n.value));break;case"select":e.multiple=!!n.multiple,o=n.value,o!=null?d1(e,!!n.multiple,o,!1):n.defaultValue!=null&&d1(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=YE)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return _u(t),null;case 6:if(e&&t.stateNode!=null)rY(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(fn(166));if(r=Cy(z2.current),Cy(Np.current),oP(t)){if(n=t.stateNode,r=t.memoizedProps,n[Ap]=t,(o=n.nodeValue!==r)&&(e=Xd,e!==null))switch(e.tag){case 3:iP(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&iP(n.nodeValue,r,(e.mode&1)!==0)}o&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ap]=t,t.stateNode=n}return _u(t),null;case 13:if(xs(Gs),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Is&&qd!==null&&t.mode&1&&!(t.flags&128))bX(),B1(),t.flags|=98560,o=!1;else if(o=oP(t),n!==null&&n.dehydrated!==null){if(e===null){if(!o)throw Error(fn(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(fn(317));o[Ap]=t}else B1(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;_u(t),o=!1}else If!==null&&(HL(If),If=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Gs.current&1?fc===0&&(fc=3):V4())),t.updateQueue!==null&&(t.flags|=4),_u(t),null);case 4:return V1(),FL(e,t),e===null&&N2(t.stateNode.containerInfo),_u(t),null;case 10:return P4(t.type._context),_u(t),null;case 17:return pd(t.type)&&QE(),_u(t),null;case 19:if(xs(Gs),o=t.memoizedState,o===null)return _u(t),null;if(n=(t.flags&128)!==0,s=o.rendering,s===null)if(n)hw(o,!1);else{if(fc!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=oA(e),s!==null){for(t.flags|=128,hw(o,!1),n=s.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)o=r,e=n,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,e=s.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return rs(Gs,Gs.current&1|2),t.child}e=e.sibling}o.tail!==null&&Al()>G1&&(t.flags|=128,n=!0,hw(o,!1),t.lanes=4194304)}else{if(!n)if(e=oA(s),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),hw(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!Is)return _u(t),null}else 2*Al()-o.renderingStartTime>G1&&r!==1073741824&&(t.flags|=128,n=!0,hw(o,!1),t.lanes=4194304);o.isBackwards?(s.sibling=t.child,t.child=s):(r=o.last,r!==null?r.sibling=s:t.child=s,o.last=s)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Al(),t.sibling=null,r=Gs.current,rs(Gs,n?r&1|2:r&1),t):(_u(t),null);case 22:case 23:return U4(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Bd&1073741824&&(_u(t),t.subtreeFlags&6&&(t.flags|=8192)):_u(t),null;case 24:return null;case 25:return null}throw Error(fn(156,t.tag))}function Gpe(e,t){switch(w4(t),t.tag){case 1:return pd(t.type)&&QE(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return V1(),xs(fd),xs(Au),I4(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return k4(t),null;case 13:if(xs(Gs),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(fn(340));B1()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return xs(Gs),null;case 4:return V1(),null;case 10:return P4(t.type._context),null;case 22:case 23:return U4(),null;case 24:return null;default:return null}}var lP=!1,Tu=!1,qpe=typeof WeakSet=="function"?WeakSet:Set,Bn=null;function Xv(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){ll(e,t,n)}else r.current=null}function zL(e,t,r){try{r()}catch(n){ll(e,t,n)}}var bB=!1;function Hpe(e,t){if(ML=KE,e=sX(),b4(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,o=n.focusNode;n=n.focusOffset;try{r.nodeType,o.nodeType}catch{r=null;break e}var s=0,a=-1,u=-1,d=0,m=0,g=e,_=null;t:for(;;){for(var y;g!==r||i!==0&&g.nodeType!==3||(a=s+i),g!==o||n!==0&&g.nodeType!==3||(u=s+n),g.nodeType===3&&(s+=g.nodeValue.length),(y=g.firstChild)!==null;)_=g,g=y;for(;;){if(g===e)break t;if(_===r&&++d===i&&(a=s),_===o&&++m===n&&(u=s),(y=g.nextSibling)!==null)break;g=_,_=g.parentNode}g=y}r=a===-1||u===-1?null:{start:a,end:u}}else r=null}r=r||{start:0,end:0}}else r=null;for(SL={focusedElem:e,selectionRange:r},KE=!1,Bn=t;Bn!==null;)if(t=Bn,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Bn=e;else for(;Bn!==null;){t=Bn;try{var M=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(M!==null){var x=M.memoizedProps,E=M.memoizedState,T=t.stateNode,P=T.getSnapshotBeforeUpdate(t.elementType===t.type?x:Sf(t.type,x),E);T.__reactInternalSnapshotBeforeUpdate=P}break;case 3:var C=t.stateNode.containerInfo;C.nodeType===1?C.textContent="":C.nodeType===9&&C.documentElement&&C.removeChild(C.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(fn(163))}}catch(D){ll(t,t.return,D)}if(e=t.sibling,e!==null){e.return=t.return,Bn=e;break}Bn=t.return}return M=bB,bB=!1,M}function s2(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,o!==void 0&&zL(t,r,o)}i=i.next}while(i!==n)}}function a5(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function BL(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function nY(e){var t=e.alternate;t!==null&&(e.alternate=null,nY(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ap],delete t[R2],delete t[EL],delete t[Cpe],delete t[kpe])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function iY(e){return e.tag===5||e.tag===3||e.tag===4}function xB(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||iY(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function UL(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=YE));else if(n!==4&&(e=e.child,e!==null))for(UL(e,t,r),e=e.sibling;e!==null;)UL(e,t,r),e=e.sibling}function VL(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(VL(e,t,r),e=e.sibling;e!==null;)VL(e,t,r),e=e.sibling}var tu=null,Af=!1;function Tg(e,t,r){for(r=r.child;r!==null;)oY(e,t,r),r=r.sibling}function oY(e,t,r){if($p&&typeof $p.onCommitFiberUnmount=="function")try{$p.onCommitFiberUnmount(QC,r)}catch{}switch(r.tag){case 5:Tu||Xv(r,t);case 6:var n=tu,i=Af;tu=null,Tg(e,t,r),tu=n,Af=i,tu!==null&&(Af?(e=tu,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):tu.removeChild(r.stateNode));break;case 18:tu!==null&&(Af?(e=tu,r=r.stateNode,e.nodeType===8?dI(e.parentNode,r):e.nodeType===1&&dI(e,r),L2(e)):dI(tu,r.stateNode));break;case 4:n=tu,i=Af,tu=r.stateNode.containerInfo,Af=!0,Tg(e,t,r),tu=n,Af=i;break;case 0:case 11:case 14:case 15:if(!Tu&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&zL(r,t,s),i=i.next}while(i!==n)}Tg(e,t,r);break;case 1:if(!Tu&&(Xv(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(a){ll(r,t,a)}Tg(e,t,r);break;case 21:Tg(e,t,r);break;case 22:r.mode&1?(Tu=(n=Tu)||r.memoizedState!==null,Tg(e,t,r),Tu=n):Tg(e,t,r);break;default:Tg(e,t,r)}}function wB(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new qpe),t.forEach(function(n){var i=rme.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function ff(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var o=e,s=t,a=s;e:for(;a!==null;){switch(a.tag){case 5:tu=a.stateNode,Af=!1;break e;case 3:tu=a.stateNode.containerInfo,Af=!0;break e;case 4:tu=a.stateNode.containerInfo,Af=!0;break e}a=a.return}if(tu===null)throw Error(fn(160));oY(o,s,i),tu=null,Af=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(d){ll(i,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)aY(t,e),t=t.sibling}function aY(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ff(t,e),bp(e),n&4){try{s2(3,e,e.return),a5(3,e)}catch(x){ll(e,e.return,x)}try{s2(5,e,e.return)}catch(x){ll(e,e.return,x)}}break;case 1:ff(t,e),bp(e),n&512&&r!==null&&Xv(r,r.return);break;case 5:if(ff(t,e),bp(e),n&512&&r!==null&&Xv(r,r.return),e.flags&32){var i=e.stateNode;try{C2(i,"")}catch(x){ll(e,e.return,x)}}if(n&4&&(i=e.stateNode,i!=null)){var o=e.memoizedProps,s=r!==null?r.memoizedProps:o,a=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&AZ(i,o),fL(a,s);var d=fL(a,o);for(s=0;s<u.length;s+=2){var m=u[s],g=u[s+1];m==="style"?LZ(i,g):m==="dangerouslySetInnerHTML"?IZ(i,g):m==="children"?C2(i,g):s4(i,m,g,d)}switch(a){case"input":lL(i,o);break;case"textarea":CZ(i,o);break;case"select":var _=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var y=o.value;y!=null?d1(i,!!o.multiple,y,!1):_!==!!o.multiple&&(o.defaultValue!=null?d1(i,!!o.multiple,o.defaultValue,!0):d1(i,!!o.multiple,o.multiple?[]:"",!1))}i[R2]=o}catch(x){ll(e,e.return,x)}}break;case 6:if(ff(t,e),bp(e),n&4){if(e.stateNode===null)throw Error(fn(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(x){ll(e,e.return,x)}}break;case 3:if(ff(t,e),bp(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{L2(t.containerInfo)}catch(x){ll(e,e.return,x)}break;case 4:ff(t,e),bp(e);break;case 13:ff(t,e),bp(e),i=e.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(z4=Al())),n&4&&wB(e);break;case 22:if(m=r!==null&&r.memoizedState!==null,e.mode&1?(Tu=(d=Tu)||m,ff(t,e),Tu=d):ff(t,e),bp(e),n&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!m&&e.mode&1)for(Bn=e,m=e.child;m!==null;){for(g=Bn=m;Bn!==null;){switch(_=Bn,y=_.child,_.tag){case 0:case 11:case 14:case 15:s2(4,_,_.return);break;case 1:Xv(_,_.return);var M=_.stateNode;if(typeof M.componentWillUnmount=="function"){n=_,r=_.return;try{t=n,M.props=t.memoizedProps,M.state=t.memoizedState,M.componentWillUnmount()}catch(x){ll(n,r,x)}}break;case 5:Xv(_,_.return);break;case 22:if(_.memoizedState!==null){SB(g);continue}}y!==null?(y.return=_,Bn=y):SB(g)}m=m.sibling}e:for(m=null,g=e;;){if(g.tag===5){if(m===null){m=g;try{i=g.stateNode,d?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=g.stateNode,u=g.memoizedProps.style,s=u!=null&&u.hasOwnProperty("display")?u.display:null,a.style.display=OZ("display",s))}catch(x){ll(e,e.return,x)}}}else if(g.tag===6){if(m===null)try{g.stateNode.nodeValue=d?"":g.memoizedProps}catch(x){ll(e,e.return,x)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===e)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===e)break e;for(;g.sibling===null;){if(g.return===null||g.return===e)break e;m===g&&(m=null),g=g.return}m===g&&(m=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:ff(t,e),bp(e),n&4&&wB(e);break;case 21:break;default:ff(t,e),bp(e)}}function bp(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(iY(r)){var n=r;break e}r=r.return}throw Error(fn(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(C2(i,""),n.flags&=-33);var o=xB(e);VL(e,o,i);break;case 3:case 4:var s=n.stateNode.containerInfo,a=xB(e);UL(e,a,s);break;default:throw Error(fn(161))}}catch(u){ll(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Kpe(e,t,r){Bn=e,sY(e)}function sY(e,t,r){for(var n=(e.mode&1)!==0;Bn!==null;){var i=Bn,o=i.child;if(i.tag===22&&n){var s=i.memoizedState!==null||lP;if(!s){var a=i.alternate,u=a!==null&&a.memoizedState!==null||Tu;a=lP;var d=Tu;if(lP=s,(Tu=u)&&!d)for(Bn=i;Bn!==null;)s=Bn,u=s.child,s.tag===22&&s.memoizedState!==null?TB(i):u!==null?(u.return=s,Bn=u):TB(i);for(;o!==null;)Bn=o,sY(o),o=o.sibling;Bn=i,lP=a,Tu=d}MB(e)}else i.subtreeFlags&8772&&o!==null?(o.return=i,Bn=o):MB(e)}}function MB(e){for(;Bn!==null;){var t=Bn;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Tu||a5(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Tu)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:Sf(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&sB(t,o,n);break;case 3:var s=t.updateQueue;if(s!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}sB(t,s,r)}break;case 5:var a=t.stateNode;if(r===null&&t.flags&4){r=a;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&r.focus();break;case"img":u.src&&(r.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var m=d.memoizedState;if(m!==null){var g=m.dehydrated;g!==null&&L2(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(fn(163))}Tu||t.flags&512&&BL(t)}catch(_){ll(t,t.return,_)}}if(t===e){Bn=null;break}if(r=t.sibling,r!==null){r.return=t.return,Bn=r;break}Bn=t.return}}function SB(e){for(;Bn!==null;){var t=Bn;if(t===e){Bn=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Bn=r;break}Bn=t.return}}function TB(e){for(;Bn!==null;){var t=Bn;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{a5(4,t)}catch(u){ll(t,r,u)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(u){ll(t,i,u)}}var o=t.return;try{BL(t)}catch(u){ll(t,o,u)}break;case 5:var s=t.return;try{BL(t)}catch(u){ll(t,s,u)}}}catch(u){ll(t,t.return,u)}if(t===e){Bn=null;break}var a=t.sibling;if(a!==null){a.return=t.return,Bn=a;break}Bn=t.return}}var Zpe=Math.ceil,lA=Jm.ReactCurrentDispatcher,R4=Jm.ReactCurrentOwner,Oh=Jm.ReactCurrentBatchConfig,Qo=0,zc=null,Hl=null,ou=0,Bd=0,Yv=k_(0),fc=0,W2=null,i0=0,s5=0,F4=0,l2=null,sd=null,z4=0,G1=1/0,Sm=null,cA=!1,WL=null,d_=null,cP=!1,e_=null,uA=0,c2=0,GL=null,_E=-1,yE=0;function qu(){return Qo&6?Al():_E!==-1?_E:_E=Al()}function h_(e){return e.mode&1?Qo&2&&ou!==0?ou&-ou:Ope.transition!==null?(yE===0&&(yE=GZ()),yE):(e=Sa,e!==0||(e=window.event,e=e===void 0?16:QZ(e.type)),e):1}function Nf(e,t,r,n){if(50<c2)throw c2=0,GL=null,Error(fn(185));oS(e,r,n),(!(Qo&2)||e!==zc)&&(e===zc&&(!(Qo&2)&&(s5|=r),fc===4&&Wg(e,ou)),md(e,n),r===1&&Qo===0&&!(t.mode&1)&&(G1=Al()+500,n5&&I_()))}function md(e,t){var r=e.callbackNode;Ofe(e,t);var n=HE(e,e===zc?ou:0);if(n===0)r!==null&&Dz(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Dz(r),t===1)e.tag===0?Ipe(PB.bind(null,e)):_X(PB.bind(null,e)),Epe(function(){!(Qo&6)&&I_()}),r=null;else{switch(qZ(n)){case 1:r=h4;break;case 4:r=VZ;break;case 16:r=qE;break;case 536870912:r=WZ;break;default:r=qE}r=mY(r,lY.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function lY(e,t){if(_E=-1,yE=0,Qo&6)throw Error(fn(327));var r=e.callbackNode;if(g1()&&e.callbackNode!==r)return null;var n=HE(e,e===zc?ou:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=dA(e,n);else{t=n;var i=Qo;Qo|=2;var o=uY();(zc!==e||ou!==t)&&(Sm=null,G1=Al()+500,Hy(e,t));do try{Qpe();break}catch(a){cY(e,a)}while(!0);T4(),lA.current=o,Qo=i,Hl!==null?t=0:(zc=null,ou=0,t=fc)}if(t!==0){if(t===2&&(i=yL(e),i!==0&&(n=i,t=qL(e,i))),t===1)throw r=W2,Hy(e,0),Wg(e,n),md(e,Al()),r;if(t===6)Wg(e,n);else{if(i=e.current.alternate,!(n&30)&&!Xpe(i)&&(t=dA(e,n),t===2&&(o=yL(e),o!==0&&(n=o,t=qL(e,o))),t===1))throw r=W2,Hy(e,0),Wg(e,n),md(e,Al()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(fn(345));case 2:gy(e,sd,Sm);break;case 3:if(Wg(e,n),(n&130023424)===n&&(t=z4+500-Al(),10<t)){if(HE(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){qu(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=PL(gy.bind(null,e,sd,Sm),t);break}gy(e,sd,Sm);break;case 4:if(Wg(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var s=31-$f(n);o=1<<s,s=t[s],s>i&&(i=s),n&=~o}if(n=i,n=Al()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Zpe(n/1960))-n,10<n){e.timeoutHandle=PL(gy.bind(null,e,sd,Sm),n);break}gy(e,sd,Sm);break;case 5:gy(e,sd,Sm);break;default:throw Error(fn(329))}}}return md(e,Al()),e.callbackNode===r?lY.bind(null,e):null}function qL(e,t){var r=l2;return e.current.memoizedState.isDehydrated&&(Hy(e,t).flags|=256),e=dA(e,t),e!==2&&(t=sd,sd=r,t!==null&&HL(t)),e}function HL(e){sd===null?sd=e:sd.push.apply(sd,e)}function Xpe(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],o=i.getSnapshot;i=i.value;try{if(!Bf(o(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Wg(e,t){for(t&=~F4,t&=~s5,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-$f(t),n=1<<r;e[r]=-1,t&=~n}}function PB(e){if(Qo&6)throw Error(fn(327));g1();var t=HE(e,0);if(!(t&1))return md(e,Al()),null;var r=dA(e,t);if(e.tag!==0&&r===2){var n=yL(e);n!==0&&(t=n,r=qL(e,n))}if(r===1)throw r=W2,Hy(e,0),Wg(e,t),md(e,Al()),r;if(r===6)throw Error(fn(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,gy(e,sd,Sm),md(e,Al()),null}function B4(e,t){var r=Qo;Qo|=1;try{return e(t)}finally{Qo=r,Qo===0&&(G1=Al()+500,n5&&I_())}}function o0(e){e_!==null&&e_.tag===0&&!(Qo&6)&&g1();var t=Qo;Qo|=1;var r=Oh.transition,n=Sa;try{if(Oh.transition=null,Sa=1,e)return e()}finally{Sa=n,Oh.transition=r,Qo=t,!(Qo&6)&&I_()}}function U4(){Bd=Yv.current,xs(Yv)}function Hy(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Ppe(r)),Hl!==null)for(r=Hl.return;r!==null;){var n=r;switch(w4(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&QE();break;case 3:V1(),xs(fd),xs(Au),I4();break;case 5:k4(n);break;case 4:V1();break;case 13:xs(Gs);break;case 19:xs(Gs);break;case 10:P4(n.type._context);break;case 22:case 23:U4()}r=r.return}if(zc=e,Hl=e=f_(e.current,null),ou=Bd=t,fc=0,W2=null,F4=s5=i0=0,sd=l2=null,Ay!==null){for(t=0;t<Ay.length;t++)if(r=Ay[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,o=r.pending;if(o!==null){var s=o.next;o.next=i,n.next=s}r.pending=n}Ay=null}return e}function cY(e,t){do{var r=Hl;try{if(T4(),pE.current=sA,aA){for(var n=Hs.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}aA=!1}if(n0=0,Nc=dc=Hs=null,a2=!1,B2=0,R4.current=null,r===null||r.return===null){fc=1,W2=t,Hl=null;break}e:{var o=e,s=r.return,a=r,u=t;if(t=ou,a.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,m=a,g=m.tag;if(!(m.mode&1)&&(g===0||g===11||g===15)){var _=m.alternate;_?(m.updateQueue=_.updateQueue,m.memoizedState=_.memoizedState,m.lanes=_.lanes):(m.updateQueue=null,m.memoizedState=null)}var y=fB(s);if(y!==null){y.flags&=-257,pB(y,s,a,o,t),y.mode&1&&hB(o,d,t),t=y,u=d;var M=t.updateQueue;if(M===null){var x=new Set;x.add(u),t.updateQueue=x}else M.add(u);break e}else{if(!(t&1)){hB(o,d,t),V4();break e}u=Error(fn(426))}}else if(Is&&a.mode&1){var E=fB(s);if(E!==null){!(E.flags&65536)&&(E.flags|=256),pB(E,s,a,o,t),M4(W1(u,a));break e}}o=u=W1(u,a),fc!==4&&(fc=2),l2===null?l2=[o]:l2.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var T=qX(o,u,t);aB(o,T);break e;case 1:a=u;var P=o.type,C=o.stateNode;if(!(o.flags&128)&&(typeof P.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(d_===null||!d_.has(C)))){o.flags|=65536,t&=-t,o.lanes|=t;var D=HX(o,a,t);aB(o,D);break e}}o=o.return}while(o!==null)}hY(r)}catch(L){t=L,Hl===r&&r!==null&&(Hl=r=r.return);continue}break}while(!0)}function uY(){var e=lA.current;return lA.current=sA,e===null?sA:e}function V4(){(fc===0||fc===3||fc===2)&&(fc=4),zc===null||!(i0&268435455)&&!(s5&268435455)||Wg(zc,ou)}function dA(e,t){var r=Qo;Qo|=2;var n=uY();(zc!==e||ou!==t)&&(Sm=null,Hy(e,t));do try{Ype();break}catch(i){cY(e,i)}while(!0);if(T4(),Qo=r,lA.current=n,Hl!==null)throw Error(fn(261));return zc=null,ou=0,fc}function Ype(){for(;Hl!==null;)dY(Hl)}function Qpe(){for(;Hl!==null&&!Mfe();)dY(Hl)}function dY(e){var t=pY(e.alternate,e,Bd);e.memoizedProps=e.pendingProps,t===null?hY(e):Hl=t,R4.current=null}function hY(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Gpe(r,t),r!==null){r.flags&=32767,Hl=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{fc=6,Hl=null;return}}else if(r=Wpe(r,t,Bd),r!==null){Hl=r;return}if(t=t.sibling,t!==null){Hl=t;return}Hl=t=e}while(t!==null);fc===0&&(fc=5)}function gy(e,t,r){var n=Sa,i=Oh.transition;try{Oh.transition=null,Sa=1,Jpe(e,t,r,n)}finally{Oh.transition=i,Sa=n}return null}function Jpe(e,t,r,n){do g1();while(e_!==null);if(Qo&6)throw Error(fn(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(fn(177));e.callbackNode=null,e.callbackPriority=0;var o=r.lanes|r.childLanes;if(Lfe(e,o),e===zc&&(Hl=zc=null,ou=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||cP||(cP=!0,mY(qE,function(){return g1(),null})),o=(r.flags&15990)!==0,r.subtreeFlags&15990||o){o=Oh.transition,Oh.transition=null;var s=Sa;Sa=1;var a=Qo;Qo|=4,R4.current=null,Hpe(e,r),aY(r,e),vpe(SL),KE=!!ML,SL=ML=null,e.current=r,Kpe(r),Sfe(),Qo=a,Sa=s,Oh.transition=o}else e.current=r;if(cP&&(cP=!1,e_=e,uA=i),o=e.pendingLanes,o===0&&(d_=null),Efe(r.stateNode),md(e,Al()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(cA)throw cA=!1,e=WL,WL=null,e;return uA&1&&e.tag!==0&&g1(),o=e.pendingLanes,o&1?e===GL?c2++:(c2=0,GL=e):c2=0,I_(),null}function g1(){if(e_!==null){var e=qZ(uA),t=Oh.transition,r=Sa;try{if(Oh.transition=null,Sa=16>e?16:e,e_===null)var n=!1;else{if(e=e_,e_=null,uA=0,Qo&6)throw Error(fn(331));var i=Qo;for(Qo|=4,Bn=e.current;Bn!==null;){var o=Bn,s=o.child;if(Bn.flags&16){var a=o.deletions;if(a!==null){for(var u=0;u<a.length;u++){var d=a[u];for(Bn=d;Bn!==null;){var m=Bn;switch(m.tag){case 0:case 11:case 15:s2(8,m,o)}var g=m.child;if(g!==null)g.return=m,Bn=g;else for(;Bn!==null;){m=Bn;var _=m.sibling,y=m.return;if(nY(m),m===d){Bn=null;break}if(_!==null){_.return=y,Bn=_;break}Bn=y}}}var M=o.alternate;if(M!==null){var x=M.child;if(x!==null){M.child=null;do{var E=x.sibling;x.sibling=null,x=E}while(x!==null)}}Bn=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,Bn=s;else e:for(;Bn!==null;){if(o=Bn,o.flags&2048)switch(o.tag){case 0:case 11:case 15:s2(9,o,o.return)}var T=o.sibling;if(T!==null){T.return=o.return,Bn=T;break e}Bn=o.return}}var P=e.current;for(Bn=P;Bn!==null;){s=Bn;var C=s.child;if(s.subtreeFlags&2064&&C!==null)C.return=s,Bn=C;else e:for(s=P;Bn!==null;){if(a=Bn,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:a5(9,a)}}catch(L){ll(a,a.return,L)}if(a===s){Bn=null;break e}var D=a.sibling;if(D!==null){D.return=a.return,Bn=D;break e}Bn=a.return}}if(Qo=i,I_(),$p&&typeof $p.onPostCommitFiberRoot=="function")try{$p.onPostCommitFiberRoot(QC,e)}catch{}n=!0}return n}finally{Sa=r,Oh.transition=t}}return!1}function EB(e,t,r){t=W1(r,t),t=qX(e,t,1),e=u_(e,t,1),t=qu(),e!==null&&(oS(e,1,t),md(e,t))}function ll(e,t,r){if(e.tag===3)EB(e,e,r);else for(;t!==null;){if(t.tag===3){EB(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(d_===null||!d_.has(n))){e=W1(r,e),e=HX(t,e,1),t=u_(t,e,1),e=qu(),t!==null&&(oS(t,1,e),md(t,e));break}}t=t.return}}function eme(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=qu(),e.pingedLanes|=e.suspendedLanes&r,zc===e&&(ou&r)===r&&(fc===4||fc===3&&(ou&130023424)===ou&&500>Al()-z4?Hy(e,0):F4|=r),md(e,t)}function fY(e,t){t===0&&(e.mode&1?(t=JT,JT<<=1,!(JT&130023424)&&(JT=4194304)):t=1);var r=qu();e=Um(e,t),e!==null&&(oS(e,t,r),md(e,r))}function tme(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),fY(e,r)}function rme(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(fn(314))}n!==null&&n.delete(t),fY(e,r)}var pY;pY=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||fd.current)cd=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return cd=!1,Vpe(e,t,r);cd=!!(e.flags&131072)}else cd=!1,Is&&t.flags&1048576&&yX(t,tA,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;gE(e,t),e=t.pendingProps;var i=z1(t,Au.current);m1(t,r),i=L4(null,t,n,e,i,r);var o=D4();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,pd(n)?(o=!0,JE(t)):o=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,A4(t),i.updater=o5,t.stateNode=i,i._reactInternals=t,LL(t,n,e,r),t=NL(null,t,n,!0,o,r)):(t.tag=0,Is&&o&&x4(t),Ru(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(gE(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=ime(n),e=Sf(n,e),i){case 0:t=$L(null,t,n,e,r);break e;case 1:t=_B(null,t,n,e,r);break e;case 11:t=mB(null,t,n,e,r);break e;case 14:t=gB(null,t,n,Sf(n.type,e),r);break e}throw Error(fn(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Sf(n,i),$L(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Sf(n,i),_B(e,t,n,i,r);case 3:e:{if(YX(t),e===null)throw Error(fn(387));n=t.pendingProps,o=t.memoizedState,i=o.element,SX(e,t),iA(t,n,null,r);var s=t.memoizedState;if(n=s.element,o.isDehydrated)if(o={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){i=W1(Error(fn(423)),t),t=yB(e,t,n,r,i);break e}else if(n!==i){i=W1(Error(fn(424)),t),t=yB(e,t,n,r,i);break e}else for(qd=c_(t.stateNode.containerInfo.firstChild),Xd=t,Is=!0,If=null,r=wX(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(B1(),n===i){t=Vm(e,t,r);break e}Ru(e,t,n,r)}t=t.child}return t;case 5:return TX(t),e===null&&kL(t),n=t.type,i=t.pendingProps,o=e!==null?e.memoizedProps:null,s=i.children,TL(n,i)?s=null:o!==null&&TL(n,o)&&(t.flags|=32),XX(e,t),Ru(e,t,s,r),t.child;case 6:return e===null&&kL(t),null;case 13:return QX(e,t,r);case 4:return C4(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=U1(t,null,n,r):Ru(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Sf(n,i),mB(e,t,n,i,r);case 7:return Ru(e,t,t.pendingProps,r),t.child;case 8:return Ru(e,t,t.pendingProps.children,r),t.child;case 12:return Ru(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,o=t.memoizedProps,s=i.value,rs(rA,n._currentValue),n._currentValue=s,o!==null)if(Bf(o.value,s)){if(o.children===i.children&&!fd.current){t=Vm(e,t,r);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var a=o.dependencies;if(a!==null){s=o.child;for(var u=a.firstContext;u!==null;){if(u.context===n){if(o.tag===1){u=Nm(-1,r&-r),u.tag=2;var d=o.updateQueue;if(d!==null){d=d.shared;var m=d.pending;m===null?u.next=u:(u.next=m.next,m.next=u),d.pending=u}}o.lanes|=r,u=o.alternate,u!==null&&(u.lanes|=r),IL(o.return,r,t),a.lanes|=r;break}u=u.next}}else if(o.tag===10)s=o.type===t.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(fn(341));s.lanes|=r,a=s.alternate,a!==null&&(a.lanes|=r),IL(s,r,t),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===t){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}Ru(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,m1(t,r),i=jh(i),n=n(i),t.flags|=1,Ru(e,t,n,r),t.child;case 14:return n=t.type,i=Sf(n,t.pendingProps),i=Sf(n.type,i),gB(e,t,n,i,r);case 15:return KX(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Sf(n,i),gE(e,t),t.tag=1,pd(n)?(e=!0,JE(t)):e=!1,m1(t,r),GX(t,n,i),LL(t,n,i,r),NL(null,t,n,!0,e,r);case 19:return JX(e,t,r);case 22:return ZX(e,t,r)}throw Error(fn(156,t.tag))};function mY(e,t){return UZ(e,t)}function nme(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kh(e,t,r,n){return new nme(e,t,r,n)}function W4(e){return e=e.prototype,!(!e||!e.isReactComponent)}function ime(e){if(typeof e=="function")return W4(e)?1:0;if(e!=null){if(e=e.$$typeof,e===c4)return 11;if(e===u4)return 14}return 2}function f_(e,t){var r=e.alternate;return r===null?(r=kh(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function vE(e,t,r,n,i,o){var s=2;if(n=e,typeof e=="function")W4(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case Bv:return Ky(r.children,i,o,t);case l4:s=8,i|=8;break;case nL:return e=kh(12,r,t,i|2),e.elementType=nL,e.lanes=o,e;case iL:return e=kh(13,r,t,i),e.elementType=iL,e.lanes=o,e;case oL:return e=kh(19,r,t,i),e.elementType=oL,e.lanes=o,e;case TZ:return l5(r,i,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case MZ:s=10;break e;case SZ:s=9;break e;case c4:s=11;break e;case u4:s=14;break e;case zg:s=16,n=null;break e}throw Error(fn(130,e==null?e:typeof e,""))}return t=kh(s,r,t,i),t.elementType=e,t.type=n,t.lanes=o,t}function Ky(e,t,r,n){return e=kh(7,e,n,t),e.lanes=r,e}function l5(e,t,r,n){return e=kh(22,e,n,t),e.elementType=TZ,e.lanes=r,e.stateNode={isHidden:!1},e}function vI(e,t,r){return e=kh(6,e,null,t),e.lanes=r,e}function bI(e,t,r){return t=kh(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function ome(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=eI(0),this.expirationTimes=eI(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=eI(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function G4(e,t,r,n,i,o,s,a,u){return e=new ome(e,t,r,a,u),t===1?(t=1,o===!0&&(t|=8)):t=0,o=kh(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},A4(o),e}function ame(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:zv,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function gY(e){if(!e)return x_;e=e._reactInternals;e:{if(A0(e)!==e||e.tag!==1)throw Error(fn(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(pd(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(fn(171))}if(e.tag===1){var r=e.type;if(pd(r))return gX(e,r,t)}return t}function _Y(e,t,r,n,i,o,s,a,u){return e=G4(r,n,!0,e,i,o,s,a,u),e.context=gY(null),r=e.current,n=qu(),i=h_(r),o=Nm(n,i),o.callback=t??null,u_(r,o,i),e.current.lanes=i,oS(e,i,n),md(e,n),e}function c5(e,t,r,n){var i=t.current,o=qu(),s=h_(i);return r=gY(r),t.context===null?t.context=r:t.pendingContext=r,t=Nm(o,s),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=u_(i,t,s),e!==null&&(Nf(e,i,s,o),fE(e,i,s)),s}function hA(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function AB(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function q4(e,t){AB(e,t),(e=e.alternate)&&AB(e,t)}function sme(){return null}var yY=typeof reportError=="function"?reportError:function(e){console.error(e)};function H4(e){this._internalRoot=e}u5.prototype.render=H4.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(fn(409));c5(e,t,null,null)};u5.prototype.unmount=H4.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;o0(function(){c5(null,e,null,null)}),t[Bm]=null}};function u5(e){this._internalRoot=e}u5.prototype.unstable_scheduleHydration=function(e){if(e){var t=ZZ();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Vg.length&&t!==0&&t<Vg[r].priority;r++);Vg.splice(r,0,e),r===0&&YZ(e)}};function K4(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function d5(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function CB(){}function lme(e,t,r,n,i){if(i){if(typeof n=="function"){var o=n;n=function(){var d=hA(s);o.call(d)}}var s=_Y(t,n,e,0,null,!1,!1,"",CB);return e._reactRootContainer=s,e[Bm]=s.current,N2(e.nodeType===8?e.parentNode:e),o0(),s}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var a=n;n=function(){var d=hA(u);a.call(d)}}var u=G4(e,0,!1,null,null,!1,!1,"",CB);return e._reactRootContainer=u,e[Bm]=u.current,N2(e.nodeType===8?e.parentNode:e),o0(function(){c5(t,u,r,n)}),u}function h5(e,t,r,n,i){var o=r._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var a=i;i=function(){var u=hA(s);a.call(u)}}c5(t,s,e,i)}else s=lme(r,t,e,i,n);return hA(s)}HZ=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Vw(t.pendingLanes);r!==0&&(f4(t,r|1),md(t,Al()),!(Qo&6)&&(G1=Al()+500,I_()))}break;case 13:o0(function(){var n=Um(e,1);if(n!==null){var i=qu();Nf(n,e,1,i)}}),q4(e,1)}};p4=function(e){if(e.tag===13){var t=Um(e,134217728);if(t!==null){var r=qu();Nf(t,e,134217728,r)}q4(e,134217728)}};KZ=function(e){if(e.tag===13){var t=h_(e),r=Um(e,t);if(r!==null){var n=qu();Nf(r,e,t,n)}q4(e,t)}};ZZ=function(){return Sa};XZ=function(e,t){var r=Sa;try{return Sa=e,t()}finally{Sa=r}};mL=function(e,t,r){switch(t){case"input":if(lL(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=r5(n);if(!i)throw Error(fn(90));EZ(n),lL(n,i)}}}break;case"textarea":CZ(e,r);break;case"select":t=r.value,t!=null&&d1(e,!!r.multiple,t,!1)}};NZ=B4;jZ=o0;var cme={usingClientEntryPoint:!1,Events:[sS,Gv,r5,DZ,$Z,B4]},fw={findFiberByHostInstance:Ey,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ume={bundleType:fw.bundleType,version:fw.version,rendererPackageName:fw.rendererPackageName,rendererConfig:fw.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Jm.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=zZ(e),e===null?null:e.stateNode},findFiberByHostInstance:fw.findFiberByHostInstance||sme,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var uP=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!uP.isDisabled&&uP.supportsFiber)try{QC=uP.inject(ume),$p=uP}catch{}}nh.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cme;nh.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!K4(t))throw Error(fn(200));return ame(e,t,null,r)};nh.createRoot=function(e,t){if(!K4(e))throw Error(fn(299));var r=!1,n="",i=yY;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=G4(e,1,!1,null,null,r,!1,n,i),e[Bm]=t.current,N2(e.nodeType===8?e.parentNode:e),new H4(t)};nh.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(fn(188)):(e=Object.keys(e).join(","),Error(fn(268,e)));return e=zZ(t),e=e===null?null:e.stateNode,e};nh.flushSync=function(e){return o0(e)};nh.hydrate=function(e,t,r){if(!d5(t))throw Error(fn(200));return h5(null,e,t,!0,r)};nh.hydrateRoot=function(e,t,r){if(!K4(e))throw Error(fn(405));var n=r!=null&&r.hydratedSources||null,i=!1,o="",s=yY;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(o=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),t=_Y(t,null,e,1,r??null,i,!1,o,s),e[Bm]=t.current,N2(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new u5(t)};nh.render=function(e,t,r){if(!d5(t))throw Error(fn(200));return h5(null,e,t,!1,r)};nh.unmountComponentAtNode=function(e){if(!d5(e))throw Error(fn(40));return e._reactRootContainer?(o0(function(){h5(null,null,e,!1,function(){e._reactRootContainer=null,e[Bm]=null})}),!0):!1};nh.unstable_batchedUpdates=B4;nh.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!d5(r))throw Error(fn(200));if(e==null||e._reactInternals===void 0)throw Error(fn(38));return h5(e,t,r,!1,n)};nh.version="18.3.1-next-f1338f8080-20240426";function vY(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(vY)}catch(e){console.error(e)}}vY(),vZ.exports=nh;var C0=vZ.exports;const bY=sa(C0);var xY,kB=C0;xY=kB.createRoot,kB.hydrateRoot;const dme=1,hme=1e6;let xI=0;function fme(){return xI=(xI+1)%Number.MAX_SAFE_INTEGER,xI.toString()}const wI=new Map,IB=e=>{if(wI.has(e))return;const t=setTimeout(()=>{wI.delete(e),u2({type:"REMOVE_TOAST",toastId:e})},hme);wI.set(e,t)},pme=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,dme)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(r=>r.id===t.toast.id?{...r,...t.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=t;return r?IB(r):e.toasts.forEach(n=>{IB(n.id)}),{...e,toasts:e.toasts.map(n=>n.id===r||r===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(r=>r.id!==t.toastId)}}},bE=[];let xE={toasts:[]};function u2(e){xE=pme(xE,e),bE.forEach(t=>{t(xE)})}function mme({...e}){const t=fme(),r=i=>u2({type:"UPDATE_TOAST",toast:{...i,id:t}}),n=()=>u2({type:"DISMISS_TOAST",toastId:t});return u2({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:i=>{i||n()}}}),{id:t,dismiss:n,update:r}}function cS(){const[e,t]=oe.useState(xE);return oe.useEffect(()=>(bE.push(t),()=>{const r=bE.indexOf(t);r>-1&&bE.splice(r,1)}),[e]),{...e,toast:mme,dismiss:r=>u2({type:"DISMISS_TOAST",toastId:r})}}function In(e,t,{checkForDefaultPrevented:r=!0}={}){return function(i){if(e==null||e(i),r===!1||!i.defaultPrevented)return t==null?void 0:t(i)}}function OB(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function f5(...e){return t=>{let r=!1;const n=e.map(i=>{const o=OB(i,t);return!r&&typeof o=="function"&&(r=!0),o});if(r)return()=>{for(let i=0;i<n.length;i++){const o=n[i];typeof o=="function"?o():OB(e[i],null)}}}}function ea(...e){return oe.useCallback(f5(...e),e)}function gme(e,t){const r=oe.createContext(t),n=o=>{const{children:s,...a}=o,u=oe.useMemo(()=>a,Object.values(a));return F.jsx(r.Provider,{value:u,children:s})};n.displayName=e+"Provider";function i(o){const s=oe.useContext(r);if(s)return s;if(t!==void 0)return t;throw new Error(`\`${o}\` must be used within \`${e}\``)}return[n,i]}function Bh(e,t=[]){let r=[];function n(o,s){const a=oe.createContext(s),u=r.length;r=[...r,s];const d=g=>{var T;const{scope:_,children:y,...M}=g,x=((T=_==null?void 0:_[e])==null?void 0:T[u])||a,E=oe.useMemo(()=>M,Object.values(M));return F.jsx(x.Provider,{value:E,children:y})};d.displayName=o+"Provider";function m(g,_){var x;const y=((x=_==null?void 0:_[e])==null?void 0:x[u])||a,M=oe.useContext(y);if(M)return M;if(s!==void 0)return s;throw new Error(`\`${g}\` must be used within \`${o}\``)}return[d,m]}const i=()=>{const o=r.map(s=>oe.createContext(s));return function(a){const u=(a==null?void 0:a[e])||o;return oe.useMemo(()=>({[`__scope${e}`]:{...a,[e]:u}}),[a,u])}};return i.scopeName=e,[n,_me(i,...t)]}function _me(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(o){const s=n.reduce((a,{useScope:u,scopeName:d})=>{const g=u(o)[`__scope${d}`];return{...a,...g}},{});return oe.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return r.scopeName=t.scopeName,r}function a0(e){const t=vme(e),r=oe.forwardRef((n,i)=>{const{children:o,...s}=n,a=oe.Children.toArray(o),u=a.find(xme);if(u){const d=u.props.children,m=a.map(g=>g===u?oe.Children.count(d)>1?oe.Children.only(null):oe.isValidElement(d)?d.props.children:null:g);return F.jsx(t,{...s,ref:i,children:oe.isValidElement(d)?oe.cloneElement(d,void 0,m):null})}return F.jsx(t,{...s,ref:i,children:o})});return r.displayName=`${e}.Slot`,r}var yme=a0("Slot");function vme(e){const t=oe.forwardRef((r,n)=>{const{children:i,...o}=r;if(oe.isValidElement(i)){const s=Mme(i),a=wme(o,i.props);return i.type!==oe.Fragment&&(a.ref=n?f5(n,s):s),oe.cloneElement(i,a)}return oe.Children.count(i)>1?oe.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var wY=Symbol("radix.slottable");function bme(e){const t=({children:r})=>F.jsx(F.Fragment,{children:r});return t.displayName=`${e}.Slottable`,t.__radixId=wY,t}function xme(e){return oe.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===wY}function wme(e,t){const r={...t};for(const n in t){const i=e[n],o=t[n];/^on[A-Z]/.test(n)?i&&o?r[n]=(...a)=>{const u=o(...a);return i(...a),u}:i&&(r[n]=i):n==="style"?r[n]={...i,...o}:n==="className"&&(r[n]=[i,o].filter(Boolean).join(" "))}return{...e,...r}}function Mme(e){var n,i;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(i=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:i.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function p5(e){const t=e+"CollectionProvider",[r,n]=Bh(t),[i,o]=r(t,{collectionRef:{current:null},itemMap:new Map}),s=x=>{const{scope:E,children:T}=x,P=ct.useRef(null),C=ct.useRef(new Map).current;return F.jsx(i,{scope:E,itemMap:C,collectionRef:P,children:T})};s.displayName=t;const a=e+"CollectionSlot",u=a0(a),d=ct.forwardRef((x,E)=>{const{scope:T,children:P}=x,C=o(a,T),D=ea(E,C.collectionRef);return F.jsx(u,{ref:D,children:P})});d.displayName=a;const m=e+"CollectionItemSlot",g="data-radix-collection-item",_=a0(m),y=ct.forwardRef((x,E)=>{const{scope:T,children:P,...C}=x,D=ct.useRef(null),L=ea(E,D),N=o(m,T);return ct.useEffect(()=>(N.itemMap.set(D,{ref:D,...C}),()=>void N.itemMap.delete(D))),F.jsx(_,{[g]:"",ref:L,children:P})});y.displayName=m;function M(x){const E=o(e+"CollectionConsumer",x);return ct.useCallback(()=>{const P=E.collectionRef.current;if(!P)return[];const C=Array.from(P.querySelectorAll(`[${g}]`));return Array.from(E.itemMap.values()).sort((N,j)=>C.indexOf(N.ref.current)-C.indexOf(j.ref.current))},[E.collectionRef,E.itemMap])}return[{Provider:s,Slot:d,ItemSlot:y},M,n]}var Sme=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Ei=Sme.reduce((e,t)=>{const r=a0(`Primitive.${t}`),n=oe.forwardRef((i,o)=>{const{asChild:s,...a}=i,u=s?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),F.jsx(u,{...a,ref:o})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function Z4(e,t){e&&C0.flushSync(()=>e.dispatchEvent(t))}function Hu(e){const t=oe.useRef(e);return oe.useEffect(()=>{t.current=e}),oe.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function Tme(e,t=globalThis==null?void 0:globalThis.document){const r=Hu(e);oe.useEffect(()=>{const n=i=>{i.key==="Escape"&&r(i)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var Pme="DismissableLayer",KL="dismissableLayer.update",Eme="dismissableLayer.pointerDownOutside",Ame="dismissableLayer.focusOutside",LB,MY=oe.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Ib=oe.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:i,onFocusOutside:o,onInteractOutside:s,onDismiss:a,...u}=e,d=oe.useContext(MY),[m,g]=oe.useState(null),_=(m==null?void 0:m.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,y]=oe.useState({}),M=ea(t,j=>g(j)),x=Array.from(d.layers),[E]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),T=x.indexOf(E),P=m?x.indexOf(m):-1,C=d.layersWithOutsidePointerEventsDisabled.size>0,D=P>=T,L=kme(j=>{const $=j.target,U=[...d.branches].some(G=>G.contains($));!D||U||(i==null||i(j),s==null||s(j),j.defaultPrevented||a==null||a())},_),N=Ime(j=>{const $=j.target;[...d.branches].some(G=>G.contains($))||(o==null||o(j),s==null||s(j),j.defaultPrevented||a==null||a())},_);return Tme(j=>{P===d.layers.size-1&&(n==null||n(j),!j.defaultPrevented&&a&&(j.preventDefault(),a()))},_),oe.useEffect(()=>{if(m)return r&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(LB=_.body.style.pointerEvents,_.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(m)),d.layers.add(m),DB(),()=>{r&&d.layersWithOutsidePointerEventsDisabled.size===1&&(_.body.style.pointerEvents=LB)}},[m,_,r,d]),oe.useEffect(()=>()=>{m&&(d.layers.delete(m),d.layersWithOutsidePointerEventsDisabled.delete(m),DB())},[m,d]),oe.useEffect(()=>{const j=()=>y({});return document.addEventListener(KL,j),()=>document.removeEventListener(KL,j)},[]),F.jsx(Ei.div,{...u,ref:M,style:{pointerEvents:C?D?"auto":"none":void 0,...e.style},onFocusCapture:In(e.onFocusCapture,N.onFocusCapture),onBlurCapture:In(e.onBlurCapture,N.onBlurCapture),onPointerDownCapture:In(e.onPointerDownCapture,L.onPointerDownCapture)})});Ib.displayName=Pme;var Cme="DismissableLayerBranch",SY=oe.forwardRef((e,t)=>{const r=oe.useContext(MY),n=oe.useRef(null),i=ea(t,n);return oe.useEffect(()=>{const o=n.current;if(o)return r.branches.add(o),()=>{r.branches.delete(o)}},[r.branches]),F.jsx(Ei.div,{...e,ref:i})});SY.displayName=Cme;function kme(e,t=globalThis==null?void 0:globalThis.document){const r=Hu(e),n=oe.useRef(!1),i=oe.useRef(()=>{});return oe.useEffect(()=>{const o=a=>{if(a.target&&!n.current){let u=function(){TY(Eme,r,d,{discrete:!0})};const d={originalEvent:a};a.pointerType==="touch"?(t.removeEventListener("click",i.current),i.current=u,t.addEventListener("click",i.current,{once:!0})):u()}else t.removeEventListener("click",i.current);n.current=!1},s=window.setTimeout(()=>{t.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(s),t.removeEventListener("pointerdown",o),t.removeEventListener("click",i.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function Ime(e,t=globalThis==null?void 0:globalThis.document){const r=Hu(e),n=oe.useRef(!1);return oe.useEffect(()=>{const i=o=>{o.target&&!n.current&&TY(Ame,r,{originalEvent:o},{discrete:!1})};return t.addEventListener("focusin",i),()=>t.removeEventListener("focusin",i)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function DB(){const e=new CustomEvent(KL);document.dispatchEvent(e)}function TY(e,t,r,{discrete:n}){const i=r.originalEvent.target,o=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&i.addEventListener(e,t,{once:!0}),n?Z4(i,o):i.dispatchEvent(o)}var Ome=Ib,Lme=SY,Zl=globalThis!=null&&globalThis.document?oe.useLayoutEffect:()=>{},Dme="Portal",uS=oe.forwardRef((e,t)=>{var a;const{container:r,...n}=e,[i,o]=oe.useState(!1);Zl(()=>o(!0),[]);const s=r||i&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return s?bY.createPortal(F.jsx(Ei.div,{...n,ref:t}),s):null});uS.displayName=Dme;function $me(e,t){return oe.useReducer((r,n)=>t[r][n]??r,e)}var Hf=e=>{const{present:t,children:r}=e,n=Nme(t),i=typeof r=="function"?r({present:n.isPresent}):oe.Children.only(r),o=ea(n.ref,jme(i));return typeof r=="function"||n.isPresent?oe.cloneElement(i,{ref:o}):null};Hf.displayName="Presence";function Nme(e){const[t,r]=oe.useState(),n=oe.useRef(null),i=oe.useRef(e),o=oe.useRef("none"),s=e?"mounted":"unmounted",[a,u]=$me(s,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return oe.useEffect(()=>{const d=dP(n.current);o.current=a==="mounted"?d:"none"},[a]),Zl(()=>{const d=n.current,m=i.current;if(m!==e){const _=o.current,y=dP(d);e?u("MOUNT"):y==="none"||(d==null?void 0:d.display)==="none"?u("UNMOUNT"):u(m&&_!==y?"ANIMATION_OUT":"UNMOUNT"),i.current=e}},[e,u]),Zl(()=>{if(t){let d;const m=t.ownerDocument.defaultView??window,g=y=>{const x=dP(n.current).includes(y.animationName);if(y.target===t&&x&&(u("ANIMATION_END"),!i.current)){const E=t.style.animationFillMode;t.style.animationFillMode="forwards",d=m.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=E)})}},_=y=>{y.target===t&&(o.current=dP(n.current))};return t.addEventListener("animationstart",_),t.addEventListener("animationcancel",g),t.addEventListener("animationend",g),()=>{m.clearTimeout(d),t.removeEventListener("animationstart",_),t.removeEventListener("animationcancel",g),t.removeEventListener("animationend",g)}}else u("ANIMATION_END")},[t,u]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:oe.useCallback(d=>{n.current=d?getComputedStyle(d):null,r(d)},[])}}function dP(e){return(e==null?void 0:e.animationName)||"none"}function jme(e){var n,i;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(i=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:i.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var Rme=i4[" useInsertionEffect ".trim().toString()]||Zl;function s0({prop:e,defaultProp:t,onChange:r=()=>{},caller:n}){const[i,o,s]=Fme({defaultProp:t,onChange:r}),a=e!==void 0,u=a?e:i;{const m=oe.useRef(e!==void 0);oe.useEffect(()=>{const g=m.current;g!==a&&console.warn(`${n} is changing from ${g?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),m.current=a},[a,n])}const d=oe.useCallback(m=>{var g;if(a){const _=zme(m)?m(e):m;_!==e&&((g=s.current)==null||g.call(s,_))}else o(m)},[a,e,o,s]);return[u,d]}function Fme({defaultProp:e,onChange:t}){const[r,n]=oe.useState(e),i=oe.useRef(r),o=oe.useRef(t);return Rme(()=>{o.current=t},[t]),oe.useEffect(()=>{var s;i.current!==r&&((s=o.current)==null||s.call(o,r),i.current=r)},[r,i]),[r,n,o]}function zme(e){return typeof e=="function"}var PY=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Bme="VisuallyHidden",m5=oe.forwardRef((e,t)=>F.jsx(Ei.span,{...e,ref:t,style:{...PY,...e.style}}));m5.displayName=Bme;var Ume=m5,X4="ToastProvider",[Y4,Vme,Wme]=p5("Toast"),[EY,Tet]=Bh("Toast",[Wme]),[Gme,g5]=EY(X4),AY=e=>{const{__scopeToast:t,label:r="Notification",duration:n=5e3,swipeDirection:i="right",swipeThreshold:o=50,children:s}=e,[a,u]=oe.useState(null),[d,m]=oe.useState(0),g=oe.useRef(!1),_=oe.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${X4}\`. Expected non-empty \`string\`.`),F.jsx(Y4.Provider,{scope:t,children:F.jsx(Gme,{scope:t,label:r,duration:n,swipeDirection:i,swipeThreshold:o,toastCount:d,viewport:a,onViewportChange:u,onToastAdd:oe.useCallback(()=>m(y=>y+1),[]),onToastRemove:oe.useCallback(()=>m(y=>y-1),[]),isFocusedToastEscapeKeyDownRef:g,isClosePausedRef:_,children:s})})};AY.displayName=X4;var CY="ToastViewport",qme=["F8"],ZL="toast.viewportPause",XL="toast.viewportResume",kY=oe.forwardRef((e,t)=>{const{__scopeToast:r,hotkey:n=qme,label:i="Notifications ({hotkey})",...o}=e,s=g5(CY,r),a=Vme(r),u=oe.useRef(null),d=oe.useRef(null),m=oe.useRef(null),g=oe.useRef(null),_=ea(t,g,s.onViewportChange),y=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),M=s.toastCount>0;oe.useEffect(()=>{const E=T=>{var C;n.length!==0&&n.every(D=>T[D]||T.code===D)&&((C=g.current)==null||C.focus())};return document.addEventListener("keydown",E),()=>document.removeEventListener("keydown",E)},[n]),oe.useEffect(()=>{const E=u.current,T=g.current;if(M&&E&&T){const P=()=>{if(!s.isClosePausedRef.current){const N=new CustomEvent(ZL);T.dispatchEvent(N),s.isClosePausedRef.current=!0}},C=()=>{if(s.isClosePausedRef.current){const N=new CustomEvent(XL);T.dispatchEvent(N),s.isClosePausedRef.current=!1}},D=N=>{!E.contains(N.relatedTarget)&&C()},L=()=>{E.contains(document.activeElement)||C()};return E.addEventListener("focusin",P),E.addEventListener("focusout",D),E.addEventListener("pointermove",P),E.addEventListener("pointerleave",L),window.addEventListener("blur",P),window.addEventListener("focus",C),()=>{E.removeEventListener("focusin",P),E.removeEventListener("focusout",D),E.removeEventListener("pointermove",P),E.removeEventListener("pointerleave",L),window.removeEventListener("blur",P),window.removeEventListener("focus",C)}}},[M,s.isClosePausedRef]);const x=oe.useCallback(({tabbingDirection:E})=>{const P=a().map(C=>{const D=C.ref.current,L=[D,...oge(D)];return E==="forwards"?L:L.reverse()});return(E==="forwards"?P.reverse():P).flat()},[a]);return oe.useEffect(()=>{const E=g.current;if(E){const T=P=>{var L,N,j;const C=P.altKey||P.ctrlKey||P.metaKey;if(P.key==="Tab"&&!C){const $=document.activeElement,U=P.shiftKey;if(P.target===E&&U){(L=d.current)==null||L.focus();return}const X=x({tabbingDirection:U?"backwards":"forwards"}),ee=X.findIndex(ae=>ae===$);MI(X.slice(ee+1))?P.preventDefault():U?(N=d.current)==null||N.focus():(j=m.current)==null||j.focus()}};return E.addEventListener("keydown",T),()=>E.removeEventListener("keydown",T)}},[a,x]),F.jsxs(Lme,{ref:u,role:"region","aria-label":i.replace("{hotkey}",y),tabIndex:-1,style:{pointerEvents:M?void 0:"none"},children:[M&&F.jsx(YL,{ref:d,onFocusFromOutsideViewport:()=>{const E=x({tabbingDirection:"forwards"});MI(E)}}),F.jsx(Y4.Slot,{scope:r,children:F.jsx(Ei.ol,{tabIndex:-1,...o,ref:_})}),M&&F.jsx(YL,{ref:m,onFocusFromOutsideViewport:()=>{const E=x({tabbingDirection:"backwards"});MI(E)}})]})});kY.displayName=CY;var IY="ToastFocusProxy",YL=oe.forwardRef((e,t)=>{const{__scopeToast:r,onFocusFromOutsideViewport:n,...i}=e,o=g5(IY,r);return F.jsx(m5,{"aria-hidden":!0,tabIndex:0,...i,ref:t,style:{position:"fixed"},onFocus:s=>{var d;const a=s.relatedTarget;!((d=o.viewport)!=null&&d.contains(a))&&n()}})});YL.displayName=IY;var dS="Toast",Hme="toast.swipeStart",Kme="toast.swipeMove",Zme="toast.swipeCancel",Xme="toast.swipeEnd",OY=oe.forwardRef((e,t)=>{const{forceMount:r,open:n,defaultOpen:i,onOpenChange:o,...s}=e,[a,u]=s0({prop:n,defaultProp:i??!0,onChange:o,caller:dS});return F.jsx(Hf,{present:r||a,children:F.jsx(Jme,{open:a,...s,ref:t,onClose:()=>u(!1),onPause:Hu(e.onPause),onResume:Hu(e.onResume),onSwipeStart:In(e.onSwipeStart,d=>{d.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:In(e.onSwipeMove,d=>{const{x:m,y:g}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","move"),d.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${m}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${g}px`)}),onSwipeCancel:In(e.onSwipeCancel,d=>{d.currentTarget.setAttribute("data-swipe","cancel"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:In(e.onSwipeEnd,d=>{const{x:m,y:g}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","end"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${m}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${g}px`),u(!1)})})})});OY.displayName=dS;var[Yme,Qme]=EY(dS,{onClose(){}}),Jme=oe.forwardRef((e,t)=>{const{__scopeToast:r,type:n="foreground",duration:i,open:o,onClose:s,onEscapeKeyDown:a,onPause:u,onResume:d,onSwipeStart:m,onSwipeMove:g,onSwipeCancel:_,onSwipeEnd:y,...M}=e,x=g5(dS,r),[E,T]=oe.useState(null),P=ea(t,ae=>T(ae)),C=oe.useRef(null),D=oe.useRef(null),L=i||x.duration,N=oe.useRef(0),j=oe.useRef(L),$=oe.useRef(0),{onToastAdd:U,onToastRemove:G}=x,H=Hu(()=>{var de;(E==null?void 0:E.contains(document.activeElement))&&((de=x.viewport)==null||de.focus()),s()}),X=oe.useCallback(ae=>{!ae||ae===1/0||(window.clearTimeout($.current),N.current=new Date().getTime(),$.current=window.setTimeout(H,ae))},[H]);oe.useEffect(()=>{const ae=x.viewport;if(ae){const de=()=>{X(j.current),d==null||d()},ye=()=>{const _e=new Date().getTime()-N.current;j.current=j.current-_e,window.clearTimeout($.current),u==null||u()};return ae.addEventListener(ZL,ye),ae.addEventListener(XL,de),()=>{ae.removeEventListener(ZL,ye),ae.removeEventListener(XL,de)}}},[x.viewport,L,u,d,X]),oe.useEffect(()=>{o&&!x.isClosePausedRef.current&&X(L)},[o,L,x.isClosePausedRef,X]),oe.useEffect(()=>(U(),()=>G()),[U,G]);const ee=oe.useMemo(()=>E?FY(E):null,[E]);return x.viewport?F.jsxs(F.Fragment,{children:[ee&&F.jsx(ege,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite","aria-atomic":!0,children:ee}),F.jsx(Yme,{scope:r,onClose:H,children:C0.createPortal(F.jsx(Y4.ItemSlot,{scope:r,children:F.jsx(Ome,{asChild:!0,onEscapeKeyDown:In(a,()=>{x.isFocusedToastEscapeKeyDownRef.current||H(),x.isFocusedToastEscapeKeyDownRef.current=!1}),children:F.jsx(Ei.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":o?"open":"closed","data-swipe-direction":x.swipeDirection,...M,ref:P,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:In(e.onKeyDown,ae=>{ae.key==="Escape"&&(a==null||a(ae.nativeEvent),ae.nativeEvent.defaultPrevented||(x.isFocusedToastEscapeKeyDownRef.current=!0,H()))}),onPointerDown:In(e.onPointerDown,ae=>{ae.button===0&&(C.current={x:ae.clientX,y:ae.clientY})}),onPointerMove:In(e.onPointerMove,ae=>{if(!C.current)return;const de=ae.clientX-C.current.x,ye=ae.clientY-C.current.y,_e=!!D.current,ue=["left","right"].includes(x.swipeDirection),fe=["left","up"].includes(x.swipeDirection)?Math.min:Math.max,De=ue?fe(0,de):0,pe=ue?0:fe(0,ye),K=ae.pointerType==="touch"?10:2,te={x:De,y:pe},ve={originalEvent:ae,delta:te};_e?(D.current=te,hP(Kme,g,ve,{discrete:!1})):$B(te,x.swipeDirection,K)?(D.current=te,hP(Hme,m,ve,{discrete:!1}),ae.target.setPointerCapture(ae.pointerId)):(Math.abs(de)>K||Math.abs(ye)>K)&&(C.current=null)}),onPointerUp:In(e.onPointerUp,ae=>{const de=D.current,ye=ae.target;if(ye.hasPointerCapture(ae.pointerId)&&ye.releasePointerCapture(ae.pointerId),D.current=null,C.current=null,de){const _e=ae.currentTarget,ue={originalEvent:ae,delta:de};$B(de,x.swipeDirection,x.swipeThreshold)?hP(Xme,y,ue,{discrete:!0}):hP(Zme,_,ue,{discrete:!0}),_e.addEventListener("click",fe=>fe.preventDefault(),{once:!0})}})})})}),x.viewport)})]}):null}),ege=e=>{const{__scopeToast:t,children:r,...n}=e,i=g5(dS,t),[o,s]=oe.useState(!1),[a,u]=oe.useState(!1);return nge(()=>s(!0)),oe.useEffect(()=>{const d=window.setTimeout(()=>u(!0),1e3);return()=>window.clearTimeout(d)},[]),a?null:F.jsx(uS,{asChild:!0,children:F.jsx(m5,{...n,children:o&&F.jsxs(F.Fragment,{children:[i.label," ",r]})})})},tge="ToastTitle",LY=oe.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return F.jsx(Ei.div,{...n,ref:t})});LY.displayName=tge;var rge="ToastDescription",DY=oe.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return F.jsx(Ei.div,{...n,ref:t})});DY.displayName=rge;var $Y="ToastAction",NY=oe.forwardRef((e,t)=>{const{altText:r,...n}=e;return r.trim()?F.jsx(RY,{altText:r,asChild:!0,children:F.jsx(Q4,{...n,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${$Y}\`. Expected non-empty \`string\`.`),null)});NY.displayName=$Y;var jY="ToastClose",Q4=oe.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e,i=Qme(jY,r);return F.jsx(RY,{asChild:!0,children:F.jsx(Ei.button,{type:"button",...n,ref:t,onClick:In(e.onClick,i.onClose)})})});Q4.displayName=jY;var RY=oe.forwardRef((e,t)=>{const{__scopeToast:r,altText:n,...i}=e;return F.jsx(Ei.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...i,ref:t})});function FY(e){const t=[];return Array.from(e.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&t.push(n.textContent),ige(n)){const i=n.ariaHidden||n.hidden||n.style.display==="none",o=n.dataset.radixToastAnnounceExclude==="";if(!i)if(o){const s=n.dataset.radixToastAnnounceAlt;s&&t.push(s)}else t.push(...FY(n))}}),t}function hP(e,t,r,{discrete:n}){const i=r.originalEvent.currentTarget,o=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&i.addEventListener(e,t,{once:!0}),n?Z4(i,o):i.dispatchEvent(o)}var $B=(e,t,r=0)=>{const n=Math.abs(e.x),i=Math.abs(e.y),o=n>i;return t==="left"||t==="right"?o&&n>r:!o&&i>r};function nge(e=()=>{}){const t=Hu(e);Zl(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[t])}function ige(e){return e.nodeType===e.ELEMENT_NODE}function oge(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const i=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||i?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function MI(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var age=AY,zY=kY,BY=OY,UY=LY,VY=DY,WY=NY,GY=Q4;function qY(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(r=qY(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function Wi(){for(var e,t,r=0,n="",i=arguments.length;r<i;r++)(e=arguments[r])&&(t=qY(e))&&(n&&(n+=" "),n+=t);return n}const NB=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,jB=Wi,_5=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return jB(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:i,defaultVariants:o}=t,s=Object.keys(i).map(d=>{const m=r==null?void 0:r[d],g=o==null?void 0:o[d];if(m===null)return null;const _=NB(m)||NB(g);return i[d][_]}),a=r&&Object.entries(r).reduce((d,m)=>{let[g,_]=m;return _===void 0||(d[g]=_),d},{}),u=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((d,m)=>{let{class:g,className:_,...y}=m;return Object.entries(y).every(M=>{let[x,E]=M;return Array.isArray(E)?E.includes({...o,...a}[x]):{...o,...a}[x]===E})?[...d,g,_]:d},[]);return jB(e,s,u,r==null?void 0:r.class,r==null?void 0:r.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sge=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),HY=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var lge={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cge=oe.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:o,iconNode:s,...a},u)=>oe.createElement("svg",{ref:u,...lge,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:HY("lucide",i),...a},[...s.map(([d,m])=>oe.createElement(d,m)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ki=(e,t)=>{const r=oe.forwardRef(({className:n,...i},o)=>oe.createElement(cge,{ref:o,iconNode:t,className:HY(`lucide-${sge(e)}`,n),...i}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uge=Ki("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KY=Ki("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dge=Ki("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J4=Ki("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZY=Ki("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hge=Ki("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fge=Ki("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QL=Ki("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yd=Ki("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SI=Ki("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pge=Ki("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fA=Ki("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wE=Ki("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G2=Ki("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mge=Ki("Droplet",[["path",{d:"M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z",key:"c7niix"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gge=Ki("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RB=Ki("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FB=Ki("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _ge=Ki("FileClock",[["path",{d:"M16 22h2a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"37hlfg"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"8",cy:"16",r:"6",key:"10v15b"}],["path",{d:"M9.5 17.5 8 16.25V14",key:"1o80t2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yge=Ki("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w_=Ki("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vge=Ki("FileX",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m14.5 12.5-5 5",key:"b62r18"}],["path",{d:"m9.5 12.5 5 5",key:"1rk7el"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XY=Ki("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bge=Ki("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xge=Ki("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wge=Ki("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mge=Ki("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zB=Ki("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sge=Ki("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O_=Ki("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YY=Ki("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tge=Ki("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JL=Ki("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QY=Ki("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pge=Ki("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q2=Ki("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ME=Ki("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ej=Ki("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eD=Ki("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ege=Ki("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Age=Ki("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JY=Ki("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l0=Ki("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eQ=Ki("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),tj="-",Cge=e=>{const t=Ige(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:s=>{const a=s.split(tj);return a[0]===""&&a.length!==1&&a.shift(),tQ(a,t)||kge(s)},getConflictingClassGroupIds:(s,a)=>{const u=r[s]||[];return a&&n[s]?[...u,...n[s]]:u}}},tQ=(e,t)=>{var s;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),i=n?tQ(e.slice(1),n):void 0;if(i)return i;if(t.validators.length===0)return;const o=e.join(tj);return(s=t.validators.find(({validator:a})=>a(o)))==null?void 0:s.classGroupId},BB=/^\[(.+)\]$/,kge=e=>{if(BB.test(e)){const t=BB.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},Ige=e=>{const{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]};return Lge(Object.entries(e.classGroups),r).forEach(([o,s])=>{tD(s,n,o,t)}),n},tD=(e,t,r,n)=>{e.forEach(i=>{if(typeof i=="string"){const o=i===""?t:UB(t,i);o.classGroupId=r;return}if(typeof i=="function"){if(Oge(i)){tD(i(n),t,r,n);return}t.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(([o,s])=>{tD(s,UB(t,o),r,n)})})},UB=(e,t)=>{let r=e;return t.split(tj).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},Oge=e=>e.isThemeGetter,Lge=(e,t)=>t?e.map(([r,n])=>{const i=n.map(o=>typeof o=="string"?t+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(([s,a])=>[t+s,a])):o);return[r,i]}):e,Dge=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const i=(o,s)=>{r.set(o,s),t++,t>e&&(t=0,n=r,r=new Map)};return{get(o){let s=r.get(o);if(s!==void 0)return s;if((s=n.get(o))!==void 0)return i(o,s),s},set(o,s){r.has(o)?r.set(o,s):i(o,s)}}},rQ="!",$ge=e=>{const{separator:t,experimentalParseClassName:r}=e,n=t.length===1,i=t[0],o=t.length,s=a=>{const u=[];let d=0,m=0,g;for(let E=0;E<a.length;E++){let T=a[E];if(d===0){if(T===i&&(n||a.slice(E,E+o)===t)){u.push(a.slice(m,E)),m=E+o;continue}if(T==="/"){g=E;continue}}T==="["?d++:T==="]"&&d--}const _=u.length===0?a:a.substring(m),y=_.startsWith(rQ),M=y?_.substring(1):_,x=g&&g>m?g-m:void 0;return{modifiers:u,hasImportantModifier:y,baseClassName:M,maybePostfixModifierPosition:x}};return r?a=>r({className:a,parseClassName:s}):s},Nge=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(n=>{n[0]==="["?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t},jge=e=>({cache:Dge(e.cacheSize),parseClassName:$ge(e),...Cge(e)}),Rge=/\s+/,Fge=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:i}=t,o=[],s=e.trim().split(Rge);let a="";for(let u=s.length-1;u>=0;u-=1){const d=s[u],{modifiers:m,hasImportantModifier:g,baseClassName:_,maybePostfixModifierPosition:y}=r(d);let M=!!y,x=n(M?_.substring(0,y):_);if(!x){if(!M){a=d+(a.length>0?" "+a:a);continue}if(x=n(_),!x){a=d+(a.length>0?" "+a:a);continue}M=!1}const E=Nge(m).join(":"),T=g?E+rQ:E,P=T+x;if(o.includes(P))continue;o.push(P);const C=i(x,M);for(let D=0;D<C.length;++D){const L=C[D];o.push(T+L)}a=d+(a.length>0?" "+a:a)}return a};function zge(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=nQ(t))&&(n&&(n+=" "),n+=r);return n}const nQ=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=nQ(e[n]))&&(r&&(r+=" "),r+=t);return r};function Bge(e,...t){let r,n,i,o=s;function s(u){const d=t.reduce((m,g)=>g(m),e());return r=jge(d),n=r.cache.get,i=r.cache.set,o=a,a(u)}function a(u){const d=n(u);if(d)return d;const m=Fge(u,r);return i(u,m),m}return function(){return o(zge.apply(null,arguments))}}const gs=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},iQ=/^\[(?:([a-z-]+):)?(.+)\]$/i,Uge=/^\d+\/\d+$/,Vge=new Set(["px","full","screen"]),Wge=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Gge=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,qge=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Hge=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Kge=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,_m=e=>_1(e)||Vge.has(e)||Uge.test(e),Pg=e=>Ob(e,"length",r_e),_1=e=>!!e&&!Number.isNaN(Number(e)),TI=e=>Ob(e,"number",_1),pw=e=>!!e&&Number.isInteger(Number(e)),Zge=e=>e.endsWith("%")&&_1(e.slice(0,-1)),fo=e=>iQ.test(e),Eg=e=>Wge.test(e),Xge=new Set(["length","size","percentage"]),Yge=e=>Ob(e,Xge,oQ),Qge=e=>Ob(e,"position",oQ),Jge=new Set(["image","url"]),e_e=e=>Ob(e,Jge,i_e),t_e=e=>Ob(e,"",n_e),mw=()=>!0,Ob=(e,t,r)=>{const n=iQ.exec(e);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):r(n[2]):!1},r_e=e=>Gge.test(e)&&!qge.test(e),oQ=()=>!1,n_e=e=>Hge.test(e),i_e=e=>Kge.test(e),o_e=()=>{const e=gs("colors"),t=gs("spacing"),r=gs("blur"),n=gs("brightness"),i=gs("borderColor"),o=gs("borderRadius"),s=gs("borderSpacing"),a=gs("borderWidth"),u=gs("contrast"),d=gs("grayscale"),m=gs("hueRotate"),g=gs("invert"),_=gs("gap"),y=gs("gradientColorStops"),M=gs("gradientColorStopPositions"),x=gs("inset"),E=gs("margin"),T=gs("opacity"),P=gs("padding"),C=gs("saturate"),D=gs("scale"),L=gs("sepia"),N=gs("skew"),j=gs("space"),$=gs("translate"),U=()=>["auto","contain","none"],G=()=>["auto","hidden","clip","visible","scroll"],H=()=>["auto",fo,t],X=()=>[fo,t],ee=()=>["",_m,Pg],ae=()=>["auto",_1,fo],de=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],ye=()=>["solid","dashed","dotted","double","none"],_e=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ue=()=>["start","end","center","between","around","evenly","stretch"],fe=()=>["","0",fo],De=()=>["auto","avoid","all","avoid-page","page","left","right","column"],pe=()=>[_1,fo];return{cacheSize:500,separator:":",theme:{colors:[mw],spacing:[_m,Pg],blur:["none","",Eg,fo],brightness:pe(),borderColor:[e],borderRadius:["none","","full",Eg,fo],borderSpacing:X(),borderWidth:ee(),contrast:pe(),grayscale:fe(),hueRotate:pe(),invert:fe(),gap:X(),gradientColorStops:[e],gradientColorStopPositions:[Zge,Pg],inset:H(),margin:H(),opacity:pe(),padding:X(),saturate:pe(),scale:pe(),sepia:fe(),skew:pe(),space:X(),translate:X()},classGroups:{aspect:[{aspect:["auto","square","video",fo]}],container:["container"],columns:[{columns:[Eg]}],"break-after":[{"break-after":De()}],"break-before":[{"break-before":De()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...de(),fo]}],overflow:[{overflow:G()}],"overflow-x":[{"overflow-x":G()}],"overflow-y":[{"overflow-y":G()}],overscroll:[{overscroll:U()}],"overscroll-x":[{"overscroll-x":U()}],"overscroll-y":[{"overscroll-y":U()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[x]}],"inset-x":[{"inset-x":[x]}],"inset-y":[{"inset-y":[x]}],start:[{start:[x]}],end:[{end:[x]}],top:[{top:[x]}],right:[{right:[x]}],bottom:[{bottom:[x]}],left:[{left:[x]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",pw,fo]}],basis:[{basis:H()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",fo]}],grow:[{grow:fe()}],shrink:[{shrink:fe()}],order:[{order:["first","last","none",pw,fo]}],"grid-cols":[{"grid-cols":[mw]}],"col-start-end":[{col:["auto",{span:["full",pw,fo]},fo]}],"col-start":[{"col-start":ae()}],"col-end":[{"col-end":ae()}],"grid-rows":[{"grid-rows":[mw]}],"row-start-end":[{row:["auto",{span:[pw,fo]},fo]}],"row-start":[{"row-start":ae()}],"row-end":[{"row-end":ae()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",fo]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",fo]}],gap:[{gap:[_]}],"gap-x":[{"gap-x":[_]}],"gap-y":[{"gap-y":[_]}],"justify-content":[{justify:["normal",...ue()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...ue(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...ue(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[P]}],px:[{px:[P]}],py:[{py:[P]}],ps:[{ps:[P]}],pe:[{pe:[P]}],pt:[{pt:[P]}],pr:[{pr:[P]}],pb:[{pb:[P]}],pl:[{pl:[P]}],m:[{m:[E]}],mx:[{mx:[E]}],my:[{my:[E]}],ms:[{ms:[E]}],me:[{me:[E]}],mt:[{mt:[E]}],mr:[{mr:[E]}],mb:[{mb:[E]}],ml:[{ml:[E]}],"space-x":[{"space-x":[j]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[j]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",fo,t]}],"min-w":[{"min-w":[fo,t,"min","max","fit"]}],"max-w":[{"max-w":[fo,t,"none","full","min","max","fit","prose",{screen:[Eg]},Eg]}],h:[{h:[fo,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[fo,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[fo,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[fo,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Eg,Pg]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",TI]}],"font-family":[{font:[mw]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",fo]}],"line-clamp":[{"line-clamp":["none",_1,TI]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",_m,fo]}],"list-image":[{"list-image":["none",fo]}],"list-style-type":[{list:["none","disc","decimal",fo]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[T]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[T]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ye(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",_m,Pg]}],"underline-offset":[{"underline-offset":["auto",_m,fo]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:X()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",fo]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",fo]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[T]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...de(),Qge]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Yge]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},e_e]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[M]}],"gradient-via-pos":[{via:[M]}],"gradient-to-pos":[{to:[M]}],"gradient-from":[{from:[y]}],"gradient-via":[{via:[y]}],"gradient-to":[{to:[y]}],rounded:[{rounded:[o]}],"rounded-s":[{"rounded-s":[o]}],"rounded-e":[{"rounded-e":[o]}],"rounded-t":[{"rounded-t":[o]}],"rounded-r":[{"rounded-r":[o]}],"rounded-b":[{"rounded-b":[o]}],"rounded-l":[{"rounded-l":[o]}],"rounded-ss":[{"rounded-ss":[o]}],"rounded-se":[{"rounded-se":[o]}],"rounded-ee":[{"rounded-ee":[o]}],"rounded-es":[{"rounded-es":[o]}],"rounded-tl":[{"rounded-tl":[o]}],"rounded-tr":[{"rounded-tr":[o]}],"rounded-br":[{"rounded-br":[o]}],"rounded-bl":[{"rounded-bl":[o]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[T]}],"border-style":[{border:[...ye(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[T]}],"divide-style":[{divide:ye()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...ye()]}],"outline-offset":[{"outline-offset":[_m,fo]}],"outline-w":[{outline:[_m,Pg]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:ee()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[T]}],"ring-offset-w":[{"ring-offset":[_m,Pg]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Eg,t_e]}],"shadow-color":[{shadow:[mw]}],opacity:[{opacity:[T]}],"mix-blend":[{"mix-blend":[..._e(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":_e()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[u]}],"drop-shadow":[{"drop-shadow":["","none",Eg,fo]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[m]}],invert:[{invert:[g]}],saturate:[{saturate:[C]}],sepia:[{sepia:[L]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[u]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[m]}],"backdrop-invert":[{"backdrop-invert":[g]}],"backdrop-opacity":[{"backdrop-opacity":[T]}],"backdrop-saturate":[{"backdrop-saturate":[C]}],"backdrop-sepia":[{"backdrop-sepia":[L]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[s]}],"border-spacing-x":[{"border-spacing-x":[s]}],"border-spacing-y":[{"border-spacing-y":[s]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",fo]}],duration:[{duration:pe()}],ease:[{ease:["linear","in","out","in-out",fo]}],delay:[{delay:pe()}],animate:[{animate:["none","spin","ping","pulse","bounce",fo]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[D]}],"scale-x":[{"scale-x":[D]}],"scale-y":[{"scale-y":[D]}],rotate:[{rotate:[pw,fo]}],"translate-x":[{"translate-x":[$]}],"translate-y":[{"translate-y":[$]}],"skew-x":[{"skew-x":[N]}],"skew-y":[{"skew-y":[N]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",fo]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",fo]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":X()}],"scroll-mx":[{"scroll-mx":X()}],"scroll-my":[{"scroll-my":X()}],"scroll-ms":[{"scroll-ms":X()}],"scroll-me":[{"scroll-me":X()}],"scroll-mt":[{"scroll-mt":X()}],"scroll-mr":[{"scroll-mr":X()}],"scroll-mb":[{"scroll-mb":X()}],"scroll-ml":[{"scroll-ml":X()}],"scroll-p":[{"scroll-p":X()}],"scroll-px":[{"scroll-px":X()}],"scroll-py":[{"scroll-py":X()}],"scroll-ps":[{"scroll-ps":X()}],"scroll-pe":[{"scroll-pe":X()}],"scroll-pt":[{"scroll-pt":X()}],"scroll-pr":[{"scroll-pr":X()}],"scroll-pb":[{"scroll-pb":X()}],"scroll-pl":[{"scroll-pl":X()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",fo]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[_m,Pg,TI]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},a_e=Bge(o_e);function _i(...e){return a_e(Wi(e))}const s_e=age,aQ=oe.forwardRef(({className:e,...t},r)=>F.jsx(zY,{ref:r,className:_i("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));aQ.displayName=zY.displayName;const l_e=_5("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),sQ=oe.forwardRef(({className:e,variant:t,...r},n)=>F.jsx(BY,{ref:n,className:_i(l_e({variant:t}),e),...r}));sQ.displayName=BY.displayName;const c_e=oe.forwardRef(({className:e,...t},r)=>F.jsx(WY,{ref:r,className:_i("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));c_e.displayName=WY.displayName;const lQ=oe.forwardRef(({className:e,...t},r)=>F.jsx(GY,{ref:r,className:_i("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:F.jsx(eQ,{className:"h-4 w-4"})}));lQ.displayName=GY.displayName;const cQ=oe.forwardRef(({className:e,...t},r)=>F.jsx(UY,{ref:r,className:_i("text-sm font-semibold",e),...t}));cQ.displayName=UY.displayName;const uQ=oe.forwardRef(({className:e,...t},r)=>F.jsx(VY,{ref:r,className:_i("text-sm opacity-90",e),...t}));uQ.displayName=VY.displayName;function u_e(){const{toasts:e}=cS();return F.jsxs(s_e,{children:[e.map(function({id:t,title:r,description:n,action:i,...o}){return F.jsxs(sQ,{...o,children:[F.jsxs("div",{className:"grid gap-1",children:[r&&F.jsx(cQ,{children:r}),n&&F.jsx(uQ,{children:n})]}),i,F.jsx(lQ,{})]},t)}),F.jsx(aQ,{})]})}var VB=["light","dark"],d_e="(prefers-color-scheme: dark)",h_e=oe.createContext(void 0),f_e={setTheme:e=>{},themes:[]},p_e=()=>{var e;return(e=oe.useContext(h_e))!=null?e:f_e};oe.memo(({forcedTheme:e,storageKey:t,attribute:r,enableSystem:n,enableColorScheme:i,defaultTheme:o,value:s,attrs:a,nonce:u})=>{let d=o==="system",m=r==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${a.map(M=>`'${M}'`).join(",")})`};`:`var d=document.documentElement,n='${r}',s='setAttribute';`,g=i?VB.includes(o)&&o?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${o}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",_=(M,x=!1,E=!0)=>{let T=s?s[M]:M,P=x?M+"|| ''":`'${T}'`,C="";return i&&E&&!x&&VB.includes(M)&&(C+=`d.style.colorScheme = '${M}';`),r==="class"?x||T?C+=`c.add(${P})`:C+="null":T&&(C+=`d[s](n,${P})`),C},y=e?`!function(){${m}${_(e)}}()`:n?`!function(){try{${m}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${d})){var t='${d_e}',m=window.matchMedia(t);if(m.media!==t||m.matches){${_("dark")}}else{${_("light")}}}else if(e){${s?`var x=${JSON.stringify(s)};`:""}${_(s?"x[e]":"e",!0)}}${d?"":"else{"+_(o,!1,!1)+"}"}${g}}catch(e){}}()`:`!function(){try{${m}var e=localStorage.getItem('${t}');if(e){${s?`var x=${JSON.stringify(s)};`:""}${_(s?"x[e]":"e",!0)}}else{${_(o,!1,!1)};}${g}}catch(t){}}();`;return oe.createElement("script",{nonce:u,dangerouslySetInnerHTML:{__html:y}})});var m_e=e=>{switch(e){case"success":return y_e;case"info":return b_e;case"warning":return v_e;case"error":return x_e;default:return null}},g_e=Array(12).fill(0),__e=({visible:e,className:t})=>ct.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},ct.createElement("div",{className:"sonner-spinner"},g_e.map((r,n)=>ct.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),y_e=ct.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ct.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),v_e=ct.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},ct.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),b_e=ct.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ct.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),x_e=ct.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ct.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),w_e=ct.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},ct.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),ct.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),M_e=()=>{let[e,t]=ct.useState(document.hidden);return ct.useEffect(()=>{let r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),e},rD=1,S_e=class{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{let r=this.subscribers.indexOf(t);this.subscribers.splice(r,1)}),this.publish=t=>{this.subscribers.forEach(r=>r(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var r;let{message:n,...i}=t,o=typeof(t==null?void 0:t.id)=="number"||((r=t.id)==null?void 0:r.length)>0?t.id:rD++,s=this.toasts.find(u=>u.id===o),a=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(o)&&this.dismissedToasts.delete(o),s?this.toasts=this.toasts.map(u=>u.id===o?(this.publish({...u,...t,id:o,title:n}),{...u,...t,id:o,dismissible:a,title:n}):u):this.addToast({title:n,...i,dismissible:a,id:o}),o},this.dismiss=t=>(this.dismissedToasts.add(t),t||this.toasts.forEach(r=>{this.subscribers.forEach(n=>n({id:r.id,dismiss:!0}))}),this.subscribers.forEach(r=>r({id:t,dismiss:!0})),t),this.message=(t,r)=>this.create({...r,message:t}),this.error=(t,r)=>this.create({...r,message:t,type:"error"}),this.success=(t,r)=>this.create({...r,type:"success",message:t}),this.info=(t,r)=>this.create({...r,type:"info",message:t}),this.warning=(t,r)=>this.create({...r,type:"warning",message:t}),this.loading=(t,r)=>this.create({...r,type:"loading",message:t}),this.promise=(t,r)=>{if(!r)return;let n;r.loading!==void 0&&(n=this.create({...r,promise:t,type:"loading",message:r.loading,description:typeof r.description!="function"?r.description:void 0}));let i=t instanceof Promise?t:t(),o=n!==void 0,s,a=i.then(async d=>{if(s=["resolve",d],ct.isValidElement(d))o=!1,this.create({id:n,type:"default",message:d});else if(P_e(d)&&!d.ok){o=!1;let m=typeof r.error=="function"?await r.error(`HTTP error! status: ${d.status}`):r.error,g=typeof r.description=="function"?await r.description(`HTTP error! status: ${d.status}`):r.description;this.create({id:n,type:"error",message:m,description:g})}else if(r.success!==void 0){o=!1;let m=typeof r.success=="function"?await r.success(d):r.success,g=typeof r.description=="function"?await r.description(d):r.description;this.create({id:n,type:"success",message:m,description:g})}}).catch(async d=>{if(s=["reject",d],r.error!==void 0){o=!1;let m=typeof r.error=="function"?await r.error(d):r.error,g=typeof r.description=="function"?await r.description(d):r.description;this.create({id:n,type:"error",message:m,description:g})}}).finally(()=>{var d;o&&(this.dismiss(n),n=void 0),(d=r.finally)==null||d.call(r)}),u=()=>new Promise((d,m)=>a.then(()=>s[0]==="reject"?m(s[1]):d(s[1])).catch(m));return typeof n!="string"&&typeof n!="number"?{unwrap:u}:Object.assign(n,{unwrap:u})},this.custom=(t,r)=>{let n=(r==null?void 0:r.id)||rD++;return this.create({jsx:t(n),id:n,...r}),n},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},od=new S_e,T_e=(e,t)=>{let r=(t==null?void 0:t.id)||rD++;return od.addToast({title:e,...t,id:r}),r},P_e=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",E_e=T_e,A_e=()=>od.toasts,C_e=()=>od.getActiveToasts();Object.assign(E_e,{success:od.success,info:od.info,warning:od.warning,error:od.error,custom:od.custom,message:od.message,promise:od.promise,dismiss:od.dismiss,loading:od.loading},{getHistory:A_e,getToasts:C_e});function k_e(e,{insertAt:t}={}){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t==="top"&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}k_e(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function fP(e){return e.label!==void 0}var I_e=3,O_e="32px",L_e="16px",WB=4e3,D_e=356,$_e=14,N_e=20,j_e=200;function pf(...e){return e.filter(Boolean).join(" ")}function R_e(e){let[t,r]=e.split("-"),n=[];return t&&n.push(t),r&&n.push(r),n}var F_e=e=>{var t,r,n,i,o,s,a,u,d,m,g;let{invert:_,toast:y,unstyled:M,interacting:x,setHeights:E,visibleToasts:T,heights:P,index:C,toasts:D,expanded:L,removeToast:N,defaultRichColors:j,closeButton:$,style:U,cancelButtonStyle:G,actionButtonStyle:H,className:X="",descriptionClassName:ee="",duration:ae,position:de,gap:ye,loadingIcon:_e,expandByDefault:ue,classNames:fe,icons:De,closeButtonAriaLabel:pe="Close toast",pauseWhenPageIsHidden:K}=e,[te,ve]=ct.useState(null),[$e,Ce]=ct.useState(null),[Ge,ot]=ct.useState(!1),[Ye,et]=ct.useState(!1),[Te,Le]=ct.useState(!1),[ke,Xe]=ct.useState(!1),[Ne,Ot]=ct.useState(!1),[Lt,kt]=ct.useState(0),[mt,Zt]=ct.useState(0),Kt=ct.useRef(y.duration||ae||WB),dr=ct.useRef(null),Bt=ct.useRef(null),wr=C===0,mr=C+1<=T,hr=y.type,xr=y.dismissible!==!1,or=y.className||"",tt=y.descriptionClassName||"",Se=ct.useMemo(()=>P.findIndex(Ir=>Ir.toastId===y.id)||0,[P,y.id]),Pe=ct.useMemo(()=>{var Ir;return(Ir=y.closeButton)!=null?Ir:$},[y.closeButton,$]),Ve=ct.useMemo(()=>y.duration||ae||WB,[y.duration,ae]),Qe=ct.useRef(0),dt=ct.useRef(0),Pt=ct.useRef(0),Vt=ct.useRef(null),[At,qt]=de.split("-"),er=ct.useMemo(()=>P.reduce((Ir,Xr,qr)=>qr>=Se?Ir:Ir+Xr.height,0),[P,Se]),fr=M_e(),Jr=y.invert||_,$t=hr==="loading";dt.current=ct.useMemo(()=>Se*ye+er,[Se,er]),ct.useEffect(()=>{Kt.current=Ve},[Ve]),ct.useEffect(()=>{ot(!0)},[]),ct.useEffect(()=>{let Ir=Bt.current;if(Ir){let Xr=Ir.getBoundingClientRect().height;return Zt(Xr),E(qr=>[{toastId:y.id,height:Xr,position:y.position},...qr]),()=>E(qr=>qr.filter(An=>An.toastId!==y.id))}},[E,y.id]),ct.useLayoutEffect(()=>{if(!Ge)return;let Ir=Bt.current,Xr=Ir.style.height;Ir.style.height="auto";let qr=Ir.getBoundingClientRect().height;Ir.style.height=Xr,Zt(qr),E(An=>An.find(ge=>ge.toastId===y.id)?An.map(ge=>ge.toastId===y.id?{...ge,height:qr}:ge):[{toastId:y.id,height:qr,position:y.position},...An])},[Ge,y.title,y.description,E,y.id]);let zr=ct.useCallback(()=>{et(!0),kt(dt.current),E(Ir=>Ir.filter(Xr=>Xr.toastId!==y.id)),setTimeout(()=>{N(y)},j_e)},[y,N,E,dt]);ct.useEffect(()=>{if(y.promise&&hr==="loading"||y.duration===1/0||y.type==="loading")return;let Ir;return L||x||K&&fr?(()=>{if(Pt.current<Qe.current){let Xr=new Date().getTime()-Qe.current;Kt.current=Kt.current-Xr}Pt.current=new Date().getTime()})():Kt.current!==1/0&&(Qe.current=new Date().getTime(),Ir=setTimeout(()=>{var Xr;(Xr=y.onAutoClose)==null||Xr.call(y,y),zr()},Kt.current)),()=>clearTimeout(Ir)},[L,x,y,hr,K,fr,zr]),ct.useEffect(()=>{y.delete&&zr()},[zr,y.delete]);function Sr(){var Ir,Xr,qr;return De!=null&&De.loading?ct.createElement("div",{className:pf(fe==null?void 0:fe.loader,(Ir=y==null?void 0:y.classNames)==null?void 0:Ir.loader,"sonner-loader"),"data-visible":hr==="loading"},De.loading):_e?ct.createElement("div",{className:pf(fe==null?void 0:fe.loader,(Xr=y==null?void 0:y.classNames)==null?void 0:Xr.loader,"sonner-loader"),"data-visible":hr==="loading"},_e):ct.createElement(__e,{className:pf(fe==null?void 0:fe.loader,(qr=y==null?void 0:y.classNames)==null?void 0:qr.loader),visible:hr==="loading"})}return ct.createElement("li",{tabIndex:0,ref:Bt,className:pf(X,or,fe==null?void 0:fe.toast,(t=y==null?void 0:y.classNames)==null?void 0:t.toast,fe==null?void 0:fe.default,fe==null?void 0:fe[hr],(r=y==null?void 0:y.classNames)==null?void 0:r[hr]),"data-sonner-toast":"","data-rich-colors":(n=y.richColors)!=null?n:j,"data-styled":!(y.jsx||y.unstyled||M),"data-mounted":Ge,"data-promise":!!y.promise,"data-swiped":Ne,"data-removed":Ye,"data-visible":mr,"data-y-position":At,"data-x-position":qt,"data-index":C,"data-front":wr,"data-swiping":Te,"data-dismissible":xr,"data-type":hr,"data-invert":Jr,"data-swipe-out":ke,"data-swipe-direction":$e,"data-expanded":!!(L||ue&&Ge),style:{"--index":C,"--toasts-before":C,"--z-index":D.length-C,"--offset":`${Ye?Lt:dt.current}px`,"--initial-height":ue?"auto":`${mt}px`,...U,...y.style},onDragEnd:()=>{Le(!1),ve(null),Vt.current=null},onPointerDown:Ir=>{$t||!xr||(dr.current=new Date,kt(dt.current),Ir.target.setPointerCapture(Ir.pointerId),Ir.target.tagName!=="BUTTON"&&(Le(!0),Vt.current={x:Ir.clientX,y:Ir.clientY}))},onPointerUp:()=>{var Ir,Xr,qr,An;if(ke||!xr)return;Vt.current=null;let ge=Number(((Ir=Bt.current)==null?void 0:Ir.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),ut=Number(((Xr=Bt.current)==null?void 0:Xr.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),We=new Date().getTime()-((qr=dr.current)==null?void 0:qr.getTime()),Je=te==="x"?ge:ut,xt=Math.abs(Je)/We;if(Math.abs(Je)>=N_e||xt>.11){kt(dt.current),(An=y.onDismiss)==null||An.call(y,y),Ce(te==="x"?ge>0?"right":"left":ut>0?"down":"up"),zr(),Xe(!0),Ot(!1);return}Le(!1),ve(null)},onPointerMove:Ir=>{var Xr,qr,An,ge;if(!Vt.current||!xr||((Xr=window.getSelection())==null?void 0:Xr.toString().length)>0)return;let ut=Ir.clientY-Vt.current.y,We=Ir.clientX-Vt.current.x,Je=(qr=e.swipeDirections)!=null?qr:R_e(de);!te&&(Math.abs(We)>1||Math.abs(ut)>1)&&ve(Math.abs(We)>Math.abs(ut)?"x":"y");let xt={x:0,y:0};te==="y"?(Je.includes("top")||Je.includes("bottom"))&&(Je.includes("top")&&ut<0||Je.includes("bottom")&&ut>0)&&(xt.y=ut):te==="x"&&(Je.includes("left")||Je.includes("right"))&&(Je.includes("left")&&We<0||Je.includes("right")&&We>0)&&(xt.x=We),(Math.abs(xt.x)>0||Math.abs(xt.y)>0)&&Ot(!0),(An=Bt.current)==null||An.style.setProperty("--swipe-amount-x",`${xt.x}px`),(ge=Bt.current)==null||ge.style.setProperty("--swipe-amount-y",`${xt.y}px`)}},Pe&&!y.jsx?ct.createElement("button",{"aria-label":pe,"data-disabled":$t,"data-close-button":!0,onClick:$t||!xr?()=>{}:()=>{var Ir;zr(),(Ir=y.onDismiss)==null||Ir.call(y,y)},className:pf(fe==null?void 0:fe.closeButton,(i=y==null?void 0:y.classNames)==null?void 0:i.closeButton)},(o=De==null?void 0:De.close)!=null?o:w_e):null,y.jsx||oe.isValidElement(y.title)?y.jsx?y.jsx:typeof y.title=="function"?y.title():y.title:ct.createElement(ct.Fragment,null,hr||y.icon||y.promise?ct.createElement("div",{"data-icon":"",className:pf(fe==null?void 0:fe.icon,(s=y==null?void 0:y.classNames)==null?void 0:s.icon)},y.promise||y.type==="loading"&&!y.icon?y.icon||Sr():null,y.type!=="loading"?y.icon||(De==null?void 0:De[hr])||m_e(hr):null):null,ct.createElement("div",{"data-content":"",className:pf(fe==null?void 0:fe.content,(a=y==null?void 0:y.classNames)==null?void 0:a.content)},ct.createElement("div",{"data-title":"",className:pf(fe==null?void 0:fe.title,(u=y==null?void 0:y.classNames)==null?void 0:u.title)},typeof y.title=="function"?y.title():y.title),y.description?ct.createElement("div",{"data-description":"",className:pf(ee,tt,fe==null?void 0:fe.description,(d=y==null?void 0:y.classNames)==null?void 0:d.description)},typeof y.description=="function"?y.description():y.description):null),oe.isValidElement(y.cancel)?y.cancel:y.cancel&&fP(y.cancel)?ct.createElement("button",{"data-button":!0,"data-cancel":!0,style:y.cancelButtonStyle||G,onClick:Ir=>{var Xr,qr;fP(y.cancel)&&xr&&((qr=(Xr=y.cancel).onClick)==null||qr.call(Xr,Ir),zr())},className:pf(fe==null?void 0:fe.cancelButton,(m=y==null?void 0:y.classNames)==null?void 0:m.cancelButton)},y.cancel.label):null,oe.isValidElement(y.action)?y.action:y.action&&fP(y.action)?ct.createElement("button",{"data-button":!0,"data-action":!0,style:y.actionButtonStyle||H,onClick:Ir=>{var Xr,qr;fP(y.action)&&((qr=(Xr=y.action).onClick)==null||qr.call(Xr,Ir),!Ir.defaultPrevented&&zr())},className:pf(fe==null?void 0:fe.actionButton,(g=y==null?void 0:y.classNames)==null?void 0:g.actionButton)},y.action.label):null))};function GB(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function z_e(e,t){let r={};return[e,t].forEach((n,i)=>{let o=i===1,s=o?"--mobile-offset":"--offset",a=o?L_e:O_e;function u(d){["top","right","bottom","left"].forEach(m=>{r[`${s}-${m}`]=typeof d=="number"?`${d}px`:d})}typeof n=="number"||typeof n=="string"?u(n):typeof n=="object"?["top","right","bottom","left"].forEach(d=>{n[d]===void 0?r[`${s}-${d}`]=a:r[`${s}-${d}`]=typeof n[d]=="number"?`${n[d]}px`:n[d]}):u(a)}),r}var B_e=oe.forwardRef(function(e,t){let{invert:r,position:n="bottom-right",hotkey:i=["altKey","KeyT"],expand:o,closeButton:s,className:a,offset:u,mobileOffset:d,theme:m="light",richColors:g,duration:_,style:y,visibleToasts:M=I_e,toastOptions:x,dir:E=GB(),gap:T=$_e,loadingIcon:P,icons:C,containerAriaLabel:D="Notifications",pauseWhenPageIsHidden:L}=e,[N,j]=ct.useState([]),$=ct.useMemo(()=>Array.from(new Set([n].concat(N.filter(K=>K.position).map(K=>K.position)))),[N,n]),[U,G]=ct.useState([]),[H,X]=ct.useState(!1),[ee,ae]=ct.useState(!1),[de,ye]=ct.useState(m!=="system"?m:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),_e=ct.useRef(null),ue=i.join("+").replace(/Key/g,"").replace(/Digit/g,""),fe=ct.useRef(null),De=ct.useRef(!1),pe=ct.useCallback(K=>{j(te=>{var ve;return(ve=te.find($e=>$e.id===K.id))!=null&&ve.delete||od.dismiss(K.id),te.filter(({id:$e})=>$e!==K.id)})},[]);return ct.useEffect(()=>od.subscribe(K=>{if(K.dismiss){j(te=>te.map(ve=>ve.id===K.id?{...ve,delete:!0}:ve));return}setTimeout(()=>{bY.flushSync(()=>{j(te=>{let ve=te.findIndex($e=>$e.id===K.id);return ve!==-1?[...te.slice(0,ve),{...te[ve],...K},...te.slice(ve+1)]:[K,...te]})})})}),[]),ct.useEffect(()=>{if(m!=="system"){ye(m);return}if(m==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?ye("dark"):ye("light")),typeof window>"u")return;let K=window.matchMedia("(prefers-color-scheme: dark)");try{K.addEventListener("change",({matches:te})=>{ye(te?"dark":"light")})}catch{K.addListener(({matches:ve})=>{try{ye(ve?"dark":"light")}catch($e){console.error($e)}})}},[m]),ct.useEffect(()=>{N.length<=1&&X(!1)},[N]),ct.useEffect(()=>{let K=te=>{var ve,$e;i.every(Ce=>te[Ce]||te.code===Ce)&&(X(!0),(ve=_e.current)==null||ve.focus()),te.code==="Escape"&&(document.activeElement===_e.current||($e=_e.current)!=null&&$e.contains(document.activeElement))&&X(!1)};return document.addEventListener("keydown",K),()=>document.removeEventListener("keydown",K)},[i]),ct.useEffect(()=>{if(_e.current)return()=>{fe.current&&(fe.current.focus({preventScroll:!0}),fe.current=null,De.current=!1)}},[_e.current]),ct.createElement("section",{ref:t,"aria-label":`${D} ${ue}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},$.map((K,te)=>{var ve;let[$e,Ce]=K.split("-");return N.length?ct.createElement("ol",{key:K,dir:E==="auto"?GB():E,tabIndex:-1,ref:_e,className:a,"data-sonner-toaster":!0,"data-theme":de,"data-y-position":$e,"data-lifted":H&&N.length>1&&!o,"data-x-position":Ce,style:{"--front-toast-height":`${((ve=U[0])==null?void 0:ve.height)||0}px`,"--width":`${D_e}px`,"--gap":`${T}px`,...y,...z_e(u,d)},onBlur:Ge=>{De.current&&!Ge.currentTarget.contains(Ge.relatedTarget)&&(De.current=!1,fe.current&&(fe.current.focus({preventScroll:!0}),fe.current=null))},onFocus:Ge=>{Ge.target instanceof HTMLElement&&Ge.target.dataset.dismissible==="false"||De.current||(De.current=!0,fe.current=Ge.relatedTarget)},onMouseEnter:()=>X(!0),onMouseMove:()=>X(!0),onMouseLeave:()=>{ee||X(!1)},onDragEnd:()=>X(!1),onPointerDown:Ge=>{Ge.target instanceof HTMLElement&&Ge.target.dataset.dismissible==="false"||ae(!0)},onPointerUp:()=>ae(!1)},N.filter(Ge=>!Ge.position&&te===0||Ge.position===K).map((Ge,ot)=>{var Ye,et;return ct.createElement(F_e,{key:Ge.id,icons:C,index:ot,toast:Ge,defaultRichColors:g,duration:(Ye=x==null?void 0:x.duration)!=null?Ye:_,className:x==null?void 0:x.className,descriptionClassName:x==null?void 0:x.descriptionClassName,invert:r,visibleToasts:M,closeButton:(et=x==null?void 0:x.closeButton)!=null?et:s,interacting:ee,position:K,style:x==null?void 0:x.style,unstyled:x==null?void 0:x.unstyled,classNames:x==null?void 0:x.classNames,cancelButtonStyle:x==null?void 0:x.cancelButtonStyle,actionButtonStyle:x==null?void 0:x.actionButtonStyle,removeToast:pe,toasts:N.filter(Te=>Te.position==Ge.position),heights:U.filter(Te=>Te.position==Ge.position),setHeights:G,expandByDefault:o,gap:T,loadingIcon:P,expanded:H,pauseWhenPageIsHidden:L,swipeDirections:e.swipeDirections})})):null}))});const U_e=({...e})=>{const{theme:t="system"}=p_e();return F.jsx(B_e,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};var V_e=i4[" useId ".trim().toString()]||(()=>{}),W_e=0;function jm(e){const[t,r]=oe.useState(V_e());return Zl(()=>{r(n=>n??String(W_e++))},[e]),t?`radix-${t}`:""}const G_e=["top","right","bottom","left"],M_=Math.min,Vd=Math.max,pA=Math.round,pP=Math.floor,jp=e=>({x:e,y:e}),q_e={left:"right",right:"left",bottom:"top",top:"bottom"},H_e={start:"end",end:"start"};function nD(e,t,r){return Vd(e,M_(t,r))}function Wm(e,t){return typeof e=="function"?e(t):e}function Gm(e){return e.split("-")[0]}function Lb(e){return e.split("-")[1]}function rj(e){return e==="x"?"y":"x"}function nj(e){return e==="y"?"height":"width"}const K_e=new Set(["top","bottom"]);function Ip(e){return K_e.has(Gm(e))?"y":"x"}function ij(e){return rj(Ip(e))}function Z_e(e,t,r){r===void 0&&(r=!1);const n=Lb(e),i=ij(e),o=nj(i);let s=i==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[o]>t.floating[o]&&(s=mA(s)),[s,mA(s)]}function X_e(e){const t=mA(e);return[iD(e),t,iD(t)]}function iD(e){return e.replace(/start|end/g,t=>H_e[t])}const qB=["left","right"],HB=["right","left"],Y_e=["top","bottom"],Q_e=["bottom","top"];function J_e(e,t,r){switch(e){case"top":case"bottom":return r?t?HB:qB:t?qB:HB;case"left":case"right":return t?Y_e:Q_e;default:return[]}}function eye(e,t,r,n){const i=Lb(e);let o=J_e(Gm(e),r==="start",n);return i&&(o=o.map(s=>s+"-"+i),t&&(o=o.concat(o.map(iD)))),o}function mA(e){return e.replace(/left|right|bottom|top/g,t=>q_e[t])}function tye(e){return{top:0,right:0,bottom:0,left:0,...e}}function dQ(e){return typeof e!="number"?tye(e):{top:e,right:e,bottom:e,left:e}}function gA(e){const{x:t,y:r,width:n,height:i}=e;return{width:n,height:i,top:r,left:t,right:t+n,bottom:r+i,x:t,y:r}}function KB(e,t,r){let{reference:n,floating:i}=e;const o=Ip(t),s=ij(t),a=nj(s),u=Gm(t),d=o==="y",m=n.x+n.width/2-i.width/2,g=n.y+n.height/2-i.height/2,_=n[a]/2-i[a]/2;let y;switch(u){case"top":y={x:m,y:n.y-i.height};break;case"bottom":y={x:m,y:n.y+n.height};break;case"right":y={x:n.x+n.width,y:g};break;case"left":y={x:n.x-i.width,y:g};break;default:y={x:n.x,y:n.y}}switch(Lb(t)){case"start":y[s]-=_*(r&&d?-1:1);break;case"end":y[s]+=_*(r&&d?-1:1);break}return y}const rye=async(e,t,r)=>{const{placement:n="bottom",strategy:i="absolute",middleware:o=[],platform:s}=r,a=o.filter(Boolean),u=await(s.isRTL==null?void 0:s.isRTL(t));let d=await s.getElementRects({reference:e,floating:t,strategy:i}),{x:m,y:g}=KB(d,n,u),_=n,y={},M=0;for(let x=0;x<a.length;x++){const{name:E,fn:T}=a[x],{x:P,y:C,data:D,reset:L}=await T({x:m,y:g,initialPlacement:n,placement:_,strategy:i,middlewareData:y,rects:d,platform:s,elements:{reference:e,floating:t}});m=P??m,g=C??g,y={...y,[E]:{...y[E],...D}},L&&M<=50&&(M++,typeof L=="object"&&(L.placement&&(_=L.placement),L.rects&&(d=L.rects===!0?await s.getElementRects({reference:e,floating:t,strategy:i}):L.rects),{x:m,y:g}=KB(d,_,u)),x=-1)}return{x:m,y:g,placement:_,strategy:i,middlewareData:y}};async function H2(e,t){var r;t===void 0&&(t={});const{x:n,y:i,platform:o,rects:s,elements:a,strategy:u}=e,{boundary:d="clippingAncestors",rootBoundary:m="viewport",elementContext:g="floating",altBoundary:_=!1,padding:y=0}=Wm(t,e),M=dQ(y),E=a[_?g==="floating"?"reference":"floating":g],T=gA(await o.getClippingRect({element:(r=await(o.isElement==null?void 0:o.isElement(E)))==null||r?E:E.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(a.floating)),boundary:d,rootBoundary:m,strategy:u})),P=g==="floating"?{x:n,y:i,width:s.floating.width,height:s.floating.height}:s.reference,C=await(o.getOffsetParent==null?void 0:o.getOffsetParent(a.floating)),D=await(o.isElement==null?void 0:o.isElement(C))?await(o.getScale==null?void 0:o.getScale(C))||{x:1,y:1}:{x:1,y:1},L=gA(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:P,offsetParent:C,strategy:u}):P);return{top:(T.top-L.top+M.top)/D.y,bottom:(L.bottom-T.bottom+M.bottom)/D.y,left:(T.left-L.left+M.left)/D.x,right:(L.right-T.right+M.right)/D.x}}const nye=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:i,rects:o,platform:s,elements:a,middlewareData:u}=t,{element:d,padding:m=0}=Wm(e,t)||{};if(d==null)return{};const g=dQ(m),_={x:r,y:n},y=ij(i),M=nj(y),x=await s.getDimensions(d),E=y==="y",T=E?"top":"left",P=E?"bottom":"right",C=E?"clientHeight":"clientWidth",D=o.reference[M]+o.reference[y]-_[y]-o.floating[M],L=_[y]-o.reference[y],N=await(s.getOffsetParent==null?void 0:s.getOffsetParent(d));let j=N?N[C]:0;(!j||!await(s.isElement==null?void 0:s.isElement(N)))&&(j=a.floating[C]||o.floating[M]);const $=D/2-L/2,U=j/2-x[M]/2-1,G=M_(g[T],U),H=M_(g[P],U),X=G,ee=j-x[M]-H,ae=j/2-x[M]/2+$,de=nD(X,ae,ee),ye=!u.arrow&&Lb(i)!=null&&ae!==de&&o.reference[M]/2-(ae<X?G:H)-x[M]/2<0,_e=ye?ae<X?ae-X:ae-ee:0;return{[y]:_[y]+_e,data:{[y]:de,centerOffset:ae-de-_e,...ye&&{alignmentOffset:_e}},reset:ye}}}),iye=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:i,middlewareData:o,rects:s,initialPlacement:a,platform:u,elements:d}=t,{mainAxis:m=!0,crossAxis:g=!0,fallbackPlacements:_,fallbackStrategy:y="bestFit",fallbackAxisSideDirection:M="none",flipAlignment:x=!0,...E}=Wm(e,t);if((r=o.arrow)!=null&&r.alignmentOffset)return{};const T=Gm(i),P=Ip(a),C=Gm(a)===a,D=await(u.isRTL==null?void 0:u.isRTL(d.floating)),L=_||(C||!x?[mA(a)]:X_e(a)),N=M!=="none";!_&&N&&L.push(...eye(a,x,M,D));const j=[a,...L],$=await H2(t,E),U=[];let G=((n=o.flip)==null?void 0:n.overflows)||[];if(m&&U.push($[T]),g){const ae=Z_e(i,s,D);U.push($[ae[0]],$[ae[1]])}if(G=[...G,{placement:i,overflows:U}],!U.every(ae=>ae<=0)){var H,X;const ae=(((H=o.flip)==null?void 0:H.index)||0)+1,de=j[ae];if(de&&(!(g==="alignment"?P!==Ip(de):!1)||G.every(ue=>ue.overflows[0]>0&&Ip(ue.placement)===P)))return{data:{index:ae,overflows:G},reset:{placement:de}};let ye=(X=G.filter(_e=>_e.overflows[0]<=0).sort((_e,ue)=>_e.overflows[1]-ue.overflows[1])[0])==null?void 0:X.placement;if(!ye)switch(y){case"bestFit":{var ee;const _e=(ee=G.filter(ue=>{if(N){const fe=Ip(ue.placement);return fe===P||fe==="y"}return!0}).map(ue=>[ue.placement,ue.overflows.filter(fe=>fe>0).reduce((fe,De)=>fe+De,0)]).sort((ue,fe)=>ue[1]-fe[1])[0])==null?void 0:ee[0];_e&&(ye=_e);break}case"initialPlacement":ye=a;break}if(i!==ye)return{reset:{placement:ye}}}return{}}}};function ZB(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function XB(e){return G_e.some(t=>e[t]>=0)}const oye=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...i}=Wm(e,t);switch(n){case"referenceHidden":{const o=await H2(t,{...i,elementContext:"reference"}),s=ZB(o,r.reference);return{data:{referenceHiddenOffsets:s,referenceHidden:XB(s)}}}case"escaped":{const o=await H2(t,{...i,altBoundary:!0}),s=ZB(o,r.floating);return{data:{escapedOffsets:s,escaped:XB(s)}}}default:return{}}}}},hQ=new Set(["left","top"]);async function aye(e,t){const{placement:r,platform:n,elements:i}=e,o=await(n.isRTL==null?void 0:n.isRTL(i.floating)),s=Gm(r),a=Lb(r),u=Ip(r)==="y",d=hQ.has(s)?-1:1,m=o&&u?-1:1,g=Wm(t,e);let{mainAxis:_,crossAxis:y,alignmentAxis:M}=typeof g=="number"?{mainAxis:g,crossAxis:0,alignmentAxis:null}:{mainAxis:g.mainAxis||0,crossAxis:g.crossAxis||0,alignmentAxis:g.alignmentAxis};return a&&typeof M=="number"&&(y=a==="end"?M*-1:M),u?{x:y*m,y:_*d}:{x:_*d,y:y*m}}const sye=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:i,y:o,placement:s,middlewareData:a}=t,u=await aye(t,e);return s===((r=a.offset)==null?void 0:r.placement)&&(n=a.arrow)!=null&&n.alignmentOffset?{}:{x:i+u.x,y:o+u.y,data:{...u,placement:s}}}}},lye=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:i}=t,{mainAxis:o=!0,crossAxis:s=!1,limiter:a={fn:E=>{let{x:T,y:P}=E;return{x:T,y:P}}},...u}=Wm(e,t),d={x:r,y:n},m=await H2(t,u),g=Ip(Gm(i)),_=rj(g);let y=d[_],M=d[g];if(o){const E=_==="y"?"top":"left",T=_==="y"?"bottom":"right",P=y+m[E],C=y-m[T];y=nD(P,y,C)}if(s){const E=g==="y"?"top":"left",T=g==="y"?"bottom":"right",P=M+m[E],C=M-m[T];M=nD(P,M,C)}const x=a.fn({...t,[_]:y,[g]:M});return{...x,data:{x:x.x-r,y:x.y-n,enabled:{[_]:o,[g]:s}}}}}},cye=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:i,rects:o,middlewareData:s}=t,{offset:a=0,mainAxis:u=!0,crossAxis:d=!0}=Wm(e,t),m={x:r,y:n},g=Ip(i),_=rj(g);let y=m[_],M=m[g];const x=Wm(a,t),E=typeof x=="number"?{mainAxis:x,crossAxis:0}:{mainAxis:0,crossAxis:0,...x};if(u){const C=_==="y"?"height":"width",D=o.reference[_]-o.floating[C]+E.mainAxis,L=o.reference[_]+o.reference[C]-E.mainAxis;y<D?y=D:y>L&&(y=L)}if(d){var T,P;const C=_==="y"?"width":"height",D=hQ.has(Gm(i)),L=o.reference[g]-o.floating[C]+(D&&((T=s.offset)==null?void 0:T[g])||0)+(D?0:E.crossAxis),N=o.reference[g]+o.reference[C]+(D?0:((P=s.offset)==null?void 0:P[g])||0)-(D?E.crossAxis:0);M<L?M=L:M>N&&(M=N)}return{[_]:y,[g]:M}}}},uye=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:i,rects:o,platform:s,elements:a}=t,{apply:u=()=>{},...d}=Wm(e,t),m=await H2(t,d),g=Gm(i),_=Lb(i),y=Ip(i)==="y",{width:M,height:x}=o.floating;let E,T;g==="top"||g==="bottom"?(E=g,T=_===(await(s.isRTL==null?void 0:s.isRTL(a.floating))?"start":"end")?"left":"right"):(T=g,E=_==="end"?"top":"bottom");const P=x-m.top-m.bottom,C=M-m.left-m.right,D=M_(x-m[E],P),L=M_(M-m[T],C),N=!t.middlewareData.shift;let j=D,$=L;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&($=C),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(j=P),N&&!_){const G=Vd(m.left,0),H=Vd(m.right,0),X=Vd(m.top,0),ee=Vd(m.bottom,0);y?$=M-2*(G!==0||H!==0?G+H:Vd(m.left,m.right)):j=x-2*(X!==0||ee!==0?X+ee:Vd(m.top,m.bottom))}await u({...t,availableWidth:$,availableHeight:j});const U=await s.getDimensions(a.floating);return M!==U.width||x!==U.height?{reset:{rects:!0}}:{}}}};function y5(){return typeof window<"u"}function Db(e){return fQ(e)?(e.nodeName||"").toLowerCase():"#document"}function Qd(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Zp(e){var t;return(t=(fQ(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function fQ(e){return y5()?e instanceof Node||e instanceof Qd(e).Node:!1}function Uf(e){return y5()?e instanceof Element||e instanceof Qd(e).Element:!1}function Hp(e){return y5()?e instanceof HTMLElement||e instanceof Qd(e).HTMLElement:!1}function YB(e){return!y5()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Qd(e).ShadowRoot}const dye=new Set(["inline","contents"]);function hS(e){const{overflow:t,overflowX:r,overflowY:n,display:i}=Vf(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!dye.has(i)}const hye=new Set(["table","td","th"]);function fye(e){return hye.has(Db(e))}const pye=[":popover-open",":modal"];function v5(e){return pye.some(t=>{try{return e.matches(t)}catch{return!1}})}const mye=["transform","translate","scale","rotate","perspective"],gye=["transform","translate","scale","rotate","perspective","filter"],_ye=["paint","layout","strict","content"];function oj(e){const t=aj(),r=Uf(e)?Vf(e):e;return mye.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||gye.some(n=>(r.willChange||"").includes(n))||_ye.some(n=>(r.contain||"").includes(n))}function yye(e){let t=S_(e);for(;Hp(t)&&!q1(t);){if(oj(t))return t;if(v5(t))return null;t=S_(t)}return null}function aj(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const vye=new Set(["html","body","#document"]);function q1(e){return vye.has(Db(e))}function Vf(e){return Qd(e).getComputedStyle(e)}function b5(e){return Uf(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function S_(e){if(Db(e)==="html")return e;const t=e.assignedSlot||e.parentNode||YB(e)&&e.host||Zp(e);return YB(t)?t.host:t}function pQ(e){const t=S_(e);return q1(t)?e.ownerDocument?e.ownerDocument.body:e.body:Hp(t)&&hS(t)?t:pQ(t)}function K2(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const i=pQ(e),o=i===((n=e.ownerDocument)==null?void 0:n.body),s=Qd(i);if(o){const a=oD(s);return t.concat(s,s.visualViewport||[],hS(i)?i:[],a&&r?K2(a):[])}return t.concat(i,K2(i,[],r))}function oD(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function mQ(e){const t=Vf(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const i=Hp(e),o=i?e.offsetWidth:r,s=i?e.offsetHeight:n,a=pA(r)!==o||pA(n)!==s;return a&&(r=o,n=s),{width:r,height:n,$:a}}function sj(e){return Uf(e)?e:e.contextElement}function y1(e){const t=sj(e);if(!Hp(t))return jp(1);const r=t.getBoundingClientRect(),{width:n,height:i,$:o}=mQ(t);let s=(o?pA(r.width):r.width)/n,a=(o?pA(r.height):r.height)/i;return(!s||!Number.isFinite(s))&&(s=1),(!a||!Number.isFinite(a))&&(a=1),{x:s,y:a}}const bye=jp(0);function gQ(e){const t=Qd(e);return!aj()||!t.visualViewport?bye:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function xye(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==Qd(e)?!1:t}function c0(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const i=e.getBoundingClientRect(),o=sj(e);let s=jp(1);t&&(n?Uf(n)&&(s=y1(n)):s=y1(e));const a=xye(o,r,n)?gQ(o):jp(0);let u=(i.left+a.x)/s.x,d=(i.top+a.y)/s.y,m=i.width/s.x,g=i.height/s.y;if(o){const _=Qd(o),y=n&&Uf(n)?Qd(n):n;let M=_,x=oD(M);for(;x&&n&&y!==M;){const E=y1(x),T=x.getBoundingClientRect(),P=Vf(x),C=T.left+(x.clientLeft+parseFloat(P.paddingLeft))*E.x,D=T.top+(x.clientTop+parseFloat(P.paddingTop))*E.y;u*=E.x,d*=E.y,m*=E.x,g*=E.y,u+=C,d+=D,M=Qd(x),x=oD(M)}}return gA({width:m,height:g,x:u,y:d})}function lj(e,t){const r=b5(e).scrollLeft;return t?t.left+r:c0(Zp(e)).left+r}function _Q(e,t,r){r===void 0&&(r=!1);const n=e.getBoundingClientRect(),i=n.left+t.scrollLeft-(r?0:lj(e,n)),o=n.top+t.scrollTop;return{x:i,y:o}}function wye(e){let{elements:t,rect:r,offsetParent:n,strategy:i}=e;const o=i==="fixed",s=Zp(n),a=t?v5(t.floating):!1;if(n===s||a&&o)return r;let u={scrollLeft:0,scrollTop:0},d=jp(1);const m=jp(0),g=Hp(n);if((g||!g&&!o)&&((Db(n)!=="body"||hS(s))&&(u=b5(n)),Hp(n))){const y=c0(n);d=y1(n),m.x=y.x+n.clientLeft,m.y=y.y+n.clientTop}const _=s&&!g&&!o?_Q(s,u,!0):jp(0);return{width:r.width*d.x,height:r.height*d.y,x:r.x*d.x-u.scrollLeft*d.x+m.x+_.x,y:r.y*d.y-u.scrollTop*d.y+m.y+_.y}}function Mye(e){return Array.from(e.getClientRects())}function Sye(e){const t=Zp(e),r=b5(e),n=e.ownerDocument.body,i=Vd(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),o=Vd(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let s=-r.scrollLeft+lj(e);const a=-r.scrollTop;return Vf(n).direction==="rtl"&&(s+=Vd(t.clientWidth,n.clientWidth)-i),{width:i,height:o,x:s,y:a}}function Tye(e,t){const r=Qd(e),n=Zp(e),i=r.visualViewport;let o=n.clientWidth,s=n.clientHeight,a=0,u=0;if(i){o=i.width,s=i.height;const d=aj();(!d||d&&t==="fixed")&&(a=i.offsetLeft,u=i.offsetTop)}return{width:o,height:s,x:a,y:u}}const Pye=new Set(["absolute","fixed"]);function Eye(e,t){const r=c0(e,!0,t==="fixed"),n=r.top+e.clientTop,i=r.left+e.clientLeft,o=Hp(e)?y1(e):jp(1),s=e.clientWidth*o.x,a=e.clientHeight*o.y,u=i*o.x,d=n*o.y;return{width:s,height:a,x:u,y:d}}function QB(e,t,r){let n;if(t==="viewport")n=Tye(e,r);else if(t==="document")n=Sye(Zp(e));else if(Uf(t))n=Eye(t,r);else{const i=gQ(e);n={x:t.x-i.x,y:t.y-i.y,width:t.width,height:t.height}}return gA(n)}function yQ(e,t){const r=S_(e);return r===t||!Uf(r)||q1(r)?!1:Vf(r).position==="fixed"||yQ(r,t)}function Aye(e,t){const r=t.get(e);if(r)return r;let n=K2(e,[],!1).filter(a=>Uf(a)&&Db(a)!=="body"),i=null;const o=Vf(e).position==="fixed";let s=o?S_(e):e;for(;Uf(s)&&!q1(s);){const a=Vf(s),u=oj(s);!u&&a.position==="fixed"&&(i=null),(o?!u&&!i:!u&&a.position==="static"&&!!i&&Pye.has(i.position)||hS(s)&&!u&&yQ(e,s))?n=n.filter(m=>m!==s):i=a,s=S_(s)}return t.set(e,n),n}function Cye(e){let{element:t,boundary:r,rootBoundary:n,strategy:i}=e;const s=[...r==="clippingAncestors"?v5(t)?[]:Aye(t,this._c):[].concat(r),n],a=s[0],u=s.reduce((d,m)=>{const g=QB(t,m,i);return d.top=Vd(g.top,d.top),d.right=M_(g.right,d.right),d.bottom=M_(g.bottom,d.bottom),d.left=Vd(g.left,d.left),d},QB(t,a,i));return{width:u.right-u.left,height:u.bottom-u.top,x:u.left,y:u.top}}function kye(e){const{width:t,height:r}=mQ(e);return{width:t,height:r}}function Iye(e,t,r){const n=Hp(t),i=Zp(t),o=r==="fixed",s=c0(e,!0,o,t);let a={scrollLeft:0,scrollTop:0};const u=jp(0);function d(){u.x=lj(i)}if(n||!n&&!o)if((Db(t)!=="body"||hS(i))&&(a=b5(t)),n){const y=c0(t,!0,o,t);u.x=y.x+t.clientLeft,u.y=y.y+t.clientTop}else i&&d();o&&!n&&i&&d();const m=i&&!n&&!o?_Q(i,a):jp(0),g=s.left+a.scrollLeft-u.x-m.x,_=s.top+a.scrollTop-u.y-m.y;return{x:g,y:_,width:s.width,height:s.height}}function PI(e){return Vf(e).position==="static"}function JB(e,t){if(!Hp(e)||Vf(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return Zp(e)===r&&(r=r.ownerDocument.body),r}function vQ(e,t){const r=Qd(e);if(v5(e))return r;if(!Hp(e)){let i=S_(e);for(;i&&!q1(i);){if(Uf(i)&&!PI(i))return i;i=S_(i)}return r}let n=JB(e,t);for(;n&&fye(n)&&PI(n);)n=JB(n,t);return n&&q1(n)&&PI(n)&&!oj(n)?r:n||yye(e)||r}const Oye=async function(e){const t=this.getOffsetParent||vQ,r=this.getDimensions,n=await r(e.floating);return{reference:Iye(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function Lye(e){return Vf(e).direction==="rtl"}const Dye={convertOffsetParentRelativeRectToViewportRelativeRect:wye,getDocumentElement:Zp,getClippingRect:Cye,getOffsetParent:vQ,getElementRects:Oye,getClientRects:Mye,getDimensions:kye,getScale:y1,isElement:Uf,isRTL:Lye};function bQ(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function $ye(e,t){let r=null,n;const i=Zp(e);function o(){var a;clearTimeout(n),(a=r)==null||a.disconnect(),r=null}function s(a,u){a===void 0&&(a=!1),u===void 0&&(u=1),o();const d=e.getBoundingClientRect(),{left:m,top:g,width:_,height:y}=d;if(a||t(),!_||!y)return;const M=pP(g),x=pP(i.clientWidth-(m+_)),E=pP(i.clientHeight-(g+y)),T=pP(m),C={rootMargin:-M+"px "+-x+"px "+-E+"px "+-T+"px",threshold:Vd(0,M_(1,u))||1};let D=!0;function L(N){const j=N[0].intersectionRatio;if(j!==u){if(!D)return s();j?s(!1,j):n=setTimeout(()=>{s(!1,1e-7)},1e3)}j===1&&!bQ(d,e.getBoundingClientRect())&&s(),D=!1}try{r=new IntersectionObserver(L,{...C,root:i.ownerDocument})}catch{r=new IntersectionObserver(L,C)}r.observe(e)}return s(!0),o}function Nye(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:i=!0,ancestorResize:o=!0,elementResize:s=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:u=!1}=n,d=sj(e),m=i||o?[...d?K2(d):[],...K2(t)]:[];m.forEach(T=>{i&&T.addEventListener("scroll",r,{passive:!0}),o&&T.addEventListener("resize",r)});const g=d&&a?$ye(d,r):null;let _=-1,y=null;s&&(y=new ResizeObserver(T=>{let[P]=T;P&&P.target===d&&y&&(y.unobserve(t),cancelAnimationFrame(_),_=requestAnimationFrame(()=>{var C;(C=y)==null||C.observe(t)})),r()}),d&&!u&&y.observe(d),y.observe(t));let M,x=u?c0(e):null;u&&E();function E(){const T=c0(e);x&&!bQ(x,T)&&r(),x=T,M=requestAnimationFrame(E)}return r(),()=>{var T;m.forEach(P=>{i&&P.removeEventListener("scroll",r),o&&P.removeEventListener("resize",r)}),g==null||g(),(T=y)==null||T.disconnect(),y=null,u&&cancelAnimationFrame(M)}}const jye=sye,Rye=lye,Fye=iye,zye=uye,Bye=oye,e6=nye,Uye=cye,Vye=(e,t,r)=>{const n=new Map,i={platform:Dye,...r},o={...i.platform,_c:n};return rye(e,t,{...i,platform:o})};var Wye=typeof document<"u",Gye=function(){},SE=Wye?oe.useLayoutEffect:Gye;function _A(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,i;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!_A(e[n],t[n]))return!1;return!0}if(i=Object.keys(e),r=i.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,i[n]))return!1;for(n=r;n--!==0;){const o=i[n];if(!(o==="_owner"&&e.$$typeof)&&!_A(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}function xQ(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function t6(e,t){const r=xQ(e);return Math.round(t*r)/r}function EI(e){const t=oe.useRef(e);return SE(()=>{t.current=e}),t}function qye(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:i,elements:{reference:o,floating:s}={},transform:a=!0,whileElementsMounted:u,open:d}=e,[m,g]=oe.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[_,y]=oe.useState(n);_A(_,n)||y(n);const[M,x]=oe.useState(null),[E,T]=oe.useState(null),P=oe.useCallback(ue=>{ue!==N.current&&(N.current=ue,x(ue))},[]),C=oe.useCallback(ue=>{ue!==j.current&&(j.current=ue,T(ue))},[]),D=o||M,L=s||E,N=oe.useRef(null),j=oe.useRef(null),$=oe.useRef(m),U=u!=null,G=EI(u),H=EI(i),X=EI(d),ee=oe.useCallback(()=>{if(!N.current||!j.current)return;const ue={placement:t,strategy:r,middleware:_};H.current&&(ue.platform=H.current),Vye(N.current,j.current,ue).then(fe=>{const De={...fe,isPositioned:X.current!==!1};ae.current&&!_A($.current,De)&&($.current=De,C0.flushSync(()=>{g(De)}))})},[_,t,r,H,X]);SE(()=>{d===!1&&$.current.isPositioned&&($.current.isPositioned=!1,g(ue=>({...ue,isPositioned:!1})))},[d]);const ae=oe.useRef(!1);SE(()=>(ae.current=!0,()=>{ae.current=!1}),[]),SE(()=>{if(D&&(N.current=D),L&&(j.current=L),D&&L){if(G.current)return G.current(D,L,ee);ee()}},[D,L,ee,G,U]);const de=oe.useMemo(()=>({reference:N,floating:j,setReference:P,setFloating:C}),[P,C]),ye=oe.useMemo(()=>({reference:D,floating:L}),[D,L]),_e=oe.useMemo(()=>{const ue={position:r,left:0,top:0};if(!ye.floating)return ue;const fe=t6(ye.floating,m.x),De=t6(ye.floating,m.y);return a?{...ue,transform:"translate("+fe+"px, "+De+"px)",...xQ(ye.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:fe,top:De}},[r,a,ye.floating,m.x,m.y]);return oe.useMemo(()=>({...m,update:ee,refs:de,elements:ye,floatingStyles:_e}),[m,ee,de,ye,_e])}const Hye=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:i}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?e6({element:n.current,padding:i}).fn(r):{}:n?e6({element:n,padding:i}).fn(r):{}}}},Kye=(e,t)=>({...jye(e),options:[e,t]}),Zye=(e,t)=>({...Rye(e),options:[e,t]}),Xye=(e,t)=>({...Uye(e),options:[e,t]}),Yye=(e,t)=>({...Fye(e),options:[e,t]}),Qye=(e,t)=>({...zye(e),options:[e,t]}),Jye=(e,t)=>({...Bye(e),options:[e,t]}),e0e=(e,t)=>({...Hye(e),options:[e,t]});var t0e="Arrow",wQ=oe.forwardRef((e,t)=>{const{children:r,width:n=10,height:i=5,...o}=e;return F.jsx(Ei.svg,{...o,ref:t,width:n,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:F.jsx("polygon",{points:"0,0 30,0 15,10"})})});wQ.displayName=t0e;var r0e=wQ;function MQ(e){const[t,r]=oe.useState(void 0);return Zl(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const o=i[0];let s,a;if("borderBoxSize"in o){const u=o.borderBoxSize,d=Array.isArray(u)?u[0]:u;s=d.inlineSize,a=d.blockSize}else s=e.offsetWidth,a=e.offsetHeight;r({width:s,height:a})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var cj="Popper",[SQ,$b]=Bh(cj),[n0e,TQ]=SQ(cj),PQ=e=>{const{__scopePopper:t,children:r}=e,[n,i]=oe.useState(null);return F.jsx(n0e,{scope:t,anchor:n,onAnchorChange:i,children:r})};PQ.displayName=cj;var EQ="PopperAnchor",AQ=oe.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...i}=e,o=TQ(EQ,r),s=oe.useRef(null),a=ea(t,s);return oe.useEffect(()=>{o.onAnchorChange((n==null?void 0:n.current)||s.current)}),n?null:F.jsx(Ei.div,{...i,ref:a})});AQ.displayName=EQ;var uj="PopperContent",[i0e,o0e]=SQ(uj),CQ=oe.forwardRef((e,t)=>{var Ge,ot,Ye,et,Te,Le;const{__scopePopper:r,side:n="bottom",sideOffset:i=0,align:o="center",alignOffset:s=0,arrowPadding:a=0,avoidCollisions:u=!0,collisionBoundary:d=[],collisionPadding:m=0,sticky:g="partial",hideWhenDetached:_=!1,updatePositionStrategy:y="optimized",onPlaced:M,...x}=e,E=TQ(uj,r),[T,P]=oe.useState(null),C=ea(t,ke=>P(ke)),[D,L]=oe.useState(null),N=MQ(D),j=(N==null?void 0:N.width)??0,$=(N==null?void 0:N.height)??0,U=n+(o!=="center"?"-"+o:""),G=typeof m=="number"?m:{top:0,right:0,bottom:0,left:0,...m},H=Array.isArray(d)?d:[d],X=H.length>0,ee={padding:G,boundary:H.filter(s0e),altBoundary:X},{refs:ae,floatingStyles:de,placement:ye,isPositioned:_e,middlewareData:ue}=qye({strategy:"fixed",placement:U,whileElementsMounted:(...ke)=>Nye(...ke,{animationFrame:y==="always"}),elements:{reference:E.anchor},middleware:[Kye({mainAxis:i+$,alignmentAxis:s}),u&&Zye({mainAxis:!0,crossAxis:!1,limiter:g==="partial"?Xye():void 0,...ee}),u&&Yye({...ee}),Qye({...ee,apply:({elements:ke,rects:Xe,availableWidth:Ne,availableHeight:Ot})=>{const{width:Lt,height:kt}=Xe.reference,mt=ke.floating.style;mt.setProperty("--radix-popper-available-width",`${Ne}px`),mt.setProperty("--radix-popper-available-height",`${Ot}px`),mt.setProperty("--radix-popper-anchor-width",`${Lt}px`),mt.setProperty("--radix-popper-anchor-height",`${kt}px`)}}),D&&e0e({element:D,padding:a}),l0e({arrowWidth:j,arrowHeight:$}),_&&Jye({strategy:"referenceHidden",...ee})]}),[fe,De]=OQ(ye),pe=Hu(M);Zl(()=>{_e&&(pe==null||pe())},[_e,pe]);const K=(Ge=ue.arrow)==null?void 0:Ge.x,te=(ot=ue.arrow)==null?void 0:ot.y,ve=((Ye=ue.arrow)==null?void 0:Ye.centerOffset)!==0,[$e,Ce]=oe.useState();return Zl(()=>{T&&Ce(window.getComputedStyle(T).zIndex)},[T]),F.jsx("div",{ref:ae.setFloating,"data-radix-popper-content-wrapper":"",style:{...de,transform:_e?de.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:$e,"--radix-popper-transform-origin":[(et=ue.transformOrigin)==null?void 0:et.x,(Te=ue.transformOrigin)==null?void 0:Te.y].join(" "),...((Le=ue.hide)==null?void 0:Le.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:F.jsx(i0e,{scope:r,placedSide:fe,onArrowChange:L,arrowX:K,arrowY:te,shouldHideArrow:ve,children:F.jsx(Ei.div,{"data-side":fe,"data-align":De,...x,ref:C,style:{...x.style,animation:_e?void 0:"none"}})})})});CQ.displayName=uj;var kQ="PopperArrow",a0e={top:"bottom",right:"left",bottom:"top",left:"right"},IQ=oe.forwardRef(function(t,r){const{__scopePopper:n,...i}=t,o=o0e(kQ,n),s=a0e[o.placedSide];return F.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[s]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:F.jsx(r0e,{...i,ref:r,style:{...i.style,display:"block"}})})});IQ.displayName=kQ;function s0e(e){return e!==null}var l0e=e=>({name:"transformOrigin",options:e,fn(t){var E,T,P;const{placement:r,rects:n,middlewareData:i}=t,s=((E=i.arrow)==null?void 0:E.centerOffset)!==0,a=s?0:e.arrowWidth,u=s?0:e.arrowHeight,[d,m]=OQ(r),g={start:"0%",center:"50%",end:"100%"}[m],_=(((T=i.arrow)==null?void 0:T.x)??0)+a/2,y=(((P=i.arrow)==null?void 0:P.y)??0)+u/2;let M="",x="";return d==="bottom"?(M=s?g:`${_}px`,x=`${-u}px`):d==="top"?(M=s?g:`${_}px`,x=`${n.floating.height+u}px`):d==="right"?(M=`${-u}px`,x=s?g:`${y}px`):d==="left"&&(M=`${n.floating.width+u}px`,x=s?g:`${y}px`),{data:{x:M,y:x}}}});function OQ(e){const[t,r="center"]=e.split("-");return[t,r]}var LQ=PQ,dj=AQ,hj=CQ,fj=IQ,[x5,Eet]=Bh("Tooltip",[$b]),pj=$b(),DQ="TooltipProvider",c0e=700,r6="tooltip.open",[u0e,$Q]=x5(DQ),NQ=e=>{const{__scopeTooltip:t,delayDuration:r=c0e,skipDelayDuration:n=300,disableHoverableContent:i=!1,children:o}=e,s=oe.useRef(!0),a=oe.useRef(!1),u=oe.useRef(0);return oe.useEffect(()=>{const d=u.current;return()=>window.clearTimeout(d)},[]),F.jsx(u0e,{scope:t,isOpenDelayedRef:s,delayDuration:r,onOpen:oe.useCallback(()=>{window.clearTimeout(u.current),s.current=!1},[]),onClose:oe.useCallback(()=>{window.clearTimeout(u.current),u.current=window.setTimeout(()=>s.current=!0,n)},[n]),isPointerInTransitRef:a,onPointerInTransitChange:oe.useCallback(d=>{a.current=d},[]),disableHoverableContent:i,children:o})};NQ.displayName=DQ;var jQ="Tooltip",[Aet,w5]=x5(jQ),aD="TooltipTrigger",d0e=oe.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,i=w5(aD,r),o=$Q(aD,r),s=pj(r),a=oe.useRef(null),u=ea(t,a,i.onTriggerChange),d=oe.useRef(!1),m=oe.useRef(!1),g=oe.useCallback(()=>d.current=!1,[]);return oe.useEffect(()=>()=>document.removeEventListener("pointerup",g),[g]),F.jsx(dj,{asChild:!0,...s,children:F.jsx(Ei.button,{"aria-describedby":i.open?i.contentId:void 0,"data-state":i.stateAttribute,...n,ref:u,onPointerMove:In(e.onPointerMove,_=>{_.pointerType!=="touch"&&!m.current&&!o.isPointerInTransitRef.current&&(i.onTriggerEnter(),m.current=!0)}),onPointerLeave:In(e.onPointerLeave,()=>{i.onTriggerLeave(),m.current=!1}),onPointerDown:In(e.onPointerDown,()=>{i.open&&i.onClose(),d.current=!0,document.addEventListener("pointerup",g,{once:!0})}),onFocus:In(e.onFocus,()=>{d.current||i.onOpen()}),onBlur:In(e.onBlur,i.onClose),onClick:In(e.onClick,i.onClose)})})});d0e.displayName=aD;var h0e="TooltipPortal",[Cet,f0e]=x5(h0e,{forceMount:void 0}),H1="TooltipContent",RQ=oe.forwardRef((e,t)=>{const r=f0e(H1,e.__scopeTooltip),{forceMount:n=r.forceMount,side:i="top",...o}=e,s=w5(H1,e.__scopeTooltip);return F.jsx(Hf,{present:n||s.open,children:s.disableHoverableContent?F.jsx(FQ,{side:i,...o,ref:t}):F.jsx(p0e,{side:i,...o,ref:t})})}),p0e=oe.forwardRef((e,t)=>{const r=w5(H1,e.__scopeTooltip),n=$Q(H1,e.__scopeTooltip),i=oe.useRef(null),o=ea(t,i),[s,a]=oe.useState(null),{trigger:u,onClose:d}=r,m=i.current,{onPointerInTransitChange:g}=n,_=oe.useCallback(()=>{a(null),g(!1)},[g]),y=oe.useCallback((M,x)=>{const E=M.currentTarget,T={x:M.clientX,y:M.clientY},P=v0e(T,E.getBoundingClientRect()),C=b0e(T,P),D=x0e(x.getBoundingClientRect()),L=M0e([...C,...D]);a(L),g(!0)},[g]);return oe.useEffect(()=>()=>_(),[_]),oe.useEffect(()=>{if(u&&m){const M=E=>y(E,m),x=E=>y(E,u);return u.addEventListener("pointerleave",M),m.addEventListener("pointerleave",x),()=>{u.removeEventListener("pointerleave",M),m.removeEventListener("pointerleave",x)}}},[u,m,y,_]),oe.useEffect(()=>{if(s){const M=x=>{const E=x.target,T={x:x.clientX,y:x.clientY},P=(u==null?void 0:u.contains(E))||(m==null?void 0:m.contains(E)),C=!w0e(T,s);P?_():C&&(_(),d())};return document.addEventListener("pointermove",M),()=>document.removeEventListener("pointermove",M)}},[u,m,s,d,_]),F.jsx(FQ,{...e,ref:o})}),[m0e,g0e]=x5(jQ,{isInside:!1}),_0e=bme("TooltipContent"),FQ=oe.forwardRef((e,t)=>{const{__scopeTooltip:r,children:n,"aria-label":i,onEscapeKeyDown:o,onPointerDownOutside:s,...a}=e,u=w5(H1,r),d=pj(r),{onClose:m}=u;return oe.useEffect(()=>(document.addEventListener(r6,m),()=>document.removeEventListener(r6,m)),[m]),oe.useEffect(()=>{if(u.trigger){const g=_=>{const y=_.target;y!=null&&y.contains(u.trigger)&&m()};return window.addEventListener("scroll",g,{capture:!0}),()=>window.removeEventListener("scroll",g,{capture:!0})}},[u.trigger,m]),F.jsx(Ib,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:o,onPointerDownOutside:s,onFocusOutside:g=>g.preventDefault(),onDismiss:m,children:F.jsxs(hj,{"data-state":u.stateAttribute,...d,...a,ref:t,style:{...a.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[F.jsx(_0e,{children:n}),F.jsx(m0e,{scope:r,isInside:!0,children:F.jsx(Ume,{id:u.contentId,role:"tooltip",children:i||n})})]})})});RQ.displayName=H1;var zQ="TooltipArrow",y0e=oe.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,i=pj(r);return g0e(zQ,r).isInside?null:F.jsx(fj,{...i,...n,ref:t})});y0e.displayName=zQ;function v0e(e,t){const r=Math.abs(t.top-e.y),n=Math.abs(t.bottom-e.y),i=Math.abs(t.right-e.x),o=Math.abs(t.left-e.x);switch(Math.min(r,n,i,o)){case o:return"left";case i:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function b0e(e,t,r=5){const n=[];switch(t){case"top":n.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":n.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":n.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":n.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r});break}return n}function x0e(e){const{top:t,right:r,bottom:n,left:i}=e;return[{x:i,y:t},{x:r,y:t},{x:r,y:n},{x:i,y:n}]}function w0e(e,t){const{x:r,y:n}=e;let i=!1;for(let o=0,s=t.length-1;o<t.length;s=o++){const a=t[o],u=t[s],d=a.x,m=a.y,g=u.x,_=u.y;m>n!=_>n&&r<(g-d)*(n-m)/(_-m)+d&&(i=!i)}return i}function M0e(e){const t=e.slice();return t.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),S0e(t)}function S0e(e){if(e.length<=1)return e.slice();const t=[];for(let n=0;n<e.length;n++){const i=e[n];for(;t.length>=2;){const o=t[t.length-1],s=t[t.length-2];if((o.x-s.x)*(i.y-s.y)>=(o.y-s.y)*(i.x-s.x))t.pop();else break}t.push(i)}t.pop();const r=[];for(let n=e.length-1;n>=0;n--){const i=e[n];for(;r.length>=2;){const o=r[r.length-1],s=r[r.length-2];if((o.x-s.x)*(i.y-s.y)>=(o.y-s.y)*(i.x-s.x))r.pop();else break}r.push(i)}return r.pop(),t.length===1&&r.length===1&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}var T0e=NQ,BQ=RQ;const P0e=T0e,E0e=oe.forwardRef(({className:e,sideOffset:t=4,...r},n)=>F.jsx(BQ,{ref:n,sideOffset:t,className:_i("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r}));E0e.displayName=BQ.displayName;var M5=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},S5=typeof window>"u"||"Deno"in globalThis;function Tf(){}function A0e(e,t){return typeof e=="function"?e(t):e}function C0e(e){return typeof e=="number"&&e>=0&&e!==1/0}function k0e(e,t){return Math.max(e+(t||0)-Date.now(),0)}function sD(e,t){return typeof e=="function"?e(t):e}function I0e(e,t){return typeof e=="function"?e(t):e}function n6(e,t){const{type:r="all",exact:n,fetchStatus:i,predicate:o,queryKey:s,stale:a}=e;if(s){if(n){if(t.queryHash!==mj(s,t.options))return!1}else if(!X2(t.queryKey,s))return!1}if(r!=="all"){const u=t.isActive();if(r==="active"&&!u||r==="inactive"&&u)return!1}return!(typeof a=="boolean"&&t.isStale()!==a||i&&i!==t.state.fetchStatus||o&&!o(t))}function i6(e,t){const{exact:r,status:n,predicate:i,mutationKey:o}=e;if(o){if(!t.options.mutationKey)return!1;if(r){if(Z2(t.options.mutationKey)!==Z2(o))return!1}else if(!X2(t.options.mutationKey,o))return!1}return!(n&&t.state.status!==n||i&&!i(t))}function mj(e,t){return((t==null?void 0:t.queryKeyHashFn)||Z2)(e)}function Z2(e){return JSON.stringify(e,(t,r)=>lD(r)?Object.keys(r).sort().reduce((n,i)=>(n[i]=r[i],n),{}):r)}function X2(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>X2(e[r],t[r])):!1}function UQ(e,t){if(e===t)return e;const r=o6(e)&&o6(t);if(r||lD(e)&&lD(t)){const n=r?e:Object.keys(e),i=n.length,o=r?t:Object.keys(t),s=o.length,a=r?[]:{},u=new Set(n);let d=0;for(let m=0;m<s;m++){const g=r?m:o[m];(!r&&u.has(g)||r)&&e[g]===void 0&&t[g]===void 0?(a[g]=void 0,d++):(a[g]=UQ(e[g],t[g]),a[g]===e[g]&&e[g]!==void 0&&d++)}return i===s&&d===i?e:a}return t}function o6(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function lD(e){if(!a6(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!a6(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function a6(e){return Object.prototype.toString.call(e)==="[object Object]"}function O0e(e){return new Promise(t=>{setTimeout(t,e)})}function L0e(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?UQ(e,t):t}function D0e(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function $0e(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var gj=Symbol();function VQ(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===gj?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var By,Kg,I1,eZ,N0e=(eZ=class extends M5{constructor(){super();oa(this,By);oa(this,Kg);oa(this,I1);to(this,I1,t=>{if(!S5&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){Br(this,Kg)||this.setEventListener(Br(this,I1))}onUnsubscribe(){var t;this.hasListeners()||((t=Br(this,Kg))==null||t.call(this),to(this,Kg,void 0))}setEventListener(t){var r;to(this,I1,t),(r=Br(this,Kg))==null||r.call(this),to(this,Kg,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){Br(this,By)!==t&&(to(this,By,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof Br(this,By)=="boolean"?Br(this,By):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},By=new WeakMap,Kg=new WeakMap,I1=new WeakMap,eZ),WQ=new N0e,O1,Zg,L1,tZ,j0e=(tZ=class extends M5{constructor(){super();oa(this,O1,!0);oa(this,Zg);oa(this,L1);to(this,L1,t=>{if(!S5&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){Br(this,Zg)||this.setEventListener(Br(this,L1))}onUnsubscribe(){var t;this.hasListeners()||((t=Br(this,Zg))==null||t.call(this),to(this,Zg,void 0))}setEventListener(t){var r;to(this,L1,t),(r=Br(this,Zg))==null||r.call(this),to(this,Zg,t(this.setOnline.bind(this)))}setOnline(t){Br(this,O1)!==t&&(to(this,O1,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return Br(this,O1)}},O1=new WeakMap,Zg=new WeakMap,L1=new WeakMap,tZ),yA=new j0e;function R0e(){let e,t;const r=new Promise((i,o)=>{e=i,t=o});r.status="pending",r.catch(()=>{});function n(i){Object.assign(r,i),delete r.resolve,delete r.reject}return r.resolve=i=>{n({status:"fulfilled",value:i}),e(i)},r.reject=i=>{n({status:"rejected",reason:i}),t(i)},r}function F0e(e){return Math.min(1e3*2**e,3e4)}function GQ(e){return(e??"online")==="online"?yA.isOnline():!0}var qQ=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function AI(e){return e instanceof qQ}function HQ(e){let t=!1,r=0,n=!1,i;const o=R0e(),s=x=>{var E;n||(_(new qQ(x)),(E=e.abort)==null||E.call(e))},a=()=>{t=!0},u=()=>{t=!1},d=()=>WQ.isFocused()&&(e.networkMode==="always"||yA.isOnline())&&e.canRun(),m=()=>GQ(e.networkMode)&&e.canRun(),g=x=>{var E;n||(n=!0,(E=e.onSuccess)==null||E.call(e,x),i==null||i(),o.resolve(x))},_=x=>{var E;n||(n=!0,(E=e.onError)==null||E.call(e,x),i==null||i(),o.reject(x))},y=()=>new Promise(x=>{var E;i=T=>{(n||d())&&x(T)},(E=e.onPause)==null||E.call(e)}).then(()=>{var x;i=void 0,n||(x=e.onContinue)==null||x.call(e)}),M=()=>{if(n)return;let x;const E=r===0?e.initialPromise:void 0;try{x=E??e.fn()}catch(T){x=Promise.reject(T)}Promise.resolve(x).then(g).catch(T=>{var N;if(n)return;const P=e.retry??(S5?0:3),C=e.retryDelay??F0e,D=typeof C=="function"?C(r,T):C,L=P===!0||typeof P=="number"&&r<P||typeof P=="function"&&P(r,T);if(t||!L){_(T);return}r++,(N=e.onFail)==null||N.call(e,r,T),O0e(D).then(()=>d()?void 0:y()).then(()=>{t?_(T):M()})})};return{promise:o,cancel:s,continue:()=>(i==null||i(),o),cancelRetry:a,continueRetry:u,canStart:m,start:()=>(m()?M():y().then(M),o)}}var z0e=e=>setTimeout(e,0);function B0e(){let e=[],t=0,r=a=>{a()},n=a=>{a()},i=z0e;const o=a=>{t?e.push(a):i(()=>{r(a)})},s=()=>{const a=e;e=[],a.length&&i(()=>{n(()=>{a.forEach(u=>{r(u)})})})};return{batch:a=>{let u;t++;try{u=a()}finally{t--,t||s()}return u},batchCalls:a=>(...u)=>{o(()=>{a(...u)})},schedule:o,setNotifyFunction:a=>{r=a},setBatchNotifyFunction:a=>{n=a},setScheduler:a=>{i=a}}}var zu=B0e(),Uy,rZ,KQ=(rZ=class{constructor(){oa(this,Uy)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),C0e(this.gcTime)&&to(this,Uy,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(S5?1/0:5*60*1e3))}clearGcTimeout(){Br(this,Uy)&&(clearTimeout(Br(this,Uy)),to(this,Uy,void 0))}},Uy=new WeakMap,rZ),D1,Vy,Sh,Wy,wu,rS,Gy,Pf,Mm,nZ,U0e=(nZ=class extends KQ{constructor(t){super();oa(this,Pf);oa(this,D1);oa(this,Vy);oa(this,Sh);oa(this,Wy);oa(this,wu);oa(this,rS);oa(this,Gy);to(this,Gy,!1),to(this,rS,t.defaultOptions),this.setOptions(t.options),this.observers=[],to(this,Wy,t.client),to(this,Sh,Br(this,Wy).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,to(this,D1,W0e(this.options)),this.state=t.state??Br(this,D1),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=Br(this,wu))==null?void 0:t.promise}setOptions(t){this.options={...Br(this,rS),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&Br(this,Sh).remove(this)}setData(t,r){const n=L0e(this.state.data,t,this.options);return mu(this,Pf,Mm).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){mu(this,Pf,Mm).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,i;const r=(n=Br(this,wu))==null?void 0:n.promise;return(i=Br(this,wu))==null||i.cancel(t),r?r.then(Tf).catch(Tf):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(Br(this,D1))}isActive(){return this.observers.some(t=>I0e(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===gj||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>sD(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!k0e(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=Br(this,wu))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=Br(this,wu))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),Br(this,Sh).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(Br(this,wu)&&(Br(this,Gy)?Br(this,wu).cancel({revert:!0}):Br(this,wu).cancelRetry()),this.scheduleGc()),Br(this,Sh).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||mu(this,Pf,Mm).call(this,{type:"invalidate"})}fetch(t,r){var d,m,g;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(Br(this,wu))return Br(this,wu).continueRetry(),Br(this,wu).promise}if(t&&this.setOptions(t),!this.options.queryFn){const _=this.observers.find(y=>y.options.queryFn);_&&this.setOptions(_.options)}const n=new AbortController,i=_=>{Object.defineProperty(_,"signal",{enumerable:!0,get:()=>(to(this,Gy,!0),n.signal)})},o=()=>{const _=VQ(this.options,r),M=(()=>{const x={client:Br(this,Wy),queryKey:this.queryKey,meta:this.meta};return i(x),x})();return to(this,Gy,!1),this.options.persister?this.options.persister(_,M,this):_(M)},a=(()=>{const _={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:Br(this,Wy),state:this.state,fetchFn:o};return i(_),_})();(d=this.options.behavior)==null||d.onFetch(a,this),to(this,Vy,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((m=a.fetchOptions)==null?void 0:m.meta))&&mu(this,Pf,Mm).call(this,{type:"fetch",meta:(g=a.fetchOptions)==null?void 0:g.meta});const u=_=>{var y,M,x,E;AI(_)&&_.silent||mu(this,Pf,Mm).call(this,{type:"error",error:_}),AI(_)||((M=(y=Br(this,Sh).config).onError)==null||M.call(y,_,this),(E=(x=Br(this,Sh).config).onSettled)==null||E.call(x,this.state.data,_,this)),this.scheduleGc()};return to(this,wu,HQ({initialPromise:r==null?void 0:r.initialPromise,fn:a.fetchFn,abort:n.abort.bind(n),onSuccess:_=>{var y,M,x,E;if(_===void 0){u(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(_)}catch(T){u(T);return}(M=(y=Br(this,Sh).config).onSuccess)==null||M.call(y,_,this),(E=(x=Br(this,Sh).config).onSettled)==null||E.call(x,_,this.state.error,this),this.scheduleGc()},onError:u,onFail:(_,y)=>{mu(this,Pf,Mm).call(this,{type:"failed",failureCount:_,error:y})},onPause:()=>{mu(this,Pf,Mm).call(this,{type:"pause"})},onContinue:()=>{mu(this,Pf,Mm).call(this,{type:"continue"})},retry:a.options.retry,retryDelay:a.options.retryDelay,networkMode:a.options.networkMode,canRun:()=>!0})),Br(this,wu).start()}},D1=new WeakMap,Vy=new WeakMap,Sh=new WeakMap,Wy=new WeakMap,wu=new WeakMap,rS=new WeakMap,Gy=new WeakMap,Pf=new WeakSet,Mm=function(t){const r=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...V0e(n.data,this.options),fetchMeta:t.meta??null};case"success":return to(this,Vy,void 0),{...n,data:t.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const i=t.error;return AI(i)&&i.revert&&Br(this,Vy)?{...Br(this,Vy),fetchStatus:"idle"}:{...n,error:i,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=r(this.state),zu.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),Br(this,Sh).notify({query:this,type:"updated",action:t})})},nZ);function V0e(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:GQ(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function W0e(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var Tp,iZ,G0e=(iZ=class extends M5{constructor(t={}){super();oa(this,Tp);this.config=t,to(this,Tp,new Map)}build(t,r,n){const i=r.queryKey,o=r.queryHash??mj(i,r);let s=this.get(o);return s||(s=new U0e({client:t,queryKey:i,queryHash:o,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(i)}),this.add(s)),s}add(t){Br(this,Tp).has(t.queryHash)||(Br(this,Tp).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=Br(this,Tp).get(t.queryHash);r&&(t.destroy(),r===t&&Br(this,Tp).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){zu.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return Br(this,Tp).get(t)}getAll(){return[...Br(this,Tp).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>n6(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>n6(t,n)):r}notify(t){zu.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){zu.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){zu.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Tp=new WeakMap,iZ),Pp,ju,qy,Ep,Lg,oZ,q0e=(oZ=class extends KQ{constructor(t){super();oa(this,Ep);oa(this,Pp);oa(this,ju);oa(this,qy);this.mutationId=t.mutationId,to(this,ju,t.mutationCache),to(this,Pp,[]),this.state=t.state||H0e(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){Br(this,Pp).includes(t)||(Br(this,Pp).push(t),this.clearGcTimeout(),Br(this,ju).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){to(this,Pp,Br(this,Pp).filter(r=>r!==t)),this.scheduleGc(),Br(this,ju).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){Br(this,Pp).length||(this.state.status==="pending"?this.scheduleGc():Br(this,ju).remove(this))}continue(){var t;return((t=Br(this,qy))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var o,s,a,u,d,m,g,_,y,M,x,E,T,P,C,D,L,N,j,$;const r=()=>{mu(this,Ep,Lg).call(this,{type:"continue"})};to(this,qy,HQ({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(U,G)=>{mu(this,Ep,Lg).call(this,{type:"failed",failureCount:U,error:G})},onPause:()=>{mu(this,Ep,Lg).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>Br(this,ju).canRun(this)}));const n=this.state.status==="pending",i=!Br(this,qy).canStart();try{if(n)r();else{mu(this,Ep,Lg).call(this,{type:"pending",variables:t,isPaused:i}),await((s=(o=Br(this,ju).config).onMutate)==null?void 0:s.call(o,t,this));const G=await((u=(a=this.options).onMutate)==null?void 0:u.call(a,t));G!==this.state.context&&mu(this,Ep,Lg).call(this,{type:"pending",context:G,variables:t,isPaused:i})}const U=await Br(this,qy).start();return await((m=(d=Br(this,ju).config).onSuccess)==null?void 0:m.call(d,U,t,this.state.context,this)),await((_=(g=this.options).onSuccess)==null?void 0:_.call(g,U,t,this.state.context)),await((M=(y=Br(this,ju).config).onSettled)==null?void 0:M.call(y,U,null,this.state.variables,this.state.context,this)),await((E=(x=this.options).onSettled)==null?void 0:E.call(x,U,null,t,this.state.context)),mu(this,Ep,Lg).call(this,{type:"success",data:U}),U}catch(U){try{throw await((P=(T=Br(this,ju).config).onError)==null?void 0:P.call(T,U,t,this.state.context,this)),await((D=(C=this.options).onError)==null?void 0:D.call(C,U,t,this.state.context)),await((N=(L=Br(this,ju).config).onSettled)==null?void 0:N.call(L,void 0,U,this.state.variables,this.state.context,this)),await(($=(j=this.options).onSettled)==null?void 0:$.call(j,void 0,U,t,this.state.context)),U}finally{mu(this,Ep,Lg).call(this,{type:"error",error:U})}}finally{Br(this,ju).runNext(this)}}},Pp=new WeakMap,ju=new WeakMap,qy=new WeakMap,Ep=new WeakSet,Lg=function(t){const r=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),zu.batch(()=>{Br(this,Pp).forEach(n=>{n.onMutationUpdate(t)}),Br(this,ju).notify({mutation:this,type:"updated",action:t})})},oZ);function H0e(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Cm,Ef,nS,aZ,K0e=(aZ=class extends M5{constructor(t={}){super();oa(this,Cm);oa(this,Ef);oa(this,nS);this.config=t,to(this,Cm,new Set),to(this,Ef,new Map),to(this,nS,0)}build(t,r,n){const i=new q0e({mutationCache:this,mutationId:++HT(this,nS)._,options:t.defaultMutationOptions(r),state:n});return this.add(i),i}add(t){Br(this,Cm).add(t);const r=mP(t);if(typeof r=="string"){const n=Br(this,Ef).get(r);n?n.push(t):Br(this,Ef).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(Br(this,Cm).delete(t)){const r=mP(t);if(typeof r=="string"){const n=Br(this,Ef).get(r);if(n)if(n.length>1){const i=n.indexOf(t);i!==-1&&n.splice(i,1)}else n[0]===t&&Br(this,Ef).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=mP(t);if(typeof r=="string"){const n=Br(this,Ef).get(r),i=n==null?void 0:n.find(o=>o.state.status==="pending");return!i||i===t}else return!0}runNext(t){var n;const r=mP(t);if(typeof r=="string"){const i=(n=Br(this,Ef).get(r))==null?void 0:n.find(o=>o!==t&&o.state.isPaused);return(i==null?void 0:i.continue())??Promise.resolve()}else return Promise.resolve()}clear(){zu.batch(()=>{Br(this,Cm).forEach(t=>{this.notify({type:"removed",mutation:t})}),Br(this,Cm).clear(),Br(this,Ef).clear()})}getAll(){return Array.from(Br(this,Cm))}find(t){const r={exact:!0,...t};return this.getAll().find(n=>i6(r,n))}findAll(t={}){return this.getAll().filter(r=>i6(t,r))}notify(t){zu.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return zu.batch(()=>Promise.all(t.map(r=>r.continue().catch(Tf))))}},Cm=new WeakMap,Ef=new WeakMap,nS=new WeakMap,aZ);function mP(e){var t;return(t=e.options.scope)==null?void 0:t.id}function s6(e){return{onFetch:(t,r)=>{var m,g,_,y,M;const n=t.options,i=(_=(g=(m=t.fetchOptions)==null?void 0:m.meta)==null?void 0:g.fetchMore)==null?void 0:_.direction,o=((y=t.state.data)==null?void 0:y.pages)||[],s=((M=t.state.data)==null?void 0:M.pageParams)||[];let a={pages:[],pageParams:[]},u=0;const d=async()=>{let x=!1;const E=C=>{Object.defineProperty(C,"signal",{enumerable:!0,get:()=>(t.signal.aborted?x=!0:t.signal.addEventListener("abort",()=>{x=!0}),t.signal)})},T=VQ(t.options,t.fetchOptions),P=async(C,D,L)=>{if(x)return Promise.reject();if(D==null&&C.pages.length)return Promise.resolve(C);const j=(()=>{const H={client:t.client,queryKey:t.queryKey,pageParam:D,direction:L?"backward":"forward",meta:t.options.meta};return E(H),H})(),$=await T(j),{maxPages:U}=t.options,G=L?$0e:D0e;return{pages:G(C.pages,$,U),pageParams:G(C.pageParams,D,U)}};if(i&&o.length){const C=i==="backward",D=C?Z0e:l6,L={pages:o,pageParams:s},N=D(n,L);a=await P(L,N,C)}else{const C=e??o.length;do{const D=u===0?s[0]??n.initialPageParam:l6(n,a);if(u>0&&D==null)break;a=await P(a,D),u++}while(u<C)}return a};t.options.persister?t.fetchFn=()=>{var x,E;return(E=(x=t.options).persister)==null?void 0:E.call(x,d,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=d}}}function l6(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function Z0e(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var ol,Xg,Yg,$1,N1,Qg,j1,R1,sZ,X0e=(sZ=class{constructor(e={}){oa(this,ol);oa(this,Xg);oa(this,Yg);oa(this,$1);oa(this,N1);oa(this,Qg);oa(this,j1);oa(this,R1);to(this,ol,e.queryCache||new G0e),to(this,Xg,e.mutationCache||new K0e),to(this,Yg,e.defaultOptions||{}),to(this,$1,new Map),to(this,N1,new Map),to(this,Qg,0)}mount(){HT(this,Qg)._++,Br(this,Qg)===1&&(to(this,j1,WQ.subscribe(async e=>{e&&(await this.resumePausedMutations(),Br(this,ol).onFocus())})),to(this,R1,yA.subscribe(async e=>{e&&(await this.resumePausedMutations(),Br(this,ol).onOnline())})))}unmount(){var e,t;HT(this,Qg)._--,Br(this,Qg)===0&&((e=Br(this,j1))==null||e.call(this),to(this,j1,void 0),(t=Br(this,R1))==null||t.call(this),to(this,R1,void 0))}isFetching(e){return Br(this,ol).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return Br(this,Xg).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=Br(this,ol).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=Br(this,ol).build(this,t),n=r.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(sD(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return Br(this,ol).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),i=Br(this,ol).get(n.queryHash),o=i==null?void 0:i.state.data,s=A0e(t,o);if(s!==void 0)return Br(this,ol).build(this,n).setData(s,{...r,manual:!0})}setQueriesData(e,t,r){return zu.batch(()=>Br(this,ol).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=Br(this,ol).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=Br(this,ol);zu.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=Br(this,ol);return zu.batch(()=>(r.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},n=zu.batch(()=>Br(this,ol).findAll(e).map(i=>i.cancel(r)));return Promise.all(n).then(Tf).catch(Tf)}invalidateQueries(e,t={}){return zu.batch(()=>(Br(this,ol).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},n=zu.batch(()=>Br(this,ol).findAll(e).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let o=i.fetch(void 0,r);return r.throwOnError||(o=o.catch(Tf)),i.state.fetchStatus==="paused"?Promise.resolve():o}));return Promise.all(n).then(Tf)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=Br(this,ol).build(this,t);return r.isStaleByTime(sD(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Tf).catch(Tf)}fetchInfiniteQuery(e){return e.behavior=s6(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Tf).catch(Tf)}ensureInfiniteQueryData(e){return e.behavior=s6(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return yA.isOnline()?Br(this,Xg).resumePausedMutations():Promise.resolve()}getQueryCache(){return Br(this,ol)}getMutationCache(){return Br(this,Xg)}getDefaultOptions(){return Br(this,Yg)}setDefaultOptions(e){to(this,Yg,e)}setQueryDefaults(e,t){Br(this,$1).set(Z2(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...Br(this,$1).values()],r={};return t.forEach(n=>{X2(e,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(e,t){Br(this,N1).set(Z2(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...Br(this,N1).values()],r={};return t.forEach(n=>{X2(e,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...Br(this,Yg).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=mj(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===gj&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...Br(this,Yg).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){Br(this,ol).clear(),Br(this,Xg).clear()}},ol=new WeakMap,Xg=new WeakMap,Yg=new WeakMap,$1=new WeakMap,N1=new WeakMap,Qg=new WeakMap,j1=new WeakMap,R1=new WeakMap,sZ),Y0e=oe.createContext(void 0),Q0e=({client:e,children:t})=>(oe.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),F.jsx(Y0e.Provider,{value:e,children:t}));/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Y2(){return Y2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Y2.apply(this,arguments)}var t_;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(t_||(t_={}));const c6="popstate";function J0e(e){e===void 0&&(e={});function t(n,i){let{pathname:o,search:s,hash:a}=n.location;return cD("",{pathname:o,search:s,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:vA(i)}return tve(t,r,null,e)}function Ll(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function ZQ(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function eve(){return Math.random().toString(36).substr(2,8)}function u6(e,t){return{usr:e.state,key:e.key,idx:t}}function cD(e,t,r,n){return r===void 0&&(r=null),Y2({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Nb(t):t,{state:r,key:t&&t.key||n||eve()})}function vA(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Nb(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function tve(e,t,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:o=!1}=n,s=i.history,a=t_.Pop,u=null,d=m();d==null&&(d=0,s.replaceState(Y2({},s.state,{idx:d}),""));function m(){return(s.state||{idx:null}).idx}function g(){a=t_.Pop;let E=m(),T=E==null?null:E-d;d=E,u&&u({action:a,location:x.location,delta:T})}function _(E,T){a=t_.Push;let P=cD(x.location,E,T);d=m()+1;let C=u6(P,d),D=x.createHref(P);try{s.pushState(C,"",D)}catch(L){if(L instanceof DOMException&&L.name==="DataCloneError")throw L;i.location.assign(D)}o&&u&&u({action:a,location:x.location,delta:1})}function y(E,T){a=t_.Replace;let P=cD(x.location,E,T);d=m();let C=u6(P,d),D=x.createHref(P);s.replaceState(C,"",D),o&&u&&u({action:a,location:x.location,delta:0})}function M(E){let T=i.location.origin!=="null"?i.location.origin:i.location.href,P=typeof E=="string"?E:vA(E);return P=P.replace(/ $/,"%20"),Ll(T,"No window.location.(origin|href) available to create URL for href: "+P),new URL(P,T)}let x={get action(){return a},get location(){return e(i,s)},listen(E){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(c6,g),u=E,()=>{i.removeEventListener(c6,g),u=null}},createHref(E){return t(i,E)},createURL:M,encodeLocation(E){let T=M(E);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:_,replace:y,go(E){return s.go(E)}};return x}var d6;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(d6||(d6={}));function rve(e,t,r){return r===void 0&&(r="/"),nve(e,t,r,!1)}function nve(e,t,r,n){let i=typeof t=="string"?Nb(t):t,o=_j(i.pathname||"/",r);if(o==null)return null;let s=XQ(e);ive(s);let a=null;for(let u=0;a==null&&u<s.length;++u){let d=mve(o);a=fve(s[u],d,n)}return a}function XQ(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(o,s,a)=>{let u={relativePath:a===void 0?o.path||"":a,caseSensitive:o.caseSensitive===!0,childrenIndex:s,route:o};u.relativePath.startsWith("/")&&(Ll(u.relativePath.startsWith(n),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(n.length));let d=p_([n,u.relativePath]),m=r.concat(u);o.children&&o.children.length>0&&(Ll(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),XQ(o.children,t,m,d)),!(o.path==null&&!o.index)&&t.push({path:d,score:dve(d,o.index),routesMeta:m})};return e.forEach((o,s)=>{var a;if(o.path===""||!((a=o.path)!=null&&a.includes("?")))i(o,s);else for(let u of YQ(o.path))i(o,s,u)}),t}function YQ(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,i=r.endsWith("?"),o=r.replace(/\?$/,"");if(n.length===0)return i?[o,""]:[o];let s=YQ(n.join("/")),a=[];return a.push(...s.map(u=>u===""?o:[o,u].join("/"))),i&&a.push(...s),a.map(u=>e.startsWith("/")&&u===""?"/":u)}function ive(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:hve(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const ove=/^:[\w-]+$/,ave=3,sve=2,lve=1,cve=10,uve=-2,h6=e=>e==="*";function dve(e,t){let r=e.split("/"),n=r.length;return r.some(h6)&&(n+=uve),t&&(n+=sve),r.filter(i=>!h6(i)).reduce((i,o)=>i+(ove.test(o)?ave:o===""?lve:cve),n)}function hve(e,t){return e.length===t.length&&e.slice(0,-1).every((n,i)=>n===t[i])?e[e.length-1]-t[t.length-1]:0}function fve(e,t,r){let{routesMeta:n}=e,i={},o="/",s=[];for(let a=0;a<n.length;++a){let u=n[a],d=a===n.length-1,m=o==="/"?t:t.slice(o.length)||"/",g=f6({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},m),_=u.route;if(!g&&d&&r&&!n[n.length-1].route.index&&(g=f6({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},m)),!g)return null;Object.assign(i,g.params),s.push({params:i,pathname:p_([o,g.pathname]),pathnameBase:vve(p_([o,g.pathnameBase])),route:_}),g.pathnameBase!=="/"&&(o=p_([o,g.pathnameBase]))}return s}function f6(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=pve(e.path,e.caseSensitive,e.end),i=t.match(r);if(!i)return null;let o=i[0],s=o.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:n.reduce((d,m,g)=>{let{paramName:_,isOptional:y}=m;if(_==="*"){let x=a[g]||"";s=o.slice(0,o.length-x.length).replace(/(.)\/+$/,"$1")}const M=a[g];return y&&!M?d[_]=void 0:d[_]=(M||"").replace(/%2F/g,"/"),d},{}),pathname:o,pathnameBase:s,pattern:e}}function pve(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),ZQ(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,a,u)=>(n.push({paramName:a,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),n]}function mve(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return ZQ(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function _j(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function gve(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:i=""}=typeof e=="string"?Nb(e):e;return{pathname:r?r.startsWith("/")?r:_ve(r,t):t,search:bve(n),hash:xve(i)}}function _ve(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function CI(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function yve(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function yj(e,t){let r=yve(e);return t?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function vj(e,t,r,n){n===void 0&&(n=!1);let i;typeof e=="string"?i=Nb(e):(i=Y2({},e),Ll(!i.pathname||!i.pathname.includes("?"),CI("?","pathname","search",i)),Ll(!i.pathname||!i.pathname.includes("#"),CI("#","pathname","hash",i)),Ll(!i.search||!i.search.includes("#"),CI("#","search","hash",i)));let o=e===""||i.pathname==="",s=o?"/":i.pathname,a;if(s==null)a=r;else{let g=t.length-1;if(!n&&s.startsWith("..")){let _=s.split("/");for(;_[0]==="..";)_.shift(),g-=1;i.pathname=_.join("/")}a=g>=0?t[g]:"/"}let u=gve(i,a),d=s&&s!=="/"&&s.endsWith("/"),m=(o||s===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(d||m)&&(u.pathname+="/"),u}const p_=e=>e.join("/").replace(/\/\/+/g,"/"),vve=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),bve=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,xve=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function wve(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const QQ=["post","put","patch","delete"];new Set(QQ);const Mve=["get",...QQ];new Set(Mve);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Q2(){return Q2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Q2.apply(this,arguments)}const bj=oe.createContext(null),Sve=oe.createContext(null),L_=oe.createContext(null),T5=oe.createContext(null),D_=oe.createContext({outlet:null,matches:[],isDataRoute:!1}),JQ=oe.createContext(null);function Tve(e,t){let{relative:r}=t===void 0?{}:t;jb()||Ll(!1);let{basename:n,navigator:i}=oe.useContext(L_),{hash:o,pathname:s,search:a}=rJ(e,{relative:r}),u=s;return n!=="/"&&(u=s==="/"?n:p_([n,s])),i.createHref({pathname:u,search:a,hash:o})}function jb(){return oe.useContext(T5)!=null}function k0(){return jb()||Ll(!1),oe.useContext(T5).location}function eJ(e){oe.useContext(L_).static||oe.useLayoutEffect(e)}function tJ(){let{isDataRoute:e}=oe.useContext(D_);return e?Rve():Pve()}function Pve(){jb()||Ll(!1);let e=oe.useContext(bj),{basename:t,future:r,navigator:n}=oe.useContext(L_),{matches:i}=oe.useContext(D_),{pathname:o}=k0(),s=JSON.stringify(yj(i,r.v7_relativeSplatPath)),a=oe.useRef(!1);return eJ(()=>{a.current=!0}),oe.useCallback(function(d,m){if(m===void 0&&(m={}),!a.current)return;if(typeof d=="number"){n.go(d);return}let g=vj(d,JSON.parse(s),o,m.relative==="path");e==null&&t!=="/"&&(g.pathname=g.pathname==="/"?t:p_([t,g.pathname])),(m.replace?n.replace:n.push)(g,m.state,m)},[t,n,s,o,e])}function rJ(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=oe.useContext(L_),{matches:i}=oe.useContext(D_),{pathname:o}=k0(),s=JSON.stringify(yj(i,n.v7_relativeSplatPath));return oe.useMemo(()=>vj(e,JSON.parse(s),o,r==="path"),[e,s,o,r])}function Eve(e,t){return Ave(e,t)}function Ave(e,t,r,n){jb()||Ll(!1);let{navigator:i}=oe.useContext(L_),{matches:o}=oe.useContext(D_),s=o[o.length-1],a=s?s.params:{};s&&s.pathname;let u=s?s.pathnameBase:"/";s&&s.route;let d=k0(),m;if(t){var g;let E=typeof t=="string"?Nb(t):t;u==="/"||(g=E.pathname)!=null&&g.startsWith(u)||Ll(!1),m=E}else m=d;let _=m.pathname||"/",y=_;if(u!=="/"){let E=u.replace(/^\//,"").split("/");y="/"+_.replace(/^\//,"").split("/").slice(E.length).join("/")}let M=rve(e,{pathname:y}),x=Lve(M&&M.map(E=>Object.assign({},E,{params:Object.assign({},a,E.params),pathname:p_([u,i.encodeLocation?i.encodeLocation(E.pathname).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?u:p_([u,i.encodeLocation?i.encodeLocation(E.pathnameBase).pathname:E.pathnameBase])})),o,r,n);return t&&x?oe.createElement(T5.Provider,{value:{location:Q2({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:t_.Pop}},x):x}function Cve(){let e=jve(),t=wve(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return oe.createElement(oe.Fragment,null,oe.createElement("h2",null,"Unexpected Application Error!"),oe.createElement("h3",{style:{fontStyle:"italic"}},t),r?oe.createElement("pre",{style:i},r):null,null)}const kve=oe.createElement(Cve,null);class Ive extends oe.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?oe.createElement(D_.Provider,{value:this.props.routeContext},oe.createElement(JQ.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Ove(e){let{routeContext:t,match:r,children:n}=e,i=oe.useContext(bj);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),oe.createElement(D_.Provider,{value:t},n)}function Lve(e,t,r,n){var i;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var o;if(!r)return null;if(r.errors)e=r.matches;else if((o=n)!=null&&o.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let s=e,a=(i=r)==null?void 0:i.errors;if(a!=null){let m=s.findIndex(g=>g.route.id&&(a==null?void 0:a[g.route.id])!==void 0);m>=0||Ll(!1),s=s.slice(0,Math.min(s.length,m+1))}let u=!1,d=-1;if(r&&n&&n.v7_partialHydration)for(let m=0;m<s.length;m++){let g=s[m];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(d=m),g.route.id){let{loaderData:_,errors:y}=r,M=g.route.loader&&_[g.route.id]===void 0&&(!y||y[g.route.id]===void 0);if(g.route.lazy||M){u=!0,d>=0?s=s.slice(0,d+1):s=[s[0]];break}}}return s.reduceRight((m,g,_)=>{let y,M=!1,x=null,E=null;r&&(y=a&&g.route.id?a[g.route.id]:void 0,x=g.route.errorElement||kve,u&&(d<0&&_===0?(M=!0,E=null):d===_&&(M=!0,E=g.route.hydrateFallbackElement||null)));let T=t.concat(s.slice(0,_+1)),P=()=>{let C;return y?C=x:M?C=E:g.route.Component?C=oe.createElement(g.route.Component,null):g.route.element?C=g.route.element:C=m,oe.createElement(Ove,{match:g,routeContext:{outlet:m,matches:T,isDataRoute:r!=null},children:C})};return r&&(g.route.ErrorBoundary||g.route.errorElement||_===0)?oe.createElement(Ive,{location:r.location,revalidation:r.revalidation,component:x,error:y,children:P(),routeContext:{outlet:null,matches:T,isDataRoute:!0}}):P()},null)}var nJ=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(nJ||{}),bA=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(bA||{});function Dve(e){let t=oe.useContext(bj);return t||Ll(!1),t}function $ve(e){let t=oe.useContext(Sve);return t||Ll(!1),t}function Nve(e){let t=oe.useContext(D_);return t||Ll(!1),t}function iJ(e){let t=Nve(),r=t.matches[t.matches.length-1];return r.route.id||Ll(!1),r.route.id}function jve(){var e;let t=oe.useContext(JQ),r=$ve(bA.UseRouteError),n=iJ(bA.UseRouteError);return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function Rve(){let{router:e}=Dve(nJ.UseNavigateStable),t=iJ(bA.UseNavigateStable),r=oe.useRef(!1);return eJ(()=>{r.current=!0}),oe.useCallback(function(i,o){o===void 0&&(o={}),r.current&&(typeof i=="number"?e.navigate(i):e.navigate(i,Q2({fromRouteId:t},o)))},[e,t])}function Fve(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function oJ(e){let{to:t,replace:r,state:n,relative:i}=e;jb()||Ll(!1);let{future:o,static:s}=oe.useContext(L_),{matches:a}=oe.useContext(D_),{pathname:u}=k0(),d=tJ(),m=vj(t,yj(a,o.v7_relativeSplatPath),u,i==="path"),g=JSON.stringify(m);return oe.useEffect(()=>d(JSON.parse(g),{replace:r,state:n,relative:i}),[d,g,i,r,n]),null}function Dg(e){Ll(!1)}function zve(e){let{basename:t="/",children:r=null,location:n,navigationType:i=t_.Pop,navigator:o,static:s=!1,future:a}=e;jb()&&Ll(!1);let u=t.replace(/^\/*/,"/"),d=oe.useMemo(()=>({basename:u,navigator:o,static:s,future:Q2({v7_relativeSplatPath:!1},a)}),[u,a,o,s]);typeof n=="string"&&(n=Nb(n));let{pathname:m="/",search:g="",hash:_="",state:y=null,key:M="default"}=n,x=oe.useMemo(()=>{let E=_j(m,u);return E==null?null:{location:{pathname:E,search:g,hash:_,state:y,key:M},navigationType:i}},[u,m,g,_,y,M,i]);return x==null?null:oe.createElement(L_.Provider,{value:d},oe.createElement(T5.Provider,{children:r,value:x}))}function Bve(e){let{children:t,location:r}=e;return Eve(uD(t),r)}new Promise(()=>{});function uD(e,t){t===void 0&&(t=[]);let r=[];return oe.Children.forEach(e,(n,i)=>{if(!oe.isValidElement(n))return;let o=[...t,i];if(n.type===oe.Fragment){r.push.apply(r,uD(n.props.children,o));return}n.type!==Dg&&Ll(!1),!n.props.index||!n.props.children||Ll(!1);let s={id:n.props.id||o.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(s.children=uD(n.props.children,o)),r.push(s)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function dD(){return dD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dD.apply(this,arguments)}function Uve(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function Vve(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Wve(e,t){return e.button===0&&(!t||t==="_self")&&!Vve(e)}const Gve=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],qve="6";try{window.__reactRouterVersion=qve}catch{}const Hve="startTransition",p6=i4[Hve];function Kve(e){let{basename:t,children:r,future:n,window:i}=e,o=oe.useRef();o.current==null&&(o.current=J0e({window:i,v5Compat:!0}));let s=o.current,[a,u]=oe.useState({action:s.action,location:s.location}),{v7_startTransition:d}=n||{},m=oe.useCallback(g=>{d&&p6?p6(()=>u(g)):u(g)},[u,d]);return oe.useLayoutEffect(()=>s.listen(m),[s,m]),oe.useEffect(()=>Fve(n),[n]),oe.createElement(zve,{basename:t,children:r,location:a.location,navigationType:a.action,navigator:s,future:n})}const Zve=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Xve=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,xA=oe.forwardRef(function(t,r){let{onClick:n,relative:i,reloadDocument:o,replace:s,state:a,target:u,to:d,preventScrollReset:m,viewTransition:g}=t,_=Uve(t,Gve),{basename:y}=oe.useContext(L_),M,x=!1;if(typeof d=="string"&&Xve.test(d)&&(M=d,Zve))try{let C=new URL(window.location.href),D=d.startsWith("//")?new URL(C.protocol+d):new URL(d),L=_j(D.pathname,y);D.origin===C.origin&&L!=null?d=L+D.search+D.hash:x=!0}catch{}let E=Tve(d,{relative:i}),T=Yve(d,{replace:s,state:a,target:u,preventScrollReset:m,relative:i,viewTransition:g});function P(C){n&&n(C),C.defaultPrevented||T(C)}return oe.createElement("a",dD({},_,{href:M||E,onClick:x||o?n:P,ref:r,target:u}))});var m6;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(m6||(m6={}));var g6;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(g6||(g6={}));function Yve(e,t){let{target:r,replace:n,state:i,preventScrollReset:o,relative:s,viewTransition:a}=t===void 0?{}:t,u=tJ(),d=k0(),m=rJ(e,{relative:s});return oe.useCallback(g=>{if(Wve(g,r)){g.preventDefault();let _=n!==void 0?n:vA(d)===vA(m);u(e,{replace:_,state:i,preventScrollReset:o,relative:s,viewTransition:a})}},[d,u,m,n,i,r,e,o,s,a])}const aJ=oe.createContext(void 0),Xp=()=>{const e=oe.useContext(aJ);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},Qve=({children:e})=>{const[t,r]=oe.useState(null),[n,i]=oe.useState(!1);oe.useEffect(()=>{const a=localStorage.getItem("fra-user");if(a){const u=JSON.parse(a);r(u),i(!0)}},[]);const o=async(a,u,d)=>{const m={id:"1",name:d==="user"?"Ramesh Kumar":d==="officer"?"Priya Sharma":"Dr. Anil Gupta",email:a,role:d,district:d==="user"?"Bastar":d==="officer"?"Kanker":void 0,state:"Chhattisgarh"};r(m),i(!0),localStorage.setItem("fra-user",JSON.stringify(m))},s=()=>{r(null),i(!1),localStorage.removeItem("fra-user")};return F.jsx(aJ.Provider,{value:{user:t,isAuthenticated:n,login:o,logout:s},children:e})},Jve=_5("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),iu=oe.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...i},o)=>{const s=n?yme:"button";return F.jsx(s,{className:_i(Jve({variant:t,size:r,className:e})),ref:o,...i})});iu.displayName="Button";var sJ={exports:{}},lJ={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var K1=oe;function e1e(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var t1e=typeof Object.is=="function"?Object.is:e1e,r1e=K1.useState,n1e=K1.useEffect,i1e=K1.useLayoutEffect,o1e=K1.useDebugValue;function a1e(e,t){var r=t(),n=r1e({inst:{value:r,getSnapshot:t}}),i=n[0].inst,o=n[1];return i1e(function(){i.value=r,i.getSnapshot=t,kI(i)&&o({inst:i})},[e,r,t]),n1e(function(){return kI(i)&&o({inst:i}),e(function(){kI(i)&&o({inst:i})})},[e]),o1e(r),r}function kI(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!t1e(e,r)}catch{return!0}}function s1e(e,t){return t()}var l1e=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?s1e:a1e;lJ.useSyncExternalStore=K1.useSyncExternalStore!==void 0?K1.useSyncExternalStore:l1e;sJ.exports=lJ;var c1e=sJ.exports;function u1e(){return c1e.useSyncExternalStore(d1e,()=>!0,()=>!1)}function d1e(){return()=>{}}var xj="Avatar",[h1e,ket]=Bh(xj),[f1e,cJ]=h1e(xj),uJ=oe.forwardRef((e,t)=>{const{__scopeAvatar:r,...n}=e,[i,o]=oe.useState("idle");return F.jsx(f1e,{scope:r,imageLoadingStatus:i,onImageLoadingStatusChange:o,children:F.jsx(Ei.span,{...n,ref:t})})});uJ.displayName=xj;var dJ="AvatarImage",hJ=oe.forwardRef((e,t)=>{const{__scopeAvatar:r,src:n,onLoadingStatusChange:i=()=>{},...o}=e,s=cJ(dJ,r),a=p1e(n,o),u=Hu(d=>{i(d),s.onImageLoadingStatusChange(d)});return Zl(()=>{a!=="idle"&&u(a)},[a,u]),a==="loaded"?F.jsx(Ei.img,{...o,ref:t,src:n}):null});hJ.displayName=dJ;var fJ="AvatarFallback",pJ=oe.forwardRef((e,t)=>{const{__scopeAvatar:r,delayMs:n,...i}=e,o=cJ(fJ,r),[s,a]=oe.useState(n===void 0);return oe.useEffect(()=>{if(n!==void 0){const u=window.setTimeout(()=>a(!0),n);return()=>window.clearTimeout(u)}},[n]),s&&o.imageLoadingStatus!=="loaded"?F.jsx(Ei.span,{...i,ref:t}):null});pJ.displayName=fJ;function _6(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}function p1e(e,{referrerPolicy:t,crossOrigin:r}){const n=u1e(),i=oe.useRef(null),o=n?(i.current||(i.current=new window.Image),i.current):null,[s,a]=oe.useState(()=>_6(o,e));return Zl(()=>{a(_6(o,e))},[o,e]),Zl(()=>{const u=g=>()=>{a(g)};if(!o)return;const d=u("loaded"),m=u("error");return o.addEventListener("load",d),o.addEventListener("error",m),t&&(o.referrerPolicy=t),typeof r=="string"&&(o.crossOrigin=r),()=>{o.removeEventListener("load",d),o.removeEventListener("error",m)}},[o,r,t]),s}var mJ=uJ,gJ=hJ,_J=pJ;const yJ=oe.forwardRef(({className:e,...t},r)=>F.jsx(mJ,{ref:r,className:_i("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...t}));yJ.displayName=mJ.displayName;const m1e=oe.forwardRef(({className:e,...t},r)=>F.jsx(gJ,{ref:r,className:_i("aspect-square h-full w-full",e),...t}));m1e.displayName=gJ.displayName;const vJ=oe.forwardRef(({className:e,...t},r)=>F.jsx(_J,{ref:r,className:_i("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));vJ.displayName=_J.displayName;var g1e=oe.createContext(void 0);function wj(e){const t=oe.useContext(g1e);return e||t||"ltr"}var II=0;function Mj(){oe.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??y6()),document.body.insertAdjacentElement("beforeend",e[1]??y6()),II++,()=>{II===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),II--}},[])}function y6(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var OI="focusScope.autoFocusOnMount",LI="focusScope.autoFocusOnUnmount",v6={bubbles:!1,cancelable:!0},_1e="FocusScope",P5=oe.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:i,onUnmountAutoFocus:o,...s}=e,[a,u]=oe.useState(null),d=Hu(i),m=Hu(o),g=oe.useRef(null),_=ea(t,x=>u(x)),y=oe.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;oe.useEffect(()=>{if(n){let x=function(C){if(y.paused||!a)return;const D=C.target;a.contains(D)?g.current=D:$g(g.current,{select:!0})},E=function(C){if(y.paused||!a)return;const D=C.relatedTarget;D!==null&&(a.contains(D)||$g(g.current,{select:!0}))},T=function(C){if(document.activeElement===document.body)for(const L of C)L.removedNodes.length>0&&$g(a)};document.addEventListener("focusin",x),document.addEventListener("focusout",E);const P=new MutationObserver(T);return a&&P.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",x),document.removeEventListener("focusout",E),P.disconnect()}}},[n,a,y.paused]),oe.useEffect(()=>{if(a){x6.add(y);const x=document.activeElement;if(!a.contains(x)){const T=new CustomEvent(OI,v6);a.addEventListener(OI,d),a.dispatchEvent(T),T.defaultPrevented||(y1e(M1e(bJ(a)),{select:!0}),document.activeElement===x&&$g(a))}return()=>{a.removeEventListener(OI,d),setTimeout(()=>{const T=new CustomEvent(LI,v6);a.addEventListener(LI,m),a.dispatchEvent(T),T.defaultPrevented||$g(x??document.body,{select:!0}),a.removeEventListener(LI,m),x6.remove(y)},0)}}},[a,d,m,y]);const M=oe.useCallback(x=>{if(!r&&!n||y.paused)return;const E=x.key==="Tab"&&!x.altKey&&!x.ctrlKey&&!x.metaKey,T=document.activeElement;if(E&&T){const P=x.currentTarget,[C,D]=v1e(P);C&&D?!x.shiftKey&&T===D?(x.preventDefault(),r&&$g(C,{select:!0})):x.shiftKey&&T===C&&(x.preventDefault(),r&&$g(D,{select:!0})):T===P&&x.preventDefault()}},[r,n,y.paused]);return F.jsx(Ei.div,{tabIndex:-1,...s,ref:_,onKeyDown:M})});P5.displayName=_1e;function y1e(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if($g(n,{select:t}),document.activeElement!==r)return}function v1e(e){const t=bJ(e),r=b6(t,e),n=b6(t.reverse(),e);return[r,n]}function bJ(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const i=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||i?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function b6(e,t){for(const r of e)if(!b1e(r,{upTo:t}))return r}function b1e(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function x1e(e){return e instanceof HTMLInputElement&&"select"in e}function $g(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&x1e(e)&&t&&e.select()}}var x6=w1e();function w1e(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=w6(e,t),e.unshift(t)},remove(t){var r;e=w6(e,t),(r=e[0])==null||r.resume()}}}function w6(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function M1e(e){return e.filter(t=>t.tagName!=="A")}var DI="rovingFocusGroup.onEntryFocus",S1e={bubbles:!1,cancelable:!0},fS="RovingFocusGroup",[hD,xJ,T1e]=p5(fS),[P1e,wJ]=Bh(fS,[T1e]),[E1e,A1e]=P1e(fS),MJ=oe.forwardRef((e,t)=>F.jsx(hD.Provider,{scope:e.__scopeRovingFocusGroup,children:F.jsx(hD.Slot,{scope:e.__scopeRovingFocusGroup,children:F.jsx(C1e,{...e,ref:t})})}));MJ.displayName=fS;var C1e=oe.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:i=!1,dir:o,currentTabStopId:s,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:u,onEntryFocus:d,preventScrollOnEntryFocus:m=!1,...g}=e,_=oe.useRef(null),y=ea(t,_),M=wj(o),[x,E]=s0({prop:s,defaultProp:a??null,onChange:u,caller:fS}),[T,P]=oe.useState(!1),C=Hu(d),D=xJ(r),L=oe.useRef(!1),[N,j]=oe.useState(0);return oe.useEffect(()=>{const $=_.current;if($)return $.addEventListener(DI,C),()=>$.removeEventListener(DI,C)},[C]),F.jsx(E1e,{scope:r,orientation:n,dir:M,loop:i,currentTabStopId:x,onItemFocus:oe.useCallback($=>E($),[E]),onItemShiftTab:oe.useCallback(()=>P(!0),[]),onFocusableItemAdd:oe.useCallback(()=>j($=>$+1),[]),onFocusableItemRemove:oe.useCallback(()=>j($=>$-1),[]),children:F.jsx(Ei.div,{tabIndex:T||N===0?-1:0,"data-orientation":n,...g,ref:y,style:{outline:"none",...e.style},onMouseDown:In(e.onMouseDown,()=>{L.current=!0}),onFocus:In(e.onFocus,$=>{const U=!L.current;if($.target===$.currentTarget&&U&&!T){const G=new CustomEvent(DI,S1e);if($.currentTarget.dispatchEvent(G),!G.defaultPrevented){const H=D().filter(ye=>ye.focusable),X=H.find(ye=>ye.active),ee=H.find(ye=>ye.id===x),de=[X,ee,...H].filter(Boolean).map(ye=>ye.ref.current);PJ(de,m)}}L.current=!1}),onBlur:In(e.onBlur,()=>P(!1))})})}),SJ="RovingFocusGroupItem",TJ=oe.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:i=!1,tabStopId:o,children:s,...a}=e,u=jm(),d=o||u,m=A1e(SJ,r),g=m.currentTabStopId===d,_=xJ(r),{onFocusableItemAdd:y,onFocusableItemRemove:M,currentTabStopId:x}=m;return oe.useEffect(()=>{if(n)return y(),()=>M()},[n,y,M]),F.jsx(hD.ItemSlot,{scope:r,id:d,focusable:n,active:i,children:F.jsx(Ei.span,{tabIndex:g?0:-1,"data-orientation":m.orientation,...a,ref:t,onMouseDown:In(e.onMouseDown,E=>{n?m.onItemFocus(d):E.preventDefault()}),onFocus:In(e.onFocus,()=>m.onItemFocus(d)),onKeyDown:In(e.onKeyDown,E=>{if(E.key==="Tab"&&E.shiftKey){m.onItemShiftTab();return}if(E.target!==E.currentTarget)return;const T=O1e(E,m.orientation,m.dir);if(T!==void 0){if(E.metaKey||E.ctrlKey||E.altKey||E.shiftKey)return;E.preventDefault();let C=_().filter(D=>D.focusable).map(D=>D.ref.current);if(T==="last")C.reverse();else if(T==="prev"||T==="next"){T==="prev"&&C.reverse();const D=C.indexOf(E.currentTarget);C=m.loop?L1e(C,D+1):C.slice(D+1)}setTimeout(()=>PJ(C))}}),children:typeof s=="function"?s({isCurrentTabStop:g,hasTabStop:x!=null}):s})})});TJ.displayName=SJ;var k1e={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function I1e(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function O1e(e,t,r){const n=I1e(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return k1e[n]}function PJ(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function L1e(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var D1e=MJ,$1e=TJ,N1e=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Mv=new WeakMap,gP=new WeakMap,_P={},$I=0,EJ=function(e){return e&&(e.host||EJ(e.parentNode))},j1e=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=EJ(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},R1e=function(e,t,r,n){var i=j1e(t,Array.isArray(e)?e:[e]);_P[r]||(_P[r]=new WeakMap);var o=_P[r],s=[],a=new Set,u=new Set(i),d=function(g){!g||a.has(g)||(a.add(g),d(g.parentNode))};i.forEach(d);var m=function(g){!g||u.has(g)||Array.prototype.forEach.call(g.children,function(_){if(a.has(_))m(_);else try{var y=_.getAttribute(n),M=y!==null&&y!=="false",x=(Mv.get(_)||0)+1,E=(o.get(_)||0)+1;Mv.set(_,x),o.set(_,E),s.push(_),x===1&&M&&gP.set(_,!0),E===1&&_.setAttribute(r,"true"),M||_.setAttribute(n,"true")}catch(T){console.error("aria-hidden: cannot operate on ",_,T)}})};return m(t),a.clear(),$I++,function(){s.forEach(function(g){var _=Mv.get(g)-1,y=o.get(g)-1;Mv.set(g,_),o.set(g,y),_||(gP.has(g)||g.removeAttribute(n),gP.delete(g)),y||g.removeAttribute(r)}),$I--,$I||(Mv=new WeakMap,Mv=new WeakMap,gP=new WeakMap,_P={})}},Sj=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),i=N1e(e);return i?(n.push.apply(n,Array.from(i.querySelectorAll("[aria-live]"))),R1e(n,i,r,"aria-hidden")):function(){return null}},Cp=function(){return Cp=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},Cp.apply(this,arguments)};function AJ(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function F1e(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,o;n<i;n++)(o||!(n in t))&&(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))}var TE="right-scroll-bar-position",PE="width-before-scroll-bar",z1e="with-scroll-bars-hidden",B1e="--removed-body-scroll-bar-size";function NI(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function U1e(e,t){var r=oe.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var i=r.value;i!==n&&(r.value=n,r.callback(n,i))}}}})[0];return r.callback=t,r.facade}var V1e=typeof window<"u"?oe.useLayoutEffect:oe.useEffect,M6=new WeakMap;function W1e(e,t){var r=U1e(null,function(n){return e.forEach(function(i){return NI(i,n)})});return V1e(function(){var n=M6.get(r);if(n){var i=new Set(n),o=new Set(e),s=r.current;i.forEach(function(a){o.has(a)||NI(a,null)}),o.forEach(function(a){i.has(a)||NI(a,s)})}M6.set(r,e)},[e]),r}function G1e(e){return e}function q1e(e,t){t===void 0&&(t=G1e);var r=[],n=!1,i={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(o){var s=t(o,n);return r.push(s),function(){r=r.filter(function(a){return a!==s})}},assignSyncMedium:function(o){for(n=!0;r.length;){var s=r;r=[],s.forEach(o)}r={push:function(a){return o(a)},filter:function(){return r}}},assignMedium:function(o){n=!0;var s=[];if(r.length){var a=r;r=[],a.forEach(o),s=r}var u=function(){var m=s;s=[],m.forEach(o)},d=function(){return Promise.resolve().then(u)};d(),r={push:function(m){s.push(m),d()},filter:function(m){return s=s.filter(m),r}}}};return i}function H1e(e){e===void 0&&(e={});var t=q1e(null);return t.options=Cp({async:!0,ssr:!1},e),t}var CJ=function(e){var t=e.sideCar,r=AJ(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return oe.createElement(n,Cp({},r))};CJ.isSideCarExport=!0;function K1e(e,t){return e.useMedium(t),CJ}var kJ=H1e(),jI=function(){},E5=oe.forwardRef(function(e,t){var r=oe.useRef(null),n=oe.useState({onScrollCapture:jI,onWheelCapture:jI,onTouchMoveCapture:jI}),i=n[0],o=n[1],s=e.forwardProps,a=e.children,u=e.className,d=e.removeScrollBar,m=e.enabled,g=e.shards,_=e.sideCar,y=e.noRelative,M=e.noIsolation,x=e.inert,E=e.allowPinchZoom,T=e.as,P=T===void 0?"div":T,C=e.gapMode,D=AJ(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),L=_,N=W1e([r,t]),j=Cp(Cp({},D),i);return oe.createElement(oe.Fragment,null,m&&oe.createElement(L,{sideCar:kJ,removeScrollBar:d,shards:g,noRelative:y,noIsolation:M,inert:x,setCallbacks:o,allowPinchZoom:!!E,lockRef:r,gapMode:C}),s?oe.cloneElement(oe.Children.only(a),Cp(Cp({},j),{ref:N})):oe.createElement(P,Cp({},j,{className:u,ref:N}),a))});E5.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};E5.classNames={fullWidth:PE,zeroRight:TE};var Z1e=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function X1e(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=Z1e();return t&&e.setAttribute("nonce",t),e}function Y1e(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function Q1e(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var J1e=function(){var e=0,t=null;return{add:function(r){e==0&&(t=X1e())&&(Y1e(t,r),Q1e(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},ebe=function(){var e=J1e();return function(t,r){oe.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},IJ=function(){var e=ebe(),t=function(r){var n=r.styles,i=r.dynamic;return e(n,i),null};return t},tbe={left:0,top:0,right:0,gap:0},RI=function(e){return parseInt(e||"",10)||0},rbe=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],i=t[e==="padding"?"paddingRight":"marginRight"];return[RI(r),RI(n),RI(i)]},nbe=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return tbe;var t=rbe(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},ibe=IJ(),v1="data-scroll-locked",obe=function(e,t,r,n){var i=e.left,o=e.top,s=e.right,a=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(z1e,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(a,"px ").concat(n,`;
  }
  body[`).concat(v1,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(s,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(a,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(TE,` {
    right: `).concat(a,"px ").concat(n,`;
  }
  
  .`).concat(PE,` {
    margin-right: `).concat(a,"px ").concat(n,`;
  }
  
  .`).concat(TE," .").concat(TE,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(PE," .").concat(PE,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(v1,`] {
    `).concat(B1e,": ").concat(a,`px;
  }
`)},S6=function(){var e=parseInt(document.body.getAttribute(v1)||"0",10);return isFinite(e)?e:0},abe=function(){oe.useEffect(function(){return document.body.setAttribute(v1,(S6()+1).toString()),function(){var e=S6()-1;e<=0?document.body.removeAttribute(v1):document.body.setAttribute(v1,e.toString())}},[])},sbe=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,i=n===void 0?"margin":n;abe();var o=oe.useMemo(function(){return nbe(i)},[i]);return oe.createElement(ibe,{styles:obe(o,!t,i,r?"":"!important")})},fD=!1;if(typeof window<"u")try{var yP=Object.defineProperty({},"passive",{get:function(){return fD=!0,!0}});window.addEventListener("test",yP,yP),window.removeEventListener("test",yP,yP)}catch{fD=!1}var Sv=fD?{passive:!1}:!1,lbe=function(e){return e.tagName==="TEXTAREA"},OJ=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!lbe(e)&&r[t]==="visible")},cbe=function(e){return OJ(e,"overflowY")},ube=function(e){return OJ(e,"overflowX")},T6=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var i=LJ(e,n);if(i){var o=DJ(e,n),s=o[1],a=o[2];if(s>a)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},dbe=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},hbe=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},LJ=function(e,t){return e==="v"?cbe(t):ube(t)},DJ=function(e,t){return e==="v"?dbe(t):hbe(t)},fbe=function(e,t){return e==="h"&&t==="rtl"?-1:1},pbe=function(e,t,r,n,i){var o=fbe(e,window.getComputedStyle(t).direction),s=o*n,a=r.target,u=t.contains(a),d=!1,m=s>0,g=0,_=0;do{if(!a)break;var y=DJ(e,a),M=y[0],x=y[1],E=y[2],T=x-E-o*M;(M||T)&&LJ(e,a)&&(g+=T,_+=M);var P=a.parentNode;a=P&&P.nodeType===Node.DOCUMENT_FRAGMENT_NODE?P.host:P}while(!u&&a!==document.body||u&&(t.contains(a)||t===a));return(m&&(Math.abs(g)<1||!i)||!m&&(Math.abs(_)<1||!i))&&(d=!0),d},vP=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},P6=function(e){return[e.deltaX,e.deltaY]},E6=function(e){return e&&"current"in e?e.current:e},mbe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},gbe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},_be=0,Tv=[];function ybe(e){var t=oe.useRef([]),r=oe.useRef([0,0]),n=oe.useRef(),i=oe.useState(_be++)[0],o=oe.useState(IJ)[0],s=oe.useRef(e);oe.useEffect(function(){s.current=e},[e]),oe.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(i));var x=F1e([e.lockRef.current],(e.shards||[]).map(E6),!0).filter(Boolean);return x.forEach(function(E){return E.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),x.forEach(function(E){return E.classList.remove("allow-interactivity-".concat(i))})}}},[e.inert,e.lockRef.current,e.shards]);var a=oe.useCallback(function(x,E){if("touches"in x&&x.touches.length===2||x.type==="wheel"&&x.ctrlKey)return!s.current.allowPinchZoom;var T=vP(x),P=r.current,C="deltaX"in x?x.deltaX:P[0]-T[0],D="deltaY"in x?x.deltaY:P[1]-T[1],L,N=x.target,j=Math.abs(C)>Math.abs(D)?"h":"v";if("touches"in x&&j==="h"&&N.type==="range")return!1;var $=T6(j,N);if(!$)return!0;if($?L=j:(L=j==="v"?"h":"v",$=T6(j,N)),!$)return!1;if(!n.current&&"changedTouches"in x&&(C||D)&&(n.current=L),!L)return!0;var U=n.current||L;return pbe(U,E,x,U==="h"?C:D,!0)},[]),u=oe.useCallback(function(x){var E=x;if(!(!Tv.length||Tv[Tv.length-1]!==o)){var T="deltaY"in E?P6(E):vP(E),P=t.current.filter(function(L){return L.name===E.type&&(L.target===E.target||E.target===L.shadowParent)&&mbe(L.delta,T)})[0];if(P&&P.should){E.cancelable&&E.preventDefault();return}if(!P){var C=(s.current.shards||[]).map(E6).filter(Boolean).filter(function(L){return L.contains(E.target)}),D=C.length>0?a(E,C[0]):!s.current.noIsolation;D&&E.cancelable&&E.preventDefault()}}},[]),d=oe.useCallback(function(x,E,T,P){var C={name:x,delta:E,target:T,should:P,shadowParent:vbe(T)};t.current.push(C),setTimeout(function(){t.current=t.current.filter(function(D){return D!==C})},1)},[]),m=oe.useCallback(function(x){r.current=vP(x),n.current=void 0},[]),g=oe.useCallback(function(x){d(x.type,P6(x),x.target,a(x,e.lockRef.current))},[]),_=oe.useCallback(function(x){d(x.type,vP(x),x.target,a(x,e.lockRef.current))},[]);oe.useEffect(function(){return Tv.push(o),e.setCallbacks({onScrollCapture:g,onWheelCapture:g,onTouchMoveCapture:_}),document.addEventListener("wheel",u,Sv),document.addEventListener("touchmove",u,Sv),document.addEventListener("touchstart",m,Sv),function(){Tv=Tv.filter(function(x){return x!==o}),document.removeEventListener("wheel",u,Sv),document.removeEventListener("touchmove",u,Sv),document.removeEventListener("touchstart",m,Sv)}},[]);var y=e.removeScrollBar,M=e.inert;return oe.createElement(oe.Fragment,null,M?oe.createElement(o,{styles:gbe(i)}):null,y?oe.createElement(sbe,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function vbe(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const bbe=K1e(kJ,ybe);var A5=oe.forwardRef(function(e,t){return oe.createElement(E5,Cp({},e,{ref:t,sideCar:bbe}))});A5.classNames=E5.classNames;var pD=["Enter"," "],xbe=["ArrowDown","PageUp","Home"],$J=["ArrowUp","PageDown","End"],wbe=[...xbe,...$J],Mbe={ltr:[...pD,"ArrowRight"],rtl:[...pD,"ArrowLeft"]},Sbe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},pS="Menu",[J2,Tbe,Pbe]=p5(pS),[I0,NJ]=Bh(pS,[Pbe,$b,wJ]),C5=$b(),jJ=wJ(),[Ebe,O0]=I0(pS),[Abe,mS]=I0(pS),RJ=e=>{const{__scopeMenu:t,open:r=!1,children:n,dir:i,onOpenChange:o,modal:s=!0}=e,a=C5(t),[u,d]=oe.useState(null),m=oe.useRef(!1),g=Hu(o),_=wj(i);return oe.useEffect(()=>{const y=()=>{m.current=!0,document.addEventListener("pointerdown",M,{capture:!0,once:!0}),document.addEventListener("pointermove",M,{capture:!0,once:!0})},M=()=>m.current=!1;return document.addEventListener("keydown",y,{capture:!0}),()=>{document.removeEventListener("keydown",y,{capture:!0}),document.removeEventListener("pointerdown",M,{capture:!0}),document.removeEventListener("pointermove",M,{capture:!0})}},[]),F.jsx(LQ,{...a,children:F.jsx(Ebe,{scope:t,open:r,onOpenChange:g,content:u,onContentChange:d,children:F.jsx(Abe,{scope:t,onClose:oe.useCallback(()=>g(!1),[g]),isUsingKeyboardRef:m,dir:_,modal:s,children:n})})})};RJ.displayName=pS;var Cbe="MenuAnchor",Tj=oe.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,i=C5(r);return F.jsx(dj,{...i,...n,ref:t})});Tj.displayName=Cbe;var Pj="MenuPortal",[kbe,FJ]=I0(Pj,{forceMount:void 0}),zJ=e=>{const{__scopeMenu:t,forceMount:r,children:n,container:i}=e,o=O0(Pj,t);return F.jsx(kbe,{scope:t,forceMount:r,children:F.jsx(Hf,{present:r||o.open,children:F.jsx(uS,{asChild:!0,container:i,children:n})})})};zJ.displayName=Pj;var Lh="MenuContent",[Ibe,Ej]=I0(Lh),BJ=oe.forwardRef((e,t)=>{const r=FJ(Lh,e.__scopeMenu),{forceMount:n=r.forceMount,...i}=e,o=O0(Lh,e.__scopeMenu),s=mS(Lh,e.__scopeMenu);return F.jsx(J2.Provider,{scope:e.__scopeMenu,children:F.jsx(Hf,{present:n||o.open,children:F.jsx(J2.Slot,{scope:e.__scopeMenu,children:s.modal?F.jsx(Obe,{...i,ref:t}):F.jsx(Lbe,{...i,ref:t})})})})}),Obe=oe.forwardRef((e,t)=>{const r=O0(Lh,e.__scopeMenu),n=oe.useRef(null),i=ea(t,n);return oe.useEffect(()=>{const o=n.current;if(o)return Sj(o)},[]),F.jsx(Aj,{...e,ref:i,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:In(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),Lbe=oe.forwardRef((e,t)=>{const r=O0(Lh,e.__scopeMenu);return F.jsx(Aj,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),Dbe=a0("MenuContent.ScrollLock"),Aj=oe.forwardRef((e,t)=>{const{__scopeMenu:r,loop:n=!1,trapFocus:i,onOpenAutoFocus:o,onCloseAutoFocus:s,disableOutsidePointerEvents:a,onEntryFocus:u,onEscapeKeyDown:d,onPointerDownOutside:m,onFocusOutside:g,onInteractOutside:_,onDismiss:y,disableOutsideScroll:M,...x}=e,E=O0(Lh,r),T=mS(Lh,r),P=C5(r),C=jJ(r),D=Tbe(r),[L,N]=oe.useState(null),j=oe.useRef(null),$=ea(t,j,E.onContentChange),U=oe.useRef(0),G=oe.useRef(""),H=oe.useRef(0),X=oe.useRef(null),ee=oe.useRef("right"),ae=oe.useRef(0),de=M?A5:oe.Fragment,ye=M?{as:Dbe,allowPinchZoom:!0}:void 0,_e=fe=>{var Ge,ot;const De=G.current+fe,pe=D().filter(Ye=>!Ye.disabled),K=document.activeElement,te=(Ge=pe.find(Ye=>Ye.ref.current===K))==null?void 0:Ge.textValue,ve=pe.map(Ye=>Ye.textValue),$e=qbe(ve,De,te),Ce=(ot=pe.find(Ye=>Ye.textValue===$e))==null?void 0:ot.ref.current;(function Ye(et){G.current=et,window.clearTimeout(U.current),et!==""&&(U.current=window.setTimeout(()=>Ye(""),1e3))})(De),Ce&&setTimeout(()=>Ce.focus())};oe.useEffect(()=>()=>window.clearTimeout(U.current),[]),Mj();const ue=oe.useCallback(fe=>{var pe,K;return ee.current===((pe=X.current)==null?void 0:pe.side)&&Kbe(fe,(K=X.current)==null?void 0:K.area)},[]);return F.jsx(Ibe,{scope:r,searchRef:G,onItemEnter:oe.useCallback(fe=>{ue(fe)&&fe.preventDefault()},[ue]),onItemLeave:oe.useCallback(fe=>{var De;ue(fe)||((De=j.current)==null||De.focus(),N(null))},[ue]),onTriggerLeave:oe.useCallback(fe=>{ue(fe)&&fe.preventDefault()},[ue]),pointerGraceTimerRef:H,onPointerGraceIntentChange:oe.useCallback(fe=>{X.current=fe},[]),children:F.jsx(de,{...ye,children:F.jsx(P5,{asChild:!0,trapped:i,onMountAutoFocus:In(o,fe=>{var De;fe.preventDefault(),(De=j.current)==null||De.focus({preventScroll:!0})}),onUnmountAutoFocus:s,children:F.jsx(Ib,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:d,onPointerDownOutside:m,onFocusOutside:g,onInteractOutside:_,onDismiss:y,children:F.jsx(D1e,{asChild:!0,...C,dir:T.dir,orientation:"vertical",loop:n,currentTabStopId:L,onCurrentTabStopIdChange:N,onEntryFocus:In(u,fe=>{T.isUsingKeyboardRef.current||fe.preventDefault()}),preventScrollOnEntryFocus:!0,children:F.jsx(hj,{role:"menu","aria-orientation":"vertical","data-state":nee(E.open),"data-radix-menu-content":"",dir:T.dir,...P,...x,ref:$,style:{outline:"none",...x.style},onKeyDown:In(x.onKeyDown,fe=>{const pe=fe.target.closest("[data-radix-menu-content]")===fe.currentTarget,K=fe.ctrlKey||fe.altKey||fe.metaKey,te=fe.key.length===1;pe&&(fe.key==="Tab"&&fe.preventDefault(),!K&&te&&_e(fe.key));const ve=j.current;if(fe.target!==ve||!wbe.includes(fe.key))return;fe.preventDefault();const Ce=D().filter(Ge=>!Ge.disabled).map(Ge=>Ge.ref.current);$J.includes(fe.key)&&Ce.reverse(),Wbe(Ce)}),onBlur:In(e.onBlur,fe=>{fe.currentTarget.contains(fe.target)||(window.clearTimeout(U.current),G.current="")}),onPointerMove:In(e.onPointerMove,eM(fe=>{const De=fe.target,pe=ae.current!==fe.clientX;if(fe.currentTarget.contains(De)&&pe){const K=fe.clientX>ae.current?"right":"left";ee.current=K,ae.current=fe.clientX}}))})})})})})})});BJ.displayName=Lh;var $be="MenuGroup",Cj=oe.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return F.jsx(Ei.div,{role:"group",...n,ref:t})});Cj.displayName=$be;var Nbe="MenuLabel",UJ=oe.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return F.jsx(Ei.div,{...n,ref:t})});UJ.displayName=Nbe;var wA="MenuItem",A6="menu.itemSelect",k5=oe.forwardRef((e,t)=>{const{disabled:r=!1,onSelect:n,...i}=e,o=oe.useRef(null),s=mS(wA,e.__scopeMenu),a=Ej(wA,e.__scopeMenu),u=ea(t,o),d=oe.useRef(!1),m=()=>{const g=o.current;if(!r&&g){const _=new CustomEvent(A6,{bubbles:!0,cancelable:!0});g.addEventListener(A6,y=>n==null?void 0:n(y),{once:!0}),Z4(g,_),_.defaultPrevented?d.current=!1:s.onClose()}};return F.jsx(VJ,{...i,ref:u,disabled:r,onClick:In(e.onClick,m),onPointerDown:g=>{var _;(_=e.onPointerDown)==null||_.call(e,g),d.current=!0},onPointerUp:In(e.onPointerUp,g=>{var _;d.current||(_=g.currentTarget)==null||_.click()}),onKeyDown:In(e.onKeyDown,g=>{const _=a.searchRef.current!=="";r||_&&g.key===" "||pD.includes(g.key)&&(g.currentTarget.click(),g.preventDefault())})})});k5.displayName=wA;var VJ=oe.forwardRef((e,t)=>{const{__scopeMenu:r,disabled:n=!1,textValue:i,...o}=e,s=Ej(wA,r),a=jJ(r),u=oe.useRef(null),d=ea(t,u),[m,g]=oe.useState(!1),[_,y]=oe.useState("");return oe.useEffect(()=>{const M=u.current;M&&y((M.textContent??"").trim())},[o.children]),F.jsx(J2.ItemSlot,{scope:r,disabled:n,textValue:i??_,children:F.jsx($1e,{asChild:!0,...a,focusable:!n,children:F.jsx(Ei.div,{role:"menuitem","data-highlighted":m?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...o,ref:d,onPointerMove:In(e.onPointerMove,eM(M=>{n?s.onItemLeave(M):(s.onItemEnter(M),M.defaultPrevented||M.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:In(e.onPointerLeave,eM(M=>s.onItemLeave(M))),onFocus:In(e.onFocus,()=>g(!0)),onBlur:In(e.onBlur,()=>g(!1))})})})}),jbe="MenuCheckboxItem",WJ=oe.forwardRef((e,t)=>{const{checked:r=!1,onCheckedChange:n,...i}=e;return F.jsx(ZJ,{scope:e.__scopeMenu,checked:r,children:F.jsx(k5,{role:"menuitemcheckbox","aria-checked":MA(r)?"mixed":r,...i,ref:t,"data-state":Ij(r),onSelect:In(i.onSelect,()=>n==null?void 0:n(MA(r)?!0:!r),{checkForDefaultPrevented:!1})})})});WJ.displayName=jbe;var GJ="MenuRadioGroup",[Rbe,Fbe]=I0(GJ,{value:void 0,onValueChange:()=>{}}),qJ=oe.forwardRef((e,t)=>{const{value:r,onValueChange:n,...i}=e,o=Hu(n);return F.jsx(Rbe,{scope:e.__scopeMenu,value:r,onValueChange:o,children:F.jsx(Cj,{...i,ref:t})})});qJ.displayName=GJ;var HJ="MenuRadioItem",KJ=oe.forwardRef((e,t)=>{const{value:r,...n}=e,i=Fbe(HJ,e.__scopeMenu),o=r===i.value;return F.jsx(ZJ,{scope:e.__scopeMenu,checked:o,children:F.jsx(k5,{role:"menuitemradio","aria-checked":o,...n,ref:t,"data-state":Ij(o),onSelect:In(n.onSelect,()=>{var s;return(s=i.onValueChange)==null?void 0:s.call(i,r)},{checkForDefaultPrevented:!1})})})});KJ.displayName=HJ;var kj="MenuItemIndicator",[ZJ,zbe]=I0(kj,{checked:!1}),XJ=oe.forwardRef((e,t)=>{const{__scopeMenu:r,forceMount:n,...i}=e,o=zbe(kj,r);return F.jsx(Hf,{present:n||MA(o.checked)||o.checked===!0,children:F.jsx(Ei.span,{...i,ref:t,"data-state":Ij(o.checked)})})});XJ.displayName=kj;var Bbe="MenuSeparator",YJ=oe.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return F.jsx(Ei.div,{role:"separator","aria-orientation":"horizontal",...n,ref:t})});YJ.displayName=Bbe;var Ube="MenuArrow",QJ=oe.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,i=C5(r);return F.jsx(fj,{...i,...n,ref:t})});QJ.displayName=Ube;var Vbe="MenuSub",[Iet,JJ]=I0(Vbe),Gw="MenuSubTrigger",eee=oe.forwardRef((e,t)=>{const r=O0(Gw,e.__scopeMenu),n=mS(Gw,e.__scopeMenu),i=JJ(Gw,e.__scopeMenu),o=Ej(Gw,e.__scopeMenu),s=oe.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:u}=o,d={__scopeMenu:e.__scopeMenu},m=oe.useCallback(()=>{s.current&&window.clearTimeout(s.current),s.current=null},[]);return oe.useEffect(()=>m,[m]),oe.useEffect(()=>{const g=a.current;return()=>{window.clearTimeout(g),u(null)}},[a,u]),F.jsx(Tj,{asChild:!0,...d,children:F.jsx(VJ,{id:i.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":i.contentId,"data-state":nee(r.open),...e,ref:f5(t,i.onTriggerChange),onClick:g=>{var _;(_=e.onClick)==null||_.call(e,g),!(e.disabled||g.defaultPrevented)&&(g.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:In(e.onPointerMove,eM(g=>{o.onItemEnter(g),!g.defaultPrevented&&!e.disabled&&!r.open&&!s.current&&(o.onPointerGraceIntentChange(null),s.current=window.setTimeout(()=>{r.onOpenChange(!0),m()},100))})),onPointerLeave:In(e.onPointerLeave,eM(g=>{var y,M;m();const _=(y=r.content)==null?void 0:y.getBoundingClientRect();if(_){const x=(M=r.content)==null?void 0:M.dataset.side,E=x==="right",T=E?-5:5,P=_[E?"left":"right"],C=_[E?"right":"left"];o.onPointerGraceIntentChange({area:[{x:g.clientX+T,y:g.clientY},{x:P,y:_.top},{x:C,y:_.top},{x:C,y:_.bottom},{x:P,y:_.bottom}],side:x}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(g),g.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:In(e.onKeyDown,g=>{var y;const _=o.searchRef.current!=="";e.disabled||_&&g.key===" "||Mbe[n.dir].includes(g.key)&&(r.onOpenChange(!0),(y=r.content)==null||y.focus(),g.preventDefault())})})})});eee.displayName=Gw;var tee="MenuSubContent",ree=oe.forwardRef((e,t)=>{const r=FJ(Lh,e.__scopeMenu),{forceMount:n=r.forceMount,...i}=e,o=O0(Lh,e.__scopeMenu),s=mS(Lh,e.__scopeMenu),a=JJ(tee,e.__scopeMenu),u=oe.useRef(null),d=ea(t,u);return F.jsx(J2.Provider,{scope:e.__scopeMenu,children:F.jsx(Hf,{present:n||o.open,children:F.jsx(J2.Slot,{scope:e.__scopeMenu,children:F.jsx(Aj,{id:a.contentId,"aria-labelledby":a.triggerId,...i,ref:d,align:"start",side:s.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:m=>{var g;s.isUsingKeyboardRef.current&&((g=u.current)==null||g.focus()),m.preventDefault()},onCloseAutoFocus:m=>m.preventDefault(),onFocusOutside:In(e.onFocusOutside,m=>{m.target!==a.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:In(e.onEscapeKeyDown,m=>{s.onClose(),m.preventDefault()}),onKeyDown:In(e.onKeyDown,m=>{var y;const g=m.currentTarget.contains(m.target),_=Sbe[s.dir].includes(m.key);g&&_&&(o.onOpenChange(!1),(y=a.trigger)==null||y.focus(),m.preventDefault())})})})})})});ree.displayName=tee;function nee(e){return e?"open":"closed"}function MA(e){return e==="indeterminate"}function Ij(e){return MA(e)?"indeterminate":e?"checked":"unchecked"}function Wbe(e){const t=document.activeElement;for(const r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function Gbe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}function qbe(e,t,r){const i=t.length>1&&Array.from(t).every(d=>d===t[0])?t[0]:t,o=r?e.indexOf(r):-1;let s=Gbe(e,Math.max(o,0));i.length===1&&(s=s.filter(d=>d!==r));const u=s.find(d=>d.toLowerCase().startsWith(i.toLowerCase()));return u!==r?u:void 0}function Hbe(e,t){const{x:r,y:n}=e;let i=!1;for(let o=0,s=t.length-1;o<t.length;s=o++){const a=t[o],u=t[s],d=a.x,m=a.y,g=u.x,_=u.y;m>n!=_>n&&r<(g-d)*(n-m)/(_-m)+d&&(i=!i)}return i}function Kbe(e,t){if(!t)return!1;const r={x:e.clientX,y:e.clientY};return Hbe(r,t)}function eM(e){return t=>t.pointerType==="mouse"?e(t):void 0}var Zbe=RJ,Xbe=Tj,Ybe=zJ,Qbe=BJ,Jbe=Cj,exe=UJ,txe=k5,rxe=WJ,nxe=qJ,ixe=KJ,oxe=XJ,axe=YJ,sxe=QJ,lxe=eee,cxe=ree,I5="DropdownMenu",[uxe,Oet]=Bh(I5,[NJ]),Xu=NJ(),[dxe,iee]=uxe(I5),oee=e=>{const{__scopeDropdownMenu:t,children:r,dir:n,open:i,defaultOpen:o,onOpenChange:s,modal:a=!0}=e,u=Xu(t),d=oe.useRef(null),[m,g]=s0({prop:i,defaultProp:o??!1,onChange:s,caller:I5});return F.jsx(dxe,{scope:t,triggerId:jm(),triggerRef:d,contentId:jm(),open:m,onOpenChange:g,onOpenToggle:oe.useCallback(()=>g(_=>!_),[g]),modal:a,children:F.jsx(Zbe,{...u,open:m,onOpenChange:g,dir:n,modal:a,children:r})})};oee.displayName=I5;var aee="DropdownMenuTrigger",see=oe.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,disabled:n=!1,...i}=e,o=iee(aee,r),s=Xu(r);return F.jsx(Xbe,{asChild:!0,...s,children:F.jsx(Ei.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...i,ref:f5(t,o.triggerRef),onPointerDown:In(e.onPointerDown,a=>{!n&&a.button===0&&a.ctrlKey===!1&&(o.onOpenToggle(),o.open||a.preventDefault())}),onKeyDown:In(e.onKeyDown,a=>{n||(["Enter"," "].includes(a.key)&&o.onOpenToggle(),a.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})})});see.displayName=aee;var hxe="DropdownMenuPortal",lee=e=>{const{__scopeDropdownMenu:t,...r}=e,n=Xu(t);return F.jsx(Ybe,{...n,...r})};lee.displayName=hxe;var cee="DropdownMenuContent",uee=oe.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,i=iee(cee,r),o=Xu(r),s=oe.useRef(!1);return F.jsx(Qbe,{id:i.contentId,"aria-labelledby":i.triggerId,...o,...n,ref:t,onCloseAutoFocus:In(e.onCloseAutoFocus,a=>{var u;s.current||(u=i.triggerRef.current)==null||u.focus(),s.current=!1,a.preventDefault()}),onInteractOutside:In(e.onInteractOutside,a=>{const u=a.detail.originalEvent,d=u.button===0&&u.ctrlKey===!0,m=u.button===2||d;(!i.modal||m)&&(s.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});uee.displayName=cee;var fxe="DropdownMenuGroup",pxe=oe.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,i=Xu(r);return F.jsx(Jbe,{...i,...n,ref:t})});pxe.displayName=fxe;var mxe="DropdownMenuLabel",dee=oe.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,i=Xu(r);return F.jsx(exe,{...i,...n,ref:t})});dee.displayName=mxe;var gxe="DropdownMenuItem",hee=oe.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,i=Xu(r);return F.jsx(txe,{...i,...n,ref:t})});hee.displayName=gxe;var _xe="DropdownMenuCheckboxItem",fee=oe.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,i=Xu(r);return F.jsx(rxe,{...i,...n,ref:t})});fee.displayName=_xe;var yxe="DropdownMenuRadioGroup",vxe=oe.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,i=Xu(r);return F.jsx(nxe,{...i,...n,ref:t})});vxe.displayName=yxe;var bxe="DropdownMenuRadioItem",pee=oe.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,i=Xu(r);return F.jsx(ixe,{...i,...n,ref:t})});pee.displayName=bxe;var xxe="DropdownMenuItemIndicator",mee=oe.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,i=Xu(r);return F.jsx(oxe,{...i,...n,ref:t})});mee.displayName=xxe;var wxe="DropdownMenuSeparator",gee=oe.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,i=Xu(r);return F.jsx(axe,{...i,...n,ref:t})});gee.displayName=wxe;var Mxe="DropdownMenuArrow",Sxe=oe.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,i=Xu(r);return F.jsx(sxe,{...i,...n,ref:t})});Sxe.displayName=Mxe;var Txe="DropdownMenuSubTrigger",_ee=oe.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,i=Xu(r);return F.jsx(lxe,{...i,...n,ref:t})});_ee.displayName=Txe;var Pxe="DropdownMenuSubContent",yee=oe.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,i=Xu(r);return F.jsx(cxe,{...i,...n,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});yee.displayName=Pxe;var Exe=oee,Axe=see,Cxe=lee,vee=uee,bee=dee,xee=hee,wee=fee,Mee=pee,See=mee,Tee=gee,Pee=_ee,Eee=yee;const kxe=Exe,Ixe=Axe,Oxe=oe.forwardRef(({className:e,inset:t,children:r,...n},i)=>F.jsxs(Pee,{ref:i,className:_i("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",e),...n,children:[r,F.jsx(hge,{className:"ml-auto h-4 w-4"})]}));Oxe.displayName=Pee.displayName;const Lxe=oe.forwardRef(({className:e,...t},r)=>F.jsx(Eee,{ref:r,className:_i("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));Lxe.displayName=Eee.displayName;const Aee=oe.forwardRef(({className:e,sideOffset:t=4,...r},n)=>F.jsx(Cxe,{children:F.jsx(vee,{ref:n,sideOffset:t,className:_i("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));Aee.displayName=vee.displayName;const mD=oe.forwardRef(({className:e,inset:t,...r},n)=>F.jsx(xee,{ref:n,className:_i("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...r}));mD.displayName=xee.displayName;const Dxe=oe.forwardRef(({className:e,children:t,checked:r,...n},i)=>F.jsxs(wee,{ref:i,className:_i("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:r,...n,children:[F.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:F.jsx(See,{children:F.jsx(J4,{className:"h-4 w-4"})})}),t]}));Dxe.displayName=wee.displayName;const $xe=oe.forwardRef(({className:e,children:t,...r},n)=>F.jsxs(Mee,{ref:n,className:_i("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[F.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:F.jsx(See,{children:F.jsx(pge,{className:"h-2 w-2 fill-current"})})}),t]}));$xe.displayName=Mee.displayName;const Nxe=oe.forwardRef(({className:e,inset:t,...r},n)=>F.jsx(bee,{ref:n,className:_i("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...r}));Nxe.displayName=bee.displayName;const Cee=oe.forwardRef(({className:e,...t},r)=>F.jsx(Tee,{ref:r,className:_i("-mx-1 my-1 h-px bg-muted",e),...t}));Cee.displayName=Tee.displayName;const jxe=()=>{const{user:e,logout:t}=Xp(),r=k0(),[n,i]=oe.useState(!1),o=d=>r.pathname===d,s=[{href:"/",label:"Home",icon:xge},{href:"/atlas",label:"FRA Atlas",icon:YY},{href:"/ai-insights",label:"AI Insights",icon:KY},{href:"/dss",label:"DSS",icon:JL},{href:"/export",label:"Export",icon:G2}],a=()=>{i(!n),document.documentElement.classList.toggle("dark")},u=d=>{switch(d){case"admin":return"bg-destructive text-destructive-foreground";case"officer":return"bg-warning text-warning-foreground";default:return"bg-success text-success-foreground"}};return e?F.jsx("nav",{className:"fixed top-0 left-0 right-0 z-50 bg-card/80 backdrop-blur-md border-b border-border shadow-sm",children:F.jsx("div",{className:"container mx-auto px-4",children:F.jsxs("div",{className:"flex items-center justify-between h-16",children:[F.jsxs("div",{className:"flex items-center space-x-3",children:[F.jsx("div",{className:"w-8 h-8 bg-primary rounded-lg flex items-center justify-center",children:F.jsx(QY,{className:"w-5 h-5 text-primary-foreground"})}),F.jsxs("div",{className:"hidden md:block",children:[F.jsx("h1",{className:"text-lg font-bold text-foreground",children:"FRA Atlas Portal"}),F.jsx("p",{className:"text-xs text-muted-foreground",children:"Decision Support System"})]})]}),F.jsx("div",{className:"hidden md:flex items-center space-x-1",children:s.map(d=>{const m=d.icon;return F.jsxs(xA,{to:d.href,className:`flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium transition-colors ${o(d.href)?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground hover:bg-accent"}`,children:[F.jsx(m,{className:"w-4 h-4"}),F.jsx("span",{children:d.label})]},d.href)})}),F.jsxs("div",{className:"flex items-center space-x-3",children:[F.jsx(iu,{variant:"ghost",size:"icon",onClick:a,className:"w-9 h-9",children:n?F.jsx(Pge,{className:"w-4 h-4"}):F.jsx(Tge,{className:"w-4 h-4"})}),F.jsxs(kxe,{children:[F.jsx(Ixe,{asChild:!0,children:F.jsxs(iu,{variant:"ghost",className:"flex items-center space-x-2",children:[F.jsx(yJ,{className:"w-8 h-8",children:F.jsx(vJ,{className:"bg-primary text-primary-foreground text-xs",children:e.name.split(" ").map(d=>d[0]).join("")})}),F.jsxs("div",{className:"hidden md:block text-left",children:[F.jsx("p",{className:"text-sm font-medium",children:e.name}),F.jsx("div",{className:"flex items-center space-x-1",children:F.jsx("span",{className:`px-1.5 py-0.5 rounded text-xs font-medium ${u(e.role)}`,children:e.role.toUpperCase()})})]})]})}),F.jsxs(Aee,{align:"end",className:"w-56",children:[F.jsxs(mD,{children:[F.jsx(JY,{className:"w-4 h-4 mr-2"}),"Profile"]}),F.jsx(Cee,{}),F.jsxs(mD,{onClick:t,className:"text-destructive",children:[F.jsx(Sge,{className:"w-4 h-4 mr-2"}),"Logout"]})]})]})]})]})})}):null},kee=oe.createContext({});function Rxe(e){const t=oe.useRef(null);return t.current===null&&(t.current=e()),t.current}const Oj=typeof window<"u",Fxe=Oj?oe.useLayoutEffect:oe.useEffect,Lj=oe.createContext(null);function Dj(e,t){e.indexOf(t)===-1&&e.push(t)}function $j(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}const qm=(e,t,r)=>r>t?t:r<e?e:r;let SA=()=>{};const Hm={},Iee=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function Oee(e){return typeof e=="object"&&e!==null}const Lee=e=>/^0[^.\s]+$/u.test(e);function Nj(e){let t;return()=>(t===void 0&&(t=e()),t)}const Dh=e=>e,zxe=(e,t)=>r=>t(e(r)),gS=(...e)=>e.reduce(zxe),tM=(e,t,r)=>{const n=t-e;return n===0?1:(r-e)/n};class jj{constructor(){this.subscriptions=[]}add(t){return Dj(this.subscriptions,t),()=>$j(this.subscriptions,t)}notify(t,r,n){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](t,r,n);else for(let o=0;o<i;o++){const s=this.subscriptions[o];s&&s(t,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Rp=e=>e*1e3,Fp=e=>e/1e3;function Dee(e,t){return t?e*(1e3/t):0}const $ee=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,Bxe=1e-7,Uxe=12;function Vxe(e,t,r,n,i){let o,s,a=0;do s=t+(r-t)/2,o=$ee(s,n,i)-e,o>0?r=s:t=s;while(Math.abs(o)>Bxe&&++a<Uxe);return s}function _S(e,t,r,n){if(e===t&&r===n)return Dh;const i=o=>Vxe(o,0,1,e,r);return o=>o===0||o===1?o:$ee(i(o),t,n)}const Nee=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,jee=e=>t=>1-e(1-t),Ree=_S(.33,1.53,.69,.99),Rj=jee(Ree),Fee=Nee(Rj),zee=e=>(e*=2)<1?.5*Rj(e):.5*(2-Math.pow(2,-10*(e-1))),Fj=e=>1-Math.sin(Math.acos(e)),Bee=jee(Fj),Uee=Nee(Fj),Wxe=_S(.42,0,1,1),Gxe=_S(0,0,.58,1),Vee=_S(.42,0,.58,1),qxe=e=>Array.isArray(e)&&typeof e[0]!="number",Wee=e=>Array.isArray(e)&&typeof e[0]=="number",C6={linear:Dh,easeIn:Wxe,easeInOut:Vee,easeOut:Gxe,circIn:Fj,circInOut:Uee,circOut:Bee,backIn:Rj,backInOut:Fee,backOut:Ree,anticipate:zee},Hxe=e=>typeof e=="string",k6=e=>{if(Wee(e)){SA(e.length===4);const[t,r,n,i]=e;return _S(t,r,n,i)}else if(Hxe(e))return SA(C6[e]!==void 0),C6[e];return e},bP=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],I6={value:null,addProjectionMetrics:null};function Kxe(e,t){let r=new Set,n=new Set,i=!1,o=!1;const s=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1},u=0;function d(g){s.has(g)&&(m.schedule(g),e()),u++,g(a)}const m={schedule:(g,_=!1,y=!1)=>{const x=y&&i?r:n;return _&&s.add(g),x.has(g)||x.add(g),g},cancel:g=>{n.delete(g),s.delete(g)},process:g=>{if(a=g,i){o=!0;return}i=!0,[r,n]=[n,r],r.forEach(d),t&&I6.value&&I6.value.frameloop[t].push(u),u=0,r.clear(),i=!1,o&&(o=!1,m.process(g))}};return m}const Zxe=40;function Gee(e,t){let r=!1,n=!0;const i={delta:0,timestamp:0,isProcessing:!1},o=()=>r=!0,s=bP.reduce((C,D)=>(C[D]=Kxe(o,t?D:void 0),C),{}),{setup:a,read:u,resolveKeyframes:d,preUpdate:m,update:g,preRender:_,render:y,postRender:M}=s,x=()=>{const C=Hm.useManualTiming?i.timestamp:performance.now();r=!1,Hm.useManualTiming||(i.delta=n?1e3/60:Math.max(Math.min(C-i.timestamp,Zxe),1)),i.timestamp=C,i.isProcessing=!0,a.process(i),u.process(i),d.process(i),m.process(i),g.process(i),_.process(i),y.process(i),M.process(i),i.isProcessing=!1,r&&t&&(n=!1,e(x))},E=()=>{r=!0,n=!0,i.isProcessing||e(x)};return{schedule:bP.reduce((C,D)=>{const L=s[D];return C[D]=(N,j=!1,$=!1)=>(r||E(),L.schedule(N,j,$)),C},{}),cancel:C=>{for(let D=0;D<bP.length;D++)s[bP[D]].cancel(C)},state:i,steps:s}}const{schedule:Ls,cancel:T_,state:nu,steps:FI}=Gee(typeof requestAnimationFrame<"u"?requestAnimationFrame:Dh,!0);let EE;function Xxe(){EE=void 0}const ud={now:()=>(EE===void 0&&ud.set(nu.isProcessing||Hm.useManualTiming?nu.timestamp:performance.now()),EE),set:e=>{EE=e,queueMicrotask(Xxe)}},qee=e=>t=>typeof t=="string"&&t.startsWith(e),zj=qee("--"),Yxe=qee("var(--"),Bj=e=>Yxe(e)?Qxe.test(e.split("/*")[0].trim()):!1,Qxe=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Rb={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},rM={...Rb,transform:e=>qm(0,1,e)},xP={...Rb,default:1},d2=e=>Math.round(e*1e5)/1e5,Uj=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Jxe(e){return e==null}const ewe=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Vj=(e,t)=>r=>!!(typeof r=="string"&&ewe.test(r)&&r.startsWith(e)||t&&!Jxe(r)&&Object.prototype.hasOwnProperty.call(r,t)),Hee=(e,t,r)=>n=>{if(typeof n!="string")return n;const[i,o,s,a]=n.match(Uj);return{[e]:parseFloat(i),[t]:parseFloat(o),[r]:parseFloat(s),alpha:a!==void 0?parseFloat(a):1}},twe=e=>qm(0,255,e),zI={...Rb,transform:e=>Math.round(twe(e))},ky={test:Vj("rgb","red"),parse:Hee("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:n=1})=>"rgba("+zI.transform(e)+", "+zI.transform(t)+", "+zI.transform(r)+", "+d2(rM.transform(n))+")"};function rwe(e){let t="",r="",n="",i="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7),i=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),n=e.substring(3,4),i=e.substring(4,5),t+=t,r+=r,n+=n,i+=i),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:i?parseInt(i,16)/255:1}}const gD={test:Vj("#"),parse:rwe,transform:ky.transform},yS=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Ng=yS("deg"),zp=yS("%"),ki=yS("px"),nwe=yS("vh"),iwe=yS("vw"),O6={...zp,parse:e=>zp.parse(e)/100,transform:e=>zp.transform(e*100)},Qv={test:Vj("hsl","hue"),parse:Hee("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(e)+", "+zp.transform(d2(t))+", "+zp.transform(d2(r))+", "+d2(rM.transform(n))+")"},ql={test:e=>ky.test(e)||gD.test(e)||Qv.test(e),parse:e=>ky.test(e)?ky.parse(e):Qv.test(e)?Qv.parse(e):gD.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?ky.transform(e):Qv.transform(e),getAnimatableNone:e=>{const t=ql.parse(e);return t.alpha=0,ql.transform(t)}},owe=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function awe(e){var t,r;return isNaN(e)&&typeof e=="string"&&(((t=e.match(Uj))==null?void 0:t.length)||0)+(((r=e.match(owe))==null?void 0:r.length)||0)>0}const Kee="number",Zee="color",swe="var",lwe="var(",L6="${}",cwe=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function nM(e){const t=e.toString(),r=[],n={color:[],number:[],var:[]},i=[];let o=0;const a=t.replace(cwe,u=>(ql.test(u)?(n.color.push(o),i.push(Zee),r.push(ql.parse(u))):u.startsWith(lwe)?(n.var.push(o),i.push(swe),r.push(u)):(n.number.push(o),i.push(Kee),r.push(parseFloat(u))),++o,L6)).split(L6);return{values:r,split:a,indexes:n,types:i}}function Xee(e){return nM(e).values}function Yee(e){const{split:t,types:r}=nM(e),n=t.length;return i=>{let o="";for(let s=0;s<n;s++)if(o+=t[s],i[s]!==void 0){const a=r[s];a===Kee?o+=d2(i[s]):a===Zee?o+=ql.transform(i[s]):o+=i[s]}return o}}const uwe=e=>typeof e=="number"?0:ql.test(e)?ql.getAnimatableNone(e):e;function dwe(e){const t=Xee(e);return Yee(e)(t.map(uwe))}const P_={test:awe,parse:Xee,createTransformer:Yee,getAnimatableNone:dwe};function BI(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function hwe({hue:e,saturation:t,lightness:r,alpha:n}){e/=360,t/=100,r/=100;let i=0,o=0,s=0;if(!t)i=o=s=r;else{const a=r<.5?r*(1+t):r+t-r*t,u=2*r-a;i=BI(u,a,e+1/3),o=BI(u,a,e),s=BI(u,a,e-1/3)}return{red:Math.round(i*255),green:Math.round(o*255),blue:Math.round(s*255),alpha:n}}function TA(e,t){return r=>r>0?t:e}const qs=(e,t,r)=>e+(t-e)*r,UI=(e,t,r)=>{const n=e*e,i=r*(t*t-n)+n;return i<0?0:Math.sqrt(i)},fwe=[gD,ky,Qv],pwe=e=>fwe.find(t=>t.test(e));function D6(e){const t=pwe(e);if(!t)return!1;let r=t.parse(e);return t===Qv&&(r=hwe(r)),r}const $6=(e,t)=>{const r=D6(e),n=D6(t);if(!r||!n)return TA(e,t);const i={...r};return o=>(i.red=UI(r.red,n.red,o),i.green=UI(r.green,n.green,o),i.blue=UI(r.blue,n.blue,o),i.alpha=qs(r.alpha,n.alpha,o),ky.transform(i))},_D=new Set(["none","hidden"]);function mwe(e,t){return _D.has(e)?r=>r<=0?e:t:r=>r>=1?t:e}function gwe(e,t){return r=>qs(e,t,r)}function Wj(e){return typeof e=="number"?gwe:typeof e=="string"?Bj(e)?TA:ql.test(e)?$6:vwe:Array.isArray(e)?Qee:typeof e=="object"?ql.test(e)?$6:_we:TA}function Qee(e,t){const r=[...e],n=r.length,i=e.map((o,s)=>Wj(o)(o,t[s]));return o=>{for(let s=0;s<n;s++)r[s]=i[s](o);return r}}function _we(e,t){const r={...e,...t},n={};for(const i in r)e[i]!==void 0&&t[i]!==void 0&&(n[i]=Wj(e[i])(e[i],t[i]));return i=>{for(const o in n)r[o]=n[o](i);return r}}function ywe(e,t){const r=[],n={color:0,var:0,number:0};for(let i=0;i<t.values.length;i++){const o=t.types[i],s=e.indexes[o][n[o]],a=e.values[s]??0;r[i]=a,n[o]++}return r}const vwe=(e,t)=>{const r=P_.createTransformer(t),n=nM(e),i=nM(t);return n.indexes.var.length===i.indexes.var.length&&n.indexes.color.length===i.indexes.color.length&&n.indexes.number.length>=i.indexes.number.length?_D.has(e)&&!i.values.length||_D.has(t)&&!n.values.length?mwe(e,t):gS(Qee(ywe(n,i),i.values),r):TA(e,t)};function Jee(e,t,r){return typeof e=="number"&&typeof t=="number"&&typeof r=="number"?qs(e,t,r):Wj(e)(e,t)}const bwe=e=>{const t=({timestamp:r})=>e(r);return{start:(r=!0)=>Ls.update(t,r),stop:()=>T_(t),now:()=>nu.isProcessing?nu.timestamp:ud.now()}},ete=(e,t,r=10)=>{let n="";const i=Math.max(Math.round(t/r),2);for(let o=0;o<i;o++)n+=Math.round(e(o/(i-1))*1e4)/1e4+", ";return`linear(${n.substring(0,n.length-2)})`},PA=2e4;function Gj(e){let t=0;const r=50;let n=e.next(t);for(;!n.done&&t<PA;)t+=r,n=e.next(t);return t>=PA?1/0:t}function xwe(e,t=100,r){const n=r({...e,keyframes:[0,t]}),i=Math.min(Gj(n),PA);return{type:"keyframes",ease:o=>n.next(i*o).value/t,duration:Fp(i)}}const wwe=5;function tte(e,t,r){const n=Math.max(t-wwe,0);return Dee(r-e(n),t-n)}const sl={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},VI=.001;function Mwe({duration:e=sl.duration,bounce:t=sl.bounce,velocity:r=sl.velocity,mass:n=sl.mass}){let i,o,s=1-t;s=qm(sl.minDamping,sl.maxDamping,s),e=qm(sl.minDuration,sl.maxDuration,Fp(e)),s<1?(i=d=>{const m=d*s,g=m*e,_=m-r,y=yD(d,s),M=Math.exp(-g);return VI-_/y*M},o=d=>{const g=d*s*e,_=g*r+r,y=Math.pow(s,2)*Math.pow(d,2)*e,M=Math.exp(-g),x=yD(Math.pow(d,2),s);return(-i(d)+VI>0?-1:1)*((_-y)*M)/x}):(i=d=>{const m=Math.exp(-d*e),g=(d-r)*e+1;return-VI+m*g},o=d=>{const m=Math.exp(-d*e),g=(r-d)*(e*e);return m*g});const a=5/e,u=Twe(i,o,a);if(e=Rp(e),isNaN(u))return{stiffness:sl.stiffness,damping:sl.damping,duration:e};{const d=Math.pow(u,2)*n;return{stiffness:d,damping:s*2*Math.sqrt(n*d),duration:e}}}const Swe=12;function Twe(e,t,r){let n=r;for(let i=1;i<Swe;i++)n=n-e(n)/t(n);return n}function yD(e,t){return e*Math.sqrt(1-t*t)}const Pwe=["duration","bounce"],Ewe=["stiffness","damping","mass"];function N6(e,t){return t.some(r=>e[r]!==void 0)}function Awe(e){let t={velocity:sl.velocity,stiffness:sl.stiffness,damping:sl.damping,mass:sl.mass,isResolvedFromDuration:!1,...e};if(!N6(e,Ewe)&&N6(e,Pwe))if(e.visualDuration){const r=e.visualDuration,n=2*Math.PI/(r*1.2),i=n*n,o=2*qm(.05,1,1-(e.bounce||0))*Math.sqrt(i);t={...t,mass:sl.mass,stiffness:i,damping:o}}else{const r=Mwe(e);t={...t,...r,mass:sl.mass},t.isResolvedFromDuration=!0}return t}function EA(e=sl.visualDuration,t=sl.bounce){const r=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:n,restDelta:i}=r;const o=r.keyframes[0],s=r.keyframes[r.keyframes.length-1],a={done:!1,value:o},{stiffness:u,damping:d,mass:m,duration:g,velocity:_,isResolvedFromDuration:y}=Awe({...r,velocity:-Fp(r.velocity||0)}),M=_||0,x=d/(2*Math.sqrt(u*m)),E=s-o,T=Fp(Math.sqrt(u/m)),P=Math.abs(E)<5;n||(n=P?sl.restSpeed.granular:sl.restSpeed.default),i||(i=P?sl.restDelta.granular:sl.restDelta.default);let C;if(x<1){const L=yD(T,x);C=N=>{const j=Math.exp(-x*T*N);return s-j*((M+x*T*E)/L*Math.sin(L*N)+E*Math.cos(L*N))}}else if(x===1)C=L=>s-Math.exp(-T*L)*(E+(M+T*E)*L);else{const L=T*Math.sqrt(x*x-1);C=N=>{const j=Math.exp(-x*T*N),$=Math.min(L*N,300);return s-j*((M+x*T*E)*Math.sinh($)+L*E*Math.cosh($))/L}}const D={calculatedDuration:y&&g||null,next:L=>{const N=C(L);if(y)a.done=L>=g;else{let j=L===0?M:0;x<1&&(j=L===0?Rp(M):tte(C,L,N));const $=Math.abs(j)<=n,U=Math.abs(s-N)<=i;a.done=$&&U}return a.value=a.done?s:N,a},toString:()=>{const L=Math.min(Gj(D),PA),N=ete(j=>D.next(L*j).value,L,30);return L+"ms "+N},toTransition:()=>{}};return D}EA.applyToOptions=e=>{const t=xwe(e,100,EA);return e.ease=t.ease,e.duration=Rp(t.duration),e.type="keyframes",e};function vD({keyframes:e,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:i=10,bounceStiffness:o=500,modifyTarget:s,min:a,max:u,restDelta:d=.5,restSpeed:m}){const g=e[0],_={done:!1,value:g},y=$=>a!==void 0&&$<a||u!==void 0&&$>u,M=$=>a===void 0?u:u===void 0||Math.abs(a-$)<Math.abs(u-$)?a:u;let x=r*t;const E=g+x,T=s===void 0?E:s(E);T!==E&&(x=T-g);const P=$=>-x*Math.exp(-$/n),C=$=>T+P($),D=$=>{const U=P($),G=C($);_.done=Math.abs(U)<=d,_.value=_.done?T:G};let L,N;const j=$=>{y(_.value)&&(L=$,N=EA({keyframes:[_.value,M(_.value)],velocity:tte(C,$,_.value),damping:i,stiffness:o,restDelta:d,restSpeed:m}))};return j(0),{calculatedDuration:null,next:$=>{let U=!1;return!N&&L===void 0&&(U=!0,D($),j($)),L!==void 0&&$>=L?N.next($-L):(!U&&D($),_)}}}function Cwe(e,t,r){const n=[],i=r||Hm.mix||Jee,o=e.length-1;for(let s=0;s<o;s++){let a=i(e[s],e[s+1]);if(t){const u=Array.isArray(t)?t[s]||Dh:t;a=gS(u,a)}n.push(a)}return n}function kwe(e,t,{clamp:r=!0,ease:n,mixer:i}={}){const o=e.length;if(SA(o===t.length),o===1)return()=>t[0];if(o===2&&t[0]===t[1])return()=>t[1];const s=e[0]===e[1];e[0]>e[o-1]&&(e=[...e].reverse(),t=[...t].reverse());const a=Cwe(t,n,i),u=a.length,d=m=>{if(s&&m<e[0])return t[0];let g=0;if(u>1)for(;g<e.length-2&&!(m<e[g+1]);g++);const _=tM(e[g],e[g+1],m);return a[g](_)};return r?m=>d(qm(e[0],e[o-1],m)):d}function Iwe(e,t){const r=e[e.length-1];for(let n=1;n<=t;n++){const i=tM(0,t,n);e.push(qs(r,1,i))}}function Owe(e){const t=[0];return Iwe(t,e.length-1),t}function Lwe(e,t){return e.map(r=>r*t)}function Dwe(e,t){return e.map(()=>t||Vee).splice(0,e.length-1)}function h2({duration:e=300,keyframes:t,times:r,ease:n="easeInOut"}){const i=qxe(n)?n.map(k6):k6(n),o={done:!1,value:t[0]},s=Lwe(r&&r.length===t.length?r:Owe(t),e),a=kwe(s,t,{ease:Array.isArray(i)?i:Dwe(t,i)});return{calculatedDuration:e,next:u=>(o.value=a(u),o.done=u>=e,o)}}const $we=e=>e!==null;function qj(e,{repeat:t,repeatType:r="loop"},n,i=1){const o=e.filter($we),a=i<0||t&&r!=="loop"&&t%2===1?0:o.length-1;return!a||n===void 0?o[a]:n}const Nwe={decay:vD,inertia:vD,tween:h2,keyframes:h2,spring:EA};function rte(e){typeof e.type=="string"&&(e.type=Nwe[e.type])}class Hj{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,r){return this.finished.then(t,r)}}const jwe=e=>e/100;class Kj extends Hj{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var n,i;const{motionValue:r}=this.options;r&&r.updatedAt!==ud.now()&&this.tick(ud.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(i=(n=this.options).onStop)==null||i.call(n))},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;rte(t);const{type:r=h2,repeat:n=0,repeatDelay:i=0,repeatType:o,velocity:s=0}=t;let{keyframes:a}=t;const u=r||h2;u!==h2&&typeof a[0]!="number"&&(this.mixKeyframes=gS(jwe,Jee(a[0],a[1])),a=[0,100]);const d=u({...t,keyframes:a});o==="mirror"&&(this.mirroredGenerator=u({...t,keyframes:[...a].reverse(),velocity:-s})),d.calculatedDuration===null&&(d.calculatedDuration=Gj(d));const{calculatedDuration:m}=d;this.calculatedDuration=m,this.resolvedDuration=m+i,this.totalDuration=this.resolvedDuration*(n+1)-i,this.generator=d}updateTime(t){const r=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(t,r=!1){const{generator:n,totalDuration:i,mixKeyframes:o,mirroredGenerator:s,resolvedDuration:a,calculatedDuration:u}=this;if(this.startTime===null)return n.next(0);const{delay:d=0,keyframes:m,repeat:g,repeatType:_,repeatDelay:y,type:M,onUpdate:x,finalKeyframe:E}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-i/this.speed,this.startTime)),r?this.currentTime=t:this.updateTime(t);const T=this.currentTime-d*(this.playbackSpeed>=0?1:-1),P=this.playbackSpeed>=0?T<0:T>i;this.currentTime=Math.max(T,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let C=this.currentTime,D=n;if(g){const $=Math.min(this.currentTime,i)/a;let U=Math.floor($),G=$%1;!G&&$>=1&&(G=1),G===1&&U--,U=Math.min(U,g+1),!!(U%2)&&(_==="reverse"?(G=1-G,y&&(G-=y/a)):_==="mirror"&&(D=s)),C=qm(0,1,G)*a}const L=P?{done:!1,value:m[0]}:D.next(C);o&&(L.value=o(L.value));let{done:N}=L;!P&&u!==null&&(N=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const j=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&N);return j&&M!==vD&&(L.value=qj(m,this.options,E,this.speed)),x&&x(L.value),j&&this.finish(),L}then(t,r){return this.finished.then(t,r)}get duration(){return Fp(this.calculatedDuration)}get time(){return Fp(this.currentTime)}set time(t){var r;t=Rp(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),(r=this.driver)==null||r.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(ud.now());const r=this.playbackSpeed!==t;this.playbackSpeed=t,r&&(this.time=Fp(this.currentTime))}play(){var i,o;if(this.isStopped)return;const{driver:t=bwe,startTime:r}=this.options;this.driver||(this.driver=t(s=>this.tick(s))),(o=(i=this.options).onPlay)==null||o.call(i);const n=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=n):this.holdTime!==null?this.startTime=n-this.holdTime:this.startTime||(this.startTime=r??n),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(ud.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var t,r;this.notifyFinished(),this.teardown(),this.state="finished",(r=(t=this.options).onComplete)==null||r.call(t)}cancel(){var t,r;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(r=(t=this.options).onCancel)==null||r.call(t)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){var r;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(r=this.driver)==null||r.stop(),t.observe(this)}}function Rwe(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const Iy=e=>e*180/Math.PI,bD=e=>{const t=Iy(Math.atan2(e[1],e[0]));return xD(t)},Fwe={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:bD,rotateZ:bD,skewX:e=>Iy(Math.atan(e[1])),skewY:e=>Iy(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},xD=e=>(e=e%360,e<0&&(e+=360),e),j6=bD,R6=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),F6=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),zwe={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:R6,scaleY:F6,scale:e=>(R6(e)+F6(e))/2,rotateX:e=>xD(Iy(Math.atan2(e[6],e[5]))),rotateY:e=>xD(Iy(Math.atan2(-e[2],e[0]))),rotateZ:j6,rotate:j6,skewX:e=>Iy(Math.atan(e[4])),skewY:e=>Iy(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function wD(e){return e.includes("scale")?1:0}function MD(e,t){if(!e||e==="none")return wD(t);const r=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,i;if(r)n=zwe,i=r;else{const a=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=Fwe,i=a}if(!i)return wD(t);const o=n[t],s=i[1].split(",").map(Uwe);return typeof o=="function"?o(s):s[o]}const Bwe=(e,t)=>{const{transform:r="none"}=getComputedStyle(e);return MD(r,t)};function Uwe(e){return parseFloat(e.trim())}const Fb=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],zb=new Set(Fb),z6=e=>e===Rb||e===ki,Vwe=new Set(["x","y","z"]),Wwe=Fb.filter(e=>!Vwe.has(e));function Gwe(e){const t=[];return Wwe.forEach(r=>{const n=e.getValue(r);n!==void 0&&(t.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),t}const Zy={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>MD(t,"x"),y:(e,{transform:t})=>MD(t,"y")};Zy.translateX=Zy.x;Zy.translateY=Zy.y;const Xy=new Set;let SD=!1,TD=!1,PD=!1;function nte(){if(TD){const e=Array.from(Xy).filter(n=>n.needsMeasurement),t=new Set(e.map(n=>n.element)),r=new Map;t.forEach(n=>{const i=Gwe(n);i.length&&(r.set(n,i),n.render())}),e.forEach(n=>n.measureInitialState()),t.forEach(n=>{n.render();const i=r.get(n);i&&i.forEach(([o,s])=>{var a;(a=n.getValue(o))==null||a.set(s)})}),e.forEach(n=>n.measureEndState()),e.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}TD=!1,SD=!1,Xy.forEach(e=>e.complete(PD)),Xy.clear()}function ite(){Xy.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(TD=!0)})}function qwe(){PD=!0,ite(),nte(),PD=!1}class Zj{constructor(t,r,n,i,o,s=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=r,this.name=n,this.motionValue=i,this.element=o,this.isAsync=s}scheduleResolve(){this.state="scheduled",this.isAsync?(Xy.add(this),SD||(SD=!0,Ls.read(ite),Ls.resolveKeyframes(nte))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:r,element:n,motionValue:i}=this;if(t[0]===null){const o=i==null?void 0:i.get(),s=t[t.length-1];if(o!==void 0)t[0]=o;else if(n&&r){const a=n.readValue(r,s);a!=null&&(t[0]=a)}t[0]===void 0&&(t[0]=s),i&&o===void 0&&i.set(t[0])}Rwe(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),Xy.delete(this)}cancel(){this.state==="scheduled"&&(Xy.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const Hwe=e=>e.startsWith("--");function Kwe(e,t,r){Hwe(t)?e.style.setProperty(t,r):e.style[t]=r}const Zwe=Nj(()=>window.ScrollTimeline!==void 0),Xwe={};function Ywe(e,t){const r=Nj(e);return()=>Xwe[t]??r()}const ote=Ywe(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),qw=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`,B6={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:qw([0,.65,.55,1]),circOut:qw([.55,0,1,.45]),backIn:qw([.31,.01,.66,-.59]),backOut:qw([.33,1.53,.69,.99])};function ate(e,t){if(e)return typeof e=="function"?ote()?ete(e,t):"ease-out":Wee(e)?qw(e):Array.isArray(e)?e.map(r=>ate(r,t)||B6.easeOut):B6[e]}function Qwe(e,t,r,{delay:n=0,duration:i=300,repeat:o=0,repeatType:s="loop",ease:a="easeOut",times:u}={},d=void 0){const m={[t]:r};u&&(m.offset=u);const g=ate(a,i);Array.isArray(g)&&(m.easing=g);const _={delay:n,duration:i,easing:Array.isArray(g)?"linear":g,fill:"both",iterations:o+1,direction:s==="reverse"?"alternate":"normal"};return d&&(_.pseudoElement=d),e.animate(m,_)}function ste(e){return typeof e=="function"&&"applyToOptions"in e}function Jwe({type:e,...t}){return ste(e)&&ote()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class e2e extends Hj{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:r,name:n,keyframes:i,pseudoElement:o,allowFlatten:s=!1,finalKeyframe:a,onComplete:u}=t;this.isPseudoElement=!!o,this.allowFlatten=s,this.options=t,SA(typeof t.type!="string");const d=Jwe(t);this.animation=Qwe(r,n,i,d,o),d.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!o){const m=qj(i,this.options,a,this.speed);this.updateMotionValue?this.updateMotionValue(m):Kwe(r,n,m),this.animation.cancel()}u==null||u(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,r;(r=(t=this.animation).finish)==null||r.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,r;this.isPseudoElement||(r=(t=this.animation).commitStyles)==null||r.call(t)}get duration(){var r,n;const t=((n=(r=this.animation.effect)==null?void 0:r.getComputedTiming)==null?void 0:n.call(r).duration)||0;return Fp(Number(t))}get time(){return Fp(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=Rp(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:r}){var n;return this.allowFlatten&&((n=this.animation.effect)==null||n.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&Zwe()?(this.animation.timeline=t,Dh):r(this)}}const lte={anticipate:zee,backInOut:Fee,circInOut:Uee};function t2e(e){return e in lte}function r2e(e){typeof e.ease=="string"&&t2e(e.ease)&&(e.ease=lte[e.ease])}const U6=10;class n2e extends e2e{constructor(t){r2e(t),rte(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:r,onUpdate:n,onComplete:i,element:o,...s}=this.options;if(!r)return;if(t!==void 0){r.set(t);return}const a=new Kj({...s,autoplay:!1}),u=Rp(this.finishedTime??this.time);r.setWithVelocity(a.sample(u-U6).value,a.sample(u).value,U6),a.stop()}}const V6=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(P_.test(e)||e==="0")&&!e.startsWith("url("));function i2e(e){const t=e[0];if(e.length===1)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}function o2e(e,t,r,n){const i=e[0];if(i===null)return!1;if(t==="display"||t==="visibility")return!0;const o=e[e.length-1],s=V6(i,t),a=V6(o,t);return!s||!a?!1:i2e(e)||(r==="spring"||ste(r))&&n}function ED(e){e.duration=0,e.type}const a2e=new Set(["opacity","clipPath","filter","transform"]),s2e=Nj(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function l2e(e){var m;const{motionValue:t,name:r,repeatDelay:n,repeatType:i,damping:o,type:s}=e;if(!(((m=t==null?void 0:t.owner)==null?void 0:m.current)instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:d}=t.owner.getProps();return s2e()&&r&&a2e.has(r)&&(r!=="transform"||!d)&&!u&&!n&&i!=="mirror"&&o!==0&&s!=="inertia"}const c2e=40;class u2e extends Hj{constructor({autoplay:t=!0,delay:r=0,type:n="keyframes",repeat:i=0,repeatDelay:o=0,repeatType:s="loop",keyframes:a,name:u,motionValue:d,element:m,...g}){var M;super(),this.stop=()=>{var x,E;this._animation&&(this._animation.stop(),(x=this.stopTimeline)==null||x.call(this)),(E=this.keyframeResolver)==null||E.cancel()},this.createdAt=ud.now();const _={autoplay:t,delay:r,type:n,repeat:i,repeatDelay:o,repeatType:s,name:u,motionValue:d,element:m,...g},y=(m==null?void 0:m.KeyframeResolver)||Zj;this.keyframeResolver=new y(a,(x,E,T)=>this.onKeyframesResolved(x,E,_,!T),u,d,m),(M=this.keyframeResolver)==null||M.scheduleResolve()}onKeyframesResolved(t,r,n,i){this.keyframeResolver=void 0;const{name:o,type:s,velocity:a,delay:u,isHandoff:d,onUpdate:m}=n;this.resolvedAt=ud.now(),o2e(t,o,s,a)||((Hm.instantAnimations||!u)&&(m==null||m(qj(t,n,r))),t[0]=t[t.length-1],ED(n),n.repeat=0);const _={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>c2e?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...n,keyframes:t},y=!d&&l2e(_)?new n2e({..._,element:_.motionValue.owner.current}):new Kj(_);y.finished.then(()=>this.notifyFinished()).catch(Dh),this.pendingTimeline&&(this.stopTimeline=y.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=y}get finished(){return this._animation?this.animation.finished:this._finished}then(t,r){return this.finished.finally(t).then(()=>{})}get animation(){var t;return this._animation||((t=this.keyframeResolver)==null||t.resume(),qwe()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var t;this._animation&&this.animation.cancel(),(t=this.keyframeResolver)==null||t.cancel()}}const d2e=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function h2e(e){const t=d2e.exec(e);if(!t)return[,];const[,r,n,i]=t;return[`--${r??n}`,i]}function cte(e,t,r=1){const[n,i]=h2e(e);if(!n)return;const o=window.getComputedStyle(t).getPropertyValue(n);if(o){const s=o.trim();return Iee(s)?parseFloat(s):s}return Bj(i)?cte(i,t,r+1):i}function Xj(e,t){return(e==null?void 0:e[t])??(e==null?void 0:e.default)??e}const ute=new Set(["width","height","top","left","right","bottom",...Fb]),f2e={test:e=>e==="auto",parse:e=>e},dte=e=>t=>t.test(e),hte=[Rb,ki,zp,Ng,iwe,nwe,f2e],W6=e=>hte.find(dte(e));function p2e(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||Lee(e):!0}const m2e=new Set(["brightness","contrast","saturate","opacity"]);function g2e(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=r.match(Uj)||[];if(!n)return e;const i=r.replace(n,"");let o=m2e.has(t)?1:0;return n!==r&&(o*=100),t+"("+o+i+")"}const _2e=/\b([a-z-]*)\(.*?\)/gu,AD={...P_,getAnimatableNone:e=>{const t=e.match(_2e);return t?t.map(g2e).join(" "):e}},G6={...Rb,transform:Math.round},y2e={rotate:Ng,rotateX:Ng,rotateY:Ng,rotateZ:Ng,scale:xP,scaleX:xP,scaleY:xP,scaleZ:xP,skew:Ng,skewX:Ng,skewY:Ng,distance:ki,translateX:ki,translateY:ki,translateZ:ki,x:ki,y:ki,z:ki,perspective:ki,transformPerspective:ki,opacity:rM,originX:O6,originY:O6,originZ:ki},Yj={borderWidth:ki,borderTopWidth:ki,borderRightWidth:ki,borderBottomWidth:ki,borderLeftWidth:ki,borderRadius:ki,radius:ki,borderTopLeftRadius:ki,borderTopRightRadius:ki,borderBottomRightRadius:ki,borderBottomLeftRadius:ki,width:ki,maxWidth:ki,height:ki,maxHeight:ki,top:ki,right:ki,bottom:ki,left:ki,padding:ki,paddingTop:ki,paddingRight:ki,paddingBottom:ki,paddingLeft:ki,margin:ki,marginTop:ki,marginRight:ki,marginBottom:ki,marginLeft:ki,backgroundPositionX:ki,backgroundPositionY:ki,...y2e,zIndex:G6,fillOpacity:rM,strokeOpacity:rM,numOctaves:G6},v2e={...Yj,color:ql,backgroundColor:ql,outlineColor:ql,fill:ql,stroke:ql,borderColor:ql,borderTopColor:ql,borderRightColor:ql,borderBottomColor:ql,borderLeftColor:ql,filter:AD,WebkitFilter:AD},fte=e=>v2e[e];function pte(e,t){let r=fte(e);return r!==AD&&(r=P_),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const b2e=new Set(["auto","none","0"]);function x2e(e,t,r){let n=0,i;for(;n<e.length&&!i;){const o=e[n];typeof o=="string"&&!b2e.has(o)&&nM(o).values.length&&(i=e[n]),n++}if(i&&r)for(const o of t)e[o]=pte(r,i)}class w2e extends Zj{constructor(t,r,n,i,o){super(t,r,n,i,o,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let u=0;u<t.length;u++){let d=t[u];if(typeof d=="string"&&(d=d.trim(),Bj(d))){const m=cte(d,r.current);m!==void 0&&(t[u]=m),u===t.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!ute.has(n)||t.length!==2)return;const[i,o]=t,s=W6(i),a=W6(o);if(s!==a)if(z6(s)&&z6(a))for(let u=0;u<t.length;u++){const d=t[u];typeof d=="string"&&(t[u]=parseFloat(d))}else Zy[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:r}=this,n=[];for(let i=0;i<t.length;i++)(t[i]===null||p2e(t[i]))&&n.push(i);n.length&&x2e(t,n,r)}measureInitialState(){const{element:t,unresolvedKeyframes:r,name:n}=this;if(!t||!t.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Zy[n](t.measureViewportBox(),window.getComputedStyle(t.current)),r[0]=this.measuredOrigin;const i=r[r.length-1];i!==void 0&&t.getValue(n,i).jump(i,!1)}measureEndState(){var a;const{element:t,name:r,unresolvedKeyframes:n}=this;if(!t||!t.current)return;const i=t.getValue(r);i&&i.jump(this.measuredOrigin,!1);const o=n.length-1,s=n[o];n[o]=Zy[r](t.measureViewportBox(),window.getComputedStyle(t.current)),s!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=s),(a=this.removedTransforms)!=null&&a.length&&this.removedTransforms.forEach(([u,d])=>{t.getValue(u).set(d)}),this.resolveNoneKeyframes()}}function M2e(e,t,r){if(e instanceof EventTarget)return[e];if(typeof e=="string"){const i=document.querySelectorAll(e);return i?Array.from(i):[]}return Array.from(e)}const mte=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function S2e(e){return Oee(e)&&"offsetHeight"in e}const q6=30,T2e=e=>!isNaN(parseFloat(e));class P2e{constructor(t,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=n=>{var o;const i=ud.now();if(this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&((o=this.events.change)==null||o.notify(this.current),this.dependents))for(const s of this.dependents)s.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=r.owner}setCurrent(t){this.current=t,this.updatedAt=ud.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=T2e(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new jj);const n=this.events[t].add(r);return t==="change"?()=>{n(),Ls.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-n}jump(t,r=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var t;(t=this.events.change)==null||t.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=ud.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>q6)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,q6);return Dee(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t,r;(t=this.dependents)==null||t.clear(),(r=this.events.destroy)==null||r.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Z1(e,t){return new P2e(e,t)}const{schedule:Qj,cancel:Let}=Gee(queueMicrotask,!1),wf={x:!1,y:!1};function gte(){return wf.x||wf.y}function E2e(e){return e==="x"||e==="y"?wf[e]?null:(wf[e]=!0,()=>{wf[e]=!1}):wf.x||wf.y?null:(wf.x=wf.y=!0,()=>{wf.x=wf.y=!1})}function _te(e,t){const r=M2e(e),n=new AbortController,i={passive:!0,...t,signal:n.signal};return[r,i,()=>n.abort()]}function H6(e){return!(e.pointerType==="touch"||gte())}function A2e(e,t,r={}){const[n,i,o]=_te(e,r),s=a=>{if(!H6(a))return;const{target:u}=a,d=t(u,a);if(typeof d!="function"||!u)return;const m=g=>{H6(g)&&(d(g),u.removeEventListener("pointerleave",m))};u.addEventListener("pointerleave",m,i)};return n.forEach(a=>{a.addEventListener("pointerenter",s,i)}),o}const yte=(e,t)=>t?e===t?!0:yte(e,t.parentElement):!1,Jj=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,C2e=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function k2e(e){return C2e.has(e.tagName)||e.tabIndex!==-1}const AE=new WeakSet;function K6(e){return t=>{t.key==="Enter"&&e(t)}}function WI(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const I2e=(e,t)=>{const r=e.currentTarget;if(!r)return;const n=K6(()=>{if(AE.has(r))return;WI(r,"down");const i=K6(()=>{WI(r,"up")}),o=()=>WI(r,"cancel");r.addEventListener("keyup",i,t),r.addEventListener("blur",o,t)});r.addEventListener("keydown",n,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",n),t)};function Z6(e){return Jj(e)&&!gte()}function O2e(e,t,r={}){const[n,i,o]=_te(e,r),s=a=>{const u=a.currentTarget;if(!Z6(a))return;AE.add(u);const d=t(u,a),m=(y,M)=>{window.removeEventListener("pointerup",g),window.removeEventListener("pointercancel",_),AE.has(u)&&AE.delete(u),Z6(y)&&typeof d=="function"&&d(y,{success:M})},g=y=>{m(y,u===window||u===document||r.useGlobalTarget||yte(u,y.target))},_=y=>{m(y,!1)};window.addEventListener("pointerup",g,i),window.addEventListener("pointercancel",_,i)};return n.forEach(a=>{(r.useGlobalTarget?window:a).addEventListener("pointerdown",s,i),S2e(a)&&(a.addEventListener("focus",d=>I2e(d,i)),!k2e(a)&&!a.hasAttribute("tabindex")&&(a.tabIndex=0))}),o}function vte(e){return Oee(e)&&"ownerSVGElement"in e}function L2e(e){return vte(e)&&e.tagName==="svg"}const Eu=e=>!!(e&&e.getVelocity),D2e=[...hte,ql,P_],$2e=e=>D2e.find(dte(e)),bte=oe.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function N2e(e=!0){const t=oe.useContext(Lj);if(t===null)return[!0,null];const{isPresent:r,onExitComplete:n,register:i}=t,o=oe.useId();oe.useEffect(()=>{if(e)return i(o)},[e]);const s=oe.useCallback(()=>e&&n&&n(o),[o,n,e]);return!r&&n?[!1,s]:[!0]}const xte=oe.createContext({strict:!1}),X6={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},X1={};for(const e in X6)X1[e]={isEnabled:t=>X6[e].some(r=>!!t[r])};function j2e(e){for(const t in e)X1[t]={...X1[t],...e[t]}}const R2e=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function AA(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||R2e.has(e)}let wte=e=>!AA(e);function F2e(e){typeof e=="function"&&(wte=t=>t.startsWith("on")?!AA(t):e(t))}try{F2e(require("@emotion/is-prop-valid").default)}catch{}function z2e(e,t,r){const n={};for(const i in e)i==="values"&&typeof e.values=="object"||(wte(i)||r===!0&&AA(i)||!t&&!AA(i)||e.draggable&&i.startsWith("onDrag"))&&(n[i]=e[i]);return n}const O5=oe.createContext({});function L5(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function iM(e){return typeof e=="string"||Array.isArray(e)}const eR=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],tR=["initial",...eR];function D5(e){return L5(e.animate)||tR.some(t=>iM(e[t]))}function Mte(e){return!!(D5(e)||e.variants)}function B2e(e,t){if(D5(e)){const{initial:r,animate:n}=e;return{initial:r===!1||iM(r)?r:void 0,animate:iM(n)?n:void 0}}return e.inherit!==!1?t:{}}function U2e(e){const{initial:t,animate:r}=B2e(e,oe.useContext(O5));return oe.useMemo(()=>({initial:t,animate:r}),[Y6(t),Y6(r)])}function Y6(e){return Array.isArray(e)?e.join(" "):e}const oM={};function V2e(e){for(const t in e)oM[t]=e[t],zj(t)&&(oM[t].isCSSVariable=!0)}function Ste(e,{layout:t,layoutId:r}){return zb.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!oM[e]||e==="opacity")}const W2e={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},G2e=Fb.length;function q2e(e,t,r){let n="",i=!0;for(let o=0;o<G2e;o++){const s=Fb[o],a=e[s];if(a===void 0)continue;let u=!0;if(typeof a=="number"?u=a===(s.startsWith("scale")?1:0):u=parseFloat(a)===0,!u||r){const d=mte(a,Yj[s]);if(!u){i=!1;const m=W2e[s]||s;n+=`${m}(${d}) `}r&&(t[s]=d)}}return n=n.trim(),r?n=r(t,i?"":n):i&&(n="none"),n}function rR(e,t,r){const{style:n,vars:i,transformOrigin:o}=e;let s=!1,a=!1;for(const u in t){const d=t[u];if(zb.has(u)){s=!0;continue}else if(zj(u)){i[u]=d;continue}else{const m=mte(d,Yj[u]);u.startsWith("origin")?(a=!0,o[u]=m):n[u]=m}}if(t.transform||(s||r?n.transform=q2e(t,e.transform,r):n.transform&&(n.transform="none")),a){const{originX:u="50%",originY:d="50%",originZ:m=0}=o;n.transformOrigin=`${u} ${d} ${m}`}}const nR=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function Tte(e,t,r){for(const n in t)!Eu(t[n])&&!Ste(n,r)&&(e[n]=t[n])}function H2e({transformTemplate:e},t){return oe.useMemo(()=>{const r=nR();return rR(r,t,e),Object.assign({},r.vars,r.style)},[t])}function K2e(e,t){const r=e.style||{},n={};return Tte(n,r,e),Object.assign(n,H2e(e,t)),n}function Z2e(e,t){const r={},n=K2e(e,t);return e.drag&&e.dragListener!==!1&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=n,r}const X2e={offset:"stroke-dashoffset",array:"stroke-dasharray"},Y2e={offset:"strokeDashoffset",array:"strokeDasharray"};function Q2e(e,t,r=1,n=0,i=!0){e.pathLength=1;const o=i?X2e:Y2e;e[o.offset]=ki.transform(-n);const s=ki.transform(t),a=ki.transform(r);e[o.array]=`${s} ${a}`}function Pte(e,{attrX:t,attrY:r,attrScale:n,pathLength:i,pathSpacing:o=1,pathOffset:s=0,...a},u,d,m){if(rR(e,a,d),u){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:g,style:_}=e;g.transform&&(_.transform=g.transform,delete g.transform),(_.transform||g.transformOrigin)&&(_.transformOrigin=g.transformOrigin??"50% 50%",delete g.transformOrigin),_.transform&&(_.transformBox=(m==null?void 0:m.transformBox)??"fill-box",delete g.transformBox),t!==void 0&&(g.x=t),r!==void 0&&(g.y=r),n!==void 0&&(g.scale=n),i!==void 0&&Q2e(g,i,o,s,!1)}const Ete=()=>({...nR(),attrs:{}}),Ate=e=>typeof e=="string"&&e.toLowerCase()==="svg";function J2e(e,t,r,n){const i=oe.useMemo(()=>{const o=Ete();return Pte(o,t,Ate(n),e.transformTemplate,e.style),{...o.attrs,style:{...o.style}}},[t]);if(e.style){const o={};Tte(o,e.style,e),i.style={...o,...i.style}}return i}const eMe=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function iR(e){return typeof e!="string"||e.includes("-")?!1:!!(eMe.indexOf(e)>-1||/[A-Z]/u.test(e))}function tMe(e,t,r,{latestValues:n},i,o=!1){const a=(iR(e)?J2e:Z2e)(t,n,i,e),u=z2e(t,typeof e=="string",o),d=e!==oe.Fragment?{...u,...a,ref:r}:{},{children:m}=t,g=oe.useMemo(()=>Eu(m)?m.get():m,[m]);return oe.createElement(e,{...d,children:g})}function Q6(e){const t=[{},{}];return e==null||e.values.forEach((r,n)=>{t[0][n]=r.get(),t[1][n]=r.getVelocity()}),t}function oR(e,t,r,n){if(typeof t=="function"){const[i,o]=Q6(n);t=t(r!==void 0?r:e.custom,i,o)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[i,o]=Q6(n);t=t(r!==void 0?r:e.custom,i,o)}return t}function CE(e){return Eu(e)?e.get():e}function rMe({scrapeMotionValuesFromProps:e,createRenderState:t},r,n,i){return{latestValues:nMe(r,n,i,e),renderState:t()}}function nMe(e,t,r,n){const i={},o=n(e,{});for(const _ in o)i[_]=CE(o[_]);let{initial:s,animate:a}=e;const u=D5(e),d=Mte(e);t&&d&&!u&&e.inherit!==!1&&(s===void 0&&(s=t.initial),a===void 0&&(a=t.animate));let m=r?r.initial===!1:!1;m=m||s===!1;const g=m?a:s;if(g&&typeof g!="boolean"&&!L5(g)){const _=Array.isArray(g)?g:[g];for(let y=0;y<_.length;y++){const M=oR(e,_[y]);if(M){const{transitionEnd:x,transition:E,...T}=M;for(const P in T){let C=T[P];if(Array.isArray(C)){const D=m?C.length-1:0;C=C[D]}C!==null&&(i[P]=C)}for(const P in x)i[P]=x[P]}}}return i}const Cte=e=>(t,r)=>{const n=oe.useContext(O5),i=oe.useContext(Lj),o=()=>rMe(e,t,n,i);return r?o():Rxe(o)};function aR(e,t,r){var o;const{style:n}=e,i={};for(const s in n)(Eu(n[s])||t.style&&Eu(t.style[s])||Ste(s,e)||((o=r==null?void 0:r.getValue(s))==null?void 0:o.liveStyle)!==void 0)&&(i[s]=n[s]);return i}const iMe=Cte({scrapeMotionValuesFromProps:aR,createRenderState:nR});function kte(e,t,r){const n=aR(e,t,r);for(const i in e)if(Eu(e[i])||Eu(t[i])){const o=Fb.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;n[o]=e[i]}return n}const oMe=Cte({scrapeMotionValuesFromProps:kte,createRenderState:Ete}),aMe=Symbol.for("motionComponentSymbol");function Jv(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function sMe(e,t,r){return oe.useCallback(n=>{n&&e.onMount&&e.onMount(n),t&&(n?t.mount(n):t.unmount()),r&&(typeof r=="function"?r(n):Jv(r)&&(r.current=n))},[t])}const sR=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),lMe="framerAppearId",Ite="data-"+sR(lMe),Ote=oe.createContext({});function cMe(e,t,r,n,i){var x,E;const{visualElement:o}=oe.useContext(O5),s=oe.useContext(xte),a=oe.useContext(Lj),u=oe.useContext(bte).reducedMotion,d=oe.useRef(null);n=n||s.renderer,!d.current&&n&&(d.current=n(e,{visualState:t,parent:o,props:r,presenceContext:a,blockInitialAnimation:a?a.initial===!1:!1,reducedMotionConfig:u}));const m=d.current,g=oe.useContext(Ote);m&&!m.projection&&i&&(m.type==="html"||m.type==="svg")&&uMe(d.current,r,i,g);const _=oe.useRef(!1);oe.useInsertionEffect(()=>{m&&_.current&&m.update(r,a)});const y=r[Ite],M=oe.useRef(!!y&&!((x=window.MotionHandoffIsComplete)!=null&&x.call(window,y))&&((E=window.MotionHasOptimisedAnimation)==null?void 0:E.call(window,y)));return Fxe(()=>{m&&(_.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),m.scheduleRenderMicrotask(),M.current&&m.animationState&&m.animationState.animateChanges())}),oe.useEffect(()=>{m&&(!M.current&&m.animationState&&m.animationState.animateChanges(),M.current&&(queueMicrotask(()=>{var T;(T=window.MotionHandoffMarkAsComplete)==null||T.call(window,y)}),M.current=!1),m.enteringChildren=void 0)}),m}function uMe(e,t,r,n){const{layoutId:i,layout:o,drag:s,dragConstraints:a,layoutScroll:u,layoutRoot:d,layoutCrossfade:m}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:Lte(e.parent)),e.projection.setOptions({layoutId:i,layout:o,alwaysMeasureLayout:!!s||a&&Jv(a),visualElement:e,animationType:typeof o=="string"?o:"both",initialPromotionConfig:n,crossfade:m,layoutScroll:u,layoutRoot:d})}function Lte(e){if(e)return e.options.allowProjection!==!1?e.projection:Lte(e.parent)}function GI(e,{forwardMotionProps:t=!1}={},r,n){r&&j2e(r);const i=iR(e)?oMe:iMe;function o(a,u){let d;const m={...oe.useContext(bte),...a,layoutId:dMe(a)},{isStatic:g}=m,_=U2e(a),y=i(a,g);if(!g&&Oj){hMe();const M=fMe(m);d=M.MeasureLayout,_.visualElement=cMe(e,y,m,n,M.ProjectionNode)}return F.jsxs(O5.Provider,{value:_,children:[d&&_.visualElement?F.jsx(d,{visualElement:_.visualElement,...m}):null,tMe(e,a,sMe(y,_.visualElement,u),y,g,t)]})}o.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const s=oe.forwardRef(o);return s[aMe]=e,s}function dMe({layoutId:e}){const t=oe.useContext(kee).id;return t&&e!==void 0?t+"-"+e:e}function hMe(e,t){oe.useContext(xte).strict}function fMe(e){const{drag:t,layout:r}=X1;if(!t&&!r)return{};const n={...t,...r};return{MeasureLayout:t!=null&&t.isEnabled(e)||r!=null&&r.isEnabled(e)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}function pMe(e,t){if(typeof Proxy>"u")return GI;const r=new Map,n=(o,s)=>GI(o,s,e,t),i=(o,s)=>n(o,s);return new Proxy(i,{get:(o,s)=>s==="create"?n:(r.has(s)||r.set(s,GI(s,void 0,e,t)),r.get(s))})}function Dte({top:e,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:e,max:n}}}function mMe({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function gMe(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function qI(e){return e===void 0||e===1}function CD({scale:e,scaleX:t,scaleY:r}){return!qI(e)||!qI(t)||!qI(r)}function _y(e){return CD(e)||$te(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function $te(e){return J6(e.x)||J6(e.y)}function J6(e){return e&&e!=="0%"}function CA(e,t,r){const n=e-r,i=t*n;return r+i}function e8(e,t,r,n,i){return i!==void 0&&(e=CA(e,i,n)),CA(e,r,n)+t}function kD(e,t=0,r=1,n,i){e.min=e8(e.min,t,r,n,i),e.max=e8(e.max,t,r,n,i)}function Nte(e,{x:t,y:r}){kD(e.x,t.translate,t.scale,t.originPoint),kD(e.y,r.translate,r.scale,r.originPoint)}const t8=.999999999999,r8=1.0000000000001;function _Me(e,t,r,n=!1){const i=r.length;if(!i)return;t.x=t.y=1;let o,s;for(let a=0;a<i;a++){o=r[a],s=o.projectionDelta;const{visualElement:u}=o.options;u&&u.props.style&&u.props.style.display==="contents"||(n&&o.options.layoutScroll&&o.scroll&&o!==o.root&&t1(e,{x:-o.scroll.offset.x,y:-o.scroll.offset.y}),s&&(t.x*=s.x.scale,t.y*=s.y.scale,Nte(e,s)),n&&_y(o.latestValues)&&t1(e,o.latestValues))}t.x<r8&&t.x>t8&&(t.x=1),t.y<r8&&t.y>t8&&(t.y=1)}function e1(e,t){e.min=e.min+t,e.max=e.max+t}function n8(e,t,r,n,i=.5){const o=qs(e.min,e.max,i);kD(e,t,r,o,n)}function t1(e,t){n8(e.x,t.x,t.scaleX,t.scale,t.originX),n8(e.y,t.y,t.scaleY,t.scale,t.originY)}function jte(e,t){return Dte(gMe(e.getBoundingClientRect(),t))}function yMe(e,t,r){const n=jte(e,r),{scroll:i}=t;return i&&(e1(n.x,i.offset.x),e1(n.y,i.offset.y)),n}const i8=()=>({translate:0,scale:1,origin:0,originPoint:0}),r1=()=>({x:i8(),y:i8()}),o8=()=>({min:0,max:0}),El=()=>({x:o8(),y:o8()}),ID={current:null},Rte={current:!1};function vMe(){if(Rte.current=!0,!!Oj)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>ID.current=e.matches;e.addEventListener("change",t),t()}else ID.current=!1}const bMe=new WeakMap;function xMe(e,t,r){for(const n in t){const i=t[n],o=r[n];if(Eu(i))e.addValue(n,i);else if(Eu(o))e.addValue(n,Z1(i,{owner:e}));else if(o!==i)if(e.hasValue(n)){const s=e.getValue(n);s.liveStyle===!0?s.jump(i):s.hasAnimated||s.set(i)}else{const s=e.getStaticValue(n);e.addValue(n,Z1(s!==void 0?s:i,{owner:e}))}}for(const n in r)t[n]===void 0&&e.removeValue(n);return t}const a8=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class wMe{scrapeMotionValuesFromProps(t,r,n){return{}}constructor({parent:t,props:r,presenceContext:n,reducedMotionConfig:i,blockInitialAnimation:o,visualState:s},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Zj,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const _=ud.now();this.renderScheduledAt<_&&(this.renderScheduledAt=_,Ls.render(this.render,!1,!0))};const{latestValues:u,renderState:d}=s;this.latestValues=u,this.baseTarget={...u},this.initialValues=r.initial?{...u}:{},this.renderState=d,this.parent=t,this.props=r,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=i,this.options=a,this.blockInitialAnimation=!!o,this.isControllingVariants=D5(r),this.isVariantNode=Mte(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:m,...g}=this.scrapeMotionValuesFromProps(r,{},this);for(const _ in g){const y=g[_];u[_]!==void 0&&Eu(y)&&y.set(u[_])}}mount(t){var r;this.current=t,bMe.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,i)=>this.bindToMotionValue(i,n)),Rte.current||vMe(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:ID.current,(r=this.parent)==null||r.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var t;this.projection&&this.projection.unmount(),T_(this.notifyUpdate),T_(this.render),this.valueSubscriptions.forEach(r=>r()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(t=this.parent)==null||t.removeChild(this);for(const r in this.events)this.events[r].clear();for(const r in this.features){const n=this.features[r];n&&(n.unmount(),n.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,r){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const n=zb.has(t);n&&this.onBindTransform&&this.onBindTransform();const i=r.on("change",s=>{this.latestValues[t]=s,this.props.onUpdate&&Ls.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,t,r)),this.valueSubscriptions.set(t,()=>{i(),o&&o(),r.owner&&r.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in X1){const r=X1[t];if(!r)continue;const{isEnabled:n,Feature:i}=r;if(!this.features[t]&&i&&n(this.props)&&(this.features[t]=new i(this)),this.features[t]){const o=this.features[t];o.isMounted?o.update():(o.mount(),o.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):El()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<a8.length;n++){const i=a8[n];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const o="on"+i,s=t[o];s&&(this.propEventSubscriptions[i]=this.on(i,s))}this.prevMotionValues=xMe(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){const n=this.values.get(t);r!==n&&(n&&this.removeValue(t),this.bindToMotionValue(t,r),this.values.set(t,r),this.latestValues[t]=r.get())}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&r!==void 0&&(n=Z1(r===null?void 0:r,{owner:this}),this.addValue(t,n)),n}readValue(t,r){let n=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return n!=null&&(typeof n=="string"&&(Iee(n)||Lee(n))?n=parseFloat(n):!$2e(n)&&P_.test(r)&&(n=pte(t,r)),this.setBaseTarget(t,Eu(n)?n.get():n)),Eu(n)?n.get():n}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var o;const{initial:r}=this.props;let n;if(typeof r=="string"||typeof r=="object"){const s=oR(this.props,r,(o=this.presenceContext)==null?void 0:o.custom);s&&(n=s[t])}if(r&&n!==void 0)return n;const i=this.getBaseTargetFromProps(this.props,t);return i!==void 0&&!Eu(i)?i:this.initialValues[t]!==void 0&&n===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new jj),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}scheduleRenderMicrotask(){Qj.render(this.render)}}class Fte extends wMe{constructor(){super(...arguments),this.KeyframeResolver=w2e}sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:n}){delete r[t],delete n[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Eu(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function zte(e,{style:t,vars:r},n,i){const o=e.style;let s;for(s in t)o[s]=t[s];i==null||i.applyProjectionStyles(o,n);for(s in r)o.setProperty(s,r[s])}function MMe(e){return window.getComputedStyle(e)}class SMe extends Fte{constructor(){super(...arguments),this.type="html",this.renderInstance=zte}readValueFromInstance(t,r){var n;if(zb.has(r))return(n=this.projection)!=null&&n.isProjecting?wD(r):Bwe(t,r);{const i=MMe(t),o=(zj(r)?i.getPropertyValue(r):i[r])||0;return typeof o=="string"?o.trim():o}}measureInstanceViewportBox(t,{transformPagePoint:r}){return jte(t,r)}build(t,r,n){rR(t,r,n.transformTemplate)}scrapeMotionValuesFromProps(t,r,n){return aR(t,r,n)}}const Bte=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function TMe(e,t,r,n){zte(e,t,void 0,n);for(const i in t.attrs)e.setAttribute(Bte.has(i)?i:sR(i),t.attrs[i])}class PMe extends Fte{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=El}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(zb.has(r)){const n=fte(r);return n&&n.default||0}return r=Bte.has(r)?r:sR(r),t.getAttribute(r)}scrapeMotionValuesFromProps(t,r,n){return kte(t,r,n)}build(t,r,n){Pte(t,r,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(t,r,n,i){TMe(t,r,n,i)}mount(t){this.isSVGTag=Ate(t.tagName),super.mount(t)}}const EMe=(e,t)=>iR(e)?new PMe(t):new SMe(t,{allowProjection:e!==oe.Fragment});function b1(e,t,r){const n=e.getProps();return oR(n,t,r!==void 0?r:n.custom,e)}const OD=e=>Array.isArray(e);function AMe(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,Z1(r))}function CMe(e){return OD(e)?e[e.length-1]||0:e}function kMe(e,t){const r=b1(e,t);let{transitionEnd:n={},transition:i={},...o}=r||{};o={...o,...n};for(const s in o){const a=CMe(o[s]);AMe(e,s,a)}}function IMe(e){return!!(Eu(e)&&e.add)}function LD(e,t){const r=e.getValue("willChange");if(IMe(r))return r.add(t);if(!r&&Hm.WillChange){const n=new Hm.WillChange("auto");e.addValue("willChange",n),n.add(t)}}function Ute(e){return e.props[Ite]}const OMe=e=>e!==null;function LMe(e,{repeat:t,repeatType:r="loop"},n){const i=e.filter(OMe),o=t&&r!=="loop"&&t%2===1?0:i.length-1;return!o||n===void 0?i[o]:n}const DMe={type:"spring",stiffness:500,damping:25,restSpeed:10},$Me=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),NMe={type:"keyframes",duration:.8},jMe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},RMe=(e,{keyframes:t})=>t.length>2?NMe:zb.has(e)?e.startsWith("scale")?$Me(t[1]):DMe:jMe;function FMe({when:e,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:i,repeat:o,repeatType:s,repeatDelay:a,from:u,elapsed:d,...m}){return!!Object.keys(m).length}const lR=(e,t,r,n={},i,o)=>s=>{const a=Xj(n,e)||{},u=a.delay||n.delay||0;let{elapsed:d=0}=n;d=d-Rp(u);const m={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...a,delay:-d,onUpdate:_=>{t.set(_),a.onUpdate&&a.onUpdate(_)},onComplete:()=>{s(),a.onComplete&&a.onComplete()},name:e,motionValue:t,element:o?void 0:i};FMe(a)||Object.assign(m,RMe(e,m)),m.duration&&(m.duration=Rp(m.duration)),m.repeatDelay&&(m.repeatDelay=Rp(m.repeatDelay)),m.from!==void 0&&(m.keyframes[0]=m.from);let g=!1;if((m.type===!1||m.duration===0&&!m.repeatDelay)&&(ED(m),m.delay===0&&(g=!0)),(Hm.instantAnimations||Hm.skipAnimations)&&(g=!0,ED(m),m.delay=0),m.allowFlatten=!a.type&&!a.ease,g&&!o&&t.get()!==void 0){const _=LMe(m.keyframes,a);if(_!==void 0){Ls.update(()=>{m.onUpdate(_),m.onComplete()});return}}return a.isSync?new Kj(m):new u2e(m)};function zMe({protectedKeys:e,needsAnimating:t},r){const n=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,n}function Vte(e,t,{delay:r=0,transitionOverride:n,type:i}={}){let{transition:o=e.getDefaultTransition(),transitionEnd:s,...a}=t;n&&(o=n);const u=[],d=i&&e.animationState&&e.animationState.getState()[i];for(const m in a){const g=e.getValue(m,e.latestValues[m]??null),_=a[m];if(_===void 0||d&&zMe(d,m))continue;const y={delay:r,...Xj(o||{},m)},M=g.get();if(M!==void 0&&!g.isAnimating&&!Array.isArray(_)&&_===M&&!y.velocity)continue;let x=!1;if(window.MotionHandoffAnimation){const T=Ute(e);if(T){const P=window.MotionHandoffAnimation(T,m,Ls);P!==null&&(y.startTime=P,x=!0)}}LD(e,m),g.start(lR(m,g,_,e.shouldReduceMotion&&ute.has(m)?{type:!1}:y,e,x));const E=g.animation;E&&u.push(E)}return s&&Promise.all(u).then(()=>{Ls.update(()=>{s&&kMe(e,s)})}),u}function Wte(e,t,r,n=0,i=1){const o=Array.from(e).sort((d,m)=>d.sortNodePosition(m)).indexOf(t),s=e.size,a=(s-1)*n;return typeof r=="function"?r(o,s):i===1?o*n:a-o*n}function DD(e,t,r={}){var u;const n=b1(e,t,r.type==="exit"?(u=e.presenceContext)==null?void 0:u.custom:void 0);let{transition:i=e.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(i=r.transitionOverride);const o=n?()=>Promise.all(Vte(e,n,r)):()=>Promise.resolve(),s=e.variantChildren&&e.variantChildren.size?(d=0)=>{const{delayChildren:m=0,staggerChildren:g,staggerDirection:_}=i;return BMe(e,t,d,m,g,_,r)}:()=>Promise.resolve(),{when:a}=i;if(a){const[d,m]=a==="beforeChildren"?[o,s]:[s,o];return d().then(()=>m())}else return Promise.all([o(),s(r.delay)])}function BMe(e,t,r=0,n=0,i=0,o=1,s){const a=[];for(const u of e.variantChildren)u.notify("AnimationStart",t),a.push(DD(u,t,{...s,delay:r+(typeof n=="function"?0:n)+Wte(e.variantChildren,u,n,i,o)}).then(()=>u.notify("AnimationComplete",t)));return Promise.all(a)}function UMe(e,t,r={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const i=t.map(o=>DD(e,o,r));n=Promise.all(i)}else if(typeof t=="string")n=DD(e,t,r);else{const i=typeof t=="function"?b1(e,t,r.custom):t;n=Promise.all(Vte(e,i,r))}return n.then(()=>{e.notify("AnimationComplete",t)})}function Gte(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}const VMe=tR.length;function qte(e){if(!e)return;if(!e.isControllingVariants){const r=e.parent?qte(e.parent)||{}:{};return e.props.initial!==void 0&&(r.initial=e.props.initial),r}const t={};for(let r=0;r<VMe;r++){const n=tR[r],i=e.props[n];(iM(i)||i===!1)&&(t[n]=i)}return t}const WMe=[...eR].reverse(),GMe=eR.length;function qMe(e){return t=>Promise.all(t.map(({animation:r,options:n})=>UMe(e,r,n)))}function HMe(e){let t=qMe(e),r=s8(),n=!0;const i=u=>(d,m)=>{var _;const g=b1(e,m,u==="exit"?(_=e.presenceContext)==null?void 0:_.custom:void 0);if(g){const{transition:y,transitionEnd:M,...x}=g;d={...d,...x,...M}}return d};function o(u){t=u(e)}function s(u){const{props:d}=e,m=qte(e.parent)||{},g=[],_=new Set;let y={},M=1/0;for(let E=0;E<GMe;E++){const T=WMe[E],P=r[T],C=d[T]!==void 0?d[T]:m[T],D=iM(C),L=T===u?P.isActive:null;L===!1&&(M=E);let N=C===m[T]&&C!==d[T]&&D;if(N&&n&&e.manuallyAnimateOnMount&&(N=!1),P.protectedKeys={...y},!P.isActive&&L===null||!C&&!P.prevProp||L5(C)||typeof C=="boolean")continue;const j=KMe(P.prevProp,C);let $=j||T===u&&P.isActive&&!N&&D||E>M&&D,U=!1;const G=Array.isArray(C)?C:[C];let H=G.reduce(i(T),{});L===!1&&(H={});const{prevResolvedValues:X={}}=P,ee={...X,...H},ae=_e=>{$=!0,_.has(_e)&&(U=!0,_.delete(_e)),P.needsAnimating[_e]=!0;const ue=e.getValue(_e);ue&&(ue.liveStyle=!1)};for(const _e in ee){const ue=H[_e],fe=X[_e];if(y.hasOwnProperty(_e))continue;let De=!1;OD(ue)&&OD(fe)?De=!Gte(ue,fe):De=ue!==fe,De?ue!=null?ae(_e):_.add(_e):ue!==void 0&&_.has(_e)?ae(_e):P.protectedKeys[_e]=!0}P.prevProp=C,P.prevResolvedValues=H,P.isActive&&(y={...y,...H}),n&&e.blockInitialAnimation&&($=!1);const de=N&&j;$&&(!de||U)&&g.push(...G.map(_e=>{const ue={type:T};if(typeof _e=="string"&&n&&!de&&e.manuallyAnimateOnMount&&e.parent){const{parent:fe}=e,De=b1(fe,_e);if(fe.enteringChildren&&De){const{delayChildren:pe}=De.transition||{};ue.delay=Wte(fe.enteringChildren,e,pe)}}return{animation:_e,options:ue}}))}if(_.size){const E={};if(typeof d.initial!="boolean"){const T=b1(e,Array.isArray(d.initial)?d.initial[0]:d.initial);T&&T.transition&&(E.transition=T.transition)}_.forEach(T=>{const P=e.getBaseTarget(T),C=e.getValue(T);C&&(C.liveStyle=!0),E[T]=P??null}),g.push({animation:E})}let x=!!g.length;return n&&(d.initial===!1||d.initial===d.animate)&&!e.manuallyAnimateOnMount&&(x=!1),n=!1,x?t(g):Promise.resolve()}function a(u,d){var g;if(r[u].isActive===d)return Promise.resolve();(g=e.variantChildren)==null||g.forEach(_=>{var y;return(y=_.animationState)==null?void 0:y.setActive(u,d)}),r[u].isActive=d;const m=s(u);for(const _ in r)r[_].protectedKeys={};return m}return{animateChanges:s,setActive:a,setAnimateFunction:o,getState:()=>r,reset:()=>{r=s8(),n=!0}}}function KMe(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!Gte(t,e):!1}function sy(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function s8(){return{animate:sy(!0),whileInView:sy(),whileHover:sy(),whileTap:sy(),whileDrag:sy(),whileFocus:sy(),exit:sy()}}class $_{constructor(t){this.isMounted=!1,this.node=t}update(){}}class ZMe extends $_{constructor(t){super(t),t.animationState||(t.animationState=HMe(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();L5(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let XMe=0;class YMe extends $_{constructor(){super(...arguments),this.id=XMe++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===n)return;const i=this.node.animationState.setActive("exit",!t);r&&!t&&i.then(()=>{r(this.id)})}mount(){const{register:t,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const QMe={animation:{Feature:ZMe},exit:{Feature:YMe}};function aM(e,t,r,n={passive:!0}){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r)}function vS(e){return{point:{x:e.pageX,y:e.pageY}}}const JMe=e=>t=>Jj(t)&&e(t,vS(t));function f2(e,t,r,n){return aM(e,t,JMe(r),n)}const Hte=1e-4,eSe=1-Hte,tSe=1+Hte,Kte=.01,rSe=0-Kte,nSe=0+Kte;function Bu(e){return e.max-e.min}function iSe(e,t,r){return Math.abs(e-t)<=r}function l8(e,t,r,n=.5){e.origin=n,e.originPoint=qs(t.min,t.max,e.origin),e.scale=Bu(r)/Bu(t),e.translate=qs(r.min,r.max,e.origin)-e.originPoint,(e.scale>=eSe&&e.scale<=tSe||isNaN(e.scale))&&(e.scale=1),(e.translate>=rSe&&e.translate<=nSe||isNaN(e.translate))&&(e.translate=0)}function p2(e,t,r,n){l8(e.x,t.x,r.x,n?n.originX:void 0),l8(e.y,t.y,r.y,n?n.originY:void 0)}function c8(e,t,r){e.min=r.min+t.min,e.max=e.min+Bu(t)}function oSe(e,t,r){c8(e.x,t.x,r.x),c8(e.y,t.y,r.y)}function u8(e,t,r){e.min=t.min-r.min,e.max=e.min+Bu(t)}function m2(e,t,r){u8(e.x,t.x,r.x),u8(e.y,t.y,r.y)}function wh(e){return[e("x"),e("y")]}const Zte=({current:e})=>e?e.ownerDocument.defaultView:null,d8=(e,t)=>Math.abs(e-t);function aSe(e,t){const r=d8(e.x,t.x),n=d8(e.y,t.y);return Math.sqrt(r**2+n**2)}class Xte{constructor(t,r,{transformPagePoint:n,contextWindow:i=window,dragSnapToOrigin:o=!1,distanceThreshold:s=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const _=KI(this.lastMoveEventInfo,this.history),y=this.startEvent!==null,M=aSe(_.offset,{x:0,y:0})>=this.distanceThreshold;if(!y&&!M)return;const{point:x}=_,{timestamp:E}=nu;this.history.push({...x,timestamp:E});const{onStart:T,onMove:P}=this.handlers;y||(T&&T(this.lastMoveEvent,_),this.startEvent=this.lastMoveEvent),P&&P(this.lastMoveEvent,_)},this.handlePointerMove=(_,y)=>{this.lastMoveEvent=_,this.lastMoveEventInfo=HI(y,this.transformPagePoint),Ls.update(this.updatePoint,!0)},this.handlePointerUp=(_,y)=>{this.end();const{onEnd:M,onSessionEnd:x,resumeAnimation:E}=this.handlers;if(this.dragSnapToOrigin&&E&&E(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const T=KI(_.type==="pointercancel"?this.lastMoveEventInfo:HI(y,this.transformPagePoint),this.history);this.startEvent&&M&&M(_,T),x&&x(_,T)},!Jj(t))return;this.dragSnapToOrigin=o,this.handlers=r,this.transformPagePoint=n,this.distanceThreshold=s,this.contextWindow=i||window;const a=vS(t),u=HI(a,this.transformPagePoint),{point:d}=u,{timestamp:m}=nu;this.history=[{...d,timestamp:m}];const{onSessionStart:g}=r;g&&g(t,KI(u,this.history)),this.removeListeners=gS(f2(this.contextWindow,"pointermove",this.handlePointerMove),f2(this.contextWindow,"pointerup",this.handlePointerUp),f2(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),T_(this.updatePoint)}}function HI(e,t){return t?{point:t(e.point)}:e}function h8(e,t){return{x:e.x-t.x,y:e.y-t.y}}function KI({point:e},t){return{point:e,delta:h8(e,Yte(t)),offset:h8(e,sSe(t)),velocity:lSe(t,.1)}}function sSe(e){return e[0]}function Yte(e){return e[e.length-1]}function lSe(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,n=null;const i=Yte(e);for(;r>=0&&(n=e[r],!(i.timestamp-n.timestamp>Rp(t)));)r--;if(!n)return{x:0,y:0};const o=Fp(i.timestamp-n.timestamp);if(o===0)return{x:0,y:0};const s={x:(i.x-n.x)/o,y:(i.y-n.y)/o};return s.x===1/0&&(s.x=0),s.y===1/0&&(s.y=0),s}function cSe(e,{min:t,max:r},n){return t!==void 0&&e<t?e=n?qs(t,e,n.min):Math.max(e,t):r!==void 0&&e>r&&(e=n?qs(r,e,n.max):Math.min(e,r)),e}function f8(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function uSe(e,{top:t,left:r,bottom:n,right:i}){return{x:f8(e.x,r,i),y:f8(e.y,t,n)}}function p8(e,t){let r=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,n]=[n,r]),{min:r,max:n}}function dSe(e,t){return{x:p8(e.x,t.x),y:p8(e.y,t.y)}}function hSe(e,t){let r=.5;const n=Bu(e),i=Bu(t);return i>n?r=tM(t.min,t.max-n,e.min):n>i&&(r=tM(e.min,e.max-i,t.min)),qm(0,1,r)}function fSe(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const $D=.35;function pSe(e=$D){return e===!1?e=0:e===!0&&(e=$D),{x:m8(e,"left","right"),y:m8(e,"top","bottom")}}function m8(e,t,r){return{min:g8(e,t),max:g8(e,r)}}function g8(e,t){return typeof e=="number"?e:e[t]||0}const mSe=new WeakMap;class gSe{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=El(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:r=!1,distanceThreshold:n}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const o=g=>{const{dragSnapToOrigin:_}=this.getProps();_?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(vS(g).point)},s=(g,_)=>{const{drag:y,dragPropagation:M,onDragStart:x}=this.getProps();if(y&&!M&&(this.openDragLock&&this.openDragLock(),this.openDragLock=E2e(y),!this.openDragLock))return;this.latestPointerEvent=g,this.latestPanInfo=_,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),wh(T=>{let P=this.getAxisMotionValue(T).get()||0;if(zp.test(P)){const{projection:C}=this.visualElement;if(C&&C.layout){const D=C.layout.layoutBox[T];D&&(P=Bu(D)*(parseFloat(P)/100))}}this.originPoint[T]=P}),x&&Ls.postRender(()=>x(g,_)),LD(this.visualElement,"transform");const{animationState:E}=this.visualElement;E&&E.setActive("whileDrag",!0)},a=(g,_)=>{this.latestPointerEvent=g,this.latestPanInfo=_;const{dragPropagation:y,dragDirectionLock:M,onDirectionLock:x,onDrag:E}=this.getProps();if(!y&&!this.openDragLock)return;const{offset:T}=_;if(M&&this.currentDirection===null){this.currentDirection=_Se(T),this.currentDirection!==null&&x&&x(this.currentDirection);return}this.updateAxis("x",_.point,T),this.updateAxis("y",_.point,T),this.visualElement.render(),E&&E(g,_)},u=(g,_)=>{this.latestPointerEvent=g,this.latestPanInfo=_,this.stop(g,_),this.latestPointerEvent=null,this.latestPanInfo=null},d=()=>wh(g=>{var _;return this.getAnimationState(g)==="paused"&&((_=this.getAxisMotionValue(g).animation)==null?void 0:_.play())}),{dragSnapToOrigin:m}=this.getProps();this.panSession=new Xte(t,{onSessionStart:o,onStart:s,onMove:a,onSessionEnd:u,resumeAnimation:d},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:m,distanceThreshold:n,contextWindow:Zte(this.visualElement)})}stop(t,r){const n=t||this.latestPointerEvent,i=r||this.latestPanInfo,o=this.isDragging;if(this.cancel(),!o||!i||!n)return;const{velocity:s}=i;this.startAnimation(s);const{onDragEnd:a}=this.getProps();a&&Ls.postRender(()=>a(n,i))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,n){const{drag:i}=this.getProps();if(!n||!wP(t,i,this.currentDirection))return;const o=this.getAxisMotionValue(t);let s=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(s=cSe(s,this.constraints[t],this.elastic[t])),o.set(s)}resolveConstraints(){var o;const{dragConstraints:t,dragElastic:r}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(o=this.visualElement.projection)==null?void 0:o.layout,i=this.constraints;t&&Jv(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&n?this.constraints=uSe(n.layoutBox,t):this.constraints=!1,this.elastic=pSe(r),i!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&wh(s=>{this.constraints!==!1&&this.getAxisMotionValue(s)&&(this.constraints[s]=fSe(n.layoutBox[s],this.constraints[s]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!Jv(t))return!1;const n=t.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const o=yMe(n,i.root,this.visualElement.getTransformPagePoint());let s=dSe(i.layout.layoutBox,o);if(r){const a=r(mMe(s));this.hasMutatedConstraints=!!a,a&&(s=Dte(a))}return s}startAnimation(t){const{drag:r,dragMomentum:n,dragElastic:i,dragTransition:o,dragSnapToOrigin:s,onDragTransitionEnd:a}=this.getProps(),u=this.constraints||{},d=wh(m=>{if(!wP(m,r,this.currentDirection))return;let g=u&&u[m]||{};s&&(g={min:0,max:0});const _=i?200:1e6,y=i?40:1e7,M={type:"inertia",velocity:n?t[m]:0,bounceStiffness:_,bounceDamping:y,timeConstant:750,restDelta:1,restSpeed:10,...o,...g};return this.startAxisValueAnimation(m,M)});return Promise.all(d).then(a)}startAxisValueAnimation(t,r){const n=this.getAxisMotionValue(t);return LD(this.visualElement,t),n.start(lR(t,n,0,r,this.visualElement,!1))}stopAnimation(){wh(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){wh(t=>{var r;return(r=this.getAxisMotionValue(t).animation)==null?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)==null?void 0:r.state}getAxisMotionValue(t){const r=`_drag${t.toUpperCase()}`,n=this.visualElement.getProps(),i=n[r];return i||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){wh(r=>{const{drag:n}=this.getProps();if(!wP(r,n,this.currentDirection))return;const{projection:i}=this.visualElement,o=this.getAxisMotionValue(r);if(i&&i.layout){const{min:s,max:a}=i.layout.layoutBox[r];o.set(t[r]-qs(s,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!Jv(r)||!n||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};wh(s=>{const a=this.getAxisMotionValue(s);if(a&&this.constraints!==!1){const u=a.get();i[s]=hSe({min:u,max:u},this.constraints[s])}});const{transformTemplate:o}=this.visualElement.getProps();this.visualElement.current.style.transform=o?o({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),wh(s=>{if(!wP(s,t,null))return;const a=this.getAxisMotionValue(s),{min:u,max:d}=this.constraints[s];a.set(qs(u,d,i[s]))})}addListeners(){if(!this.visualElement.current)return;mSe.set(this.visualElement,this);const t=this.visualElement.current,r=f2(t,"pointerdown",u=>{const{drag:d,dragListener:m=!0}=this.getProps();d&&m&&this.start(u)}),n=()=>{const{dragConstraints:u}=this.getProps();Jv(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,o=i.addEventListener("measure",n);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),Ls.read(n);const s=aM(window,"resize",()=>this.scalePositionWithinConstraints()),a=i.addEventListener("didUpdate",({delta:u,hasLayoutChanged:d})=>{this.isDragging&&d&&(wh(m=>{const g=this.getAxisMotionValue(m);g&&(this.originPoint[m]+=u[m].translate,g.set(g.get()+u[m].translate))}),this.visualElement.render())});return()=>{s(),r(),o(),a&&a()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:i=!1,dragConstraints:o=!1,dragElastic:s=$D,dragMomentum:a=!0}=t;return{...t,drag:r,dragDirectionLock:n,dragPropagation:i,dragConstraints:o,dragElastic:s,dragMomentum:a}}}function wP(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function _Se(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class ySe extends $_{constructor(t){super(t),this.removeGroupControls=Dh,this.removeListeners=Dh,this.controls=new gSe(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Dh}unmount(){this.removeGroupControls(),this.removeListeners()}}const _8=e=>(t,r)=>{e&&Ls.postRender(()=>e(t,r))};class vSe extends $_{constructor(){super(...arguments),this.removePointerDownListener=Dh}onPointerDown(t){this.session=new Xte(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Zte(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:n,onPanEnd:i}=this.node.getProps();return{onSessionStart:_8(t),onStart:_8(r),onMove:n,onEnd:(o,s)=>{delete this.session,i&&Ls.postRender(()=>i(o,s))}}}mount(){this.removePointerDownListener=f2(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const kE={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function y8(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const gw={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(ki.test(e))e=parseFloat(e);else return e;const r=y8(e,t.target.x),n=y8(e,t.target.y);return`${r}% ${n}%`}},bSe={correct:(e,{treeScale:t,projectionDelta:r})=>{const n=e,i=P_.parse(e);if(i.length>5)return n;const o=P_.createTransformer(e),s=typeof i[0]!="number"?1:0,a=r.x.scale*t.x,u=r.y.scale*t.y;i[0+s]/=a,i[1+s]/=u;const d=qs(a,u,.5);return typeof i[2+s]=="number"&&(i[2+s]/=d),typeof i[3+s]=="number"&&(i[3+s]/=d),o(i)}};let ZI=!1;class xSe extends oe.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n,layoutId:i}=this.props,{projection:o}=t;V2e(wSe),o&&(r.group&&r.group.add(o),n&&n.register&&i&&n.register(o),ZI&&o.root.didUpdate(),o.addEventListener("animationComplete",()=>{this.safeToRemove()}),o.setOptions({...o.options,onExitComplete:()=>this.safeToRemove()})),kE.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:n,drag:i,isPresent:o}=this.props,{projection:s}=n;return s&&(s.isPresent=o,ZI=!0,i||t.layoutDependency!==r||r===void 0||t.isPresent!==o?s.willUpdate():this.safeToRemove(),t.isPresent!==o&&(o?s.promote():s.relegate()||Ls.postRender(()=>{const a=s.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),Qj.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:i}=t;ZI=!0,i&&(i.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(i),n&&n.deregister&&n.deregister(i))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function Qte(e){const[t,r]=N2e(),n=oe.useContext(kee);return F.jsx(xSe,{...e,layoutGroup:n,switchLayoutGroup:oe.useContext(Ote),isPresent:t,safeToRemove:r})}const wSe={borderRadius:{...gw,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:gw,borderTopRightRadius:gw,borderBottomLeftRadius:gw,borderBottomRightRadius:gw,boxShadow:bSe};function MSe(e,t,r){const n=Eu(e)?e:Z1(e);return n.start(lR("",n,t,r)),n.animation}const SSe=(e,t)=>e.depth-t.depth;class TSe{constructor(){this.children=[],this.isDirty=!1}add(t){Dj(this.children,t),this.isDirty=!0}remove(t){$j(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(SSe),this.isDirty=!1,this.children.forEach(t)}}function PSe(e,t){const r=ud.now(),n=({timestamp:i})=>{const o=i-r;o>=t&&(T_(n),e(o-t))};return Ls.setup(n,!0),()=>T_(n)}const Jte=["TopLeft","TopRight","BottomLeft","BottomRight"],ESe=Jte.length,v8=e=>typeof e=="string"?parseFloat(e):e,b8=e=>typeof e=="number"||ki.test(e);function ASe(e,t,r,n,i,o){i?(e.opacity=qs(0,r.opacity??1,CSe(n)),e.opacityExit=qs(t.opacity??1,0,kSe(n))):o&&(e.opacity=qs(t.opacity??1,r.opacity??1,n));for(let s=0;s<ESe;s++){const a=`border${Jte[s]}Radius`;let u=x8(t,a),d=x8(r,a);if(u===void 0&&d===void 0)continue;u||(u=0),d||(d=0),u===0||d===0||b8(u)===b8(d)?(e[a]=Math.max(qs(v8(u),v8(d),n),0),(zp.test(d)||zp.test(u))&&(e[a]+="%")):e[a]=d}(t.rotate||r.rotate)&&(e.rotate=qs(t.rotate||0,r.rotate||0,n))}function x8(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const CSe=ere(0,.5,Bee),kSe=ere(.5,.95,Dh);function ere(e,t,r){return n=>n<e?0:n>t?1:r(tM(e,t,n))}function w8(e,t){e.min=t.min,e.max=t.max}function yh(e,t){w8(e.x,t.x),w8(e.y,t.y)}function M8(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function S8(e,t,r,n,i){return e-=t,e=CA(e,1/r,n),i!==void 0&&(e=CA(e,1/i,n)),e}function ISe(e,t=0,r=1,n=.5,i,o=e,s=e){if(zp.test(t)&&(t=parseFloat(t),t=qs(s.min,s.max,t/100)-s.min),typeof t!="number")return;let a=qs(o.min,o.max,n);e===o&&(a-=t),e.min=S8(e.min,t,r,a,i),e.max=S8(e.max,t,r,a,i)}function T8(e,t,[r,n,i],o,s){ISe(e,t[r],t[n],t[i],t.scale,o,s)}const OSe=["x","scaleX","originX"],LSe=["y","scaleY","originY"];function P8(e,t,r,n){T8(e.x,t,OSe,r?r.x:void 0,n?n.x:void 0),T8(e.y,t,LSe,r?r.y:void 0,n?n.y:void 0)}function E8(e){return e.translate===0&&e.scale===1}function tre(e){return E8(e.x)&&E8(e.y)}function A8(e,t){return e.min===t.min&&e.max===t.max}function DSe(e,t){return A8(e.x,t.x)&&A8(e.y,t.y)}function C8(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function rre(e,t){return C8(e.x,t.x)&&C8(e.y,t.y)}function k8(e){return Bu(e.x)/Bu(e.y)}function I8(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class $Se{constructor(){this.members=[]}add(t){Dj(this.members,t),t.scheduleRender()}remove(t){if($j(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(i=>t===i);if(r===0)return!1;let n;for(let i=r;i>=0;i--){const o=this.members[i];if(o.isPresent!==!1){n=o;break}}return n?(this.promote(n),!0):!1}promote(t,r){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,r&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:i}=t.options;i===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:n}=t;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function NSe(e,t,r){let n="";const i=e.x.translate/t.x,o=e.y.translate/t.y,s=(r==null?void 0:r.z)||0;if((i||o||s)&&(n=`translate3d(${i}px, ${o}px, ${s}px) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:d,rotate:m,rotateX:g,rotateY:_,skewX:y,skewY:M}=r;d&&(n=`perspective(${d}px) ${n}`),m&&(n+=`rotate(${m}deg) `),g&&(n+=`rotateX(${g}deg) `),_&&(n+=`rotateY(${_}deg) `),y&&(n+=`skewX(${y}deg) `),M&&(n+=`skewY(${M}deg) `)}const a=e.x.scale*t.x,u=e.y.scale*t.y;return(a!==1||u!==1)&&(n+=`scale(${a}, ${u})`),n||"none"}const XI=["","X","Y","Z"],jSe=1e3;let RSe=0;function YI(e,t,r,n){const{latestValues:i}=t;i[e]&&(r[e]=i[e],t.setStaticValue(e,0),n&&(n[e]=0))}function nre(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const r=Ute(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:i,layoutId:o}=e.options;window.MotionCancelOptimisedAnimation(r,"transform",Ls,!(i||o))}const{parent:n}=e;n&&!n.hasCheckedOptimisedAppear&&nre(n)}function ire({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:i}){return class{constructor(s={},a=t==null?void 0:t()){this.id=RSe++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(BSe),this.nodes.forEach(GSe),this.nodes.forEach(qSe),this.nodes.forEach(USe)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=s,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new TSe)}addEventListener(s,a){return this.eventHandlers.has(s)||this.eventHandlers.set(s,new jj),this.eventHandlers.get(s).add(a)}notifyListeners(s,...a){const u=this.eventHandlers.get(s);u&&u.notify(...a)}hasListeners(s){return this.eventHandlers.has(s)}mount(s){if(this.instance)return;this.isSVG=vte(s)&&!L2e(s),this.instance=s;const{layoutId:a,layout:u,visualElement:d}=this.options;if(d&&!d.current&&d.mount(s),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(u||a)&&(this.isLayoutDirty=!0),e){let m,g=0;const _=()=>this.root.updateBlockedByResize=!1;Ls.read(()=>{g=window.innerWidth}),e(s,()=>{const y=window.innerWidth;y!==g&&(g=y,this.root.updateBlockedByResize=!0,m&&m(),m=PSe(_,250),kE.hasAnimatedSinceResize&&(kE.hasAnimatedSinceResize=!1,this.nodes.forEach(D8)))})}a&&this.root.registerSharedNode(a,this),this.options.animate!==!1&&d&&(a||u)&&this.addEventListener("didUpdate",({delta:m,hasLayoutChanged:g,hasRelativeLayoutChanged:_,layout:y})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const M=this.options.transition||d.getDefaultTransition()||YSe,{onLayoutAnimationStart:x,onLayoutAnimationComplete:E}=d.getProps(),T=!this.targetLayout||!rre(this.targetLayout,y),P=!g&&_;if(this.options.layoutRoot||this.resumeFrom||P||g&&(T||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const C={...Xj(M,"layout"),onPlay:x,onComplete:E};(d.shouldReduceMotion||this.options.layoutRoot)&&(C.delay=0,C.type=!1),this.startAnimation(C),this.setAnimationOrigin(m,P)}else g||D8(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=y})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const s=this.getStack();s&&s.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),T_(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(HSe),this.animationId++)}getTransformTemplate(){const{visualElement:s}=this.options;return s&&s.getProps().transformTemplate}willUpdate(s=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&nre(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let m=0;m<this.path.length;m++){const g=this.path[m];g.shouldResetTransform=!0,g.updateScroll("snapshot"),g.options.layoutRoot&&g.willUpdate(!1)}const{layoutId:a,layout:u}=this.options;if(a===void 0&&!u)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),s&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(O8);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(L8);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(WSe),this.nodes.forEach(FSe),this.nodes.forEach(zSe)):this.nodes.forEach(L8),this.clearAllSnapshots();const a=ud.now();nu.delta=qm(0,1e3/60,a-nu.timestamp),nu.timestamp=a,nu.isProcessing=!0,FI.update.process(nu),FI.preRender.process(nu),FI.render.process(nu),nu.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Qj.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(VSe),this.sharedNodes.forEach(KSe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Ls.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Ls.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Bu(this.snapshot.measuredBox.x)&&!Bu(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const s=this.layout;this.layout=this.measure(!1),this.layoutCorrected=El(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,s?s.layoutBox:void 0)}updateScroll(s="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===s&&(a=!1),a&&this.instance){const u=n(this.instance);this.scroll={animationId:this.root.animationId,phase:s,isRoot:u,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!i)return;const s=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!tre(this.projectionDelta),u=this.getTransformTemplate(),d=u?u(this.latestValues,""):void 0,m=d!==this.prevTransformTemplateValue;s&&this.instance&&(a||_y(this.latestValues)||m)&&(i(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(s=!0){const a=this.measurePageBox();let u=this.removeElementScroll(a);return s&&(u=this.removeTransform(u)),QSe(u),{animationId:this.root.animationId,measuredBox:a,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){var d;const{visualElement:s}=this.options;if(!s)return El();const a=s.measureViewportBox();if(!(((d=this.scroll)==null?void 0:d.wasRoot)||this.path.some(JSe))){const{scroll:m}=this.root;m&&(e1(a.x,m.offset.x),e1(a.y,m.offset.y))}return a}removeElementScroll(s){var u;const a=El();if(yh(a,s),(u=this.scroll)!=null&&u.wasRoot)return a;for(let d=0;d<this.path.length;d++){const m=this.path[d],{scroll:g,options:_}=m;m!==this.root&&g&&_.layoutScroll&&(g.wasRoot&&yh(a,s),e1(a.x,g.offset.x),e1(a.y,g.offset.y))}return a}applyTransform(s,a=!1){const u=El();yh(u,s);for(let d=0;d<this.path.length;d++){const m=this.path[d];!a&&m.options.layoutScroll&&m.scroll&&m!==m.root&&t1(u,{x:-m.scroll.offset.x,y:-m.scroll.offset.y}),_y(m.latestValues)&&t1(u,m.latestValues)}return _y(this.latestValues)&&t1(u,this.latestValues),u}removeTransform(s){const a=El();yh(a,s);for(let u=0;u<this.path.length;u++){const d=this.path[u];if(!d.instance||!_y(d.latestValues))continue;CD(d.latestValues)&&d.updateSnapshot();const m=El(),g=d.measurePageBox();yh(m,g),P8(a,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,m)}return _y(this.latestValues)&&P8(a,this.latestValues),a}setTargetDelta(s){this.targetDelta=s,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(s){this.options={...this.options,...s,crossfade:s.crossfade!==void 0?s.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==nu.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(s=!1){var _;const a=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=a.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=a.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=a.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==a;if(!(s||u&&this.isSharedProjectionDirty||this.isProjectionDirty||(_=this.parent)!=null&&_.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:m,layoutId:g}=this.options;if(!(!this.layout||!(m||g))){if(this.resolvedRelativeTargetAt=nu.timestamp,!this.targetDelta&&!this.relativeTarget){const y=this.getClosestProjectingParent();y&&y.layout&&this.animationProgress!==1?(this.relativeParent=y,this.forceRelativeParentToResolveTarget(),this.relativeTarget=El(),this.relativeTargetOrigin=El(),m2(this.relativeTargetOrigin,this.layout.layoutBox,y.layout.layoutBox),yh(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=El(),this.targetWithTransforms=El()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),oSe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):yh(this.target,this.layout.layoutBox),Nte(this.target,this.targetDelta)):yh(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const y=this.getClosestProjectingParent();y&&!!y.resumingFrom==!!this.resumingFrom&&!y.options.layoutScroll&&y.target&&this.animationProgress!==1?(this.relativeParent=y,this.forceRelativeParentToResolveTarget(),this.relativeTarget=El(),this.relativeTargetOrigin=El(),m2(this.relativeTargetOrigin,this.target,y.target),yh(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||CD(this.parent.latestValues)||$te(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var M;const s=this.getLead(),a=!!this.resumingFrom||this!==s;let u=!0;if((this.isProjectionDirty||(M=this.parent)!=null&&M.isProjectionDirty)&&(u=!1),a&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===nu.timestamp&&(u=!1),u)return;const{layout:d,layoutId:m}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||m))return;yh(this.layoutCorrected,this.layout.layoutBox);const g=this.treeScale.x,_=this.treeScale.y;_Me(this.layoutCorrected,this.treeScale,this.path,a),s.layout&&!s.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(s.target=s.layout.layoutBox,s.targetWithTransforms=El());const{target:y}=s;if(!y){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(M8(this.prevProjectionDelta.x,this.projectionDelta.x),M8(this.prevProjectionDelta.y,this.projectionDelta.y)),p2(this.projectionDelta,this.layoutCorrected,y,this.latestValues),(this.treeScale.x!==g||this.treeScale.y!==_||!I8(this.projectionDelta.x,this.prevProjectionDelta.x)||!I8(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",y))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(s=!0){var a;if((a=this.options.visualElement)==null||a.scheduleRender(),s){const u=this.getStack();u&&u.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=r1(),this.projectionDelta=r1(),this.projectionDeltaWithTransform=r1()}setAnimationOrigin(s,a=!1){const u=this.snapshot,d=u?u.latestValues:{},m={...this.latestValues},g=r1();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const _=El(),y=u?u.source:void 0,M=this.layout?this.layout.source:void 0,x=y!==M,E=this.getStack(),T=!E||E.members.length<=1,P=!!(x&&!T&&this.options.crossfade===!0&&!this.path.some(XSe));this.animationProgress=0;let C;this.mixTargetDelta=D=>{const L=D/1e3;$8(g.x,s.x,L),$8(g.y,s.y,L),this.setTargetDelta(g),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(m2(_,this.layout.layoutBox,this.relativeParent.layout.layoutBox),ZSe(this.relativeTarget,this.relativeTargetOrigin,_,L),C&&DSe(this.relativeTarget,C)&&(this.isProjectionDirty=!1),C||(C=El()),yh(C,this.relativeTarget)),x&&(this.animationValues=m,ASe(m,d,this.latestValues,L,P,T)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=L},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(s){var a,u,d;this.notifyListeners("animationStart"),(a=this.currentAnimation)==null||a.stop(),(d=(u=this.resumingFrom)==null?void 0:u.currentAnimation)==null||d.stop(),this.pendingAnimation&&(T_(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Ls.update(()=>{kE.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Z1(0)),this.currentAnimation=MSe(this.motionValue,[0,1e3],{...s,velocity:0,isSync:!0,onUpdate:m=>{this.mixTargetDelta(m),s.onUpdate&&s.onUpdate(m)},onStop:()=>{},onComplete:()=>{s.onComplete&&s.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const s=this.getStack();s&&s.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(jSe),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const s=this.getLead();let{targetWithTransforms:a,target:u,layout:d,latestValues:m}=s;if(!(!a||!u||!d)){if(this!==s&&this.layout&&d&&ore(this.options.animationType,this.layout.layoutBox,d.layoutBox)){u=this.target||El();const g=Bu(this.layout.layoutBox.x);u.x.min=s.target.x.min,u.x.max=u.x.min+g;const _=Bu(this.layout.layoutBox.y);u.y.min=s.target.y.min,u.y.max=u.y.min+_}yh(a,u),t1(a,m),p2(this.projectionDeltaWithTransform,this.layoutCorrected,a,m)}}registerSharedNode(s,a){this.sharedNodes.has(s)||this.sharedNodes.set(s,new $Se),this.sharedNodes.get(s).add(a);const d=a.options.initialPromotionConfig;a.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(a):void 0})}isLead(){const s=this.getStack();return s?s.lead===this:!0}getLead(){var a;const{layoutId:s}=this.options;return s?((a=this.getStack())==null?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:s}=this.options;return s?(a=this.getStack())==null?void 0:a.prevLead:void 0}getStack(){const{layoutId:s}=this.options;if(s)return this.root.sharedNodes.get(s)}promote({needsReset:s,transition:a,preserveFollowOpacity:u}={}){const d=this.getStack();d&&d.promote(this,u),s&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const s=this.getStack();return s?s.relegate(this):!1}resetSkewAndRotation(){const{visualElement:s}=this.options;if(!s)return;let a=!1;const{latestValues:u}=s;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(a=!0),!a)return;const d={};u.z&&YI("z",s,d,this.animationValues);for(let m=0;m<XI.length;m++)YI(`rotate${XI[m]}`,s,d,this.animationValues),YI(`skew${XI[m]}`,s,d,this.animationValues);s.render();for(const m in d)s.setStaticValue(m,d[m]),this.animationValues&&(this.animationValues[m]=d[m]);s.scheduleRender()}applyProjectionStyles(s,a){if(!this.instance||this.isSVG)return;if(!this.isVisible){s.visibility="hidden";return}const u=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,s.visibility="",s.opacity="",s.pointerEvents=CE(a==null?void 0:a.pointerEvents)||"",s.transform=u?u(this.latestValues,""):"none";return}const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){this.options.layoutId&&(s.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,s.pointerEvents=CE(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!_y(this.latestValues)&&(s.transform=u?u({},""):"none",this.hasProjected=!1);return}s.visibility="";const m=d.animationValues||d.latestValues;this.applyTransformsToTarget();let g=NSe(this.projectionDeltaWithTransform,this.treeScale,m);u&&(g=u(m,g)),s.transform=g;const{x:_,y}=this.projectionDelta;s.transformOrigin=`${_.origin*100}% ${y.origin*100}% 0`,d.animationValues?s.opacity=d===this?m.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:m.opacityExit:s.opacity=d===this?m.opacity!==void 0?m.opacity:"":m.opacityExit!==void 0?m.opacityExit:0;for(const M in oM){if(m[M]===void 0)continue;const{correct:x,applyTo:E,isCSSVariable:T}=oM[M],P=g==="none"?m[M]:x(m[M],d);if(E){const C=E.length;for(let D=0;D<C;D++)s[E[D]]=P}else T?this.options.visualElement.renderState.vars[M]=P:s[M]=P}this.options.layoutId&&(s.pointerEvents=d===this?CE(a==null?void 0:a.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(s=>{var a;return(a=s.currentAnimation)==null?void 0:a.stop()}),this.root.nodes.forEach(O8),this.root.sharedNodes.clear()}}}function FSe(e){e.updateLayout()}function zSe(e){var r;const t=((r=e.resumeFrom)==null?void 0:r.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:i}=e.layout,{animationType:o}=e.options,s=t.source!==e.layout.source;o==="size"?wh(g=>{const _=s?t.measuredBox[g]:t.layoutBox[g],y=Bu(_);_.min=n[g].min,_.max=_.min+y}):ore(o,t.layoutBox,n)&&wh(g=>{const _=s?t.measuredBox[g]:t.layoutBox[g],y=Bu(n[g]);_.max=_.min+y,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[g].max=e.relativeTarget[g].min+y)});const a=r1();p2(a,n,t.layoutBox);const u=r1();s?p2(u,e.applyTransform(i,!0),t.measuredBox):p2(u,n,t.layoutBox);const d=!tre(a);let m=!1;if(!e.resumeFrom){const g=e.getClosestProjectingParent();if(g&&!g.resumeFrom){const{snapshot:_,layout:y}=g;if(_&&y){const M=El();m2(M,t.layoutBox,_.layoutBox);const x=El();m2(x,n,y.layoutBox),rre(M,x)||(m=!0),g.options.layoutRoot&&(e.relativeTarget=x,e.relativeTargetOrigin=M,e.relativeParent=g)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:t,delta:u,layoutDelta:a,hasLayoutChanged:d,hasRelativeLayoutChanged:m})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function BSe(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function USe(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function VSe(e){e.clearSnapshot()}function O8(e){e.clearMeasurements()}function L8(e){e.isLayoutDirty=!1}function WSe(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function D8(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function GSe(e){e.resolveTargetDelta()}function qSe(e){e.calcProjection()}function HSe(e){e.resetSkewAndRotation()}function KSe(e){e.removeLeadSnapshot()}function $8(e,t,r){e.translate=qs(t.translate,0,r),e.scale=qs(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function N8(e,t,r,n){e.min=qs(t.min,r.min,n),e.max=qs(t.max,r.max,n)}function ZSe(e,t,r,n){N8(e.x,t.x,r.x,n),N8(e.y,t.y,r.y,n)}function XSe(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const YSe={duration:.45,ease:[.4,0,.1,1]},j8=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),R8=j8("applewebkit/")&&!j8("chrome/")?Math.round:Dh;function F8(e){e.min=R8(e.min),e.max=R8(e.max)}function QSe(e){F8(e.x),F8(e.y)}function ore(e,t,r){return e==="position"||e==="preserve-aspect"&&!iSe(k8(t),k8(r),.2)}function JSe(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const eTe=ire({attachResizeListener:(e,t)=>aM(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),QI={current:void 0},are=ire({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!QI.current){const e=new eTe({});e.mount(window),e.setOptions({layoutScroll:!0}),QI.current=e}return QI.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),tTe={pan:{Feature:vSe},drag:{Feature:ySe,ProjectionNode:are,MeasureLayout:Qte}};function z8(e,t,r){const{props:n}=e;e.animationState&&n.whileHover&&e.animationState.setActive("whileHover",r==="Start");const i="onHover"+r,o=n[i];o&&Ls.postRender(()=>o(t,vS(t)))}class rTe extends $_{mount(){const{current:t}=this.node;t&&(this.unmount=A2e(t,(r,n)=>(z8(this.node,n,"Start"),i=>z8(this.node,i,"End"))))}unmount(){}}class nTe extends $_{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=gS(aM(this.node.current,"focus",()=>this.onFocus()),aM(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function B8(e,t,r){const{props:n}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&n.whileTap&&e.animationState.setActive("whileTap",r==="Start");const i="onTap"+(r==="End"?"":r),o=n[i];o&&Ls.postRender(()=>o(t,vS(t)))}class iTe extends $_{mount(){const{current:t}=this.node;t&&(this.unmount=O2e(t,(r,n)=>(B8(this.node,n,"Start"),(i,{success:o})=>B8(this.node,i,o?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const ND=new WeakMap,JI=new WeakMap,oTe=e=>{const t=ND.get(e.target);t&&t(e)},aTe=e=>{e.forEach(oTe)};function sTe({root:e,...t}){const r=e||document;JI.has(r)||JI.set(r,{});const n=JI.get(r),i=JSON.stringify(t);return n[i]||(n[i]=new IntersectionObserver(aTe,{root:e,...t})),n[i]}function lTe(e,t,r){const n=sTe(t);return ND.set(e,r),n.observe(e),()=>{ND.delete(e),n.unobserve(e)}}const cTe={some:0,all:1};class uTe extends $_{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:n,amount:i="some",once:o}=t,s={root:r?r.current:void 0,rootMargin:n,threshold:typeof i=="number"?i:cTe[i]},a=u=>{const{isIntersecting:d}=u;if(this.isInView===d||(this.isInView=d,o&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:m,onViewportLeave:g}=this.node.getProps(),_=d?m:g;_&&_(u)};return lTe(this.node.current,s,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(dTe(t,r))&&this.startObserver()}unmount(){}}function dTe({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const hTe={inView:{Feature:uTe},tap:{Feature:iTe},focus:{Feature:nTe},hover:{Feature:rTe}},fTe={layout:{ProjectionNode:are,MeasureLayout:Qte}},pTe={...QMe,...hTe,...tTe,...fTe},jf=pMe(pTe,EMe),mTe=({children:e})=>F.jsxs("div",{className:"min-h-screen bg-background",children:[F.jsx(jxe,{}),F.jsx(jf.main,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"pt-16",children:e})]}),Gg=oe.forwardRef(({className:e,type:t,...r},n)=>F.jsx("input",{type:t,className:_i("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:n,...r}));Gg.displayName="Input";var gTe="Label",sre=oe.forwardRef((e,t)=>F.jsx(Ei.label,{...e,ref:t,onMouseDown:r=>{var i;r.target.closest("button, input, select, textarea")||((i=e.onMouseDown)==null||i.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));sre.displayName=gTe;var lre=sre;const _Te=_5("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ld=oe.forwardRef(({className:e,...t},r)=>F.jsx(lre,{ref:r,className:_i(_Te(),e),...t}));ld.displayName=lre.displayName;const ci=oe.forwardRef(({className:e,...t},r)=>F.jsx("div",{ref:r,className:_i("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));ci.displayName="Card";const oo=oe.forwardRef(({className:e,...t},r)=>F.jsx("div",{ref:r,className:_i("flex flex-col space-y-1.5 p-6",e),...t}));oo.displayName="CardHeader";const ao=oe.forwardRef(({className:e,...t},r)=>F.jsx("h3",{ref:r,className:_i("text-2xl font-semibold leading-none tracking-tight",e),...t}));ao.displayName="CardTitle";const Fc=oe.forwardRef(({className:e,...t},r)=>F.jsx("p",{ref:r,className:_i("text-sm text-muted-foreground",e),...t}));Fc.displayName="CardDescription";const ui=oe.forwardRef(({className:e,...t},r)=>F.jsx("div",{ref:r,className:_i("p-6 pt-0",e),...t}));ui.displayName="CardContent";const yTe=oe.forwardRef(({className:e,...t},r)=>F.jsx("div",{ref:r,className:_i("flex items-center p-6 pt-0",e),...t}));yTe.displayName="CardFooter";const vTe=_5("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Hd({className:e,variant:t,...r}){return F.jsx("div",{className:_i(vTe({variant:t}),e),...r})}const bTe=()=>{const{isAuthenticated:e,login:t}=Xp(),{toast:r}=cS(),[n,i]=oe.useState(""),[o,s]=oe.useState(""),[a,u]=oe.useState("user"),[d,m]=oe.useState(!1);if(e)return F.jsx(oJ,{to:"/",replace:!0});const g=[{role:"user",title:"FRA Beneficiary",description:"View your forest rights and claim status",icon:JY,color:"bg-success text-success-foreground"},{role:"officer",title:"FRA Officer",description:"Manage claims and verification process",icon:Ege,color:"bg-warning text-warning-foreground"},{role:"admin",title:"District Administrator",description:"Full access to analytics and DSS",icon:Age,color:"bg-destructive text-destructive-foreground"}],_=async y=>{y.preventDefault(),m(!0);try{await t(n,o,a),r({title:"Login Successful",description:`Welcome to FRA Atlas Portal as ${a}`})}catch{r({title:"Login Failed",description:"Please check your credentials and try again.",variant:"destructive"})}finally{m(!1)}};return F.jsx("div",{className:"min-h-screen bg-gradient-hero flex items-center justify-center p-4",children:F.jsx(jf.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.3},className:"w-full max-w-md",children:F.jsxs(ci,{className:"glass-card",children:[F.jsxs(oo,{className:"text-center space-y-4",children:[F.jsx("div",{className:"w-16 h-16 bg-primary rounded-full flex items-center justify-center mx-auto",children:F.jsx(QY,{className:"w-8 h-8 text-primary-foreground"})}),F.jsxs("div",{children:[F.jsx(ao,{className:"text-2xl gov-heading",children:"FRA Atlas Portal"}),F.jsx(Fc,{className:"text-base",children:"Forest Rights Act - Decision Support System"})]})]}),F.jsxs(ui,{className:"space-y-6",children:[F.jsxs("div",{className:"space-y-3",children:[F.jsx(ld,{className:"text-sm font-medium",children:"Select Your Role"}),F.jsx("div",{className:"grid gap-3",children:g.map(y=>{const M=y.icon;return F.jsx("div",{className:`p-3 rounded-lg border-2 cursor-pointer transition-all ${a===y.role?"border-primary bg-primary/5":"border-border hover:border-primary/50"}`,onClick:()=>u(y.role),children:F.jsxs("div",{className:"flex items-center space-x-3",children:[F.jsx(M,{className:"w-5 h-5 text-primary"}),F.jsxs("div",{className:"flex-1",children:[F.jsxs("div",{className:"flex items-center space-x-2",children:[F.jsx("h3",{className:"font-medium text-sm",children:y.title}),F.jsx(Hd,{className:`text-xs ${y.color}`,children:y.role.toUpperCase()})]}),F.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:y.description})]})]})},y.role)})})]}),F.jsxs("form",{onSubmit:_,className:"space-y-4",children:[F.jsxs("div",{className:"space-y-2",children:[F.jsx(ld,{htmlFor:"email",children:"Email"}),F.jsx(Gg,{id:"email",type:"email",value:n,onChange:y=>i(y.target.value),placeholder:"Enter your email",required:!0})]}),F.jsxs("div",{className:"space-y-2",children:[F.jsx(ld,{htmlFor:"password",children:"Password"}),F.jsx(Gg,{id:"password",type:"password",value:o,onChange:y=>s(y.target.value),placeholder:"Enter your password",required:!0})]}),F.jsx(iu,{type:"submit",className:"w-full gradient-primary",disabled:d,children:d?"Signing In...":"Sign In"})]}),F.jsx("div",{className:"text-center",children:F.jsx("p",{className:"text-xs text-muted-foreground",children:"Demo Mode: Use any email/password to login"})})]})]})})})};var cR="Progress",uR=100,[xTe,$et]=Bh(cR),[wTe,MTe]=xTe(cR),cre=oe.forwardRef((e,t)=>{const{__scopeProgress:r,value:n=null,max:i,getValueLabel:o=STe,...s}=e;(i||i===0)&&!U8(i)&&console.error(TTe(`${i}`,"Progress"));const a=U8(i)?i:uR;n!==null&&!V8(n,a)&&console.error(PTe(`${n}`,"Progress"));const u=V8(n,a)?n:null,d=kA(u)?o(u,a):void 0;return F.jsx(wTe,{scope:r,value:u,max:a,children:F.jsx(Ei.div,{"aria-valuemax":a,"aria-valuemin":0,"aria-valuenow":kA(u)?u:void 0,"aria-valuetext":d,role:"progressbar","data-state":hre(u,a),"data-value":u??void 0,"data-max":a,...s,ref:t})})});cre.displayName=cR;var ure="ProgressIndicator",dre=oe.forwardRef((e,t)=>{const{__scopeProgress:r,...n}=e,i=MTe(ure,r);return F.jsx(Ei.div,{"data-state":hre(i.value,i.max),"data-value":i.value??void 0,"data-max":i.max,...n,ref:t})});dre.displayName=ure;function STe(e,t){return`${Math.round(e/t*100)}%`}function hre(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function kA(e){return typeof e=="number"}function U8(e){return kA(e)&&!isNaN(e)&&e>0}function V8(e,t){return kA(e)&&!isNaN(e)&&e<=t&&e>=0}function TTe(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${uR}\`.`}function PTe(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${uR} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var fre=cre,ETe=dre;const pre=oe.forwardRef(({className:e,value:t,...r},n)=>F.jsx(fre,{ref:n,className:_i("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...r,children:F.jsx(ETe,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));pre.displayName=fre.displayName;const IE=new Map,yy=[],ATe=(e,t,r)=>{if(t&&typeof t.init=="function"&&typeof t.createInferenceSessionHandler=="function"){const n=IE.get(e);if(n===void 0)IE.set(e,{backend:t,priority:r});else{if(n.priority>r)return;if(n.priority===r&&n.backend!==t)throw new Error(`cannot register backend "${e}" using priority ${r}`)}if(r>=0){const i=yy.indexOf(e);i!==-1&&yy.splice(i,1);for(let o=0;o<yy.length;o++)if(IE.get(yy[o]).priority<=r){yy.splice(o,0,e);return}yy.push(e)}return}throw new TypeError("not a valid backend")},CTe=async e=>{const t=IE.get(e);if(!t)return"backend not found.";if(t.initialized)return t.backend;if(t.aborted)return t.error;{const r=!!t.initPromise;try{return r||(t.initPromise=t.backend.init(e)),await t.initPromise,t.initialized=!0,t.backend}catch(n){return r||(t.error=`${n}`,t.aborted=!0),t.error}finally{delete t.initPromise}}},kTe=async e=>{const t=e.executionProviders||[],r=t.map(u=>typeof u=="string"?u:u.name),n=r.length===0?yy:r;let i;const o=[],s=new Set;for(const u of n){const d=await CTe(u);typeof d=="string"?o.push({name:u,err:d}):(i||(i=d),i===d&&s.add(u))}if(!i)throw new Error(`no available backend found. ERR: ${o.map(u=>`[${u.name}] ${u.err}`).join(", ")}`);for(const{name:u,err:d}of o)r.includes(u)&&console.warn(`removing requested execution provider "${u}" from session options because it is not available: ${d}`);const a=t.filter(u=>s.has(typeof u=="string"?u:u.name));return[i,new Proxy(e,{get:(u,d)=>d==="executionProviders"?a:Reflect.get(u,d)})]},ITe="1.21.0";let W8="warning";const Rf={wasm:{},webgl:{},webgpu:{},versions:{common:ITe},set logLevel(e){if(e!==void 0){if(typeof e!="string"||["verbose","info","warning","error","fatal"].indexOf(e)===-1)throw new Error(`Unsupported logging level: ${e}`);W8=e}},get logLevel(){return W8}};Object.defineProperty(Rf,"logLevel",{enumerable:!0});const OTe=Rf,LTe=(e,t)=>{const r=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);r.width=e.dims[3],r.height=e.dims[2];const n=r.getContext("2d");if(n!=null){let i,o;(t==null?void 0:t.tensorLayout)!==void 0&&t.tensorLayout==="NHWC"?(i=e.dims[2],o=e.dims[3]):(i=e.dims[3],o=e.dims[2]);const s=(t==null?void 0:t.format)!==void 0?t.format:"RGB",a=t==null?void 0:t.norm;let u,d;a===void 0||a.mean===void 0?u=[255,255,255,255]:typeof a.mean=="number"?u=[a.mean,a.mean,a.mean,a.mean]:(u=[a.mean[0],a.mean[1],a.mean[2],0],a.mean[3]!==void 0&&(u[3]=a.mean[3])),a===void 0||a.bias===void 0?d=[0,0,0,0]:typeof a.bias=="number"?d=[a.bias,a.bias,a.bias,a.bias]:(d=[a.bias[0],a.bias[1],a.bias[2],0],a.bias[3]!==void 0&&(d[3]=a.bias[3]));const m=o*i;let g=0,_=m,y=m*2,M=-1;s==="RGBA"?(g=0,_=m,y=m*2,M=m*3):s==="RGB"?(g=0,_=m,y=m*2):s==="RBG"&&(g=0,y=m,_=m*2);for(let x=0;x<o;x++)for(let E=0;E<i;E++){const T=(e.data[g++]-d[0])*u[0],P=(e.data[_++]-d[1])*u[1],C=(e.data[y++]-d[2])*u[2],D=M===-1?255:(e.data[M++]-d[3])*u[3];n.fillStyle="rgba("+T+","+P+","+C+","+D+")",n.fillRect(E,x,1,1)}if("toDataURL"in r)return r.toDataURL();throw new Error("toDataURL is not supported")}else throw new Error("Can not access image data")},DTe=(e,t)=>{const r=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d");let n;if(r!=null){let i,o,s;(t==null?void 0:t.tensorLayout)!==void 0&&t.tensorLayout==="NHWC"?(i=e.dims[2],o=e.dims[1],s=e.dims[3]):(i=e.dims[3],o=e.dims[2],s=e.dims[1]);const a=t!==void 0&&t.format!==void 0?t.format:"RGB",u=t==null?void 0:t.norm;let d,m;u===void 0||u.mean===void 0?d=[255,255,255,255]:typeof u.mean=="number"?d=[u.mean,u.mean,u.mean,u.mean]:(d=[u.mean[0],u.mean[1],u.mean[2],255],u.mean[3]!==void 0&&(d[3]=u.mean[3])),u===void 0||u.bias===void 0?m=[0,0,0,0]:typeof u.bias=="number"?m=[u.bias,u.bias,u.bias,u.bias]:(m=[u.bias[0],u.bias[1],u.bias[2],0],u.bias[3]!==void 0&&(m[3]=u.bias[3]));const g=o*i;if(t!==void 0&&(t.format!==void 0&&s===4&&t.format!=="RGBA"||s===3&&t.format!=="RGB"&&t.format!=="BGR"))throw new Error("Tensor format doesn't match input tensor dims");const _=4;let y=0,M=1,x=2,E=3,T=0,P=g,C=g*2,D=-1;a==="RGBA"?(T=0,P=g,C=g*2,D=g*3):a==="RGB"?(T=0,P=g,C=g*2):a==="RBG"&&(T=0,C=g,P=g*2),n=r.createImageData(i,o);for(let L=0;L<o*i;y+=_,M+=_,x+=_,E+=_,L++)n.data[y]=(e.data[T++]-m[0])*d[0],n.data[M]=(e.data[P++]-m[1])*d[1],n.data[x]=(e.data[C++]-m[2])*d[2],n.data[E]=D===-1?255:(e.data[D++]-m[3])*d[3]}else throw new Error("Can not access image data");return n},e3=(e,t)=>{if(e===void 0)throw new Error("Image buffer must be defined");if(t.height===void 0||t.width===void 0)throw new Error("Image height and width must be defined");if(t.tensorLayout==="NHWC")throw new Error("NHWC Tensor layout is not supported yet");const{height:r,width:n}=t,i=t.norm??{mean:255,bias:0};let o,s;typeof i.mean=="number"?o=[i.mean,i.mean,i.mean,i.mean]:o=[i.mean[0],i.mean[1],i.mean[2],i.mean[3]??255],typeof i.bias=="number"?s=[i.bias,i.bias,i.bias,i.bias]:s=[i.bias[0],i.bias[1],i.bias[2],i.bias[3]??0];const a=t.format!==void 0?t.format:"RGBA",u=t.tensorFormat!==void 0&&t.tensorFormat!==void 0?t.tensorFormat:"RGB",d=r*n,m=u==="RGBA"?new Float32Array(d*4):new Float32Array(d*3);let g=4,_=0,y=1,M=2,x=3,E=0,T=d,P=d*2,C=-1;a==="RGB"&&(g=3,_=0,y=1,M=2,x=-1),u==="RGBA"?C=d*3:u==="RBG"?(E=0,P=d,T=d*2):u==="BGR"&&(P=0,T=d,E=d*2);for(let L=0;L<d;L++,_+=g,M+=g,y+=g,x+=g)m[E++]=(e[_]+s[0])/o[0],m[T++]=(e[y]+s[1])/o[1],m[P++]=(e[M]+s[2])/o[2],C!==-1&&x!==-1&&(m[C++]=(e[x]+s[3])/o[3]);return u==="RGBA"?new Eh("float32",m,[1,4,r,n]):new Eh("float32",m,[1,3,r,n])},$Te=async(e,t)=>{const r=typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement,n=typeof ImageData<"u"&&e instanceof ImageData,i=typeof ImageBitmap<"u"&&e instanceof ImageBitmap,o=typeof e=="string";let s,a=t??{};const u=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},d=m=>typeof HTMLCanvasElement<"u"&&m instanceof HTMLCanvasElement||m instanceof OffscreenCanvas?m.getContext("2d"):null;if(r){const m=u();m.width=e.width,m.height=e.height;const g=d(m);if(g!=null){let _=e.height,y=e.width;if(t!==void 0&&t.resizedHeight!==void 0&&t.resizedWidth!==void 0&&(_=t.resizedHeight,y=t.resizedWidth),t!==void 0){if(a=t,t.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");a.tensorFormat="RGBA",a.height=_,a.width=y}else a.tensorFormat="RGBA",a.height=_,a.width=y;g.drawImage(e,0,0),s=g.getImageData(0,0,y,_).data}else throw new Error("Can not access image data")}else if(n){let m,g;if(t!==void 0&&t.resizedWidth!==void 0&&t.resizedHeight!==void 0?(m=t.resizedHeight,g=t.resizedWidth):(m=e.height,g=e.width),t!==void 0&&(a=t),a.format="RGBA",a.height=m,a.width=g,t!==void 0){const _=u();_.width=g,_.height=m;const y=d(_);if(y!=null)y.putImageData(e,0,0),s=y.getImageData(0,0,g,m).data;else throw new Error("Can not access image data")}else s=e.data}else if(i){if(t===void 0)throw new Error("Please provide image config with format for Imagebitmap");const m=u();m.width=e.width,m.height=e.height;const g=d(m);if(g!=null){const _=e.height,y=e.width;return g.drawImage(e,0,0,y,_),s=g.getImageData(0,0,y,_).data,a.height=_,a.width=y,e3(s,a)}else throw new Error("Can not access image data")}else{if(o)return new Promise((m,g)=>{const _=u(),y=d(_);if(!e||!y)return g();const M=new Image;M.crossOrigin="Anonymous",M.src=e,M.onload=()=>{_.width=M.width,_.height=M.height,y.drawImage(M,0,0,_.width,_.height);const x=y.getImageData(0,0,_.width,_.height);a.height=_.height,a.width=_.width,m(e3(x.data,a))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if(s!==void 0)return e3(s,a);throw new Error("Input data provided is not supported - aborted tensor creation")},NTe=(e,t)=>{const{width:r,height:n,download:i,dispose:o}=t,s=[1,n,r,4];return new Eh({location:"texture",type:"float32",texture:e,dims:s,download:i,dispose:o})},jTe=(e,t)=>{const{dataType:r,dims:n,download:i,dispose:o}=t;return new Eh({location:"gpu-buffer",type:r??"float32",gpuBuffer:e,dims:n,download:i,dispose:o})},RTe=(e,t)=>{const{dataType:r,dims:n,download:i,dispose:o}=t;return new Eh({location:"ml-tensor",type:r??"float32",mlTensor:e,dims:n,download:i,dispose:o})},FTe=(e,t,r)=>new Eh({location:"cpu-pinned",type:e,data:t,dims:r??[t.length]}),n1=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array],["int4",Uint8Array],["uint4",Uint8Array]]),OE=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]);let G8=!1;const zTe=()=>{if(!G8){G8=!0;const e=typeof BigInt64Array<"u"&&BigInt64Array.from,t=typeof BigUint64Array<"u"&&BigUint64Array.from,r=globalThis.Float16Array,n=typeof r<"u"&&r.from;e&&(n1.set("int64",BigInt64Array),OE.set(BigInt64Array,"int64")),t&&(n1.set("uint64",BigUint64Array),OE.set(BigUint64Array,"uint64")),n?(n1.set("float16",r),OE.set(r,"float16")):n1.set("float16",Uint16Array)}},BTe=e=>{let t=1;for(let r=0;r<e.length;r++){const n=e[r];if(typeof n!="number"||!Number.isSafeInteger(n))throw new TypeError(`dims[${r}] must be an integer, got: ${n}`);if(n<0)throw new RangeError(`dims[${r}] must be a non-negative integer, got: ${n}`);t*=n}return t},UTe=(e,t)=>{switch(e.location){case"cpu":return new Eh(e.type,e.data,t);case"cpu-pinned":return new Eh({location:"cpu-pinned",data:e.data,type:e.type,dims:t});case"texture":return new Eh({location:"texture",texture:e.texture,type:e.type,dims:t});case"gpu-buffer":return new Eh({location:"gpu-buffer",gpuBuffer:e.gpuBuffer,type:e.type,dims:t});case"ml-tensor":return new Eh({location:"ml-tensor",mlTensor:e.mlTensor,type:e.type,dims:t});default:throw new Error(`tensorReshape: tensor location ${e.location} is not supported`)}};let Eh=class{constructor(t,r,n){zTe();let i,o;if(typeof t=="object"&&"location"in t)switch(this.dataLocation=t.location,i=t.type,o=t.dims,t.location){case"cpu-pinned":{const a=n1.get(i);if(!a)throw new TypeError(`unsupported type "${i}" to create tensor from pinned buffer`);if(!(t.data instanceof a))throw new TypeError(`buffer should be of type ${a.name}`);this.cpuData=t.data;break}case"texture":{if(i!=="float32")throw new TypeError(`unsupported type "${i}" to create tensor from texture`);this.gpuTextureData=t.texture,this.downloader=t.download,this.disposer=t.dispose;break}case"gpu-buffer":{if(i!=="float32"&&i!=="float16"&&i!=="int32"&&i!=="int64"&&i!=="uint32"&&i!=="uint8"&&i!=="bool"&&i!=="uint4"&&i!=="int4")throw new TypeError(`unsupported type "${i}" to create tensor from gpu buffer`);this.gpuBufferData=t.gpuBuffer,this.downloader=t.download,this.disposer=t.dispose;break}case"ml-tensor":{if(i!=="float32"&&i!=="float16"&&i!=="int32"&&i!=="int64"&&i!=="uint32"&&i!=="uint64"&&i!=="int8"&&i!=="uint8"&&i!=="bool"&&i!=="uint4"&&i!=="int4")throw new TypeError(`unsupported type "${i}" to create tensor from MLTensor`);this.mlTensorData=t.mlTensor,this.downloader=t.download,this.disposer=t.dispose;break}default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let a,u;if(typeof t=="string")if(i=t,u=n,t==="string"){if(!Array.isArray(r))throw new TypeError("A string tensor's data must be a string array.");a=r}else{const d=n1.get(t);if(d===void 0)throw new TypeError(`Unsupported tensor type: ${t}.`);if(Array.isArray(r)){if(t==="float16"&&d===Uint16Array||t==="uint4"||t==="int4")throw new TypeError(`Creating a ${t} tensor from number array is not supported. Please use ${d.name} as data.`);t==="uint64"||t==="int64"?a=d.from(r,BigInt):a=d.from(r)}else if(r instanceof d)a=r;else if(r instanceof Uint8ClampedArray)if(t==="uint8")a=Uint8Array.from(r);else throw new TypeError("A Uint8ClampedArray tensor's data must be type of uint8");else if(t==="float16"&&r instanceof Uint16Array&&d!==Uint16Array)a=new globalThis.Float16Array(r.buffer,r.byteOffset,r.length);else throw new TypeError(`A ${i} tensor's data must be type of ${d}`)}else if(u=r,Array.isArray(t)){if(t.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");const d=typeof t[0];if(d==="string")i="string",a=t;else if(d==="boolean")i="bool",a=Uint8Array.from(t);else throw new TypeError(`Invalid element type of data array: ${d}.`)}else if(t instanceof Uint8ClampedArray)i="uint8",a=Uint8Array.from(t);else{const d=OE.get(t.constructor);if(d===void 0)throw new TypeError(`Unsupported type for tensor data: ${t.constructor}.`);i=d,a=t}if(u===void 0)u=[a.length];else if(!Array.isArray(u))throw new TypeError("A tensor's dims must be a number array");o=u,this.cpuData=a,this.dataLocation="cpu"}const s=BTe(o);if(this.cpuData&&s!==this.cpuData.length&&!((i==="uint4"||i==="int4")&&Math.ceil(s/2)===this.cpuData.length))throw new Error(`Tensor's size(${s}) does not match data length(${this.cpuData.length}).`);this.type=i,this.dims=o,this.size=s}static async fromImage(t,r){return $Te(t,r)}static fromTexture(t,r){return NTe(t,r)}static fromGpuBuffer(t,r){return jTe(t,r)}static fromMLTensor(t,r){return RTe(t,r)}static fromPinnedBuffer(t,r,n){return FTe(t,r,n)}toDataURL(t){return LTe(this,t)}toImageData(t){return DTe(this,t)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}get mlTensor(){if(this.ensureValid(),!this.mlTensorData)throw new Error("The data is not stored as a WebNN MLTensor.");return this.mlTensorData}async getData(t){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":case"ml-tensor":{if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;const r=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=r,t&&this.disposer&&(this.disposer(),this.disposer=void 0),r}finally{this.isDownloading=!1}}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.mlTensorData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if(this.dataLocation==="none")throw new Error("The tensor is disposed.")}reshape(t){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return UTe(this,t)}};const $v=Eh,mre=(e,t)=>{(typeof Rf.trace>"u"?!Rf.wasm.trace:!Rf.trace)||console.timeStamp(`${e}::ORT::${t}`)},gre=(e,t)=>{var i;const r=((i=new Error().stack)==null?void 0:i.split(/\r\n|\r|\n/g))||[];let n=!1;for(let o=0;o<r.length;o++){if(n&&!r[o].includes("TRACE_FUNC")){let s=`FUNC_${e}::${r[o].trim().split(" ")[1]}`;t&&(s+=`::${t}`),mre("CPU",s);return}r[o].includes("TRACE_FUNC")&&(n=!0)}},jD=e=>{(typeof Rf.trace>"u"?!Rf.wasm.trace:!Rf.trace)||gre("BEGIN",e)},RD=e=>{(typeof Rf.trace>"u"?!Rf.wasm.trace:!Rf.trace)||gre("END",e)};let VTe=class _re{constructor(t){this.handler=t}async run(t,r,n){jD();const i={};let o={};if(typeof t!="object"||t===null||t instanceof $v||Array.isArray(t))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let s=!0;if(typeof r=="object"){if(r===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(r instanceof $v)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(r)){if(r.length===0)throw new TypeError("'fetches' cannot be an empty array.");s=!1;for(const d of r){if(typeof d!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(d)===-1)throw new RangeError(`'fetches' contains invalid output name: ${d}.`);i[d]=null}if(typeof n=="object"&&n!==null)o=n;else if(typeof n<"u")throw new TypeError("'options' must be an object.")}else{let d=!1;const m=Object.getOwnPropertyNames(r);for(const g of this.outputNames)if(m.indexOf(g)!==-1){const _=r[g];(_===null||_ instanceof $v)&&(d=!0,s=!1,i[g]=_)}if(d){if(typeof n=="object"&&n!==null)o=n;else if(typeof n<"u")throw new TypeError("'options' must be an object.")}else o=r}}else if(typeof r<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(const d of this.inputNames)if(typeof t[d]>"u")throw new Error(`input '${d}' is missing in 'feeds'.`);if(s)for(const d of this.outputNames)i[d]=null;const a=await this.handler.run(t,i,o),u={};for(const d in a)if(Object.hasOwnProperty.call(a,d)){const m=a[d];m instanceof $v?u[d]=m:u[d]=new $v(m.type,m.data,m.dims)}return RD(),u}async release(){return this.handler.dispose()}static async create(t,r,n,i){jD();let o,s={};if(typeof t=="string"){if(o=t,typeof r=="object"&&r!==null)s=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else if(t instanceof Uint8Array){if(o=t,typeof r=="object"&&r!==null)s=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else if(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer){const m=t;let g=0,_=t.byteLength;if(typeof r=="object"&&r!==null)s=r;else if(typeof r=="number"){if(g=r,!Number.isSafeInteger(g))throw new RangeError("'byteOffset' must be an integer.");if(g<0||g>=m.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${m.byteLength}).`);if(_=t.byteLength-g,typeof n=="number"){if(_=n,!Number.isSafeInteger(_))throw new RangeError("'byteLength' must be an integer.");if(_<=0||g+_>m.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${m.byteLength-g}].`);if(typeof i=="object"&&i!==null)s=i;else if(typeof i<"u")throw new TypeError("'options' must be an object.")}else if(typeof n<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof r<"u")throw new TypeError("'options' must be an object.");o=new Uint8Array(m,g,_)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");const[a,u]=await kTe(s),d=await a.createInferenceSessionHandler(o,u);return RD(),new _re(d)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}};const WTe=VTe,GTe=Object.freeze(Object.defineProperty({__proto__:null,InferenceSession:WTe,TRACE:mre,TRACE_FUNC_BEGIN:jD,TRACE_FUNC_END:RD,Tensor:$v,env:OTe,registerBackend:ATe},Symbol.toStringTag,{value:"Module"}));/*!
 * ONNX Runtime Web v1.22.0-dev.20250409-89f8206ba4
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */var dR=Object.defineProperty,qTe=Object.getOwnPropertyDescriptor,HTe=Object.getOwnPropertyNames,KTe=Object.prototype.hasOwnProperty,ZTe=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')}),nn=(e,t)=>()=>(e&&(t=e(e=0)),t),Bb=(e,t)=>{for(var r in t)dR(e,r,{get:t[r],enumerable:!0})},XTe=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of HTe(t))!KTe.call(e,i)&&i!==r&&dR(e,i,{get:()=>t[i],enumerable:!(n=qTe(t,i))||n.enumerable});return e},sM=e=>XTe(dR({},"__esModule",{value:!0}),e),_w,Ag,Oy,q8,yre,vre=nn(()=>{_w=new Map,Ag=[],Oy=(e,t,r)=>{if(t&&typeof t.init=="function"&&typeof t.createInferenceSessionHandler=="function"){let n=_w.get(e);if(n===void 0)_w.set(e,{backend:t,priority:r});else{if(n.priority>r)return;if(n.priority===r&&n.backend!==t)throw new Error(`cannot register backend "${e}" using priority ${r}`)}if(r>=0){let i=Ag.indexOf(e);i!==-1&&Ag.splice(i,1);for(let o=0;o<Ag.length;o++)if(_w.get(Ag[o]).priority<=r){Ag.splice(o,0,e);return}Ag.push(e)}return}throw new TypeError("not a valid backend")},q8=async e=>{let t=_w.get(e);if(!t)return"backend not found.";if(t.initialized)return t.backend;if(t.aborted)return t.error;{let r=!!t.initPromise;try{return r||(t.initPromise=t.backend.init(e)),await t.initPromise,t.initialized=!0,t.backend}catch(n){return r||(t.error=`${n}`,t.aborted=!0),t.error}finally{delete t.initPromise}}},yre=async e=>{let t=e.executionProviders||[],r=t.map(u=>typeof u=="string"?u:u.name),n=r.length===0?Ag:r,i,o=[],s=new Set;for(let u of n){let d=await q8(u);typeof d=="string"?o.push({name:u,err:d}):(i||(i=d),i===d&&s.add(u))}if(!i)throw new Error(`no available backend found. ERR: ${o.map(u=>`[${u.name}] ${u.err}`).join(", ")}`);for(let{name:u,err:d}of o)r.includes(u)&&console.warn(`removing requested execution provider "${u}" from session options because it is not available: ${d}`);let a=t.filter(u=>s.has(typeof u=="string"?u:u.name));return[i,new Proxy(e,{get:(u,d)=>d==="executionProviders"?a:Reflect.get(u,d)})]}}),YTe=nn(()=>{vre()}),bre,QTe=nn(()=>{bre="1.22.0-dev.20250409-89f8206ba4"}),t3,Mh,xre=nn(()=>{QTe(),t3="warning",Mh={wasm:{},webgl:{},webgpu:{},versions:{common:bre},set logLevel(e){if(e!==void 0){if(typeof e!="string"||["verbose","info","warning","error","fatal"].indexOf(e)===-1)throw new Error(`Unsupported logging level: ${e}`);t3=e}},get logLevel(){return t3}},Object.defineProperty(Mh,"logLevel",{enumerable:!0})}),Ua,JTe=nn(()=>{xre(),Ua=Mh}),wre,Mre,ePe=nn(()=>{wre=(e,t)=>{let r=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);r.width=e.dims[3],r.height=e.dims[2];let n=r.getContext("2d");if(n!=null){let i,o;(t==null?void 0:t.tensorLayout)!==void 0&&t.tensorLayout==="NHWC"?(i=e.dims[2],o=e.dims[3]):(i=e.dims[3],o=e.dims[2]);let s=(t==null?void 0:t.format)!==void 0?t.format:"RGB",a=t==null?void 0:t.norm,u,d;a===void 0||a.mean===void 0?u=[255,255,255,255]:typeof a.mean=="number"?u=[a.mean,a.mean,a.mean,a.mean]:(u=[a.mean[0],a.mean[1],a.mean[2],0],a.mean[3]!==void 0&&(u[3]=a.mean[3])),a===void 0||a.bias===void 0?d=[0,0,0,0]:typeof a.bias=="number"?d=[a.bias,a.bias,a.bias,a.bias]:(d=[a.bias[0],a.bias[1],a.bias[2],0],a.bias[3]!==void 0&&(d[3]=a.bias[3]));let m=o*i,g=0,_=m,y=m*2,M=-1;s==="RGBA"?(g=0,_=m,y=m*2,M=m*3):s==="RGB"?(g=0,_=m,y=m*2):s==="RBG"&&(g=0,y=m,_=m*2);for(let x=0;x<o;x++)for(let E=0;E<i;E++){let T=(e.data[g++]-d[0])*u[0],P=(e.data[_++]-d[1])*u[1],C=(e.data[y++]-d[2])*u[2],D=M===-1?255:(e.data[M++]-d[3])*u[3];n.fillStyle="rgba("+T+","+P+","+C+","+D+")",n.fillRect(E,x,1,1)}if("toDataURL"in r)return r.toDataURL();throw new Error("toDataURL is not supported")}else throw new Error("Can not access image data")},Mre=(e,t)=>{let r=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d"),n;if(r!=null){let i,o,s;(t==null?void 0:t.tensorLayout)!==void 0&&t.tensorLayout==="NHWC"?(i=e.dims[2],o=e.dims[1],s=e.dims[3]):(i=e.dims[3],o=e.dims[2],s=e.dims[1]);let a=t!==void 0&&t.format!==void 0?t.format:"RGB",u=t==null?void 0:t.norm,d,m;u===void 0||u.mean===void 0?d=[255,255,255,255]:typeof u.mean=="number"?d=[u.mean,u.mean,u.mean,u.mean]:(d=[u.mean[0],u.mean[1],u.mean[2],255],u.mean[3]!==void 0&&(d[3]=u.mean[3])),u===void 0||u.bias===void 0?m=[0,0,0,0]:typeof u.bias=="number"?m=[u.bias,u.bias,u.bias,u.bias]:(m=[u.bias[0],u.bias[1],u.bias[2],0],u.bias[3]!==void 0&&(m[3]=u.bias[3]));let g=o*i;if(t!==void 0&&(t.format!==void 0&&s===4&&t.format!=="RGBA"||s===3&&t.format!=="RGB"&&t.format!=="BGR"))throw new Error("Tensor format doesn't match input tensor dims");let _=4,y=0,M=1,x=2,E=3,T=0,P=g,C=g*2,D=-1;a==="RGBA"?(T=0,P=g,C=g*2,D=g*3):a==="RGB"?(T=0,P=g,C=g*2):a==="RBG"&&(T=0,C=g,P=g*2),n=r.createImageData(i,o);for(let L=0;L<o*i;y+=_,M+=_,x+=_,E+=_,L++)n.data[y]=(e.data[T++]-m[0])*d[0],n.data[M]=(e.data[P++]-m[1])*d[1],n.data[x]=(e.data[C++]-m[2])*d[2],n.data[E]=D===-1?255:(e.data[D++]-m[3])*d[3]}else throw new Error("Can not access image data");return n}}),MP,Sre,Tre,Pre,Ere,Are,tPe=nn(()=>{hR(),MP=(e,t)=>{if(e===void 0)throw new Error("Image buffer must be defined");if(t.height===void 0||t.width===void 0)throw new Error("Image height and width must be defined");if(t.tensorLayout==="NHWC")throw new Error("NHWC Tensor layout is not supported yet");let{height:r,width:n}=t,i=t.norm??{mean:255,bias:0},o,s;typeof i.mean=="number"?o=[i.mean,i.mean,i.mean,i.mean]:o=[i.mean[0],i.mean[1],i.mean[2],i.mean[3]??255],typeof i.bias=="number"?s=[i.bias,i.bias,i.bias,i.bias]:s=[i.bias[0],i.bias[1],i.bias[2],i.bias[3]??0];let a=t.format!==void 0?t.format:"RGBA",u=t.tensorFormat!==void 0&&t.tensorFormat!==void 0?t.tensorFormat:"RGB",d=r*n,m=u==="RGBA"?new Float32Array(d*4):new Float32Array(d*3),g=4,_=0,y=1,M=2,x=3,E=0,T=d,P=d*2,C=-1;a==="RGB"&&(g=3,_=0,y=1,M=2,x=-1),u==="RGBA"?C=d*3:u==="RBG"?(E=0,P=d,T=d*2):u==="BGR"&&(P=0,T=d,E=d*2);for(let D=0;D<d;D++,_+=g,M+=g,y+=g,x+=g)m[E++]=(e[_]+s[0])/o[0],m[T++]=(e[y]+s[1])/o[1],m[P++]=(e[M]+s[2])/o[2],C!==-1&&x!==-1&&(m[C++]=(e[x]+s[3])/o[3]);return u==="RGBA"?new Wd("float32",m,[1,4,r,n]):new Wd("float32",m,[1,3,r,n])},Sre=async(e,t)=>{let r=typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement,n=typeof ImageData<"u"&&e instanceof ImageData,i=typeof ImageBitmap<"u"&&e instanceof ImageBitmap,o=typeof e=="string",s,a=t??{},u=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},d=m=>typeof HTMLCanvasElement<"u"&&m instanceof HTMLCanvasElement||m instanceof OffscreenCanvas?m.getContext("2d"):null;if(r){let m=u();m.width=e.width,m.height=e.height;let g=d(m);if(g!=null){let _=e.height,y=e.width;if(t!==void 0&&t.resizedHeight!==void 0&&t.resizedWidth!==void 0&&(_=t.resizedHeight,y=t.resizedWidth),t!==void 0){if(a=t,t.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");a.tensorFormat="RGBA",a.height=_,a.width=y}else a.tensorFormat="RGBA",a.height=_,a.width=y;g.drawImage(e,0,0),s=g.getImageData(0,0,y,_).data}else throw new Error("Can not access image data")}else if(n){let m,g;if(t!==void 0&&t.resizedWidth!==void 0&&t.resizedHeight!==void 0?(m=t.resizedHeight,g=t.resizedWidth):(m=e.height,g=e.width),t!==void 0&&(a=t),a.format="RGBA",a.height=m,a.width=g,t!==void 0){let _=u();_.width=g,_.height=m;let y=d(_);if(y!=null)y.putImageData(e,0,0),s=y.getImageData(0,0,g,m).data;else throw new Error("Can not access image data")}else s=e.data}else if(i){if(t===void 0)throw new Error("Please provide image config with format for Imagebitmap");let m=u();m.width=e.width,m.height=e.height;let g=d(m);if(g!=null){let _=e.height,y=e.width;return g.drawImage(e,0,0,y,_),s=g.getImageData(0,0,y,_).data,a.height=_,a.width=y,MP(s,a)}else throw new Error("Can not access image data")}else{if(o)return new Promise((m,g)=>{let _=u(),y=d(_);if(!e||!y)return g();let M=new Image;M.crossOrigin="Anonymous",M.src=e,M.onload=()=>{_.width=M.width,_.height=M.height,y.drawImage(M,0,0,_.width,_.height);let x=y.getImageData(0,0,_.width,_.height);a.height=_.height,a.width=_.width,m(MP(x.data,a))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if(s!==void 0)return MP(s,a);throw new Error("Input data provided is not supported - aborted tensor creation")},Tre=(e,t)=>{let{width:r,height:n,download:i,dispose:o}=t,s=[1,n,r,4];return new Wd({location:"texture",type:"float32",texture:e,dims:s,download:i,dispose:o})},Pre=(e,t)=>{let{dataType:r,dims:n,download:i,dispose:o}=t;return new Wd({location:"gpu-buffer",type:r??"float32",gpuBuffer:e,dims:n,download:i,dispose:o})},Ere=(e,t)=>{let{dataType:r,dims:n,download:i,dispose:o}=t;return new Wd({location:"ml-tensor",type:r??"float32",mlTensor:e,dims:n,download:i,dispose:o})},Are=(e,t,r)=>new Wd({location:"cpu-pinned",type:e,data:t,dims:r??[t.length]})}),My,Hw,r3,Cre,rPe=nn(()=>{My=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array],["int4",Uint8Array],["uint4",Uint8Array]]),Hw=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),r3=!1,Cre=()=>{if(!r3){r3=!0;let e=typeof BigInt64Array<"u"&&BigInt64Array.from,t=typeof BigUint64Array<"u"&&BigUint64Array.from,r=globalThis.Float16Array,n=typeof r<"u"&&r.from;e&&(My.set("int64",BigInt64Array),Hw.set(BigInt64Array,"int64")),t&&(My.set("uint64",BigUint64Array),Hw.set(BigUint64Array,"uint64")),n?(My.set("float16",r),Hw.set(r,"float16")):My.set("float16",Uint16Array)}}}),kre,Ire,nPe=nn(()=>{hR(),kre=e=>{let t=1;for(let r=0;r<e.length;r++){let n=e[r];if(typeof n!="number"||!Number.isSafeInteger(n))throw new TypeError(`dims[${r}] must be an integer, got: ${n}`);if(n<0)throw new RangeError(`dims[${r}] must be a non-negative integer, got: ${n}`);t*=n}return t},Ire=(e,t)=>{switch(e.location){case"cpu":return new Wd(e.type,e.data,t);case"cpu-pinned":return new Wd({location:"cpu-pinned",data:e.data,type:e.type,dims:t});case"texture":return new Wd({location:"texture",texture:e.texture,type:e.type,dims:t});case"gpu-buffer":return new Wd({location:"gpu-buffer",gpuBuffer:e.gpuBuffer,type:e.type,dims:t});case"ml-tensor":return new Wd({location:"ml-tensor",mlTensor:e.mlTensor,type:e.type,dims:t});default:throw new Error(`tensorReshape: tensor location ${e.location} is not supported`)}}}),Wd,hR=nn(()=>{ePe(),tPe(),rPe(),nPe(),Wd=class{constructor(e,t,r){Cre();let n,i;if(typeof e=="object"&&"location"in e)switch(this.dataLocation=e.location,n=e.type,i=e.dims,e.location){case"cpu-pinned":{let s=My.get(n);if(!s)throw new TypeError(`unsupported type "${n}" to create tensor from pinned buffer`);if(!(e.data instanceof s))throw new TypeError(`buffer should be of type ${s.name}`);this.cpuData=e.data;break}case"texture":{if(n!=="float32")throw new TypeError(`unsupported type "${n}" to create tensor from texture`);this.gpuTextureData=e.texture,this.downloader=e.download,this.disposer=e.dispose;break}case"gpu-buffer":{if(n!=="float32"&&n!=="float16"&&n!=="int32"&&n!=="int64"&&n!=="uint32"&&n!=="uint8"&&n!=="bool"&&n!=="uint4"&&n!=="int4")throw new TypeError(`unsupported type "${n}" to create tensor from gpu buffer`);this.gpuBufferData=e.gpuBuffer,this.downloader=e.download,this.disposer=e.dispose;break}case"ml-tensor":{if(n!=="float32"&&n!=="float16"&&n!=="int32"&&n!=="int64"&&n!=="uint32"&&n!=="uint64"&&n!=="int8"&&n!=="uint8"&&n!=="bool"&&n!=="uint4"&&n!=="int4")throw new TypeError(`unsupported type "${n}" to create tensor from MLTensor`);this.mlTensorData=e.mlTensor,this.downloader=e.download,this.disposer=e.dispose;break}default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let s,a;if(typeof e=="string")if(n=e,a=r,e==="string"){if(!Array.isArray(t))throw new TypeError("A string tensor's data must be a string array.");s=t}else{let u=My.get(e);if(u===void 0)throw new TypeError(`Unsupported tensor type: ${e}.`);if(Array.isArray(t)){if(e==="float16"&&u===Uint16Array||e==="uint4"||e==="int4")throw new TypeError(`Creating a ${e} tensor from number array is not supported. Please use ${u.name} as data.`);e==="uint64"||e==="int64"?s=u.from(t,BigInt):s=u.from(t)}else if(t instanceof u)s=t;else if(t instanceof Uint8ClampedArray)if(e==="uint8")s=Uint8Array.from(t);else throw new TypeError("A Uint8ClampedArray tensor's data must be type of uint8");else if(e==="float16"&&t instanceof Uint16Array&&u!==Uint16Array)s=new globalThis.Float16Array(t.buffer,t.byteOffset,t.length);else throw new TypeError(`A ${n} tensor's data must be type of ${u}`)}else if(a=t,Array.isArray(e)){if(e.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");let u=typeof e[0];if(u==="string")n="string",s=e;else if(u==="boolean")n="bool",s=Uint8Array.from(e);else throw new TypeError(`Invalid element type of data array: ${u}.`)}else if(e instanceof Uint8ClampedArray)n="uint8",s=Uint8Array.from(e);else{let u=Hw.get(e.constructor);if(u===void 0)throw new TypeError(`Unsupported type for tensor data: ${e.constructor}.`);n=u,s=e}if(a===void 0)a=[s.length];else if(!Array.isArray(a))throw new TypeError("A tensor's dims must be a number array");i=a,this.cpuData=s,this.dataLocation="cpu"}let o=kre(i);if(this.cpuData&&o!==this.cpuData.length&&!((n==="uint4"||n==="int4")&&Math.ceil(o/2)===this.cpuData.length))throw new Error(`Tensor's size(${o}) does not match data length(${this.cpuData.length}).`);this.type=n,this.dims=i,this.size=o}static async fromImage(e,t){return Sre(e,t)}static fromTexture(e,t){return Tre(e,t)}static fromGpuBuffer(e,t){return Pre(e,t)}static fromMLTensor(e,t){return Ere(e,t)}static fromPinnedBuffer(e,t,r){return Are(e,t,r)}toDataURL(e){return wre(this,e)}toImageData(e){return Mre(this,e)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}get mlTensor(){if(this.ensureValid(),!this.mlTensorData)throw new Error("The data is not stored as a WebNN MLTensor.");return this.mlTensorData}async getData(e){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":case"ml-tensor":{if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;let t=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=t,e&&this.disposer&&(this.disposer(),this.disposer=void 0),t}finally{this.isDownloading=!1}}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.mlTensorData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if(this.dataLocation==="none")throw new Error("The tensor is disposed.")}reshape(e){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return Ire(this,e)}}}),Lf,Ore=nn(()=>{hR(),Lf=Wd}),lM,n3,Wf,$h,Lre=nn(()=>{xre(),lM=(e,t)=>{(typeof Mh.trace>"u"?!Mh.wasm.trace:!Mh.trace)||console.timeStamp(`${e}::ORT::${t}`)},n3=(e,t)=>{var i;let r=((i=new Error().stack)==null?void 0:i.split(/\r\n|\r|\n/g))||[],n=!1;for(let o=0;o<r.length;o++){if(n&&!r[o].includes("TRACE_FUNC")){let s=`FUNC_${e}::${r[o].trim().split(" ")[1]}`;t&&(s+=`::${t}`),lM("CPU",s);return}r[o].includes("TRACE_FUNC")&&(n=!0)}},Wf=e=>{(typeof Mh.trace>"u"?!Mh.wasm.trace:!Mh.trace)||n3("BEGIN",e)},$h=e=>{(typeof Mh.trace>"u"?!Mh.wasm.trace:!Mh.trace)||n3("END",e)}}),Dre,iPe=nn(()=>{vre(),Ore(),Lre(),Dre=class $re{constructor(t){this.handler=t}async run(t,r,n){Wf();let i={},o={};if(typeof t!="object"||t===null||t instanceof Lf||Array.isArray(t))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let s=!0;if(typeof r=="object"){if(r===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(r instanceof Lf)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(r)){if(r.length===0)throw new TypeError("'fetches' cannot be an empty array.");s=!1;for(let d of r){if(typeof d!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(d)===-1)throw new RangeError(`'fetches' contains invalid output name: ${d}.`);i[d]=null}if(typeof n=="object"&&n!==null)o=n;else if(typeof n<"u")throw new TypeError("'options' must be an object.")}else{let d=!1,m=Object.getOwnPropertyNames(r);for(let g of this.outputNames)if(m.indexOf(g)!==-1){let _=r[g];(_===null||_ instanceof Lf)&&(d=!0,s=!1,i[g]=_)}if(d){if(typeof n=="object"&&n!==null)o=n;else if(typeof n<"u")throw new TypeError("'options' must be an object.")}else o=r}}else if(typeof r<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let d of this.inputNames)if(typeof t[d]>"u")throw new Error(`input '${d}' is missing in 'feeds'.`);if(s)for(let d of this.outputNames)i[d]=null;let a=await this.handler.run(t,i,o),u={};for(let d in a)if(Object.hasOwnProperty.call(a,d)){let m=a[d];m instanceof Lf?u[d]=m:u[d]=new Lf(m.type,m.data,m.dims)}return $h(),u}async release(){return this.handler.dispose()}static async create(t,r,n,i){Wf();let o,s={};if(typeof t=="string"){if(o=t,typeof r=="object"&&r!==null)s=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else if(t instanceof Uint8Array){if(o=t,typeof r=="object"&&r!==null)s=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else if(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer){let m=t,g=0,_=t.byteLength;if(typeof r=="object"&&r!==null)s=r;else if(typeof r=="number"){if(g=r,!Number.isSafeInteger(g))throw new RangeError("'byteOffset' must be an integer.");if(g<0||g>=m.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${m.byteLength}).`);if(_=t.byteLength-g,typeof n=="number"){if(_=n,!Number.isSafeInteger(_))throw new RangeError("'byteLength' must be an integer.");if(_<=0||g+_>m.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${m.byteLength-g}].`);if(typeof i=="object"&&i!==null)s=i;else if(typeof i<"u")throw new TypeError("'options' must be an object.")}else if(typeof n<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof r<"u")throw new TypeError("'options' must be an object.");o=new Uint8Array(m,g,_)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");let[a,u]=await yre(s),d=await a.createInferenceSessionHandler(o,u);return $h(),new $re(d)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}get inputMetadata(){return this.handler.inputMetadata}get outputMetadata(){return this.handler.outputMetadata}}}),fR,oPe=nn(()=>{iPe(),fR=Dre}),aPe=nn(()=>{}),sPe=nn(()=>{}),lPe=nn(()=>{}),cPe=nn(()=>{}),Nre={};Bb(Nre,{InferenceSession:()=>fR,TRACE:()=>lM,TRACE_FUNC_BEGIN:()=>Wf,TRACE_FUNC_END:()=>$h,Tensor:()=>Lf,env:()=>Ua,registerBackend:()=>Oy});var Kf=nn(()=>{YTe(),JTe(),oPe(),Ore(),aPe(),sPe(),Lre(),lPe(),cPe()}),pR=nn(()=>{}),jre={};Bb(jre,{default:()=>Rre});var i3,o3,Rre,uPe=nn(()=>{var e;Voe(),L0(),mR(),i3="ort-wasm-proxy-worker",o3=((e=globalThis.self)==null?void 0:e.name)===i3,o3&&(self.onmessage=t=>{let{type:r,in:n}=t.data;try{switch(r){case"init-wasm":gR(n.wasm).then(()=>{DR(n).then(()=>{postMessage({type:r})},i=>{postMessage({type:r,err:i})})},i=>{postMessage({type:r,err:i})});break;case"init-ep":{let{epName:i,env:o}=n;$R(o,i).then(()=>{postMessage({type:r})},s=>{postMessage({type:r,err:s})});break}case"copy-from":{let{buffer:i}=n,o=jA(i);postMessage({type:r,out:o});break}case"create":{let{model:i,options:o}=n;NR(i,o).then(s=>{postMessage({type:r,out:s})},s=>{postMessage({type:r,err:s})});break}case"release":jR(n),postMessage({type:r});break;case"run":{let{sessionId:i,inputIndices:o,inputs:s,outputIndices:a,options:u}=n;RR(i,o,s,a,new Array(a.length).fill(null),u).then(d=>{d.some(m=>m[3]!=="cpu")?postMessage({type:r,err:"Proxy does not support non-cpu tensor location."}):postMessage({type:r,out:d},zR([...s,...d]))},d=>{postMessage({type:r,err:d})});break}case"end-profiling":FR(n),postMessage({type:r});break;default:}}catch(i){postMessage({type:r,err:i})}}),Rre=o3?null:t=>new Worker(t??jd,{type:"module",name:i3})}),Fre={};Bb(Fre,{default:()=>zre});var a3,s3,zre,H8,dPe=nn(()=>{var e,t;s3=(a3=import.meta.url,async function(r={}){var cu;var n,i,o=r,s=new Promise((Y,he)=>{n=Y,i=he}),a=typeof window=="object",u=typeof WorkerGlobalScope<"u",d=u&&((cu=self.name)==null?void 0:cu.startsWith("em-pthread"));o.mountExternalData=(Y,he)=>{Y.startsWith("./")&&(Y=Y.substring(2)),(o.Eb||(o.Eb=new Map)).set(Y,he)},o.unmountExternalData=()=>{delete o.Eb};var m=globalThis.SharedArrayBuffer??new WebAssembly.Memory({initial:0,maximum:0,pc:!0}).buffer.constructor;let g=Y=>async(...he)=>{var Oe;try{if(o.Fb)throw Error("Session already started");let Ke=o.Fb={dc:he[0],errors:[]},at=await Y(...he);if(o.Fb!==Ke)throw Error("Session mismatch");(Oe=o.Jb)==null||Oe.flush();let Ht=Ke.errors;if(0<Ht.length){let gr=await Promise.all(Ht);if(gr=gr.filter(Wr=>Wr),0<gr.length)throw Error(gr.join(`
`))}return at}finally{o.Fb=null}};o.jsepInit=(Y,he)=>{if(Y==="webgpu"){[o.Jb,o.Ub,o.Yb,o.Kb,o.Xb,o.jb,o.Zb,o.ac,o.Vb,o.Wb,o.$b]=he;let Oe=o.Jb;o.jsepRegisterBuffer=(Ke,at,Ht,gr)=>Oe.registerBuffer(Ke,at,Ht,gr),o.jsepGetBuffer=Ke=>Oe.getBuffer(Ke),o.jsepCreateDownloader=(Ke,at,Ht)=>Oe.createDownloader(Ke,at,Ht),o.jsepOnCreateSession=Ke=>{Oe.onCreateSession(Ke)},o.jsepOnReleaseSession=Ke=>{Oe.onReleaseSession(Ke)},o.jsepOnRunStart=Ke=>Oe.onRunStart(Ke),o.bc=(Ke,at)=>{Oe.upload(Ke,at)}}else if(Y==="webnn"){let Oe=he[0];[o.nc,o.Nb,o.webnnEnsureTensor,o.Ob,o.webnnDownloadTensor]=he.slice(1),o.webnnReleaseTensorId=o.Nb,o.webnnUploadTensor=o.Ob,o.webnnOnRunStart=Ke=>Oe.onRunStart(Ke),o.webnnOnRunEnd=Oe.onRunEnd.bind(Oe),o.webnnRegisterMLContext=(Ke,at)=>{Oe.registerMLContext(Ke,at)},o.webnnOnReleaseSession=Ke=>{Oe.onReleaseSession(Ke)},o.webnnCreateMLTensorDownloader=(Ke,at)=>Oe.createMLTensorDownloader(Ke,at),o.webnnRegisterMLTensor=(Ke,at,Ht,gr)=>Oe.registerMLTensor(Ke,at,Ht,gr),o.webnnCreateMLContext=Ke=>Oe.createMLContext(Ke),o.webnnRegisterMLConstant=(Ke,at,Ht,gr,Wr,cn)=>Oe.registerMLConstant(Ke,at,Ht,gr,Wr,o.Eb,cn),o.webnnRegisterGraphInput=Oe.registerGraphInput.bind(Oe),o.webnnIsGraphInput=Oe.isGraphInput.bind(Oe),o.webnnCreateTemporaryTensor=Oe.createTemporaryTensor.bind(Oe),o.webnnIsInt64Supported=Oe.isInt64Supported.bind(Oe)}};let _=()=>{let Y=(he,Oe,Ke)=>(...at)=>{let Ht=ma,gr=Oe==null?void 0:Oe();at=he(...at);let Wr=Oe==null?void 0:Oe();return gr!==Wr&&(he=Wr,Ke(gr),Oe=Ke=null),ma!=Ht?new Promise((cn,wn)=>{bn={resolve:cn,reject:wn}}):at};(()=>{for(let he of["_OrtAppendExecutionProvider","_OrtCreateSession","_OrtRun","_OrtRunWithBinding","_OrtBindInput"])o[he]=Y(o[he],()=>o[he],Oe=>o[he]=Oe)})(),g!==void 0&&(o._OrtRun=g(o._OrtRun),o._OrtRunWithBinding=g(o._OrtRunWithBinding)),_=void 0};o.asyncInit=()=>{_==null||_()};var y,M,x=Object.assign({},o),E=(Y,he)=>{throw he},T="";(a||u)&&(u?T=self.location.href:typeof document<"u"&&document.currentScript&&(T=document.currentScript.src),a3&&(T=a3),T=T.startsWith("blob:")?"":T.slice(0,T.replace(/[?#].*/,"").lastIndexOf("/")+1),u&&(M=Y=>{var he=new XMLHttpRequest;return he.open("GET",Y,!1),he.responseType="arraybuffer",he.send(null),new Uint8Array(he.response)}),y=async Y=>{if(pe(Y))return new Promise((Oe,Ke)=>{var at=new XMLHttpRequest;at.open("GET",Y,!0),at.responseType="arraybuffer",at.onload=()=>{at.status==200||at.status==0&&at.response?Oe(at.response):Ke(at.status)},at.onerror=Ke,at.send(null)});var he=await fetch(Y,{credentials:"same-origin"});if(he.ok)return he.arrayBuffer();throw Error(he.status+" : "+he.url)});var P=console.log.bind(console),C=console.error.bind(console),D=P,L=C;Object.assign(o,x),x=null;var N,j,$,U,G,H,X,ee,ae,de,ye,_e,ue,fe=o.wasmBinary,De=!1,pe=Y=>Y.startsWith("file://");function K(){return N.buffer!=U.buffer&&Le(),U}function te(){return N.buffer!=U.buffer&&Le(),G}function ve(){return N.buffer!=U.buffer&&Le(),H}function $e(){return N.buffer!=U.buffer&&Le(),X}function Ce(){return N.buffer!=U.buffer&&Le(),ee}function Ge(){return N.buffer!=U.buffer&&Le(),ae}function ot(){return N.buffer!=U.buffer&&Le(),de}function Ye(){return N.buffer!=U.buffer&&Le(),ue}if(d){let Y=function(he){try{var Oe=he.data,Ke=Oe.Bb;if(Ke==="load"){let at=[];self.onmessage=Ht=>at.push(Ht),self.startWorker=()=>{postMessage({Bb:"loaded"});for(let Ht of at)Y(Ht);self.onmessage=Y};for(let Ht of Oe.Rb)o[Ht]&&!o[Ht].proxy||(o[Ht]=(...gr)=>{postMessage({Bb:"callHandler",Qb:Ht,args:gr})},Ht=="print"&&(D=o[Ht]),Ht=="printErr"&&(L=o[Ht]));N=Oe.kc,Le(),et(Oe.lc)}else if(Ke==="run"){fr(Oe.Ab),bl(Oe.Ab,0,0,1,0,0),At(),Dt(Oe.Ab),Te||(Gc(),Te=!0);try{Jr(Oe.fc,Oe.Hb)}catch(at){if(at!="unwind")throw at}}else Oe.target!=="setimmediate"&&(Ke==="checkMailbox"?Te&&yr():Ke&&(L(`worker: received unknown command ${Ke}`),L(Oe)))}catch(at){throw qa(),at}};var et,Te=!1;L=function(...he){he=he.join(" "),console.error(he)},self.alert=function(...he){postMessage({Bb:"alert",text:he.join(" "),ic:rc()})},self.onunhandledrejection=he=>{throw he.reason||he},self.onmessage=Y}function Le(){var Y=N.buffer;o.HEAP8=U=new Int8Array(Y),o.HEAP16=H=new Int16Array(Y),o.HEAPU8=G=new Uint8Array(Y),o.HEAPU16=X=new Uint16Array(Y),o.HEAP32=ee=new Int32Array(Y),o.HEAPU32=ae=new Uint32Array(Y),o.HEAPF32=de=new Float32Array(Y),o.HEAPF64=ue=new Float64Array(Y),o.HEAP64=ye=new BigInt64Array(Y),o.HEAPU64=_e=new BigUint64Array(Y)}function ke(){d?startWorker(o):$n.Ca()}d||(N=new WebAssembly.Memory({initial:256,maximum:65536,shared:!0}),Le());var Xe,Ne=0,Ot=null;function Lt(){if(--Ne==0&&Ot){var Y=Ot;Ot=null,Y()}}function kt(Y){throw L(Y="Aborted("+Y+")"),De=!0,Y=new WebAssembly.RuntimeError(Y+". Build with -sASSERTIONS for more info."),i(Y),Y}function mt(){return{a:{L:dr,Aa:Kt,b:zr,$:Ir,A:ge,pa:ut,X:xt,Z:wt,qa:pr,na:Rr,ga:On,ma:Mn,J:_r,Y:Or,V:an,oa:Vn,W:_o,va:Vo,E:Xs,Q:Qn,O:os,D:Hr,u:gn,r:Zi,P:dl,z:Ie,R:rt,ja:Tt,T:Vr,aa:Qr,M:Dr,F:Ln,ia:Dt,sa:Ii,t:rn,Ba:Xi,w:ni,o:Qi,l:ga,c:$s,n:hl,j:Ms,v:vo,p:Ss,f:re,s:ze,m:pt,e:Ut,k:Qt,i:Er,g:jr,d:Sn,da:vn,ea:Ao,fa:Ko,ba:pi,ca,N:pl,xa:yc,ua:su,h:vc,C:bc,G:La,ta:Wh,x:Da,ra:gl,U:Ys,q:Oa,y:Ql,K:Yu,S:$a,za:ua,ya:_l,ka:wc,la:ss,_:Pe,B:Ts,I:js,ha:Rs,H:tc,a:N,wa:tt}}}var Zt={829644:(Y,he,Oe,Ke,at)=>{if(o===void 0||!o.Eb)return 1;if((Y=An(Number(Y>>>0))).startsWith("./")&&(Y=Y.substring(2)),!(Y=o.Eb.get(Y)))return 2;if(he=Number(he>>>0),Oe=Number(Oe>>>0),Ke=Number(Ke>>>0),he+Oe>Y.byteLength)return 3;try{let Ht=Y.subarray(he,he+Oe);switch(at){case 0:te().set(Ht,Ke>>>0);break;case 1:o.mc?o.mc(Ke,Ht):o.bc(Ke,Ht);break;default:return 4}return 0}catch{return 4}},830468:(Y,he,Oe)=>{o.Ob(Y,te().subarray(he>>>0,he+Oe>>>0))},830532:()=>o.nc(),830574:Y=>{o.Nb(Y)},830611:()=>{o.Vb()},830642:()=>{o.Wb()},830671:()=>{o.$b()},830696:Y=>o.Ub(Y),830729:Y=>o.Yb(Y),830761:(Y,he,Oe)=>{o.Kb(Number(Y),Number(he),Number(Oe),!0)},830824:(Y,he,Oe)=>{o.Kb(Number(Y),Number(he),Number(Oe))},830881:()=>typeof wasmOffsetConverter<"u",830938:Y=>{o.jb("Abs",Y,void 0)},830989:Y=>{o.jb("Neg",Y,void 0)},831040:Y=>{o.jb("Floor",Y,void 0)},831093:Y=>{o.jb("Ceil",Y,void 0)},831145:Y=>{o.jb("Reciprocal",Y,void 0)},831203:Y=>{o.jb("Sqrt",Y,void 0)},831255:Y=>{o.jb("Exp",Y,void 0)},831306:Y=>{o.jb("Erf",Y,void 0)},831357:Y=>{o.jb("Sigmoid",Y,void 0)},831412:(Y,he,Oe)=>{o.jb("HardSigmoid",Y,{alpha:he,beta:Oe})},831491:Y=>{o.jb("Log",Y,void 0)},831542:Y=>{o.jb("Sin",Y,void 0)},831593:Y=>{o.jb("Cos",Y,void 0)},831644:Y=>{o.jb("Tan",Y,void 0)},831695:Y=>{o.jb("Asin",Y,void 0)},831747:Y=>{o.jb("Acos",Y,void 0)},831799:Y=>{o.jb("Atan",Y,void 0)},831851:Y=>{o.jb("Sinh",Y,void 0)},831903:Y=>{o.jb("Cosh",Y,void 0)},831955:Y=>{o.jb("Asinh",Y,void 0)},832008:Y=>{o.jb("Acosh",Y,void 0)},832061:Y=>{o.jb("Atanh",Y,void 0)},832114:Y=>{o.jb("Tanh",Y,void 0)},832166:Y=>{o.jb("Not",Y,void 0)},832217:(Y,he,Oe)=>{o.jb("Clip",Y,{min:he,max:Oe})},832286:Y=>{o.jb("Clip",Y,void 0)},832338:(Y,he)=>{o.jb("Elu",Y,{alpha:he})},832396:Y=>{o.jb("Gelu",Y,void 0)},832448:Y=>{o.jb("Relu",Y,void 0)},832500:(Y,he)=>{o.jb("LeakyRelu",Y,{alpha:he})},832564:(Y,he)=>{o.jb("ThresholdedRelu",Y,{alpha:he})},832634:(Y,he)=>{o.jb("Cast",Y,{to:he})},832692:Y=>{o.jb("Add",Y,void 0)},832743:Y=>{o.jb("Sub",Y,void 0)},832794:Y=>{o.jb("Mul",Y,void 0)},832845:Y=>{o.jb("Div",Y,void 0)},832896:Y=>{o.jb("Pow",Y,void 0)},832947:Y=>{o.jb("Equal",Y,void 0)},833e3:Y=>{o.jb("Greater",Y,void 0)},833055:Y=>{o.jb("GreaterOrEqual",Y,void 0)},833117:Y=>{o.jb("Less",Y,void 0)},833169:Y=>{o.jb("LessOrEqual",Y,void 0)},833228:(Y,he,Oe,Ke,at)=>{o.jb("ReduceMean",Y,{keepDims:!!he,noopWithEmptyAxes:!!Oe,axes:Ke?Array.from(Ce().subarray(Number(Ke)>>>0,Number(at)>>>0)):[]})},833403:(Y,he,Oe,Ke,at)=>{o.jb("ReduceMax",Y,{keepDims:!!he,noopWithEmptyAxes:!!Oe,axes:Ke?Array.from(Ce().subarray(Number(Ke)>>>0,Number(at)>>>0)):[]})},833577:(Y,he,Oe,Ke,at)=>{o.jb("ReduceMin",Y,{keepDims:!!he,noopWithEmptyAxes:!!Oe,axes:Ke?Array.from(Ce().subarray(Number(Ke)>>>0,Number(at)>>>0)):[]})},833751:(Y,he,Oe,Ke,at)=>{o.jb("ReduceProd",Y,{keepDims:!!he,noopWithEmptyAxes:!!Oe,axes:Ke?Array.from(Ce().subarray(Number(Ke)>>>0,Number(at)>>>0)):[]})},833926:(Y,he,Oe,Ke,at)=>{o.jb("ReduceSum",Y,{keepDims:!!he,noopWithEmptyAxes:!!Oe,axes:Ke?Array.from(Ce().subarray(Number(Ke)>>>0,Number(at)>>>0)):[]})},834100:(Y,he,Oe,Ke,at)=>{o.jb("ReduceL1",Y,{keepDims:!!he,noopWithEmptyAxes:!!Oe,axes:Ke?Array.from(Ce().subarray(Number(Ke)>>>0,Number(at)>>>0)):[]})},834273:(Y,he,Oe,Ke,at)=>{o.jb("ReduceL2",Y,{keepDims:!!he,noopWithEmptyAxes:!!Oe,axes:Ke?Array.from(Ce().subarray(Number(Ke)>>>0,Number(at)>>>0)):[]})},834446:(Y,he,Oe,Ke,at)=>{o.jb("ReduceLogSum",Y,{keepDims:!!he,noopWithEmptyAxes:!!Oe,axes:Ke?Array.from(Ce().subarray(Number(Ke)>>>0,Number(at)>>>0)):[]})},834623:(Y,he,Oe,Ke,at)=>{o.jb("ReduceSumSquare",Y,{keepDims:!!he,noopWithEmptyAxes:!!Oe,axes:Ke?Array.from(Ce().subarray(Number(Ke)>>>0,Number(at)>>>0)):[]})},834803:(Y,he,Oe,Ke,at)=>{o.jb("ReduceLogSumExp",Y,{keepDims:!!he,noopWithEmptyAxes:!!Oe,axes:Ke?Array.from(Ce().subarray(Number(Ke)>>>0,Number(at)>>>0)):[]})},834983:Y=>{o.jb("Where",Y,void 0)},835036:(Y,he,Oe)=>{o.jb("Transpose",Y,{perm:he?Array.from(Ce().subarray(Number(he)>>>0,Number(Oe)>>>0)):[]})},835160:(Y,he,Oe,Ke)=>{o.jb("DepthToSpace",Y,{blocksize:he,mode:An(Oe),format:Ke?"NHWC":"NCHW"})},835293:(Y,he,Oe,Ke)=>{o.jb("DepthToSpace",Y,{blocksize:he,mode:An(Oe),format:Ke?"NHWC":"NCHW"})},835426:(Y,he,Oe,Ke,at,Ht,gr,Wr,cn,wn,Yn,Ci,ro,da,Nl)=>{o.jb("ConvTranspose",Y,{format:cn?"NHWC":"NCHW",autoPad:he,dilations:[Oe],group:Ke,kernelShape:[at],pads:[Ht,gr],strides:[Wr],wIsConst:()=>!!K()[wn>>>0],outputPadding:Yn?Array.from(Ce().subarray(Number(Yn)>>>0,Number(Ci)>>>0)):[],outputShape:ro?Array.from(Ce().subarray(Number(ro)>>>0,Number(da)>>>0)):[],activation:An(Nl)})},835859:(Y,he,Oe,Ke,at,Ht,gr,Wr,cn,wn,Yn,Ci,ro,da)=>{o.jb("ConvTranspose",Y,{format:Wr?"NHWC":"NCHW",autoPad:he,dilations:Array.from(Ce().subarray(Number(Oe)>>>0,2+(Number(Oe)>>>0)>>>0)),group:Ke,kernelShape:Array.from(Ce().subarray(Number(at)>>>0,2+(Number(at)>>>0)>>>0)),pads:Array.from(Ce().subarray(Number(Ht)>>>0,4+(Number(Ht)>>>0)>>>0)),strides:Array.from(Ce().subarray(Number(gr)>>>0,2+(Number(gr)>>>0)>>>0)),wIsConst:()=>!!K()[cn>>>0],outputPadding:wn?Array.from(Ce().subarray(Number(wn)>>>0,Number(Yn)>>>0)):[],outputShape:Ci?Array.from(Ce().subarray(Number(Ci)>>>0,Number(ro)>>>0)):[],activation:An(da)})},836520:(Y,he,Oe,Ke,at,Ht,gr,Wr,cn,wn,Yn,Ci,ro,da,Nl)=>{o.jb("ConvTranspose",Y,{format:cn?"NHWC":"NCHW",autoPad:he,dilations:[Oe],group:Ke,kernelShape:[at],pads:[Ht,gr],strides:[Wr],wIsConst:()=>!!K()[wn>>>0],outputPadding:Yn?Array.from(Ce().subarray(Number(Yn)>>>0,Number(Ci)>>>0)):[],outputShape:ro?Array.from(Ce().subarray(Number(ro)>>>0,Number(da)>>>0)):[],activation:An(Nl)})},836953:(Y,he,Oe,Ke,at,Ht,gr,Wr,cn,wn,Yn,Ci,ro,da)=>{o.jb("ConvTranspose",Y,{format:Wr?"NHWC":"NCHW",autoPad:he,dilations:Array.from(Ce().subarray(Number(Oe)>>>0,2+(Number(Oe)>>>0)>>>0)),group:Ke,kernelShape:Array.from(Ce().subarray(Number(at)>>>0,2+(Number(at)>>>0)>>>0)),pads:Array.from(Ce().subarray(Number(Ht)>>>0,4+(Number(Ht)>>>0)>>>0)),strides:Array.from(Ce().subarray(Number(gr)>>>0,2+(Number(gr)>>>0)>>>0)),wIsConst:()=>!!K()[cn>>>0],outputPadding:wn?Array.from(Ce().subarray(Number(wn)>>>0,Number(Yn)>>>0)):[],outputShape:Ci?Array.from(Ce().subarray(Number(Ci)>>>0,Number(ro)>>>0)):[],activation:An(da)})},837614:(Y,he)=>{o.jb("GlobalAveragePool",Y,{format:he?"NHWC":"NCHW"})},837705:(Y,he,Oe,Ke,at,Ht,gr,Wr,cn,wn,Yn,Ci,ro,da)=>{o.jb("AveragePool",Y,{format:da?"NHWC":"NCHW",auto_pad:he,ceil_mode:Oe,count_include_pad:Ke,storage_order:at,dilations:Ht?Array.from(Ce().subarray(Number(Ht)>>>0,Number(gr)>>>0)):[],kernel_shape:Wr?Array.from(Ce().subarray(Number(Wr)>>>0,Number(cn)>>>0)):[],pads:wn?Array.from(Ce().subarray(Number(wn)>>>0,Number(Yn)>>>0)):[],strides:Ci?Array.from(Ce().subarray(Number(Ci)>>>0,Number(ro)>>>0)):[]})},838184:(Y,he)=>{o.jb("GlobalAveragePool",Y,{format:he?"NHWC":"NCHW"})},838275:(Y,he,Oe,Ke,at,Ht,gr,Wr,cn,wn,Yn,Ci,ro,da)=>{o.jb("AveragePool",Y,{format:da?"NHWC":"NCHW",auto_pad:he,ceil_mode:Oe,count_include_pad:Ke,storage_order:at,dilations:Ht?Array.from(Ce().subarray(Number(Ht)>>>0,Number(gr)>>>0)):[],kernel_shape:Wr?Array.from(Ce().subarray(Number(Wr)>>>0,Number(cn)>>>0)):[],pads:wn?Array.from(Ce().subarray(Number(wn)>>>0,Number(Yn)>>>0)):[],strides:Ci?Array.from(Ce().subarray(Number(Ci)>>>0,Number(ro)>>>0)):[]})},838754:(Y,he)=>{o.jb("GlobalMaxPool",Y,{format:he?"NHWC":"NCHW"})},838841:(Y,he,Oe,Ke,at,Ht,gr,Wr,cn,wn,Yn,Ci,ro,da)=>{o.jb("MaxPool",Y,{format:da?"NHWC":"NCHW",auto_pad:he,ceil_mode:Oe,count_include_pad:Ke,storage_order:at,dilations:Ht?Array.from(Ce().subarray(Number(Ht)>>>0,Number(gr)>>>0)):[],kernel_shape:Wr?Array.from(Ce().subarray(Number(Wr)>>>0,Number(cn)>>>0)):[],pads:wn?Array.from(Ce().subarray(Number(wn)>>>0,Number(Yn)>>>0)):[],strides:Ci?Array.from(Ce().subarray(Number(Ci)>>>0,Number(ro)>>>0)):[]})},839316:(Y,he)=>{o.jb("GlobalMaxPool",Y,{format:he?"NHWC":"NCHW"})},839403:(Y,he,Oe,Ke,at,Ht,gr,Wr,cn,wn,Yn,Ci,ro,da)=>{o.jb("MaxPool",Y,{format:da?"NHWC":"NCHW",auto_pad:he,ceil_mode:Oe,count_include_pad:Ke,storage_order:at,dilations:Ht?Array.from(Ce().subarray(Number(Ht)>>>0,Number(gr)>>>0)):[],kernel_shape:Wr?Array.from(Ce().subarray(Number(Wr)>>>0,Number(cn)>>>0)):[],pads:wn?Array.from(Ce().subarray(Number(wn)>>>0,Number(Yn)>>>0)):[],strides:Ci?Array.from(Ce().subarray(Number(Ci)>>>0,Number(ro)>>>0)):[]})},839878:(Y,he,Oe,Ke,at)=>{o.jb("Gemm",Y,{alpha:he,beta:Oe,transA:Ke,transB:at})},839982:Y=>{o.jb("MatMul",Y,void 0)},840036:(Y,he,Oe,Ke)=>{o.jb("ArgMax",Y,{keepDims:!!he,selectLastIndex:!!Oe,axis:Ke})},840144:(Y,he,Oe,Ke)=>{o.jb("ArgMin",Y,{keepDims:!!he,selectLastIndex:!!Oe,axis:Ke})},840252:(Y,he)=>{o.jb("Softmax",Y,{axis:he})},840315:(Y,he)=>{o.jb("Concat",Y,{axis:he})},840375:(Y,he,Oe,Ke,at)=>{o.jb("Split",Y,{axis:he,numOutputs:Oe,splitSizes:Ke?Array.from(Ce().subarray(Number(Ke)>>>0,Number(at)>>>0)):[]})},840531:Y=>{o.jb("Expand",Y,void 0)},840585:(Y,he)=>{o.jb("Gather",Y,{axis:Number(he)})},840656:(Y,he)=>{o.jb("GatherElements",Y,{axis:Number(he)})},840735:(Y,he)=>{o.jb("GatherND",Y,{batch_dims:Number(he)})},840814:(Y,he,Oe,Ke,at,Ht,gr,Wr,cn,wn,Yn)=>{o.jb("Resize",Y,{antialias:he,axes:Oe?Array.from(Ce().subarray(Number(Oe)>>>0,Number(Ke)>>>0)):[],coordinateTransformMode:An(at),cubicCoeffA:Ht,excludeOutside:gr,extrapolationValue:Wr,keepAspectRatioPolicy:An(cn),mode:An(wn),nearestMode:An(Yn)})},841176:(Y,he,Oe,Ke,at,Ht,gr)=>{o.jb("Slice",Y,{starts:he?Array.from(Ce().subarray(Number(he)>>>0,Number(Oe)>>>0)):[],ends:Ke?Array.from(Ce().subarray(Number(Ke)>>>0,Number(at)>>>0)):[],axes:Ht?Array.from(Ce().subarray(Number(Ht)>>>0,Number(gr)>>>0)):[]})},841440:Y=>{o.jb("Tile",Y,void 0)},841492:(Y,he,Oe)=>{o.jb("InstanceNormalization",Y,{epsilon:he,format:Oe?"NHWC":"NCHW"})},841606:(Y,he,Oe)=>{o.jb("InstanceNormalization",Y,{epsilon:he,format:Oe?"NHWC":"NCHW"})},841720:Y=>{o.jb("Range",Y,void 0)},841773:(Y,he)=>{o.jb("Einsum",Y,{equation:An(he)})},841854:(Y,he,Oe,Ke,at)=>{o.jb("Pad",Y,{mode:he,value:Oe,pads:Ke?Array.from(Ce().subarray(Number(Ke)>>>0,Number(at)>>>0)):[]})},841997:(Y,he,Oe,Ke,at,Ht)=>{o.jb("BatchNormalization",Y,{epsilon:he,momentum:Oe,spatial:!!at,trainingMode:!!Ke,format:Ht?"NHWC":"NCHW"})},842166:(Y,he,Oe,Ke,at,Ht)=>{o.jb("BatchNormalization",Y,{epsilon:he,momentum:Oe,spatial:!!at,trainingMode:!!Ke,format:Ht?"NHWC":"NCHW"})},842335:(Y,he,Oe)=>{o.jb("CumSum",Y,{exclusive:Number(he),reverse:Number(Oe)})},842432:(Y,he,Oe)=>{o.jb("DequantizeLinear",Y,{axis:he,blockSize:Oe})},842522:(Y,he,Oe,Ke,at)=>{o.jb("GridSample",Y,{align_corners:he,mode:An(Oe),padding_mode:An(Ke),format:at?"NHWC":"NCHW"})},842692:(Y,he,Oe,Ke,at)=>{o.jb("GridSample",Y,{align_corners:he,mode:An(Oe),padding_mode:An(Ke),format:at?"NHWC":"NCHW"})},842862:(Y,he)=>{o.jb("ScatterND",Y,{reduction:An(he)})},842947:(Y,he,Oe,Ke,at,Ht,gr,Wr,cn)=>{o.jb("Attention",Y,{numHeads:he,isUnidirectional:Oe,maskFilterValue:Ke,scale:at,doRotary:Ht,qkvHiddenSizes:gr?Array.from(Ce().subarray(Number(Wr)>>>0,Number(Wr)+gr>>>0)):[],pastPresentShareBuffer:!!cn})},843219:Y=>{o.jb("BiasAdd",Y,void 0)},843274:Y=>{o.jb("BiasSplitGelu",Y,void 0)},843335:Y=>{o.jb("FastGelu",Y,void 0)},843391:(Y,he,Oe,Ke,at,Ht,gr,Wr,cn,wn,Yn,Ci,ro,da,Nl,ah)=>{o.jb("Conv",Y,{format:Ci?"NHWC":"NCHW",auto_pad:he,dilations:Oe?Array.from(Ce().subarray(Number(Oe)>>>0,Number(Ke)>>>0)):[],group:at,kernel_shape:Ht?Array.from(Ce().subarray(Number(Ht)>>>0,Number(gr)>>>0)):[],pads:Wr?Array.from(Ce().subarray(Number(Wr)>>>0,Number(cn)>>>0)):[],strides:wn?Array.from(Ce().subarray(Number(wn)>>>0,Number(Yn)>>>0)):[],w_is_const:()=>!!K()[Number(ro)>>>0],activation:An(da),activation_params:Nl?Array.from(ot().subarray(Number(Nl)>>>0,Number(ah)>>>0)):[]})},843975:Y=>{o.jb("Gelu",Y,void 0)},844027:(Y,he,Oe,Ke,at,Ht,gr,Wr,cn)=>{o.jb("GroupQueryAttention",Y,{numHeads:he,kvNumHeads:Oe,scale:Ke,softcap:at,doRotary:Ht,rotaryInterleaved:gr,smoothSoftmax:Wr,localWindowSize:cn})},844244:(Y,he,Oe,Ke)=>{o.jb("LayerNormalization",Y,{axis:he,epsilon:Oe,simplified:!!Ke})},844355:(Y,he,Oe,Ke)=>{o.jb("LayerNormalization",Y,{axis:he,epsilon:Oe,simplified:!!Ke})},844466:(Y,he,Oe,Ke,at,Ht)=>{o.jb("MatMulNBits",Y,{k:he,n:Oe,accuracyLevel:Ke,bits:at,blockSize:Ht})},844593:(Y,he,Oe,Ke,at,Ht)=>{o.jb("MultiHeadAttention",Y,{numHeads:he,isUnidirectional:Oe,maskFilterValue:Ke,scale:at,doRotary:Ht})},844752:(Y,he)=>{o.jb("QuickGelu",Y,{alpha:he})},844816:(Y,he,Oe,Ke,at)=>{o.jb("RotaryEmbedding",Y,{interleaved:!!he,numHeads:Oe,rotaryEmbeddingDim:Ke,scale:at})},844955:(Y,he,Oe)=>{o.jb("SkipLayerNormalization",Y,{epsilon:he,simplified:!!Oe})},845057:(Y,he,Oe)=>{o.jb("SkipLayerNormalization",Y,{epsilon:he,simplified:!!Oe})},845159:(Y,he,Oe,Ke)=>{o.jb("GatherBlockQuantized",Y,{gatherAxis:he,quantizeAxis:Oe,blockSize:Ke})},845280:Y=>{o.Zb(Y)},845314:(Y,he)=>o.ac(Number(Y),Number(he),o.Fb.dc,o.Fb.errors)};function Kt(Y,he,Oe){return Mo(async()=>{await o.Xb(Number(Y),Number(he),Number(Oe))})}function dr(){return typeof wasmOffsetConverter<"u"}class Bt{constructor(he){_t(this,"name","ExitStatus");this.message=`Program terminated with exit(${he})`,this.status=he}}var wr=Y=>{Y.terminate(),Y.onmessage=()=>{}},mr=[],hr=Y=>{Ve.length==0&&(er(),qt(Ve[0]));var he=Ve.pop();if(!he)return 6;Qe.push(he),Pt[Y.Ab]=he,he.Ab=Y.Ab;var Oe={Bb:"run",fc:Y.ec,Hb:Y.Hb,Ab:Y.Ab};return he.postMessage(Oe,Y.Mb),0},xr=0,or=(Y,he,...Oe)=>{for(var Ke=2*Oe.length,at=wl(),Ht=na(8*Ke),gr=Ht>>>3,Wr=0;Wr<Oe.length;Wr++){var cn=Oe[Wr];typeof cn=="bigint"?(ye[gr+2*Wr]=1n,ye[gr+2*Wr+1]=cn):(ye[gr+2*Wr]=0n,Ye()[gr+2*Wr+1>>>0]=cn)}return Y=bi(Y,0,Ke,Ht,he),Fo(at),Y};function tt(Y){if(d)return or(0,1,Y);if($=Y,!(0<xr)){for(var he of Qe)wr(he);for(he of Ve)wr(he);Ve=[],Qe=[],Pt={},De=!0}E(0,new Bt(Y))}function Se(Y){if(d)return or(1,0,Y);Pe(Y)}var Pe=Y=>{if($=Y,d)throw Se(Y),"unwind";tt(Y)},Ve=[],Qe=[],dt=[],Pt={},Vt=Y=>{var he=Y.Ab;delete Pt[he],Ve.push(Y),Qe.splice(Qe.indexOf(Y),1),Y.Ab=0,qc(he)};function At(){dt.forEach(Y=>Y())}var qt=Y=>new Promise(he=>{Y.onmessage=at=>{var Ht=(at=at.data).Bb;if(at.Gb&&at.Gb!=rc()){var gr=Pt[at.Gb];gr?gr.postMessage(at,at.Mb):L(`Internal error! Worker sent a message "${Ht}" to target pthread ${at.Gb}, but that thread no longer exists!`)}else Ht==="checkMailbox"?yr():Ht==="spawnThread"?hr(at):Ht==="cleanupThread"?Vt(Pt[at.hc]):Ht==="loaded"?(Y.loaded=!0,he(Y)):Ht==="alert"?alert(`Thread ${at.ic}: ${at.text}`):at.target==="setimmediate"?Y.postMessage(at):Ht==="callHandler"?o[at.Qb](...at.args):Ht&&L(`worker sent an unknown command ${Ht}`)},Y.onerror=at=>{throw L(`worker sent an error! ${at.filename}:${at.lineno}: ${at.message}`),at};var Oe,Ke=[];for(Oe of[])o.propertyIsEnumerable(Oe)&&Ke.push(Oe);Y.postMessage({Bb:"load",Rb:Ke,kc:N,lc:j})});function er(){var Y=new Worker((()=>{let he=URL;return import.meta.url>"file:"&&import.meta.url<"file;"?new he("ort.bundle.min.mjs",import.meta.url):new URL(import.meta.url)})(),{type:"module",workerData:"em-pthread",name:"em-pthread"});Ve.push(Y)}var fr=Y=>{Le();var he=Ge()[Y+52>>>2>>>0];Y=Ge()[Y+56>>>2>>>0],Ji(he,he-Y),Fo(he)},Jr=(Y,he)=>{xr=0,Y=lu(Y,he),0<xr?$=Y:ja(Y)};class $t{constructor(he){this.Ib=he-24}}function zr(Y,he,Oe){var Ke=new $t(Y>>>=0);throw he>>>=0,Oe>>>=0,Ge()[Ke.Ib+16>>>2>>>0]=0,Ge()[Ke.Ib+4>>>2>>>0]=he,Ge()[Ke.Ib+8>>>2>>>0]=Oe,Y}function Sr(Y,he,Oe,Ke){return d?or(2,1,Y,he,Oe,Ke):Ir(Y,he,Oe,Ke)}function Ir(Y,he,Oe,Ke){if(Y>>>=0,Oe>>>=0,Ke>>>=0,m===void 0)return 6;var at=[];return d&&at.length===0?Sr(Y,he>>>=0,Oe,Ke):(Y={ec:Oe,Ab:Y,Hb:Ke,Mb:at},d?(Y.Bb="spawnThread",postMessage(Y,at),0):hr(Y))}var Xr=typeof TextDecoder<"u"?new TextDecoder:void 0,qr=(Y,he=0,Oe=NaN)=>{var Ke=(he>>>=0)+Oe;for(Oe=he;Y[Oe]&&!(Oe>=Ke);)++Oe;if(16<Oe-he&&Y.buffer&&Xr)return Xr.decode(Y.buffer instanceof ArrayBuffer?Y.subarray(he,Oe):Y.slice(he,Oe));for(Ke="";he<Oe;){var at=Y[he++];if(128&at){var Ht=63&Y[he++];if((224&at)==192)Ke+=String.fromCharCode((31&at)<<6|Ht);else{var gr=63&Y[he++];65536>(at=(240&at)==224?(15&at)<<12|Ht<<6|gr:(7&at)<<18|Ht<<12|gr<<6|63&Y[he++])?Ke+=String.fromCharCode(at):(at-=65536,Ke+=String.fromCharCode(55296|at>>10,56320|1023&at))}}else Ke+=String.fromCharCode(at)}return Ke},An=(Y,he)=>(Y>>>=0)?qr(te(),Y,he):"";function ge(Y,he,Oe){return d?or(3,1,Y,he,Oe):0}function ut(Y,he){if(d)return or(4,1,Y,he)}var We=Y=>{for(var he=0,Oe=0;Oe<Y.length;++Oe){var Ke=Y.charCodeAt(Oe);127>=Ke?he++:2047>=Ke?he+=2:55296<=Ke&&57343>=Ke?(he+=4,++Oe):he+=3}return he},Je=(Y,he,Oe)=>{var Ke=te();if(he>>>=0,0<Oe){var at=he;Oe=he+Oe-1;for(var Ht=0;Ht<Y.length;++Ht){var gr=Y.charCodeAt(Ht);if(55296<=gr&&57343>=gr&&(gr=65536+((1023&gr)<<10)|1023&Y.charCodeAt(++Ht)),127>=gr){if(he>=Oe)break;Ke[he++>>>0]=gr}else{if(2047>=gr){if(he+1>=Oe)break;Ke[he++>>>0]=192|gr>>6}else{if(65535>=gr){if(he+2>=Oe)break;Ke[he++>>>0]=224|gr>>12}else{if(he+3>=Oe)break;Ke[he++>>>0]=240|gr>>18,Ke[he++>>>0]=128|gr>>12&63}Ke[he++>>>0]=128|gr>>6&63}Ke[he++>>>0]=128|63&gr}}Ke[he>>>0]=0,Y=he-at}else Y=0;return Y};function xt(Y,he){if(d)return or(5,1,Y,he)}function wt(Y,he,Oe){if(d)return or(6,1,Y,he,Oe)}function pr(Y,he,Oe){return d?or(7,1,Y,he,Oe):0}function Rr(Y,he){if(d)return or(8,1,Y,he)}function On(Y,he,Oe){if(d)return or(9,1,Y,he,Oe)}function Mn(Y,he,Oe,Ke){if(d)return or(10,1,Y,he,Oe,Ke)}function _r(Y,he,Oe,Ke){if(d)return or(11,1,Y,he,Oe,Ke)}function Or(Y,he,Oe,Ke){if(d)return or(12,1,Y,he,Oe,Ke)}function an(Y){if(d)return or(13,1,Y)}function Vn(Y,he){if(d)return or(14,1,Y,he)}function _o(Y,he,Oe){if(d)return or(15,1,Y,he,Oe)}var Uo,yn,Vo=()=>kt(""),Po=Y=>{for(var he="";te()[Y>>>0];)he+=Uo[te()[Y++>>>0]];return he},pa={},ta={};function ra(Y,he,Oe={}){return function(Ke,at,Ht={}){var gr=at.name;if(!Ke)throw new yn(`type "${gr}" must have a positive integer typeid pointer`);if(ta.hasOwnProperty(Ke)){if(Ht.Sb)return;throw new yn(`Cannot register type '${gr}' twice`)}ta[Ke]=at,pa.hasOwnProperty(Ke)&&(at=pa[Ke],delete pa[Ke],at.forEach(Wr=>Wr()))}(Y,he,Oe)}var so=(Y,he,Oe)=>{switch(he){case 1:return Oe?Ke=>K()[Ke>>>0]:Ke=>te()[Ke>>>0];case 2:return Oe?Ke=>ve()[Ke>>>1>>>0]:Ke=>$e()[Ke>>>1>>>0];case 4:return Oe?Ke=>Ce()[Ke>>>2>>>0]:Ke=>Ge()[Ke>>>2>>>0];case 8:return Oe?Ke=>ye[Ke>>>3]:Ke=>_e[Ke>>>3];default:throw new TypeError(`invalid integer width (${he}): ${Y}`)}};function Xs(Y,he,Oe){Oe>>>=0,ra(Y>>>=0,{name:he=Po(he>>>0),fromWireType:Ke=>Ke,toWireType:function(Ke,at){if(typeof at!="bigint"&&typeof at!="number")throw at=at===null?"null":(Ke=typeof at)=="object"||Ke==="array"||Ke==="function"?at.toString():""+at,new TypeError(`Cannot convert "${at}" to ${this.name}`);return typeof at=="number"&&(at=BigInt(at)),at},Cb:xo,readValueFromPointer:so(he,Oe,he.indexOf("u")==-1),Db:null})}var xo=8;function Qn(Y,he,Oe,Ke){ra(Y>>>=0,{name:he=Po(he>>>0),fromWireType:function(at){return!!at},toWireType:function(at,Ht){return Ht?Oe:Ke},Cb:xo,readValueFromPointer:function(at){return this.fromWireType(te()[at>>>0])},Db:null})}var is=[],la=[];function $s(Y){9<(Y>>>=0)&&--la[Y+1]==0&&(la[Y]=void 0,is.push(Y))}var wo=Y=>{if(!Y)throw new yn("Cannot use deleted val. handle = "+Y);return la[Y]},Eo=Y=>{switch(Y){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:let he=is.pop()||la.length;return la[he]=Y,la[he+1]=1,he}};function Wa(Y){return this.fromWireType(Ge()[Y>>>2>>>0])}var ul={name:"emscripten::val",fromWireType:Y=>{var he=wo(Y);return $s(Y),he},toWireType:(Y,he)=>Eo(he),Cb:xo,readValueFromPointer:Wa,Db:null};function os(Y){return ra(Y>>>0,ul)}var Pr=(Y,he)=>{switch(he){case 4:return function(Oe){return this.fromWireType(ot()[Oe>>>2>>>0])};case 8:return function(Oe){return this.fromWireType(Ye()[Oe>>>3>>>0])};default:throw new TypeError(`invalid float width (${he}): ${Y}`)}};function Hr(Y,he,Oe){Oe>>>=0,ra(Y>>>=0,{name:he=Po(he>>>0),fromWireType:Ke=>Ke,toWireType:(Ke,at)=>at,Cb:xo,readValueFromPointer:Pr(he,Oe),Db:null})}function gn(Y,he,Oe,Ke,at){if(Y>>>=0,Oe>>>=0,he=Po(he>>>0),at===-1&&(at=4294967295),at=Wr=>Wr,Ke===0){var Ht=32-8*Oe;at=Wr=>Wr<<Ht>>>Ht}var gr=he.includes("unsigned")?function(Wr,cn){return cn>>>0}:function(Wr,cn){return cn};ra(Y,{name:he,fromWireType:at,toWireType:gr,Cb:xo,readValueFromPointer:so(he,Oe,Ke!==0),Db:null})}function Zi(Y,he,Oe){function Ke(Ht){var gr=Ge()[Ht>>>2>>>0];return Ht=Ge()[Ht+4>>>2>>>0],new at(K().buffer,Ht,gr)}var at=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array][he];ra(Y>>>=0,{name:Oe=Po(Oe>>>0),fromWireType:Ke,Cb:xo,readValueFromPointer:Ke},{Sb:!0})}function dl(Y,he){ra(Y>>>=0,{name:he=Po(he>>>0),fromWireType:function(Oe){for(var Ke,at=Ge()[Oe>>>2>>>0],Ht=Oe+4,gr=Ht,Wr=0;Wr<=at;++Wr){var cn=Ht+Wr;Wr!=at&&te()[cn>>>0]!=0||(gr=An(gr,cn-gr),Ke===void 0?Ke=gr:(Ke+="\0",Ke+=gr),gr=cn+1)}return Na(Oe),Ke},toWireType:function(Oe,Ke){Ke instanceof ArrayBuffer&&(Ke=new Uint8Array(Ke));var at=typeof Ke=="string";if(!(at||Ke instanceof Uint8Array||Ke instanceof Uint8ClampedArray||Ke instanceof Int8Array))throw new yn("Cannot pass non-string to std::string");var Ht=at?We(Ke):Ke.length,gr=nc(4+Ht+1),Wr=gr+4;if(Ge()[gr>>>2>>>0]=Ht,at)Je(Ke,Wr,Ht+1);else if(at)for(at=0;at<Ht;++at){var cn=Ke.charCodeAt(at);if(255<cn)throw Na(gr),new yn("String has UTF-16 code units that do not fit in 8 bits");te()[Wr+at>>>0]=cn}else for(at=0;at<Ht;++at)te()[Wr+at>>>0]=Ke[at];return Oe!==null&&Oe.push(Na,gr),gr},Cb:xo,readValueFromPointer:Wa,Db(Oe){Na(Oe)}})}var ba=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,Ga=(Y,he)=>{for(var Oe=Y>>1,Ke=Oe+he/2;!(Oe>=Ke)&&$e()[Oe>>>0];)++Oe;if(32<(Oe<<=1)-Y&&ba)return ba.decode(te().slice(Y,Oe));for(Oe="",Ke=0;!(Ke>=he/2);++Ke){var at=ve()[Y+2*Ke>>>1>>>0];if(at==0)break;Oe+=String.fromCharCode(at)}return Oe},yo=(Y,he,Oe)=>{if(Oe??(Oe=2147483647),2>Oe)return 0;var Ke=he;Oe=(Oe-=2)<2*Y.length?Oe/2:Y.length;for(var at=0;at<Oe;++at){var Ht=Y.charCodeAt(at);ve()[he>>>1>>>0]=Ht,he+=2}return ve()[he>>>1>>>0]=0,he-Ke},Xl=Y=>2*Y.length,Dl=(Y,he)=>{for(var Oe=0,Ke="";!(Oe>=he/4);){var at=Ce()[Y+4*Oe>>>2>>>0];if(at==0)break;++Oe,65536<=at?(at-=65536,Ke+=String.fromCharCode(55296|at>>10,56320|1023&at)):Ke+=String.fromCharCode(at)}return Ke},Uc=(Y,he,Oe)=>{if(he>>>=0,Oe??(Oe=2147483647),4>Oe)return 0;var Ke=he;Oe=Ke+Oe-4;for(var at=0;at<Y.length;++at){var Ht=Y.charCodeAt(at);if(55296<=Ht&&57343>=Ht&&(Ht=65536+((1023&Ht)<<10)|1023&Y.charCodeAt(++at)),Ce()[he>>>2>>>0]=Ht,(he+=4)+4>Oe)break}return Ce()[he>>>2>>>0]=0,he-Ke},Yt=Y=>{for(var he=0,Oe=0;Oe<Y.length;++Oe){var Ke=Y.charCodeAt(Oe);55296<=Ke&&57343>=Ke&&++Oe,he+=4}return he};function Ie(Y,he,Oe){if(Y>>>=0,he>>>=0,Oe=Po(Oe>>>=0),he===2)var Ke=Ga,at=yo,Ht=Xl,gr=Wr=>$e()[Wr>>>1>>>0];else he===4&&(Ke=Dl,at=Uc,Ht=Yt,gr=Wr=>Ge()[Wr>>>2>>>0]);ra(Y,{name:Oe,fromWireType:Wr=>{for(var cn,wn=Ge()[Wr>>>2>>>0],Yn=Wr+4,Ci=0;Ci<=wn;++Ci){var ro=Wr+4+Ci*he;Ci!=wn&&gr(ro)!=0||(Yn=Ke(Yn,ro-Yn),cn===void 0?cn=Yn:(cn+="\0",cn+=Yn),Yn=ro+he)}return Na(Wr),cn},toWireType:(Wr,cn)=>{if(typeof cn!="string")throw new yn(`Cannot pass non-string to C++ string type ${Oe}`);var wn=Ht(cn),Yn=nc(4+wn+he);return Ge()[Yn>>>2>>>0]=wn/he,at(cn,Yn+4,wn+he),Wr!==null&&Wr.push(Na,Yn),Yn},Cb:xo,readValueFromPointer:Wa,Db(Wr){Na(Wr)}})}function rt(Y,he){ra(Y>>>=0,{Tb:!0,name:he=Po(he>>>0),Cb:0,fromWireType:()=>{},toWireType:()=>{}})}function Tt(Y){bl(Y>>>0,!u,1,!a,131072,!1),At()}var Ft=Y=>{if(!De)try{if(Y(),!(0<xr))try{d?ja($):Pe($)}catch(he){he instanceof Bt||he=="unwind"||E(0,he)}}catch(he){he instanceof Bt||he=="unwind"||E(0,he)}};function Dt(Y){Y>>>=0,typeof Atomics.jc=="function"&&(Atomics.jc(Ce(),Y>>>2,Y).value.then(yr),Y+=128,Atomics.store(Ce(),Y>>>2,1))}var yr=()=>{var Y=rc();Y&&(Dt(Y),Ft(So))};function Vr(Y,he){(Y>>>=0)==he>>>0?setTimeout(yr):d?postMessage({Gb:Y,Bb:"checkMailbox"}):(Y=Pt[Y])&&Y.postMessage({Bb:"checkMailbox"})}var en=[];function Qr(Y,he,Oe,Ke,at){for(he>>>=0,Ke/=2,en.length=Ke,Oe=at>>>0>>>3,at=0;at<Ke;at++)en[at]=ye[Oe+2*at]?ye[Oe+2*at+1]:Ye()[Oe+2*at+1>>>0];return(he?Zt[he]:yl[Y])(...en)}var Dr=()=>{xr=0};function Ln(Y){Y>>>=0,d?postMessage({Bb:"cleanupThread",hc:Y}):Vt(Pt[Y])}function Ii(Y){}var vi=(Y,he)=>{var Oe=ta[Y];if(Oe===void 0)throw Y=vl(Y),Oe=Po(Y),Na(Y),new yn(`${he} has unknown type ${Oe}`);return Oe},Ai=(Y,he,Oe)=>{var Ke=[];return Y=Y.toWireType(Ke,Oe),Ke.length&&(Ge()[he>>>2>>>0]=Eo(Ke)),Y};function rn(Y,he,Oe){return he>>>=0,Oe>>>=0,Y=wo(Y>>>0),he=vi(he,"emval::as"),Ai(he,Oe,Y)}function Xi(Y,he){return he>>>=0,Y=wo(Y>>>0),(he=vi(he,"emval::as")).toWireType(null,Y)}var Oi=Y=>{try{Y()}catch(he){kt(he)}},ri=0,ma=null,Ri=0,lo=[],Mi={},di={},Ho=0,bn=null,Nn=[];function Mo(Y){return function(he){if(!De){if(ri===0){var Oe=!1,Ke=!1;he((at=0)=>{if(!De&&(Ri=at,Oe=!0,Ke)){ri=2,Oi(()=>oh(ma)),typeof MainLoop<"u"&&MainLoop.Pb&&MainLoop.resume(),at=!1;try{var Ht=function(){var cn=Ce()[ma+8>>>2>>>0];return cn=$n[di[cn]],--xr,cn()}()}catch(cn){Ht=cn,at=!0}var gr=!1;if(!ma){var Wr=bn;Wr&&(bn=null,(at?Wr.reject:Wr.resolve)(Ht),gr=!0)}if(at&&!gr)throw Ht}}),Ke=!0,Oe||(ri=1,ma=function(){var at=nc(65548),Ht=at+12;Ge()[at>>>2>>>0]=Ht,Ge()[at+4>>>2>>>0]=Ht+65536,Ht=lo[0];var gr=Mi[Ht];return gr===void 0&&(gr=Ho++,Mi[Ht]=gr,di[gr]=Ht),Ht=gr,Ce()[at+8>>>2>>>0]=Ht,at}(),typeof MainLoop<"u"&&MainLoop.Pb&&MainLoop.pause(),Oi(()=>$l(ma)))}else ri===2?(ri=0,Oi(yd),Na(ma),ma=null,Nn.forEach(Ft)):kt(`invalid state: ${ri}`);return Ri}}(he=>{Y().then(he)})}function ni(Y){return Y>>>=0,Mo(async()=>{var he=await wo(Y);return Eo(he)})}var Yi=[];function Qi(Y,he,Oe,Ke){return Oe>>>=0,Ke>>>=0,(Y=Yi[Y>>>0])(null,he=wo(he>>>0),Oe,Ke)}var co={},po=Y=>{var he=co[Y];return he===void 0?Po(Y):he};function ga(Y,he,Oe,Ke,at){return Oe>>>=0,Ke>>>=0,at>>>=0,(Y=Yi[Y>>>0])(he=wo(he>>>0),he[Oe=po(Oe)],Ke,at)}var ws=()=>typeof globalThis=="object"?globalThis:Function("return this")();function hl(Y){return(Y>>>=0)==0?Eo(ws()):(Y=po(Y),Eo(ws()[Y]))}var fl=Y=>{var he=Yi.length;return Yi.push(Y),he},Yl=(Y,he)=>{for(var Oe=Array(Y),Ke=0;Ke<Y;++Ke)Oe[Ke]=vi(Ge()[he+4*Ke>>>2>>>0],"parameter "+Ke);return Oe},_c=(Y,he)=>Object.defineProperty(he,"name",{value:Y});function Ms(Y,he,Oe){var Ke=(he=Yl(Y,he>>>0)).shift();Y--;var at=`return function (obj, func, destructorsRef, args) {
`,Ht=0,gr=[];Oe===0&&gr.push("obj");for(var Wr=["retType"],cn=[Ke],wn=0;wn<Y;++wn)gr.push("arg"+wn),Wr.push("argType"+wn),cn.push(he[wn]),at+=`  var arg${wn} = argType${wn}.readValueFromPointer(args${Ht?"+"+Ht:""});
`,Ht+=he[wn].Cb;return at+=`  var rv = ${Oe===1?"new func":"func.call"}(${gr.join(", ")});
`,Ke.Tb||(Wr.push("emval_returnValue"),cn.push(Ai),at+=`  return emval_returnValue(retType, destructorsRef, rv);
`),Wr.push(at+`};
`),Y=function(Yn){var Ci=Function;if(!(Ci instanceof Function))throw new TypeError(`new_ called with constructor type ${typeof Ci} which is not a function`);var ro=_c(Ci.name||"unknownFunctionName",function(){});return ro.prototype=Ci.prototype,ro=new ro,(Yn=Ci.apply(ro,Yn))instanceof Object?Yn:ro}(Wr)(...cn),Oe=`methodCaller<(${he.map(Yn=>Yn.name).join(", ")}) => ${Ke.name}>`,fl(_c(Oe,Y))}function vo(Y){return Y=po(Y>>>0),Eo(o[Y])}function Ss(Y,he){return he>>>=0,Y=wo(Y>>>0),he=wo(he),Eo(Y[he])}function re(Y){9<(Y>>>=0)&&(la[Y+1]+=1)}function ze(){return Eo([])}function pt(Y){Y=wo(Y>>>0);for(var he=Array(Y.length),Oe=0;Oe<Y.length;Oe++)he[Oe]=Y[Oe];return Eo(he)}function Ut(Y){return Eo(po(Y>>>0))}function Qt(){return Eo({})}function Er(Y){for(var he=wo(Y>>>=0);he.length;){var Oe=he.pop();he.pop()(Oe)}$s(Y)}function jr(Y,he,Oe){he>>>=0,Oe>>>=0,Y=wo(Y>>>0),he=wo(he),Oe=wo(Oe),Y[he]=Oe}function Sn(Y,he){return he>>>=0,Y=(Y=vi(Y>>>0,"_emval_take_value")).readValueFromPointer(he),Eo(Y)}function vn(Y,he){Y=-9007199254740992>Y||9007199254740992<Y?NaN:Number(Y),he>>>=0,Y=new Date(1e3*Y),Ce()[he>>>2>>>0]=Y.getUTCSeconds(),Ce()[he+4>>>2>>>0]=Y.getUTCMinutes(),Ce()[he+8>>>2>>>0]=Y.getUTCHours(),Ce()[he+12>>>2>>>0]=Y.getUTCDate(),Ce()[he+16>>>2>>>0]=Y.getUTCMonth(),Ce()[he+20>>>2>>>0]=Y.getUTCFullYear()-1900,Ce()[he+24>>>2>>>0]=Y.getUTCDay(),Y=(Y.getTime()-Date.UTC(Y.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,Ce()[he+28>>>2>>>0]=Y}var Zn=Y=>Y%4==0&&(Y%100!=0||Y%400==0),Xn=[0,31,60,91,121,152,182,213,244,274,305,335],Ui=[0,31,59,90,120,151,181,212,243,273,304,334];function Ao(Y,he){Y=-9007199254740992>Y||9007199254740992<Y?NaN:Number(Y),he>>>=0,Y=new Date(1e3*Y),Ce()[he>>>2>>>0]=Y.getSeconds(),Ce()[he+4>>>2>>>0]=Y.getMinutes(),Ce()[he+8>>>2>>>0]=Y.getHours(),Ce()[he+12>>>2>>>0]=Y.getDate(),Ce()[he+16>>>2>>>0]=Y.getMonth(),Ce()[he+20>>>2>>>0]=Y.getFullYear()-1900,Ce()[he+24>>>2>>>0]=Y.getDay();var Oe=(Zn(Y.getFullYear())?Xn:Ui)[Y.getMonth()]+Y.getDate()-1|0;Ce()[he+28>>>2>>>0]=Oe,Ce()[he+36>>>2>>>0]=-60*Y.getTimezoneOffset(),Oe=new Date(Y.getFullYear(),6,1).getTimezoneOffset();var Ke=new Date(Y.getFullYear(),0,1).getTimezoneOffset();Y=0|(Oe!=Ke&&Y.getTimezoneOffset()==Math.min(Ke,Oe)),Ce()[he+32>>>2>>>0]=Y}function Ko(Y){Y>>>=0;var he=new Date(Ce()[Y+20>>>2>>>0]+1900,Ce()[Y+16>>>2>>>0],Ce()[Y+12>>>2>>>0],Ce()[Y+8>>>2>>>0],Ce()[Y+4>>>2>>>0],Ce()[Y>>>2>>>0],0),Oe=Ce()[Y+32>>>2>>>0],Ke=he.getTimezoneOffset(),at=new Date(he.getFullYear(),6,1).getTimezoneOffset(),Ht=new Date(he.getFullYear(),0,1).getTimezoneOffset(),gr=Math.min(Ht,at);return 0>Oe?Ce()[Y+32>>>2>>>0]=+(at!=Ht&&gr==Ke):0<Oe!=(gr==Ke)&&(at=Math.max(Ht,at),he.setTime(he.getTime()+6e4*((0<Oe?gr:at)-Ke))),Ce()[Y+24>>>2>>>0]=he.getDay(),Oe=(Zn(he.getFullYear())?Xn:Ui)[he.getMonth()]+he.getDate()-1|0,Ce()[Y+28>>>2>>>0]=Oe,Ce()[Y>>>2>>>0]=he.getSeconds(),Ce()[Y+4>>>2>>>0]=he.getMinutes(),Ce()[Y+8>>>2>>>0]=he.getHours(),Ce()[Y+12>>>2>>>0]=he.getDate(),Ce()[Y+16>>>2>>>0]=he.getMonth(),Ce()[Y+20>>>2>>>0]=he.getYear(),Y=he.getTime(),BigInt(isNaN(Y)?-1:Y/1e3)}function pi(Y,he,Oe,Ke,at,Ht,gr){return d?or(16,1,Y,he,Oe,Ke,at,Ht,gr):-52}function ca(Y,he,Oe,Ke,at,Ht){if(d)return or(17,1,Y,he,Oe,Ke,at,Ht)}var jo={},Oa=()=>performance.timeOrigin+performance.now();function pl(Y,he){if(d)return or(18,1,Y,he);if(jo[Y]&&(clearTimeout(jo[Y].id),delete jo[Y]),!he)return 0;var Oe=setTimeout(()=>{delete jo[Y],Ft(()=>xl(Y,performance.timeOrigin+performance.now()))},he);return jo[Y]={id:Oe,qc:he},0}function yc(Y,he,Oe,Ke){Y>>>=0,he>>>=0,Oe>>>=0,Ke>>>=0;var at=new Date().getFullYear(),Ht=new Date(at,0,1).getTimezoneOffset();at=new Date(at,6,1).getTimezoneOffset();var gr=Math.max(Ht,at);Ge()[Y>>>2>>>0]=60*gr,Ce()[he>>>2>>>0]=+(Ht!=at),Y=(he=Wr=>{var cn=Math.abs(Wr);return`UTC${0<=Wr?"-":"+"}${String(Math.floor(cn/60)).padStart(2,"0")}${String(cn%60).padStart(2,"0")}`})(Ht),he=he(at),at<Ht?(Je(Y,Oe,17),Je(he,Ke,17)):(Je(Y,Ke,17),Je(he,Oe,17))}var Wh=()=>Date.now();function su(Y,he,Oe){return 0<=Y&&3>=Y?(Y===0?Y=Date.now():Y=performance.timeOrigin+performance.now(),ye[Oe>>>0>>>3]=BigInt(Math.round(1e6*Y)),0):28}var ml=[],Pa=(Y,he)=>{ml.length=0;for(var Oe;Oe=te()[Y++>>>0];){var Ke=Oe!=105;he+=(Ke&=Oe!=112)&&he%8?4:0,ml.push(Oe==112?Ge()[he>>>2>>>0]:Oe==106?ye[he>>>3]:Oe==105?Ce()[he>>>2>>>0]:Ye()[he>>>3>>>0]),he+=Ke?8:4}return ml};function vc(Y,he,Oe){return Y>>>=0,he=Pa(he>>>0,Oe>>>0),Zt[Y](...he)}function bc(Y,he,Oe){return Y>>>=0,he=Pa(he>>>0,Oe>>>0),Zt[Y](...he)}var La=()=>{};function Da(Y,he){return L(An(Y>>>0,he>>>0))}var gl=()=>{throw xr+=1,"unwind"};function Ys(){return 4294901760}var Ql=()=>navigator.hardwareConcurrency;function Yu(){return kt("Cannot use emscripten_pc_get_function without -sUSE_OFFSET_CONVERTER"),0}function $a(Y){Y>>>=0;var he=te().length;if(Y<=he||4294901760<Y)return!1;for(var Oe=1;4>=Oe;Oe*=2){var Ke=he*(1+.2/Oe);Ke=Math.min(Ke,Y+100663296);e:{Ke=(Math.min(4294901760,65536*Math.ceil(Math.max(Y,Ke)/65536))-N.buffer.byteLength+65535)/65536|0;try{N.grow(Ke),Le();var at=1;break e}catch{}at=void 0}if(at)return!0}return!1}var Vc=()=>(kt("Cannot use convertFrameToPC (needed by __builtin_return_address) without -sUSE_OFFSET_CONVERTER"),0),as={},Wc=Y=>{Y.forEach(he=>{Vc()})};function ua(){var Y=Error().stack.toString().split(`
`);return Y[0]=="Error"&&Y.shift(),Wc(Y),as.Lb=Vc(),as.cc=Y,as.Lb}function _l(Y,he,Oe){if(Y>>>=0,he>>>=0,as.Lb==Y)var Ke=as.cc;else(Ke=Error().stack.toString().split(`
`))[0]=="Error"&&Ke.shift(),Wc(Ke);for(var at=3;Ke[at]&&Vc()!=Y;)++at;for(Y=0;Y<Oe&&Ke[Y+at];++Y)Ce()[he+4*Y>>>2>>>0]=Vc();return Y}var xc,Ns={},Jl=()=>{if(!xc){var Y,he={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:"./this.program"};for(Y in Ns)Ns[Y]===void 0?delete he[Y]:he[Y]=Ns[Y];var Oe=[];for(Y in he)Oe.push(`${Y}=${he[Y]}`);xc=Oe}return xc};function wc(Y,he){if(d)return or(19,1,Y,he);Y>>>=0,he>>>=0;var Oe=0;return Jl().forEach((Ke,at)=>{var Ht=he+Oe;for(at=Ge()[Y+4*at>>>2>>>0]=Ht,Ht=0;Ht<Ke.length;++Ht)K()[at++>>>0]=Ke.charCodeAt(Ht);K()[at>>>0]=0,Oe+=Ke.length+1}),0}function ss(Y,he){if(d)return or(20,1,Y,he);Y>>>=0,he>>>=0;var Oe=Jl();Ge()[Y>>>2>>>0]=Oe.length;var Ke=0;return Oe.forEach(at=>Ke+=at.length+1),Ge()[he>>>2>>>0]=Ke,0}function Ts(Y){return d?or(21,1,Y):52}function js(Y,he,Oe,Ke){return d?or(22,1,Y,he,Oe,Ke):52}function Rs(Y,he,Oe,Ke){return d?or(23,1,Y,he,Oe,Ke):70}var ec=[null,[],[]];function tc(Y,he,Oe,Ke){if(d)return or(24,1,Y,he,Oe,Ke);he>>>=0,Oe>>>=0,Ke>>>=0;for(var at=0,Ht=0;Ht<Oe;Ht++){var gr=Ge()[he>>>2>>>0],Wr=Ge()[he+4>>>2>>>0];he+=8;for(var cn=0;cn<Wr;cn++){var wn=te()[gr+cn>>>0],Yn=ec[Y];wn===0||wn===10?((Y===1?D:L)(qr(Yn)),Yn.length=0):Yn.push(wn)}at+=Wr}return Ge()[Ke>>>2>>>0]=at,0}d||function(){for(var Y=o.numThreads-1;Y--;)er();mr.unshift(()=>{Ne++,function(he){d?he():Promise.all(Ve.map(qt)).then(he)}(()=>Lt())})}();for(var Mc=Array(256),Co=0;256>Co;++Co)Mc[Co]=String.fromCharCode(Co);Uo=Mc,yn=o.BindingError=class extends Error{constructor(Y){super(Y),this.name="BindingError"}},o.InternalError=class extends Error{constructor(Y){super(Y),this.name="InternalError"}},la.push(0,1,void 0,1,null,1,!0,1,!1,1),o.count_emval_handles=()=>la.length/2-5-is.length;var $n,yl=[tt,Se,Sr,ge,ut,xt,wt,pr,Rr,On,Mn,_r,Or,an,Vn,_o,pi,ca,pl,wc,ss,Ts,js,Rs,tc];(async function(){function Y(Ke,at){return $n=Ke.exports,$n=function(){var Ht=$n,gr={};for(let[Wr,cn]of Object.entries(Ht))gr[Wr]=typeof cn=="function"?(...wn)=>{lo.push(Wr);try{return cn(...wn)}finally{De||(lo.pop(),ma&&ri===1&&lo.length===0&&(ri=0,xr+=1,Oi(Hc),typeof Fibers<"u"&&Fibers.rc()))}}:cn;return gr}(),$n=function(){var Ht=$n,gr=cn=>wn=>cn(wn)>>>0,Wr=cn=>()=>cn()>>>0;return(Ht=Object.assign({},Ht)).Da=gr(Ht.Da),Ht.fb=Wr(Ht.fb),Ht.hb=gr(Ht.hb),Ht.tb=gr(Ht.tb),Ht.ub=Wr(Ht.ub),Ht.__cxa_get_exception_ptr=gr(Ht.__cxa_get_exception_ptr),Ht}(),dt.push($n.ib),j=at,Lt(),$n}Ne++;var he=mt();if(o.instantiateWasm)return new Promise(Ke=>{o.instantiateWasm(he,(at,Ht)=>{Y(at,Ht),Ke(at.exports)})});if(d)return new Promise(Ke=>{et=at=>{var Ht=new WebAssembly.Instance(at,mt());Ke(Y(Ht,at))}});Xe??(Xe=o.locateFile?o.locateFile?o.locateFile("ort-wasm-simd-threaded.jsep.wasm",T):T+"ort-wasm-simd-threaded.jsep.wasm":new URL("/forest_right_portal.github.io/assets/ort-wasm-simd-threaded.jsep-B0T3yYHD.wasm",import.meta.url).href);try{var Oe=await async function(Ke){var at=Xe;if(!fe&&typeof WebAssembly.instantiateStreaming=="function"&&!pe(at))try{var Ht=fetch(at,{credentials:"same-origin"});return await WebAssembly.instantiateStreaming(Ht,Ke)}catch(gr){L(`wasm streaming compile failed: ${gr}`),L("falling back to ArrayBuffer instantiation")}return async function(gr,Wr){try{var cn=await async function(wn){if(!fe)try{var Yn=await y(wn);return new Uint8Array(Yn)}catch{}if(wn==Xe&&fe)wn=new Uint8Array(fe);else{if(!M)throw"both async and sync fetching of the wasm failed";wn=M(wn)}return wn}(gr);return await WebAssembly.instantiate(cn,Wr)}catch(wn){L(`failed to asynchronously prepare wasm: ${wn}`),kt(wn)}}(at,Ke)}(he);return Y(Oe.instance,Oe.module)}catch(Ke){return i(Ke),Promise.reject(Ke)}})();var vl=Y=>(vl=$n.Da)(Y),Gc=()=>(Gc=$n.Ea)();o._OrtInit=(Y,he)=>(o._OrtInit=$n.Fa)(Y,he),o._OrtGetLastError=(Y,he)=>(o._OrtGetLastError=$n.Ga)(Y,he),o._OrtCreateSessionOptions=(Y,he,Oe,Ke,at,Ht,gr,Wr,cn,wn)=>(o._OrtCreateSessionOptions=$n.Ha)(Y,he,Oe,Ke,at,Ht,gr,Wr,cn,wn),o._OrtAppendExecutionProvider=(Y,he,Oe,Ke,at)=>(o._OrtAppendExecutionProvider=$n.Ia)(Y,he,Oe,Ke,at),o._OrtAddFreeDimensionOverride=(Y,he,Oe)=>(o._OrtAddFreeDimensionOverride=$n.Ja)(Y,he,Oe),o._OrtAddSessionConfigEntry=(Y,he,Oe)=>(o._OrtAddSessionConfigEntry=$n.Ka)(Y,he,Oe),o._OrtReleaseSessionOptions=Y=>(o._OrtReleaseSessionOptions=$n.La)(Y),o._OrtCreateSession=(Y,he,Oe)=>(o._OrtCreateSession=$n.Ma)(Y,he,Oe),o._OrtReleaseSession=Y=>(o._OrtReleaseSession=$n.Na)(Y),o._OrtGetInputOutputCount=(Y,he,Oe)=>(o._OrtGetInputOutputCount=$n.Oa)(Y,he,Oe),o._OrtGetInputOutputMetadata=(Y,he,Oe,Ke)=>(o._OrtGetInputOutputMetadata=$n.Pa)(Y,he,Oe,Ke),o._OrtFree=Y=>(o._OrtFree=$n.Qa)(Y),o._OrtCreateTensor=(Y,he,Oe,Ke,at,Ht)=>(o._OrtCreateTensor=$n.Ra)(Y,he,Oe,Ke,at,Ht),o._OrtGetTensorData=(Y,he,Oe,Ke,at)=>(o._OrtGetTensorData=$n.Sa)(Y,he,Oe,Ke,at),o._OrtReleaseTensor=Y=>(o._OrtReleaseTensor=$n.Ta)(Y),o._OrtCreateRunOptions=(Y,he,Oe,Ke)=>(o._OrtCreateRunOptions=$n.Ua)(Y,he,Oe,Ke),o._OrtAddRunConfigEntry=(Y,he,Oe)=>(o._OrtAddRunConfigEntry=$n.Va)(Y,he,Oe),o._OrtReleaseRunOptions=Y=>(o._OrtReleaseRunOptions=$n.Wa)(Y),o._OrtCreateBinding=Y=>(o._OrtCreateBinding=$n.Xa)(Y),o._OrtBindInput=(Y,he,Oe)=>(o._OrtBindInput=$n.Ya)(Y,he,Oe),o._OrtBindOutput=(Y,he,Oe,Ke)=>(o._OrtBindOutput=$n.Za)(Y,he,Oe,Ke),o._OrtClearBoundOutputs=Y=>(o._OrtClearBoundOutputs=$n._a)(Y),o._OrtReleaseBinding=Y=>(o._OrtReleaseBinding=$n.$a)(Y),o._OrtRunWithBinding=(Y,he,Oe,Ke,at)=>(o._OrtRunWithBinding=$n.ab)(Y,he,Oe,Ke,at),o._OrtRun=(Y,he,Oe,Ke,at,Ht,gr,Wr)=>(o._OrtRun=$n.bb)(Y,he,Oe,Ke,at,Ht,gr,Wr),o._OrtEndProfiling=Y=>(o._OrtEndProfiling=$n.cb)(Y),o._JsepOutput=(Y,he,Oe)=>(o._JsepOutput=$n.db)(Y,he,Oe),o._JsepGetNodeName=Y=>(o._JsepGetNodeName=$n.eb)(Y);var rc=()=>(rc=$n.fb)(),Na=o._free=Y=>(Na=o._free=$n.gb)(Y),nc=o._malloc=Y=>(nc=o._malloc=$n.hb)(Y),bl=(Y,he,Oe,Ke,at,Ht)=>(bl=$n.kb)(Y,he,Oe,Ke,at,Ht),qa=()=>(qa=$n.lb)(),bi=(Y,he,Oe,Ke,at)=>(bi=$n.mb)(Y,he,Oe,Ke,at),qc=Y=>(qc=$n.nb)(Y),ja=Y=>(ja=$n.ob)(Y),xl=(Y,he)=>(xl=$n.pb)(Y,he),So=()=>(So=$n.qb)(),Ji=(Y,he)=>(Ji=$n.rb)(Y,he),Fo=Y=>(Fo=$n.sb)(Y),na=Y=>(na=$n.tb)(Y),wl=()=>(wl=$n.ub)(),lu=o.dynCall_ii=(Y,he)=>(lu=o.dynCall_ii=$n.vb)(Y,he),$l=Y=>($l=$n.wb)(Y),Hc=()=>(Hc=$n.xb)(),oh=Y=>(oh=$n.yb)(Y),yd=()=>(yd=$n.zb)();return o.stackSave=()=>wl(),o.stackRestore=Y=>Fo(Y),o.stackAlloc=Y=>na(Y),o.setValue=function(Y,he,Oe="i8"){switch(Oe.endsWith("*")&&(Oe="*"),Oe){case"i1":case"i8":K()[Y>>>0]=he;break;case"i16":ve()[Y>>>1>>>0]=he;break;case"i32":Ce()[Y>>>2>>>0]=he;break;case"i64":ye[Y>>>3]=BigInt(he);break;case"float":ot()[Y>>>2>>>0]=he;break;case"double":Ye()[Y>>>3>>>0]=he;break;case"*":Ge()[Y>>>2>>>0]=he;break;default:kt(`invalid type for setValue: ${Oe}`)}},o.getValue=function(Y,he="i8"){switch(he.endsWith("*")&&(he="*"),he){case"i1":case"i8":return K()[Y>>>0];case"i16":return ve()[Y>>>1>>>0];case"i32":return Ce()[Y>>>2>>>0];case"i64":return ye[Y>>>3];case"float":return ot()[Y>>>2>>>0];case"double":return Ye()[Y>>>3>>>0];case"*":return Ge()[Y>>>2>>>0];default:kt(`invalid type for getValue: ${he}`)}},o.UTF8ToString=An,o.stringToUTF8=Je,o.lengthBytesUTF8=We,function Y(){if(0<Ne)Ot=Y;else if(d)n(o),ke();else{for(;0<mr.length;)mr.shift()(o);0<Ne?Ot=Y:(o.calledRun=!0,De||(ke(),n(o)))}}(),o.PTR_SIZE=4,s}),zre=s3,H8=(t=(e=globalThis.self)==null?void 0:e.name)==null?void 0:t.startsWith("em-pthread"),H8&&s3()}),l3,FD,K8,jd,Bre,SP,Z8,X8,c3,Y8,u3,Ure,d3,Vre,mR=nn(()=>{pR(),l3=typeof location>"u"?void 0:location.origin,FD=import.meta.url>"file:"&&import.meta.url<"file;",K8=()=>{{if(FD){let e=URL;return new URL(new e("ort.bundle.min.mjs",import.meta.url).href,l3).href}return import.meta.url}},jd=K8(),Bre=()=>{if(jd&&!jd.startsWith("blob:"))return jd.substring(0,jd.lastIndexOf("/")+1)},SP=(e,t)=>{try{let r=t??jd;return(r?new URL(e,r):new URL(e)).origin===l3}catch{return!1}},Z8=(e,t)=>{let r=t??jd;try{return(r?new URL(e,r):new URL(e)).href}catch{return}},X8=(e,t)=>`${t??"./"}${e}`,c3=async e=>{let t=await(await fetch(e,{credentials:"same-origin"})).blob();return URL.createObjectURL(t)},Y8=async e=>(await import(e)).default,u3=(uPe(),sM(jre)).default,Ure=async()=>{if(!jd)throw new Error("Failed to load proxy worker: cannot determine the script source URL.");if(SP(jd))return[void 0,u3()];let e=await c3(jd);return[e,u3(e)]},d3=(dPe(),sM(Fre)).default,Vre=async(e,t,r)=>{if(!e&&!t&&d3&&jd&&SP(jd))return[void 0,d3];{let n="ort-wasm-simd-threaded.jsep.mjs",i=e??Z8(n,t),o=r&&i&&!SP(i,t),s=o?await c3(i):i??X8(n,t);return[o?s:void 0,await Y8(s)]}}}),h3,TP,yw,f3,Q8,J8,eU,gR,ka,L0=nn(()=>{mR(),TP=!1,yw=!1,f3=!1,Q8=()=>{if(typeof SharedArrayBuffer>"u")return!1;try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},J8=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},eU=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,19,1,17,0,65,1,253,15,65,2,253,15,65,3,253,15,253,147,2,11]))}catch{return!1}},gR=async e=>{if(TP)return Promise.resolve();if(yw)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(f3)throw new Error("previous call to 'initializeWebAssembly()' failed.");yw=!0;let t=e.initTimeout,r=e.numThreads;if(e.simd!==!1){if(e.simd==="relaxed"){if(!eU())throw new Error("Relaxed WebAssembly SIMD is not supported in the current environment.")}else if(!J8())throw new Error("WebAssembly SIMD is not supported in the current environment.")}let n=Q8();r>1&&!n&&(typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+r+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),console.warn("WebAssembly multi-threading is not supported in the current environment. Falling back to single-threading."),e.numThreads=r=1);let i=e.wasmPaths,o=typeof i=="string"?i:void 0,s=i==null?void 0:i.mjs,a=(s==null?void 0:s.href)??s,u=i==null?void 0:i.wasm,d=(u==null?void 0:u.href)??u,m=e.wasmBinary,[g,_]=await Vre(a,o,r>1),y=!1,M=[];if(t>0&&M.push(new Promise(x=>{setTimeout(()=>{y=!0,x()},t)})),M.push(new Promise((x,E)=>{let T={numThreads:r};if(m)T.wasmBinary=m;else if(d||o)T.locateFile=P=>d??o+P;else if(a&&a.indexOf("blob:")!==0)T.locateFile=P=>new URL(P,a).href;else if(g){let P=Bre();P&&(T.locateFile=C=>P+C)}_(T).then(P=>{yw=!1,TP=!0,h3=P,x(),g&&URL.revokeObjectURL(g)},P=>{yw=!1,f3=!0,E(P)})})),await Promise.race(M),y)throw new Error(`WebAssembly backend initializing failed due to timeout: ${t}ms`)},ka=()=>{if(TP&&h3)return h3;throw new Error("WebAssembly is not initialized yet.")}}),Of,IA,fa,_R=nn(()=>{L0(),Of=(e,t)=>{let r=ka(),n=r.lengthBytesUTF8(e)+1,i=r._malloc(n);return r.stringToUTF8(e,i,n),t.push(i),i},IA=(e,t,r,n)=>{if(typeof e=="object"&&e!==null){if(r.has(e))throw new Error("Circular reference in options");r.add(e)}Object.entries(e).forEach(([i,o])=>{let s=t?t+i:i;if(typeof o=="object")IA(o,s+".",r,n);else if(typeof o=="string"||typeof o=="number")n(s,o.toString());else if(typeof o=="boolean")n(s,o?"1":"0");else throw new Error(`Can't handle extra config type: ${typeof o}`)})},fa=e=>{let t=ka(),r=t.stackSave();try{let n=t.PTR_SIZE,i=t.stackAlloc(2*n);t._OrtGetLastError(i,i+n);let o=Number(t.getValue(i,n===4?"i32":"i64")),s=t.getValue(i+n,"*"),a=s?t.UTF8ToString(s):"";throw new Error(`${e} ERROR_CODE: ${o}, ERROR_MESSAGE: ${a}`)}finally{t.stackRestore(r)}}}),Wre,hPe=nn(()=>{L0(),_R(),Wre=e=>{let t=ka(),r=0,n=[],i=e||{};try{if((e==null?void 0:e.logSeverityLevel)===void 0)i.logSeverityLevel=2;else if(typeof e.logSeverityLevel!="number"||!Number.isInteger(e.logSeverityLevel)||e.logSeverityLevel<0||e.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${e.logSeverityLevel}`);if((e==null?void 0:e.logVerbosityLevel)===void 0)i.logVerbosityLevel=0;else if(typeof e.logVerbosityLevel!="number"||!Number.isInteger(e.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${e.logVerbosityLevel}`);(e==null?void 0:e.terminate)===void 0&&(i.terminate=!1);let o=0;return(e==null?void 0:e.tag)!==void 0&&(o=Of(e.tag,n)),r=t._OrtCreateRunOptions(i.logSeverityLevel,i.logVerbosityLevel,!!i.terminate,o),r===0&&fa("Can't create run options."),(e==null?void 0:e.extra)!==void 0&&IA(e.extra,"",new WeakSet,(s,a)=>{let u=Of(s,n),d=Of(a,n);t._OrtAddRunConfigEntry(r,u,d)!==0&&fa(`Can't set a run config entry: ${s} - ${a}.`)}),[r,n]}catch(o){throw r!==0&&t._OrtReleaseRunOptions(r),n.forEach(s=>t._free(s)),o}}}),tU,rU,nU,vw,iU,Gre,fPe=nn(()=>{L0(),_R(),tU=e=>{switch(e){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${e}`)}},rU=e=>{switch(e){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${e}`)}},nU=e=>{e.extra||(e.extra={}),e.extra.session||(e.extra.session={});let t=e.extra.session;t.use_ort_model_bytes_directly||(t.use_ort_model_bytes_directly="1"),e.executionProviders&&e.executionProviders.some(r=>(typeof r=="string"?r:r.name)==="webgpu")&&(e.enableMemPattern=!1)},vw=(e,t,r,n)=>{let i=Of(t,n),o=Of(r,n);ka()._OrtAddSessionConfigEntry(e,i,o)!==0&&fa(`Can't set a session config entry: ${t} - ${r}.`)},iU=async(e,t,r)=>{for(let n of t){let i=typeof n=="string"?n:n.name,o=[];switch(i){case"webnn":if(i="WEBNN",typeof n!="string"){let m=n==null?void 0:n.deviceType;m&&vw(e,"deviceType",m,r)}break;case"webgpu":if(i="JS",typeof n!="string"){let m=n;if(m!=null&&m.preferredLayout){if(m.preferredLayout!=="NCHW"&&m.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either 'NCHW' or 'NHWC': ${m.preferredLayout}`);vw(e,"preferredLayout",m.preferredLayout,r)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${i}`)}let s=Of(i,r),a=o.length,u=0,d=0;if(a>0){u=ka()._malloc(a*ka().PTR_SIZE),r.push(u),d=ka()._malloc(a*ka().PTR_SIZE),r.push(d);for(let m=0;m<a;m++)ka().setValue(u+m*ka().PTR_SIZE,o[m][0],"*"),ka().setValue(d+m*ka().PTR_SIZE,o[m][1],"*")}await ka()._OrtAppendExecutionProvider(e,s,u,d,a)!==0&&fa(`Can't append execution provider: ${i}.`)}},Gre=async e=>{let t=ka(),r=0,n=[],i=e||{};nU(i);try{let o=tU(i.graphOptimizationLevel??"all"),s=rU(i.executionMode??"sequential"),a=typeof i.logId=="string"?Of(i.logId,n):0,u=i.logSeverityLevel??2;if(!Number.isInteger(u)||u<0||u>4)throw new Error(`log serverity level is not valid: ${u}`);let d=i.logVerbosityLevel??0;if(!Number.isInteger(d)||d<0||d>4)throw new Error(`log verbosity level is not valid: ${d}`);let m=typeof i.optimizedModelFilePath=="string"?Of(i.optimizedModelFilePath,n):0;if(r=t._OrtCreateSessionOptions(o,!!i.enableCpuMemArena,!!i.enableMemPattern,s,!!i.enableProfiling,0,a,u,d,m),r===0&&fa("Can't create session options."),i.executionProviders&&await iU(r,i.executionProviders,n),i.enableGraphCapture!==void 0){if(typeof i.enableGraphCapture!="boolean")throw new Error(`enableGraphCapture must be a boolean value: ${i.enableGraphCapture}`);vw(r,"enableGraphCapture",i.enableGraphCapture.toString(),n)}if(i.freeDimensionOverrides)for(let[g,_]of Object.entries(i.freeDimensionOverrides)){if(typeof g!="string")throw new Error(`free dimension override name must be a string: ${g}`);if(typeof _!="number"||!Number.isInteger(_)||_<0)throw new Error(`free dimension override value must be a non-negative integer: ${_}`);let y=Of(g,n);t._OrtAddFreeDimensionOverride(r,y,_)!==0&&fa(`Can't set a free dimension override: ${g} - ${_}.`)}return i.extra!==void 0&&IA(i.extra,"",new WeakSet,(g,_)=>{vw(r,g,_,n)}),[r,n]}catch(o){throw r!==0&&t._OrtReleaseSessionOptions(r)!==0&&fa("Can't release session options."),n.forEach(s=>t._free(s)),o}}}),Nv,km,Sy,yR,OA,vR,bR,zD,yi=nn(()=>{Nv=e=>{switch(e){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;case"int4":return 22;case"uint4":return 21;default:throw new Error(`unsupported data type: ${e}`)}},km=e=>{switch(e){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";case 22:return"int4";case 21:return"uint4";default:throw new Error(`unsupported data type: ${e}`)}},Sy=(e,t)=>{let r=[-1,4,1,1,2,2,4,8,-1,1,2,8,4,8,-1,-1,-1,-1,-1,-1,-1,.5,.5][e],n=typeof t=="number"?t:t.reduce((i,o)=>i*o,1);return r>0?Math.ceil(n*r):void 0},yR=e=>{switch(e){case"float16":return typeof Float16Array<"u"&&Float16Array.from?Float16Array:Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${e}`)}},OA=e=>{switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${e}`)}},vR=e=>e==="float32"||e==="float16"||e==="int32"||e==="int64"||e==="uint32"||e==="uint8"||e==="bool"||e==="uint4"||e==="int4",bR=e=>e==="float32"||e==="float16"||e==="int32"||e==="int64"||e==="uint32"||e==="uint64"||e==="int8"||e==="uint8"||e==="bool"||e==="uint4"||e==="int4",zD=e=>{switch(e){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;case"ml-tensor":return 5;default:throw new Error(`unsupported data location: ${e}`)}}}),xR,qre=nn(()=>{pR(),xR=async e=>{if(typeof e=="string"){let t=await fetch(e);if(!t.ok)throw new Error(`failed to load external data file: ${e}`);let r=t.headers.get("Content-Length"),n=r?parseInt(r,10):0;if(n<1073741824)return new Uint8Array(await t.arrayBuffer());{if(!t.body)throw new Error(`failed to load external data file: ${e}, no response body.`);let i=t.body.getReader(),o;try{o=new ArrayBuffer(n)}catch(a){if(a instanceof RangeError){let u=Math.ceil(n/65536);o=new WebAssembly.Memory({initial:u,maximum:u}).buffer}else throw a}let s=0;for(;;){let{done:a,value:u}=await i.read();if(a)break;let d=u.byteLength;new Uint8Array(o,s,d).set(u),s+=d}return new Uint8Array(o,0,n)}}else return e instanceof Blob?new Uint8Array(await e.arrayBuffer()):e instanceof Uint8Array?e:new Uint8Array(e)}}),oU,aU,sU,lU,wR,cU,Do,eg=nn(()=>{yi(),oU=["V","I","W","E","F"],aU=(e,t)=>{console.log(`[${oU[e]},${new Date().toISOString()}]${t}`)},wR=(e,t)=>{sU=e,lU=t},cU=(e,t)=>{let r=OA(e),n=OA(sU);r>=n&&aU(r,typeof t=="function"?t():t)},Do=(...e)=>{lU&&cU(...e)}}),uU,Y1,br,LA,Hre,Kre,Zre,ji=nn(()=>{uU=class{static calcMatMulShape(e,t){return e[1]!==t[0]?void 0:[e[0],t[1]]}},Y1=class{static calcShape(e,t,r=!1){let n=e.length,i=t.length;if(n===0)return t;if(i===0)return e;let o=Math.max(e.length,t.length),s=new Array(o);if(r){if(n<2||i<2)return;let a=uU.calcMatMulShape([e[n-2],e[n-1]],[t[i-2],t[i-1]]);if(a===void 0)return;[s[o-2],s[o-1]]=a}for(let a=r?3:1;a<=o;a++){let u=n-a<0?1:e[n-a],d=i-a<0?1:t[i-a];if(u!==d&&u>1&&d>1)return;let m=Math.max(u,d);if(u&&d)s[o-a]=Math.max(u,d);else{if(m>1)return;s[o-a]=0}}return s}static isValidBroadcast(e,t){let r=e.length,n=t.length;if(r>n)return!1;for(let i=1;i<=r;i++)if(e[r-i]!==1&&e[r-i]!==t[n-i])return!1;return!0}},br=class LE{static size(t){return LE.getSizeFromDimensionRange(t,0,t.length)}static convertShape(t,r=4){let n=t.length;if(n===0)return[];let i=new Array(n),o=n-1;for(;o>=0;){if(t[o]%r===0){i[o]=t[o]/r;break}if(r%t[o]!==0)throw new Error("cannot convert shape");i[o]=1,r/=t[o],o--}for(o--;o>=0;o--)i[o]=t[o];return i}static sizeFromDimension(t,r){if(r<0||r>t.length)throw new Error(`invalid dimension of ${r} for sizeFromDimension as Tensor has ${t.length} dimensions.`);return LE.getSizeFromDimensionRange(t,r,t.length)}static sizeToDimension(t,r){if(r<0||r>t.length)throw new Error(`invalid dimension of ${r} for sizeToDimension as Tensor has ${t.length} dimensions.`);return LE.getSizeFromDimensionRange(t,0,r)}static getSizeFromDimensionRange(t,r,n){let i=1;for(let o=r;o<n;o++){if(t[o]<0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains negative values in them.");i*=Number(t[o])}return i}static computeStrides(t){let r=t.length;if(r===0)return[];if(r===1)return[1];let n=new Array(r);n[r-1]=1,n[r-2]=t[r-1];for(let i=r-3;i>=0;--i)n[i]=n[i+1]*t[i+1];return n}static normalizeAxis(t,r){if(t<-r&&t>=r)throw new Error("unsupported axis for this operation.");return t<0?t+r:t}static normalizeAxes(t,r){return t.map(n=>this.normalizeAxis(n,r??t.length))}static sortBasedOnPerm(t,r){return r?r.map(n=>t[n]):t.slice().reverse()}static padShape(t,r){let n=t.length;return t.map((i,o)=>i+r[o]+r[o+n])}static areEqual(t,r){return t.length!==r.length?!1:t.every((n,i)=>n===r[i])}},LA=class Kw{static adjustPoolAttributes(t,r,n,i,o,s){if(!t&&n.length!==r.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(t)for(let a=0;a<r.length-2;a++)a>=n.length?n.push(r[a+2]):n[a]=r[a+2];for(let a=0;a<n.length;a++)if(a<i.length){if(i[a]<0)throw new Error("strides should be greater than or equal to 1")}else i.push(1);for(let a=0;a<n.length;a++)if(a<o.length){if(o[a]<0)throw new Error("dilations should be greater than or equal to 1")}else o.push(1);for(let a=0;a<n.length*2;a++)if(a<s.length){if(s[a]<0)throw new Error("pad should be greater than or equal to 1")}else s.push(0);for(let a=0;a<n.length;a++){if(n[a]<=0)throw new Error("kernel shapes need to be greater than 0");if(s[a]>=n[a]||s[a+n.length]>=n[a])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(t,r,n,i,o,s,a){if(a){if(o.length!==2*(t.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(r.length!==t.length-2)throw new Error("length of strides should be the length of data dimensions");if(i.length!==t.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let u=0;u<t.length-2;u++)Kw.adjustPadAndReturnShape(t[u+(s?1:2)],r[u],n[u],i[u],o,u,u+t.length-2,a)}}static computePoolOutputShape(t,r,n,i,o,s,a){if(r.length<=0)throw new Error("input shape must be of size greater than 0");let u=[r[0],r[1]];return Kw.computeShapeHelper(t,r,u,n,i,o,s,a),u}static computeConvOutputShape(t,r,n,i,o,s,a){if(t.length<=0||r.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");let u=[t[0],r[0]];return Kw.computeShapeHelper(!1,t,u,n,i,o,s,a),u}static computeShapeHelper(t,r,n,i,o,s,a,u){if(t)for(let d=0;d<r.length-2;d++)n.push(1);else for(let d=0;d<r.length-2;d++)n.push(Kw.adjustPadAndReturnShape(r[d+2],i[d],o[d],s[d],a,d,d+r.length-2,u))}static adjustPadAndReturnShape(t,r,n,i,o,s,a,u){let d=n*(i-1)+1;if(u&&u!=="NOTSET")switch(u){case"VALID":return o[s]=0,o[a]=0,Math.floor((t-d)/r+1);case"SAME_LOWER":case"SAME_UPPER":if(n!==1)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{let m=((t+r-1)/r-1)*r+i-t;return o[s]=Math.floor(u==="SAME_LOWER"?(m+1)/2:m/2),o[a]=m-o[s],Math.floor((t+m-i)/r+1)}default:throw new Error("Unsupported AutoPad type")}else return Math.floor((t+o[s]+o[a]-d)/r+1)}},Hre=class{static getShapeOfGemmResult(e,t,r,n,i){if(e.length!==2||r.length!==2)throw new Error("shape need to be of size 2");let o,s,a;t?(o=e[1],s=e[0]):(o=e[0],s=e[1]);let u=-1;if(n?(a=r[0],u=1):(a=r[1],u=0),r[u]!==s)throw new Error("dimension mismatch");if(o<=0||a<=0||s<=0)throw new Error("invalid shape specified");if(i&&!Y1.isValidBroadcast(i,[o,a]))throw new Error("gemm: invalid bias shape for broadcast");return[o,a,s]}},Kre=-34028234663852886e22,Zre=34028234663852886e22}),MR,Xre=nn(()=>{yi(),MR=(e,t)=>new(yR(t))(e)}),BD,p3,dU,m3,hU,g3,_3,y3,fU,Yre,pPe=nn(()=>{eg(),BD=(e,t=!0)=>{if(e.byteLength%8!==0)throw new Error("Invalid Uint8Array length - must be a multiple of 8 (BigInt).");let r=e.byteLength/8,n=new BigInt64Array(e.buffer,e.byteOffset,r),i=new Int32Array(r);for(let o=0;o<r;o++){let s=n[o];if(s>2147483647n||s<-2147483648n)throw new Error(`Overflow occurred when converting BigInt to Int32 at index ${o}: ${s}`);i[o]=Number(s)}return t?new Uint8Array(i.buffer):i},p3=(e,t=!0)=>{if(e.byteLength%4!==0)throw new Error("Invalid Uint8Array length - must be a multiple of 4 (Int32).");let r=e.byteLength/4,n=new Int32Array(e.buffer,e.byteOffset,r),i=BigInt64Array.from(n,BigInt);return t?new Uint8Array(i.buffer):i},dU=1,m3=()=>dU++,hU=new Map([["float32",32],["float16",16],["int32",32],["uint32",32],["int64",64],["uint64",64],["int8",8],["uint8",8],["int4",4],["uint4",4]]),g3=(e,t)=>{let r=hU.get(e);if(!r)throw new Error("Unsupported data type.");return t.length>0?Math.ceil(t.reduce((n,i)=>n*i)*r/8):0},_3=class{constructor(e){this.shouldConvertInt64toInt32=!1,this.isInt64ToInt32Converted=!1;let{sessionId:t,context:r,tensor:n,dataType:i,shape:o,shouldConvertInt64toInt32:s=!1}=e;this.sessionId=t,this.mlContext=r,this.mlTensor=n,this.dataType=i,this.tensorShape=o,this.shouldConvertInt64toInt32=s}get tensor(){return this.mlTensor}get type(){return this.dataType}get shape(){return this.tensorShape}get byteLength(){return g3(this.dataType,this.tensorShape)}destroy(){Do("verbose",()=>"[WebNN] TensorWrapper.destroy"),this.mlTensor.destroy()}write(e){this.mlContext.writeTensor(this.mlTensor,e)}async read(e,t){if(e){let r=await this.mlContext.readTensor(this.mlTensor),n=p3(new Uint8Array(r));if(t){(t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)).set(n);return}else return n.buffer}else return t?this.mlContext.readTensor(this.mlTensor,t):this.mlContext.readTensor(this.mlTensor)}canReuseTensor(e,t,r){return this.mlContext===e&&this.dataType===t&&this.tensorShape.length===r.length&&this.tensorShape.every((n,i)=>n===r[i])}setIsInt64ToInt32Converted(e){this.isInt64ToInt32Converted=e}},y3=class{constructor(e,t){this.tensorManager=e,this.wrapper=t}get tensorWrapper(){return this.wrapper}releaseTensor(){this.tensorWrapper&&(this.tensorManager.releaseTensor(this.tensorWrapper),this.wrapper=void 0)}async ensureTensor(e,t,r,n){let i=t,o=this.tensorManager.getMLContext(e),s=i==="int64"&&!o.opSupportLimits().input.dataTypes.includes("int64");if(s&&(i="int32",Do("verbose",()=>"[WebNN] TensorIdTracker.ensureTensor: convert dataType from int64 to int32")),this.wrapper){if(this.wrapper.canReuseTensor(o,i,r))return this.wrapper.tensor;if(n){if(this.wrapper.byteLength!==g3(i,r))throw new Error("Unable to copy data to tensor with different size.");this.activeUpload=new Uint8Array(await this.wrapper.read())}this.tensorManager.releaseTensor(this.wrapper)}let a=typeof MLTensorUsage>"u"?void 0:MLTensorUsage.READ|MLTensorUsage.WRITE;return this.wrapper=await this.tensorManager.getCachedTensor(e,i,r,a,!0,!0,s),n&&this.activeUpload&&(this.wrapper.write(this.activeUpload),this.activeUpload=void 0),this.wrapper.tensor}upload(e){let t=e;if(this.wrapper)if(this.wrapper.shouldConvertInt64toInt32&&(t=BD(e,!0),this.wrapper.setIsInt64ToInt32Converted(!0)),t.byteLength===this.wrapper.byteLength){this.wrapper.write(t);return}else Do("verbose",()=>"Data size does not match tensor size. Releasing tensor."),this.releaseTensor();this.activeUpload?this.activeUpload.set(t):this.activeUpload=new Uint8Array(t)}async download(e){var t,r,n;if(this.activeUpload){let i=(t=this.wrapper)!=null&&t.isInt64ToInt32Converted?p3(this.activeUpload):this.activeUpload;if(e){e instanceof ArrayBuffer?new Uint8Array(e).set(i):new Uint8Array(e.buffer,e.byteOffset,e.byteLength).set(i);return}else return i.buffer}if(!this.wrapper)throw new Error("Tensor has not been created.");return e?this.wrapper.read((r=this.wrapper)==null?void 0:r.shouldConvertInt64toInt32,e):this.wrapper.read((n=this.wrapper)==null?void 0:n.shouldConvertInt64toInt32)}},fU=class{constructor(e){this.backend=e,this.tensorTrackersById=new Map,this.freeTensors=[],this.externalTensors=new Set}getMLContext(e){let t=this.backend.getMLContext(e);if(!t)throw new Error("MLContext not found for session.");return t}reserveTensorId(){let e=m3();return this.tensorTrackersById.set(e,new y3(this)),e}releaseTensorId(e){let t=this.tensorTrackersById.get(e);t&&(this.tensorTrackersById.delete(e),t.tensorWrapper&&this.releaseTensor(t.tensorWrapper))}async ensureTensor(e,t,r,n,i){Do("verbose",()=>`[WebNN] TensorManager.ensureTensor {tensorId: ${t}, dataType: ${r}, shape: ${n}, copyOld: ${i}}`);let o=this.tensorTrackersById.get(t);if(!o)throw new Error("Tensor not found.");return o.ensureTensor(e,r,n,i)}upload(e,t){let r=this.tensorTrackersById.get(e);if(!r)throw new Error("Tensor not found.");r.upload(t)}async download(e,t){Do("verbose",()=>`[WebNN] TensorManager.download {tensorId: ${e}, dstBuffer: ${t==null?void 0:t.byteLength}}`);let r=this.tensorTrackersById.get(e);if(!r)throw new Error("Tensor not found.");return r.download(t)}releaseTensorsForSession(e){for(let t of this.freeTensors)t.sessionId===e&&t.destroy();this.freeTensors=this.freeTensors.filter(t=>t.sessionId!==e)}registerTensor(e,t,r,n){let i=this.getMLContext(e),o=m3(),s=new _3({sessionId:e,context:i,tensor:t,dataType:r,shape:n});return this.tensorTrackersById.set(o,new y3(this,s)),this.externalTensors.add(s),o}async getCachedTensor(e,t,r,n,i,o,s=!1){let a=this.getMLContext(e);for(let[d,m]of this.freeTensors.entries())if(m.canReuseTensor(a,t,r)){Do("verbose",()=>`[WebNN] Reusing tensor {dataType: ${t}, shape: ${r}}`);let g=this.freeTensors.splice(d,1)[0];return g.sessionId=e,g}Do("verbose",()=>`[WebNN] MLContext.createTensor {dataType: ${t}, shape: ${r}}`);let u=await a.createTensor({dataType:t,shape:r,dimensions:r,usage:n,writable:i,readable:o});return new _3({sessionId:e,context:a,tensor:u,dataType:t,shape:r,shouldConvertInt64toInt32:s})}releaseTensor(e){this.externalTensors.has(e)&&this.externalTensors.delete(e),this.freeTensors.push(e)}},Yre=(...e)=>new fU(...e)}),PP,pU,Qre,mPe=nn(()=>{yi(),L0(),Xre(),pPe(),eg(),PP=new Map([[1,"float32"],[10,"float16"],[6,"int32"],[12,"uint32"],[7,"int64"],[13,"uint64"],[22,"int4"],[21,"uint4"],[3,"int8"],[2,"uint8"],[9,"uint8"]]),pU=(e,t)=>{if(e===t)return!0;if(e===void 0||t===void 0)return!1;let r=Object.keys(e).sort(),n=Object.keys(t).sort();return r.length===n.length&&r.every((i,o)=>i===n[o]&&e[i]===t[i])},Qre=class{constructor(e){this.tensorManager=Yre(this),this.mlContextBySessionId=new Map,this.sessionIdsByMLContext=new Map,this.mlContextCache=[],this.sessionGraphInputs=new Map,this.temporaryGraphInputs=[],this.temporarySessionTensorIds=new Map,wR(e.logLevel,!!e.debug)}get currentSessionId(){if(this.activeSessionId===void 0)throw new Error("No active session");return this.activeSessionId}onRunStart(e){Do("verbose",()=>`[WebNN] onRunStart {sessionId: ${e}}`),this.activeSessionId=e}onRunEnd(e){Do("verbose",()=>`[WebNN] onRunEnd {sessionId: ${e}}`);let t=this.temporarySessionTensorIds.get(e);if(t){for(let r of t)Do("verbose",()=>`[WebNN] releasing temporary tensor {tensorId: ${r}}`),this.tensorManager.releaseTensorId(r);this.temporarySessionTensorIds.delete(e),this.activeSessionId=void 0}}async createMLContext(e){if(e instanceof GPUDevice){let r=this.mlContextCache.findIndex(n=>n.gpuDevice===e);if(r!==-1)return this.mlContextCache[r].mlContext;{let n=await navigator.ml.createContext(e);return this.mlContextCache.push({gpuDevice:e,mlContext:n}),n}}else if(e===void 0){let r=this.mlContextCache.findIndex(n=>n.options===void 0&&n.gpuDevice===void 0);if(r!==-1)return this.mlContextCache[r].mlContext;{let n=await navigator.ml.createContext();return this.mlContextCache.push({mlContext:n}),n}}let t=this.mlContextCache.findIndex(r=>pU(r.options,e));if(t!==-1)return this.mlContextCache[t].mlContext;{let r=await navigator.ml.createContext(e);return this.mlContextCache.push({options:e,mlContext:r}),r}}registerMLContext(e,t){this.mlContextBySessionId.set(e,t);let r=this.sessionIdsByMLContext.get(t);r||(r=new Set,this.sessionIdsByMLContext.set(t,r)),r.add(e),this.temporaryGraphInputs.length>0&&(this.sessionGraphInputs.set(e,this.temporaryGraphInputs),this.temporaryGraphInputs=[])}onReleaseSession(e){this.sessionGraphInputs.delete(e);let t=this.mlContextBySessionId.get(e);if(!t)return;this.tensorManager.releaseTensorsForSession(e),this.mlContextBySessionId.delete(e);let r=this.sessionIdsByMLContext.get(t);if(r.delete(e),r.size===0){this.sessionIdsByMLContext.delete(t);let n=this.mlContextCache.findIndex(i=>i.mlContext===t);n!==-1&&this.mlContextCache.splice(n,1)}}getMLContext(e){return this.mlContextBySessionId.get(e)}reserveTensorId(){return this.tensorManager.reserveTensorId()}releaseTensorId(e){Do("verbose",()=>`[WebNN] releaseTensorId {tensorId: ${e}}`),this.tensorManager.releaseTensorId(e)}async ensureTensor(e,t,r,n,i){let o=PP.get(r);if(!o)throw new Error(`Unsupported ONNX data type: ${r}`);return this.tensorManager.ensureTensor(e??this.currentSessionId,t,o,n,i)}async createTemporaryTensor(e,t,r){Do("verbose",()=>`[WebNN] createTemporaryTensor {onnxDataType: ${t}, shape: ${r}}`);let n=PP.get(t);if(!n)throw new Error(`Unsupported ONNX data type: ${t}`);let i=this.tensorManager.reserveTensorId();await this.tensorManager.ensureTensor(e,i,n,r,!1);let o=this.temporarySessionTensorIds.get(e);return o?o.push(i):this.temporarySessionTensorIds.set(e,[i]),i}uploadTensor(e,t){if(!ka().shouldTransferToMLTensor)throw new Error("Trying to upload to a MLTensor while shouldTransferToMLTensor is false");Do("verbose",()=>`[WebNN] uploadTensor {tensorId: ${e}, data: ${t.byteLength}}`),this.tensorManager.upload(e,t)}async downloadTensor(e,t){return this.tensorManager.download(e,t)}createMLTensorDownloader(e,t){return async()=>{let r=await this.tensorManager.download(e);return MR(r,t)}}registerMLTensor(e,t,r,n){let i=PP.get(r);if(!i)throw new Error(`Unsupported ONNX data type: ${r}`);let o=this.tensorManager.registerTensor(e,t,i,n);return Do("verbose",()=>`[WebNN] registerMLTensor {tensor: ${t}, dataType: ${i}, dimensions: ${n}} -> {tensorId: ${o}}`),o}registerMLConstant(e,t,r,n,i,o,s=!1){if(!o)throw new Error("External mounted files are not available.");let a=e;e.startsWith("./")&&(a=e.substring(2));let u=o.get(a);if(!u)throw new Error(`File with name ${a} not found in preloaded files.`);if(t+r>u.byteLength)throw new Error("Out of bounds: data offset and length exceed the external file data size.");let d=u.slice(t,t+r).buffer,m;switch(i.dataType){case"float32":m=new Float32Array(d);break;case"float16":m=typeof Float16Array<"u"&&Float16Array.from?new Float16Array(d):new Uint16Array(d);break;case"int32":m=new Int32Array(d);break;case"uint32":m=new Uint32Array(d);break;case"int64":s?(m=BD(new Uint8Array(d),!1),i.dataType="int32"):m=new BigInt64Array(d);break;case"uint64":m=new BigUint64Array(d);break;case"int8":m=new Int8Array(d);break;case"int4":case"uint4":case"uint8":m=new Uint8Array(d);break;default:throw new Error(`Unsupported data type: ${i.dataType} in creating WebNN Constant from external data.`)}return Do("verbose",()=>`[WebNN] registerMLConstant {dataType: ${i.dataType}, shape: ${i.shape}}} ${s?"(Note: it was int64 data type and registered to int32 as workaround)":""}`),n.constant(i,m)}registerGraphInput(e){this.temporaryGraphInputs.push(e)}isGraphInput(e,t){let r=this.sessionGraphInputs.get(e);return r?r.includes(t):!1}isInt64Supported(e){var t;return!!((t=this.mlContextBySessionId.get(e))!=null&&t.opSupportLimits().input.dataTypes.includes("int64"))}flush(){}}}),SR=nn(()=>{}),v3,EP,AP,mU,gU,b3,UD,_U,Jre,gPe=nn(()=>{eg(),SR(),v3=new Map([[64,250],[128,200],[256,200],[512,200],[2048,230],[4096,200],[8192,50],[16384,50],[32768,50],[65536,50],[131072,50],[262144,50],[524288,50],[1048576,50],[2097152,30],[4194304,20],[8388608,10],[12582912,10],[16777216,10],[26214400,15],[33554432,22],[44236800,2],[58982400,6],[67108864,6],[134217728,6],[167772160,6]]),EP=[],AP=e=>Math.ceil(Number(e)/16)*16,mU=e=>{for(let t=0;t<EP.length;t++){let r=EP[t];if(e<=r)return r}return Math.ceil(e/16)*16},gU=1,b3=()=>gU++,UD=async(e,t,r,n)=>{let i=AP(r),o=e.device.createBuffer({size:i,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});try{let s=e.getCommandEncoder();e.endComputePass(),s.copyBufferToBuffer(t,0,o,0,i),e.flush(),await o.mapAsync(GPUMapMode.READ);let a=o.getMappedRange();if(n){let u=n();return u.set(new Uint8Array(a,0,r)),u}else return new Uint8Array(a.slice(0,r))}finally{o.destroy()}},_U=class{constructor(e){this.backend=e,this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.buffersPending=[],this.capturedPendingBuffers=new Map;for(let[t]of v3)EP.push(t),this.freeBuffers.set(t,[]),this.freeUniformBuffers.set(t,[]);this.sessionCount=0}upload(e,t){let r=t.buffer,n=t.byteOffset,i=t.byteLength,o=AP(i),s=this.storageCache.get(e);if(!s)throw new Error("gpu data for uploading does not exist");if(Number(s.originalSize)!==i)throw new Error(`inconsistent data size. gpu data size=${s.originalSize}, data size=${i}`);let a=this.backend.device.createBuffer({mappedAtCreation:!0,size:o,usage:GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC}),u=a.getMappedRange();new Uint8Array(u).set(new Uint8Array(r,n,i)),a.unmap();let d=this.backend.device.createCommandEncoder();d.copyBufferToBuffer(a,0,s.gpuData.buffer,0,o),this.backend.device.queue.submit([d.finish()]),a.destroy(),Do("verbose",()=>`[WebGPU] GpuDataManager.upload(id=${e})`)}memcpy(e,t){let r=this.storageCache.get(e);if(!r)throw new Error("source gpu data for memcpy does not exist");let n=this.storageCache.get(t);if(!n)throw new Error("destination gpu data for memcpy does not exist");if(r.originalSize!==n.originalSize)throw new Error("inconsistent source and destination gpu data size");let i=AP(r.originalSize),o=this.backend.getCommandEncoder();this.backend.endComputePass(),o.copyBufferToBuffer(r.gpuData.buffer,0,n.gpuData.buffer,0,i)}registerExternalBuffer(e,t,r){let n;if(r){if(n=r[0],e===r[1])return Do("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${t}) => id=${n}, buffer is the same, skip.`),n;if(this.backend.capturedCommandList.has(this.backend.currentSessionId))throw new Error(`Registering a different external buffer under graph capture mode is not supported yet.
             Please use the previous external buffer!`)}else n=b3();return this.storageCache.set(n,{gpuData:{id:n,type:0,buffer:e},originalSize:t}),Do("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${t}) => id=${n}, registered.`),n}unregisterExternalBuffer(e){e!==void 0&&(this.storageCache.delete(e),Do("verbose",()=>`[WebGPU] GpuDataManager.unregisterExternalBuffer() => id=${e}`))}create(e,t=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST){let r=mU(e),n,i=(t&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE,o=(t&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM;if(i||o){let a=(i?this.freeBuffers:this.freeUniformBuffers).get(r);a?a.length>0?n=a.pop():n=this.backend.device.createBuffer({size:r,usage:t}):n=this.backend.device.createBuffer({size:r,usage:t})}else n=this.backend.device.createBuffer({size:r,usage:t});let s={id:b3(),type:0,buffer:n};return this.storageCache.set(s.id,{gpuData:s,originalSize:Number(e)}),Do("verbose",()=>`[WebGPU] GpuDataManager.create(size=${e}) => id=${s.id}`),s}get(e){var t;return(t=this.storageCache.get(e))==null?void 0:t.gpuData}release(e){let t=typeof e=="bigint"?Number(e):e,r=this.storageCache.get(t);if(!r){if(this.storageCache.size===0)return 0;throw new Error("releasing data does not exist")}return Do("verbose",()=>`[WebGPU] GpuDataManager.release(id=${t}), gpuDataId=${r.gpuData.id}`),this.storageCache.delete(t),this.buffersPending.push(r.gpuData.buffer),r.originalSize}async download(e,t){let r=this.storageCache.get(Number(e));if(!r)throw new Error("data does not exist");await UD(this.backend,r.gpuData.buffer,r.originalSize,t)}refreshPendingBuffers(){if(this.buffersPending.length!==0)if(this.backend.sessionStatus==="default"){for(let e of this.buffersPending){let t=v3.get(e.size);if((e.usage&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE){let r=this.freeBuffers.get(e.size)||[];t===void 0||r.length>=t?e.destroy():r.push(e)}else if((e.usage&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM){let r=this.freeUniformBuffers.get(e.size)||[];t===void 0||r.length>=t?e.destroy():r.push(e)}else e.destroy()}this.buffersPending=[]}else{let e=this.capturedPendingBuffers.get(this.backend.currentSessionId);e||(e=[],this.capturedPendingBuffers.set(this.backend.currentSessionId,e));for(let t of this.buffersPending)e.push(t);this.buffersPending=[]}}dispose(){this.freeBuffers.forEach(e=>{e.forEach(t=>{t.destroy()})}),this.freeUniformBuffers.forEach(e=>{e.forEach(t=>{t.destroy()})}),this.storageCache.forEach(e=>{e.gpuData.buffer.destroy()}),this.capturedPendingBuffers.forEach(e=>{e.forEach(t=>{t.destroy()})}),this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.capturedPendingBuffers=new Map}onCreateSession(){this.sessionCount+=1}onReleaseSession(e){let t=this.capturedPendingBuffers.get(e);t&&(t.forEach(r=>{r.destroy()}),this.capturedPendingBuffers.delete(e)),this.sessionCount-=1,this.sessionCount===0&&(Do("warning",()=>"[WebGPU] Clearing webgpu buffer cache"),this.storageCache.forEach(r=>{r.gpuData.buffer.destroy()}),this.storageCache=new Map)}},Jre=(...e)=>new _U(...e)}),yU,Jo,Zs=nn(()=>{yU=class{constructor(e){Object.assign(this,e)}get cacheKey(){return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map(e=>`${this[e]}`).join(";")),this.key}},Jo=e=>new yU(e)}),Q1,CP,mc,Mu,Kn,Os,VD,i1,E_,Wn,bw,kr,Fn,ene,TR,vU,tne,Bi=nn(()=>{yi(),ji(),Q1=64,CP=(e,t)=>{if(t===3)throw new Error("vec3 has same alignment as vec4, use vec4 instead");switch(Number(e)){case 10:return t>1?`vec${t}<f16>`:"f16";case 1:return t>1?`vec${t}<f32>`:"f32";case 6:return t>1?`vec${t}<i32>`:"i32";case 12:return t>1?`vec${t}<u32>`:"u32";case 7:if(t>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","i32"];case 13:if(t>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","u32"];case 9:if(t!==4)throw new Error("bool must be vec4");return["u32","vec4<bool>"];case 22:return"i32";case 21:return"u32";default:throw new Error(`Unknown data type: ${e}`)}},mc=(e,t=1)=>{let r=CP(e,t);return typeof r=="string"?r:r[0]},Mu=(e,t=1)=>{let r=CP(e,t);return typeof r=="string"?r:r[1]},Kn=(...e)=>{let t=[];return e.forEach(r=>{r.length!==0&&t.push({type:12,data:r},{type:12,data:br.computeStrides(r)})}),t},Os=e=>e%4===0?4:e%2===0?2:1,VD=(e="f32",t,r="0")=>!t||t===1?`${e}(${r})`:`vec${t}<${e}>(${r})`,i1=(e,t,r)=>e==="f32"?r:t===1?`f32(${r})`:`vec${t}<f32>(${r})`,E_=(e,t)=>t===4?`(${e}.x + ${e}.y + ${e}.z + ${e}.w)`:t===2?`(${e}.x + ${e}.y)`:t===3?`(${e}.x + ${e}.y + ${e}.z)`:e,Wn=(e,t,r,n)=>e.startsWith("uniforms.")&&r>4?typeof t=="string"?n==="f16"?`${e}[(${t}) / 8][(${t}) % 8 / 4][(${t}) % 8 % 4]`:`${e}[(${t}) / 4][(${t}) % 4]`:n==="f16"?`${e}[${Math.floor(t/8)}][${Math.floor(t%8/4)}][${t%8%4}]`:`${e}[${Math.floor(t/4)}][${t%4}]`:r>1?`${e}[${t}]`:e,bw=(e,t,r,n,i)=>{let o=typeof r=="number",s=o?r:r.length,a=[...new Array(s).keys()],u=s<2?"u32":s<=4?`vec${s}<u32>`:`array<u32, ${s}>`,d=CP(t,i),m=typeof d=="string"?d:d[1],g=typeof d=="string"?d:d[0],_={indices:u,value:m,storage:g,tensor:t},y=pe=>typeof pe=="string"?pe:`${pe}u`,M={offsetToIndices:!1,indicesToOffset:!1,broadcastedIndicesToOffset:!1,set:!1,setByIndices:!1,get:!1,getByIndices:!1},x=o?"uniforms.":"",E=`${x}${e}_shape`,T=`${x}${e}_strides`,P="";for(let pe=0;pe<s-1;pe++)P+=`
    let dim${pe} = current / ${Wn(T,pe,s)};
    let rest${pe} = current % ${Wn(T,pe,s)};
    indices[${pe}] = dim${pe};
    current = rest${pe};
    `;P+=`indices[${s-1}] = current;`;let C=s<2?"":`
  fn o2i_${e}(offset: u32) -> ${_.indices} {
    var indices: ${_.indices};
    var current = offset;
    ${P}
    return indices;
  }`,D=pe=>(M.offsetToIndices=!0,s<2?pe:`o2i_${e}(${pe})`),L=[];if(s>=2)for(let pe=s-1;pe>=0;pe--)L.push(`${Wn(T,pe,s)} * (indices[${pe}])`);let N=s<2?"":`
  fn i2o_${e}(indices: ${_.indices}) -> u32 {
    return ${L.join("+")};
  }`,j=pe=>(M.indicesToOffset=!0,s<2?pe:`i2o_${e}(${pe})`),$=(...pe)=>s===0?"0u":`${_.indices}(${pe.map(y).join(",")})`,U=(pe,K)=>s<2?`${pe}`:`${Wn(pe,K,s)}`,G=(pe,K,te)=>s<2?`${pe}=${te};`:`${Wn(pe,K,s)}=${te};`,H={},X=(pe,K)=>{M.broadcastedIndicesToOffset=!0;let te=`${K.name}broadcastedIndicesTo${e}Offset`;if(te in H)return`${te}(${pe})`;let ve=[];for(let $e=s-1;$e>=0;$e--){let Ce=K.indicesGet("outputIndices",$e+K.rank-s);ve.push(`${U(T,$e)} * (${Ce} % ${U(E,$e)})`)}return H[te]=`fn ${te}(outputIndices: ${K.type.indices}) -> u32 {
             return ${ve.length>0?ve.join("+"):"0u"};
           }`,`${te}(${pe})`},ee=(pe,K)=>(()=>{if(_.storage===_.value)return`${e}[${pe}]=${K};`;if(_.storage==="vec2<u32>"&&_.value==="i32")return`${e}[${pe}]=vec2<u32>(u32(${K}), select(0u, 0xFFFFFFFFu, ${K} < 0));`;if(_.storage==="vec2<u32>"&&_.value==="u32")return`${e}[${pe}]=vec2<u32>(u32(${K}), 0u);`;if(_.storage==="u32"&&_.value==="vec4<bool>")return`${e}[${pe}]=dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(${K}));`;throw new Error(`not supported combination of storage type ${_.storage} and value type ${_.value} yet`)})(),ae=pe=>(()=>{if(_.storage===_.value)return`${e}[${pe}]`;if(_.storage==="vec2<u32>"&&_.value==="i32")return`i32(${e}[${pe}].x)`;if(_.storage==="vec2<u32>"&&_.value==="u32")return`u32(${e}[${pe}].x)`;if(_.storage==="u32"&&_.value==="vec4<bool>")return`vec4<bool>(bool(${e}[${pe}] & 0xFFu), bool(${e}[${pe}] & 0xFF00u), bool(${e}[${pe}] & 0xFF0000u), bool(${e}[${pe}] & 0xFF000000u))`;throw new Error(`not supported combination of storage type ${_.storage} and value type ${_.value} yet`)})(),de=s<2?"":`
  fn get_${e}ByIndices(indices: ${_.indices}) -> ${m} {
    return ${ae(`i2o_${e}(indices)`)};
  }`,ye=s<2?"":(()=>{let pe=a.map(te=>`d${te}: u32`).join(", "),K=a.map(te=>`d${te}`).join(", ");return`
  fn get_${e}(${pe}) -> ${m} {
    return get_${e}ByIndices(${$(K)});
  }`})(),_e=(...pe)=>{if(pe.length!==s)throw new Error(`indices length must be ${s}`);let K=pe.map(y).join(",");return s===0?ae("0u"):s===1?ae(K[0]):(M.get=!0,M.getByIndices=!0,M.indicesToOffset=!0,`get_${e}(${K})`)},ue=pe=>s<2?ae(pe):(M.getByIndices=!0,M.indicesToOffset=!0,`get_${e}ByIndices(${pe})`),fe=s<2?"":`
  fn set_${e}ByIndices(indices: ${_.indices}, value: ${m}) {
    ${ee(`i2o_${e}(indices)`,"value")}
  }`,De=s<2?"":(()=>{let pe=a.map(te=>`d${te}: u32`).join(", "),K=a.map(te=>`d${te}`).join(", ");return`
  fn set_${e}(${pe}, value: ${m}) {
    set_${e}ByIndices(${$(K)}, value);
  }`})();return{impl:()=>{let pe=[],K=!1;return M.offsetToIndices&&(pe.push(C),K=!0),M.indicesToOffset&&(pe.push(N),K=!0),M.broadcastedIndicesToOffset&&(Object.values(H).forEach(te=>pe.push(te)),K=!0),M.set&&(pe.push(De),K=!0),M.setByIndices&&(pe.push(fe),K=!0),M.get&&(pe.push(ye),K=!0),M.getByIndices&&(pe.push(de),K=!0),!o&&K&&pe.unshift(`const ${E} = ${_.indices}(${r.join(",")});`,`const ${T} = ${_.indices}(${br.computeStrides(r).join(",")});`),pe.join(`
`)},type:_,offsetToIndices:D,indicesToOffset:j,broadcastedIndicesToOffset:X,indices:$,indicesGet:U,indicesSet:G,set:(...pe)=>{if(pe.length!==s+1)throw new Error(`indices length must be ${s}`);let K=pe[s];if(typeof K!="string")throw new Error("value must be string");let te=pe.slice(0,s).map(y).join(",");return s===0?ee("0u",K):s===1?ee(te[0],K):(M.set=!0,M.setByIndices=!0,M.indicesToOffset=!0,`set_${e}(${te}, ${K})`)},setByOffset:ee,setByIndices:(pe,K)=>s<2?ee(pe,K):(M.setByIndices=!0,M.indicesToOffset=!0,`set_${e}ByIndices(${pe}, ${K});`),get:_e,getByOffset:ae,getByIndices:ue,usage:n,name:e,strides:T,shape:E,rank:s}},kr=(e,t,r,n=1)=>bw(e,t,r,"input",n),Fn=(e,t,r,n=1)=>bw(e,t,r,"output",n),ene=(e,t,r)=>bw(e,t,r,"atomicOutput",1),TR=(e,t,r,n=1)=>bw(e,t,r,"internal",n),vU=class{constructor(e,t){this.normalizedDispatchGroup=e,this.limits=t,this.internalVariables=[],this.variables=[],this.uniforms=[],this.variableIndex=0}guardAgainstOutOfBoundsWorkgroupSizes(e){return`if (global_idx >= ${typeof e=="number"?`${e}u`:e}) { return; }`}mainStart(e=Q1){let t=typeof e=="number"?e:e[0],r=typeof e=="number"?1:e[1],n=typeof e=="number"?1:e[2];if(t>this.limits.maxComputeWorkgroupSizeX||r>this.limits.maxComputeWorkgroupSizeY||n>this.limits.maxComputeWorkgroupSizeZ)throw new Error(`workgroup size [${t}, ${r}, ${n}] exceeds the maximum workgroup size [${this.limits.maxComputeWorkgroupSizeX}, ${this.limits.maxComputeWorkgroupSizeY}, ${this.limits.maxComputeWorkgroupSizeZ}].`);if(t*r*n>this.limits.maxComputeInvocationsPerWorkgroup)throw new Error(`workgroup size [${t}, ${r}, ${n}] exceeds the maximum workgroup invocations ${this.limits.maxComputeInvocationsPerWorkgroup}.`);let i=this.normalizedDispatchGroup[1]===1&&this.normalizedDispatchGroup[2]===1,o=i?`@builtin(global_invocation_id) global_id : vec3<u32>,
    @builtin(workgroup_id) workgroup_id : vec3<u32>,
    @builtin(local_invocation_index) local_idx : u32,
    @builtin(local_invocation_id) local_id : vec3<u32>`:`@builtin(global_invocation_id) global_id : vec3<u32>,
                                             @builtin(local_invocation_id) local_id : vec3<u32>,
    @builtin(local_invocation_index) local_idx : u32,
    @builtin(workgroup_id) workgroup_id : vec3<u32>,
    @builtin(num_workgroups) num_workgroups : vec3<u32>`,s=i?`let global_idx = global_id.x;
         let workgroup_index = workgroup_id.x;`:`let workgroup_index = workgroup_id.z * num_workgroups[0] * num_workgroups[1] +
             workgroup_id.y * num_workgroups[0] + workgroup_id.x;
         let global_idx = workgroup_index * ${t*r*n}u + local_idx;`;return`@compute @workgroup_size(${t}, ${r}, ${n})
  fn main(${o}) {
    ${s}
  `}appendVariableUniforms(e){e.rank!==0&&(e.shape.startsWith("uniforms.")&&this.uniforms.push({name:e.shape.replace("uniforms.",""),type:"u32",length:e.rank}),e.strides.startsWith("uniforms.")&&this.uniforms.push({name:e.strides.replace("uniforms.",""),type:"u32",length:e.rank}))}declareVariable(e,t){if(e.usage==="internal")throw new Error("cannot use internal variable with declareVariable(). use registerInternalVariables() instead.");this.variables.push(e),this.appendVariableUniforms(e);let r=e.usage==="input"?"read":"read_write",n=e.usage==="atomicOutput"?"atomic<i32>":e.type.storage;return`@group(0) @binding(${t}) var<storage, ${r}> ${e.name}: array<${n}>;`}declareVariables(...e){return e.map(t=>this.declareVariable(t,this.variableIndex++)).join(`
`)}registerInternalVariable(e){if(e.usage!=="internal")throw new Error("cannot use input or output variable with registerInternalVariable(). use declareVariables() instead.");this.internalVariables.push(e),this.appendVariableUniforms(e)}registerInternalVariables(...e){return e.forEach(t=>this.registerInternalVariable(t)),this}registerUniform(e,t,r=1){return this.uniforms.push({name:e,type:t,length:r}),this}registerUniforms(e){return this.uniforms=this.uniforms.concat(e),this}uniformDeclaration(){if(this.uniforms.length===0)return"";let e=[];for(let{name:t,type:r,length:n}of this.uniforms)if(n&&n>4)r==="f16"?e.push(`@align(16) ${t}:array<mat2x4<${r}>, ${Math.ceil(n/8)}>`):e.push(`${t}:array<vec4<${r}>, ${Math.ceil(n/4)}>`);else{let i=n==null||n===1?r:`vec${n}<${r}>`;e.push(`${t}:${i}`)}return`
      struct Uniforms { ${e.join(", ")} };
      @group(0) @binding(${this.variableIndex}) var<uniform> uniforms: Uniforms;`}get additionalImplementations(){return this.uniformDeclaration()+this.variables.map(e=>e.impl()).join(`
`)+this.internalVariables.map(e=>e.impl()).join(`
`)}get variablesInfo(){if(this.uniforms.length===0)return;let e=t=>[12,10,1,6][["u32","f16","f32","i32"].indexOf(t)];return this.uniforms.map(t=>[e(t.type),t.length??1])}},tne=(e,t)=>new vU(e,t)}),bU,x3,xU,wU,MU,SU,Jd,rne,nne,N_=nn(()=>{yi(),ji(),Zs(),Bi(),bU=(e,t)=>{if(!e||e.length!==1)throw new Error("Transpose requires 1 input.");if(t.length!==0&&t.length!==e[0].dims.length)throw new Error(`perm size ${t.length} does not match input rank ${e[0].dims.length}`)},x3=(e,t)=>t.length!==0?t:[...new Array(e).keys()].reverse(),xU=(e,t)=>br.sortBasedOnPerm(e,x3(e.length,t)),wU=(e,t,r,n)=>{let i=`fn perm(i: ${n.type.indices}) -> ${r.type.indices} {
    var a: ${r.type.indices};`;for(let o=0;o<t;++o)i+=`a[${e[o]}]=i[${o}];`;return i+="return a;}"},MU=(e,t)=>{let r=[],n=[];for(let i=0;i<e.length;++i)e[i]!==1&&r.push(e[i]),e[t[i]]!==1&&n.push(t[i]);return{newShape:r,newPerm:n}},SU=(e,t)=>{let r=0;for(let n=0;n<e.length;++n)if(t[e[n]]!==1){if(e[n]<r)return!1;r=e[n]}return!0},Jd=(e,t)=>{let r=e.dataType,n=e.dims.length,i=x3(n,t),o=xU(e.dims,i),s=e.dims,a=o,u=n<2||SU(i,e.dims),d;if(u)return d=M=>{let x=kr("input",r,s,4),E=Fn("output",r,a,4);return`
  ${M.registerUniform("output_size","u32").declareVariables(x,E)}
  ${M.mainStart()}
    ${M.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    output[global_idx] = input[global_idx];
  }`},{name:"TransposeCopy",shaderCache:{inputDependencies:["type"]},getRunData:()=>{let M=br.size(o);return{outputs:[{dims:o,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(M/64/4)},programUniforms:[{type:12,data:Math.ceil(M/4)}]}},getShaderSource:d};let{newShape:m,newPerm:g}=MU(e.dims,i),_=br.areEqual(g,[2,3,1]),y=br.areEqual(g,[3,1,2]);if(m.length===2||_||y){s=_?[m[0],m[1]*m[2]]:y?[m[0]*m[1],m[2]]:m,a=[s[1],s[0]];let M=16;return d=x=>{let E=kr("a",r,s.length),T=Fn("output",r,a.length);return`
  ${x.registerUniform("output_size","u32").declareVariables(E,T)}
  var<workgroup> tile : array<array<${T.type.value}, ${M+1}>, ${M}>;
  ${x.mainStart([M,M,1])}
    let stride = (uniforms.output_shape[1] - 1) / ${M} + 1;
    let workgroup_id_x = workgroup_index % stride;
    let workgroup_id_y = workgroup_index / stride;
    let input_col = workgroup_id_y * ${M}u + local_id.x;
    let input_row = workgroup_id_x * ${M}u + local_id.y;
    if (input_row < uniforms.a_shape[0] && input_col < uniforms.a_shape[1]) {
      tile[local_id.y][local_id.x] = ${E.getByIndices(`${E.type.indices}(input_row, input_col)`)};
    }
    workgroupBarrier();

    let output_col = workgroup_id_x * ${M}u + local_id.x;
    let output_row = workgroup_id_y * ${M}u + local_id.y;
    if (output_row < uniforms.output_shape[0] && output_col < uniforms.output_shape[1]) {
      ${T.setByIndices(`${T.type.indices}(output_row, output_col)`,"tile[local_id.x][local_id.y]")}
    }
  }`},{name:"TransposeShared",shaderCache:{inputDependencies:["type"]},getRunData:()=>{let x=br.size(o);return{outputs:[{dims:o,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(a[1]/M),y:Math.ceil(a[0]/M)},programUniforms:[{type:12,data:x},...Kn(s,a)]}},getShaderSource:d}}return d=M=>{let x=kr("a",r,s.length),E=Fn("output",r,a.length);return`
  ${M.registerUniform("output_size","u32").declareVariables(x,E)}

  ${wU(i,n,x,E)}

  ${M.mainStart()}
    ${M.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let indices = ${E.offsetToIndices("global_idx")};
    let aIndices = perm(indices);

    ${E.setByOffset("global_idx",x.getByIndices("aIndices"))}
  }`},{name:"Transpose",shaderCache:{hint:`${t}`,inputDependencies:["rank"]},getRunData:()=>{let M=br.size(o);return{outputs:[{dims:o,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(M/64)},programUniforms:[{type:12,data:M},...Kn(s,a)]}},getShaderSource:d}},rne=(e,t)=>{bU(e.inputs,t.perm),e.compute(Jd(e.inputs[0],t.perm))},nne=e=>Jo({perm:e.perm})}),TU,PU,EU,AU,CU,kU,IU,OU,LU,DU,mf,ine,one,ane,sne,lne,cne,une,dne,hne,fne,_Pe=nn(()=>{yi(),ji(),Bi(),PR(),N_(),TU={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate * candidate",logSumExp:"bestValue + exp(candidate)",l1:"bestValue + abs(candidate)",l2:"bestValue + candidate * candidate",logSum:"bestValue + candidate"},PU={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate",logSumExp:"bestValue + candidate",l1:"bestValue + candidate",l2:"bestValue + candidate",logSum:"bestValue + candidate"},EU={max:"_A[offset]",min:"_A[offset]",mean:"0",sum:"0",prod:"1",sumSquare:"0",logSumExp:"0",l1:"0",l2:"0",logSum:"0"},AU={max:"bestValue",min:"bestValue",sum:"bestValue",prod:"bestValue",sumSquare:"bestValue",logSumExp:"log(bestValue)",l1:"bestValue",l2:"sqrt(bestValue)",logSum:"log(bestValue)"},CU=(e,t)=>{let r=[];for(let n=t-e;n<t;++n)r.push(n);return r},kU=(e,t)=>{let r=[],n=e.length;for(let o=0;o<n;o++)t.indexOf(o)===-1&&r.push(e[o]);let i=t.map(o=>e[o]);return[r,i]},IU=(e,t)=>{let r=e.length+t.length,n=[],i=0;for(let o=0;o<r;o++)t.indexOf(o)===-1?n.push(e[i++]):n.push(1);return n},OU=(e,t)=>{for(let r=0;r<e.length;++r)if(e[e.length-r-1]!==t-1-r)return!1;return!0},LU=(e,t)=>{let r=[];if(!OU(e,t)){for(let n=0;n<t;++n)e.indexOf(n)===-1&&r.push(n);e.forEach(n=>r.push(n))}return r},DU=(e,t,r,n,i,o,s)=>{let a=r[0].dims,u=br.size(o),d=br.size(s),m=kr("_A",r[0].dataType,a),g=Fn("output",i,o),_=64;u===1&&(_=256);let y=`
          var<workgroup> aBestValues : array<f32, ${_}>;
       `,M=x=>`
        ${x.registerUniform("reduceSize","u32").declareVariables(m,g)}
        ${y}
        fn DIV_CEIL(a : u32, b : u32) -> u32 {
          return ((a - 1u) / b + 1u);
         }
         ${x.mainStart(_)}

          let outputIndex = global_idx / ${_};
          let offset = outputIndex * uniforms.reduceSize;

          var bestValue = f32(${EU[n]});
          let Length = uniforms.reduceSize;
          for (var k = local_idx; k < Length; k = k + ${_}) {
           let candidate = f32(${m.getByOffset("offset + k")});
           bestValue = ${TU[n]};
          }
          aBestValues[local_idx] = bestValue;
          workgroupBarrier();

         var reduceSize = min(Length, ${_}u);
         for (var currentSize = reduceSize / 2u; reduceSize > 1u;
             currentSize = reduceSize / 2u) {
           let interval = DIV_CEIL(reduceSize, 2u);
           if (local_idx < currentSize) {
            let candidate = aBestValues[local_idx + interval];
            bestValue = ${PU[n]};
            aBestValues[local_idx] = bestValue;
           }
           reduceSize = interval;
           workgroupBarrier();
         }

         if (local_idx == 0u) {
          ${g.setByOffset("outputIndex",`${n==="mean"?`${g.type.storage}(bestValue / f32(uniforms.reduceSize))`:`${g.type.storage}(${AU[n]})`}`)};
         }
        }`;return{name:e,shaderCache:{hint:`${t};${_}`,inputDependencies:["type"]},getShaderSource:M,getRunData:()=>({outputs:[{dims:o,dataType:i}],dispatchGroup:{x:u},programUniforms:[{type:12,data:d}]})}},mf=(e,t,r,n)=>{let i=e.inputs.length===1?r:WD(e.inputs,r),o=i.axes;o.length===0&&!i.noopWithEmptyAxes&&(o=e.inputs[0].dims.map((y,M)=>M));let s=br.normalizeAxes(o,e.inputs[0].dims.length),a=s,u=e.inputs[0],d=LU(a,e.inputs[0].dims.length);d.length>0&&(u=e.compute(Jd(e.inputs[0],d),{inputs:[0],outputs:[-1]})[0],a=CU(a.length,u.dims.length));let[m,g]=kU(u.dims,a),_=m;i.keepDims&&(_=IU(m,s)),e.compute(DU(t,i.cacheKey,[u],n,e.inputs[0].dataType,_,g),{inputs:[u]})},ine=(e,t)=>{mf(e,"ReduceMeanShared",t,"mean")},one=(e,t)=>{mf(e,"ReduceL1Shared",t,"l1")},ane=(e,t)=>{mf(e,"ReduceL2Shared",t,"l2")},sne=(e,t)=>{mf(e,"ReduceLogSumExpShared",t,"logSumExp")},lne=(e,t)=>{mf(e,"ReduceMaxShared",t,"max")},cne=(e,t)=>{mf(e,"ReduceMinShared",t,"min")},une=(e,t)=>{mf(e,"ReduceProdShared",t,"prod")},dne=(e,t)=>{mf(e,"ReduceSumShared",t,"sum")},hne=(e,t)=>{mf(e,"ReduceSumSquareShared",t,"sumSquare")},fne=(e,t)=>{mf(e,"ReduceLogSumShared",t,"logSum")}}),gf,$U,DA,WD,_f,NU,jU,RU,FU,zU,BU,UU,VU,WU,GU,yf,pne,mne,gne,_ne,yne,vne,bne,xne,wne,Mne,PR=nn(()=>{yi(),ji(),Zs(),Bi(),_Pe(),gf=e=>{if(!e||e.length===0||e.length>2)throw new Error("Reduce op requires 1 or 2 inputs.");if(e.length===2&&e[1].dims.length!==1)throw new Error("Invalid axes input dims.")},$U=e=>["","",`var value = ${e.getByIndices("input_indices")};`,""],DA=(e,t,r,n,i,o,s=!1,a=!1)=>{let u=[],d=r[0].dims,m=d.length,g=br.normalizeAxes(i,m),_=!a&&g.length===0;d.forEach((x,E)=>{_||g.indexOf(E)>=0?s&&u.push(1):u.push(x)});let y=u.length,M=br.size(u);return{name:e,shaderCache:t,getShaderSource:x=>{let E=[],T=kr("_A",r[0].dataType,m),P=Fn("output",o,y),C=n(T,P,g),D=C[2];for(let L=0,N=0;L<m;L++)_||g.indexOf(L)>=0?(s&&N++,D=`for(var j${L}: u32 = 0; j${L} < ${d[L]}; j${L}++) {
                  ${C[2].includes("last_index")?`let last_index = j${L};`:""}
                  ${T.indicesSet("input_indices",L,`j${L}`)}
                  ${D}
                }`):(E.push(`${T.indicesSet("input_indices",L,P.indicesGet("output_indices",N))};`),N++);return`

        ${x.registerUniform("output_size","u32").declareVariables(T,P)}

        ${x.mainStart()}
          ${x.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          var input_indices: ${T.type.indices};
          let output_indices = ${P.offsetToIndices("global_idx")};

          ${E.join(`
`)}
          ${C[0]}       // init ops for reduce max/min
          ${C[1]}
          ${D}
          ${C[3]}
          ${C.length===4?P.setByOffset("global_idx","value"):C.slice(4).join(`
`)}
        }`},getRunData:()=>({outputs:[{dims:u,dataType:o}],dispatchGroup:{x:Math.ceil(M/64)},programUniforms:[{type:12,data:M},...Kn(d,u)]})}},WD=(e,t)=>{let r=[];return e[1].dims[0]>0&&e[1].getBigInt64Array().forEach(n=>r.push(Number(n))),Jo({axes:r,keepDims:t.keepDims,noopWithEmptyAxes:t.noopWithEmptyAxes})},_f=(e,t,r,n)=>{let i=e.inputs,o=i.length===1?r:WD(i,r);e.compute(DA(t,{hint:o.cacheKey,inputDependencies:["rank"]},[i[0]],o.noopWithEmptyAxes&&o.axes.length===0?$U:n,o.axes,i[0].dataType,o.keepDims,o.noopWithEmptyAxes),{inputs:[0]})},NU=(e,t)=>{gf(e.inputs),_f(e,"ReduceLogSum",t,(r,n)=>[`var value = ${n.type.storage}(0);`,"",`value += ${r.getByIndices("input_indices")};`,"value = log(value);"])},jU=(e,t)=>{gf(e.inputs),_f(e,"ReduceL1",t,(r,n)=>[`var value = ${n.type.storage}(0);`,"",`value += abs(${r.getByIndices("input_indices")});`,""])},RU=(e,t)=>{gf(e.inputs),_f(e,"ReduceL2",t,(r,n)=>[`var t = ${n.type.value}(0); var value = ${n.type.value}(0);`,"",`t = ${r.getByIndices("input_indices")}; value += (t * t);`,"value = sqrt(value);"])},FU=(e,t)=>{gf(e.inputs),_f(e,"ReduceLogSumExp",t,(r,n)=>[`var value = ${n.type.storage}(0);`,"",`value += exp(${r.getByIndices("input_indices")});`,"value = log(value);"])},zU=(e,t)=>{gf(e.inputs),_f(e,"ReduceMax",t,(r,n,i)=>{let o=[];for(let s=0;s<r.rank;s++)(i.indexOf(s)>=0||i.length===0)&&o.push(r.indicesSet("input_indices",s,0));return[`${o.join(`
`)}`,`var value = ${r.getByIndices("input_indices")};`,`value = max(value, ${r.getByIndices("input_indices")});`,""]})},BU=(e,t)=>{gf(e.inputs),_f(e,"ReduceMean",t,(r,n,i)=>{let o=1;for(let s=0;s<r.rank;s++)(i.indexOf(s)>=0||i.length===0)&&(o*=e.inputs[0].dims[s]);return["var sum = f32(0);","",`sum += f32(${r.getByIndices("input_indices")});`,`let value = ${n.type.value}(sum / ${o});`]})},UU=(e,t)=>{gf(e.inputs),_f(e,"ReduceMin",t,(r,n,i)=>{let o=[];for(let s=0;s<r.rank;s++)(i.indexOf(s)>=0||i.length===0)&&o.push(`input_indices[${s}] = 0;`);return[`${o.join(`
`)}`,`var value = ${r.getByIndices("input_indices")};`,`value = min(value, ${r.getByIndices("input_indices")});`,""]})},VU=(e,t)=>{gf(e.inputs),_f(e,"ReduceProd",t,(r,n)=>[`var value = ${n.type.storage}(1);`,"",`value *= ${r.getByIndices("input_indices")};`,""])},WU=(e,t)=>{gf(e.inputs),_f(e,"ReduceSum",t,(r,n)=>[`var value = ${n.type.storage}(0);`,"",`value += ${r.getByIndices("input_indices")};`,""])},GU=(e,t)=>{gf(e.inputs),_f(e,"ReduceSumSquare",t,(r,n)=>[`var t = ${n.type.value}(0); var value = ${n.type.value}(0);`,"",`t = ${r.getByIndices("input_indices")}; value += t * t;`,""])},yf=(e,t,r)=>{if(t.length===0)return r;let n=1,i=1;for(let o=0;o<t.length;o++)t.indexOf(o)===-1?n*=e[o]:i*=e[o];return i<32&&n>1024},pne=(e,t)=>{yf(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?BU(e,t):ine(e,t)},mne=(e,t)=>{yf(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?jU(e,t):one(e,t)},gne=(e,t)=>{yf(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?RU(e,t):ane(e,t)},_ne=(e,t)=>{yf(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?FU(e,t):sne(e,t)},yne=(e,t)=>{yf(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?zU(e,t):lne(e,t)},vne=(e,t)=>{yf(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?UU(e,t):cne(e,t)},bne=(e,t)=>{yf(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?VU(e,t):une(e,t)},xne=(e,t)=>{yf(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?WU(e,t):dne(e,t)},wne=(e,t)=>{yf(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?GU(e,t):hne(e,t)},Mne=(e,t)=>{yf(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?NU(e,t):fne(e,t)}}),w3,Sne,Tne,GD,yPe=nn(()=>{yi(),Zs(),PR(),w3=e=>{if(!e||e.length===0||e.length>2)throw new Error("ArgMinMaxOp op requires 1 or 2 inputs.");if(e[0].dataType!==1)throw new Error("Invalid input type.")},Sne=(e,t)=>{w3(e.inputs);let r=(n,i,o)=>{let s=[];for(let a=0;a<n.rank;a++)(o.indexOf(a)>=0||o.length===0)&&s.push(`input_indices[${a}] = 0;`);return[`${s.join(`
`)}`,`var value = ${n.getByIndices("input_indices")};
var best_index : i32 = 0;`,`if (${n.getByIndices("input_indices")} ${t.selectLastIndex>0?"<=":"<"} value) {
         value = ${n.getByIndices("input_indices")};
         best_index = i32(last_index);
       }`,"",i.setByOffset("global_idx","best_index")]};e.compute(DA("ArgMin",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],r,[t.axis],7,t.keepDims),{inputs:[0]})},Tne=(e,t)=>{w3(e.inputs);let r=(n,i,o)=>{let s=[];for(let a=0;a<n.rank;a++)(o.indexOf(a)>=0||o.length===0)&&s.push(`input_indices[${a}] = 0;`);return[`${s.join(`
`)}`,`var value = ${n.getByIndices("input_indices")};
var best_index : i32 = 0;`,`if (${n.getByIndices("input_indices")} ${t.selectLastIndex>0?">=":">"} value) {
         value = ${n.getByIndices("input_indices")};
         best_index = i32(last_index);
       }`,"",i.setByOffset("global_idx","best_index")]};e.compute(DA("argMax",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],r,[t.axis],7,t.keepDims),{inputs:[0]})},GD=e=>Jo(e)}),qU,kP,HU,KU,ZU,cM,XU,Pne,ER=nn(()=>{yi(),ji(),SR(),Bi(),qU=(e,t)=>{let r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],a=e[5];if(s&&a)throw new Error("Attention cannot have both past and attention_bias");if(r.dims.length!==3)throw new Error('Input "input" must have 3 dimensions');let u=r.dims[0],d=r.dims[1],m=r.dims[2];if(i.dims.length!==1)throw new Error('Input "bias" is expected to have 1 dimensions');if(n.dims.length!==2)throw new Error('Input "weights" is expected to have 2 dimensions');if(n.dims[0]!==m)throw new Error("Input 1 dimension 0 should have same length as dimension 2 of input 0");if(i.dims[0]!==n.dims[1])throw new Error('Input "bias" dimension 0 should have same length as dimension 1 of input "weights"');let g=i.dims[0]/3,_=g,y=_;if(t.qkvHiddenSizes.length>0){if(t.qkvHiddenSizes.length!==3)throw new Error("qkv_hidden_sizes attribute should have 3 elements");for(let C of t.qkvHiddenSizes)if(C%t.numHeads!==0)throw new Error("qkv_hidden_sizes should be divisible by num_heads");g=t.qkvHiddenSizes[0],_=t.qkvHiddenSizes[1],y=t.qkvHiddenSizes[2]}let M=d;if(g!==_)throw new Error("qkv_hidden_sizes first element should be same as the second");if(i.dims[0]!==g+_+y)throw new Error('Input "bias" dimension 0 should have same length as sum of Q/K/V hidden sizes');let x=0;if(s){if(_!==y)throw new Error('Input "past" expect k_hidden_size == v_hidden_size');if(s.dims.length!==5)throw new Error('Input "past" must have 5 dimensions');if(s.dims[0]!==2)throw new Error('Input "past" first dimension must be 2');if(s.dims[1]!==u)throw new Error('Input "past" second dimension must be batch_size');if(s.dims[2]!==t.numHeads)throw new Error('Input "past" third dimension must be num_heads');if(s.dims[4]!==_/t.numHeads)throw new Error('Input "past" fifth dimension must be k_hidden_size / num_heads');t.pastPresentShareBuffer||(x=s.dims[3])}let E=M+x,T=-1,P=0;if(o)throw new Error("Mask not supported");if(s)throw new Error("past is not supported");if(a){if(a.dims.length!==4)throw new Error('Input "attention_bias" must have 4 dimensions');if(a.dims[0]!==u||a.dims[1]!==t.numHeads||a.dims[2]!==d||a.dims[3]!==E)throw new Error('Expect "attention_bias" shape (batch_size, num_heads, sequence_length, total_sequence_length)')}return{batchSize:u,sequenceLength:d,pastSequenceLength:x,kvSequenceLength:M,totalSequenceLength:E,maxSequenceLength:T,inputHiddenSize:m,hiddenSize:g,vHiddenSize:y,headSize:Math.floor(g/t.numHeads),vHeadSize:Math.floor(y/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:P,scale:t.scale,broadcastResPosBias:!1,passPastInKv:!1,qkvFormat:1}},kP=(e,t,r)=>t&&e?`
      let total_sequence_length_input = u32(${t.getByOffset("0")});
      let present_sequence_length = max(total_sequence_length_input, uniforms.past_sequence_length);
      let is_subsequent_prompt: bool = sequence_length > 1 && sequence_length != total_sequence_length_input;
      let is_first_prompt: bool = is_subsequent_prompt == false && sequence_length == total_sequence_length_input;
      total_sequence_length = u32(${e==null?void 0:e.getByOffset("batchIdx")}) + 1;
      var past_sequence_length: u32 = 0;
      if (is_first_prompt == false) {
        past_sequence_length = total_sequence_length - sequence_length;
      }
       `:`
    ${r?"let past_sequence_length = uniforms.past_sequence_length":""};
    let present_sequence_length = total_sequence_length;
    `,HU=(e,t,r,n,i,o,s,a)=>{let u=Os(s?1:o),d=64,m=o/u;m<d&&(d=32);let g=Math.ceil(o/u/d),_=[{type:12,data:t},{type:12,data:r},{type:12,data:n},{type:12,data:i},{type:12,data:m},{type:12,data:g}],y=mc(e.dataType,u),M=Mu(1,u),x=["type"];s&&x.push("type"),a&&x.push("type");let E=T=>{let P=Fn("x",e.dataType,e.dims,u),C=[P],D=s?kr("seq_lens",s.dataType,s.dims):void 0;D&&C.push(D);let L=a?kr("total_sequence_length_input",a.dataType,a.dims):void 0;L&&C.push(L);let N=Mu(e.dataType),j=[{name:"batch_size",type:"u32"},{name:"num_heads",type:"u32"},{name:"past_sequence_length",type:"u32"},{name:"sequence_length",type:"u32"},{name:"total_sequence_length",type:"u32"},{name:"elements_per_thread",type:"u32"}];return`
  var<workgroup> thread_max: array<f32, ${d}>;
  var<workgroup> thread_sum: array<f32, ${d}>;
  ${T.registerUniforms(j).declareVariables(...C)}
  ${T.mainStart([d,1,1])}
    let batchIdx = workgroup_id.z / uniforms.num_heads;
    let headIdx = workgroup_id.z % uniforms.num_heads;
    let sequence_length = uniforms.sequence_length;
    var total_sequence_length = uniforms.total_sequence_length;
    ${kP(D,L,!1)}
    let local_offset = local_idx * uniforms.elements_per_thread;
    let offset = (global_idx / ${d}) * uniforms.total_sequence_length + local_offset;
    let seq_causal_length = ${s?"u32(past_sequence_length + workgroup_id.y + 1)":"total_sequence_length"};
    var thread_max_vector = ${M}(-3.402823e+38f);
    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
      thread_max_vector = max(${M}(x[offset + i]), thread_max_vector);
    }
    thread_max[local_idx] = ${(()=>{switch(u){case 1:return"thread_max_vector";case 2:return"max(thread_max_vector.x, thread_max_vector.y)";case 4:return"max(max(thread_max_vector.x, thread_max_vector.y), max(thread_max_vector.z, thread_max_vector.w))";default:throw new Error(`Unsupported components: ${u}`)}})()};
    workgroupBarrier();

    var max_value =  f32(-3.402823e+38f);
    for (var i = 0u; i < ${d}; i++) {
      max_value = max(thread_max[i], max_value);
    }

    var sum_vector = ${M}(0);
    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
      sum_vector += exp(${M}(x[offset + i]) - max_value);
    }
    thread_sum[local_idx] = ${(()=>{switch(u){case 1:return"sum_vector";case 2:return"sum_vector.x + sum_vector.y";case 4:return"sum_vector.x + sum_vector.y + sum_vector.z + sum_vector.w";default:throw new Error(`Unsupported components: ${u}`)}})()};
    workgroupBarrier();

    var sum: f32 = 0;
    for (var i = 0u; i < ${d}; i++) {
      sum += thread_sum[i];
    }

    if (sum == 0) {
      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
        x[offset + i] = ${P.type.value}(${N}(1.0) / ${N}(seq_causal_length));
      }
    } else {
      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
        var f32input = ${M}(x[offset + i]);
        x[offset + i] = ${P.type.value}(exp(f32input - max_value) / sum);
      }
    }
      ${s?`
        for (var total_seq_id: u32 = seq_causal_length; total_seq_id + local_offset < uniforms.total_sequence_length; total_seq_id++) {
          x[offset + total_seq_id] = ${P.type.value}(${N}(0));
        }`:""};
  }`};return{name:"AttentionProbsSoftmax",shaderCache:{hint:`${d};${y};${u}`,inputDependencies:x},getShaderSource:E,getRunData:()=>({outputs:[],dispatchGroup:{x:1,y:i,z:t*r},programUniforms:_})}},KU=(e,t,r,n,i,o,s,a,u)=>{let d=s+o.kvSequenceLength,m=[o.batchSize,o.numHeads,o.sequenceLength,d],g=e>1&&n,_=o.kvNumHeads?o.kvNumHeads:o.numHeads,y=g?[o.batchSize,_,d,o.headSize]:void 0,M=o.nReps?o.nReps:1,x=o.scale===0?1/Math.sqrt(o.headSize):o.scale,E=Os(o.headSize),T=o.headSize/E,P=12,C={x:Math.ceil(d/P),y:Math.ceil(o.sequenceLength/P),z:o.batchSize*o.numHeads},D=[{type:12,data:o.sequenceLength},{type:12,data:T},{type:12,data:d},{type:12,data:o.numHeads},{type:12,data:o.headSize},{type:1,data:x},{type:12,data:s},{type:12,data:o.kvSequenceLength},{type:12,data:M}],L=g&&n&&br.size(n.dims)>0,N=["type","type"];L&&N.push("type"),i&&N.push("type"),a&&N.push("type"),u&&N.push("type");let j=[{dims:m,dataType:t.dataType,gpuDataType:0}];g&&j.push({dims:y,dataType:t.dataType,gpuDataType:0});let $=U=>{let G=kr("q",t.dataType,t.dims,E),H=kr("key",r.dataType,r.dims,E),X=[G,H];if(L){let fe=kr("past_key",n.dataType,n.dims,E);X.push(fe)}i&&X.push(kr("attention_bias",i.dataType,i.dims));let ee=a?kr("seq_lens",a.dataType,a.dims):void 0;ee&&X.push(ee);let ae=u?kr("total_sequence_length_input",u.dataType,u.dims):void 0;ae&&X.push(ae);let de=Fn("output",t.dataType,m),ye=[de];g&&ye.push(Fn("present_key",t.dataType,y,E));let _e=Mu(1,E),ue=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"alpha",type:"f32"},{name:"past_sequence_length",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"n_reps",type:"u32"}];return`
  const TILE_SIZE = ${P}u;

  var<workgroup> tileQ: array<${G.type.storage}, ${P*P}>;
  var<workgroup> tileK: array<${G.type.storage}, ${P*P}>;
  ${U.registerUniforms(ue).declareVariables(...X,...ye)}
  ${U.mainStart([P,P,1])}
    // x holds the N and y holds the M
    let headIdx = workgroup_id.z % uniforms.num_heads;
    let kvHeadIdx = ${M===1?"headIdx":"headIdx / uniforms.n_reps"};
    let kv_num_heads = ${M===1?"uniforms.num_heads":"uniforms.num_heads / uniforms.n_reps"};
    let batchIdx = workgroup_id.z / uniforms.num_heads;
    let m = workgroup_id.y * TILE_SIZE;
    let n = workgroup_id.x * TILE_SIZE;
    let sequence_length = uniforms.M;
    var total_sequence_length = uniforms.N;
    ${kP(ee,ae,!0)}
    let absKvHeadIdx = batchIdx * kv_num_heads + kvHeadIdx;
    let qOffset = workgroup_id.z * uniforms.M * uniforms.K + m * uniforms.K;
    ${L&&g?"let pastKeyOffset = absKvHeadIdx * uniforms.past_sequence_length * uniforms.K;":""};
    let kOffset = absKvHeadIdx * uniforms.kv_sequence_length * uniforms.K;
    ${g?"let presentKeyOffset = absKvHeadIdx * uniforms.N * uniforms.K;":""}
    var value = ${_e}(0);
    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (global_id.y < uniforms.M && w + local_id.x < uniforms.K) {
        tileQ[TILE_SIZE * local_id.y + local_id.x] = q[qOffset + local_id.y * uniforms.K + w + local_id.x];
      }
      if (n + local_id.y < uniforms.N && w + local_id.x < uniforms.K) {
        var idx = TILE_SIZE * local_id.y + local_id.x;
      ${L&&g?`
              if (n + local_id.y < past_sequence_length) {
                tileK[idx] = past_key[pastKeyOffset + (n + local_id.y) * uniforms.K + w + local_id.x];
              } else if (n + local_id.y - past_sequence_length < uniforms.kv_sequence_length) {
                tileK[idx] = key[kOffset + (n + local_id.y - past_sequence_length) * uniforms.K + w + local_id.x];
              }`:`
          if (n + local_id.y < uniforms.kv_sequence_length) {
            tileK[idx] = key[kOffset + (n + local_id.y) * uniforms.K + w + local_id.x];
          }`}
      ${g?`if (n + local_id.y < present_sequence_length) {
        present_key[presentKeyOffset + (n + local_id.y) * uniforms.K + w + local_id.x] = tileK[idx];
      }`:""}
      }
      workgroupBarrier();

      for (var k: u32 = 0u; k < TILE_SIZE && w+k < uniforms.K; k++) {
          value += ${_e}(tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * local_id.x + k]);
      }

      workgroupBarrier();
    }

    if (global_id.y < uniforms.M && global_id.x < total_sequence_length) {
      let headOffset = workgroup_id.z * uniforms.M * uniforms.N;
      let outputIdx = headOffset + global_id.y * uniforms.N + global_id.x;
      var sum: f32 = ${(()=>{switch(E){case 1:return"value";case 2:return"value.x + value.y";case 4:return"value.x + value.y + value.z + value.w";default:throw new Error(`Unsupported components: ${E}`)}})()};
        output[outputIdx] = ${de.type.value} (sum * uniforms.alpha) + ${i?"attention_bias[outputIdx]":"0.0"};
    }
  }`};return{name:"AttentionProbs",shaderCache:{hint:`${E};${i!==void 0};${n!==void 0};${e}`,inputDependencies:N},getRunData:()=>({outputs:j,dispatchGroup:C,programUniforms:D}),getShaderSource:$}},ZU=(e,t,r,n,i,o,s=void 0,a=void 0)=>{let u=o+i.kvSequenceLength,d=i.nReps?i.nReps:1,m=i.vHiddenSize*d,g=e>1&&n,_=i.kvNumHeads?i.kvNumHeads:i.numHeads,y=g?[i.batchSize,_,u,i.headSize]:void 0,M=[i.batchSize,i.sequenceLength,m],x=12,E={x:Math.ceil(i.vHeadSize/x),y:Math.ceil(i.sequenceLength/x),z:i.batchSize*i.numHeads},T=[{type:12,data:i.sequenceLength},{type:12,data:u},{type:12,data:i.vHeadSize},{type:12,data:i.numHeads},{type:12,data:i.headSize},{type:12,data:m},{type:12,data:o},{type:12,data:i.kvSequenceLength},{type:12,data:d}],P=g&&n&&br.size(n.dims)>0,C=["type","type"];P&&C.push("type"),s&&C.push("type"),a&&C.push("type");let D=[{dims:M,dataType:t.dataType,gpuDataType:0}];g&&D.push({dims:y,dataType:t.dataType,gpuDataType:0});let L=N=>{let j=kr("probs",t.dataType,t.dims),$=kr("v",r.dataType,r.dims),U=[j,$];P&&U.push(kr("past_value",n.dataType,n.dims));let G=s?kr("seq_lens",s.dataType,s.dims):void 0;s&&U.push(G);let H=a?kr("total_sequence_length_input",a.dataType,a.dims):void 0;a&&U.push(H);let X=[Fn("output",t.dataType,M)];g&&X.push(Fn("present_value",t.dataType,y));let ee=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"v_hidden_size",type:"u32"},{name:"past_sequence_length",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"n_reps",type:"u32"}];return`
  const TILE_SIZE = ${x}u;
  var<workgroup> tileQ: array<${j.type.value}, ${x*x}>;
  var<workgroup> tileV: array<${j.type.value}, ${x*x}>;
  ${N.registerUniforms(ee).declareVariables(...U,...X)}
  ${N.mainStart([x,x,1])}
   let headIdx = workgroup_id.z % uniforms.num_heads;
   let batchIdx = workgroup_id.z / uniforms.num_heads;
   let kvHeadIdx = ${d===1?"headIdx":"headIdx / uniforms.n_reps"};
   let kv_num_heads = ${d===1?"uniforms.num_heads":"uniforms.num_heads / uniforms.n_reps"};
   let m = global_id.y;
   let n = global_id.x;
   let sequence_length = uniforms.M;
   var total_sequence_length = uniforms.K;
   ${kP(G,H,!0)}
   let offsetA = workgroup_id.z * uniforms.M * uniforms.K + m * uniforms.K;
   let absKvHeadIdx = batchIdx * kv_num_heads + kvHeadIdx; // kvHeadIdx is relative to the batch
   ${P&&g?"let pastValueOffset = absKvHeadIdx * uniforms.N * uniforms.past_sequence_length + n;":""};
   let vOffset = absKvHeadIdx * uniforms.N * uniforms.kv_sequence_length + n;
   ${g?"let presentValueOffset = absKvHeadIdx * uniforms.N * uniforms.K + n;":""}
   var value = ${j.type.storage}(0);
   for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (m < uniforms.M && w + local_id.x < uniforms.K) {
        tileQ[TILE_SIZE * local_id.y + local_id.x] = probs[offsetA + w + local_id.x];
      }
      if (n < uniforms.N && w + local_id.y < uniforms.K) {
        var idx = TILE_SIZE * local_id.y + local_id.x;
        ${P&&g?`
        if (w + local_id.y < past_sequence_length) {
          tileV[idx] = past_value[pastValueOffset + (w + local_id.y) * uniforms.N];
        } else if (w + local_id.y - past_sequence_length < uniforms.kv_sequence_length) {
          tileV[idx] = v[vOffset + (w + local_id.y - past_sequence_length) * uniforms.N];
        }
      `:`
            if (w + local_id.y < uniforms.kv_sequence_length) {
              tileV[idx] = v[vOffset + (w + local_id.y) * uniforms.N];
            }`}
        ${g?`
            if (w + local_id.y < present_sequence_length) {
          present_value[presentValueOffset + (w + local_id.y) * uniforms.N] = tileV[idx];
        }`:""}
      }
     workgroupBarrier();
     for (var k: u32 = 0u; k < TILE_SIZE && w+k < total_sequence_length; k++) {
       value += tileQ[TILE_SIZE * local_id.y + k] * tileV[TILE_SIZE * k + local_id.x];
     }
     workgroupBarrier();
   }

   // we need to transpose output from BNSH_v to BSND_v
   if (m < uniforms.M && n < uniforms.N) {
     let outputIdx = batchIdx * uniforms.M * uniforms.v_hidden_size + m * uniforms.v_hidden_size
       + headIdx * uniforms.N + n;
     output[outputIdx] = value;
   }
  }`};return{name:"AttentionScore",shaderCache:{hint:`${n!==void 0};${e}`,inputDependencies:C},getRunData:()=>({outputs:D,dispatchGroup:E,programUniforms:T}),getShaderSource:L}},cM=(e,t,r,n,i,o,s,a,u,d,m=void 0,g=void 0)=>{let _=Math.min(e.outputCount,1+(s?1:0)+(a?1:0)),y=_>1?d.pastSequenceLength:0,M=y+d.kvSequenceLength,x=u&&br.size(u.dims)>0?u:void 0,E=[t,r];_>1&&s&&br.size(s.dims)>0&&E.push(s),x&&E.push(x),m&&E.push(m),g&&E.push(g);let T=e.compute(KU(_,t,r,s,x,d,y,m,g),{inputs:E,outputs:_>1?[-1,1]:[-1]})[0];e.compute(HU(T,d.batchSize,d.numHeads,y,d.sequenceLength,M,m,g),{inputs:m&&g?[T,m,g]:[T],outputs:[]});let P=[T,n];_>1&&a&&br.size(a.dims)>0&&P.push(a),m&&P.push(m),g&&P.push(g),e.compute(ZU(_,T,n,a,d,y,m,g),{inputs:P,outputs:_>1?[0,2]:[0]})},XU=(e,t)=>{let r=[t.batchSize,t.numHeads,t.sequenceLength,t.headSize],n=t.sequenceLength,i=t.inputHiddenSize,o=t.headSize,s=12,a={x:Math.ceil(t.headSize/s),y:Math.ceil(t.sequenceLength/s),z:t.batchSize*t.numHeads},u=[e.inputs[0],e.inputs[1],e.inputs[2]],d=[{type:12,data:n},{type:12,data:i},{type:12,data:o},{type:12,data:t.numHeads},{type:12,data:t.headSize},{type:12,data:t.hiddenSize},{type:12,data:t.hiddenSize+t.hiddenSize+t.vHiddenSize}],m=g=>{let _=Fn("output_q",u[0].dataType,r),y=Fn("output_k",u[0].dataType,r),M=Fn("output_v",u[0].dataType,r),x=kr("input",u[0].dataType,u[0].dims),E=kr("weight",u[1].dataType,u[1].dims),T=kr("bias",u[2].dataType,u[2].dims),P=x.type.storage,C=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"hidden_size",type:"u32"},{name:"ldb",type:"u32"}];return`
  const TILE_SIZE = ${s}u;
  var<workgroup> tileInput: array<${P}, ${s*s}>;
  var<workgroup> tileWeightQ: array<${P}, ${s*s}>;
  var<workgroup> tileWeightK: array<${P}, ${s*s}>;
  var<workgroup> tileWeightV: array<${P}, ${s*s}>;
  ${g.registerUniforms(C).declareVariables(x,E,T,_,y,M)}
  ${g.mainStart([s,s,1])}
    let batchIndex = workgroup_id.z / uniforms.num_heads;
    let headNumber = workgroup_id.z % uniforms.num_heads;
    let m = global_id.y;
    let n = global_id.x;

    let inputOffset = batchIndex * (uniforms.M * uniforms.K) + m * uniforms.K;
    let biasOffsetQ = headNumber * uniforms.head_size;
    let biasOffsetK = uniforms.hidden_size + biasOffsetQ;
    let biasOffsetV = uniforms.hidden_size + biasOffsetK;

    var valueQ = ${P}(0);
    var valueK = ${P}(0);
    var valueV = ${P}(0);
    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (m < uniforms.M && w + local_id.x < uniforms.K) {
        tileInput[TILE_SIZE * local_id.y + local_id.x] = input[inputOffset + w + local_id.x];
      }
      if (n < uniforms.N && w + local_id.y < uniforms.K) {
        let offset = n + (w + local_id.y) * uniforms.ldb;
        tileWeightQ[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetQ + offset];
        tileWeightK[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetK + offset];
        tileWeightV[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetV + offset];
      }
      workgroupBarrier();
      for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {
        let inputTileOffset = TILE_SIZE * local_id.y + k;
        let weightTileOffset = TILE_SIZE * k + local_id.x;
        valueQ += tileInput[inputTileOffset] * tileWeightQ[weightTileOffset];
        valueK += tileInput[inputTileOffset] * tileWeightK[weightTileOffset];
        valueV += tileInput[inputTileOffset] * tileWeightV[weightTileOffset];
      }

      workgroupBarrier();
    }

    let headOffset = (m * uniforms.N + n) % uniforms.head_size;
    valueQ += bias[headOffset + biasOffsetQ];
    valueK += bias[headOffset + biasOffsetK];
    valueV += bias[headOffset + biasOffsetV];

    let offset = workgroup_id.z * uniforms.M * uniforms.N;
    if (m < uniforms.M && n < uniforms.N) {
      let outputIdx = offset + m * uniforms.N + n;
      output_q[outputIdx] = valueQ;
      output_k[outputIdx] = valueK;
      output_v[outputIdx] = valueV;
    }
  }`};return e.compute({name:"AttentionPrepare",shaderCache:{inputDependencies:["type","type","type"]},getRunData:()=>({outputs:[{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0}],dispatchGroup:a,programUniforms:d}),getShaderSource:m},{inputs:u,outputs:[-1,-1,-1]})},Pne=(e,t)=>{let r=qU(e.inputs,t),[n,i,o]=XU(e,r);return cM(e,n,i,o,e.inputs[4],void 0,void 0,void 0,e.inputs[5],r)}}),YU,QU,JU,Ene,vPe=nn(()=>{Kf(),yi(),ji(),Zs(),Bi(),YU=(e,t)=>{if(!e||e.length!==5)throw new Error("BatchNormalization requires 5 inputs");let r=(n,i,o)=>{let s=i.length;if(s!==n.length)throw new Error(`${o}: num dimensions != ${s}`);i.forEach((a,u)=>{if(a!==n[u])throw new Error(`${o}: dim[${u}] do not match`)})};if(e[0].dims.length>1){let n=t.format==="NHWC"?t.spatial?e[0].dims.slice(-1):e[0].dims.slice(-1).concat(e[0].dims.slice(1,e[0].dims.length-1)):e[0].dims.slice(1,t.spatial?2:void 0);r(e[1].dims,n,"Invalid input scale"),r(e[2].dims,n,"Invalid input B"),r(e[3].dims,n,"Invalid input mean"),r(e[4].dims,n,"Invalid input var")}else r(e[1].dims,[1],"Invalid input scale"),r(e[2].dims,[1],"Invalid input B"),r(e[3].dims,[1],"Invalid input mean"),r(e[4].dims,[1],"Invalid input var")},QU=(e,t)=>{let{epsilon:r,spatial:n,format:i}=t,o=e[0].dims,s=n?Os(o[o.length-1]):1,a=i==="NHWC"&&o.length>1?s:1,u=br.size(o)/s,d=n,m=d?o.length:o,g=kr("x",e[0].dataType,e[0].dims,s),_=kr("scale",e[1].dataType,e[1].dims,a),y=kr("bias",e[2].dataType,e[2].dims,a),M=kr("inputMean",e[3].dataType,e[3].dims,a),x=kr("inputVar",e[4].dataType,e[4].dims,a),E=Fn("y",e[0].dataType,m,s),T=()=>{let C="";if(n)C=`let cOffset = ${o.length===1?"0u":i==="NHWC"?`outputIndices[${o.length-1}] / ${s}`:"outputIndices[1]"};`;else if(i==="NCHW")C=`
            ${E.indicesSet("outputIndices","0","0")}
            let cOffset = ${E.indicesToOffset("outputIndices")};`;else{C=`var cIndices = ${_.type.indices}(0);
                       cIndices[0] = outputIndices[${o.length-1}];`;for(let D=1;D<_.rank;D++)C+=`cIndices[${D}] = outputIndices[${D}];`;C+=`let cOffset = ${_.indicesToOffset("cIndices")};`}return C},P=C=>`
  const epsilon = ${r};
  ${C.registerUniform("outputSize","u32").declareVariables(g,_,y,M,x,E)}
  ${C.mainStart()}
  ${C.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
    var outputIndices = ${E.offsetToIndices(`global_idx * ${s}`)};
    ${T()}
    let scale = ${_.getByOffset("cOffset")};
    let bias = ${y.getByOffset("cOffset")};
    let inputMean = ${M.getByOffset("cOffset")};
    let inputVar = ${x.getByOffset("cOffset")};
    let x = ${g.getByOffset("global_idx")};
    let value = (x - inputMean) * inverseSqrt(inputVar + epsilon) * scale + bias;
    ${E.setByOffset("global_idx","value")}
  }`;return{name:"BatchNormalization",shaderCache:{hint:`${t.epsilon}_${t.format}_${n}_${s}`,inputDependencies:d?["rank","type","type","type","type"]:void 0},getShaderSource:P,getRunData:()=>({outputs:[{dims:e[0].dims,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:d?[{type:12,data:u},...Kn(o)]:[{type:12,data:u}]})}},JU=e=>Jo(e),Ene=(e,t)=>{let{inputs:r,outputCount:n}=e,i=JU({...t,outputCount:n});if(Ua.webgpu.validateInputContent&&YU(r,i),t.trainingMode)throw new Error("BatchNormalization trainingMode is not supported yet.");e.compute(QU(r,i))}}),eV,tV,Ane,bPe=nn(()=>{ji(),Bi(),eV=e=>{if(e[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![320,640,1280].includes(e[0].dims[2]))throw new Error("number of channels should be 320, 640 or 1280");if(e[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},tV=e=>{let t=e[0].dims,r=e[0].dims[2],n=br.size(t)/4,i=e[0].dataType,o=kr("input",i,t,4),s=kr("bias",i,[r],4),a=kr("residual",i,t,4),u=Fn("output",i,t,4);return{name:"BiasAdd",getRunData:()=>({outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(n/64)}}),getShaderSource:d=>`
  const channels = ${r}u / 4;
  ${d.declareVariables(o,s,a,u)}

  ${d.mainStart()}
    ${d.guardAgainstOutOfBoundsWorkgroupSizes(n)}
    let value = ${o.getByOffset("global_idx")}
      + ${s.getByOffset("global_idx % channels")} + ${a.getByOffset("global_idx")};
    ${u.setByOffset("global_idx","value")}
  }`}},Ane=e=>{eV(e.inputs),e.compute(tV(e.inputs))}}),rV,qo,Cne,kne,Ine,One,Lne,Dne,$ne,Nne,jne,nV,Rne,Fne,zne,Bne,Zw,Une,DE,Vne,Wne,Gne,qne,Hne,Kne,Zne,Xne,Yne,Qne,Jne,eie,tie,rie,nie,iie,M3,oie,qD,HD,aie,sie,lie,iV,oV,cie,AR=nn(()=>{yi(),ji(),Zs(),Bi(),rV=(e,t,r,n,i,o,s)=>{let a=Math.ceil(t/4),u="";typeof i=="string"?u=`${i}(a)`:u=i("a");let d=kr("inputData",r,[a],4),m=Fn("outputData",n,[a],4),g=[{name:"vec_size",type:"u32"}];return s&&g.push(...s),`
      ${e.registerUniforms(g).declareVariables(d,m)}

  ${o??""}

  ${e.mainStart()}
    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}

    let a = ${d.getByOffset("global_idx")};
    ${m.setByOffset("global_idx",u)}
  }`},qo=(e,t,r,n,i,o=e.dataType,s,a)=>{let u=[{type:12,data:Math.ceil(br.size(e.dims)/4)}];return s&&u.push(...s),{name:t,shaderCache:{hint:i,inputDependencies:["type"]},getShaderSource:d=>rV(d,br.size(e.dims),e.dataType,o,r,n,a),getRunData:d=>({outputs:[{dims:e.dims,dataType:o}],dispatchGroup:{x:Math.ceil(br.size(d[0].dims)/64/4)},programUniforms:u})}},Cne=e=>{e.compute(qo(e.inputs[0],"Abs","abs"))},kne=e=>{e.compute(qo(e.inputs[0],"Acos","acos"))},Ine=e=>{e.compute(qo(e.inputs[0],"Acosh","acosh"))},One=e=>{e.compute(qo(e.inputs[0],"Asin","asin"))},Lne=e=>{e.compute(qo(e.inputs[0],"Asinh","asinh"))},Dne=e=>{e.compute(qo(e.inputs[0],"Atan","atan"))},$ne=e=>{e.compute(qo(e.inputs[0],"Atanh","atanh"))},Nne=e=>Jo(e),jne=(e,t)=>{let r;switch(t.to){case 10:r="vec4<f16>";break;case 1:r="vec4<f32>";break;case 12:r="vec4<u32>";break;case 6:r="vec4<i32>";break;case 9:r="vec4<bool>";break;default:throw new RangeError(`not supported type (specified in attribute 'to' from 'Cast' operator): ${t.to}`)}e.compute(qo(e.inputs[0],"Cast",r,void 0,t.cacheKey,t.to))},nV=e=>{let t,r,n=e.length>=2&&e[1].data!==0,i=e.length>=3&&e[2].data!==0;switch(e[0].dataType){case 1:t=n?e[1].getFloat32Array()[0]:-34028234663852886e22,r=i?e[2].getFloat32Array()[0]:34028234663852886e22;break;case 10:t=n?e[1].getUint16Array()[0]:64511,r=i?e[2].getUint16Array()[0]:31743;break;default:throw new Error("Unsupport data type")}return Jo({min:t,max:r})},Rne=(e,t)=>{let r=t||nV(e.inputs),n=Mu(e.inputs[0].dataType);e.compute(qo(e.inputs[0],"Clip",i=>`clamp(${i}, vec4<${n}>(uniforms.min), vec4<${n}>(uniforms.max))`,void 0,r.cacheKey,void 0,[{type:e.inputs[0].dataType,data:r.min},{type:e.inputs[0].dataType,data:r.max}],[{name:"min",type:n},{name:"max",type:n}]),{inputs:[0]})},Fne=e=>{e.compute(qo(e.inputs[0],"Ceil","ceil"))},zne=e=>{e.compute(qo(e.inputs[0],"Cos","cos"))},Bne=e=>{e.compute(qo(e.inputs[0],"Cosh","cosh"))},Zw=e=>Jo(e),Une=(e,t)=>{let r=Mu(e.inputs[0].dataType);e.compute(qo(e.inputs[0],"Elu",n=>`elu_vf32(${n})`,`
  const elu_alpha_ = ${r}(${t.alpha});

  fn elu_f32(a: ${r}) -> ${r} {
  return select((exp(a) - 1.0) * elu_alpha_, a, a >= 0.0);
  }

  fn elu_vf32(v: vec4<${r}>) -> vec4<${r}> {
  return vec4(elu_f32(v.x), elu_f32(v.y), elu_f32(v.z), elu_f32(v.w));
  }`,t.cacheKey))},DE=(e="f32")=>`
const r0: ${e} = 0.3275911;
const r1: ${e} = 0.254829592;
const r2: ${e} = -0.284496736;
const r3: ${e} = 1.421413741;
const r4: ${e} = -1.453152027;
const r5: ${e} = 1.061405429;

fn erf_vf32(v: vec4<${e}>) -> vec4<${e}> {
  let absv = abs(v);
  let x = 1.0 / (1.0 + r0 * absv);
  return sign(v) * (1.0 - ((((r5 * x + r4) * x + r3) * x + r2) * x + r1) * x * exp(-absv * absv));
}`,Vne=e=>{let t=Mu(e.inputs[0].dataType);e.compute(qo(e.inputs[0],"Erf",r=>`erf_vf32(${r})`,DE(t)))},Wne=e=>{e.compute(qo(e.inputs[0],"Exp","exp"))},Gne=e=>{e.compute(qo(e.inputs[0],"Floor","floor"))},qne=e=>{let t=Mu(e.inputs[0].dataType);e.compute(qo(e.inputs[0],"Gelu",r=>`0.5 * ${r} * (1.0 + erf_vf32(${r} * 0.7071067811865475))`,DE(t)))},Hne=(e,t)=>{let r=Mu(e.inputs[0].dataType);e.compute(qo(e.inputs[0],"LeakyRelu",n=>`select(leaky_relu_alpha_ * ${n}, ${n}, ${n} >= vec4<${r}>(0.0))`,`const leaky_relu_alpha_ = ${r}(${t.alpha});`,t.cacheKey))},Kne=e=>{e.compute(qo(e.inputs[0],"Not",t=>`!${t}`))},Zne=e=>{e.compute(qo(e.inputs[0],"Neg",t=>`-${t}`))},Xne=e=>{e.compute(qo(e.inputs[0],"Reciprocal",t=>`1.0/${t}`))},Yne=e=>{let t=Mu(e.inputs[0].dataType);e.compute(qo(e.inputs[0],"Relu",r=>`select(vec4<${t}>(0.0), ${r}, ${r} > vec4<${t}>(0.0))`))},Qne=e=>{e.compute(qo(e.inputs[0],"Sigmoid",t=>`(1.0 / (1.0 + exp(-${t})))`))},Jne=e=>Jo(e),eie=(e,t)=>{let r=Mu(e.inputs[0].dataType);e.compute(qo(e.inputs[0],"HardSigmoid",n=>`max(vec4<${r}>(0.0), min(vec4<${r}>(1.0), ${t.alpha} * ${n} + vec4<${r}>(${t.beta})))`,void 0,t.cacheKey))},tie=e=>{e.compute(qo(e.inputs[0],"Sin","sin"))},rie=e=>{e.compute(qo(e.inputs[0],"Sinh","sinh"))},nie=e=>{e.compute(qo(e.inputs[0],"Sqrt","sqrt"))},iie=e=>{e.compute(qo(e.inputs[0],"Tan","tan"))},M3=e=>`sign(${e}) * (1 - exp(-2 * abs(${e}))) / (1 + exp(-2 * abs(${e})))`,oie=e=>{e.compute(qo(e.inputs[0],"Tanh",M3))},qD=(e="f32")=>`
const fast_gelu_a: ${e} = 0.5;
const fast_gelu_b: ${e} = 0.7978845608028654;
const fast_gelu_c: ${e} = 0.035677408136300125;

fn tanh_v(v: vec4<${e}>) -> vec4<${e}> {
  return ${M3("v")};
}
`,HD=e=>`(fast_gelu_a + fast_gelu_a * tanh_v(${e} * (fast_gelu_c * ${e} * ${e} + fast_gelu_b))) * ${e}`,aie=e=>{let t=Mu(e.inputs[0].dataType);e.compute(qo(e.inputs[0],"FastGelu",HD,qD(t),void 0,e.inputs[0].dataType))},sie=(e,t)=>{let r=Mu(e.inputs[0].dataType);return e.compute(qo(e.inputs[0],"ThresholdedRelu",n=>`select(vec4<${r}>(0.0), ${n}, ${n} > thresholded_relu_alpha_)`,`const thresholded_relu_alpha_ = vec4<${r}>(${t.alpha});`,t.cacheKey)),0},lie=e=>{e.compute(qo(e.inputs[0],"Log","log"))},iV=(e,t)=>`
const alpha = vec4<${e}>(${t});
const one = ${e}(1.0);
const zero = ${e}(0.0);

fn quick_gelu_impl(x: vec4<${e}>) -> vec4<${e}> {
  let v = x *alpha;
  var x1 : vec4<${e}>;
  for (var i = 0; i < 4; i = i + 1) {
    if (v[i] >= zero) {
      x1[i] = one / (one + exp(-v[i]));
    } else {
      x1[i] = one - one / (one + exp(v[i]));
    }
  }
  return x * x1;
}
`,oV=e=>`quick_gelu_impl(${e})`,cie=(e,t)=>{let r=Mu(e.inputs[0].dataType);e.compute(qo(e.inputs[0],"QuickGelu",oV,iV(r,t.alpha),t.cacheKey,e.inputs[0].dataType))}}),aV,sV,uie,xPe=nn(()=>{ji(),Bi(),AR(),aV=e=>{if(e[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![2560,5120,10240].includes(e[0].dims[2]))throw new Error("hidden state should be 2560, 5120 or 10240");if(e[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},sV=e=>{let t=e[0].dims.slice();t[2]=t[2]/2;let r=kr("input",e[0].dataType,e[0].dims,4),n=kr("bias",e[0].dataType,[e[0].dims[2]],4),i=Fn("output",e[0].dataType,t,4),o=br.size(t)/4,s=mc(e[0].dataType);return{name:"BiasSplitGelu",getRunData:()=>({outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(o/64)}}),getShaderSource:a=>`
  const M_SQRT2 = sqrt(2.0);
  const halfChannels = ${e[0].dims[2]/4/2}u;

  ${a.declareVariables(r,n,i)}

  ${DE(s)}

  ${a.mainStart()}
    ${a.guardAgainstOutOfBoundsWorkgroupSizes(o)}
    let biasIdx = global_idx % halfChannels;
    let batchIndex = global_idx / halfChannels;
    let inputOffset = biasIdx + batchIndex * halfChannels * 2;
    let valueLeft = input[inputOffset] + bias[biasIdx];
    let valueRight = input[inputOffset + halfChannels] + bias[biasIdx + halfChannels];
    let geluRight = valueRight * 0.5 * (erf_vf32(valueRight / M_SQRT2) + 1);

    ${i.setByOffset("global_idx","valueLeft * geluRight")}
  }`}},uie=e=>{aV(e.inputs),e.compute(sV(e.inputs))}}),lV,cV,vf,die,hie,fie,pie,mie,gie,_ie,yie,vie,bie,wPe=nn(()=>{yi(),ji(),Bi(),lV=(e,t,r,n,i,o,s,a,u,d,m,g)=>{let _,y;typeof a=="string"?_=y=(P,C)=>`${a}((${P}),(${C}))`:typeof a=="function"?_=y=a:(_=a.scalar,y=a.vector);let M=Fn("outputData",m,n.length,4),x=kr("aData",u,t.length,4),E=kr("bData",d,r.length,4),T;if(i)if(o){let P=br.size(t)===1,C=br.size(r)===1,D=t.length>0&&t[t.length-1]%4===0,L=r.length>0&&r[r.length-1]%4===0;P||C?T=M.setByOffset("global_idx",y(P?`${x.type.value}(${x.getByOffset("0")}.x)`:x.getByOffset("global_idx"),C?`${E.type.value}(${E.getByOffset("0")}.x)`:E.getByOffset("global_idx"))):T=`
            let outputIndices = ${M.offsetToIndices("global_idx * 4u")};
            let offsetA = ${x.broadcastedIndicesToOffset("outputIndices",M)};
            let offsetB = ${E.broadcastedIndicesToOffset("outputIndices",M)};
            ${M.setByOffset("global_idx",y(s||D?x.getByOffset("offsetA / 4u"):`${x.type.value}(${x.getByOffset("offsetA / 4u")}[offsetA % 4u])`,s||L?E.getByOffset("offsetB / 4u"):`${E.type.value}(${E.getByOffset("offsetB / 4u")}[offsetB % 4u])`))}
          `}else T=M.setByOffset("global_idx",y(x.getByOffset("global_idx"),E.getByOffset("global_idx")));else{if(!o)throw new Error("no necessary to use scalar implementation for element-wise binary op implementation.");let P=(C,D,L="")=>{let N=`aData[indexA${D}][componentA${D}]`,j=`bData[indexB${D}][componentB${D}]`;return`
            let outputIndices${D} = ${M.offsetToIndices(`global_idx * 4u + ${D}u`)};
            let offsetA${D} = ${x.broadcastedIndicesToOffset(`outputIndices${D}`,M)};
            let offsetB${D} = ${E.broadcastedIndicesToOffset(`outputIndices${D}`,M)};
            let indexA${D} = offsetA${D} / 4u;
            let indexB${D} = offsetB${D} / 4u;
            let componentA${D} = offsetA${D} % 4u;
            let componentB${D} = offsetB${D} % 4u;
            ${C}[${D}] = ${L}(${_(N,j)});
          `};m===9?T=`
            var data = vec4<u32>(0);
            ${P("data",0,"u32")}
            ${P("data",1,"u32")}
            ${P("data",2,"u32")}
            ${P("data",3,"u32")}
            outputData[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:T=`
            ${P("outputData[global_idx]",0)}
            ${P("outputData[global_idx]",1)}
            ${P("outputData[global_idx]",2)}
            ${P("outputData[global_idx]",3)}
          `}return`
        ${e.registerUniform("vec_size","u32").declareVariables(x,E,M)}

        ${g??""}

        ${e.mainStart()}
        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
        ${T}
      }`},cV=(e,t,r,n,i,o,s=r.dataType)=>{let a=r.dims.map(x=>Number(x)??1),u=n.dims.map(x=>Number(x)??1),d=!br.areEqual(a,u),m=a,g=br.size(a),_=!1,y=!1,M=[d];if(d){let x=Y1.calcShape(a,u,!1);if(!x)throw new Error("Can't perform binary op on the given tensors");m=x.slice(),g=br.size(m);let E=br.size(a)===1,T=br.size(u)===1,P=a.length>0&&a[a.length-1]%4===0,C=u.length>0&&u[u.length-1]%4===0;M.push(E),M.push(T),M.push(P),M.push(C);let D=1;for(let L=1;L<m.length;L++){let N=a[a.length-L],j=u[u.length-L];if(N===j)D*=N;else break}D%4===0?(y=!0,_=!0):(E||T||P||C)&&(_=!0)}else _=!0;return M.push(_),{name:e,shaderCache:{hint:t+M.map(x=>x.toString()).join("_"),inputDependencies:["rank","rank"]},getShaderSource:x=>lV(x,a,u,m,_,d,y,i,r.dataType,n.dataType,s,o),getRunData:()=>({outputs:[{dims:m,dataType:s}],dispatchGroup:{x:Math.ceil(g/64/4)},programUniforms:[{type:12,data:Math.ceil(br.size(m)/4)},...Kn(a,u,m)]})}},vf=(e,t,r,n,i,o)=>{e.compute(cV(t,i??"",e.inputs[0],e.inputs[1],r,n,o))},die=e=>{vf(e,"Add",(t,r)=>`${t}+${r}`)},hie=e=>{vf(e,"Div",(t,r)=>`${t}/${r}`)},fie=e=>{vf(e,"Equal",{scalar:(t,r)=>`u32(${t}==${r})`,vector:(t,r)=>`vec4<u32>(${t}==${r})`},void 0,void 0,9)},pie=e=>{vf(e,"Mul",(t,r)=>`${t}*${r}`)},mie=e=>{let t=kr("input",e.inputs[0].dataType,e.inputs[0].dims).type.value;vf(e,"Pow",{scalar:(r,n)=>`pow_custom(${r},${n})`,vector:(r,n)=>`pow_vector_custom(${r},${n})`},`
    fn pow_custom(a : ${t}, b : ${t}) -> ${t} {
      if (b == ${t}(0.0)) {
        return ${t}(1.0);
      } else if (a < ${t}(0.0) && f32(b) != floor(f32(b))) {
        return ${t}(pow(f32(a), f32(b))); // NaN
      }
      return select(sign(a), ${t}(1.0), round(f32(abs(b) % ${t}(2.0))) != 1.0) * ${t}(${t==="i32"?"round":""}(pow(f32(abs(a)), f32(b))));
    }
    fn pow_vector_custom(a : vec4<${t}>, b : vec4<${t}>) -> vec4<${t}> {
      // TODO: implement vectorized pow
      return vec4<${t}>(pow_custom(a.x, b.x), pow_custom(a.y, b.y), pow_custom(a.z, b.z), pow_custom(a.w, b.w));
    }
      `)},gie=e=>{vf(e,"Sub",(t,r)=>`${t}-${r}`)},_ie=e=>{vf(e,"Greater",{scalar:(t,r)=>`u32(${t}>${r})`,vector:(t,r)=>`vec4<u32>(${t}>${r})`},void 0,void 0,9)},yie=e=>{vf(e,"Less",{scalar:(t,r)=>`u32(${t}<${r})`,vector:(t,r)=>`vec4<u32>(${t}<${r})`},void 0,void 0,9)},vie=e=>{vf(e,"GreaterOrEqual",{scalar:(t,r)=>`u32(${t}>=${r})`,vector:(t,r)=>`vec4<u32>(${t}>=${r})`},void 0,void 0,9)},bie=e=>{vf(e,"LessOrEqual",{scalar:(t,r)=>`u32(${t}<=${r})`,vector:(t,r)=>`vec4<u32>(${t}<=${r})`},void 0,void 0,9)}}),uV,dV,hV,fV,xie,wie,MPe=nn(()=>{yi(),ji(),Zs(),Bi(),uV=(e,t)=>{if(!e||e.length<1)throw new Error("too few inputs");let r=0,n=e[r],i=n.dataType,o=n.dims.length;e.forEach((s,a)=>{if(a!==r){if(s.dataType!==i)throw new Error("input tensors should be one type");if(s.dims.length!==o)throw new Error("input tensors should have the same shape");s.dims.forEach((u,d)=>{if(d!==t&&u!==n.dims[d])throw new Error("non concat dimensions must match")})}})},dV=(e,t)=>`
  fn calculateInputIndex(index: u32) -> u32 {
    let sizeInConcatAxis = array<u32, ${e}u>(${t});
    for (var i: u32 = 0u; i < ${e}; i += 1u ) {
      if (index < sizeInConcatAxis[i]) {
        return i;
      }
    }
    return ${e}u;
  }`,hV=(e,t)=>{let r=e.length,n=[];for(let i=0;i<r;++i){let o=t.setByOffset("global_idx",e[i].getByIndices("indices"));r===1?n.push(o):i===0?n.push(`if (inputIndex == ${i}u) { ${o} }`):i===r-1?n.push(`else { ${o} }`):n.push(`else if (inputIndex == ${i}) { ${o} }`)}return n.join(`
`)},fV=(e,t,r,n)=>{let i=br.size(r),o=new Array(e.length),s=new Array(e.length),a=0,u=[],d=[],m=[{type:12,data:i}];for(let x=0;x<e.length;++x)a+=e[x].dims[t],o[x]=a,d.push(e[x].dims.length),s[x]=kr(`input${x}`,n,d[x]),u.push("rank"),m.push({type:12,data:o[x]});for(let x=0;x<e.length;++x)m.push(...Kn(e[x].dims));m.push(...Kn(r));let g=Fn("output",n,r.length),_=g.indicesGet("indices",t),y=Array.from(Array(o.length).keys()).map(x=>`uniforms.sizeInConcatAxis${x}`).join(","),M=x=>`

  ${(()=>{x.registerUniform("outputSize","u32");for(let E=0;E<e.length;E++)x.registerUniform(`sizeInConcatAxis${E}`,"u32");return x.declareVariables(...s,g)})()}

  ${dV(o.length,y)}

  ${x.mainStart()}
    ${x.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

    var indices = ${g.offsetToIndices("global_idx")};

    let inputIndex = calculateInputIndex(${_});
    if (inputIndex != 0u) {
      let sizeInConcatAxis = array<u32, ${o.length}u>(${y});
      ${_} -= sizeInConcatAxis[inputIndex - 1u];
    }

    ${hV(s,g)}
  }`;return{name:"Concat",shaderCache:{hint:`${t}`,inputDependencies:u},getRunData:()=>({outputs:[{dims:r,dataType:n}],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:m}),getShaderSource:M}},xie=(e,t)=>{let r=e.inputs,n=r[0].dims,i=br.normalizeAxis(t.axis,n.length);uV(r,i);let o=n.slice();o[i]=r.reduce((a,u)=>a+(u.dims.length>i?u.dims[i]:0),0);let s=r.filter(a=>br.size(a.dims)>0);e.compute(fV(s,i,o,r[0].dataType),{inputs:s})},wie=e=>Jo({axis:e.axis})}),u0,d0,h0,CR,D0=nn(()=>{yi(),ji(),u0=(e,t,r="f32")=>{switch(e.activation){case"Relu":return`value = max(value, ${t}(0.0));`;case"Sigmoid":return`value = (${t}(1.0) / (${t}(1.0) + exp(-value)));`;case"Clip":return`value = clamp(value, ${t}(${r}(uniforms.clip_min)), ${t}(${r}(uniforms.clip_max)));`;case"HardSigmoid":return`value = max(${t}(0.0), min(${t}(1.0), ${r}(uniforms.alpha) * value + ${r}(uniforms.beta)));`;case"LeakyRelu":return`value = select(${r}(uniforms.alpha) * value, value, value >= ${t}(0.0));`;case"Tanh":return`let e2x = exp(-2.0 * abs(value));
              value = sign(value) * (1.0 - e2x) / (1.0 + e2x);
        `;case"":return"";default:throw new Error(`Unsupported activation ${e.activation}`)}},d0=(e,t)=>{e.activation==="Clip"?t.push({type:1,data:e.clipMax},{type:1,data:e.clipMin}):e.activation==="HardSigmoid"?t.push({type:1,data:e.alpha},{type:1,data:e.beta}):e.activation==="LeakyRelu"&&t.push({type:1,data:e.alpha})},h0=(e,t)=>{e.activation==="Clip"?t.push({name:"clip_max",type:"f32"},{name:"clip_min",type:"f32"}):e.activation==="HardSigmoid"?t.push({name:"alpha",type:"f32"},{name:"beta",type:"f32"}):e.activation==="LeakyRelu"&&t.push({name:"alpha",type:"f32"})},CR=e=>{let t=(e==null?void 0:e.activation)||"";if(t==="HardSigmoid"){let[r,n]=(e==null?void 0:e.activation_params)||[.2,.5];return{activation:t,alpha:r,beta:n}}else if(t==="Clip"){let[r,n]=(e==null?void 0:e.activation_params)||[Kre,Zre];return{activation:t,clipMax:n,clipMin:r}}else if(t==="LeakyRelu"){let[r]=(e==null?void 0:e.activation_params)||[.01];return{activation:t,alpha:r}}return{activation:t}}}),Lc,Mie,kR=nn(()=>{Lc=(e,t)=>{switch(e){case 1:return t;case 2:return`vec2<${t}>`;case 3:return`vec3<${t}>`;case 4:return`vec4<${t}>`;default:throw new Error(`${e}-component is not supported.`)}},Mie=e=>`
      ${e?"value = value + getBiasByOutputCoords(coords);":""}
      `}),Sie,SPe=nn(()=>{Sie=e=>`
fn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {
  return dot(coords, vec4<i32>(
      shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));
}
fn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {
  return dot(coords, vec4<i32>(
    i32(${e}.x), i32(${e}.y), i32(${e}.z), 1));
}
`}),g2,IR,OR=nn(()=>{yi(),ji(),Bi(),D0(),g2=(e,t,r,n,i)=>{let o=n-r;return`
      ${Array.from({length:r}).map((s,a)=>`
      if (${Wn(t.shape,a,t.rank)} != 1) {
        ${t.indicesSet(e,a,Wn(i,a+o,n))}
      } else {
        ${t.indicesSet(e,a,0)}
      }`).join("")}
`},IR=(e,t,r,n,i=!1,o)=>{let s=e[0].dims,a=e[1].dims,u=s[s.length-2],d=a[a.length-1],m=s[s.length-1],g=Os(d),_=Os(m),y=Os(u),M=br.size(r)/g/y,x=e.length>2,E=n?n.slice(0,-2):r.slice(0,-2),T=[br.size(E),u,d],P=[{type:12,data:M},{type:12,data:u},{type:12,data:d},{type:12,data:m}];d0(t,P),P.push(...Kn(E,s,a)),x&&P.push(...Kn(e[2].dims)),P.push(...Kn(T));let C=D=>{let L=TR("batch_dims",e[0].dataType,E.length),N=kr("a",e[0].dataType,s.length,_),j=kr("b",e[1].dataType,a.length,g),$=Fn("output",e[0].dataType,T.length,g),U=mc($.type.tensor),G=u0(t,$.type.value,U),H=[N,j],X="";if(x){let de=i?g:1;H.push(kr("bias",e[2].dataType,e[2].dims.length,de)),X=`${i?`value += bias[col / ${de}];`:`value += ${$.type.value}(bias[row + i]);`}`}let ee=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"}];h0(t,ee);let ae=()=>{let de=`var a_data: ${N.type.value};`;for(let ye=0;ye<_;ye++)de+=`
              let b_data${ye} = b[(b_offset + (k + ${ye}) * uniforms.N + col) / ${g}];`;for(let ye=0;ye<y;ye++){de+=`a_data = a[(a_offset + (row + ${ye}) * uniforms.K + k) / ${_}];`;for(let _e=0;_e<_;_e++)de+=`
            values[${ye}] = fma(${j.type.value}(a_data${_===1?"":`[${_e}]`}), b_data${_e}, values[${ye}]);
`}return de};return`
  ${D.registerUniforms(ee).registerInternalVariables(L).declareVariables(...H,$)}
  ${D.mainStart()}
    ${D.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let col = (global_idx % (uniforms.N / ${g})) * ${g};
    var index1 = global_idx / (uniforms.N / ${g});
    let stride1 = uniforms.M / ${y};
    let row = (index1 % stride1) * ${y};
    let batch = index1 / stride1;

    ${r.length===2?"":`let batch_indices = ${L.offsetToIndices("batch")};`}

    var a_indices: ${N.type.indices};
    ${g2("a_indices",N,N.rank-2,L.rank,"batch_indices")}
    ${N.indicesSet("a_indices",N.rank-2,0)}
    ${N.indicesSet("a_indices",N.rank-1,0)}
    let a_offset = ${N.indicesToOffset("a_indices")};

    var b_indices: ${j.type.indices};
    ${g2("b_indices",j,j.rank-2,L.rank,"batch_indices")}
    ${j.indicesSet("b_indices",j.rank-2,0)}
    ${j.indicesSet("b_indices",j.rank-1,0)}
    let b_offset = ${j.indicesToOffset("b_indices")};
    var values: array<${$.type.value}, ${y}>;
    for (var k: u32 = 0u; k < uniforms.K; k = k + ${_}) {
      ${ae()}
    }
    for (var i = 0u; i < ${y}u; i++) {
      var value = values[i];
      ${X}
      ${G}
      let cur_indices = ${$.type.indices}(batch, row + i, col);
      let offset = ${$.indicesToOffset("cur_indices")};
      ${$.setByOffset(`offset / ${g}`,"value")};
    }
  }
  `};return{name:"MatMulNaive",shaderCache:{hint:`${t.activation};${g};${_};${y};${i}`,inputDependencies:x?["rank","rank","rank"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:o?o(r):r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(M/64)},programUniforms:P}),getShaderSource:C}}}),pV,mV,KD,S3,gV,ZD,_V,$A,LR=nn(()=>{yi(),ji(),Bi(),D0(),OR(),kR(),pV=(e,t)=>e?`
        mm_Asub[inputRow][inputCol] = mm_readA(batch,
          kStart + inputRow,
          globalRowStart / innerElementSize + inputCol${t?", batchIndices":""});
        `:`
        mm_Asub[inputRow][inputCol] = mm_readA(batch,
          globalRow + innerRow,
          kStart / innerElementSize + inputCol${t?", batchIndices":""});
        `,mV=(e,t)=>e?`
        let ACached0 = mm_Asub[k * innerElementSize][localRow];
        let ACached1 = mm_Asub[k * innerElementSize + 1][localRow];
        let ACached2 = mm_Asub[k * innerElementSize + 2][localRow];
        ${t===3?"":"let ACached3 = mm_Asub[k * innerElementSize + 3][localRow];"}
        for (var i = 0; i < rowPerThread; i = i + 1) {
          acc[i] = BCached0 * ACached0[i] + acc[i];
          acc[i] = BCached1 * ACached1[i] + acc[i];
          acc[i] = BCached2 * ACached2[i] + acc[i];
          ${t===3?"":"acc[i] = BCached3 * ACached3[i] + acc[i];"}
        }`:`
        for (var i = 0; i < rowPerThread; i = i + 1) {
          let ACached = mm_Asub[tileRow + i][k];
          acc[i] = BCached0 * ACached.x + acc[i];
          acc[i] = BCached1 * ACached.y + acc[i];
          acc[i] = BCached2 * ACached.z + acc[i];
          ${t===3?"":"acc[i] = BCached3 * ACached.w + acc[i];"}
        }`,KD=(e,t,r="f32",n,i=!1,o=32,s=!1,a=32)=>{let u=t[1]*e[1],d=t[0]*e[0],m=i?u:o,g=i?o:u,_=m/t[0],y=o/t[1];if(!((i&&_===4&&e[1]===4||!i&&(_===3||_===4))&&m%t[0]===0&&o%t[1]===0&&e[0]===4))throw new Error(`If transposeA ${i} is true, innerElementSize ${_} and workPerThread[1] ${e[1]} must be 4.
      Otherwise, innerElementSize ${_} must be 3 or 4.
  tileAWidth ${m} must be divisible by workgroupSize[0]${t[0]}. tileInner ${o} must be divisible by workgroupSize[1] ${t[1]}. colPerThread ${e[0]} must be 4.`);return`
var<workgroup> mm_Asub: array<array<vec${_}<${r}>, ${m/_}>, ${g}>;
var<workgroup> mm_Bsub: array<array<vec4<${r}>, ${d/e[0]}>, ${o}>;

const rowPerThread = ${e[1]};
const colPerThread = ${e[0]};
const innerElementSize = ${_};
const tileInner = ${o};

@compute @workgroup_size(${t[0]}, ${t[1]}, ${t[2]})
fn main(@builtin(local_invocation_id) localId : vec3<u32>,
        @builtin(global_invocation_id) globalId : vec3<u32>,
        @builtin(workgroup_id) workgroupId : vec3<u32>) {
  let localRow = i32(localId.y);
  let tileRow = localRow * rowPerThread;
  let tileCol = i32(localId.x);

  let globalRow =i32(globalId.y) * rowPerThread;
  let globalCol = i32(globalId.x);
  let batch = ${s?"0":"i32(globalId.z)"};
  ${n?`let batchIndices = ${n.offsetToIndices("u32(batch)")};`:""}
  let globalRowStart = i32(workgroupId.y) * ${u};

  let num_tiles = ${s?`${Math.ceil(a/o)}`:"(uniforms.dim_inner - 1) / tileInner + 1"};
  var kStart = ${s?`i32(globalId.z) * ${a}`:"0"};

  var acc: array<vec4<${r}>, rowPerThread>;

  // Loop over shared dimension.
  let tileRowB = localRow * ${y};
  for (var t = 0; t < num_tiles; t = t + 1) {
      // Load one tile of A into local memory.
      for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
          let inputRow = tileRow + innerRow;
          let inputCol = tileCol;
          ${pV(i,n)}
      }

      // Load one tile of B into local memory.
      for (var innerRow = 0; innerRow < ${y}; innerRow = innerRow + 1) {
          let inputRow = tileRowB + innerRow;
          let inputCol = tileCol;
          mm_Bsub[inputRow][inputCol] = mm_readB(batch, kStart + inputRow, globalCol${n?", batchIndices":""});
      }
      kStart = kStart + tileInner;
      workgroupBarrier();

      // Compute acc values for a single thread.
      for (var k = 0; k < tileInner / innerElementSize; k = k + 1) {
          let BCached0 = mm_Bsub[k * innerElementSize][tileCol];
          let BCached1 = mm_Bsub[k * innerElementSize + 1][tileCol];
          let BCached2 = mm_Bsub[k * innerElementSize + 2][tileCol];
          ${_===3?"":"let BCached3 = mm_Bsub[k * innerElementSize + 3][tileCol];"}

          ${mV(i,_)}
      }

      workgroupBarrier();
  }

  for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);
  }
}`},S3=(e,t)=>e?`
            mm_Asub[inputRow][inputCol] = mm_readA(batch,
              kStart + inputRow,
              globalRowStart + inputCol${t?", batchIndices":""});
            `:`
            mm_Asub[inputRow][inputCol] = mm_readA(batch,
              globalRowStart + inputRow,
              kStart + inputCol${t?", batchIndices":""});
            `,gV=e=>e?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];",ZD=(e,t,r="f32",n,i=!1,o=32,s=!1,a=32,u=!1)=>{let d=e[1]*t[1],m=e[0]*t[0],g=i?d:o,_=i?o:d;if(!(_%t[1]===0&&g%t[0]===0&&o%t[1]===0))throw new Error(`tileAHight ${_} must be divisible by workgroupSize[1]${t[1]}, tileAWidth ${g} must be divisible by workgroupSize[0]${t[0]}, tileInner ${o} must be divisible by workgroupSize[1]${t[1]}`);let y=_/t[1],M=g/t[0],x=o/t[1],E=u?`
    let localRow = i32(localId.y);
    let localCol = i32(localId.x);
    let globalRowStart = i32(workgroupId.y) * ${d};
    let globalColStart = i32(workgroupId.x) * ${m};

    // Loop over shared dimension.
    for (var t = 0; t < num_tiles; t = t + 1) {
      // Load one tile of A into local memory.
      for (var inputRow = localRow; inputRow < ${_}; inputRow = inputRow + ${t[1]}) {
        for (var inputCol = localCol; inputCol < ${g}; inputCol = inputCol + ${t[0]}) {
          ${S3(i,n)}
        }
      }
      // Load one tile of B into local memory.
      for (var inputRow = localRow; inputRow < ${o}; inputRow = inputRow + ${t[1]}) {
            for (var inputCol = localCol; inputCol < ${m}; inputCol = inputCol + ${t[0]}) {
          mm_Bsub[inputRow][inputCol] = mm_readB(batch,
            kStart + inputRow,
            globalColStart + inputCol${n?", batchIndices":""});
        }
      }
      kStart = kStart + tileInner;
      workgroupBarrier();

      // Compute acc values for a single thread.
      var BCached : array<${r}, colPerThread>;
      for (var k = 0; k < tileInner; k = k + 1) {
        for (var inner = 0; inner < colPerThread; inner = inner + 1) {
          BCached[inner] = mm_Bsub[k][localCol + inner * ${t[0]}];
        }
        for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
          let ACached = ${i?`mm_Asub[k][localRow + innerRow * ${t[1]}];`:`mm_Asub[localRow + innerRow * ${t[1]}][k];`}
          for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
            acc[innerRow][innerCol] = acc[innerRow][innerCol] +
                ACached * BCached[innerCol];
          }
        }
      }
      workgroupBarrier();
    }
    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      let gRow = globalRowStart + localRow + innerRow * ${t[1]};
      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
        let gCol = globalColStart + localCol + innerCol * ${t[0]};
        mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);
      }
    }
    `:`
let tileRow = i32(localId.y) * rowPerThread;
let tileCol = i32(localId.x) * colPerThread;

let globalRow = i32(globalId.y) * rowPerThread;
let globalCol = i32(globalId.x) * colPerThread;
let globalRowStart = i32(workgroupId.y) * ${d};

let tileRowA = i32(localId.y) * ${y};
let tileColA = i32(localId.x) * ${M};
let tileRowB = i32(localId.y) * ${x};
// Loop over shared dimension.
for (var t = 0; t < num_tiles; t = t + 1) {
  // Load one tile of A into local memory.
  for (var innerRow = 0; innerRow < ${y}; innerRow = innerRow + 1) {
    for (var innerCol = 0; innerCol < ${M}; innerCol = innerCol + 1) {
      let inputRow = tileRowA + innerRow;
      let inputCol = tileColA + innerCol;
      ${S3(i,n)}
    }
  }

  // Load one tile of B into local memory.
  for (var innerRow = 0; innerRow < ${x}; innerRow = innerRow + 1) {
    for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
      let inputRow = tileRowB + innerRow;
      let inputCol = tileCol + innerCol;
      mm_Bsub[inputRow][inputCol] = mm_readB(batch,
        kStart + inputRow,
        globalCol + innerCol${n?", batchIndices":""});
    }
  }
  kStart = kStart + tileInner;
  workgroupBarrier();

  // Compute acc values for a single thread.
  var BCached : array<${r}, colPerThread>;
  for (var k = 0; k < tileInner; k = k + 1) {
    for (var inner = 0; inner < colPerThread; inner = inner + 1) {
      BCached[inner] = mm_Bsub[k][tileCol + inner];
    }

    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      ${gV(i)}
      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
        acc[innerRow][innerCol] = acc[innerRow][innerCol] + ACached * BCached[innerCol];
      }
    }
  }

  workgroupBarrier();
}

for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
  for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
    mm_write(batch, globalRow + innerRow, globalCol + innerCol,
        acc[innerRow][innerCol]);
  }
}
`;return`
  var<workgroup> mm_Asub : array<array<${r}, ${g}>, ${_}>;
  var<workgroup> mm_Bsub : array<array<${r}, ${m}>, ${o}>;
  const rowPerThread = ${e[1]};
  const colPerThread = ${e[0]};
  const tileInner = ${o};

@compute @workgroup_size(${t[0]}, ${t[1]}, ${t[2]})
fn main(@builtin(local_invocation_id) localId : vec3<u32>,
        @builtin(global_invocation_id) globalId : vec3<u32>,
        @builtin(workgroup_id) workgroupId : vec3<u32>) {
    let batch = ${s?"0":"i32(globalId.z)"};
    ${n?`let batchIndices = ${n.offsetToIndices("u32(batch)")};`:""}
    let num_tiles = ${s?`${Math.ceil(a/o)}`:"(uniforms.dim_inner - 1) / tileInner + 1"};
    var kStart = ${s?`i32(globalId.z) * ${a}`:"0"};

    var acc : array<array<${r}, colPerThread>, rowPerThread>;
    ${E}
  }
`},_V=(e,t,r,n,i=!1)=>{let[o,s,a,u]=n,d=mc(n[0].type.tensor);return`
    fn mm_readA(batch: i32, row: i32, colIn: i32, batchIndices: ${o.type.indices}) -> ${Lc(e,d)} {
      var value = ${Lc(e,d)}(0.0);
      let col = colIn * ${e};
      if(row < uniforms.dim_a_outer && col < uniforms.dim_inner)
      {
        var aIndices: ${s.type.indices};
        ${g2("aIndices",s,s.rank-2,o.rank,"batchIndices")}
        ${s.indicesSet("aIndices",s.rank-2,"u32(row)")}
        ${s.indicesSet("aIndices",s.rank-1,"u32(colIn)")}
        value = ${s.getByIndices("aIndices")};
      }
      return value;
    }

    fn mm_readB(batch: i32, row: i32, colIn: i32, batchIndices: ${o.type.indices}) -> ${Lc(e,d)} {
      var value = ${Lc(e,d)}(0.0);
      let col = colIn * ${e};
      if(row < uniforms.dim_inner && col < uniforms.dim_b_outer)
      {
        var bIndices: ${a.type.indices};
        ${g2("bIndices",a,a.rank-2,o.rank,"batchIndices")}
        ${a.indicesSet("bIndices",a.rank-2,"u32(row)")}
        ${a.indicesSet("bIndices",a.rank-1,"u32(colIn)")}
        value = ${a.getByIndices("bIndices")};
      }
      return value;
    }

    fn mm_write(batch: i32, row: i32, colIn: i32, valueIn: ${Lc(e,d)}) {
      let col = colIn * ${e};
      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer) {
        var value = valueIn;
        let coords = vec3<i32>(batch, row, colIn);
        ${t?`value = value + ${i?"bias[colIn]":`${Lc(e,d)}(bias[row])`};`:""}
        ${r}
        ${u.setByIndices("vec3<u32>(coords)","value")}
      }
    }
    `},$A=(e,t,r,n,i=!1,o)=>{let s=e[0].dims,a=e[1].dims,u=s.slice(0,-2),d=a.slice(0,-2),m=n?n.slice(0,-2):r.slice(0,-2),g=br.size(m),_=s[s.length-2],y=s[s.length-1],M=a[a.length-1],x=y%4===0&&M%4===0,E=_<=8?[4,1,1]:[4,4,1],T=[8,8,1],P=[Math.ceil(M/T[0]/E[0]),Math.ceil(_/T[1]/E[1]),Math.ceil(g/T[2]/E[2])],C=x?4:1,D=[...u,_,y/C],L=D.length,N=[...d,y,M/C],j=N.length,$=[g,_,M/C],U=[{type:6,data:_},{type:6,data:M},{type:6,data:y}];d0(t,U),U.push(...Kn(m,D,N));let G=["rank","rank"],H=e.length>2;H&&(U.push(...Kn(e[2].dims)),G.push("rank")),U.push(...Kn($));let X=ee=>{let ae=m.length,de=TR("batchDims",e[0].dataType,ae,1),ye=mc(e[0].dataType),_e=kr("a",e[0].dataType,L,C),ue=kr("b",e[1].dataType,j,C),fe=Fn("result",e[0].dataType,$.length,C),De=[_e,ue];if(H){let $e=i?C:1;De.push(kr("bias",e[2].dataType,e[2].dims.length,$e))}let pe=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"}];h0(t,pe);let K=mc(fe.type.tensor),te=u0(t,fe.type.value,K),ve=_V(C,H,te,[de,_e,ue,fe],i);return`
  ${ee.registerUniforms(pe).registerInternalVariables(de).declareVariables(...De,fe)}
  ${ve}
  ${x?KD(E,T,ye,de):ZD(E,T,ye,de)}
                   `};return{name:"MatMul",shaderCache:{hint:`${E};${t.activation};${x};${i}`,inputDependencies:G},getRunData:()=>({outputs:[{dims:o?o(r):r,dataType:e[0].dataType}],dispatchGroup:{x:P[0],y:P[1],z:P[2]},programUniforms:U}),getShaderSource:X}}}),yV,Tie,TPe=nn(()=>{yi(),eg(),Bi(),D0(),kR(),SPe(),LR(),yV=(e,t,r,n,i=!1,o,s=4,a=4,u=4,d="f32")=>{let m=U=>{switch(U){case 1:return"resData = x[xIndex];";case 3:return`resData = vec3<${d}>(x[xIndex], x[xIndex + 1], x[xIndex + 2]);`;case 4:return"resData = x[xIndex / 4];";default:throw new Error(`innerElementSize ${U} is not supported.`)}},g=U=>{switch(U){case 1:return"return w[row * i32(uniforms.w_shape[3]) + colIn];";case 4:return"return w[row * i32(uniforms.w_shape[3]) / 4 + colIn];";default:throw new Error(`innerElementSize ${U} is not supported.`)}},_=e?`
    let coord = vec4<i32>(batch, xRow, xCol, xCh);
    `:`
    let coord = vec4<i32>(batch, xCh, xRow, xCol);
    `,y=e?`
    let coords = vec4<i32>(
      batch,
      row / outWidth,
      row % outWidth,
      col);
    `:`
    let coords = vec4<i32>(
      batch,
      row,
      col / outWidth,
      col % outWidth);
    `,M=e?"i32(uniforms.x_shape[1])":"i32(uniforms.x_shape[2])",x=e?"i32(uniforms.x_shape[2])":"i32(uniforms.x_shape[3])",E=e?"row":"col",T=e?"col":"row",P=`
    let inChannels = i32(uniforms.w_shape[2]);
    let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};
    let outRow = ${E} / outWidth;
    let outCol = ${E} % outWidth;

    let WRow = ${T} / (i32(uniforms.w_shape[1]) * inChannels);
    let WCol = ${T} / inChannels % i32(uniforms.w_shape[1]);
    let xRow = outRow * uniforms.stride[0] + uniforms.dilation[0] * WRow - uniforms.pad[0];
    let xCol = outCol * uniforms.stride[1] + uniforms.dilation[1] * WCol - uniforms.pad[1];
    let xCh = ${T} % inChannels;
    var resData = ${Lc(s,d)}(0.0);
    // The bounds checking is always needed since we use it to pad zero for
    // the 'same' padding type.
    if (xRow >= 0 && xRow < ${M} && xCol >= 0 && xCol < ${x}) {
      ${_}
      let xIndex = getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape));
      ${m(s)}
    }
    return resData;`,C=e?t&&n?`
    let col = colIn * ${s};
    ${P}`:`
    let col = colIn * ${s};
    if (row < uniforms.dim_a_outer && col < uniforms.dim_inner) {
      ${P}
    }
    return ${Lc(s,d)}(0.0);`:n&&r?`
    let col = colIn * ${s};
    ${P}`:`
    let col = colIn * ${s};
    if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {
      ${P}
    }
    return ${Lc(s,d)}(0.0);`,D=e?n&&r?g(a):`
    let col = colIn * ${a};
    if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {
      ${g(a)}
    }
    return ${Lc(a,d)}(0.0);`:`
    let col = colIn * ${a};
    if (row < uniforms.dim_inner && col < uniforms.dim_a_outer) {
      ${g(a)}
    }
    return ${Lc(a,d)}(0.0);`,L=Lc(u,d),N=Lc(e?s:a,d),j=Lc(e?a:s,d),$=u0(o,L,d);return`
    fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${N} {
      ${e?C:D}
    }

    fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${j} {
      ${e?D:C}
    }

    fn mm_write(batch: i32, row : i32, colIn : i32, valueIn : ${L}) {
      let col = colIn * ${u};
      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer)
      {
      var value = valueIn;
      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};
      ${y}
      ${Mie(i)}
      ${$}
      setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
      }
    }`},Tie=(e,t,r,n,i,o,s,a,u)=>{let d=t.format==="NHWC",m=d?e[0].dims[3]:e[0].dims[1],g=r[0],_=d?r[2]:r[3],y=d?r[1]:r[2],M=d?r[3]:r[1],x=d&&(m%4===0||m%3===0)&&M%4===0,E=d?M:_*y,T=d?_*y:M,P=[8,8,1],C=n<=8?[4,1,1]:[4,4,1],D=[Math.ceil(E/P[0]/C[0]),Math.ceil(T/P[1]/C[1]),Math.ceil(g/P[2]/C[2])];Do("verbose",()=>`[conv2d_mm_webgpu] dispatch = ${D}`);let L=x?d&&m%4!==0?3:4:1,N=P[1]*C[1],j=P[0]*C[0],$=Math.max(P[0]*L,P[1]),U=n%N===0,G=i%j===0,H=o%$===0,X=x?[L,4,4]:[1,1,1],ee=[{type:6,data:n},{type:6,data:i},{type:6,data:o},{type:6,data:[t.pads[0],t.pads[1]]},{type:6,data:t.strides},{type:6,data:t.dilations}];d0(t,ee),ee.push(...Kn(e[0].dims,e[1].dims));let ae=["rank","rank"];s&&(ee.push(...Kn(e[2].dims)),ae.push("rank")),ee.push(...Kn(r));let de=ye=>{let _e=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"},{name:"pad",type:"i32",length:2},{name:"stride",type:"i32",length:2},{name:"dilation",type:"i32",length:2}];h0(t,_e);let ue=x?4:1,fe=mc(e[0].dataType),De=`
      fn setOutputAtIndex(flatIndex : i32, value : ${x?`vec4<${fe}>`:fe}) {
        result[flatIndex] = ${x?`vec4<${fe}>`:fe}(value);
      }
      fn setOutputAtCoords(d0 : i32, d1 : i32, d2 : i32, d3 : i32, value : ${x?`vec4<${fe}>`:fe}) {
        let flatIndex = getOutputIndexFromCoords(vec4<i32>(d0, d1, d2, d3));
        setOutputAtIndex(flatIndex ${x?"/ 4":""}, value);
      }`,pe=kr("x",e[0].dataType,e[0].dims.length,L===3?1:L),K=kr("w",e[1].dataType,e[1].dims.length,ue),te=[pe,K],ve=Fn("result",e[0].dataType,r.length,ue);if(s){let $e=kr("bias",e[2].dataType,e[2].dims.length,ue);te.push($e),De+=`
        fn getBiasByOutputCoords(coords : vec4<i32>) -> ${x?`vec4<${fe}>`:fe} {
          return bias[coords.${d?"w":"y"}${x?"/ 4":""}];
        }`}return`
        ${Sie("uniforms.result_strides")}
        //struct Uniforms { xShape : vec4<i32>, wShape : vec4<i32>, outShape : vec4<i32>,
        //  outShapeStrides: vec3<i32>, filterDims : vec2<i32>, pad : vec2<i32>, stride : vec2<i32>,
        //  dilation : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32 };
        ${ye.registerUniforms(_e).declareVariables(...te,ve)}
        ${De}
        ${yV(d,U,G,H,s,t,X[0],X[1],X[2],fe)}
        ${x?KD(C,P,fe,void 0,!d,$):ZD(C,P,fe,void 0,!d,$,!1,void 0,a)}`};return{name:"Conv2DMatMul",shaderCache:{hint:`${t.cacheKey};${L};${x};${U};${G};${H};${N};${j};${$}`,inputDependencies:ae},getRunData:()=>({outputs:[{dims:u?u(r):r,dataType:e[0].dataType}],dispatchGroup:{x:D[0],y:D[1],z:D[2]},programUniforms:ee}),getShaderSource:de}}}),vV,T3,xw,bV,P3,xV,Pie,Eie,PPe=nn(()=>{yi(),eg(),ji(),Bi(),D0(),kR(),vV=e=>{let t=1;for(let r=0;r<e.length;r++)t*=e[r];return t},T3=e=>typeof e=="number"?[e,e,e]:e,xw=(e,t)=>t<=1?e:e+(e-1)*(t-1),bV=(e,t,r,n=1)=>{let i=xw(t,n);return Math.floor((e[0]*(r-1)-r+i)/2)},P3=(e,t,r,n,i)=>{i==null&&(i=bV(e,t[0],n[0]));let o=[0,0,0,r];for(let s=0;s<3;s++)e[s]+2*i>=t[s]&&(o[s]=Math.trunc((e[s]-t[s]+2*i)/n[s]+1));return o},xV=(e,t,r,n,i,o,s,a,u,d)=>{let m,g,_,y;if(e==="VALID"&&(e=0),typeof e=="number"){m={top:e,bottom:e,left:e,right:e,front:e,back:e};let M=P3([t,r,n,1],[a,u,d],1,[i,o,s],e);g=M[0],_=M[1],y=M[2]}else if(Array.isArray(e)){if(!e.every((x,E,T)=>x===T[0]))throw Error(`Unsupported padding parameter: ${e}`);m={top:e[0],bottom:e[1],left:e[2],right:e[3],front:e[4],back:e[5]};let M=P3([t,r,n,1],[a,u,d],1,[i,o,s],e[0]);g=M[0],_=M[1],y=M[2]}else if(e==="SAME_UPPER"){g=Math.ceil(t/i),_=Math.ceil(r/o),y=Math.ceil(n/s);let M=(g-1)*i+a-t,x=(_-1)*o+u-r,E=(y-1)*s+d-n,T=Math.floor(M/2),P=M-T,C=Math.floor(x/2),D=x-C,L=Math.floor(E/2),N=E-L;m={top:C,bottom:D,left:L,right:N,front:T,back:P}}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:m,outDepth:g,outHeight:_,outWidth:y}},Pie=(e,t,r,n,i,o=!1,s="channelsLast")=>{let a,u,d,m,g;if(s==="channelsLast")[a,u,d,m,g]=e;else if(s==="channelsFirst")[a,g,u,d,m]=e;else throw new Error(`Unknown dataFormat ${s}`);let[_,,y,M,x]=t,[E,T,P]=T3(r),[C,D,L]=T3(n),N=xw(y,C),j=xw(M,D),$=xw(x,L),{padInfo:U,outDepth:G,outHeight:H,outWidth:X}=xV(i,u,d,m,E,T,P,N,j,$),ee=o?_*g:_,ae=[0,0,0,0,0];return s==="channelsFirst"?ae=[a,ee,G,H,X]:s==="channelsLast"&&(ae=[a,G,H,X,ee]),{batchSize:a,dataFormat:s,inDepth:u,inHeight:d,inWidth:m,inChannels:g,outDepth:G,outHeight:H,outWidth:X,outChannels:ee,padInfo:U,strideDepth:E,strideHeight:T,strideWidth:P,filterDepth:y,filterHeight:M,filterWidth:x,effectiveFilterDepth:N,effectiveFilterHeight:j,effectiveFilterWidth:$,dilationDepth:C,dilationHeight:D,dilationWidth:L,inShape:e,outShape:ae,filterShape:t}},Eie=(e,t,r,n,i,o)=>{let s=o==="channelsLast";s?e[0].dims[3]:e[0].dims[1];let a=[64,1,1],u={x:r.map((E,T)=>T)},d=[Math.ceil(vV(u.x.map(E=>r[E]))/a[0]),1,1];Do("verbose",()=>`[conv3d_naive_webgpu] dispatch = ${d}`);let m=1,g=br.size(r),_=[{type:12,data:g},{type:12,data:n},{type:12,data:i},{type:12,data:t.strides},{type:12,data:t.dilations}];d0(t,_),_.push(...Kn(e[0].dims,e[1].dims));let y=["rank","rank"],M=e.length===3;M&&(_.push(...Kn(e[2].dims)),y.push("rank")),_.push(...Kn(r));let x=E=>{let T=[{name:"output_size",type:"u32"},{name:"filter_dims",type:"u32",length:n.length},{name:"pads",type:"u32",length:i.length},{name:"strides",type:"u32",length:t.strides.length},{name:"dilations",type:"u32",length:t.dilations.length}];h0(t,T);let P=1,C=mc(e[0].dataType),D=kr("x",e[0].dataType,e[0].dims.length,m),L=kr("W",e[1].dataType,e[1].dims.length,P),N=[D,L],j=Fn("result",e[0].dataType,r.length,P),$="";if(M){let H=kr("bias",e[2].dataType,e[2].dims.length,P);N.push(H),$+=`
        fn getBiasByOutputCoords(coords : array<u32, 5>) -> ${C} {
          return bias[${s?Wn("coords",4,5):Wn("coords",1,5)}];
        }`}let U=Lc(m,C),G=u0(t,U,C);return`
            ${$}
            fn getX(d0 : u32, d1 : u32, d2 : u32, d3 : u32, d4 : u32) -> f32 {
              let aIndices = array<u32, 5>(d0, d1, d2, d3, d4);
              return ${D.getByIndices("aIndices")};
            }
            fn getW(d0 : u32, d1 : u32, d2 : u32, d3 : u32, d4 : u32) -> f32 {
              let aIndices = array<u32, 5>(d0, d1, d2, d3, d4);
              return ${L.getByIndices("aIndices")};
            }
          ${E.registerUniforms(T).declareVariables(...N,j)}
          ${E.mainStart()}
          ${E.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
              let coords = ${j.offsetToIndices("global_idx")};
              let batch = ${Wn("coords",0,D.rank)};
              let d2 = ${s?Wn("coords",D.rank-1,D.rank):Wn("coords",1,D.rank)};
              let xFRCCorner = vec3<u32>(${s?Wn("coords",1,D.rank):Wn("coords",2,D.rank)},
              ${s?Wn("coords",2,D.rank):Wn("coords",3,D.rank)},
              ${s?Wn("coords",3,D.rank):Wn("coords",4,D.rank)}) * uniforms.strides - uniforms.pads;
              let xFCorner = xFRCCorner.x;
              let xRCorner = xFRCCorner.y;
              let xCCorner = xFRCCorner.z;
              let xShapeY = ${s?Wn("uniforms.x_shape",1,D.rank):Wn("uniforms.x_shape",2,D.rank)};
              let xShapeZ = ${s?Wn("uniforms.x_shape",2,D.rank):Wn("uniforms.x_shape",3,D.rank)};
              let xShapeW = ${s?Wn("uniforms.x_shape",3,D.rank):Wn("uniforms.x_shape",4,D.rank)};
              let xShapeU = ${s?Wn("uniforms.x_shape",4,D.rank):Wn("uniforms.x_shape",1,D.rank)};
              let inputDepthNearestVec4 = (xShapeU / 4) * 4;
              let inputDepthVec4Remainder = xShapeU % 4;

              var value = 0.0;
              for (var wF = 0u; wF < uniforms.filter_dims[0]; wF++) {
                let xF = xFCorner + wF * uniforms.dilations[0];
                if (xF < 0 || xF >= xShapeY) {
                  continue;
                }

                for (var wR = 0u; wR < uniforms.filter_dims[1]; wR++) {
                  let xR = xRCorner + wR * uniforms.dilations[1];
                  if (xR < 0 || xR >= xShapeZ) {
                    continue;
                  }

                  for (var wC = 0u; wC < uniforms.filter_dims[2]; wC++) {
                    let xC = xCCorner + wC * uniforms.dilations[2];
                    if (xC < 0 || xC >= xShapeW) {
                      continue;
                    }

                    for (var d1 = 0u; d1 < inputDepthNearestVec4; d1 += 4) {
                      ${s?`let xValues = vec4<f32>(
                               getX(batch, xF, xR, xC, d1),
                               getX(batch, xF, xR, xC, d1 + 1),
                               getX(batch, xF, xR, xC, d1 + 2),
                               getX(batch, xF, xR, xC, d1 + 3));
                            `:`let xValues = vec4<f32>(
                               getX(batch, d1, xF, xR, xC),
                               getX(batch, d1 + 1, xF, xR, xC),
                               getX(batch, d1 + 2, xF, xR, xC),
                               getX(batch, d1 + 3, xF, xR, xC));
                            `}
                            let wValues = vec4<f32>(
                              getW(d2, d1, wF, wR, wC),
                              getW(d2, d1 + 1, wF, wR, wC),
                              getW(d2, d1 + 2, wF, wR, wC),
                              getW(d2, d1 + 3, wF, wR, wC));
                      value += dot(xValues, wValues);
                    }
                    if (inputDepthVec4Remainder == 1) {
                        ${s?`value += getX(batch, xF, xR, xC, inputDepthNearestVec4)
                          * getW(d2, inputDepthNearestVec4, wF, wR, wC);`:`value += getX(batch, inputDepthNearestVec4, xF, xR, xC)
                          * getW(d2, inputDepthNearestVec4, wF, wR, wC);`}
                    } else if (inputDepthVec4Remainder == 2) {
                      ${s?`let xValues = vec2<f32>(
                        getX(batch, xF, xR, xC, inputDepthNearestVec4),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1));
                      `:`let xValues = vec2<f32>(
                        getX(batch, inputDepthNearestVec4, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 1, xF, xR, xC));
                    `}
                    let wValues = vec2<f32>(
                      getW(d2, inputDepthNearestVec4, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 1, wF, wR, wC));
                      value += dot(xValues, wValues);
                    } else if (inputDepthVec4Remainder == 3) {
                      ${s?`let xValues = vec3<f32>(
                        getX(batch, xF, xR, xC, inputDepthNearestVec4),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 2));
                      `:`let xValues = vec3<f32>(
                        getX(batch, inputDepthNearestVec4, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 1, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 2, xF, xR, xC));
                    `}
                    let wValues = vec3<f32>(
                      getW(d2, inputDepthNearestVec4, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 1, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 2, wF, wR, wC));
                      value += dot(xValues, wValues);
                    }
                  }
                }
              }
              ${M?"value = value + getBiasByOutputCoords(coords)":""};
              ${G}
              result[global_idx] = f32(value);
          }`};return{name:"Conv3DNaive",shaderCache:{hint:`${t.cacheKey};${s};${m};${M}`,inputDependencies:y},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:d[0],y:d[1],z:d[2]},programUniforms:_}),getShaderSource:x}}}),Aie,Cie,EPe=nn(()=>{yi(),ji(),Bi(),D0(),Aie=(e,t,r,n)=>{let i=e.length>2,o=i?"value += b[output_channel];":"",s=e[0].dims,a=e[1].dims,u=t.format==="NHWC",d=u?r[3]:r[1],m=d/t.group,g=u&&m>=4?Os(d):1,_=br.size(r)/g,y=[{type:12,data:_},{type:12,data:t.dilations},{type:12,data:[t.strides[0],t.strides[1]]},{type:12,data:[t.pads[0],t.pads[1]]},{type:12,data:m}];d0(t,y),y.push(...Kn(s,[a[0],a[1],a[2],a[3]/g]));let M=i?["rank","rank","rank"]:["rank","rank"];y.push(...Kn([r[0],r[1],r[2],r[3]/g]));let x=E=>{let T=Fn("output",e[0].dataType,r.length,g),P=mc(T.type.tensor),C=u0(t,T.type.value,P),D=kr("x",e[0].dataType,s.length),L=kr("w",e[1].dataType,a.length,g),N=[D,L];i&&N.push(kr("b",e[2].dataType,e[2].dims,g));let j=[{name:"output_size",type:"u32"},{name:"dilations",type:"u32",length:t.dilations.length},{name:"strides",type:"u32",length:2},{name:"pads",type:"u32",length:2},{name:"output_channels_per_group",type:"u32"}];h0(t,j);let $=u?`
      for (var wHeight: u32 = 0u; wHeight < uniforms.w_shape[0]; wHeight++) {
        let xHeight = xRCCorner.x + wHeight * uniforms.dilations[0];

        if (xHeight < 0u || xHeight >= uniforms.x_shape[1]) {
          continue;
        }

        for (var wWidth: u32 = 0u; wWidth < uniforms.w_shape[1]; wWidth++) {
          let xWidth = xRCCorner.y + wWidth * uniforms.dilations[1];
          if (xWidth < 0u || xWidth >= uniforms.x_shape[2]) {
            continue;
          }

          for (var wInChannel: u32 = 0u; wInChannel < uniforms.w_shape[2]; wInChannel++) {
            let input_channel = in_channel_offset + wInChannel;
            let xVal = ${D.get("batch","xHeight","xWidth","input_channel")};
            let wVal = ${L.get("wHeight","wWidth","wInChannel","output_channel")};
            value += xVal * wVal;
          }
        }
      }
      `:`
      for (var wInChannel: u32 = 0u; wInChannel < uniforms.w_shape[1]; wInChannel++) {
        let input_channel = in_channel_offset + wInChannel;
        for (var wHeight: u32 = 0u; wHeight < uniforms.w_shape[2]; wHeight++) {
          let xHeight = xRCCorner.x + wHeight * uniforms.dilations[0];

          if (xHeight < 0u || xHeight >= uniforms.x_shape[2]) {
            continue;
          }

          for (var wWidth: u32 = 0u; wWidth < uniforms.w_shape[3]; wWidth++) {
            let xWidth = xRCCorner.y + wWidth * uniforms.dilations[1];
            if (xWidth < 0u || xWidth >= uniforms.x_shape[3]) {
              continue;
            }

            let xVal = ${D.get("batch","input_channel","xHeight","xWidth")};
            let wVal = ${L.get("output_channel","wInChannel","wHeight","wWidth")};
            value += xVal * wVal;
          }
        }
      }
      `;return`
  ${E.registerUniforms(j).declareVariables(...N,T)}

  ${E.mainStart()}
    ${E.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let outputIndices = ${T.offsetToIndices("global_idx")};
    let batch: u32 = outputIndices[0];
    let output_channel: u32 = outputIndices[${u?3:1}];
    let xRCCorner: vec2<u32> = vec2<u32>(outputIndices[${u?1:2}], outputIndices[${u?2:3}]) * uniforms.strides - uniforms.pads;
    let group_id: u32 = output_channel * ${g} / uniforms.output_channels_per_group;
    var in_channel_offset = group_id * uniforms.w_shape[${u?2:1}];

    var value: ${T.type.value} = ${T.type.value}(0);
    ${$}
    ${o}
    ${C}
    ${T.setByOffset("global_idx","value")}
  }`};return{name:"GroupedConv",shaderCache:{hint:`${t.cacheKey}_${g}`,inputDependencies:M},getRunData:()=>({outputs:[{dims:n?n(r):r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(_/64)},programUniforms:y}),getShaderSource:x}},Cie=(e,t,r,n)=>{let i=e.length>2,o=Os(r[3]),s=Os(r[2]),a=br.size(r)/o/s,u=[e[0].dims[0],e[0].dims[1],e[0].dims[2],e[0].dims[3]/o],d=[e[1].dims[0],e[1].dims[1],e[1].dims[2],e[1].dims[3]/o],m=[r[0],r[1],r[2],r[3]/o],g=[{type:12,data:a},{type:6,data:[t.strides[0],t.strides[1]]},{type:6,data:[t.pads[0],t.pads[1]]}];d0(t,g),g.push(...Kn(u,d,m));let _=(s-1)*t.strides[1]+d[1],y=M=>{let x=Fn("output",e[0].dataType,m.length,o),E=mc(x.type.tensor),T=u0(t,x.type.value,E),P=kr("x",e[0].dataType,u.length,o),C=kr("w",e[1].dataType,d.length,o),D=[P,C];i&&D.push(kr("b",e[2].dataType,e[2].dims,o));let L=i?"value += b[output_channel];":"",N=[{name:"output_size",type:"u32"},{name:"strides",type:"i32",length:2},{name:"pads",type:"i32",length:2}];return h0(t,N),`
  ${M.registerUniforms(N).declareVariables(...D,x)}
  ${M.mainStart()}
    ${M.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let width0 = uniforms.output_shape[3];
    let output_channel = global_idx % width0;
    var index1 = global_idx / width0;
    let width1 = uniforms.output_shape[2] / ${s}u;
    let col = (index1 % width1) * ${s}u;
    index1 = index1 / width1;
    let row = index1 % uniforms.output_shape[1];
    let batch = index1 / uniforms.output_shape[1];

    let x_corner = vec2<i32>(i32(row), i32(col)) * uniforms.strides - uniforms.pads;

    var x_vals: array<${P.type.value}, ${_}>;
    var values: array<${x.type.value}, ${s}>;
    let input_channel = output_channel;
    // Use constant instead of uniform can give better performance for w's height/width.
    for (var w_height: u32 = 0u; w_height < ${d[0]}; w_height++) {
      let x_height = x_corner.x + i32(w_height);
      if (x_height >= 0 && u32(x_height) < uniforms.x_shape[1]) {
        for (var i = 0; i < ${_}; i++) {
          let x_width = x_corner.y + i;
          if (x_width >= 0 && u32(x_width) < uniforms.x_shape[2]) {
            x_vals[i] = ${P.get("batch","u32(x_height)","u32(x_width)","input_channel")};
          } else {
            x_vals[i] = ${P.type.value}(0);
          }
        }
        for (var w_width: u32 = 0u; w_width < ${d[1]}; w_width++) {
          let w_val = ${C.get("w_height","w_width","0","output_channel")};
          for (var i = 0u; i < ${s}u; i++) {
            values[i] = fma(x_vals[i * u32(uniforms.strides[1]) + w_width], w_val, values[i]);
          }
        }
      }
    }

    for (var i = 0u; i < ${s}u; i++) {
      var value = values[i];
      ${L}
      ${T}
      ${x.set("batch","row","col + i","output_channel","value")};
    }
  }`};return{name:"GroupedConv-Vectorize",shaderCache:{hint:`${t.cacheKey};${o};${s};${_};${d[0]};${d[1]}`,inputDependencies:i?["rank","rank","type"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:n?n(r):r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:g}),getShaderSource:y}}}),wV,IP,MV,OP,XD,E3,SV,TV,YD,APe=nn(()=>{ji(),TPe(),PPe(),LR(),EPe(),D0(),OR(),N_(),wV=(e,t,r,n,i,o)=>{let s=e[0],a=e.slice(o?1:2,o?3:4),u=a.length,d=t[0],m=t.slice(2).map((_,y)=>_+(_-1)*(r[y]-1)),g=a.map((_,y)=>_+n[y]+n[y+u]).map((_,y)=>Math.floor((_-m[y]+i[y])/i[y]));return g.splice(0,0,s),g.splice(o?3:1,0,d),g},IP=[2,3,1,0],MV=(e,t)=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(e[0].dims.length>5)throw new Error("greater than 5D is not supported");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");let r=e[0].dims[t.format==="NHWC"?e[0].dims.length-1:1],n=e[1].dims[1]*t.group;if(r!==n)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(e.length===3&&(e[2].dims.length!==1||e[1].dims[0]!==e[2].dims[0]))throw new Error("invalid bias");let i=e[0].dims.length-2;if(t.dilations.length!==i)throw new Error(`dilations should be ${i}D`);if(t.strides.length!==i)throw new Error(`strides should be ${i}D`);if(t.pads.length!==i*2)throw new Error(`pads should be ${i*2}D`);if(t.kernelShape.length!==0&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape")},OP=(e,t)=>{let r=e.kernelShape.slice();r.length<t[1].dims.length-2&&r.push(...Array(t[1].dims.length-2-r.length).fill(0));for(let o=2;o<t[1].dims.length;++o)r[o-2]===0&&(r[o-2]=t[1].dims[o]);let n=e.pads.slice();LA.adjustPadsBasedOnAutoPad(t[0].dims,e.strides,e.dilations,r,n,e.format==="NHWC",e.autoPad);let i=Object.assign({},e);return Object.assign(i,{kernelShape:r,pads:n}),i},XD=e=>{let t=CR(e),r=e.format,n=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],i=e.dilations,o=e.group,s=e.kernel_shape,a=e.pads,u=e.strides,d=e.w_is_const();return{autoPad:n,format:r,dilations:i,group:o,kernelShape:s,pads:a,strides:u,wIsConst:d,...t,cacheKey:`${e.format};${t.activation};`}},E3=(e,t,r,n)=>{let i=r.format==="NHWC",o=wV(t[0].dims,t[1].dims,r.dilations,r.pads,r.strides,i);if(r.group!==1){let N=[t[0]];if(i){let j=e.kernelCustomData.wT??e.compute(Jd(t[1],IP),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=j),N.push(j)}else N.push(t[1]);t.length===3&&N.push(t[2]),!e.adapterInfo.isArchitecture("ampere")&&i&&t[1].dims[0]===r.group&&t[1].dims[1]===1&&r.dilations[0]===1&&r.dilations[1]===1?e.compute(Cie(N,r,o,n),{inputs:N}):e.compute(Aie(N,r,o,n),{inputs:N});return}let s=t.length===3,a=t[0].dims[i?1:2],u=t[0].dims[i?2:3],d=t[0].dims[i?3:1],m=t[1].dims[2],g=t[1].dims[3],_=o[i?1:2],y=o[i?2:3],M=o[i?3:1],x=i&&m===a&&g===u&&r.pads[0]===0&&r.pads[1]===0;if(x||m===1&&g===1&&r.dilations[0]===1&&r.dilations[1]===1&&r.strides[0]===1&&r.strides[1]===1&&r.pads[0]===0&&r.pads[1]===0){let N=o[0],j,$,U,G=[];if(i){let ee=e.kernelCustomData.wT??e.compute(Jd(t[1],IP),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];if(r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=ee),x){let ae=a*u*d;j=t[0].reshape([1,N,ae]),$=ee.reshape([1,ae,M]),U=[1,N,M]}else j=t[0].reshape([N,a*u,d]),$=ee.reshape([1,d,M]),U=[N,_*y,M];G.push(j),G.push($)}else j=t[0].reshape([N,d,a*u]),$=t[1].reshape([1,M,d]),U=[N,M,_*y],G.push($),G.push(j);s&&G.push(t[2]);let H=U[2],X=G[0].dims[G[0].dims.length-1];H<8&&X<8?e.compute(IR(G,r,o,U,i,n),{inputs:G}):e.compute($A(G,r,o,U,i,n),{inputs:G});return}let E=!0,T=e.kernelCustomData.wT??e.compute(Jd(t[1],IP),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=T);let P=[t[0],T];s&&P.push(t[2]);let C=i?_*y:M,D=i?M:_*y,L=m*g*d;e.compute(Tie(P,r,o,C,D,L,s,E,n),{inputs:P})},SV=(e,t)=>{let r=t.format==="NHWC",n=[e.inputs[0].reshape(r?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];e.inputs.length===3&&n.push(e.inputs[2]);let i=[0,t.pads[0],0,t.pads[1]],o=[1].concat(t.strides),s=[1].concat(t.dilations),a=[1].concat(t.kernelShape),u=OP({...t,pads:i,strides:o,dilations:s,kernelShape:a},n);E3(e,n,u,d=>r?[d[0],d[2],d[3]]:[d[0],d[1],d[3]])},TV=(e,t,r)=>{let n=r.format==="NHWC"?"channelsLast":"channelsFirst",i=OP(r,t),o=r.autoPad==="NOTSET"?r.pads:r.autoPad,s=Pie(t[0].dims,t[1].dims,r.strides,r.dilations,o,!1,n);e.compute(Eie(t,i,s.outShape,[s.filterDepth,s.filterHeight,s.filterWidth],[s.padInfo.front,s.padInfo.top,s.padInfo.left],n))},YD=(e,t)=>{if(MV(e.inputs,t),e.inputs[0].dims.length===3)SV(e,t);else if(e.inputs[0].dims.length===5)TV(e,e.inputs,t);else{let r=OP(t,e.inputs);E3(e,e.inputs,r)}}}),kie,CPe=nn(()=>{yi(),eg(),ji(),Bi(),kie=(e,t,r)=>{let n=e.length>2,i=t.outputShape,o=t.format==="NHWC",s=t.group,a=e[1].dims,u=a[2]/s,d=a[3],m=o?Os(u):1,g=o&&d===1&&u>=4,_=g?Math.floor(u/4)*4:Math.floor(u/m)*m,y=u-_,M=o?Os(d):1,x=o?d===1?m:M:1,E=br.size(i)/M,T=[Math.ceil(E/64),1,1];Do("verbose",()=>`[conv2d_backprop_webgpu] dispatch = ${T}`);let P=["rank","rank"],C=[t.strides[0],t.strides[1]],D=[t.kernelShape[o?1:2],t.kernelShape[o?2:3]],L=[t.dilations[0],t.dilations[1]],N=[D[0]+(t.dilations[0]<=1?0:(t.kernelShape[o?1:2]-1)*(t.dilations[0]-1)),D[1]+(t.dilations[1]<=1?0:(t.kernelShape[o?2:3]-1)*(t.dilations[1]-1))],j=[N[0]-1-Math.floor((t.pads[0]+t.pads[2])/2),N[1]-1-Math.floor((t.pads[1]+t.pads[3])/2)],$=[{type:12,data:E},{type:12,data:C},{type:12,data:D},{type:12,data:L},{type:12,data:N},{type:6,data:j},{type:12,data:_},{type:12,data:u},{type:12,data:d},...Kn(e[0].dims,e[1].dims)];n&&($.push(...Kn(e[2].dims)),P.push("rank")),$.push(...Kn(i));let U=G=>{let H=[{name:"output_size",type:"u32"},{name:"strides",type:"u32",length:C.length},{name:"filter_dims",type:"u32",length:D.length},{name:"dilations",type:"u32",length:D.length},{name:"effective_filter_dims",type:"u32",length:N.length},{name:"pads",type:"i32",length:j.length},{name:"input_channels_per_group_int",type:"u32"},{name:"input_channels_per_group",type:"u32"},{name:"output_channels_per_group",type:"u32"}],X=mc(e[0].dataType),ee=o?1:2,ae=o?2:3,de=o?3:1,ye=kr("W",e[1].dataType,e[1].dims.length,x),_e=kr("Dy",e[0].dataType,e[0].dims.length,m),ue=[_e,ye];n&&ue.push(kr("bias",e[2].dataType,[i[de]].length,M));let fe=Fn("result",e[0].dataType,i.length,M),De=()=>{let te="";if(g)m===4?te+=`
        let xValue = ${_e.getByOffset("x_offset")};
        let wValue = ${ye.getByOffset("w_offset")};
        dotProd = dotProd + dot(xValue, wValue);
        x_offset += 1u;
        w_offset += 1u;`:m===2?te+=`
          dotProd = dotProd + dot(vec4<${X}>(${_e.getByOffset("x_offset")}, ${_e.getByOffset("x_offset + 1u")}), vec4<${X}>(${ye.getByOffset("w_offset")}, ${ye.getByOffset("w_offset + 1u")}));
          x_offset += 2u;
          w_offset += 2u;`:m===1&&(te+=`
          dotProd = dotProd + dot(vec4<${X}>(${_e.getByOffset("x_offset")}, ${_e.getByOffset("x_offset + 1u")}, ${_e.getByOffset("x_offset + 2u")}, ${_e.getByOffset("x_offset + 3u")}), vec4<${X}>(${ye.getByOffset("w_offset")}, ${ye.getByOffset("w_offset + 1u")}, ${ye.getByOffset("w_offset + 2u")}, ${ye.getByOffset("w_offset + 3u")}));
          x_offset += 4u;
          w_offset += 4u;`);else if(te+=`
                  let xValue = ${o?_e.getByOffset(`${_e.indicesToOffset(`${_e.type.indices}(batch, idyR, idyC, inputChannel)`)} / ${m}`):_e.get("batch","inputChannel","idyR","idyC")};
        `,m===1)te+=`
          let w_offset = ${ye.indicesToOffset(`${ye.type.indices}(u32(wRPerm), u32(wCPerm), inputChannel, wOutChannel)`)};
          let wValue = ${ye.getByOffset(`w_offset / ${x}`)};
          dotProd = dotProd + xValue * wValue;`;else for(let ve=0;ve<m;ve++)te+=`
            let wValue${ve} = ${ye.getByOffset(`${ye.indicesToOffset(`${ye.type.indices}(u32(wRPerm), u32(wCPerm), inputChannel + ${ve}, wOutChannel)`)} / ${x}`)};
            dotProd = dotProd + xValue[${ve}] * wValue${ve};`;return te},pe=()=>{if(y===0)return"";if(!g)throw new Error(`packInputAs4 ${g} is not true.`);let te="";if(m===1){te+="dotProd = dotProd";for(let ve=0;ve<y;ve++)te+=`
            + ${_e.getByOffset(`x_offset + ${ve}`)} * ${ye.getByOffset(`w_offset + ${ve}`)}`;te+=";"}else if(m===2){if(y!==2)throw new Error(`Invalid inputChannelsRemainder ${y}.`);te+=`
          let xValue = ${_e.getByOffset("x_offset")};
          let wValue = ${ye.getByOffset("w_offset")};
          dotProd = dotProd + dot(xValue, wValue);`}return te},K=`
            let outputIndices = ${fe.offsetToIndices(`global_idx * ${M}`)};
            let batch = ${fe.indicesGet("outputIndices",0)};
            let d1 = ${fe.indicesGet("outputIndices",de)};
            let r = ${fe.indicesGet("outputIndices",ee)};
            let c = ${fe.indicesGet("outputIndices",ae)};
            let dyCorner = vec2<i32>(i32(r), i32(c)) - uniforms.pads;
            let dyRCorner = dyCorner.x;
            let dyCCorner = dyCorner.y;
            let groupId = d1 / uniforms.output_channels_per_group;
            let wOutChannel = d1 - groupId * uniforms.output_channels_per_group;
            // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
            // ? = to be determined. : = across all values in that axis.
            var dotProd = ${fe.type.value}(0.0);
            var wR: u32 = 0;
            if (uniforms.dilations.x == 1) {
              // Minimum wR >= 0 that satisfies (dyRCorner + wR) % (uniforms.strides.x) == 0
              wR = u32(((dyRCorner + i32(uniforms.strides.x) - 1) / i32(uniforms.strides.x)) * i32(uniforms.strides.x) - dyRCorner);
            }
            for (; wR < uniforms.effective_filter_dims.x; wR = wR + 1) {
              if (wR % uniforms.dilations.x != 0) {
                continue;
              }
              let dyR = (${X}(dyRCorner) + ${X}(wR)) / ${X}(uniforms.strides[0]);
              let wRPerm = uniforms.filter_dims.x - 1 - wR / uniforms.dilations.x;
              if (dyR < 0.0 || dyR >= ${X}(uniforms.Dy_shape[${ee}]) || fract(dyR) > 0.0 ||
                  wRPerm < 0) {
                continue;
              }
              let idyR: u32 = u32(dyR);
              var wC: u32 = 0;
              if (uniforms.dilations.y == 1) {
                // Minimum wC >= 0 that satisfies (dyCCorner + wC) % (uniforms.strides.y) == 0
                wC = u32(((dyCCorner + i32(uniforms.strides.y) - 1) / i32(uniforms.strides.y)) * i32(uniforms.strides.y) - dyCCorner);
              }
              for (; wC < uniforms.effective_filter_dims.y; wC = wC + 1) {
                if (wC % uniforms.dilations.y != 0) {
                  continue;
                }
                let dyC = (${X}(dyCCorner) + ${X}(wC)) / ${X}(uniforms.strides.y);
                let wCPerm = uniforms.filter_dims.y - 1 - wC / uniforms.dilations.y;
                if (dyC < 0.0 || dyC >= ${X}(uniforms.Dy_shape[${ae}]) ||
                    fract(dyC) > 0.0 || wCPerm < 0) {
                  continue;
                }
                let idyC: u32 = u32(dyC);
                var inputChannel = groupId * uniforms.input_channels_per_group;
                ${g?`
                var x_offset = ${_e.indicesToOffset(`${_e.type.indices}(batch, idyR, idyC, inputChannel)`)} / ${m};
                var w_offset = ${ye.indicesToOffset(`${ye.type.indices}(wRPerm, wCPerm, inputChannel, wOutChannel)`)} / ${x};
                  `:""}
                for (var d2: u32 = 0; d2 < uniforms.input_channels_per_group_int; d2 = d2 + ${g?4:m}) {
                  ${De()}
                  inputChannel = inputChannel + ${g?4:m};
                }
                ${pe()}
                wC = wC + uniforms.strides.y - 1;
              }
              wR = wR + uniforms.strides[0] - 1;
            }
            let value = dotProd${n?` + bias[d1 / ${M}]`:""};
            ${fe.setByOffset("global_idx","value")};
          `;return`
    ${G.registerUniforms(H).declareVariables(...ue,fe)}
      ${G.mainStart()}
      ${G.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")};
    ${K}}`};return{name:"ConvTranspose2D",shaderCache:{hint:`${t.cacheKey};${m}${x}${M}${g}${y}`,inputDependencies:P},getRunData:()=>({dispatchGroup:{x:T[0],y:T[1],z:T[2]},outputs:[{dims:r?r(i):i,dataType:e[0].dataType}],programUniforms:$}),getShaderSource:U}}}),PV,EV,AV,A3,Iie,CV,C3,kV,Oie,kPe=nn(()=>{CPe(),D0(),N_(),PV=(e,t,r,n,i,o)=>(e-1)*t+r+(n-1)*i+1-o,EV=(e,t,r,n,i)=>{let o=Math.floor(e/2);t==="SAME_UPPER"?(r[n]=o,r[i]=e-o):t==="SAME_LOWER"&&(r[n]=e-o,r[i]=o)},AV=(e,t,r,n,i,o,s,a,u,d)=>{let m=e.length-2,g=d.length===0;u.length<m&&u.push(...Array(m-u.length).fill(0));let _=e[0],y=t[a?3:1]*i;for(let M=0,x=e.length-m-(a?1:0);M<m;++M,++x){let E=e[x],T=g?E*s[M]:d[M],P=PV(E,s[M],o[M],t[x],r[M],T);EV(P,n,o,M,M+m),g&&d.push(s[M]*(E-1)+u[M]+(t[x]-1)*r[M]+1-o[M]-o[M+m])}d.splice(0,0,_),d.splice(a?3:1,0,y)},A3=(e,t)=>{let r=e.kernelShape.slice();if(e.kernelShape.length===0||e.kernelShape.reduce((g,_)=>g*_,1)===0){r.length=0;for(let g=2;g<t[1].dims.length;++g)r.push(t[1].dims[g])}let n=e.format==="NHWC";r.splice(0,0,t[1].dims[0]),r.splice(n?3:1,0,t[1].dims[1]);let i=e.pads.slice(),o=e.outputShape.slice(),s=e.outputPadding.slice(),a=t[0].dims,u=e.dilations.slice();if(u.reduce((g,_)=>g+_,0)===0){let g=t[0].dims.length-2;u=new Array(g).fill(1)}let d=e.strides.slice();if(d.reduce((g,_)=>g+_,0)===0){let g=t[0].dims.length-2;d=new Array(g).fill(1)}AV(a,r,u,e.autoPad,e.group,i,d,n,s,o);let m=Object.assign({},e);return Object.assign(m,{kernelShape:r,pads:i,outputPadding:s,outputShape:o,dilations:u,strides:d}),m},Iie=e=>{let t=CR(e),r=e.format,n=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][typeof e.autoPad>"u"?0:e.autoPad],i=e.dilations,o=e.group,s=e.kernelShape,a=e.pads,u=e.strides,d=e.wIsConst(),m=e.outputPadding,g=e.outputShape;return{autoPad:n,format:r,dilations:i,group:o,kernelShape:s,outputPadding:m,outputShape:g,pads:a,strides:u,wIsConst:d,...t,cacheKey:`${e.format};${t.activation};`}},CV=(e,t)=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(e[0].dims.length!==4&&e[0].dims.length!==3)throw new Error("currently only support 2-dimensional conv");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");let r=e[0].dims[t.format==="NHWC"?e[0].dims.length-1:1],n=e[1].dims[0];if(r!==n)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");let i=e[1].dims[1]*t.group;if(e.length===3&&(e[2].dims.length!==1||e[2].dims[0]!==i))throw new Error("invalid bias");let o=e[0].dims.length-2;if(t.dilations.reduce((s,a)=>s+a,0)>0&&t.dilations.length!==o)throw new Error(`dilations should be ${o}D`);if(t.strides.reduce((s,a)=>s+a,0)>0&&t.strides.length!==o)throw new Error(`strides should be ${o}D`);if(t.pads.reduce((s,a)=>s+a,0)>0&&t.pads.length!==o*2)throw new Error(`pads should be ${o*2}D`);if(t.outputPadding.length!==o&&t.outputPadding.length!==0)throw new Error(`output_padding should be ${o}D`);if(t.kernelShape.reduce((s,a)=>s+a,0)>0&&t.kernelShape.length!==0&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if(t.outputShape.length!==0&&t.outputShape.length!==e[0].dims.length-2)throw new Error("invalid output shape")},C3=(e,t,r,n)=>{let i=e.kernelCustomData.wT??e.compute(Jd(t[1],[2,3,0,1]),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=i);let o=[t[0],i];t.length===3&&o.push(t[2]),e.compute(kie(o,r,n),{inputs:o})},kV=(e,t)=>{let r=t.format==="NHWC",n=[e.inputs[0].reshape(r?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];e.inputs.length===3&&n.push(e.inputs[2]);let i=t.kernelShape;(i.length===0||i[0]===0)&&(i=[e.inputs[1].dims[2]]);let o=t.dilations;(o.length===0||o[0]===0)&&(o=[1]);let s=t.strides;(s.length===0||s[0]===0)&&(s=[1]);let a=t.pads;a.length===0&&(a=[0,0]),a=[0,a[0],0,a[1]],s=[1].concat(s),o=[1].concat(o),i=[1].concat(i);let u=t.outputPadding;u=[0].concat(u);let d=A3({...t,pads:a,strides:s,dilations:o,kernelShape:i,outputPadding:u},n);C3(e,n,d,m=>r?[m[0],m[2],m[3]]:[m[0],m[1],m[3]])},Oie=(e,t)=>{if(CV(e.inputs,t),e.inputs[0].dims.length===3)kV(e,t);else{let r=A3(t,e.inputs);C3(e,e.inputs,r)}}}),IV,Lie,Die,IPe=nn(()=>{yi(),ji(),Zs(),Bi(),IV=(e,t,r,n)=>{let i=br.size(t),o=t.length,s=kr("input",e,o),a=Fn("output",e,o),u=r.dataType===6?r.getInt32Array()[0]:Number(r.getBigInt64Array()[0]),d=br.normalizeAxis(u,o),m=g=>{let _=` i32(${s.indicesGet("inputIndices","uniforms.axis")}) `,y=Wn("uniforms.input_shape","uniforms.axis",o),M=n.reverse?_+(n.exclusive?" + 1":""):"0",x=n.reverse?y:_+(n.exclusive?"":" + 1");return`
                ${g.registerUniform("outputSize","u32").registerUniform("axis","u32").declareVariables(s,a)}
                ${g.mainStart()}
                  ${g.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
                  var inputIndices = ${a.offsetToIndices("global_idx")};
                  var sum = ${a.type.value}(0);
                  let first : i32 = ${M};
                  let last : i32 = ${x};
                  for (var i : i32 = first; i < last; i++) {
                    ${s.indicesSet("inputIndices","uniforms.axis","u32(i)")};
                    sum = sum + ${s.getByIndices("inputIndices")};
                  }
                  ${a.setByOffset("global_idx","sum")};
                }`};return{name:"CumSum",shaderCache:{hint:n.cacheKey,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:t,dataType:e}],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:[{type:12,data:i},{type:12,data:d},...Kn(t,t)]}),getShaderSource:m}},Lie=(e,t)=>{let r=e.inputs[0].dims,n=e.inputs[0].dataType,i=e.inputs[1];e.compute(IV(n,r,i,t),{inputs:[0]})},Die=e=>{let t=e.exclusive===1,r=e.reverse===1;return Jo({exclusive:t,reverse:r})}}),OV,LV,DV,$ie,Nie,OPe=nn(()=>{yi(),ji(),Zs(),Bi(),OV=e=>{if(!e||e.length!==1)throw new Error("DepthToSpace requires 1 input.");if(e[0].dims.length!==4)throw new Error("DepthToSpace requires 4D input.")},LV=(e,t,r,n)=>{let i=[];i.push(`fn perm(i: ${n.type.indices}) -> ${r.type.indices} {
    var a: ${r.type.indices};`);for(let o=0;o<t;++o)i.push(r.indicesSet("a",e[o],`i[${o}]`));return i.push("return a;}"),i.join(`
`)},DV=(e,t)=>{let r,n,i,o,s,a,u=t.format==="NHWC",d=t.blocksize,m=t.mode==="DCR";u?([r,n,i,o]=e.dims,s=m?[r,n,i,d,d,o/d**2]:[r,n,i,o/d**2,d,d],a=m?[0,1,3,2,4,5]:[0,1,4,2,5,3]):([r,n,i,o]=[e.dims[0],e.dims[2],e.dims[3],e.dims[1]],s=m?[r,d,d,o/d**2,n,i]:[r,o/d**2,d,d,n,i],a=m?[0,3,4,1,5,2]:[0,1,4,2,5,3]);let g=e.reshape(s),_=g.dims.length,y=e.dataType,M=kr("a",y,_),x=Fn("output",y,_),E=T=>`
  ${T.registerUniform("output_size","u32").declareVariables(M,x)}

  ${LV(a,_,M,x)}

  ${T.mainStart()}
    ${T.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let indices = ${x.offsetToIndices("global_idx")};
    let aIndices = perm(indices);

    ${x.setByOffset("global_idx",M.getByIndices("aIndices"))}
  }`;return{name:"DepthToSpace",shaderCache:{hint:`${e.dims};${t.blocksize};${t.mode}`,inputDependencies:["rank"]},getRunData:T=>{let P=u?[r,n*d,i*d,o/d**2]:[r,o/d**2,n*d,i*d],C=br.size(P),D=g.dims,L=br.sortBasedOnPerm(D,a);return{outputs:[{dims:P,dataType:T[0].dataType}],dispatchGroup:{x:Math.ceil(C/64)},programUniforms:[{type:12,data:C},...Kn(D,L)]}},getShaderSource:E}},$ie=(e,t)=>{OV(e.inputs),e.compute(DV(e.inputs[0],t))},Nie=e=>Jo({blocksize:e.blocksize,mode:e.mode,format:e.format})}),LP,ww,k3,$V,NV,jV,RV,I3,FV,jie,Rie,LPe=nn(()=>{yi(),ji(),Zs(),Bi(),LP="[a-zA-Z]|\\.\\.\\.",ww="("+LP+")+",k3="^"+ww+"$",$V="("+ww+",)*"+ww,NV="^"+$V+"$",jV=class{constructor(e=-1){this.symbolToIndices=new Map,this.inputIndex=e}addSymbol(e,t){let r=this.symbolToIndices.get(e);r===void 0?r=[t]:r.push(t),this.symbolToIndices.set(e,r)}},RV=class{constructor(e,t){var i;this.equation=t,this.hasEllipsis=!1,this.symbolToInfo=new Map,this.lhs=new Array,this.outputDims=[];let[r,n]=t.includes("->")?t.split("->",2):[t,""];if(!r.match(RegExp(NV)))throw new Error("Invalid LHS term");if(r.split(",").forEach((o,s)=>{let a=e[s].dims.slice();if(!o.match(RegExp(k3)))throw new Error("Invalid LHS term");let u=this.processTerm(o,!0,a,s);this.lhs.push(u)}),n==="")n+=[...this.symbolToInfo.entries()].filter(([o,s])=>s.count===1||o==="...").map(([o])=>o).join("");else if(!n.match(RegExp(ww)))throw new Error("Invalid RHS");(i=n.match(RegExp(LP,"g")))==null||i.forEach(o=>{if(o==="...")this.outputDims=this.outputDims.concat(this.ellipsisDims);else{let s=this.symbolToInfo.get(o);if(s===void 0)throw new Error("Invalid RHS symbol");this.outputDims.push(s.dimValue)}}),this.rhs=this.processTerm(n,!1,this.outputDims)}addSymbol(e,t,r){let n=this.symbolToInfo.get(e);if(n!==void 0){if(n.dimValue!==t&&n.count!==1)throw new Error("Dimension mismatch");n.count++,n.inputIndices.push(r)}else n={count:1,dimValue:t,inputIndices:[r]};this.symbolToInfo.set(e,n)}processTerm(e,t,r,n=-1){let i=r.length,o=!1,s=[],a=0;if(!e.match(RegExp(k3))&&!t&&e!=="")throw new Error("Invalid LHS term");let u=e.match(RegExp(LP,"g")),d=new jV(n);return u==null||u.forEach((m,g)=>{if(m==="..."){if(o)throw new Error("Only one ellipsis is allowed per input term");o=!0;let _=i-u.length+1;if(_<0)throw new Error("Ellipsis out of bounds");if(s=r.slice(a,a+_),this.hasEllipsis){if(this.ellipsisDims.length!==s.length||this.ellipsisDims.toString()!==s.toString())throw new Error("Ellipsis dimensions mismatch")}else if(t)this.hasEllipsis=!0,this.ellipsisDims=s;else throw new Error("Ellipsis must be specified in the LHS");for(let y=0;y<s.length;y++){let M=String.fromCharCode(48+y);d.addSymbol(M,g+y),this.addSymbol(M,r[a++],n)}}else d.addSymbol(m,g+(this.hasEllipsis?this.ellipsisDims.length-1:0)),this.addSymbol(m,r[a++],n)}),d}},I3=e=>e+"_max",FV=(e,t,r,n)=>{let i=e.map(d=>d.length).map((d,m)=>kr(`input${m}`,t,d)),o=br.size(n),s=Fn("output",t,n.length),a=[...r.symbolToInfo.keys()].filter(d=>!r.rhs.symbolToIndices.has(d)),u=d=>{let m=[],g="var prod = 1.0;",_="var sum = 0.0;",y="sum += prod;",M=[],x=[],E=[],T=[],P=r.symbolToInfo.size===r.rhs.symbolToIndices.size;r.symbolToInfo.forEach((D,L)=>{var N;if(r.rhs.symbolToIndices.has(L)){let j=(N=r.rhs.symbolToIndices.get(L))==null?void 0:N[0];j!==void 0&&r.lhs.forEach(($,U)=>{if(D.inputIndices.includes(U)){let G=$.symbolToIndices.get(L);if(G===void 0)throw new Error("Invalid symbol error");G.forEach(H=>{m.push(`${i[U].indicesSet(`input${U}Indices`,H,s.indicesGet("outputIndices",j))}`)})}})}else r.lhs.forEach((j,$)=>{if(D.inputIndices.includes($)){let U=j.symbolToIndices.get(L);if(U===void 0)throw new Error("Invalid symbol error");U.forEach(G=>{M.push(`${i[$].indicesSet(`input${$}Indices`,G,`${L}`)}`)}),T.push(`prod *= ${i[$].getByIndices(`input${$}Indices`)};`)}}),x.push(`for(var ${L}: u32 = 0; ${L} < uniforms.${I3(L)}; ${L}++) {`),E.push("}")});let C=P?[...m,`let sum = ${i.map((D,L)=>D.getByIndices(`input${L}Indices`)).join(" * ")};`]:[...m,_,...x,...M,g,...T,y,...E];return`
            ${d.registerUniforms(a.map(D=>({name:`${I3(D)}`,type:"u32"}))).registerUniform("outputSize","u32").declareVariables(...i,s)}

            ${d.mainStart()}
            ${d.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
            var outputIndices = ${s.offsetToIndices("global_idx")};
            ${i.map((D,L)=>`var input${L}Indices: ${i[L].type.indices};`).join(`
`)}
            ${C.join(`
`)};
            ${s.setByOffset("global_idx","sum")};
          }`};return{name:"Einsum",shaderCache:{hint:r.equation,inputDependencies:e.map(()=>"rank")},getRunData:()=>{let d=a.filter(g=>r.symbolToInfo.has(g)).map(g=>{var _;return{type:12,data:((_=r.symbolToInfo.get(g))==null?void 0:_.dimValue)||0}});d.push({type:12,data:o});let m=e.map((g,_)=>[...Kn(g)]).reduce((g,_)=>g.concat(_),d);return m.push(...Kn(n)),{outputs:[{dims:n,dataType:t}],dispatchGroup:{x:Math.ceil(o/64)},programUniforms:m}},getShaderSource:u}},jie=(e,t)=>{let r=new RV(e.inputs,t.equation),n=r.outputDims,i=e.inputs.map((o,s)=>o.dims);e.compute(FV(i,e.inputs[0].dataType,r,n))},Rie=e=>{let t=e.equation.replace(/\s+/g,"");return Jo({equation:t})}}),zV,O3,BV,UV,Fie,DPe=nn(()=>{yi(),ji(),Bi(),zV=e=>{if(!e||e.length!==2)throw new Error("Expand requires 2 input.");let t=e[0].dims,r=Array.from(e[1].getBigInt64Array(),Number),n=r.length<t.length?0:r.length-t.length,i=t.length<r.length?0:t.length-r.length;for(;n<r.length&&i<t.length;++n,++i)if(r[n]!==t[i]&&r[n]!==1&&t[i]!==1)throw new Error("Expand requires shape to be broadcastable to input")},O3=(e,t)=>{let r=e.length-t.length,n=[];for(let i=0;i<r;++i)n.push(e[i]);for(let i=0;i<t.length;++i)n.push(t[i]===1?e[i+r]:t[i]);return n},BV=(e,t)=>e.length>t.length?O3(e,t):O3(t,e),UV=e=>{let t=e[0].dims,r=Array.from(e[1].getBigInt64Array(),Number),n=BV(t,r),i=e[0].dataType,o=i===9||br.size(t)===1,s=i===9||t.length>0&&t[t.length-1]%4===0?4:1,a=o||n.length>0&&n[n.length-1]%4===0?4:1,u=Math.ceil(br.size(n)/a),d=g=>{let _=kr("input",i,t.length,s),y=Fn("output",i,n.length,a),M;if(i===9){let x=(E,T,P="")=>`
          let outputIndices${T} = ${y.offsetToIndices(`outputOffset + ${T}u`)};
          let offset${T} = ${_.broadcastedIndicesToOffset(`outputIndices${T}`,y)};
          let index${T} = offset${T} / 4u;
          let component${T} = offset${T} % 4u;
          ${E}[${T}] = ${P}(${_.getByOffset(`index${T}`)}[component${T}]);
        `;M=`
        let outputOffset = global_idx * ${a};
        var data = vec4<u32>(0);
        ${x("data",0,"u32")}
        ${x("data",1,"u32")}
        ${x("data",2,"u32")}
        ${x("data",3,"u32")}
        ${y.setByOffset("global_idx","data")}
      }`}else M=`
        let outputIndices = ${y.offsetToIndices(`global_idx * ${a}`)};
        let inputOffset = ${_.broadcastedIndicesToOffset("outputIndices",y)};
        let data = ${y.type.value}(${_.getByOffset(`inputOffset / ${s}`)});
        ${y.setByOffset("global_idx","data")}
      }`;return`
    ${g.registerUniform("vec_size","u32").declareVariables(_,y)}
    ${g.mainStart()}
    ${g.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
    ${M}`},m=[{type:12,data:u},...Kn(t,n)];return{name:"Expand",shaderCache:{hint:`${n.length};${s}${a}`,inputDependencies:["rank"]},getShaderSource:d,getRunData:()=>({outputs:[{dims:n,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:m})}},Fie=e=>{zV(e.inputs),e.compute(UV(e.inputs),{inputs:[0]})}}),VV,zie,$Pe=nn(()=>{yi(),ji(),Bi(),AR(),VV=e=>{let t=e[0].dataType,r=br.size(e[0].dims),n=br.size(e[1].dims),i=n%4===0,o=s=>{let a=kr("x",t,[1],4),u=kr("bias",t,[1],4),d=Fn("y",t,[1],4),m=[{name:"output_vec_size",type:"u32"},{name:"bias_size",type:"u32"}],g=y=>`
      let bias${y}_offset: u32 = (global_idx * 4 + ${y}) % uniforms.bias_size;
      let bias${y} = ${u.getByOffset(`bias${y}_offset / 4`)}[bias${y}_offset % 4];`,_=i?`
      let bias = ${u.getByOffset("global_idx % (uniforms.bias_size / 4)")};`:`${g(0)}${g(1)}${g(2)}${g(3)}
      let bias = ${a.type.value}(bias0, bias1, bias2, bias3);`;return`${s.registerUniforms(m).declareVariables(a,u,d)}

    ${qD(Mu(t))}

    ${s.mainStart(Q1)}
      ${s.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_vec_size")}

      let x = ${a.getByOffset("global_idx")};
      ${_}
      let x_in = x + bias;
      ${d.setByOffset("global_idx",HD("x_in"))}
    }`};return{name:"FastGeluWithBias",shaderCache:{hint:`${i}`,inputDependencies:["type","type"]},getShaderSource:o,getRunData:s=>({outputs:[{dims:s[0].dims,dataType:s[0].dataType}],programUniforms:[{type:12,data:Math.ceil(r/4)},{type:12,data:n}],dispatchGroup:{x:Math.ceil(r/Q1/4)}})}},zie=e=>{e.inputs.length<2||br.size(e.inputs[1].dims)===0?aie(e):e.compute(VV(e.inputs))}}),WV,GV,Bie,Uie,NPe=nn(()=>{yi(),ji(),Zs(),Bi(),WV=e=>{if(!e||e.length!==2)throw new Error("Gather requires 2 inputs.")},GV=(e,t)=>{let r=e[0].dims,n=e[1].dims,i=r.length,o=br.normalizeAxis(t.axis,i),s=r.slice(0);s.splice(o,1,...n);let a=r[o],u=e[0].dataType===9?4:1,d=Math.ceil(br.size(s)/u),m=[{type:12,data:d},{type:6,data:a},{type:12,data:o},...Kn(e[0].dims,e[1].dims,s)],g=_=>{let y=kr("data",e[0].dataType,e[0].dims.length,u),M=kr("inputIndices",e[1].dataType,e[1].dims.length),x=Fn("output",e[0].dataType,s.length,u),E=P=>{let C=n.length,D=`var indicesIndices${P}  = ${M.type.indices}(0);`;for(let L=0;L<C;L++)D+=`${C>1?`indicesIndices${P}[${L}]`:`indicesIndices${P}`} = ${s.length>1?`outputIndices${P}[uniforms.axis + ${L}]`:`outputIndices${P}`};`;D+=`
          var idx${P} = ${M.getByIndices(`indicesIndices${P}`)};
          if (idx${P} < 0) {
            idx${P} = idx${P} + uniforms.axisDimLimit;
          }
          var dataIndices${P} : ${y.type.indices};
        `;for(let L=0,N=0;L<i;L++)L===o?(D+=`${i>1?`dataIndices${P}[${L}]`:`dataIndices${P}`} = u32(idx${P});`,N+=C):(D+=`${i>1?`dataIndices${P}[${L}]`:`dataIndices${P}`} = ${s.length>1?`outputIndices${P}[${N}]`:`outputIndices${P}`};`,N++);return D},T;if(e[0].dataType===9){let P=(C,D,L="")=>`
          let outputIndices${D} = ${x.offsetToIndices(`outputOffset + ${D}u`)};
          ${E(D)};
          let offset${D} = ${y.indicesToOffset(`dataIndices${D}`)};
          let index${D} = offset${D} / 4u;
          let component${D} = offset${D} % 4u;
          ${C}[${D}] = ${L}(${y.getByOffset(`index${D}`)}[component${D}]);
        `;T=`
        let outputOffset = global_idx * ${u};
        var value = vec4<u32>(0);
        ${P("value",0,"u32")}
        ${P("value",1,"u32")}
        ${P("value",2,"u32")}
        ${P("value",3,"u32")}
        ${x.setByOffset("global_idx","value")}
      `}else T=`
      let outputIndices = ${x.offsetToIndices("global_idx")};
      ${E("")};
      let value = ${y.getByIndices("dataIndices")};
      ${x.setByOffset("global_idx","value")};
      `;return`
      ${_.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(y,M,x)}
      ${_.mainStart()}
        ${_.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
        ${T}
      }`};return{name:"Gather",shaderCache:{hint:t.cacheKey,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:s,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(d/64)},programUniforms:m}),getShaderSource:g}},Bie=e=>Jo({axis:e.axis}),Uie=(e,t)=>{let r=e.inputs;WV(r),e.compute(GV(e.inputs,t))}}),qV,Vie,Wie,jPe=nn(()=>{yi(),ji(),Bi(),qV=(e,t,r,n,i,o,s,a,u)=>{let d=[{type:12,data:o},{type:12,data:n},{type:12,data:i},{type:12,data:r},{type:12,data:s},{type:12,data:a},{type:12,data:u}],m=[o];d.push(...Kn(t.dims,m));let g=_=>{let y=kr("indices_data",t.dataType,t.dims.length),M=Fn("input_slice_offsets_data",12,1,1),x=[y,M],E=[{name:"output_size",type:"u32"},{name:"batch_dims",type:"u32"},{name:"input_dims",type:"u32",length:i.length},{name:"sizes_from_slice_dims_data",type:"u32",length:r.length},{name:"num_slices_per_batch",type:"u32"},{name:"input_batch_stride",type:"u32"},{name:"num_slice_dims",type:"u32"}];return`
  ${_.registerUniforms(E).declareVariables(...x)}
  ${_.mainStart()}
    ${_.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let batch_idx = global_idx / uniforms.num_slices_per_batch;
    let base_offset = batch_idx * uniforms.input_batch_stride;

    let slice_indices_base_offset = global_idx * uniforms.num_slice_dims;
    var relative_slice_offset = 0;
    for (var dim_idx = 0u; dim_idx < uniforms.num_slice_dims; dim_idx ++) {
      var index = i32(indices_data[dim_idx + slice_indices_base_offset].x);
      let input_dim_idx = uniforms.batch_dims + dim_idx;
      if (index < 0) {
        ${i.length===1?"index += i32(uniforms.input_dims);":"index += i32(uniforms.input_dims[input_dim_idx]);"}
      }
      ${r.length===1?"relative_slice_offset += index * i32(uniforms.sizes_from_slice_dims_data);":"relative_slice_offset += index * i32(uniforms.sizes_from_slice_dims_data[dim_idx]);"}
    }

    input_slice_offsets_data[global_idx] =  base_offset + u32(relative_slice_offset);
  }`};return e.compute({name:"computeSliceOffsets",shaderCache:{hint:`${i.length}_${r.length}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:m,dataType:e.inputs[1].dataType}],dispatchGroup:{x:Math.ceil(o/64)},programUniforms:d}),getShaderSource:g},{inputs:[t],outputs:[-1]})[0]},Vie=(e,t)=>{let r=e.inputs,n=r[0].dims,i=r[0].dataType,o=r[1].dims,s=o[o.length-1],a=br.sizeToDimension(o,o.length-1),u=br.sizeFromDimension(n,t.batchDims+s),d=br.sizeToDimension(n,t.batchDims),m=br.sizeFromDimension(n,t.batchDims),g=a/d,_=new Array(s),y=u;for(let D=0;D<s;++D)_[s-1-D]=y,y*=n[t.batchDims+s-1-D];let M=qV(e,r[1],_,t.batchDims,n,a,g,m,s),x=t.batchDims+s;if(x>n.length)throw new Error("last dimension of indices must not be larger than rank of input tensor");let E=o.slice(0,-1).concat(n.slice(x)),T=br.size(E),P=[{type:12,data:T},{type:12,data:u},...Kn(r[0].dims,M.dims,E)],C=D=>{let L=kr("data",r[0].dataType,r[0].dims.length),N=kr("slice_offsets",12,M.dims.length),j=Fn("output",r[0].dataType,E.length);return`
          ${D.registerUniform("output_size","u32").registerUniform("slice_size","u32").declareVariables(L,N,j)}
            ${D.mainStart()}
            ${D.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          let slice_offset = slice_offsets[global_idx / uniforms.slice_size];
          output[global_idx] = data[u32(slice_offset) + global_idx % uniforms.slice_size];
        }`};e.compute({name:"GatherND",shaderCache:{hint:t.cacheKey,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:E,dataType:i}],dispatchGroup:{x:Math.ceil(T/64)},programUniforms:P}),getShaderSource:C},{inputs:[r[0],M]})},Wie=e=>({batchDims:e.batch_dims,cacheKey:""})}),HV,KV,Gie,qie,RPe=nn(()=>{yi(),ji(),Zs(),Bi(),HV=(e,t)=>{if(e.length<3||e.length>4)throw new Error("GatherBlockQuantized requires 3 or 4 inputs.");let r=br.normalizeAxis(t.quantizeAxis,e[0].dims.length),n=t.blockSize,i=e[0],o=e[2],s=e.length===4?e[3]:void 0;if(o.dims.length!==i.dims.length||!i.dims.map((a,u)=>u===r?Math.ceil(a/n)===o.dims[u]:a===o.dims[u]).reduce((a,u)=>a&&u,!0))throw new Error("Scales must have the same rank as the input tensor and the dims should match except on gatherAxis.");if(s){if(s.dataType!==i.dataType)throw new Error("Zero point must have the same data type as the input tensor.");if(s.dims.length!==o.dims.length||!s.dims.map((a,u)=>a===o.dims[u]).reduce((a,u)=>a&&u,!0))throw new Error("Zero point must have the same rank as the input tensor and the dims should match except on quantizeAxis.")}},KV=(e,t)=>{let r=e[0].dims,n=e[1].dims,i=r.length,o=br.normalizeAxis(t.gatherAxis,i),s=br.normalizeAxis(t.quantizeAxis,i),a=r.slice(0);a.splice(o,1,...n);let u=br.size(a),d=e[2].dataType,m=e[0].dataType===22,g=[{type:12,data:u},{type:12,data:s},{type:12,data:o},{type:12,data:t.blockSize},...Kn(...e.map((y,M)=>y.dims),a)],_=y=>{let M=kr("data",e[0].dataType,e[0].dims.length),x=kr("inputIndices",e[1].dataType,e[1].dims.length),E=kr("scales",e[2].dataType,e[2].dims.length),T=e.length>3?kr("zeroPoint",e[3].dataType,e[3].dims.length):void 0,P=Fn("output",d,a.length),C=[M,x,E];T&&C.push(T);let D=[{name:"output_size",type:"u32"},{name:"quantize_axis",type:"u32"},{name:"gather_axis",type:"u32"},{name:"block_size",type:"u32"}];return`
        ${y.registerUniforms(D).declareVariables(...C,P)}
        ${y.mainStart()}
        let output_indices = ${P.offsetToIndices("global_idx")};
        var indices_indices = ${x.type.indices}(0);
        ${n.length>1?`
          for (var i: u32 = 0; i < ${n.length}; i++) {
            let index = ${P.indicesGet("output_indices","uniforms.gather_axis + i")};
            ${x.indicesSet("indices_indices","i","index")};
          }`:`indices_indices = ${P.indicesGet("output_indices","uniforms.gather_axis")};`};
        var data_indices = ${M.type.indices}(0);
        for (var i: u32 = 0; i < uniforms.gather_axis; i++) {
          let index = ${P.indicesGet("output_indices","i")};
          ${M.indicesSet("data_indices","i","index")};
        }
        var index_from_indices = ${x.getByIndices("indices_indices")};
        if (index_from_indices < 0) {
          index_from_indices += ${r[o]};
        }
        ${M.indicesSet("data_indices","uniforms.gather_axis","u32(index_from_indices)")};
        for (var i = uniforms.gather_axis + 1; i < ${a.length}; i++) {
          let index = ${P.indicesGet("output_indices",`i + ${n.length} - 1`)};
          ${M.indicesSet("data_indices","i","index")};
        }
        let data_offset = ${M.indicesToOffset("data_indices")};
        let data_index = data_offset % 8;
        // Convert 4-bit packed data to 8-bit packed data.
        let packed_4bit_quantized_data = ${M.getByOffset("data_offset / 8")};
        let packed_8bit_quantized_data = (packed_4bit_quantized_data >> (4 * (data_index % 2))) & 0x0f0f0f0f;
        let quantized_data_vec = ${m?"unpack4xI8":"unpack4xU8"}(u32(packed_8bit_quantized_data));
        let quantized_data = quantized_data_vec[data_index / 2];
        var scale_indices = data_indices;
        let quantize_axis_index = ${E.indicesGet("data_indices","uniforms.quantize_axis")} / uniforms.block_size;
        ${E.indicesSet("scale_indices","uniforms.quantize_axis","quantize_axis_index")};
        var scale = ${E.getByIndices("scale_indices")};
        ${T?`
              let zero_point_indices = scale_indices;
              let zero_point_offset = ${T.indicesToOffset("zero_point_indices")};
              let zero_point_index = zero_point_offset % 8;
              let packed_4bit_zero_points = ${T.getByOffset("zero_point_offset / 8")};
              let packed_8bit_zero_points = (packed_4bit_zero_points >> (4 * (zero_point_index % 2))) & 0x0f0f0f0f;
              let zero_point_vec = ${m?"unpack4xI8":"unpack4xU8"}(u32(packed_8bit_zero_points));
              let zero_point = zero_point_vec[zero_point_index / 2];`:"var zero_point = 0"};
        let dequantized_data = ${Mu(d)}(quantized_data - zero_point) * scale;
        ${P.setByOffset("global_idx","dequantized_data")};
    }`};return{name:"GatherBlockQuantized",shaderCache:{hint:`${t.cacheKey};${e.filter((y,M)=>M!==1).map(y=>y.dims.join("_")).join(";")}`,inputDependencies:Array.from({length:e.length},(y,M)=>"rank")},getRunData:()=>({outputs:[{dims:a,dataType:d}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:g}),getShaderSource:_}},Gie=(e,t)=>{let r=e.inputs;HV(r,t),e.compute(KV(e.inputs,t))},qie=e=>Jo({blockSize:e.blockSize,gatherAxis:e.gatherAxis,quantizeAxis:e.quantizeAxis})}),ZV,XV,Hie,Kie,FPe=nn(()=>{yi(),ji(),Zs(),Bi(),ZV=e=>{if(!e||e.length!==2)throw new Error("GatherElements requires 2 inputs.");if(e[0].dims.length<1)throw new Error("GatherElements requires that the data input be rank >= 1.");if(e[0].dims.length!==e[1].dims.length)throw new Error(`GatherElements requires that the data input and
                     indices input tensors be of same rank.`)},XV=(e,t)=>{let r=e[0].dims,n=e[0].dataType,i=r.length,o=e[1].dims,s=e[1].dataType,a=br.normalizeAxis(t.axis,i),u=r[a],d=o.slice(0),m=br.size(d),g=kr("input",n,i),_=kr("indicesInput",s,o.length),y=Fn("output",n,d.length),M=[{type:12,data:m},{type:6,data:u},{type:12,data:a}];return M.push(...Kn(r,o,d)),{name:"GatherElements",shaderCache:{inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:d,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(m/64)},programUniforms:M}),getShaderSource:x=>`
      ${x.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(g,_,y)}
      ${x.mainStart()}
      ${x.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

      let outputIndices = ${y.offsetToIndices("global_idx")};

      var idx = ${_.getByOffset("global_idx")};
      if (idx < 0) {
        idx = idx + uniforms.axisDimLimit;
      }
      var inputIndices = ${g.type.indices}(outputIndices);
      ${g.indicesSet("inputIndices","uniforms.axis","u32(idx)")};
      let value = ${g.getByIndices("inputIndices")};

      ${y.setByOffset("global_idx","value")};
  }`}},Hie=e=>Jo({axis:e.axis}),Kie=(e,t)=>{let r=e.inputs;ZV(r),e.compute(XV(e.inputs,t))}}),YV,QV,Zie,Xie,zPe=nn(()=>{yi(),ji(),Bi(),YV=e=>{if(!e)throw new Error("Input is missing");if(e.length<2||e.length>3)throw new Error("Invaid input number.");if(e.length===3&&e[2].dims.length>2)throw new Error("Invalid input shape of C");if(e[0].dataType!==e[1].dataType||e.length===3&&e[0].dataType!==e[2].dataType)throw new Error("Input types are mismatched")},QV=(e,t)=>{let r=e[0].dims.slice(),n=e[1].dims.slice(),[i,o,s]=Hre.getShapeOfGemmResult(r,t.transA,n,t.transB,e.length===3?e[2].dims:void 0),a=[i,o];if(!a)throw new Error("Can't use gemm on the given tensors");let u=16,d=Math.ceil(o/u),m=Math.ceil(i/u),g=!0,_=br.size(a),y=[{type:12,data:g?d:_},{type:12,data:i},{type:12,data:o},{type:12,data:s},{type:1,data:t.alpha},{type:1,data:t.beta}],M=["type","type"];e.length===3&&(y.push(...Kn(e[2].dims)),M.push("rank")),y.push(...Kn(a));let x=T=>{let P="";t.transA&&t.transB?P="value += a[k * uniforms.M + m] * b[n * uniforms.K + k];":t.transA&&!t.transB?P="value += a[k * uniforms.M + m] * b[k * uniforms.N + n];":!t.transA&&t.transB?P="value += a[m * uniforms.K + k] * b[n * uniforms.K + k];":!t.transA&&!t.transB&&(P="value += a[m * uniforms.K + k] * b[k * uniforms.N + n];");let C=t.alpha===1?"":"value *= uniforms.alpha;",D=kr("a",e[0].dataType,e[0].dims),L=kr("b",e[1].dataType,e[1].dims),N=D.type.value,j=null,$=[D,L];e.length===3&&(j=kr("c",e[2].dataType,e[2].dims.length),$.push(j));let U=Fn("output",e[0].dataType,a.length);$.push(U);let G=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}];return`
  ${T.registerUniforms(G).declareVariables(...$)}

  ${T.mainStart()}
    ${T.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let m = global_idx / uniforms.N;
    let n = global_idx % uniforms.N;

    var value = ${N}(0);
    for (var k: u32 = 0u; k < uniforms.K; k++) {
      ${P}
    }

    ${C}
    ${j!=null?`let cOffset = ${j.broadcastedIndicesToOffset("vec2(m, n)",U)}; value += ${N}(uniforms.beta) * ${j.getByOffset("cOffset")};`:""}
    output[global_idx] = value;
  }`},E=T=>{let P=kr("a",e[0].dataType,e[0].dims),C=kr("b",e[1].dataType,e[1].dims),D=null,L=[P,C];e.length===3&&(D=kr("c",e[2].dataType,e[2].dims.length),L.push(D));let N=Fn("output",e[0].dataType,a.length);L.push(N);let j=[{name:"num_tile_n",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}],$="",U="";t.transA&&t.transB?(U=`
      var col = tile_row_start + local_id.x;
      var row = k_start + local_id.y;
      if (col < uniforms.M && row < uniforms.K) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.M + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${P.type.value}(0);
      }

      col = k_start + local_id.x;
      row = tile_col_start + local_id.y;
      if (col < uniforms.K && row < uniforms.N) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.K + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${C.type.value}(0);
      }
      `,$="value += tile_a[k][local_id.y] * tile_b[local_id.x][k];"):t.transA&&!t.transB?(U=`
      var col = tile_row_start + local_id.x;
      var row = k_start + local_id.y;
      if (col < uniforms.M && row < uniforms.K) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.M + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${P.type.value}(0);
      }

      col = tile_col_start + local_id.x;
      row = k_start + local_id.y;
      if (col < uniforms.N && row < uniforms.K) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.N + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${C.type.value}(0);
      }
      `,$="value += tile_a[k][local_id.y] * tile_b[k][local_id.x];"):!t.transA&&t.transB?(U=`
      var col = k_start + local_id.x;
      var row = tile_row_start + local_id.y;
      if (col < uniforms.K && row < uniforms.M) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.K + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${P.type.value}(0);
      }

      col = k_start + local_id.x;
      row = tile_col_start + local_id.y;
      if (col < uniforms.K && row < uniforms.N) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.K + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${C.type.value}(0);
      }
      `,$="value += tile_a[local_id.y][k] * tile_b[local_id.x][k];"):!t.transA&&!t.transB&&(U=`
      var col = k_start + local_id.x;
      var row = tile_row_start + local_id.y;
      if (col < uniforms.K && row < uniforms.M) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.K + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${P.type.value}(0);
      }

      col = tile_col_start + local_id.x;
      row = k_start + local_id.y;
      if (col < uniforms.N && row < uniforms.K) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.N + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${C.type.value}(0);
      }
      `,$="value += tile_a[local_id.y][k] * tile_b[k][local_id.x];");let G=t.alpha===1?"":"value *= uniforms.alpha;";return`
  ${T.registerUniforms(j).declareVariables(...L)}
  var<workgroup> tile_a: array<array<${P.type.storage}, ${u}>, ${u}>;
  var<workgroup> tile_b: array<array<${C.type.storage}, ${u}>, ${u}>;
  ${T.mainStart([u,u,1])}
    let tile_col_start = (workgroup_index % uniforms.num_tile_n) * ${u};
    let tile_row_start = (workgroup_index / uniforms.num_tile_n) * ${u};
    let num_tiles = (uniforms.K - 1) / ${u} + 1;
    var k_start = 0u;
    var value = ${N.type.value}(0);
    for (var t: u32 = 0u; t < num_tiles; t++) {
      ${U}
      k_start = k_start + ${u};
      workgroupBarrier();

      for (var k: u32 = 0u; k < ${u}; k++) {
        ${$}
      }
      workgroupBarrier();
    }

    ${G}
    let m = tile_row_start + local_id.y;
    let n = tile_col_start + local_id.x;
    ${D!=null?`let cOffset = ${D.broadcastedIndicesToOffset("vec2(m, n)",N)}; value += ${N.type.value}(uniforms.beta) * ${D.getByOffset("cOffset")};`:""}
    if (m < uniforms.M && n < uniforms.N) {
      output[m * uniforms.N + n] = value;
    }
  }`};return g?{name:"GemmShared",shaderCache:{hint:`${t.cacheKey}`,inputDependencies:M},getRunData:()=>({outputs:[{dims:a,dataType:e[0].dataType}],dispatchGroup:{x:d*m},programUniforms:y}),getShaderSource:E}:{name:"Gemm",shaderCache:{hint:`${t.cacheKey}`,inputDependencies:M},getRunData:()=>({outputs:[{dims:a,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(_/64)},programUniforms:y}),getShaderSource:x}},Zie=e=>{let t=e.transA,r=e.transB,n=e.alpha,i=e.beta;return{transA:t,transB:r,alpha:n,beta:i,cacheKey:`${e.transA};${e.transB};${e.alpha===1}`}},Xie=(e,t)=>{YV(e.inputs),e.compute(QV(e.inputs,t))}}),xp,ym,ly,cy,JV,e7,t7,r7,n7,i7,o7,a7,Yie,Qie,BPe=nn(()=>{yi(),ji(),Zs(),Bi(),[xp,ym,ly,cy]=[0,1,2,3],JV=e=>{if(e[0].dims.length!==4)throw new Error("only 4-D tensor is supported.");if(e[0].dims.length!==e[1].dims.length)throw new Error("input dimensions must be equal to grid dimensions");if(e[0].dims.length-2!==e[1].dims[e[1].dims.length-1])throw new Error(`last dimension of grid must be equal to ${e[0].dims.length-2}`);if(e[0].dims[0]!==e[1].dims[0])throw new Error("grid batch size must match input batch size")},e7=`
  fn gs_get_cubic_coeffs(x: f32) -> vec4<f32> {
    let cubic_alpha = -0.75f;
    let x_abs = abs(x);
    var coeffs: vec4<f32>;
    coeffs[0] = (((cubic_alpha * (x_abs + 1) - 5 * cubic_alpha) * (x_abs + 1) + 8 * cubic_alpha) * (x_abs + 1) - 4 * cubic_alpha);
    coeffs[1] = (((cubic_alpha + 2) * x_abs - (cubic_alpha + 3)) * x_abs * x_abs + 1);
    coeffs[2] = (((cubic_alpha + 2) * (1 - x_abs) - (cubic_alpha + 3)) * (1 - x_abs) * (1 - x_abs) + 1);
    coeffs[3] = (((cubic_alpha * (2 - x_abs) - 5 * cubic_alpha) * (2 - x_abs) + 8 * cubic_alpha) * (2 - x_abs) - 4 * cubic_alpha);
    return coeffs;
  }
`,t7=e=>`
  fn gs_bicubic_interpolate(p: mat4x4<${e}>, x: f32, y: f32) -> ${e} {
    var v: vec4<f32>;
    var coeffs = gs_get_cubic_coeffs(x);
    for (var i = 0; i < 4; i++) {
      v[i] = coeffs[0] * p[i][0] + coeffs[1] * p[i][1] + coeffs[2] * p[i][2] + coeffs[3] * p[i][3];
    }
    coeffs = gs_get_cubic_coeffs(y);
    let pixel = ${e}(coeffs[0] * v[0] + coeffs[1] * v[1] + coeffs[2] * v[2] + coeffs[3] * v[3]);
    return pixel;
  }
`,r7=e=>`
  fn gs_denormalize(n: f32, length: i32) -> f32 {
    ${e.alignCorners===0?`
    // alignCorners: false => [-1, 1] to [-0.5, length - 0.5]
    return ((n + 1.0) * f32(length) - 1.0) / 2.0;
    `:`
    // alignCorners: true => [-1, 1] to [0, length - 1]
    return (n + 1.0) / 2.0 * (f32(length - 1));
    `}
  }
`,n7=e=>`
  ${e.paddingMode==="reflection"?`
      fn gs_reflect(x: i32, x_min: f32, x_max: f32) -> u32 {
        var dx = 0.0;
        var fx = f32(x);
        let range = x_max - x_min;
        if (fx < x_min) {
          dx = x_min - fx;
          let n = u32(dx / range);
          let r = dx - f32(n) * range;
          if (n % 2 == 0) {
            fx = x_min + r;
          } else {
            fx = x_max - r;
          }
        } else if (fx > x_max) {
          dx = fx - x_max;
          let n = u32(dx / range);
          let r = dx - f32(n) * range;
          if (n % 2 == 0) {
            fx = x_max - r;
          } else {
            fx = x_min + r;
          }
        }
        return u32(fx);
      }`:""}
`,i7=(e,t,r)=>`
  fn pixel_at_grid(r: i32, c: i32, H: i32, W: i32, batch: u32, channel: u32, border: vec4<f32>) -> ${t} {
     var pixel = ${t}(0);
     var indices = vec4<u32>(0);
     indices[${xp}] = batch;
     indices[${ym}] = channel;`+(()=>{switch(r.paddingMode){case"zeros":return`
          if (r >= 0 && r < H && c >=0 && c < W) {
            indices[${ly}] = u32(r);
            indices[${cy}] = u32(c);
          } else {
            return ${t}(0);
          }
        `;case"border":return`
          indices[${ly}] = u32(clamp(r, 0, H - 1));
          indices[${cy}] = u32(clamp(c, 0, W - 1));
        `;case"reflection":return`
          indices[${ly}] = gs_reflect(r, border[1], border[3]);
          indices[${cy}] = gs_reflect(c, border[0], border[2]);
        `;default:throw new Error(`padding mode ${r.paddingMode} is not supported`)}})()+`
    return ${e.getByIndices("indices")};
  }
`,o7=(e,t,r)=>(()=>{switch(r.mode){case"nearest":return`
          let result = pixel_at_grid(i32(round(y)), i32(round(x)), H_in, W_in, indices[${xp}], indices[${ym}], border);
        `;case"bilinear":return`
          let x1 = i32(floor(x));
          let y1 = i32(floor(y));
          let x2 = x1 + 1;
          let y2 = y1 + 1;

          let p11 = pixel_at_grid(y1, x1, H_in, W_in, indices[${xp}], indices[${ym}], border);
          let p12 = pixel_at_grid(y1, x2, H_in, W_in, indices[${xp}], indices[${ym}], border);
          let p21 = pixel_at_grid(y2, x1, H_in, W_in, indices[${xp}], indices[${ym}], border);
          let p22 = pixel_at_grid(y2, x2, H_in, W_in, indices[${xp}], indices[${ym}], border);

          let dx2 = ${t}(f32(x2) - x);
          let dx1 = ${t}(x - f32(x1));
          let dy2 = ${t}(f32(y2) - y);
          let dy1 = ${t}(y - f32(y1));
          let result = dy2 * (dx2 * p11 + dx1 * p12) + dy1 * (dx2 * p21 + dx1 * p22);
        `;case"bicubic":return`
          let x0 = i32(floor(x)) - 1;
          let y0 = i32(floor(y)) - 1;
          var p: mat4x4<${t}>;
          for (var h = 0; h < 4; h++) {
            for (var w = 0; w < 4; w++) {
              p[h][w] = pixel_at_grid(h + y0, w + x0, H_in, W_in, indices[${xp}], indices[${ym}], border);
            }
          }

          let dx = x - f32(x0 + 1);
          let dy = y - f32(y0 + 1);
          let result = gs_bicubic_interpolate(p, dx, dy);
        `;default:throw new Error(`mode ${r.mode} is not supported`)}})()+`${e.setByOffset("global_idx","result")}`,a7=(e,t)=>{let r=kr("x",e[0].dataType,e[0].dims.length),n=[e[1].dims[0],e[1].dims[1],e[1].dims[2]],i=kr("grid",e[1].dataType,n.length,2),o=[e[0].dims[0],e[0].dims[1],e[1].dims[1],e[1].dims[2]];t.format==="NHWC"&&(o=[e[0].dims[0],e[1].dims[1],e[1].dims[2],e[0].dims[3]],[xp,ym,ly,cy]=[0,3,1,2]);let s=Fn("output",e[0].dataType,o.length),a=r.type.value,u=br.size(o),d=[{type:12,data:u},...Kn(e[0].dims,n,o)],m=g=>`
  ${g.registerUniform("output_size","u32").declareVariables(r,i,s)}
  ${e7}
  ${t7(a)}
  ${r7(t)}
  ${n7(t)}
  ${i7(r,a,t)}

  ${g.mainStart()}
    ${g.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let H_in = i32(uniforms.x_shape[${ly}]);
      let W_in = i32(uniforms.x_shape[${cy}]);

      ${t.alignCorners===0?`
      let x_min = -0.5;
      let x_max = f32(W_in) - 0.5;
      let y_min = -0.5;
      let y_max = f32(H_in) - 0.5;
      `:`
      let x_min = 0.0;
      let x_max = f32(W_in) - 1.0;
      let y_min = 0.0;
      let y_max = f32(H_in) - 1.0;
      `};
      let border = vec4<f32>(x_min, y_min, x_max, y_max);

      let indices = ${s.offsetToIndices("global_idx")};
      var grid_indices = vec3<u32>(indices[${xp}], indices[${ly}], indices[${cy}]);
      let nxy = ${i.getByIndices("grid_indices")};
      var x = gs_denormalize(f32(nxy[0]), W_in);
      var y = gs_denormalize(f32(nxy[1]), H_in);

      ${o7(s,a,t)}
  }`;return{name:"GridSample",shaderCache:{hint:`${t.cacheKey}`,inputDependencies:["type","type"]},getRunData:g=>{let _=br.size(o);return{outputs:[{dims:o,dataType:g[0].dataType}],dispatchGroup:{x:Math.ceil(_/64)},programUniforms:d}},getShaderSource:m}},Yie=(e,t)=>{JV(e.inputs),e.compute(a7(e.inputs,t))},Qie=e=>Jo({alignCorners:e.align_corners,mode:e.mode,paddingMode:e.padding_mode,format:e.format})}),Nu,s7,Jie,L3,l7,Xw,eoe,toe=nn(()=>{yi(),ji(),Zs(),SR(),ER(),Bi(),N_(),Nu=(e,t)=>e.length>t&&e[t].dims.length>0?e[t]:void 0,s7=(e,t)=>{let r=e[0],n=Nu(e,1),i=Nu(e,2),o=Nu(e,3),s=Nu(e,4),a=Nu(e,5),u=Nu(e,6),d=Nu(e,7);if(r.dims.length!==3&&r.dims.length!==5)throw new Error("Input query is expected to have 3 or 5 dimensions");let m=r.dims[0],g=r.dims[1],_=r.dims.length===3?r.dims[2]:t.numHeads*r.dims[4],y=g,M=0,x=0,E=Math.floor(_/t.numHeads);if(u&&d&&br.size(u.dims)&&br.size(d.dims)){if(u.dims.length!==4)throw new Error('Input "past_key" is expected to have 4 dimensions');if(u.dims[0]!==m||u.dims[1]!==t.numHeads||u.dims[3]!==E)throw new Error('Input "past_key" shape (batch_size, num_heads, past_sequence_length, head_size)');if(d.dims[0]!==m||d.dims[1]!==t.numHeads||d.dims[3]!==E)throw new Error('Input "past_value" shape (batch_size, num_heads, past_sequence_length, head_size)');if(u.dims[2]!==d.dims[2])throw new Error('Input "past_key" and "past_value" shall have same dim 2 (past_sequence_length)');if(d.dims.length!==4)throw new Error('Input "past_value" is expected to have 4 dimensions');M=u.dims[2],x=u.dims[2]}else if(u&&br.size(u.dims)||d&&br.size(d.dims))throw new Error('Input "past_key" and "past_value" shall be both present or both absent');let T;if(n&&br.size(n.dims)>0){if(r.dims.length!==3)throw new Error('Input "query" is expected to have 3 dimensions when key is given');if(n.dims.length<3||n.dims.length>5)throw new Error('Input "key" is expected to have 3, 4, or 5 dimensions');if(r.dims[0]!==n.dims[0])throw new Error('Input "query" and "key" shall have same dim 0 (batch size)');if(n.dims.length===3){if(n.dims[2]!==r.dims[2])throw new Error('Input "query" and "key" shall have same dim 2 (hidden_size)');T=2,y=n.dims[1]}else if(n.dims.length===5){if(n.dims[2]!==t.numHeads||n.dims[3]!==2||n.dims[4]!==E)throw new Error('Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv');if(i)throw new Error('Expect "value" be none when "key" has packed kv format.');T=5,y=n.dims[1]}else{if(n.dims[1]!==t.numHeads||n.dims[3]!==E)throw new Error('Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key');T=0,y=n.dims[2]}}else{if(r.dims.length!==5)throw new Error('Input "query" is expected to have 5 dimensions when key is empty');if(r.dims[2]!==t.numHeads||r.dims[3]!==3)throw new Error('Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv');T=3}if(o&&br.size(o.dims)>0){if(o.dims.length!==1)throw new Error('Input "bias" is expected to have 1 dimension');if(n&&n.dims.length===5&&n.dims[3]===2)throw new Error("bias is not allowed for packed kv.")}let P=M+y,C=0;if(s&&br.size(s.dims)>0){C=8;let j=s.dims;throw j.length===1?j[0]===m?C=1:j[0]===3*m+2&&(C=3):j.length===2&&j[0]===m&&j[1]===P&&(C=5),C===8?new Error('Input "key_padding_mask" shape shall be (batch_size) or (batch_size, total_sequence_length)'):new Error("Mask not supported")}let D=!1,L=_;if(i&&br.size(i.dims)>0){if(i.dims.length!==3&&i.dims.length!==4)throw new Error('Input "value" is expected to have 3 or 4 dimensions');if(r.dims[0]!==i.dims[0])throw new Error('Input "query" and "value" shall have same dim 0 (batch_size)');if(i.dims.length===3){if(y!==i.dims[1])throw new Error('Input "key" and "value" shall have the same dim 1 (kv_sequence_length)');L=i.dims[2]}else{if(y!==i.dims[2])throw new Error('Input "key" and "value" shall have the same dim 2 (kv_sequence_length)');L=i.dims[1]*i.dims[3],D=!0}}let N=!1;if(s&&br.size(s.dims)>0)throw new Error("Key padding mask is not supported");if(a&&br.size(a.dims)>0){if(a.dims.length!==4)throw new Error('Input "attention_bias" is expected to have 4 dimensions');if(a.dims[0]!==m||a.dims[1]!==t.numHeads||a.dims[2]!==g||a.dims[3]!==P)throw new Error('Expect "attention_bias" shape (batch_size, num_heads, sequence_length, total_sequence_length)')}return{batchSize:m,sequenceLength:g,pastSequenceLength:M,kvSequenceLength:y,totalSequenceLength:P,maxSequenceLength:x,inputHiddenSize:0,hiddenSize:_,vHiddenSize:L,headSize:E,vHeadSize:Math.floor(L/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:C,scale:t.scale,broadcastResPosBias:N,passPastInKv:D,qkvFormat:T}},Jie=e=>Jo({...e}),L3=Jo({perm:[0,2,1,3]}),l7=(e,t,r,n,i,o,s)=>{let a=[n,i,o],u=br.size(a),d=[{type:12,data:u},{type:12,data:s},{type:12,data:o}],m=g=>{let _=Fn("qkv_with_bias",t.dataType,a),y=kr("qkv",t.dataType,a),M=kr("bias",r.dataType,a),x=[{name:"output_size",type:"u32"},{name:"bias_offset",type:"u32"},{name:"hidden_size",type:"u32"}];return`
  ${g.registerUniforms(x).declareVariables(y,M,_)}
  ${g.mainStart()}
    ${g.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let bias_offset_idx = (global_idx % uniforms.hidden_size) + uniforms.bias_offset;

    qkv_with_bias[global_idx] = qkv[global_idx] + bias[bias_offset_idx];
  }`};return e.compute({name:"MultiHeadAttentionAddBias",shaderCache:{inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:a,dataType:t.dataType,gpuDataType:0}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:d}),getShaderSource:m},{inputs:[t,r],outputs:[-1]})[0]},Xw=(e,t,r,n,i,o,s,a)=>{let u=o;if(s&&br.size(s.dims)>0){if(n===1)throw new Error("AddBiasReshape is not implemented. Please export your model with packed QKV or KV");return u=l7(e,o,s,t,n,r*i,a),u=u.reshape([t,n,r,i]),r===1||n===1?u:e.compute(Jd(u,L3.perm),{inputs:[u],outputs:[-1]})[0]}else return o.dims.length===3&&(u=o.reshape([t,n,r,i])),r===1||n===1?u:e.compute(Jd(u,L3.perm),{inputs:[u],outputs:[-1]})[0]},eoe=(e,t)=>{let r=s7(e.inputs,t),n=e.inputs[0],i=Nu(e.inputs,1),o=Nu(e.inputs,2),s=Nu(e.inputs,3),a=Nu(e.inputs,4),u=Nu(e.inputs,5),d=Nu(e.inputs,6),m=Nu(e.inputs,7);if(n.dims.length===5)throw new Error("Packed QKV is not implemented");if((i==null?void 0:i.dims.length)===5)throw new Error("Packed KV is not implemented");let g=i&&o&&i.dims.length===4&&o.dims.length===4,_=Xw(e,r.batchSize,r.numHeads,r.sequenceLength,r.headSize,n,s,0);if(g)return cM(e,_,i,o,a,void 0,d,m,u,r);if(!i||!o)throw new Error("key and value must be provided");let y=Xw(e,r.batchSize,r.numHeads,r.kvSequenceLength,r.headSize,i,s,r.hiddenSize),M=Xw(e,r.batchSize,r.numHeads,r.kvSequenceLength,r.vHeadSize,o,s,2*r.hiddenSize);cM(e,_,y,M,a,void 0,d,m,u,r)}}),c7,u7,d7,h7,QD,roe,noe,ioe=nn(()=>{yi(),ji(),Zs(),Bi(),c7=e=>{if(!e||e.length<1)throw new Error("too few inputs")},u7=(e,t)=>{let r=[],n=t.numOutputs;return e[1].dims[0]>0&&(e[1].getBigInt64Array().forEach(i=>r.push(Number(i))),n=r.length),Jo({numOutputs:n,axis:t.axis,splitSizes:r})},d7=e=>`
fn calculateOutputIndex(index: u32) -> u32 {
    for (var i: u32 = 0u; i < ${e}u; i += 1u ) {
    if (index < ${Wn("uniforms.size_in_split_axis","i",e)}) {
        return i;
    }
    }
    return ${e}u;
}`,h7=e=>{let t=e.length,r=[];for(let n=0;n<t;++n){let i=e[n].setByIndices("indices","input[global_idx]");t===1?r.push(i):n===0?r.push(`if (output_number == ${n}u) { ${i} }`):n===t-1?r.push(`else { ${i} }`):r.push(`else if (output_number == ${n}) { ${i} }`)}return`
      fn writeBufferData(output_number: u32, indices: ${e[0].type.indices}, global_idx: u32) {
        ${r.join(`
`)}
      }`},QD=(e,t)=>{let r=e[0].dims,n=br.size(r),i=e[0].dataType,o=br.normalizeAxis(t.axis,r.length),s=new Array(t.numOutputs),a=kr("input",i,r.length),u=new Array(t.numOutputs),d=[],m=[],g=0,_=[{type:12,data:n}];for(let M=0;M<t.numOutputs;M++){g+=t.splitSizes[M],u[M]=g;let x=r.slice();x[o]=t.splitSizes[M],m.push(x),s[M]=Fn(`output${M}`,i,x.length),d.push({dims:m[M],dataType:e[0].dataType})}_.push({type:12,data:u},...Kn(r,...m));let y=M=>`
  ${M.registerUniform("input_size","u32").registerUniform("size_in_split_axis","u32",u.length).declareVariables(a,...s)}
  ${d7(u.length)}
  ${h7(s)}

  ${M.mainStart()}
    ${M.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.input_size")}

    var indices = ${a.offsetToIndices("global_idx")};
    var index = ${a.indicesGet("indices",o)};
    let output_number = calculateOutputIndex(index);
    if (output_number != 0) {
      index -= ${Wn("uniforms.size_in_split_axis","output_number - 1u",u.length)};
      ${a.indicesSet("indices",o,"index")};
    }
    writeBufferData(output_number, indices, global_idx);
  }`;return{name:"Split",shaderCache:{hint:t.cacheKey,inputDependencies:["rank"]},getShaderSource:y,getRunData:()=>({outputs:d,dispatchGroup:{x:Math.ceil(n/64)},programUniforms:_})}},roe=(e,t)=>{c7(e.inputs);let r=e.inputs.length===1?t:u7(e.inputs,t);e.compute(QD(e.inputs,r),{inputs:[0]})},noe=e=>{let t=e.axis,r=e.splitSizes,n=e.numOutputs<0?r.length:e.numOutputs;if(n!==r.length)throw new Error("numOutputs and splitSizes lengh must be equal");return Jo({axis:t,numOutputs:n,splitSizes:r})}}),f7,NA,ooe,aoe=nn(()=>{yi(),ji(),Zs(),Bi(),f7=(e,t)=>{let[r,n,i,o]=e,{numHeads:s,rotaryEmbeddingDim:a}=t;if(r.dims.length!==3&&r.dims.length!==4)throw new Error(`Input 'x' is expected to have 3 or 4 dimensions, got ${r.dims.length}`);if(!br.areEqual(n.dims,[])&&!br.areEqual(n.dims,[1])&&n.dims.length!==2)throw new Error(`Input 'position_ids' is expected to have 0, 1, or 2 dimensions, got ${n.dims.length}`);if(i.dims.length!==2)throw new Error(`Input 'cos_cache' is expected to have 2 dimensions, got ${i.dims.length}`);if(o.dims.length!==2)throw new Error(`Input 'sin_cache' is expected to have 2 dimensions, got ${o.dims.length}`);if(!br.areEqual(i.dims,o.dims))throw new Error("Inputs 'cos_cache' and 'sin_cache' are expected to have the same shape");if(a>0&&s===0)throw new Error("num_heads must be provided if rotary_embedding_dim is specified");let u=r.dims[0],d=r.dims[r.dims.length-2],m=i.dims[0],g=br.sizeFromDimension(r.dims,1)/d,_=a===0?i.dims[1]*2:g/s;if(a>_)throw new Error("rotary_embedding_dim must be less than or equal to head_size");if(n.dims.length===2){if(u!==n.dims[0])throw new Error(`Input 'position_ids' dimension 0 should be of size batch_size, got ${n.dims[0]}`);if(d!==n.dims[1])throw new Error(`Input 'position_ids' dimension 1 should be of size sequence_length, got ${n.dims[1]}`)}if(_/2!==i.dims[1]&&a/2!==i.dims[1])throw new Error(`Input 'cos_cache' dimension 1 should be same as head_size / 2 or rotary_embedding_dim / 2, got ${i.dims[1]}`);if(d>m)throw new Error("Updating cos_cache and sin_cache in RotaryEmbedding is not currently supported")},NA=(e,t)=>{let{interleaved:r,numHeads:n,rotaryEmbeddingDim:i,scale:o}=t,s=e[0].dims[0],a=br.sizeFromDimension(e[0].dims,1),u=e[0].dims[e[0].dims.length-2],d=a/u,m=e[2].dims[1],g=i===0?m*2:d/n,_=new Array(s,u,d/g,g-m),y=br.computeStrides(_),M=[{type:1,data:o},{type:12,data:_},{type:12,data:y},...e[0].dims.length===3?new Array({type:12,data:[a,d,g,1]}):[],...e[0].dims.length===4?new Array({type:12,data:[a,g,u*g,1]}):[],...Kn(e[0].dims,e[1].dims,e[2].dims,e[3].dims,e[0].dims)],x=E=>{let T=kr("input",e[0].dataType,e[0].dims.length),P=kr("position_ids",e[1].dataType,e[1].dims.length),C=kr("cos_cache",e[2].dataType,e[2].dims.length),D=kr("sin_cache",e[3].dataType,e[3].dims.length),L=Fn("output",e[0].dataType,e[0].dims.length);return E.registerUniforms([{name:"scale",type:"f32"},{name:"global_shape",type:"u32",length:_.length},{name:"global_strides",type:"u32",length:y.length},{name:"input_output_strides",type:"u32",length:y.length}]),`
        ${E.declareVariables(T,P,C,D,L)}

        ${E.mainStart(Q1)}
          let half_rotary_emb_dim = uniforms.${C.name}_shape[1];
          let bsnh = global_idx / uniforms.global_strides % uniforms.global_shape;
          let size = uniforms.global_shape[0] * uniforms.global_strides[0];
          ${E.guardAgainstOutOfBoundsWorkgroupSizes("size")}

          if (bsnh[3] < half_rotary_emb_dim) {
            let position_ids_idx =
                ${P.broadcastedIndicesToOffset("bsnh.xy",Fn("",P.type.tensor,2))};
            let position_id =
                u32(${P.getByOffset("position_ids_idx")}) + select(0, bsnh[1], position_ids_idx == 0);
            let i = dot(bsnh, uniforms.input_output_strides) + select(0, bsnh[3], ${r});
            let j = i + select(half_rotary_emb_dim, 1, ${r});
            let re = ${T.getByOffset("i")} * ${C.get("position_id","bsnh[3]")} -
                ${T.getByOffset("j")} * ${D.get("position_id","bsnh[3]")};
            ${L.setByOffset("i","re")}
            let im = ${T.getByOffset("i")} * ${D.get("position_id","bsnh[3]")} +
                ${T.getByOffset("j")} * ${C.get("position_id","bsnh[3]")};
            ${L.setByOffset("j","im")}
          } else {
            let k = dot(bsnh, uniforms.input_output_strides) + half_rotary_emb_dim;
            ${L.setByOffset("k",T.getByOffset("k"))}
          }
        }`};return{name:"RotaryEmbedding",shaderCache:{hint:Jo({interleaved:r}).cacheKey,inputDependencies:["rank","rank","rank","rank"]},getShaderSource:x,getRunData:()=>({outputs:[{dims:e[0].dims,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(br.size(_)/Q1)},programUniforms:M})}},ooe=(e,t)=>{f7(e.inputs,t),e.compute(NA(e.inputs,t))}}),p7,m7,D3,g7,soe,UPe=nn(()=>{Zs(),yi(),ER(),toe(),ioe(),N_(),aoe(),Bi(),p7=(e,t)=>{if(t.doRotary&&e.length<=7)throw new Error("cos_cache and sin_cache inputs are required if do_rotary is specified");let r=e[0],n=e[1],i=e[2],o=e[3],s=e[4];if(t.doRotary!==0&&e.length<=7)throw new Error("cos_cast and sin_cache are expected if do_rotary attribute is non-zero");if(t.localWindowSize!==-1)throw new Error("Local attention is not supported");if(t.softcap!==0)throw new Error("Softcap is not supported");if(t.rotaryInterleaved!==0)throw new Error("Rotary interleaved is not supported");if(t.smoothSoftmax)throw new Error("Smooth softmax is not supported");if(r.dims.length!==3&&r.dims.length!==5)throw new Error("Input query is expected to have 3 or 5 dimensions");let a=!1,u=r.dims[0],d=r.dims[1],m=r.dims.length===3?a?r.dims[2]/3:r.dims[2]:t.numHeads*r.dims[4],g=d,_=0,y=!n||n.dims.length===0,M=Math.floor(y?m/(t.numHeads+2*t.kvNumHeads):m/t.numHeads);y&&(m=M*t.numHeads);let x=o&&o.dims.length!==0,E=s&&s.dims.length!==0;if(x&&o.dims.length===4&&o.dims[0]===u&&o.dims[1]!==t.kvNumHeads&&o.dims[2]===t.kvNumHeads&&o.dims[3]===M)throw new Error("BSNH pastKey/pastValue is not supported");if(x&&E){if(o.dims.length!==4)throw new Error('Input "past_key" is expected to have 4 dimensions');if(s.dims.length!==4)throw new Error('Input "past_value" is expected to have 4 dimensions');_=o.dims[2]}else if(x||E)throw new Error('Input "past_key" and "past_value" shall be both present or both absent');let T=1;if(n&&n.dims.length>0){if(r.dims.length!==3)throw new Error('Input "query" is expected to have 3 dimensions when key is given');if(n.dims.length<3||n.dims.length>5)throw new Error('Input "key" is expected to have 3, 4, or 5 dimensions');if(r.dims[0]!==n.dims[0])throw new Error('Input "query" and "key" shall have same dim 0 (batch size)');if(n.dims.length===3){if(r.dims[2]%n.dims[2]!==0)throw new Error('Dimension 2 of "query" should be a multiple of "key"');g=n.dims[1]}else if(n.dims.length===5){if(n.dims[2]!==t.numHeads||n.dims[3]!==2||n.dims[4]!==M)throw new Error('Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv');if(i)throw new Error('Expect "value" be none when "key" has packed kv format.');g=n.dims[1]}else{if(n.dims[1]!==t.numHeads||n.dims[3]!==M)throw new Error('Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key');g=n.dims[2]}}else{if(r.dims.length!==3&&r.dims.length!==5)throw new Error('Input "query" is expected to have 3 or 5 dimensions when key is empty');if(r.dims.length===5&&(r.dims[2]!==t.numHeads||r.dims[3]!==3))throw new Error('Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv');T=3}let P=0,C=!1,D=t.kvNumHeads?M*t.kvNumHeads:m;if(i&&i.dims.length>0){if(i.dims.length!==3&&i.dims.length!==4)throw new Error('Input "value" is expected to have 3 or 4 dimensions');if(r.dims[0]!==i.dims[0])throw new Error('Input "query" and "value" shall have same dim 0 (batch_size)');if(i.dims.length===3){if(g!==i.dims[1])throw new Error('Input "key" and "value" shall have the same dim 1 (kv_sequence_length)');D=i.dims[2]}else{if(g!==i.dims[2])throw new Error('Input "past_key" and "past_value" shall have the same dim 2 (kv_sequence_length)');D=i.dims[1]*i.dims[3],C=!0}}let L=e.length>4?e[5]:void 0;if(L&&L.dims.length!==1&&L.dims[0]!==u)throw new Error('Input "seqlens" is expected to have 1 dimension and the same dim 0 as batch_size');return{batchSize:u,sequenceLength:d,pastSequenceLength:_,kvSequenceLength:g,totalSequenceLength:-1,maxSequenceLength:-1,inputHiddenSize:0,hiddenSize:m,vHiddenSize:D,headSize:M,vHeadSize:Math.floor(D/t.kvNumHeads),numHeads:t.numHeads,kvNumHeads:t.kvNumHeads,nReps:t.numHeads/t.kvNumHeads,pastPresentShareBuffer:!1,maskType:P,scale:t.scale,broadcastResPosBias:!1,passPastInKv:C,qkvFormat:T}},m7=Jo({perm:[0,2,1,3]}),D3=(e,t,r)=>{let n=t,i=r.kvNumHeads;return t.dims.length===3&&r.kvSequenceLength!==0&&(n=t.reshape([r.batchSize,r.kvSequenceLength,i,r.headSize]),n=e.compute(Jd(n,m7.perm),{inputs:[n],outputs:[-1]})[0]),n},g7=(e,t,r,n)=>{let i=7,o=["type","type"],s=[e*t],a=e*t,u=[{type:12,data:a},{type:12,data:t},{type:12,data:e}],d=m=>{let g=kr("seq_lens",r.dataType,r.dims),_=kr("total_seq_lens",n.dataType,n.dims),y=Fn("pos_ids",i,s),M=[{name:"output_size",type:"u32"},{name:"sequence_length",type:"u32"},{name:"batch_size",type:"u32"}];return`
  ${m.registerUniforms(M).declareVariables(g,_,y)}
  ${m.mainStart()}
    ${m.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let total_sequence_length = u32(${_.getByOffset("0")});
    let is_subsequent_prompt = uniforms.sequence_length > 1 && uniforms.sequence_length != total_sequence_length;
    let is_first_prompt = !is_subsequent_prompt && uniforms.sequence_length == total_sequence_length;
    let batch_idx = global_idx / uniforms.sequence_length;
    let sequence_idx = i32(global_idx % uniforms.sequence_length);
    var pos_id: i32 = 0;
    let seqlen = ${g.getByOffset("batch_idx")};
    let total_seqlen = seqlen + 1;
    if (is_first_prompt) {
      if (sequence_idx < total_seqlen) {
        pos_id = sequence_idx;
      } else {
        pos_id = 1;
      }
      ${y.setByOffset("global_idx","pos_id")}
    } else if (is_subsequent_prompt) {
      let past_seqlen = total_seqlen - i32(uniforms.sequence_length);
      if (past_seqlen + sequence_idx < total_seqlen) {
        pos_id = past_seqlen + sequence_idx;
      } else {
        pos_id = 1;
      }
      ${y.setByOffset("global_idx","pos_id")}
    } else if (global_idx < uniforms.batch_size) {
      ${y.setByOffset("global_idx","seqlen")}
    };
  }
  `};return{name:"GeneratePositionIds",shaderCache:{hint:`${e};${t}`,inputDependencies:o},getRunData:()=>({outputs:[{dims:s,dataType:i}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:u}),getShaderSource:d}},soe=(e,t)=>{var D;let r=p7(e.inputs,t);if(e.inputs[0].dims.length===5)throw new Error("Packed QKV is not implemented");if(((D=e.inputs[1])==null?void 0:D.dims.length)===5)throw new Error("Packed KV is not implemented");let n=e.inputs[0],i=e.inputs[1]&&e.inputs[1].dims.length>0?e.inputs[1]:void 0,o=e.inputs[2]&&e.inputs[2].dims.length>0?e.inputs[2]:void 0,s=e.inputs[3]&&e.inputs[3].dims.length!==0?e.inputs[3]:void 0,a=e.inputs[4]&&e.inputs[4].dims.length!==0?e.inputs[4]:void 0,u=e.inputs.length>4?e.inputs[5]:void 0,d=e.inputs.length>5?e.inputs[6]:void 0,m=r.kvNumHeads?r.kvNumHeads:r.numHeads,g=Jo({axis:2,numOutputs:3,splitSizes:[r.numHeads*r.headSize,m*r.headSize,m*r.headSize]}),[_,y,M]=!i&&!o?e.compute(QD([n],g),{inputs:[n],outputs:[-1,-1,-1]}):[n,i,o],x,E;if(t.doRotary){let L=e.compute(g7(r.batchSize,r.sequenceLength,u,d),{inputs:[u,d],outputs:[-1]})[0],N=e.inputs[7],j=e.inputs[8],$=Jo({interleaved:t.rotaryInterleaved!==0,numHeads:r.numHeads,rotaryEmbeddingDim:0,scale:t.scale}),U=[_,L,N,j],G=[-1];x=e.compute(NA(U,$),{inputs:U,outputs:G})[0],U.splice(0,1,y);let H=Jo({interleaved:t.rotaryInterleaved!==0,numHeads:r.kvNumHeads,rotaryEmbeddingDim:0,scale:t.scale});E=e.compute(NA(U,H),{inputs:U,outputs:G})[0]}let T=Xw(e,r.batchSize,r.numHeads,r.sequenceLength,r.headSize,t.doRotary?x:_,void 0,0),P=D3(e,t.doRotary?E:y,r),C=D3(e,M,r);cM(e,T,P,C,void 0,void 0,s,a,void 0,r,u,d)}}),$3,_7,y7,loe,VPe=nn(()=>{yi(),ji(),N_(),Bi(),$3=(e,t,r,n,i,o,s,a)=>{let u=Os(o),d=u===1?"f32":`vec${u}f`,m=u===1?"vec2f":`mat2x${u}f`,g=i*s,_=64;g===1&&(_=256);let y=[i,s,o/u],M=[i,s,2],x=["rank","type","type"],E=[];E.push(...Kn(y,M));let T=P=>{let C=kr("x",t.dataType,3,u),D=kr("scale",r.dataType,r.dims),L=kr("bias",n.dataType,n.dims),N=Fn("output",1,3,2),j=[C,D,L,N];return`
  var<workgroup> workgroup_shared : array<${m}, ${_}>;
  const workgroup_size = ${_}u;
  ${P.declareVariables(...j)}
  ${P.mainStart(_)}
    let batch = workgroup_index / uniforms.x_shape[1];
    let channel = workgroup_index % uniforms.x_shape[1];
    let hight = uniforms.x_shape[2];
    // initialize workgroup memory
    var sum = ${d}(0);
    var squared_sum = ${d}(0);
    for (var h = local_idx; h < hight; h += workgroup_size) {
      let value = ${d}(${C.get("batch","channel","h")});
      sum += value;
      squared_sum += value * value;
    }
    workgroup_shared[local_idx] = ${m}(sum, squared_sum);
    workgroupBarrier();

    for (var currSize = workgroup_size >> 1;  currSize > 0; currSize = currSize >> 1) {
      if (local_idx < currSize) {
        workgroup_shared[local_idx] = workgroup_shared[local_idx] + workgroup_shared[local_idx + currSize];
      }
      workgroupBarrier();
    }
    if (local_idx == 0) {
      let sum_final = ${E_("workgroup_shared[0][0]",u)} / f32(hight * ${u});
      let squared_sum_final = ${E_("workgroup_shared[0][1]",u)} / f32(hight * ${u});

      let inv_std_dev = inverseSqrt(squared_sum_final - sum_final * sum_final + f32(${a}));
      let channel_scale = inv_std_dev * f32(scale[channel]);
      let channel_shift = f32(bias[channel]) - sum_final * channel_scale;
      output[workgroup_index] = vec2f(channel_scale, channel_shift);
    }
  }`};return e.compute({name:"InstanceNormComputeChannelScaleShift",shaderCache:{hint:`${u};${a};${_}`,inputDependencies:x},getRunData:()=>({outputs:[{dims:M,dataType:1}],dispatchGroup:{x:g},programUniforms:E}),getShaderSource:T},{inputs:[t,r,n],outputs:[-1]})[0]},_7=(e,t,r)=>{let n=t[0].dims,i=n,o=2,s=n[0],a=n[1],u=br.sizeFromDimension(n,o),d=Os(u),m=br.size(i)/d,g=$3(e,t[0],t[1],t[2],s,u,a,r.epsilon),_=[s,a,u/d],y=[s,a],M=["type","none"],x=E=>{let T=kr("x",t[0].dataType,_.length,d),P=kr("scale_shift",1,y.length,2),C=Fn("output",t[0].dataType,_.length,d),D=[T,P,C];return`
  ${E.registerUniform("output_size","u32").declareVariables(...D)}
  ${E.mainStart()}
  ${E.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let outputIndices = ${C.offsetToIndices("global_idx")};
      let batch = outputIndices[0];
      let channel = outputIndices[1];
      let scale_shift = ${P.getByIndices("vec2<u32>(batch, channel)")};
      let value = ${T.getByOffset("global_idx")} * ${C.type.value}(scale_shift.x) + ${C.type.value}(scale_shift.y);
      ${C.setByOffset("global_idx","value")};
  }`};e.compute({name:"InstanceNormalization",shaderCache:{hint:`${d}`,inputDependencies:M},getRunData:()=>({outputs:[{dims:i,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(m/64)},programUniforms:[{type:12,data:m},...Kn(_,y,_)]}),getShaderSource:x},{inputs:[t[0],g]})},y7=(e,t,r)=>{let n=t[0].dims,i=n,o=n[0],s=n[n.length-1],a=br.sizeFromDimension(n,1)/s,u=Os(s),d=br.size(i)/u,m=[{type:12,data:a},{type:12,data:Math.floor(s/u)}],g=["type","type"],_=!1,y=[0,n.length-1];for(let T=0;T<n.length-2;T++)_=_||n[T+1]!==1,y.push(T+1);_=_&&n[n.length-1]!==1;let M=_?e.compute(Jd(e.inputs[0],y),{inputs:[e.inputs[0]],outputs:[-1]})[0]:e.inputs[0].reshape(Array.from({length:n.length},(T,P)=>n[y[P]])),x=$3(e,M,t[1],t[2],o,a,s,r.epsilon),E=T=>{let P=mc(t[0].dataType),C=u===1?"vec2f":`mat${u}x2f`,D=j=>{let $=j===0?"x":"y",U=u===1?"f32":`vec${u}f`;switch(u){case 1:return`${P}(${U}(scale.${$}))`;case 2:return`vec2<${P}>(${U}(scale[0].${$}, scale[1].${$}))`;case 4:return`vec4<${P}>(${U}(scale[0].${$}, scale[1].${$}, scale[2].${$}, scale[3].${$}))`;default:throw new Error(`Not supported compoents ${u}`)}},L=kr("input",t[0].dataType,t[0].dims,u),N=Fn("output",t[0].dataType,i,u);return`
  @group(0) @binding(0) var<storage, read> input : array<${L.type.storage}>;
  @group(0) @binding(1) var<storage, read> scale_input : array<${C}>;
  @group(0) @binding(2) var<storage, read_write> output : array<${N.type.storage}>;
  struct Uniforms {H: u32, C : u32};
  @group(0) @binding(3) var<uniform> uniforms: Uniforms;

  ${T.mainStart()}
    let current_image_number = global_idx / (uniforms.C * uniforms.H);
    let current_channel_number = global_idx % uniforms.C;

    let scale_offset = current_image_number * uniforms.C + current_channel_number;
    let scale = scale_input[scale_offset];
    output[global_idx] = fma(input[global_idx], ${D(0)}, ${D(1)});
  }`};e.compute({name:"InstanceNormalizationNHWC",shaderCache:{hint:`${u}`,inputDependencies:g},getRunData:()=>({outputs:[{dims:i,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(d/64)},programUniforms:m}),getShaderSource:E},{inputs:[t[0],x]})},loe=(e,t)=>{t.format==="NHWC"?y7(e,e.inputs,t):_7(e,e.inputs,t)}}),v7,b7,coe,WPe=nn(()=>{yi(),ji(),Bi(),v7=e=>{if(!e||e.length<2)throw new Error("layerNorm requires at least 2 inputs.")},b7=(e,t,r)=>{let n=t.simplified,i=e[0].dims,o=e[1],s=!n&&e[2],a=i,u=br.normalizeAxis(t.axis,i.length),d=br.sizeToDimension(i,u),m=br.sizeFromDimension(i,u),g=br.size(o.dims),_=s?br.size(s.dims):0;if(g!==m||s&&_!==m)throw new Error(`Size of X.shape()[axis:] == ${m}.
       Size of scale and bias (if provided) must match this.
       Got scale size of ${g} and bias size of ${_}`);let y=[];for(let L=0;L<i.length;++L)L<u?y.push(i[L]):y.push(1);let M=Os(m),x=["type","type"],E=[{type:12,data:d},{type:1,data:m},{type:12,data:Math.floor(m/M)},{type:1,data:t.epsilon}];s&&x.push("type");let T=r>1,P=r>2,C=L=>{let N=mc(e[0].dataType),j=[kr("x",e[0].dataType,e[0].dims,M),kr("scale",o.dataType,o.dims,M)];s&&j.push(kr("bias",s.dataType,s.dims,M)),j.push(Fn("output",e[0].dataType,a,M)),T&&j.push(Fn("mean_data_output",1,y)),P&&j.push(Fn("inv_std_output",1,y));let $=[{name:"norm_count",type:"u32"},{name:"norm_size",type:"f32"},{name:"norm_size_vectorized",type:"u32"},{name:"epsilon",type:"f32"}];return`
  ${L.registerUniforms($).declareVariables(...j)}
  ${L.mainStart()}
    ${L.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.norm_count")}
    let offset = global_idx * uniforms.norm_size_vectorized;
    var mean_vector = ${VD("f32",M)};
    var mean_square_vector = ${VD("f32",M)};

    for (var h: u32 = 0u; h < uniforms.norm_size_vectorized; h++) {
      let value = ${i1(N,M,"x[h + offset]")};
      mean_vector += value;
      mean_square_vector += value * value;
    }
    let mean = ${E_("mean_vector",M)} / uniforms.norm_size;
    let inv_std_dev = inverseSqrt(${E_("mean_square_vector",M)} / uniforms.norm_size ${n?"":"- mean * mean"} + uniforms.epsilon);

    for (var j: u32 = 0; j < uniforms.norm_size_vectorized; j++) {
      let f32input = ${i1(N,M,"x[j + offset]")};
      let f32scale = ${i1(N,M,"scale[j]")};
      output[j + offset] = ${j[0].type.value}((f32input ${n?"":"- mean"}) * inv_std_dev * f32scale
        ${s?`+ ${i1(N,M,"bias[j]")}`:""}
      );
    }

    ${T?"mean_data_output[global_idx] = mean":""};
    ${P?"inv_std_output[global_idx] = inv_std_dev":""};
  }`},D=[{dims:a,dataType:e[0].dataType}];return T&&D.push({dims:y,dataType:1}),P&&D.push({dims:y,dataType:1}),{name:"LayerNormalization",shaderCache:{hint:`${M};${r};${n}`,inputDependencies:x},getRunData:()=>({outputs:D,dispatchGroup:{x:Math.ceil(d/64)},programUniforms:E}),getShaderSource:C}},coe=(e,t)=>{v7(e.inputs),e.compute(b7(e.inputs,t,e.outputCount))}}),x7,uoe,GPe=nn(()=>{ji(),OR(),LR(),x7=e=>{if(!e||e.length!==2)throw new Error("MatMul requires 2 inputs.");if(e[0].dims[e[0].dims.length-1]!==e[1].dims[e[1].dims.length-2])throw new Error("shared dimension does not match.")},uoe=e=>{x7(e.inputs);let t=Y1.calcShape(e.inputs[0].dims,e.inputs[1].dims,!0);if(!t)throw new Error("Can't use matmul on the given tensors");let r=t[t.length-1],n=e.inputs[0].dims[e.inputs[0].dims.length-1];if(r<8&&n<8)e.compute(IR(e.inputs,{activation:""},t));else{let i=t[t.length-2],o=br.size(e.inputs[0].dims.slice(0,-2)),s=br.size(e.inputs[1].dims.slice(0,-2));if(o!==1&&i===1&&s===1){let a=e.inputs[0].reshape([1,o,n]),u=e.inputs[1].reshape([1,n,r]),d=[1,o,r],m=[a,u];e.compute($A(m,{activation:""},t,d),{inputs:m})}else e.compute($A(e.inputs,{activation:""},t))}}}),w7,M7,S7,doe,hoe,qPe=nn(()=>{yi(),ji(),Zs(),Bi(),w7=(e,t)=>{if(e.length<3||e.length>4)throw new Error("MatMulNBits requires 3 or 4 inputs");let r=e[0],n=r.dims.length;if(r.dims[n-1]!==t.k)throw new Error("The last dim of input shape does not match the k value");let i=Math.floor((t.k+t.blockSize-1)/t.blockSize),o=t.blockSize/8*t.bits,s=e[1];if(!br.areEqual(s.dims,[t.n,i,o]))throw new Error("The second inputs must be 3D tensor with shape N X nBlocksPerCol X blobSize");let a=e[2].dims;if(br.size(a)!==t.n*i)throw new Error("scales input size error.");if(e.length===4){let u=e[3].dims,d=t.bits>4?t.n*i:t.n*Math.floor((i+1)/2);if(br.size(u)!==d)throw new Error("zeroPoints input size error.")}},M7=(e,t)=>{let r=e[0].dims,n=r.length,i=r[n-2],o=t.k,s=t.n,a=r.slice(0,n-2),u=br.size(a),d=e[1].dims[2]/4,m=e[0].dataType,g=Os(t.k),_=Os(d),y=Os(s),M=a.concat([i,s]),x=i>1&&s/y%2===0?2:1,E=br.size(M)/y/x,T=64,P=[],C=[u,i,o/g],D=br.convertShape(e[1].dims).slice();D.splice(-1,1,d/_),P.push(...Kn(C)),P.push(...Kn(D)),P.push(...Kn(e[2].dims)),e.length===4&&P.push(...Kn(br.convertShape(e[3].dims)));let L=[u,i,s/y];P.push(...Kn(L));let N=j=>{let $=C.length,U=kr("a",e[0].dataType,$,g),G=kr("b",12,D.length,_),H=kr("scales",e[2].dataType,e[2].dims.length),X=[U,G,H],ee=e.length===4?kr("zero_points",12,e[3].dims.length):void 0;ee&&X.push(ee);let ae=L.length,de=Fn("output",e[0].dataType,ae,y),ye=mc(e[0].dataType),_e=(()=>{switch(g){case 1:return`array<${ye}, 8>`;case 2:return`mat4x2<${ye}>`;case 4:return`mat2x4<${ye}>`;default:throw new Error(`${g}-component is not supported.`)}})(),ue=()=>{let pe=`
          // reuse a data
            var input_offset = ${U.indicesToOffset(`${U.type.indices}(batch, row, word_offset)`)};
            var a_data: ${_e};
            for (var j: u32 = 0; j < ${8/g}; j++) {
              a_data[j] = ${U.getByOffset("input_offset")};
              input_offset++;
            }
          `;for(let K=0;K<y*x;K++)pe+=`
            b_value = ${_===1?`b${K}_data`:`b${K}_data[i]`};
            b_value_lower = unpack4xU8(b_value & b_mask);
            b_value_upper = unpack4xU8((b_value >> 4) & b_mask);
            b_quantized_values = ${_e}(${Array.from({length:4},(te,ve)=>`${ye}(b_value_lower[${ve}]), ${ye}(b_value_upper[${ve}])`).join(", ")});
            b_dequantized_values = ${g===1?`${_e}(${Array.from({length:8},(te,ve)=>`(b_quantized_values[${ve}] - ${ee?`zero_point${K}`:"zero_point"}) * scale${K}`).join(", ")});`:`(b_quantized_values - ${_e}(${Array(8).fill(`${ee?`zero_point${K}`:"zero_point"}`).join(",")})) * scale${K};`};
            workgroup_shared[local_id.x * ${x} + ${Math.floor(K/y)}]${y>1?`[${K%y}]`:""} += ${Array.from({length:8/g},(te,ve)=>`${g===1?`a_data[${ve}] * b_dequantized_values[${ve}]`:`dot(a_data[${ve}], b_dequantized_values[${ve}])`}`).join(" + ")};
          `;return pe},fe=()=>{let pe=`
            var col_index = col * ${y};
            ${ee?`
            let zero_point_bytes_per_col = (nBlocksPerCol + 1) / 2;
            var zero_point_byte_count: u32;
            var zero_point_word_index: u32;
            var zero_point_byte_offset: u32;
            let zero_point_nibble_offset: u32 = block & 0x1u;
            var zero_point_bits_offset: u32;
            var zero_point_word: u32;`:`
            // The default zero point is 8 for unsigned 4-bit quantization.
            let zero_point = ${ye}(8);`}
            `;for(let K=0;K<y*x;K++)pe+=`
            let scale${K} = ${H.getByOffset("col_index * nBlocksPerCol + block")};
            ${ee?`
            zero_point_byte_count = col_index * zero_point_bytes_per_col + (block >> 0x1u);
            zero_point_word_index = zero_point_byte_count >> 0x2u;
            zero_point_byte_offset = zero_point_byte_count & 0x3u;
            zero_point_bits_offset = (zero_point_byte_offset << 3) + (zero_point_nibble_offset << 2);
            zero_point_word = ${ee.getByOffset("zero_point_word_index")} >> zero_point_bits_offset;
            let zero_point${K} = ${ye}((zero_point_word) & 0xFu);`:""}
            col_index += 1;`;return pe},De=()=>{let pe=`col_index = col * ${y};`;for(let K=0;K<y*x;K++)pe+=`
            let b${K}_data = ${G.getByIndices(`${G.type.indices}(col_index, block, word)`)};
            col_index += 1;`;return pe+=`
            var b_value: u32;
            let b_mask: u32 = 0x0F0F0F0Fu;
            var b_value_lower: vec4<u32>;
            var b_value_upper: vec4<u32>;
            var b_quantized_values: ${_e};
            var b_dequantized_values: ${_e};`,pe};return`
        var<workgroup> workgroup_shared: array<${de.type.value}, ${x*T}>;
        ${j.declareVariables(...X,de)}
        ${j.mainStart([T,1,1])}
          let output_indices = ${de.offsetToIndices(`(global_idx / ${T}) * ${x}`)};
          let col = output_indices[2];
          let row = output_indices[1];
          let batch = output_indices[0];
          let nBlocksPerCol = uniforms.b_shape[1];

          for (var block = local_id.x; block < nBlocksPerCol; block += ${T}) {
            //process one block
            var word_offset: u32 = block * ${t.blockSize/g};
            ${fe()}
            for (var word: u32 = 0; word < ${d}; word += ${_}) {
              ${De()}
              for (var i: u32 = 0; i < ${_}; i++) {
                ${ue()}
                word_offset += ${8/g};
              }
            }
          }
          workgroupBarrier();

          if (local_id.x < ${x}) {
            var output_value: ${de.type.value} = ${de.type.value}(0);
            var workgroup_shared_offset: u32 = local_id.x;
            for (var b: u32 = 0u; b < ${T}u; b++) {
              output_value += workgroup_shared[workgroup_shared_offset];
              workgroup_shared_offset += ${x};
            }
            ${de.setByIndices(`${de.type.indices}(batch, row, col + local_id.x)`,"output_value")};
          }
        }`};return{name:"MatMulNBits",shaderCache:{hint:`${t.blockSize};${t.bits};${g};${_};${y};${x};${T}`,inputDependencies:Array(e.length).fill("rank")},getRunData:()=>({outputs:[{dims:M,dataType:m}],dispatchGroup:{x:E},programUniforms:P}),getShaderSource:N}},S7=(e,t)=>{let r=e[0].dims,n=r.length,i=r[n-2],o=t.k,s=t.n,a=r.slice(0,n-2),u=br.size(a),d=e[1].dims[2]/4,m=e[0].dataType,g=Os(t.k),_=Os(d),y=a.concat([i,s]),M=128,x=s%8===0?8:s%4===0?4:1,E=M/x,T=E*_*8,P=T/g,C=T/t.blockSize,D=br.size(y)/x,L=[],N=[u,i,o/g],j=br.convertShape(e[1].dims).slice();j.splice(-1,1,d/_),L.push(...Kn(N)),L.push(...Kn(j)),L.push(...Kn(e[2].dims)),e.length===4&&L.push(...Kn(br.convertShape(e[3].dims)));let $=[u,i,s];L.push(...Kn($));let U=G=>{let H=N.length,X=kr("a",e[0].dataType,H,g),ee=kr("b",12,j.length,_),ae=kr("scales",e[2].dataType,e[2].dims.length),de=[X,ee,ae],ye=e.length===4?kr("zero_points",12,e[3].dims.length):void 0;ye&&de.push(ye);let _e=$.length,ue=Fn("output",e[0].dataType,_e),fe=mc(e[0].dataType),De=()=>{switch(g){case 1:return`
          let a_data0 = vec4<${fe}>(sub_a[word_offset], sub_a[word_offset + 1], sub_a[word_offset + 2], sub_a[word_offset + 3]);
          let a_data1 = vec4<${fe}>(sub_a[word_offset + 4], sub_a[word_offset + 5], sub_a[word_offset + 6], sub_a[word_offset + 7]);`;case 2:return`
          let a_data0 = vec4<${fe}>(sub_a[word_offset], sub_a[word_offset + 1]);
          let a_data1 = vec4<${fe}>(sub_a[word_offset + 2], sub_a[word_offset + 3]);`;case 4:return`
          let a_data0 = sub_a[word_offset];
          let a_data1 = sub_a[word_offset + 1];`;default:throw new Error(`${g}-component is not supported.`)}};return`
        var<workgroup> sub_a: array<${X.type.value}, ${P}>;
        var<workgroup> inter_results: array<array<${ue.type.value}, ${E}>, ${x}>;
        ${G.declareVariables(...de,ue)}
        ${G.mainStart([E,x,1])}
          let output_indices = ${ue.offsetToIndices(`workgroup_index * ${x}`)};
          let col = output_indices[2];
          let row = output_indices[1];
          let batch = output_indices[0];
          let n_blocks_per_col = uniforms.b_shape[1];
          let num_tiles =  (n_blocks_per_col - 1) / ${C} + 1;

          // Loop over shared dimension.
          for (var tile: u32 = 0; tile < num_tiles; tile += 1) {
            let a_col_start = tile * ${P};
            // load one tile A data into shared memory.
            for (var a_offset = local_idx; a_offset < ${P}; a_offset += ${M})
            {
              let a_col = a_col_start + a_offset;
              if (a_col < uniforms.a_shape[2])
              {
                sub_a[a_offset] = ${X.getByIndices(`${X.type.indices}(batch, row, a_col)`)};
              } else {
                sub_a[a_offset] = ${X.type.value}(0);
              }
            }
            workgroupBarrier();

            // each thread process one block
            let b_row = col + local_id.y;
            let block = tile * ${C} + local_id.x;
            ${ye?`
            let zero_point_bytes_per_col = (n_blocks_per_col + 1) / 2;
            let zero_point_byte_count = b_row * zero_point_bytes_per_col + (block >> 0x1u);
            let zero_point_word_index = zero_point_byte_count >> 0x2u;
            let zero_point_byte_offset = zero_point_byte_count & 0x3u;
            let zero_point_nibble_offset: u32 = block & 0x1u;
            let zero_point_bits_offset = (zero_point_byte_offset << 3) + (zero_point_nibble_offset << 2);
            let zero_point_word = ${ye.getByOffset("zero_point_word_index")} >> zero_point_bits_offset;
            let zero_point = ${fe}((zero_point_word) & 0xFu);`:`
            // The default zero point is 8 for unsigned 4-bit quantization.
            let zero_point = ${fe}(8);`}
            let scale = ${ae.getByOffset("b_row * n_blocks_per_col + block")};
            let b_data = ${ee.getByIndices(`${ee.type.indices}(b_row, block, 0)`)};
            var word_offset = local_id.x * ${t.blockSize/g};
            for (var i: u32 = 0; i < ${_}; i++) {
              ${De()}
              let b_value = ${_===1?"b_data":"b_data[i]"};
              let b_value_lower = unpack4xU8(b_value & 0x0F0F0F0Fu);
              let b_value_upper = unpack4xU8((b_value >> 4) & 0x0F0F0F0Fu);
              let b_quantized_values = mat2x4<${fe}>(${Array.from({length:4},(pe,K)=>`${fe}(b_value_lower[${K}]), ${fe}(b_value_upper[${K}])`).join(", ")});
              let b_dequantized_values = (b_quantized_values - mat2x4<${fe}>(${Array(8).fill("zero_point").join(",")})) * scale;
              inter_results[local_id.y][local_id.x] += ${Array.from({length:2},(pe,K)=>`${`dot(a_data${K}, b_dequantized_values[${K}])`}`).join(" + ")};
              word_offset += ${8/g};
            }
            workgroupBarrier();
          }

          if (local_idx < ${x}) {
            var output_value: ${ue.type.value} = ${ue.type.value}(0);
            for (var b = 0u; b < ${E}; b++) {
              output_value += inter_results[local_idx][b];
            }
            if (col + local_idx < uniforms.output_shape[2])
            {
              ${ue.setByIndices(`${ue.type.indices}(batch, row, col + local_idx)`,"output_value")}
            }
          }
        }`};return{name:"BlockwiseMatMulNBits32",shaderCache:{hint:`${t.blockSize};${g};${_};${E};${x}`,inputDependencies:Array(e.length).fill("rank")},getRunData:()=>({outputs:[{dims:y,dataType:m}],dispatchGroup:{x:D},programUniforms:L}),getShaderSource:U}},doe=(e,t)=>{w7(e.inputs,t),t.blockSize===32&&e.adapterInfo.isVendor("intel")&&e.adapterInfo.isArchitecture("gen-12lp")?e.compute(S7(e.inputs,t)):e.compute(M7(e.inputs,t))},hoe=e=>Jo(e)}),T7,P7,E7,A7,C7,k7,I7,O7,foe,HPe=nn(()=>{yi(),ji(),Bi(),T7=e=>{if(!e||e.length<1)throw new Error("Too few inputs");if(e[0].dataType!==1&&e[0].dataType!==10)throw new Error("Input type must be float or float16.");if(e.length>=2){let t=e[0].dims.length*2===e[1].dims[0];if(e.length===4&&(t=e[3].dims[0]*2===e[1].dims[0]),!t)throw new Error("The pads should be a 1D tensor of shape [2 * input_rank] or [2 * num_axes].")}},P7=(e,t,r)=>{let n="";for(let i=t-1;i>=0;--i)n+=`
            k = i32(${e.indicesGet("indices",i)}) - ${Wn("uniforms.pads",i,r)};
            if (k < 0) {
              break;
            }
            if (k >= i32(${Wn("uniforms.x_shape",i,t)})) {
              break;
            }
            offset += k * i32(${Wn("uniforms.x_strides",i,t)});
        `;return`
          value = ${e.type.value}(uniforms.constant_value);
          for (var i = 0; i < 1; i++) {
            var offset = 0;
            var k = 0;
            ${n}
            value = x[offset];
          }
      `},E7=(e,t,r)=>{let n="";for(let i=t-1;i>=0;--i)n+=`
                k = i32(${e.indicesGet("indices",i)}) - ${Wn("uniforms.pads",i,r)};
                if (k < 0) {
                  k = -k;
                }
                {
                  let _2n_1 = 2 * (i32(${Wn("uniforms.x_shape",i,t)}) - 1);
                  k = k % _2n_1;
                  if(k >= i32(${Wn("uniforms.x_shape",i,t)})) {
                    k = _2n_1 - k;
                  }
                }
                offset += k * i32(${Wn("uniforms.x_strides",i,t)});
            `;return`
              var offset = 0;
              var k = 0;
              ${n}
              value = x[offset];
          `},A7=(e,t,r)=>{let n="";for(let i=t-1;i>=0;--i)n+=`
                k = i32(${e.indicesGet("indices",i)}) - ${Wn("uniforms.pads",i,r)};
                if (k < 0) {
                  k = 0;
                }
                if (k >= i32(${Wn("uniforms.x_shape",i,t)})) {
                  k = i32(${Wn("uniforms.x_shape",i,t)}) - 1;
                }
                offset += k * i32(${Wn("uniforms.x_strides",i,t)});
            `;return`
              var offset = 0;
              var k = 0;
              ${n}
              value = x[offset];
          `},C7=(e,t,r)=>{let n="";for(let i=t-1;i>=0;--i)n+=`
                k = i32(${e.indicesGet("indices",i)}) - ${Wn("uniforms.pads",i,r)};
                if (k < 0)  {
                  k += i32(${Wn("uniforms.x_shape",i,t)}]);
                }
                if (k >= i32(${Wn("uniforms.x_shape",i,t)})) {
                  k -= i32(${Wn("uniforms.x_shape",i,t)});
                }
                offset += k * i32(${Wn("uniforms.x_strides",i,t)});
            `;return`
              var offset = 0;
              var k = 0;
              ${n}
              value = x[offset];
          `},k7=(e,t,r)=>{switch(r.mode){case 0:return P7(e,t,r.pads.length);case 1:return E7(e,t,r.pads.length);case 2:return A7(e,t,r.pads.length);case 3:return C7(e,t,r.pads.length);default:throw new Error("Invalid mode")}},I7=(e,t)=>{let r=br.padShape(e[0].dims.slice(),t.pads),n=e[0].dims,i=br.size(r),o=[{type:12,data:i},{type:6,data:t.pads}],s=e.length>=3&&e[2].data;t.mode===0&&o.push({type:s?e[2].dataType:1,data:t.value}),o.push(...Kn(e[0].dims,r));let a=["rank"],u=d=>{let m=Fn("output",e[0].dataType,r.length),g=kr("x",e[0].dataType,n.length),_=g.type.value,y=k7(m,n.length,t),M=[{name:"output_size",type:"u32"},{name:"pads",type:"i32",length:t.pads.length}];return t.mode===0&&M.push({name:"constant_value",type:s?_:"f32"}),`
            ${d.registerUniforms(M).declareVariables(g,m)}
            ${d.mainStart()}
            ${d.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

            let indices = ${m.offsetToIndices("global_idx")};

            var value = ${_}(0);
            ${y}
            output[global_idx] = value;
        }`};return{name:"Pad",shaderCache:{hint:`${t.mode}${s}`,inputDependencies:a},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(br.size(r)/64)},programUniforms:o}),getShaderSource:u}},O7=(e,t)=>{if(e.length>1){let r=e[1].getBigInt64Array(),n=e.length>=3&&e[2].data?e[2].dataType===10?e[2].getUint16Array()[0]:e[2].getFloat32Array()[0]:0,i=e[0].dims.length,o=new Int32Array(2*i).fill(0);if(e.length>=4){let a=e[3].getBigInt64Array();for(let u=0;u<a.length;u++)o[Number(a[u])]=Number(r[u]),o[Number(a[u])+i]=Number(r[u+a.length])}else r.forEach((a,u)=>o[Number(u)]=Number(a));let s=[];return o.forEach(a=>s.push(a)),{mode:t.mode,value:n,pads:s}}else return t},foe=(e,t)=>{T7(e.inputs);let r=O7(e.inputs,t);e.compute(I7(e.inputs,r),{inputs:[0]})}}),Mw,N3,j3,R3,F3,L7,D7,z3,B3,poe,moe,U3,goe,_oe,V3,yoe,voe,boe,xoe,KPe=nn(()=>{Kf(),yi(),ji(),Bi(),Mw=e=>{if(Ua.webgpu.validateInputContent&&(!e||e.length!==1))throw new Error("Pool ops requires 1 input.")},N3=(e,t,r)=>{let n=t.format==="NHWC",i=e.dims.slice();n&&i.splice(1,0,i.pop());let o=Object.hasOwnProperty.call(t,"dilations"),s=t.kernelShape.slice(),a=t.strides.slice(),u=o?t.dilations.slice():[],d=t.pads.slice();LA.adjustPoolAttributes(r,i,s,a,u,d);let m=LA.computePoolOutputShape(r,i,a,u,s,d,t.autoPad),g=Object.assign({},t);o?Object.assign(g,{kernelShape:s,strides:a,pads:d,dilations:u,cacheKey:t.cacheKey}):Object.assign(g,{kernelShape:s,strides:a,pads:d,cacheKey:t.cacheKey});let _=m.slice();return _.push(_.splice(1,1)[0]),[g,n?_:m]},j3=(e,t)=>{let r=t.format==="NHWC",n=br.size(e),i=br.size(t.kernelShape),o=[{type:12,data:n},{type:12,data:i}],s=[{name:"outputSize",type:"u32"},{name:"kernelSize",type:"u32"}];if(t.kernelShape.length<=2){let a=t.kernelShape[t.kernelShape.length-1],u=t.strides[t.strides.length-1],d=t.pads[t.pads.length/2-1],m=t.pads[t.pads.length-1],g=!!(d+m);o.push({type:12,data:a},{type:12,data:u},{type:12,data:d},{type:12,data:m}),s.push({name:"kw",type:"u32"},{name:"sw",type:"u32"},{name:"pwStart",type:"u32"},{name:"pwEnd",type:"u32"});let _=!1;if(t.kernelShape.length===2){let y=t.kernelShape[t.kernelShape.length-2],M=t.strides[t.strides.length-2],x=t.pads[t.pads.length/2-2],E=t.pads[t.pads.length-2];_=!!(x+E),o.push({type:12,data:y},{type:12,data:M},{type:12,data:x},{type:12,data:E}),s.push({name:"kh",type:"u32"},{name:"sh",type:"u32"},{name:"phStart",type:"u32"},{name:"phEnd",type:"u32"})}return[o,s,!0,g,_]}else{if(r)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let a=br.computeStrides(t.kernelShape);o.push({type:12,data:a},{type:12,data:t.pads},{type:12,data:t.strides}),s.push({name:"kernelStrides",type:"u32",length:a.length},{name:"pads",type:"u32",length:t.pads.length},{name:"strides",type:"u32",length:t.strides.length});let u=t.pads.reduce((d,m)=>d+m);return[o,s,!!u,!1,!1]}},R3=(e,t,r,n,i,o,s,a,u,d,m,g)=>{let _=i.format==="NHWC",y=t.type.value,M=Fn("output",t.type.tensor,n);if(i.kernelShape.length<=2){let x="",E="",T="",P=r-(_?2:1);if(m?x=`
                for (var i: u32 = 0u; i < uniforms.kw; i++) {
                  xIndices[${P}] = indices[${P}] * uniforms.sw - uniforms.pwStart + i;
                  if (xIndices[${P}] < 0 || xIndices[${P}]
                      >= uniforms.x_shape[${P}]) {
                    pad++;
                    continue;
                  }
                  let x_val = x[${t.indicesToOffset("xIndices")}];
                  ${o}
                }`:x=`
                for (var i: u32 = 0u; i < uniforms.kw; i++) {
                  xIndices[${P}] = indices[${P}] * uniforms.sw - uniforms.pwStart + i;
                  let x_val = x[${t.indicesToOffset("xIndices")}];
                  ${o}
                }`,i.kernelShape.length===2){let C=r-(_?3:2);g?E=`
                for (var j: u32 = 0u; j < uniforms.kh; j++) {
                  xIndices[${C}] = indices[${C}] * uniforms.sh - uniforms.phStart + j;
                  if (xIndices[${C}] < 0 || xIndices[${C}] >= uniforms.x_shape[${C}]) {
                    pad += i32(uniforms.kw);
                    continue;
                  }
              `:E=`
                for (var j: u32 = 0u; j < uniforms.kh; j++) {
                  xIndices[${C}] = indices[${C}] * uniforms.sh - uniforms.phStart + j;
                `,T=`
              }
            `}return`
            ${e.registerUniforms(u).declareVariables(t,M)}

            ${e.mainStart()}
              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

              let indices = ${M.offsetToIndices("global_idx")};
              var xIndices = ${M.offsetToIndices("global_idx")};

              var value = ${y}(${a});
              var pad = 0;
              ${E}
              ${x}
              ${T}
              ${s}

              output[global_idx] = value;
            }`}else{if(_)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let x=i.kernelShape.length,E=i.pads.length,T="";return d?T=`
                if (xIndices[j] >= uniforms.x_shape[j]) {
                  pad++;
                  isPad = true;
                  break;
                }
              }
              if (!isPad) {
                let x_val = x[${t.indicesToOffset("xIndices")}];
                ${o}
              }`:T=`
              }
              let x_val = x[${t.indicesToOffset("xIndices")}];
              ${o}
            `,`
            ${e.registerUniforms(u).declareVariables(t,M)}

            ${e.mainStart()}
              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
              let indices = ${M.offsetToIndices("global_idx")};
              var xIndices = ${M.offsetToIndices("global_idx")};

              var offsets: array<u32, ${x}>;

              var value = ${y}(${a});
              var pad = 0;
              var isPad = false;

              for (var i: u32 = 0u; i < uniforms.kernelSize; i++) {
                var offset = i;
                for (var j = 0u; j < ${x-1}u; j++) {
                  offsets[j] = offset / ${Wn("uniforms.kernelStrides","j",x)};
                  offset -= offsets[j] * ${Wn("uniforms.kernelStrides","j",x)};
                }
                offsets[${x-1}] = offset;

                isPad = false;
                for (var j = ${r-x}u; j < ${r}u; j++) {
                  xIndices[j] = indices[j] * ${Wn("uniforms.strides",`j - ${r-x}u`,x)}
                    + offsets[j - ${r-x}u] - ${Wn("uniforms.pads","j - 2u",E)};
                  ${T}
              }
              ${s}

              output[global_idx] = value;
            }`}},F3=e=>`${e.format};${e.ceilMode};${e.autoPad};${e.kernelShape.length}`,L7=e=>`${F3(e)};${e.countIncludePad}`,D7=e=>`${F3(e)};${e.storageOrder};${e.dilations}`,z3=e=>({format:e.format,autoPad:["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],ceilMode:e.ceil_mode,kernelShape:e.kernel_shape,strides:e.strides,pads:e.pads}),B3=(e,t,r,n)=>{let[i,o]=N3(t,n,r),s=kr("x",t.dataType,t.dims.length),a=s.type.value,u="value += x_val;",d="";i.countIncludePad?d+=`value /= ${a}(uniforms.kernelSize);`:d+=`value /= ${a}(i32(uniforms.kernelSize) - pad);`;let[m,g,_,y,M]=j3(o,i);m.push(...Kn(t.dims,o));let x=["rank"];return{name:e,shaderCache:{hint:`${n.cacheKey};${_};${y};${M}`,inputDependencies:x},getRunData:()=>({outputs:[{dims:o,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(br.size(o)/64)},programUniforms:m}),getShaderSource:E=>R3(E,s,t.dims.length,o.length,i,u,d,0,g,_,y,M)}},poe=e=>{let t=e.count_include_pad!==0,r=z3(e);if(r.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");let n={countIncludePad:t,...r,cacheKey:""};return{...n,cacheKey:L7(n)}},moe=(e,t)=>{Mw(e.inputs),e.compute(B3("AveragePool",e.inputs[0],!1,t))},U3={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[]},goe=e=>{let t=e.format;return{format:t,...U3,cacheKey:t}},_oe=(e,t)=>{Mw(e.inputs),e.compute(B3("GlobalAveragePool",e.inputs[0],!0,t))},V3=(e,t,r,n)=>{let[i,o]=N3(t,n,r),s=`
      value = max(x_val, value);
    `,a="",u=kr("x",t.dataType,t.dims.length),d=["rank"],[m,g,_,y,M]=j3(o,i);return m.push(...Kn(t.dims,o)),{name:e,shaderCache:{hint:`${n.cacheKey};${_};${y};${M}`,inputDependencies:d},getRunData:()=>({outputs:[{dims:o,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(br.size(o)/64)},programUniforms:m}),getShaderSource:x=>R3(x,u,t.dims.length,o.length,i,s,a,t.dataType===10?-65504:-1e5,g,_,y,M)}},yoe=(e,t)=>{Mw(e.inputs),e.compute(V3("MaxPool",e.inputs[0],!1,t))},voe=e=>{let t=e.storage_order,r=e.dilations,n=z3(e);if(t!==0)throw new Error("column major storage order is not yet supported for MaxPool");if(n.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");let i={storageOrder:t,dilations:r,...n,cacheKey:""};return{...i,cacheKey:D7(i)}},boe=e=>{let t=e.format;return{format:t,...U3,cacheKey:t}},xoe=(e,t)=>{Mw(e.inputs),e.compute(V3("GlobalMaxPool",e.inputs[0],!0,t))}}),$7,N7,woe,Moe,ZPe=nn(()=>{yi(),ji(),Zs(),Bi(),$7=(e,t)=>{if(e.length<2||e.length>3)throw new Error("DequantizeLinear requires 2 or 3 inputs.");if(e.length===3&&e[1].dims===e[2].dims)throw new Error("x-scale and x-zero-point must have the same shape.");if(e.length===3&&e[0].dataType!==e[2].dataType)throw new Error("x and x-zero-point must have the same data type.");if(e[0].dataType===6&&e.length>2)throw new Error("In the case of dequantizing int32 there is no zero point.");if(e[1].dims.length!==0&&e[1].dims.length!==1&&e[1].dims.length!==e[0].dims.length)throw new Error("scale input must be a scalar, a 1D tensor, or have the same rank as the input tensor.");if(e.length>2){if(e[0].dataType!==e[2].dataType)throw new Error("x and x-zero-point must have the same data type.");if(e[1].dims.length!==e[2].dims.length)throw new Error("scale and zero-point inputs must have the same rank.");if(!e[1].dims.map((r,n)=>r===e[2].dims[n]).reduce((r,n)=>r&&n,!0))throw new Error("scale and zero-point inputs must have the same shape.")}if(t.blockSize>0){if(e[1].dims.length===0||e[1].dims.length===1&&e[1].dims[0]===1)throw new Error("blockSize must be set only for block quantization.");if(!e[1].dims.map((i,o)=>o===t.axis||i===e[0].dims[o]).reduce((i,o)=>i&&o,!0))throw new Error("For block qunatization, scale input shape to match the input shape except for the axis");if(e[1].dims.length!==e[0].dims.length)throw new Error("For block qunatization the scale input rank must be the same as the x rank.");let r=e[0].dims[t.axis],n=e[1].dims[t.axis];if(t.blockSize<Math.ceil(r/n)||t.blockSize>Math.ceil(r/(n-1)-1))throw new Error("blockSize must be with in the range [ceil(dI / Si), ceil(dI / (Si - 1) - 1)].")}},N7=(e,t)=>{let r=br.normalizeAxis(t.axis,e[0].dims.length),n=e[0].dataType,i=n===3,o=e[0].dims,s=e[1].dataType,a=br.size(o),u=n===3||n===2,d=u?[Math.ceil(br.size(e[0].dims)/4)]:e[0].dims,m=e[1].dims,g=e.length>2?e[2]:void 0,_=g?u?[Math.ceil(br.size(g.dims)/4)]:g.dims:void 0,y=m.length===0||m.length===1&&m[0]===1,M=y===!1&&m.length===1,x=Os(a),E=y&&(!u||x===4),T=E?x:1,P=E&&!u?x:1,C=kr("input",u?12:n,d.length,P),D=kr("scale",s,m.length),L=g?kr("zero_point",u?12:n,_.length):void 0,N=Fn("output",s,o.length,T),j=[C,D];L&&j.push(L);let $=[d,m];g&&$.push(_);let U=[{type:12,data:a/T},{type:12,data:r},{type:12,data:t.blockSize},...Kn(...$,o)],G=H=>{let X=[{name:"output_size",type:"u32"},{name:"axis",type:"u32"},{name:"block_size",type:"u32"}];return`
      ${H.registerUniforms(X).declareVariables(...j,N)}
      ${H.mainStart()}
          ${H.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          let output_indices = ${N.offsetToIndices("global_idx")};

          // Set input x
          ${u?`
            let input = ${C.getByOffset("global_idx / 4")};
            let x_vec = ${i?"unpack4xI8(input)":"unpack4xU8(input)"};
            let x_value = ${T===1?"x_vec[global_idx % 4]":"x_vec"};`:`let x_value = ${C.getByOffset("global_idx")};`};

          // Set scale input
          ${y?`let scale_value= ${D.getByOffset("0")}`:M?`
            let scale_index = ${N.indicesGet("output_indices","uniforms.axis")};
            let scale_value= ${D.getByOffset("scale_index")};`:`
            var scale_indices: ${D.type.indices} = output_indices;
            let index = ${D.indicesGet("scale_indices","uniforms.axis")} / uniforms.block_size;
            ${D.indicesSet("scale_indices","uniforms.axis","index")};
            let scale_value= ${D.getByIndices("scale_indices")};`};

          // Set zero-point input
          ${L?y?u?`
                let zero_point_input = ${L.getByOffset("0")};
                let zero_point_vec =  ${i?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value= zero_point_vec[0]`:`let zero_point_value = ${L.getByOffset("0")}`:M?u?`
                let zero_point_index = ${N.indicesGet("output_indices","uniforms.axis")};
                let zero_point_input = ${L.getByOffset("zero_point_index / 4")};
                let zero_point_vec =  ${i?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value = zero_point_vec[zero_point_index % 4]`:`
                let zero_point_index = ${N.indicesGet("output_indices","uniforms.axis")};
                let zero_point_value = ${L.getByOffset("zero_point_index")};`:u?`
                let zero_point_offset = ${D.indicesToOffset("scale_indices")};
                let zero_point_input = ${L.getByOffset("zero_point_offset / 4")};
                let zero_point_vec = ${i?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value = zero_point_vec[zero_point_offset % 4];`:`let zero_point_value = ${L.getByIndices("scale_indices")};`:`let zero_point_value = ${u?i?"i32":"u32":C.type.value}(0);`};
      // Compute and write output
      ${N.setByOffset("global_idx",`${N.type.value}(x_value - zero_point_value) * scale_value`)};
      }`};return{name:"DequantizeLinear",shaderCache:{hint:t.cacheKey,inputDependencies:L?["rank","rank","rank"]:["rank","rank"]},getShaderSource:G,getRunData:()=>({outputs:[{dims:o,dataType:s}],dispatchGroup:{x:Math.ceil(a/T/64),y:1,z:1},programUniforms:U})}},woe=(e,t)=>{$7(e.inputs,t),e.compute(N7(e.inputs,t))},Moe=e=>Jo({axis:e.axis,blockSize:e.blockSize})}),j7,R7,Soe,XPe=nn(()=>{Kf(),yi(),Bi(),j7=(e,t,r)=>{let n=e===t,i=e<t&&r<0,o=e>t&&r>0;if(n||i||o)throw new Error("Range these inputs' contents are invalid.")},R7=(e,t,r,n)=>{let i=Math.abs(Math.ceil((t-e)/r)),o=[i],s=i,a=[{type:12,data:s},{type:n,data:e},{type:n,data:r},...Kn(o)],u=d=>{let m=Fn("output",n,o.length),g=m.type.value,_=[{name:"outputSize",type:"u32"},{name:"start",type:g},{name:"delta",type:g}];return`
        ${d.registerUniforms(_).declareVariables(m)}
        ${d.mainStart()}
        ${d.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
        output[global_idx] = uniforms.start + ${g}(global_idx) * uniforms.delta;
      }`};return{name:"Range",shaderCache:{hint:`${n}`},getShaderSource:u,getRunData:()=>({outputs:[{dims:o,dataType:n}],dispatchGroup:{x:Math.ceil(s/64)},programUniforms:a})}},Soe=e=>{let t=0,r=0,n=0;e.inputs[0].dataType===6?(t=e.inputs[0].getInt32Array()[0],r=e.inputs[1].getInt32Array()[0],n=e.inputs[2].getInt32Array()[0]):e.inputs[0].dataType===1&&(t=e.inputs[0].getFloat32Array()[0],r=e.inputs[1].getFloat32Array()[0],n=e.inputs[2].getFloat32Array()[0]),Ua.webgpu.validateInputContent&&j7(t,r,n),e.compute(R7(t,r,n,e.inputs[0].dataType),{inputs:[]})}}),F7,W3,G3,z7,Toe,Poe,YPe=nn(()=>{yi(),ji(),Zs(),Bi(),F7=(e,t,r,n)=>{if(e!=="none"&&n!=="i32"&&n!=="u32"&&n!=="f32")throw new Error(`Input ${n} is not supported with reduction ${e}.`);let i=`{
                var oldValue = 0;
                loop {
                  let newValueF32 =`,o=`;
                  let newValue = bitcast<i32>(newValueF32);
                  let res = atomicCompareExchangeWeak(&${t}, oldValue, newValue);
                  if res.exchanged {
                    break;
                  }
                  oldValue = res.old_value;
                }
              }`;switch(e){case"none":return`${t}=${r};`;case"add":return n==="i32"||n==="u32"?`atomicAdd(&${t}, bitcast<${n}>(${r}));`:`
              ${i}bitcast<${n}>(oldValue) + (${r})${o}`;case"max":return n==="i32"||n==="u32"?`atomicMax(&${t}, bitcast<${n}>(${r}));`:`
                ${i}max(bitcast<f32>(oldValue), (${r}))${o}`;case"min":return n==="i32"||n==="u32"?`atomicMin(&${t}, bitcast<${n}>(${r}));`:`${i}min(bitcast<${n}>(oldValue), (${r}))${o}`;case"mul":return`${i}(bitcast<${n}>(oldValue) * (${r}))${o}`;default:throw new Error(`Reduction ${e} is not supported.`)}},W3=(e,t)=>`${e===1?`
    let element_count_dim = uniforms.output_strides;
    let dim_value = uniforms.output_shape;`:`
    let element_count_dim = uniforms.output_strides[${t?"i - indices_start":"i"}];
    let dim_value = uniforms.output_shape[${t?"i - indices_start":"i"} + uniforms.last_index_dimension];`}
    
    if (index >= 0) {
      if (index >= i32(dim_value)) {
        index = i32(dim_value - 1);
      }
    } else {
      if (index < -i32(dim_value)) {
        index = 0;
      } else {
        index += i32(dim_value);
      }
    }
    data_offset += u32((u32(index) * element_count_dim));`,G3=(e,t,r)=>`for (var i = 0u; i < uniforms.num_updates_elements; i++) {
        let value = updates[uniforms.num_updates_elements * ${r?"global_idx":"idx"} + i];
        ${F7(e.reduction,"output[data_offset + i]","value",t)}
      }`,z7=(e,t)=>{let r=e[0].dims,n=e[1].dims,i=r,o=1,s=Math.ceil(br.size(n)/o),a=n[n.length-1],u=br.sizeFromDimension(r,a),d=br.sizeFromDimension(n,0)/a,m=[{type:12,data:s},{type:12,data:a},{type:12,data:u},...Kn(e[1].dims,e[2].dims,i)],g=_=>{let y=kr("indices",e[1].dataType,e[1].dims.length),M=kr("updates",e[2].dataType,e[2].dims.length,o),x=t.reduction!=="none"&&t.reduction!==""?ene("output",e[0].dataType,i.length):Fn("output",e[0].dataType,i.length,o);return`
      ${_.registerUniform("output_size","u32").registerUniform("last_index_dimension","u32").registerUniform("num_updates_elements","u32").declareVariables(y,M,x)}
      ${_.mainStart()}
        ${_.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
  var hasDuplicates = false;
  if (${t.reduction==="none"}) {
    for (var i = 0; i < ${d}; i = i + 1) {
      for (var j = i + 1; j < ${d}; j = j + 1) {
        var index_i = i32(indices[i].x);
        var index_j = i32(indices[j].x);
        if (index_i == index_j) {
          hasDuplicates = true;
          break;
        }
      }
      if (hasDuplicates) {
        break;
      }
    }
  }

  if (${t.reduction==="none"} && hasDuplicates) {
    if (global_idx != 0u) {
      return;
    }
    // Process each index-update pair individually when duplicates exist
    for (var idx = 0u; idx < ${d}u; idx++) {
      var data_offset = 0u;
      for (var i = 0u; i < uniforms.last_index_dimension; i++) {
        var index = i32(indices[idx * uniforms.last_index_dimension + i].x);
        ${W3(r.length,!1)}
      }
      ${G3(t,x.type.value,!1)}
    }
    return;
  }

  var data_offset = 0u;
  var indices_start = uniforms.last_index_dimension * global_idx;
  var indices_end = indices_start + uniforms.last_index_dimension;
  for (var i = indices_start; i < indices_end; i++) {
    var index = i32(indices[i].x);
    ${W3(r.length,!0)}
  }
  ${G3(t,x.type.value,!0)}
  }`};return{name:"ScatterND",shaderCache:{hint:`${t.cacheKey}_${t.reduction}`,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:i,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(s/64)},programUniforms:m}),getShaderSource:g}},Toe=e=>Jo({reduction:e.reduction}),Poe=(e,t)=>{e.compute(z7(e.inputs,t),{inputs:[e.inputs[1],e.inputs[2]],outputs:[]})}}),B7,U7,V7,q3,W7,G7,q7,H7,K7,Z7,X7,Y7,H3,Q7,J7,eW,tW,rW,Eoe,Aoe,QPe=nn(()=>{yi(),ji(),Zs(),Bi(),B7=(e,t)=>{if(e.every(r=>r>0||(()=>{throw new Error("Resize requires scales input values to be positive")})),e.length>0){if(t.mode==="linear"){if(!(e.length===2||e.length===3||e.length===4&&e[0]===1&&e[1]===1||e.length===4&&e[0]===1&&e[3]===1||e.length===5&&e[0]===1&&e[1]===1))throw new Error(`For linear mode, Resize requires scales to be 2D, 3D, 4D with either two outermost or one innermost and
            one outermost scale values equal to 1, or 5D with two outermost scale values equal to 1`)}else if(t.mode==="cubic"&&!(e.length===2||e.length===4&&e[0]===1&&e[1]===1||e.length===4&&e[0]===1&&e[3]===1))throw new Error("Resize requires scales input size to be 2 or 4 for cubic mode")}},U7=(e,t,r)=>{t.every(i=>i>=0&&i<r||(()=>{throw new Error("Resize requires axes input values to be positive and less than rank")}));let n=new Array(r).fill(1);return t.forEach((i,o)=>n[i]=e[o]),n},V7=(e,t,r,n,i,o)=>{let[s,a,u]=r>10?[1,2,3]:[-1,e.length>1?1:-1,-1],d=e[0].dims.length;if(s>0&&e.length>s&&e[s].dims.length>0)e[s].getFloat32Array().forEach(m=>o.push(m));else if(t.coordinateTransformMode==="tf_crop_and_resize")throw new Error("Resize requires RoI input to be specified when coordinateTransformMode is tfCropAndResize");if(a>0&&e.length>a&&e[a].dims.length===1&&e[a].dims[0]>0){if(e[a].getFloat32Array().forEach(m=>n.push(m)),n.length!==0&&n.length!==d&&r>=18&&n.length!==t.axes.length)throw new Error("Resize requires scales input size to be same as input rank or axes size for opset 18 and up");B7(n,t),t.axes.length>0&&U7(n,t.axes,d).forEach((m,g)=>n[g]=m)}if(u>0&&e.length>u&&e[u].dims.length===1&&e[u].dims[0]>0&&(e[u].getBigInt64Array().forEach(m=>i.push(Number(m))),i.length!==0&&i.length!==d&&r>=18&&i.length!==t.axes.length))throw new Error("Resize requires sizes input size to be same as input rank or axes size for opset 18 and up");if(t.axes.length>0){if(n.length!==0&&n.length!==t.axes.length)throw new Error('Resize requires "scales" input size to be of axes rank when axes attributes is specified');if(i.length!==0&&i.length!==t.axes.length)throw new Error('Resize requires "sizes" input size to be of rank axes rank when axes attributes is specified')}if(typeof n<"u"&&typeof i<"u"&&n.length>0&&i.length>d)throw new Error("Resize requires only of scales or sizes to be specified")},q3=(e,t,r,n)=>`
  // The whole part and the fractional part are calculated separately due to inaccuracy of floating
  // point division. As an example, f32(21) / f32(7) may evaluate to 2.99... instead of 3, causing an
  // offset-by-one error later in floor().
  let big = (${e}) * (${t});
  let whole = ${n}(big / (${r}));
  let fract = ${n}(big % (${r})) / ${n}(${r});
  return whole + fract;
`,W7=(e,t)=>`fn getOriginalCoordinateFromResizedCoordinate(xResized: u32, xScale: f32, lengthResized: u32,
     lengthOriginal: u32, roiStart: f32, roiEnd: f32) -> ${t} { `+(()=>{switch(e){case"asymmetric":return`
          if (xScale < 1.0 || floor(xScale) != xScale) {
            return ${t}(xResized) / ${t}(xScale);
          } else {
            ${q3("xResized","lengthOriginal","lengthResized",t)}
          }
        `;case"pytorch_half_pixel":return`if (lengthResized > 1) {
                    return (${t}(xResized) + 0.5) / ${t}(xScale) - 0.5;
                  } else {
                    return 0.0;
                  }`;case"tf_half_pixel_for_nn":return`return (${t}(xResized) + 0.5) / ${t}(xScale);`;case"align_corners":return`if (lengthResized == 1) {
                    return 0.0;
                  } else {
                    ${q3("xResized","lengthOriginal - 1","lengthResized - 1",t)}
                  }`;case"tf_crop_and_resize":return`if (lengthResized > 1) {
                    return ${t}(roiStart) * ${t}(lengthOriginal - 1) +
                        (${t}(xResized) * ${t}(roiEnd - roiStart) * ${t}(lengthOriginal - 1)) /
                        ${t}(lengthResized - 1);
                  } else {
                    return 0.5 * ${t}(roiStart + roiEnd) * ${t}(lengthOriginal - 1);
                  }`;case"half_pixel_symmetric":return`const outputWidth = ${t}xScale * ${t}(lengthResized);
                  const adjustment = ${t}(lengthResized) / outputWidth;
                  const center = ${t}(lengthOriginal) / 2;
                  const offset = center * (1 - adjustment);
                  return offset + ((${t}(xResized) + 0.5) / ${t}(xScale)) - 0.5;`;case"half_pixel":return`return ((${t}(xResized) + 0.5) / ${t}(xScale)) - 0.5;`;default:throw new Error(`Coordinate transform mode ${e} is not supported`)}})()+"}",G7=(e,t,r)=>`fn getNearestPixelFromOriginal(xOriginal: ${r}, isDownSample: bool) -> ${r} {`+(()=>{switch(e){case"round_prefer_ceil":return"if (fract(xOriginal) == 0.5) {             return ceil(xOriginal);           } else {             return round(xOriginal);           }";case"floor":return"return floor(xOriginal);";case"ceil":return"return ceil(xOriginal);";case"round_prefer_floor":return"if (fract(xOriginal) == 0.5) {                     return floor(xOriginal);                   } else {                     return round(xOriginal);                   }";case"simple":default:if(t<11)return"if (isDownSample)                     {                       return ceil(xOriginal);                     } else {                       return xOriginal;                     }";throw new Error(`Nearest mode ${e} is not supported`)}})()+"}",q7=(e,t,r)=>{let n=new Array(r).fill(0).concat(new Array(r).fill(1)),i=e.length===0?n:e.slice();return t.length>0?(t.forEach((o,s)=>{n[o]=i[s],n[s+r]=i[t.length+s]}),n):i},H7=(e,t,r,n)=>{let i=[];if(r.length>0)if(n.length>0){if(e.forEach(o=>i.push(o)),Math.max(...n)>e.length)throw new Error("axes is out of bound");n.forEach((o,s)=>i[o]=r[s])}else r.forEach(o=>i.push(o));else{if(t.length===0)throw new Error("Resize requires either scales or sizes.");i=e.map((o,s)=>Math.round(o*t[s]))}return i},K7=(e,t,r)=>{let n=(()=>{switch(r.keepAspectRatioPolicy){case"not_larger":return r.axes.length>0?Math.min(...r.axes.map(o=>t[o]),Number.MAX_VALUE):Math.min(...t,Number.MAX_VALUE);case"not_smaller":return r.axes.length>0?Math.max(...r.axes.map(o=>t[o]),Number.MIN_VALUE):Math.max(...t,Number.MIN_VALUE);default:throw new Error(`Keep aspect ratio policy ${r.keepAspectRatioPolicy} is not supported`)}})();t.fill(1,0,t.length);let i=e.slice();return r.axes.length>0?(r.axes.forEach(o=>t[o]=n),r.axes.forEach(o=>i[o]=Math.round(e[o]*t[o]))):(t.fill(n,0,t.length),i.forEach((o,s)=>i[s]=Math.round(o*t[s]))),i},Z7=(e,t,r,n,i)=>`
    fn calculateOriginalIndicesFromOutputIndices(output_indices: ${e.type.indices}) -> array<${e.type.value}, ${r.length}> {
      var original_indices: array<${e.type.value}, ${r.length}>;
      for (var i:u32 = 0; i < ${r.length}; i++) {
        var output_index = ${e.indicesGet("output_indices","i")};
        var scale = ${Wn("uniforms.scales","i",n)};
        var roi_low = ${Wn("uniforms.roi","i",i)};
        var roi_hi = ${Wn("uniforms.roi",`i + ${t.length}`,i)};
        if (scale == 1.0) {
          original_indices[i] = ${e.type.value}(output_index);
        } else {
          var input_shape_i = ${Wn("uniforms.input_shape","i",t.length)};
          var output_shape_i = ${Wn("uniforms.output_shape","i",r.length)};
          original_indices[i] = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,
                                                                           input_shape_i, roi_low, roi_hi);
        }
      }
      return original_indices;
    }`,X7=(e,t,r,n,i,o,s)=>`
    fn calculateInputIndicesFromOutputIndices(output_indices: ${t.type.indices}) -> ${e.type.indices} {
      var input_indices: ${e.type.indices};
      for (var i:u32 = 0; i < ${n.length}; i++) {
        var output_index = ${t.indicesGet("output_indices","i")};
        var input_index: u32;
        var scale = ${Wn("uniforms.scales","i",i)};
        if (scale == 1.0) {
          input_index = output_index;
        } else {
          var roi_low = ${Wn("uniforms.roi","i",o)};
          var roi_hi = ${Wn("uniforms.roi",`i + ${r.length}`,o)};
          var input_shape_i = ${Wn("uniforms.input_shape","i",r.length)};
          var output_shape_i = ${Wn("uniforms.output_shape","i",n.length)};
          var original_idx = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,
                                                                        input_shape_i, roi_low, roi_hi);
          if (!${s} || (original_idx >= 0 && original_idx < ${t.type.value}(input_shape_i))) {
            if (original_idx < 0) {
              input_index = 0;
            } else if (original_idx > ${t.type.value}(input_shape_i - 1)) {
              input_index = input_shape_i - 1;
            } else {
              input_index = u32(getNearestPixelFromOriginal(original_idx, scale < 1));
            }
          } else {
            input_index = u32(original_idx);
          }
        }
        ${e.indicesSet("input_indices","i","input_index")}
      }
      return input_indices;
    }`,Y7=(e,t)=>`
    fn checkInputIndices(input_indices: ${e.type.indices}) -> bool {
      for (var i:u32 = 0; i < ${t.length}; i++) {
        var input_index = ${e.indicesGet("input_indices","i")};
        if (input_index < 0 || input_index >= ${Wn("uniforms.input_shape","i",t.length)}) {
          return false;
        }
      }
      return true;
    }`,H3=(e,t,r,n)=>e.rank>n?`
    ${e.indicesSet("input_indices",t,"channel")};
    ${e.indicesSet("input_indices",r,"batch")};
`:"",Q7=(e,t,r,n,i)=>{let[o,s,a,u]=r.length===2?[-1,0,1,-1]:[0,2,3,1],d=e.type.value;return`
    fn getInputValue(batch: u32, channel: u32, row: u32, col: u32) -> ${d} {
      var input_indices: ${e.type.indices};
      ${e.indicesSet("input_indices",s,`max(0, min(row, ${r[s]} - 1))`)};
      ${e.indicesSet("input_indices",a,`max(0, min(col, ${r[a]} - 1))`)};
      ${H3(e,u,o,2)}
      return ${e.getByIndices("input_indices")};
    }

    fn bilinearInterpolation(output_indices: ${t.type.indices}) -> ${d} {
      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);
      var row:${d} = originalIndices[${s}];
      var col:${d} = originalIndices[${a}];
      ${n?`if (row < 0 || row > (${r[s]} - 1) || col < 0 || col > (${r[a]} - 1)) {
        return ${i};
      }`:""};
      row = max(0, min(row, ${r[s]} - 1));
      col = max(0, min(col, ${r[a]} - 1));
      var row1: u32 = u32(row);
      var col1: u32 = u32(col);
      var row2: u32 = u32(row + 1);
      var col2: u32 = u32(col + 1);
      var channel: u32 = ${r.length>2?`u32(originalIndices[${u}])`:"0"};
      var batch: u32 =  ${r.length>2?`u32(originalIndices[${o}])`:"0"};
      var x11: ${d} = getInputValue(batch, channel, row1, col1);
      var x12: ${d} = getInputValue(batch, channel, row1, col2);
      var x21: ${d} = getInputValue(batch, channel, row2, col1);
      var x22: ${d} = getInputValue(batch, channel, row2, col2);
      var dx1: ${d} = abs(row - ${d}(row1));
      var dx2: ${d} = abs(${d}(row2) - row);
      var dy1: ${d} = abs(col - ${d}(col1));
      var dy2: ${d} = abs(${d}(col2) - col);
      if (row1 == row2) {
        dx1 = 0.5;
        dx2 = 0.5;
      }
      if (col1 == col2) {
        dy1 = 0.5;
        dy2 = 0.5;
      }
      return (x11 * dx2 * dy2 + x12 * dx2 * dy1 + x21 * dx1 * dy2 + x22 * dx1 * dy1);
    }`},J7=(e,t,r,n,i,o,s,a,u,d)=>{let m=r.length===2,[g,_]=m?[0,1]:[2,3],y=e.type.value,M=x=>{let E=x===g?"row":"col";return`
      fn ${E}CubicInterpolation(input_indices: ${e.type.indices}, output_indices: ${t.type.indices}) -> ${y} {
        var output_index = ${t.indicesGet("output_indices",x)};
        var originalIdx: ${y} = getOriginalCoordinateFromResizedCoordinate(output_index, ${i[x]},
        ${n[x]}, ${r[x]}, ${o[x]}, ${o[x]} + ${r.length});
        var fractOriginalIdx: ${y} = originalIdx - floor(originalIdx);
        var coefs = getCubicInterpolationCoefs(fractOriginalIdx);

        if (${a} && (originalIdx < 0 || originalIdx > (${r[x]} - 1))) {
          return ${u};
        }
        var data: array<${y}, 4> = array<${y}, 4>(0.0, 0.0, 0.0, 0.0);
        for (var i: i32 = -1; i < 3; i++) {
          var ${E}: ${y} = originalIdx + ${y}(i);
          if (${E} < 0 || ${E} >= ${r[x]}) {
            ${d?`coefs[i + 1] = 0.0;
                        continue;`:a?`return ${u};`:`${E} = max(0, min(${E}, ${r[x]} - 1));`};
          }
        var input_indices_copy: ${e.type.indices} = input_indices;
          ${e.indicesSet("input_indices_copy",x,`u32(${E})`)};
          data[i + 1] = ${x===g?e.getByIndices("input_indices_copy"):"rowCubicInterpolation(input_indices_copy, output_indices)"};
        }
        return cubicInterpolation1D(data, coefs);
      }`};return`
    ${M(g)};
    ${M(_)};
  fn getCubicInterpolationCoefs(s: ${y}) -> array<${y}, 4> {
    var absS = abs(s);
    var coeffs: array<${y}, 4> = array<${y}, 4>(0.0, 0.0, 0.0, 0.0);
    var oneMinusAbsS: ${y} = 1.0 - absS;
    var twoMinusAbsS: ${y} = 2.0 - absS;
    var onePlusAbsS: ${y} = 1.0 + absS;
    coeffs[0] = ((${s} * onePlusAbsS - 5 * ${s}) * onePlusAbsS + 8 * ${s}) * onePlusAbsS - 4 * ${s};
    coeffs[1] = ((${s} + 2) * absS - (${s} + 3)) * absS * absS + 1;
    coeffs[2] = ((${s} + 2) * oneMinusAbsS - (${s} + 3)) * oneMinusAbsS * oneMinusAbsS + 1;
    coeffs[3] = ((${s} * twoMinusAbsS - 5 * ${s}) * twoMinusAbsS + 8 * ${s}) * twoMinusAbsS - 4 * ${s};
    return coeffs;
  }

  fn cubicInterpolation1D(x: array<${y}, 4>, coefs: array<${y}, 4>) -> ${y} {
    var coefsSum: ${y} = coefs[0] + coefs[1] + coefs[2] + coefs[3];
    return (x[0] * coefs[0] + x[1] * coefs[1]+ x[2] * coefs[2]+ x[3] * coefs[3]) / coefsSum;
  }

  fn bicubicInterpolation(output_indices: ${t.type.indices}) -> ${y} {
    var input_indices: ${e.type.indices} = output_indices;
    return colCubicInterpolation(input_indices, output_indices);
  }
    `},eW=(e,t,r,n,i)=>{let[o,s,a,u,d]=r.length===3?[-1,0,1,2,-1]:[0,2,3,4,1],m=e.type.value;return`
    fn getInputValue(batch: u32, channel: u32, depth:u32, height: u32, width: u32) -> ${m} {
      var input_indices: ${e.type.indices};
      ${e.indicesSet("input_indices",s,`max(0, min(depth, ${r[s]} - 1))`)};
      ${e.indicesSet("input_indices",a,`max(0, min(height, ${r[a]} - 1))`)};
      ${e.indicesSet("input_indices",u,`max(0, min(width, ${r[u]} - 1))`)};
      ${H3(e,d,o,3)}
      return ${e.getByIndices("input_indices")};
    }

    fn trilinearInterpolation(output_indices: ${t.type.indices}) -> ${m} {
      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);
      var depth:${m} = originalIndices[${s}];
      var height:${m} = originalIndices[${a}];
      var width:${m} = originalIndices[${u}];
      ${n?`if (depth < 0 || depth > (${r[s]} - 1) || height < 0 || height > (${r[a]} - 1) || width < 0 || (width > ${r[u]} - 1)) {
      return ${i};
        }`:""};

    depth = max(0, min(depth, ${r[s]} - 1));
      height = max(0, min(height, ${r[a]} - 1));
      width = max(0, min(width, ${r[u]} - 1));
      var depth1: u32 = u32(depth);
      var height1: u32 = u32(height);
      var width1: u32 = u32(width);
      var depth2: u32 = u32(depth + 1);
      var height2: u32 = u32(height + 1);
      var width2: u32 = u32(width + 1);
      var channel: u32 = ${r.length>3?`u32(originalIndices[${d}])`:"0"};
      var batch: u32 =  ${r.length>3?`u32(originalIndices[${o}])`:"0"};

      var x111: ${m} = getInputValue(batch, channel, depth1, height1, width1);
      var x112: ${m} = getInputValue(batch, channel, depth1, height1, width2);
      var x121: ${m} = getInputValue(batch, channel, depth1, height2, width1);
      var x122: ${m} = getInputValue(batch, channel, depth1, height2, width2);
      var x211: ${m} = getInputValue(batch, channel, depth2, height1, width1);
      var x212: ${m} = getInputValue(batch, channel, depth2, height1, width2);
      var x221: ${m} = getInputValue(batch, channel, depth2, height2, width1);
      var x222: ${m} = getInputValue(batch, channel, depth2, height2, width2);
      var dx1: ${m} = abs(depth - ${m}(depth1));
      var dx2: ${m} = abs(${m}(depth2) - depth);
      var dy1: ${m} = abs(height - ${m}(height1));
      var dy2: ${m} = abs(${m}(height2) - height);
      var dz1: ${m} = abs(width - ${m}(width1));
      var dz2: ${m} = abs(${m}(width2) - width);
      if (depth1 == depth2) {
        dx1 = 0.5;
        dx2 = 0.5;
      }
      if (height1 == height2) {
        dy1 = 0.5;
        dy2 = 0.5;
      }
      if (width1 == width2) {
        dz1 = 0.5;
        dz2 = 0.5;
      }
      return (x111 * dx2 * dy2 * dz2 + x112 * dx2 * dy2 * dz1 + x121 * dx2 * dy1 *dz2 + x122 * dx2 * dy1 * dz1 +
              x211 * dx1 * dy2 * dz2 + x212 * dx1 * dy2 * dz1 + x221 * dx1 * dy1 *dz2 + x222 * dx1 * dy1 * dz1);
    }`},tW=(e,t,r,n,i,o)=>{let s=e.dims,a=q7(o,t.axes,s.length),u=H7(s,n,i,t.axes),d=n.slice();n.length===0&&(d=s.map((P,C)=>P===0?1:u[C]/P),t.keepAspectRatioPolicy!=="stretch"&&(u=K7(s,d,t)));let m=Fn("output",e.dataType,u.length),g=kr("input",e.dataType,s.length),_=br.size(u),y=s.length===u.length&&s.every((P,C)=>P===u[C]),M=t.coordinateTransformMode==="tf_crop_and_resize",x=t.extrapolationValue,E=g.type.value,T=P=>`
      ${y?"":`
      ${W7(t.coordinateTransformMode,E)};
      ${(()=>{switch(t.mode){case"nearest":return`
              ${Y7(g,s)};
              ${G7(t.nearestMode,r,E)};
              ${X7(g,m,s,u,d.length,a.length,M)};
              `;case"linear":return`
              ${Z7(m,s,u,d.length,a.length)};
              ${(()=>{if(s.length===2||s.length===4)return`${Q7(g,m,s,M,x)}`;if(s.length===3||s.length===5)return`${eW(g,m,s,M,x)}`;throw Error("Linear mode only supports input dims 2, 3, 4 and 5 are supported in linear mode.")})()};
            `;case"cubic":return`
            ${(()=>{if(s.length===2||s.length===4)return`${J7(g,m,s,u,d,a,t.cubicCoeffA,M,t.extrapolationValue,t.excludeOutside)}`;throw Error("Cubic mode only supports input dims 2 and 4 are supported in linear mode.")})()};
            `;default:throw Error("Invalid resize mode")}})()};
      `}
      ${P.registerUniform("output_size","u32").registerUniform("scales","f32",d.length).registerUniform("roi","f32",a.length).declareVariables(g,m)}
      ${P.mainStart()}
        ${P.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
        ${y?"output[global_idx] = input[global_idx];":`
        let output_indices = ${m.offsetToIndices("global_idx")};
        var input_indices: ${g.type.indices};
        ${(()=>{switch(t.mode){case"nearest":return`input_indices = calculateInputIndicesFromOutputIndices(output_indices);
                if (checkInputIndices(input_indices)) {
                  output[global_idx] = ${g.getByIndices("input_indices")};
                } else {
                  output[global_idx] = ${t.extrapolationValue};
                }`;case"linear":return`output[global_idx] = ${s.length===2||s.length===4?"bilinearInterpolation":"trilinearInterpolation"}(output_indices);`;case"cubic":return"output[global_idx] = bicubicInterpolation(output_indices);";default:throw Error(`Unsupported resize mode: ${t.mode}`)}})()};
`}
      }`;return{name:"Resize",shaderCache:{hint:`${t.cacheKey}|${r}|${d.length>0?t.mode==="cubic"?d:d.length:""}|${i.length>0?i:""}|${a.length>0?a:""}|${y}|${t.mode==="nearest"?s.length:s}`,inputDependencies:["rank"]},getShaderSource:T,getRunData:()=>({outputs:[{dims:u,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(_/64)},programUniforms:[{type:12,data:_},{type:1,data:d},{type:1,data:a},...Kn(s,u)]})}},rW=e=>{let t=e.customDataBuffer;return new Uint32Array(t,t.byteOffset,1)[0]},Eoe=(e,t)=>{let r=[],n=[],i=[],o=rW(e);if(t.antialias!==0)throw Error("Only default value (0) for Antialias attribute is supported");V7(e.inputs,t,o,r,n,i),e.compute(tW(e.inputs[0],t,o,r,n,i),{inputs:[0]})},Aoe=e=>{let t=e.antialias,r=e.axes,n=e.coordinateTransformMode,i=e.cubicCoeffA,o=e.excludeOutside!==0,s=e.extrapolationValue,a=e.keepAspectRatioPolicy,u=e.mode,d=e.nearestMode===""?"simple":e.nearestMode;return Jo({antialias:t,axes:r,coordinateTransformMode:n,cubicCoeffA:i,excludeOutside:o,extrapolationValue:s,keepAspectRatioPolicy:a,mode:u,nearestMode:d})}}),nW,iW,Coe,JPe=nn(()=>{yi(),ji(),Bi(),nW=e=>{if(!e||e.length<3)throw new Error("layerNorm requires at least 3 inputs.");let t=e[0],r=e[1],n=e[2];if(t.dataType!==r.dataType||t.dataType!==n.dataType)throw new Error("All inputs must have the same data type");if(t.dims.length!==3&&t.dims.length!==2)throw new Error("Input must be 2D or 3D");if(r.dims.length!==3&&r.dims.length!==2)throw new Error("Skip must be 2D or 3D");let i=t.dims[t.dims.length-1],o=t.dims[t.dims.length-2];if(r.dims[r.dims.length-1]!==i)throw new Error("Skip must have the same hidden size as input");if(r.dims[r.dims.length-2]!==o)throw new Error("Skip must have the same sequence length as input");if(n.dims.length!==1)throw new Error("Gamma must be 1D");if(n.dims[n.dims.length-1]!==i)throw new Error("Gamma must have the same hidden size as input");if(e.length>3){let s=e[3];if(s.dims.length!==1)throw new Error("Beta must be 1D");if(s.dims[s.dims.length-1]!==i)throw new Error("Beta must have the same hidden size as input")}if(e.length>4){let s=e[4];if(s.dims.length!==1)throw new Error("Bias must be 1D");if(s.dims[s.dims.length-1]!==i)throw new Error("Bias must have the same hidden size as input")}},iW=(e,t,r,n)=>{let i=t.simplified,o=e[0].dims,s=br.size(o),a=o,u=s,d=o.slice(-1)[0],m=n?o.slice(0,-1).concat(1):[],g=!i&&e.length>3,_=e.length>4,y=n&&r>1,M=n&&r>2,x=r>3,E=64,T=Os(d),P=[{type:12,data:u},{type:12,data:T},{type:12,data:d},{type:1,data:t.epsilon}],C=L=>{let N=[{name:"output_size",type:"u32"},{name:"components",type:"u32"},{name:"hidden_size",type:"u32"},{name:"epsilon",type:"f32"}],j=[kr("x",e[0].dataType,e[0].dims,T),kr("skip",e[1].dataType,e[1].dims,T),kr("gamma",e[2].dataType,e[2].dims,T)];g&&j.push(kr("beta",e[3].dataType,e[3].dims,T)),_&&j.push(kr("bias",e[4].dataType,e[4].dims,T)),j.push(Fn("output",e[0].dataType,a,T)),y&&j.push(Fn("mean_output",1,m)),M&&j.push(Fn("inv_std_output",1,m)),x&&j.push(Fn("input_skip_bias_sum",e[0].dataType,a,T));let $=mc(e[0].dataType),U=mc(1,T);return`

      ${L.registerUniforms(N).declareVariables(...j)}
      var<workgroup> sum_shared : array<${U}, ${E}>;
      var<workgroup> sum_squared_shared : array<${U}, ${E}>;

      ${L.mainStart([E,1,1])}
        let ix = local_id.x;
        let iy = global_id.x / ${E};

        let hidden_size_vectorized: u32 = uniforms.hidden_size / uniforms.components;
        var stride = hidden_size_vectorized / ${E};
        let offset = ix * stride + iy * hidden_size_vectorized;
        let offset1d = stride * ix;
        if (ix == ${E-1}) {
          stride = hidden_size_vectorized - stride * ix;
        }
        for (var i: u32 = 0; i < stride; i++) {
          let skip_value = skip[offset + i];
          let bias_value = ${_?"bias[offset1d + i]":$+"(0.0)"};
          let input_value = x[offset + i];
          let value = input_value + skip_value + bias_value;
          ${x?"input_skip_bias_sum[offset + i] = value;":""}
          output[offset + i] = value;
          let f32_value = ${i1($,T,"value")};
          sum_shared[ix] += f32_value;
          sum_squared_shared[ix] += f32_value * f32_value;
        }
        workgroupBarrier();

        var reduce_size : u32 = ${E};
        for (var curr_size = reduce_size >> 1;  curr_size > 0; curr_size = reduce_size >> 1) {
          reduce_size = curr_size + (reduce_size & 1);
          if (ix < curr_size) {
            sum_shared[ix] += sum_shared[ix + reduce_size];
            sum_squared_shared[ix] += sum_squared_shared[ix + reduce_size];
          }
          workgroupBarrier();
        }

        let sum = sum_shared[0];
        let square_sum = sum_squared_shared[0];
        let mean = ${E_("sum",T)} / f32(uniforms.hidden_size);
        let inv_std_dev = inverseSqrt(${E_("square_sum",T)} / f32(uniforms.hidden_size) ${i?"":"- mean * mean"} + uniforms.epsilon);
        ${y?"mean_output[global_idx] = mean;":""}
        ${M?"inv_std_output[global_idx] = inv_std_dev;":""}

        for (var i: u32 = 0; i < stride; i++) {
          output[offset + i] = (output[offset + i] ${i?"":`- ${$}(mean)`}) *
            ${$}(inv_std_dev) * gamma[offset1d + i]
            ${g?"+ beta[offset1d + i]":""};
        }
      }`},D=[{dims:a,dataType:e[0].dataType}];return r>1&&D.push({dims:m,dataType:1}),r>2&&D.push({dims:m,dataType:1}),r>3&&D.push({dims:o,dataType:e[0].dataType}),{name:"SkipLayerNormalization",shaderCache:{hint:`${T};${y};${M};${x}`,inputDependencies:e.map((L,N)=>"type")},getShaderSource:C,getRunData:()=>({outputs:D,dispatchGroup:{x:Math.ceil(u/d)},programUniforms:P})}},Coe=(e,t)=>{nW(e.inputs);let r=[0];e.outputCount>1&&r.push(-3),e.outputCount>2&&r.push(-3),e.outputCount>3&&r.push(3),e.compute(iW(e.inputs,t,e.outputCount,!1),{outputs:r})}}),oW,Sw,aW,K3,sW,lW,koe,Ioe,eEe=nn(()=>{yi(),ji(),Zs(),Bi(),oW=(e,t)=>{if(!e||e.length<1)throw new Error("too few inputs");if(t.axes.length!==0){if(t.axes.length!==t.starts.length||t.axes.length!==t.ends.length)throw new Error("axes, starts and ends must have the same length")}else if(t.starts.length!==t.ends.length)throw new Error("starts and ends must have the same length");e.slice(1).forEach((r,n)=>{if(e[n+1].dataType!==6&&e[n+1].dataType!==7)throw new Error(`Input ${n} must be an array of int32 or int64`)})},Sw=(e,t)=>{let r=[];if(e.length>t)if(e[t].dataType===7)e[t].getBigInt64Array().forEach(n=>r.push(Number(n)));else if(e[t].dataType===6)e[t].getInt32Array().forEach(n=>r.push(Number(n)));else throw new Error(`Input ${t} must be an array of int32 or int64`);return r},aW=(e,t)=>{if(e.length>1){let r=Sw(e,1),n=Sw(e,2),i=Sw(e,3);return i.length===0&&(i=[...Array(e[0].dims.length).keys()]),Jo({starts:r,ends:n,axes:i})}else return t},K3=(e,t,r,n,i)=>{let o=e;return e<0&&(o+=r[n[t]]),i[t]<0?Math.max(0,Math.min(o,r[n[t]]-1)):Math.max(0,Math.min(o,r[n[t]]))},sW=(e,t,r)=>`fn calculateInputIndices(output_indices: ${t.type.indices}) -> ${e.type.indices} {
          var input_indices: ${e.type.indices};
          var carry = 0u;
          for (var i = ${r.length}; i >= 0; i--) {
            let input_shape_i = ${Wn("uniforms.input_shape","i",r.length)};
            let steps_i = ${Wn("uniforms.steps","i",r.length)};
            let signs_i = ${Wn("uniforms.signs","i",r.length)};
            let starts_i = ${Wn("uniforms.starts","i",r.length)};
            var output_index = ${t.indicesGet("output_indices","i")};
            var input_index = output_index * steps_i + starts_i + carry;
            carry = input_index / input_shape_i;
            input_index = input_index % input_shape_i;
            if (signs_i < 0) {
              input_index = input_shape_i - input_index - 1u + starts_i;
            }
            ${e.indicesSet("input_indices","i","input_index")};
          }
          return input_indices;
      }`,lW=(e,t)=>{let r=e[0].dims,n=br.size(r),i=t.axes.length>0?br.normalizeAxes(t.axes,r.length):[...Array(r.length).keys()],o=Sw(e,4);o.forEach(T=>T!==0||(()=>{throw new Error("step cannot be 0")})),o.length===0&&(o=Array(i.length).fill(1));let s=t.starts.map((T,P)=>K3(T,P,r,i,o)),a=t.ends.map((T,P)=>K3(T,P,r,i,o));if(i.length!==s.length||i.length!==a.length)throw new Error("start, ends and axes should have the same number of elements");if(i.length!==r.length)for(let T=0;T<r.length;++T)i.includes(T)||(s.splice(T,0,0),a.splice(T,0,r[T]),o.splice(T,0,1));let u=o.map(T=>Math.sign(T));o.forEach((T,P,C)=>{if(T<0){let D=(a[P]-s[P])/T,L=s[P],N=L+D*o[P];s[P]=N,a[P]=L,C[P]=-T}});let d=r.slice(0);i.forEach((T,P)=>{d[T]=Math.ceil((a[T]-s[T])/o[T])});let m={dims:d,dataType:e[0].dataType},g=Fn("output",e[0].dataType,d.length),_=kr("input",e[0].dataType,e[0].dims.length),y=br.size(d),M=[{name:"outputSize",type:"u32"},{name:"starts",type:"u32",length:s.length},{name:"signs",type:"i32",length:u.length},{name:"steps",type:"u32",length:o.length}],x=[{type:12,data:y},{type:12,data:s},{type:6,data:u},{type:12,data:o},...Kn(e[0].dims,d)],E=T=>`
      ${T.registerUniforms(M).declareVariables(_,g)}
        ${sW(_,g,r)}
        ${T.mainStart()}
          ${T.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
          let output_indices = ${g.offsetToIndices("global_idx")};
          let input_indices = calculateInputIndices(output_indices);
          ${g.setByOffset("global_idx",_.getByIndices("input_indices"))}
      }`;return{name:"Slice",shaderCache:{hint:`${u.length}_${s.length}_${o.length}`,inputDependencies:["rank"]},getShaderSource:E,getRunData:()=>({outputs:[m],dispatchGroup:{x:Math.ceil(n/64)},programUniforms:x})}},koe=(e,t)=>{oW(e.inputs,t);let r=aW(e.inputs,t);e.compute(lW(e.inputs,r),{inputs:[0]})},Ioe=e=>{let t=e.starts,r=e.ends,n=e.axes;return Jo({starts:t,ends:r,axes:n})}}),cW,uW,Ooe,Loe,tEe=nn(()=>{yi(),ji(),Zs(),N_(),Bi(),cW=e=>{if(!e||e.length!==1)throw new Error("Softmax op requires 1 input.")},uW=(e,t)=>{let r=e.inputs[0],n=r.dims,i=br.size(n),o=n.length,s=br.normalizeAxis(t.axis,o),a=s<n.length-1,u,d=[];a?(d=Array.from({length:o},(j,$)=>$),d[s]=o-1,d[o-1]=s,u=e.compute(Jd(r,d),{inputs:[r],outputs:[-1]})[0]):u=r;let m=u.dims,g=m[o-1],_=i/g,y=Os(g),M=g/y,x=64;_===1&&(x=256);let E=(j,$)=>$===4?`max(max(${j}.x, ${j}.y), max(${j}.z, ${j}.w))`:$===2?`max(${j}.x, ${j}.y)`:$===3?`max(max(${j}.x, ${j}.y), ${j}.z)`:j,T=kr("x",u.dataType,u.dims,y),P=Fn("result",u.dataType,u.dims,y),C=T.type.value,D=mc(u.dataType)==="f32"?`var threadMax = ${C}(-3.402823e+38f);`:`var threadMax = ${C}(-65504.0h);`,L=j=>`
      var<workgroup> rowMaxShared : ${C};
      var<workgroup> rowSumShared : ${C};
      var<workgroup> threadShared : array<${C}, ${x}>;

      fn getValue(row: i32, col: i32, row_stride: i32) -> ${C} {
        let index = row * row_stride + col;
        return x[index];
      }

      fn setValue(row: i32, col: i32, row_stride: i32, value: ${C}) {
        let index = row * row_stride + col;
        result[index] = value;
      }
      ${j.registerUniform("packedCols","i32").declareVariables(T,P)}
      ${j.mainStart(x)}
        let gindex = i32(global_idx);
        let lindex = i32(local_idx);
        const wg = ${x};
        let row = gindex / wg;
        let cols = uniforms.packedCols;
        let row_stride : i32 = uniforms.packedCols;

        // find the rows max
        ${D}
        for (var col = lindex; col < cols; col += wg) {
          let value = getValue(row, col, row_stride);
          threadMax = max(threadMax, value);
        }
        if (lindex < cols) {
          threadShared[lindex] = threadMax;
        }
        workgroupBarrier();

        var reduceSize = min(cols, wg);
        for (var currSize = reduceSize >> 1;  currSize > 0; currSize = reduceSize >> 1) {
          reduceSize = currSize + (reduceSize & 1);
          if (lindex < currSize) {
            threadShared[lindex] = max(threadShared[lindex], threadShared[lindex + reduceSize]);
          }
          workgroupBarrier();
        }
        if (lindex == 0) {
          rowMaxShared = ${C}(${E("threadShared[0]",y)});
        }
        workgroupBarrier();

        // find the rows sum
        var threadSum = ${C}(0.0);
        for (var col = lindex; col < cols; col += wg) {
          let subExp = exp(getValue(row, col, row_stride) - rowMaxShared);
          threadSum += subExp;
        }
        threadShared[lindex] = threadSum;
        workgroupBarrier();

        for (var currSize = wg >> 1;  currSize > 0; currSize = currSize >> 1) {
          if (lindex < currSize) {
            threadShared[lindex] = threadShared[lindex] + threadShared[lindex + currSize];
          }
          workgroupBarrier();
        }
        if (lindex == 0) {
          rowSumShared = ${C}(${E_("threadShared[0]",y)});
        }
        workgroupBarrier();

        // calculate final value for each element in the row
        for (var col = lindex; col < cols; col += wg) {
          let value = exp(getValue(row, col, row_stride) - rowMaxShared) / rowSumShared;
          setValue(row, col, row_stride, value);
        }
      }`,N=e.compute({name:"Softmax",shaderCache:{hint:`${y};${x}`,inputDependencies:["type"]},getRunData:()=>({outputs:[{dims:m,dataType:u.dataType}],dispatchGroup:{x:_},programUniforms:[{type:6,data:M}]}),getShaderSource:L},{inputs:[u],outputs:[a?-1:0]})[0];a&&e.compute(Jd(N,d),{inputs:[N]})},Ooe=(e,t)=>{cW(e.inputs),uW(e,t)},Loe=e=>Jo({axis:e.axis})}),Z3,dW,hW,fW,Doe,rEe=nn(()=>{yi(),ji(),Bi(),Z3=e=>Array.from(e.getBigInt64Array(),Number),dW=e=>{if(!e||e.length!==2)throw new Error("Tile requires 2 inputs.");if(e[0].dataType!==1&&e[0].dataType!==10&&e[0].dataType!==6&&e[0].dataType!==12)throw new Error("Tile only support float, float16, int32, and uint32 data types");if(e[1].dataType!==7)throw new Error("Tile `repeats` input should be of int64 data type");if(e[1].dims.length!==1)throw new Error("Tile `repeats` input should be 1-D");if(Z3(e[1]).length!==e[0].dims.length)throw new Error("Tile `repeats` input should have same number of elements as rank of input data tensor")},hW=(e,t)=>{let r=[];for(let n=0;n<e.length;++n)r.push(e[n]*t[n]);return r},fW=(e,t)=>{let r=e[0].dims,n=t??Z3(e[1]),i=hW(r,n),o=br.size(i),s=e[0].dataType,a=kr("input",s,r.length),u=Fn("output",s,i.length),d=m=>`
      const inputShape = ${a.indices(...r)};
      ${m.registerUniform("output_size","u32").declareVariables(a,u)}
      ${m.mainStart()}
      ${m.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let output_indices = ${u.offsetToIndices("global_idx")};
      var input_indices: ${a.type.indices};
      for (var i = 0; i < ${r.length}; i++) {
        let input_dim_i = ${a.indicesGet("uniforms.input_shape","i")};
        let input_dim_value = ${u.indicesGet("output_indices","i")}  % input_dim_i;

        ${a.indicesSet("input_indices","i","input_dim_value")}
      }
      ${u.setByOffset("global_idx",a.getByIndices("input_indices"))}
    }`;return{name:"Tile",shaderCache:{hint:`${n}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:i,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(o/64)},programUniforms:[{type:12,data:o},...Kn(e[0].dims,i)]}),getShaderSource:d}},Doe=e=>{dW(e.inputs),e.compute(fW(e.inputs),{inputs:[0]})}}),pW,mW,$oe,nEe=nn(()=>{yi(),ji(),Bi(),pW=(e,t,r,n,i)=>{let o=Fn("output_data",i,r.length,4),s=kr("a_data",t[1].dataType,t[1].dims.length,4),a=kr("b_data",t[2].dataType,t[2].dims.length,4),u=kr("c_data",t[0].dataType,t[0].dims.length,4),d,m=(g,_,y)=>`select(${_}, ${g}, ${y})`;if(!n)d=o.setByOffset("global_idx",m(s.getByOffset("global_idx"),a.getByOffset("global_idx"),u.getByOffset("global_idx")));else{let g=(_,y,M="")=>{let x=`a_data[index_a${y}][component_a${y}]`,E=`b_data[index_b${y}][component_b${y}]`,T=`bool(c_data[index_c${y}] & (0xffu << (component_c${y} * 8)))`;return`
            let output_indices${y} = ${o.offsetToIndices(`global_idx * 4u + ${y}u`)};
            let offset_a${y} = ${s.broadcastedIndicesToOffset(`output_indices${y}`,o)};
            let offset_b${y} = ${a.broadcastedIndicesToOffset(`output_indices${y}`,o)};
            let offset_c${y} = ${u.broadcastedIndicesToOffset(`output_indices${y}`,o)};
            let index_a${y} = offset_a${y} / 4u;
            let index_b${y} = offset_b${y} / 4u;
            let index_c${y} = offset_c${y} / 4u;
            let component_a${y} = offset_a${y} % 4u;
            let component_b${y} = offset_b${y} % 4u;
            let component_c${y} = offset_c${y} % 4u;
            ${_}[${y}] = ${M}(${m(x,E,T)});
          `};i===9?d=`
            var data = vec4<u32>(0);
            ${g("data",0,"u32")}
            ${g("data",1,"u32")}
            ${g("data",2,"u32")}
            ${g("data",3,"u32")}
            output_data[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:d=`
            ${g("output_data[global_idx]",0)}
            ${g("output_data[global_idx]",1)}
            ${g("output_data[global_idx]",2)}
            ${g("output_data[global_idx]",3)}
          `}return`
        ${e.registerUniform("vec_size","u32").declareVariables(u,s,a,o)}
        ${e.mainStart()}
        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
        ${d}
      }`},mW=e=>{let t=e[1].dims,r=e[2].dims,n=e[0].dims,i=e[1].dataType,o=!(br.areEqual(t,r)&&br.areEqual(r,n)),s=t,a=br.size(t);if(o){let d=Y1.calcShape(Y1.calcShape(t,r,!1),n,!1);if(!d)throw new Error("Can't perform where op on the given tensors");s=d,a=br.size(s)}let u=Math.ceil(a/4);return{name:"Where",shaderCache:{inputDependencies:["rank","rank","rank"]},getShaderSource:d=>pW(d,e,s,o,i),getRunData:()=>({outputs:[{dims:s,dataType:i}],dispatchGroup:{x:Math.ceil(a/64/4)},programUniforms:[{type:12,data:u},...Kn(n,t,r,s)]})}},$oe=e=>{e.compute(mW(e.inputs))}}),Noe,iEe=nn(()=>{yPe(),ER(),vPe(),bPe(),xPe(),wPe(),MPe(),APe(),kPe(),IPe(),OPe(),LPe(),DPe(),$Pe(),NPe(),jPe(),RPe(),FPe(),zPe(),BPe(),UPe(),VPe(),WPe(),GPe(),qPe(),toe(),HPe(),KPe(),ZPe(),XPe(),YPe(),PR(),QPe(),aoe(),JPe(),eEe(),tEe(),ioe(),rEe(),N_(),AR(),nEe(),Noe=new Map([["Abs",[Cne]],["Acos",[kne]],["Acosh",[Ine]],["Add",[die]],["ArgMax",[Tne,GD]],["ArgMin",[Sne,GD]],["Asin",[One]],["Asinh",[Lne]],["Atan",[Dne]],["Atanh",[$ne]],["Attention",[Pne]],["AveragePool",[moe,poe]],["BatchNormalization",[Ene]],["BiasAdd",[Ane]],["BiasSplitGelu",[uie]],["Cast",[jne,Nne]],["Ceil",[Fne]],["Clip",[Rne]],["Concat",[xie,wie]],["Conv",[YD,XD]],["ConvTranspose",[Oie,Iie]],["Cos",[zne]],["Cosh",[Bne]],["CumSum",[Lie,Die]],["DepthToSpace",[$ie,Nie]],["DequantizeLinear",[woe,Moe]],["Div",[hie]],["Einsum",[jie,Rie]],["Elu",[Une,Zw]],["Equal",[fie]],["Erf",[Vne]],["Exp",[Wne]],["Expand",[Fie]],["FastGelu",[zie]],["Floor",[Gne]],["FusedConv",[YD,XD]],["Gather",[Uie,Bie]],["GatherElements",[Kie,Hie]],["GatherBlockQuantized",[Gie,qie]],["GatherND",[Vie,Wie]],["Gelu",[qne]],["Gemm",[Xie,Zie]],["GlobalAveragePool",[_oe,goe]],["GlobalMaxPool",[xoe,boe]],["Greater",[_ie]],["GreaterOrEqual",[vie]],["GridSample",[Yie,Qie]],["GroupQueryAttention",[soe]],["HardSigmoid",[eie,Jne]],["InstanceNormalization",[loe]],["LayerNormalization",[coe]],["LeakyRelu",[Hne,Zw]],["Less",[yie]],["LessOrEqual",[bie]],["Log",[lie]],["MatMul",[uoe]],["MatMulNBits",[doe,hoe]],["MaxPool",[yoe,voe]],["Mul",[pie]],["MultiHeadAttention",[eoe,Jie]],["Neg",[Zne]],["Not",[Kne]],["Pad",[foe]],["Pow",[mie]],["QuickGelu",[cie,Zw]],["Range",[Soe]],["Reciprocal",[Xne]],["ReduceMin",[vne]],["ReduceMean",[pne]],["ReduceMax",[yne]],["ReduceSum",[xne]],["ReduceProd",[bne]],["ReduceL1",[mne]],["ReduceL2",[gne]],["ReduceLogSum",[Mne]],["ReduceLogSumExp",[_ne]],["ReduceSumSquare",[wne]],["Relu",[Yne]],["Resize",[Eoe,Aoe]],["RotaryEmbedding",[ooe]],["ScatterND",[Poe,Toe]],["Sigmoid",[Qne]],["Sin",[tie]],["Sinh",[rie]],["Slice",[koe,Ioe]],["SkipLayerNormalization",[Coe]],["Split",[roe,noe]],["Sqrt",[nie]],["Softmax",[Ooe,Loe]],["Sub",[gie]],["Tan",[iie]],["Tanh",[oie]],["ThresholdedRelu",[sie,Zw]],["Tile",[Doe]],["Transpose",[rne,nne]],["Where",[$oe]]])}),joe,oEe=nn(()=>{Kf(),eg(),Bi(),joe=class{constructor(e){this.backend=e,this.repo=new Map,this.attributesBound=!1}getArtifact(e){return this.repo.get(e)}setArtifact(e,t){this.repo.set(e,t)}run(e,t,r,n,i){Wf(e.programInfo.name);let o=this.backend.device,s=this.backend.getComputePassEncoder();this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2);let a=[];for(let d of t)a.push({binding:a.length,resource:{buffer:d.buffer}});for(let d of r)a.push({binding:a.length,resource:{buffer:d.buffer}});i&&a.push({binding:a.length,resource:i});let u=o.createBindGroup({layout:e.computePipeline.getBindGroupLayout(0),entries:a,label:e.programInfo.name});if(this.backend.sessionStatus==="capturing"){let d={kernelId:this.backend.currentKernelId,computePipeline:e.computePipeline,bindGroup:u,dispatchGroup:n};this.backend.capturedCommandList.get(this.backend.currentSessionId).push(d)}s.setPipeline(e.computePipeline),s.setBindGroup(0,u),s.dispatchWorkgroups(...n),this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2+1),this.backend.pendingDispatchNumber++,(this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber||this.backend.queryType==="at-passes")&&this.backend.endComputePass(),this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber&&this.backend.flush(),$h(e.programInfo.name)}dispose(){}build(e,t){Wf(e.name);let r=this.backend.device,n=[];[{feature:"shader-f16",extension:"f16"},{feature:"subgroups",extension:"subgroups"}].forEach(d=>{r.features.has(d.feature)&&n.push(`enable ${d.extension};`)});let i=tne(t,this.backend.device.limits),o=e.getShaderSource(i),s=`${n.join(`
`)}
${i.additionalImplementations}
${o}`,a=r.createShaderModule({code:s,label:e.name});Do("verbose",()=>`[WebGPU] ${e.name} shader code: ${s}`);let u=r.createComputePipeline({compute:{module:a,entryPoint:"main"},layout:"auto",label:e.name});return $h(e.name),{programInfo:e,computePipeline:u,uniformVariablesInfo:i.variablesInfo}}normalizeDispatchGroupSize(e){let t=typeof e=="number"?e:e.x,r=typeof e=="number"?1:e.y||1,n=typeof e=="number"?1:e.z||1,i=this.backend.device.limits.maxComputeWorkgroupsPerDimension;if(t<=i&&r<=i&&n<=i)return[t,r,n];let o=t*r*n,s=Math.ceil(Math.sqrt(o));if(s>i){if(s=Math.ceil(Math.cbrt(o)),s>i)throw new Error("Total dispatch size exceeds WebGPU maximum.");return[s,s,s]}else return[s,s,1]}}}),Roe={};Bb(Roe,{WebGpuBackend:()=>Foe});var gW,_W,yW,Foe,aEe=nn(()=>{Kf(),yi(),eg(),Xre(),gPe(),iEe(),oEe(),gW=(e,t)=>{if(t.length!==e.length)throw new Error(`inputDependencies length ${t.length} is not equal to inputTensors length ${e.length}.`);let r=[];for(let n=0;n<e.length;++n){let i=e[n].dataType;switch(t[n]){case"none":{r.push("");break}case"type":{r.push(`${i}`);break}case"rank":{let o=e[n].dims.length;r.push(`${i};${o}`);break}case"dims":{let o=e[n].dims.join(",");r.push(`${i};${o}`);break}default:throw new Error(`unsupported input dependency: ${t[n]}`)}}return r.join("|")},_W=(e,t,r)=>{var i,o;let n=e.name;return(i=e.shaderCache)!=null&&i.hint&&(n+="["+e.shaderCache.hint+"]"),n+=":"+r+`:${gW(t,((o=e.shaderCache)==null?void 0:o.inputDependencies)??new Array(t.length).fill("dims"))}`,n},yW=class{constructor(e){e&&(this.architecture=e.architecture,this.vendor=e.vendor)}isArchitecture(e){return this.architecture===e}isVendor(e){return this.vendor===e}},Foe=class{constructor(){this.currentSessionId=null,this.currentKernelId=null,this.commandEncoder=null,this.computePassEncoder=null,this.maxDispatchNumber=16,this.pendingDispatchNumber=0,this.pendingKernels=[],this.pendingQueries=new Map,this.sessionStatus="default",this.capturedCommandList=new Map,this.capturedPendingKernels=new Map,this.sessionExternalDataMapping=new Map}get currentKernelCustomData(){if(this.currentKernelId===null)throw new Error("currentKernelCustomData(): currentKernelId is null. (should not happen)");let e=this.kernelCustomData.get(this.currentKernelId);return e||(e={},this.kernelCustomData.set(this.currentKernelId,e)),e}async initialize(e,t){this.env=e;let r=[],n={requiredLimits:{maxComputeWorkgroupStorageSize:t.limits.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:t.limits.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:t.limits.maxStorageBufferBindingSize,maxBufferSize:t.limits.maxBufferSize,maxComputeInvocationsPerWorkgroup:t.limits.maxComputeInvocationsPerWorkgroup,maxComputeWorkgroupSizeX:t.limits.maxComputeWorkgroupSizeX,maxComputeWorkgroupSizeY:t.limits.maxComputeWorkgroupSizeY,maxComputeWorkgroupSizeZ:t.limits.maxComputeWorkgroupSizeZ},requiredFeatures:r},i=o=>t.features.has(o)&&r.push(o)&&!0;i("chromium-experimental-timestamp-query-inside-passes")||i("timestamp-query"),i("shader-f16"),i("subgroups"),this.device=await t.requestDevice(n),this.adapterInfo=new yW(t.info||await t.requestAdapterInfo()),this.gpuDataManager=Jre(this),this.programManager=new joe(this),this.kernels=new Map,this.kernelPersistentData=new Map,this.kernelCustomData=new Map,wR(e.logLevel,!!e.debug),this.device.onuncapturederror=o=>{o.error instanceof GPUValidationError&&console.error(`An uncaught WebGPU validation error was raised: ${o.error.message}`)},Object.defineProperty(this.env.webgpu,"device",{value:this.device,writable:!1,enumerable:!0,configurable:!1}),Object.defineProperty(this.env.webgpu,"adapter",{value:t,writable:!1,enumerable:!0,configurable:!1}),this.setQueryType()}dispose(){typeof this.querySet<"u"&&this.querySet.destroy(),this.gpuDataManager.dispose()}getCommandEncoder(){return this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder()),this.commandEncoder}getComputePassEncoder(){if(!this.computePassEncoder){let e=this.getCommandEncoder(),t={};this.queryType==="at-passes"&&(t.timestampWrites={querySet:this.querySet,beginningOfPassWriteIndex:this.pendingDispatchNumber*2,endOfPassWriteIndex:this.pendingDispatchNumber*2+1}),this.computePassEncoder=e.beginComputePass(t)}return this.computePassEncoder}endComputePass(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}flush(){if(!this.commandEncoder)return;Wf(),this.endComputePass();let e;this.queryType!=="none"&&(this.commandEncoder.resolveQuerySet(this.querySet,0,this.pendingDispatchNumber*2,this.queryResolveBuffer,0),e=this.device.createBuffer({size:this.pendingDispatchNumber*2*8,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),this.pendingQueries.set(e,this.pendingKernels),this.pendingKernels=[],this.commandEncoder.copyBufferToBuffer(this.queryResolveBuffer,0,e,0,this.pendingDispatchNumber*2*8)),this.device.queue.submit([this.commandEncoder.finish()]),this.gpuDataManager.refreshPendingBuffers(),this.commandEncoder=null,this.pendingDispatchNumber=0,this.queryType!=="none"&&e.mapAsync(GPUMapMode.READ).then(()=>{var n;let t=new BigUint64Array(e.getMappedRange()),r=this.pendingQueries.get(e);for(let i=0;i<t.length/2;i++){let o=r[i],s=o.kernelId,a=this.kernels.get(s),u=a.kernelType,d=a.kernelName,m=o.programName,g=o.inputTensorViews,_=o.outputTensorViews,y=t[i*2],M=t[i*2+1];typeof this.queryTimeBase>"u"&&(this.queryTimeBase=y);let x=Number(y-this.queryTimeBase),E=Number(M-this.queryTimeBase);if(!Number.isSafeInteger(x)||!Number.isSafeInteger(E))throw new RangeError("incorrect timestamp range");if((n=this.env.webgpu.profiling)!=null&&n.ondata)this.env.webgpu.profiling.ondata({version:1,inputsMetadata:g.map(T=>({dims:T.dims,dataType:km(T.dataType)})),outputsMetadata:_.map(T=>({dims:T.dims,dataType:km(T.dataType)})),kernelId:s,kernelType:u,kernelName:d,programName:m,startTime:x,endTime:E});else{let T="";g.forEach((C,D)=>{T+=`input[${D}]: [${C.dims}] | ${km(C.dataType)}, `});let P="";_.forEach((C,D)=>{P+=`output[${D}]: [${C.dims}] | ${km(C.dataType)}, `}),console.log(`[profiling] kernel "${s}|${u}|${d}|${m}" ${T}${P}execution time: ${E-x} ns`)}lM("GPU",`${m}::${y}::${M}`)}e.unmap(),this.pendingQueries.delete(e)}),$h()}run(e,t,r,n,i,o){Wf(e.name);let s=[];for(let P=0;P<t.length;++P){let C=t[P].data;if(C===0)continue;let D=this.gpuDataManager.get(C);if(!D)throw new Error(`no GPU data for input: ${C}`);s.push(D)}let{outputs:a,dispatchGroup:u,programUniforms:d}=e.getRunData(t),m=r.length===0?a.map((P,C)=>C):r;if(m.length!==a.length)throw new Error(`Output size ${m.length} must be equal to ${a.length}.`);let g=[],_=[];for(let P=0;P<a.length;++P){if(!Number.isInteger(m[P])||m[P]<-3||m[P]>=o)throw new Error(`Invalid output index: ${m[P]}`);if(m[P]===-3)continue;let C=m[P]===-1,D=m[P]===-2,L=C||D?i(a[P].dataType,a[P].dims):n(m[P],a[P].dataType,a[P].dims);if(g.push(L),L.data===0)continue;let N=this.gpuDataManager.get(L.data);if(!N)throw new Error(`no GPU data for output: ${L.data}`);if(C&&this.temporaryData.push(N),D){let j=this.kernelPersistentData.get(this.currentKernelId);j||(j=[],this.kernelPersistentData.set(this.currentKernelId,j)),j.push(N)}_.push(N)}if(s.length!==t.length||_.length!==g.length){if(_.length===0)return $h(e.name),g;throw new Error(`Program ${e.name} has zero-sized tensor(s) in inputs or outputs. This is not supported now.`)}let y;if(d){let P=0,C=[];d.forEach(j=>{let $=typeof j.data=="number"?[j.data]:j.data;if($.length===0)return;let U=j.type===10?2:4,G,H;j.type===10?(H=$.length>4?16:$.length>2?8:$.length*U,G=$.length>4?16:U*$.length):(H=$.length<=2?$.length*U:16,G=16),P=Math.ceil(P/H)*H,C.push(P);let X=j.type===10?8:4;P+=$.length>4?Math.ceil($.length/X)*G:$.length*U});let D=16;P=Math.ceil(P/D)*D;let L=new ArrayBuffer(P);d.forEach((j,$)=>{let U=C[$],G=typeof j.data=="number"?[j.data]:j.data;if(j.type===6)new Int32Array(L,U,G.length).set(G);else if(j.type===12)new Uint32Array(L,U,G.length).set(G);else if(j.type===10)new Uint16Array(L,U,G.length).set(G);else if(j.type===1)new Float32Array(L,U,G.length).set(G);else throw new Error(`Unsupported uniform type: ${km(j.type)}`)});let N=this.gpuDataManager.create(P,GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM);this.device.queue.writeBuffer(N.buffer,0,L,0,P),this.gpuDataManager.release(N.id),y={offset:0,size:P,buffer:N.buffer}}let M=this.programManager.normalizeDispatchGroupSize(u),x=M[1]===1&&M[2]===1,E=_W(e,t,x),T=this.programManager.getArtifact(E);if(T||(T=this.programManager.build(e,M),this.programManager.setArtifact(E,T),Do("info",()=>`[artifact] key: ${E}, programName: ${e.name}`)),d&&T.uniformVariablesInfo){if(d.length!==T.uniformVariablesInfo.length)throw new Error(`Uniform variables count mismatch: expect ${T.uniformVariablesInfo.length}, got ${d.length} in program "${T.programInfo.name}".`);for(let P=0;P<d.length;P++){let C=d[P],D=C.type,L=typeof C.data=="number"?1:C.data.length,[N,j]=T.uniformVariablesInfo[P];if(D!==N||L!==j)throw new Error(`Uniform variable ${P} mismatch: expect type ${N} with size ${j}, got type ${D} with size ${L} in program "${T.programInfo.name}".`)}}if(Do("info",()=>`[ProgramManager] run "${e.name}" (key=${E}) with ${M[0]}x${M[1]}x${M[2]}`),this.queryType!=="none"||this.sessionStatus==="capturing"){let P={kernelId:this.currentKernelId,programName:T.programInfo.name,inputTensorViews:t,outputTensorViews:g};this.pendingKernels.push(P),this.sessionStatus==="capturing"&&this.capturedPendingKernels.get(this.currentSessionId).push(P)}return this.programManager.run(T,s,_,M,y),$h(e.name),g}upload(e,t){this.gpuDataManager.upload(e,t)}memcpy(e,t){this.gpuDataManager.memcpy(e,t)}async download(e,t){await this.gpuDataManager.download(e,t)}alloc(e){return this.gpuDataManager.create(e).id}free(e){return this.gpuDataManager.release(e)}createKernel(e,t,r,n){let i=Noe.get(e);if(!i)throw new Error(`kernel not implemented: ${e}`);let o={kernelType:e,kernelName:n,kernelEntry:i[0],attributes:[i[1],r]};this.kernels.set(t,o)}releaseKernel(e){let t=this.kernelPersistentData.get(e);if(t){for(let r of t)this.gpuDataManager.release(r.id);this.kernelPersistentData.delete(e)}this.kernelCustomData.delete(e),this.kernels.delete(e)}computeKernel(e,t,r){let n=this.kernels.get(e);if(!n)throw new Error(`kernel not created: ${e}`);let i=n.kernelType,o=n.kernelName,s=n.kernelEntry,a=n.attributes;if(this.currentKernelId!==null)throw new Error(`kernel "[${i}] ${o}" is not allowed to be called recursively`);this.currentKernelId=e,a[0]&&(a[1]=a[0](a[1]),a[0]=void 0),Do("info",()=>`[WebGPU] Start to run kernel "[${i}] ${o}"...`);let u=this.env.debug;this.temporaryData=[];try{return u&&this.device.pushErrorScope("validation"),s(t,a[1]),0}catch(d){return r.push(Promise.resolve(`[WebGPU] Kernel "[${i}] ${o}" failed. ${d}`)),1}finally{u&&r.push(this.device.popErrorScope().then(d=>d?`GPU validation error for kernel "[${i}] ${o}": ${d.message}`:null));for(let d of this.temporaryData)this.gpuDataManager.release(d.id);this.temporaryData=[],this.currentKernelId=null}}registerBuffer(e,t,r,n){let i=this.sessionExternalDataMapping.get(e);i||(i=new Map,this.sessionExternalDataMapping.set(e,i));let o=i.get(t),s=this.gpuDataManager.registerExternalBuffer(r,n,o);return i.set(t,[s,r]),s}unregisterBuffers(e){let t=this.sessionExternalDataMapping.get(e);t&&(t.forEach(r=>this.gpuDataManager.unregisterExternalBuffer(r[0])),this.sessionExternalDataMapping.delete(e))}getBuffer(e){let t=this.gpuDataManager.get(e);if(!t)throw new Error(`no GPU data for buffer: ${e}`);return t.buffer}createDownloader(e,t,r){return async()=>{let n=await UD(this,e,t);return MR(n.buffer,r)}}writeTimestamp(e){this.queryType==="inside-passes"&&this.computePassEncoder.writeTimestamp(this.querySet,e)}setQueryType(){var e;this.queryType="none",(((e=this.env.webgpu.profiling)==null?void 0:e.mode)==="default"||(typeof this.env.trace>"u"?this.env.wasm.trace:this.env.trace))&&(this.device.features.has("chromium-experimental-timestamp-query-inside-passes")?this.queryType="inside-passes":this.device.features.has("timestamp-query")&&(this.queryType="at-passes"),this.queryType!=="none"&&typeof this.querySet>"u"&&(this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxDispatchNumber*2}),this.queryResolveBuffer=this.device.createBuffer({size:this.maxDispatchNumber*2*8,usage:GPUBufferUsage.COPY_SRC|GPUBufferUsage.QUERY_RESOLVE})))}captureBegin(){Do("info","captureBegin"),this.capturedCommandList.get(this.currentSessionId)||this.capturedCommandList.set(this.currentSessionId,[]),this.capturedPendingKernels.get(this.currentSessionId)||this.capturedPendingKernels.set(this.currentSessionId,[]),this.flush(),this.sessionStatus="capturing"}captureEnd(){Do("info","captureEnd"),this.flush(),this.sessionStatus="default"}replay(){Do("info","replay"),this.sessionStatus="replaying";let e=this.capturedCommandList.get(this.currentSessionId),t=this.capturedPendingKernels.get(this.currentSessionId),r=e.length;this.pendingKernels=[];for(let n=0;n<r;n++){let i=this.getComputePassEncoder(),o=e[n];this.writeTimestamp(this.pendingDispatchNumber*2),i.setPipeline(o.computePipeline),i.setBindGroup(0,o.bindGroup),i.dispatchWorkgroups(...o.dispatchGroup),this.writeTimestamp(this.pendingDispatchNumber*2+1),this.pendingDispatchNumber++,this.queryType!=="none"&&this.pendingKernels.push(t[n]),(this.pendingDispatchNumber>=this.maxDispatchNumber||this.queryType==="at-passes")&&this.endComputePass(),this.pendingDispatchNumber>=this.maxDispatchNumber&&this.flush()}this.flush(),this.sessionStatus="default"}onCreateSession(){this.gpuDataManager.onCreateSession()}onReleaseSession(e){this.unregisterBuffers(e),this.capturedCommandList.has(e)&&this.capturedCommandList.delete(e),this.capturedPendingKernels.has(e)&&this.capturedPendingKernels.delete(e),this.gpuDataManager.onReleaseSession(e)}onRunStart(e){this.currentSessionId=e,this.setQueryType()}}}),zoe={};Bb(zoe,{init:()=>Boe});var DP,vW,Boe,sEe=nn(()=>{yi(),eg(),ji(),mPe(),DP=class Uoe{constructor(t,r,n,i){this.module=t,this.dataType=r,this.data=n,this.dims=i}getFloat32Array(){if(this.dataType!==1)throw new Error("Invalid data type");let t=br.size(this.dims);return t===0?new Float32Array:new Float32Array(this.module.HEAP8.buffer,this.data,t)}getBigInt64Array(){if(this.dataType!==7)throw new Error("Invalid data type");let t=br.size(this.dims);return t===0?new BigInt64Array:new BigInt64Array(this.module.HEAP8.buffer,this.data,t)}getInt32Array(){if(this.dataType!==6)throw new Error("Invalid data type");let t=br.size(this.dims);return t===0?new Int32Array:new Int32Array(this.module.HEAP8.buffer,this.data,t)}getUint16Array(){if(this.dataType!==10&&this.dataType!==4)throw new Error("Invalid data type");let t=br.size(this.dims);return t===0?new Uint16Array:new Uint16Array(this.module.HEAP8.buffer,this.data,t)}reshape(t){if(br.size(t)!==br.size(this.dims))throw new Error("Invalid new shape");return new Uoe(this.module,this.dataType,this.data,t)}},vW=class{constructor(e,t,r){this.module=e,this.backend=t,this.customDataOffset=0,this.customDataSize=0,this.adapterInfo=t.adapterInfo;let n=e.PTR_SIZE,i=r/e.PTR_SIZE,o=n===4?"i32":"i64";this.opKernelContext=Number(e.getValue(n*i++,o));let s=Number(e.getValue(n*i++,o));this.outputCount=Number(e.getValue(n*i++,o)),this.customDataOffset=Number(e.getValue(n*i++,"*")),this.customDataSize=Number(e.getValue(n*i++,o));let a=[];for(let u=0;u<s;u++){let d=Number(e.getValue(n*i++,o)),m=Number(e.getValue(n*i++,"*")),g=Number(e.getValue(n*i++,o)),_=[];for(let y=0;y<g;y++)_.push(Number(e.getValue(n*i++,o)));a.push(new DP(e,d,m,_))}this.inputs=a}get kernelCustomData(){return this.backend.currentKernelCustomData}get customDataBuffer(){return this.module.HEAPU8.subarray(this.customDataOffset,this.customDataOffset+this.customDataSize)}compute(e,t){var s;let r=((s=t==null?void 0:t.inputs)==null?void 0:s.map(a=>typeof a=="number"?this.inputs[a]:a))??this.inputs,n=(t==null?void 0:t.outputs)??[],i=(a,u,d)=>new DP(this.module,u,this.output(a,d),d),o=(a,u)=>{let d=Sy(a,u);if(!d)throw new Error(`Unsupported data type: ${a}`);let m=d>0?this.backend.gpuDataManager.create(d).id:0;return new DP(this.module,a,m,u)};return this.backend.run(e,r,n,i,o,this.outputCount)}output(e,t){let r=this.module.stackSave();try{let n=this.module.PTR_SIZE,i=n===4?"i32":"i64",o=this.module.stackAlloc((1+t.length)*n);this.module.setValue(o,t.length,i);for(let s=0;s<t.length;s++)this.module.setValue(o+n*(s+1),t[s],i);return this.module._JsepOutput(this.opKernelContext,e,o)}catch(n){throw new Error(`Failed to generate kernel's output[${e}] with dims [${t}]. If you are running with pre-allocated output, please make sure the output type/dims are correct. Error: ${n}`)}finally{this.module.stackRestore(r)}}},Boe=async(e,t,r,n)=>{let i=t.jsepInit;if(!i)throw new Error("Failed to initialize JSEP. The WebAssembly module is not built with JSEP support.");if(e==="webgpu"){let o=(aEe(),sM(Roe)).WebGpuBackend,s=new o;await s.initialize(r,n),i("webgpu",[s,a=>s.alloc(Number(a)),a=>s.free(a),(a,u,d,m=!1)=>{if(m)Do("verbose",()=>`[WebGPU] jsepCopyGpuToGpu: src=${Number(a)}, dst=${Number(u)}, size=${Number(d)}`),s.memcpy(Number(a),Number(u));else{Do("verbose",()=>`[WebGPU] jsepCopyCpuToGpu: dataOffset=${Number(a)}, gpuDataId=${Number(u)}, size=${Number(d)}`);let g=t.HEAPU8.subarray(Number(a>>>0),Number(a>>>0)+Number(d));s.upload(Number(u),g)}},async(a,u,d)=>{Do("verbose",()=>`[WebGPU] jsepCopyGpuToCpu: gpuDataId=${a}, dataOffset=${u}, size=${d}`),await s.download(Number(a),()=>t.HEAPU8.subarray(Number(u)>>>0,Number(u+d)>>>0))},(a,u,d)=>s.createKernel(a,Number(u),d,t.UTF8ToString(t._JsepGetNodeName(Number(u)))),a=>s.releaseKernel(a),(a,u,d,m)=>{Do("verbose",()=>`[WebGPU] jsepRun: sessionHandle=${d}, kernel=${a}, contextDataOffset=${u}`);let g=new vW(t,s,Number(u));return s.computeKernel(Number(a),g,m)},()=>s.captureBegin(),()=>s.captureEnd(),()=>s.replay()])}else{let o=new Qre(r);i("webnn",[o,()=>o.reserveTensorId(),s=>o.releaseTensorId(s),async(s,a,u,d,m)=>o.ensureTensor(s,a,u,d,m),(s,a)=>{o.uploadTensor(s,a)},async(s,a)=>o.downloadTensor(s,a)])}}}),bW,DR,$R,Cg,xW,X3,jA,NR,jR,Y3,RR,FR,zR,Voe=nn(()=>{hPe(),fPe(),yi(),L0(),_R(),qre(),bW=(e,t)=>{ka()._OrtInit(e,t)!==0&&fa("Can't initialize onnxruntime.")},DR=async e=>{bW(e.wasm.numThreads,OA(e.logLevel))},$R=async(e,t)=>{var r,n;(n=(r=ka()).asyncInit)==null||n.call(r);{let i=(sEe(),sM(zoe)).init;if(t==="webgpu"){if(typeof navigator>"u"||!navigator.gpu)throw new Error("WebGPU is not supported in current environment");let o=e.webgpu.adapter;if(o){if(typeof o.limits!="object"||typeof o.features!="object"||typeof o.requestDevice!="function")throw new Error("Invalid GPU adapter set in `env.webgpu.adapter`. It must be a GPUAdapter object.")}else{let s=e.webgpu.powerPreference;if(s!==void 0&&s!=="low-power"&&s!=="high-performance")throw new Error(`Invalid powerPreference setting: "${s}"`);let a=e.webgpu.forceFallbackAdapter;if(a!==void 0&&typeof a!="boolean")throw new Error(`Invalid forceFallbackAdapter setting: "${a}"`);if(o=await navigator.gpu.requestAdapter({powerPreference:s,forceFallbackAdapter:a}),!o)throw new Error('Failed to get GPU adapter. You may need to enable flag "--enable-unsafe-webgpu" if you are using Chrome.')}await i("webgpu",ka(),e,o)}if(t==="webnn"){if(typeof navigator>"u"||!navigator.ml)throw new Error("WebNN is not supported in current environment");await i("webnn",ka(),e)}}},Cg=new Map,xW=e=>{let t=ka(),r=t.stackSave();try{let n=t.PTR_SIZE,i=t.stackAlloc(2*n);t._OrtGetInputOutputCount(e,i,i+n)!==0&&fa("Can't get session input/output count.");let o=n===4?"i32":"i64";return[Number(t.getValue(i,o)),Number(t.getValue(i+n,o))]}finally{t.stackRestore(r)}},X3=(e,t)=>{let r=ka(),n=r.stackSave(),i=0;try{let o=r.PTR_SIZE,s=r.stackAlloc(2*o);r._OrtGetInputOutputMetadata(e,t,s,s+o)!==0&&fa("Can't get session input/output metadata.");let a=Number(r.getValue(s,"*"));i=Number(r.getValue(s+o,"*"));let u=r.HEAP32[i/4];if(u===0)return[a,0];let d=r.HEAPU32[i/4+1],m=[];for(let g=0;g<d;g++){let _=Number(r.getValue(i+8+g*o,"*"));m.push(_!==0?r.UTF8ToString(_):Number(r.getValue(i+8+(g+d)*o,"*")))}return[a,u,m]}finally{r.stackRestore(n),i!==0&&r._OrtFree(i)}},jA=e=>{let t=ka(),r=t._malloc(e.byteLength);if(r===0)throw new Error(`Can't create a session. failed to allocate a buffer of size ${e.byteLength}.`);return t.HEAPU8.set(e,r),[r,e.byteLength]},NR=async(e,t)=>{var g,_,y,M;let r,n,i=ka();Array.isArray(e)?[r,n]=e:e.buffer===i.HEAPU8.buffer?[r,n]=[e.byteOffset,e.byteLength]:[r,n]=jA(e);let o=0,s=0,a=0,u=[],d=[],m=[];try{if([s,u]=await Gre(t),(t==null?void 0:t.externalData)&&i.mountExternalData){let $=[];for(let U of t.externalData){let G=typeof U=="string"?U:U.path;$.push(xR(typeof U=="string"?U:U.data).then(H=>{i.mountExternalData(G,H)}))}await Promise.all($)}for(let $ of(t==null?void 0:t.executionProviders)??[])if((typeof $=="string"?$:$.name)==="webnn"){if(i.shouldTransferToMLTensor=!1,typeof $!="string"){let U=$,G=U==null?void 0:U.context,H=U==null?void 0:U.gpuDevice,X=U==null?void 0:U.deviceType,ee=U==null?void 0:U.powerPreference;G?i.currentContext=G:H?i.currentContext=await i.webnnCreateMLContext(H):i.currentContext=await i.webnnCreateMLContext({deviceType:X,powerPreference:ee})}else i.currentContext=await i.webnnCreateMLContext();break}o=await i._OrtCreateSession(r,n,s),(g=i.webgpuOnCreateSession)==null||g.call(i,o),o===0&&fa("Can't create a session."),(_=i.jsepOnCreateSession)==null||_.call(i),i.currentContext&&(i.webnnRegisterMLContext(o,i.currentContext),i.currentContext=void 0,i.shouldTransferToMLTensor=!0);let[x,E]=xW(o),T=!!(t!=null&&t.enableGraphCapture),P=[],C=[],D=[],L=[],N=[];for(let $=0;$<x;$++){let[U,G,H]=X3(o,$);U===0&&fa("Can't get an input name."),d.push(U);let X=i.UTF8ToString(U);P.push(X),D.push(G===0?{name:X,isTensor:!1}:{name:X,isTensor:!0,type:km(G),shape:H})}for(let $=0;$<E;$++){let[U,G,H]=X3(o,$+x);U===0&&fa("Can't get an output name."),m.push(U);let X=i.UTF8ToString(U);C.push(X),L.push(G===0?{name:X,isTensor:!1}:{name:X,isTensor:!0,type:km(G),shape:H});{if(T&&(t==null?void 0:t.preferredOutputLocation)===void 0){N.push("gpu-buffer");continue}let ee=typeof(t==null?void 0:t.preferredOutputLocation)=="string"?t.preferredOutputLocation:((y=t==null?void 0:t.preferredOutputLocation)==null?void 0:y[X])??"cpu";if(ee!=="cpu"&&ee!=="cpu-pinned"&&ee!=="gpu-buffer"&&ee!=="ml-tensor")throw new Error(`Not supported preferred output location: ${ee}.`);if(T&&ee!=="gpu-buffer")throw new Error(`Not supported preferred output location: ${ee}. Only 'gpu-buffer' location is supported when enableGraphCapture is true.`);N.push(ee)}}let j=null;return N.some($=>$==="gpu-buffer"||$==="ml-tensor")&&(a=i._OrtCreateBinding(o),a===0&&fa("Can't create IO binding."),j={handle:a,outputPreferredLocations:N,outputPreferredLocationsEncoded:N.map($=>zD($))}),Cg.set(o,[o,d,m,j,T,!1]),[o,P,C,D,L]}catch(x){throw d.forEach(E=>i._OrtFree(E)),m.forEach(E=>i._OrtFree(E)),a!==0&&i._OrtReleaseBinding(a)!==0&&fa("Can't release IO binding."),o!==0&&i._OrtReleaseSession(o)!==0&&fa("Can't release session."),x}finally{i._free(r),s!==0&&i._OrtReleaseSessionOptions(s)!==0&&fa("Can't release session options."),u.forEach(x=>i._free(x)),(M=i.unmountExternalData)==null||M.call(i)}},jR=e=>{var u,d,m;let t=ka(),r=Cg.get(e);if(!r)throw new Error(`cannot release session. invalid session id: ${e}`);let[n,i,o,s,a]=r;s&&(a&&t._OrtClearBoundOutputs(s.handle)!==0&&fa("Can't clear bound outputs."),t._OrtReleaseBinding(s.handle)!==0&&fa("Can't release IO binding.")),(u=t.jsepOnReleaseSession)==null||u.call(t,e),(d=t.webnnOnReleaseSession)==null||d.call(t,e),(m=t.webgpuOnReleaseSession)==null||m.call(t,e),i.forEach(g=>t._OrtFree(g)),o.forEach(g=>t._OrtFree(g)),t._OrtReleaseSession(n)!==0&&fa("Can't release session."),Cg.delete(e)},Y3=async(e,t,r,n,i,o,s=!1)=>{if(!e){t.push(0);return}let a=ka(),u=a.PTR_SIZE,d=e[0],m=e[1],g=e[3],_=g,y,M;if(d==="string"&&(g==="gpu-buffer"||g==="ml-tensor"))throw new Error("String tensor is not supported on GPU.");if(s&&g!=="gpu-buffer")throw new Error(`External buffer must be provided for input/output index ${o} when enableGraphCapture is true.`);if(g==="gpu-buffer"){let T=e[2].gpuBuffer;M=Sy(Nv(d),m);{let P=a.jsepRegisterBuffer;if(!P)throw new Error('Tensor location "gpu-buffer" is not supported without using WebGPU.');y=P(n,o,T,M)}}else if(g==="ml-tensor"){let T=e[2].mlTensor;M=Sy(Nv(d),m);let P=a.webnnRegisterMLTensor;if(!P)throw new Error('Tensor location "ml-tensor" is not supported without using WebNN.');y=P(n,T,Nv(d),m)}else{let T=e[2];if(Array.isArray(T)){M=u*T.length,y=a._malloc(M),r.push(y);for(let P=0;P<T.length;P++){if(typeof T[P]!="string")throw new TypeError(`tensor data at index ${P} is not a string`);a.setValue(y+P*u,Of(T[P],r),"*")}}else{let P=a.webnnIsGraphInput;if(d!=="string"&&P){let C=a.UTF8ToString(i);if(P(n,C)){let D=Nv(d);M=Sy(D,m),_="ml-tensor";let L=a.webnnCreateTemporaryTensor,N=a.webnnUploadTensor;if(!L||!N)throw new Error('Tensor location "ml-tensor" is not supported without using WebNN.');let j=await L(n,D,m);N(j,new Uint8Array(T.buffer,T.byteOffset,T.byteLength)),y=j}else M=T.byteLength,y=a._malloc(M),r.push(y),a.HEAPU8.set(new Uint8Array(T.buffer,T.byteOffset,M),y)}else M=T.byteLength,y=a._malloc(M),r.push(y),a.HEAPU8.set(new Uint8Array(T.buffer,T.byteOffset,M),y)}}let x=a.stackSave(),E=a.stackAlloc(4*m.length);try{m.forEach((P,C)=>a.setValue(E+C*u,P,u===4?"i32":"i64"));let T=a._OrtCreateTensor(Nv(d),y,M,E,m.length,zD(_));T===0&&fa(`Can't create tensor for input/output. session=${n}, index=${o}.`),t.push(T)}finally{a.stackRestore(x)}},RR=async(e,t,r,n,i,o)=>{var H,X,ee,ae;let s=ka(),a=s.PTR_SIZE,u=Cg.get(e);if(!u)throw new Error(`cannot run inference. invalid session id: ${e}`);let d=u[0],m=u[1],g=u[2],_=u[3],y=u[4],M=u[5],x=t.length,E=n.length,T=0,P=[],C=[],D=[],L=[],N=s.stackSave(),j=s.stackAlloc(x*a),$=s.stackAlloc(x*a),U=s.stackAlloc(E*a),G=s.stackAlloc(E*a);try{[T,P]=Wre(o);for(let _e=0;_e<x;_e++)await Y3(r[_e],C,L,e,m[t[_e]],t[_e],y);for(let _e=0;_e<E;_e++)await Y3(i[_e],D,L,e,g[n[_e]],x+n[_e],y);for(let _e=0;_e<x;_e++)s.setValue(j+_e*a,C[_e],"*"),s.setValue($+_e*a,m[t[_e]],"*");for(let _e=0;_e<E;_e++)s.setValue(U+_e*a,D[_e],"*"),s.setValue(G+_e*a,g[n[_e]],"*");if(_&&!M){let{handle:_e,outputPreferredLocations:ue,outputPreferredLocationsEncoded:fe}=_;if(m.length!==x)throw new Error(`input count from feeds (${x}) is expected to be always equal to model's input count (${m.length}).`);for(let De=0;De<x;De++){let pe=t[De];await s._OrtBindInput(_e,m[pe],C[De])!==0&&fa(`Can't bind input[${De}] for session=${e}.`)}for(let De=0;De<E;De++){let pe=n[De];(H=i[De])!=null&&H[3]?s._OrtBindOutput(_e,g[pe],D[De],0)!==0&&fa(`Can't bind pre-allocated output[${De}] for session=${e}.`):s._OrtBindOutput(_e,g[pe],0,fe[pe])!==0&&fa(`Can't bind output[${De}] to ${ue[De]} for session=${e}.`)}Cg.set(e,[d,m,g,_,y,!0])}(X=s.jsepOnRunStart)==null||X.call(s,d),(ee=s.webnnOnRunStart)==null||ee.call(s,d);let de;_?de=await s._OrtRunWithBinding(d,_.handle,E,U,T):de=await s._OrtRun(d,$,j,x,G,E,U,T),de!==0&&fa("failed to call OrtRun().");let ye=[];for(let _e=0;_e<E;_e++){let ue=Number(s.getValue(U+_e*a,"*"));if(ue===D[_e]){ye.push(i[_e]);continue}let fe=s.stackSave(),De=s.stackAlloc(4*a),pe=!1,K,te=0;try{s._OrtGetTensorData(ue,De,De+a,De+2*a,De+3*a)!==0&&fa(`Can't access output tensor data on index ${_e}.`);let ve=a===4?"i32":"i64",$e=Number(s.getValue(De,ve));te=s.getValue(De+a,"*");let Ce=s.getValue(De+a*2,"*"),Ge=Number(s.getValue(De+a*3,ve)),ot=[];for(let Te=0;Te<Ge;Te++)ot.push(Number(s.getValue(Ce+Te*a,ve)));s._OrtFree(Ce)!==0&&fa("Can't free memory for tensor dims.");let Ye=ot.reduce((Te,Le)=>Te*Le,1);K=km($e);let et=_==null?void 0:_.outputPreferredLocations[n[_e]];if(K==="string"){if(et==="gpu-buffer"||et==="ml-tensor")throw new Error("String tensor is not supported on GPU.");let Te=[];for(let Le=0;Le<Ye;Le++){let ke=s.getValue(te+Le*a,"*"),Xe=s.getValue(te+(Le+1)*a,"*"),Ne=Le===Ye-1?void 0:Xe-ke;Te.push(s.UTF8ToString(ke,Ne))}ye.push([K,ot,Te,"cpu"])}else if(et==="gpu-buffer"&&Ye>0){let Te=s.jsepGetBuffer;if(!Te)throw new Error('preferredLocation "gpu-buffer" is not supported without using WebGPU.');let Le=Te(te),ke=Sy($e,Ye);if(ke===void 0||!vR(K))throw new Error(`Unsupported data type: ${K}`);pe=!0,ye.push([K,ot,{gpuBuffer:Le,download:s.jsepCreateDownloader(Le,ke,K),dispose:()=>{s._OrtReleaseTensor(ue)!==0&&fa("Can't release tensor.")}},"gpu-buffer"])}else if(et==="ml-tensor"&&Ye>0){let Te=s.webnnEnsureTensor,Le=s.webnnIsInt64Supported;if(!Te||!Le)throw new Error('preferredLocation "ml-tensor" is not supported without using WebNN.');if(Sy($e,Ye)===void 0||!bR(K))throw new Error(`Unsupported data type: ${K}`);if(K==="int64"&&!Le(e))throw new Error('preferredLocation "ml-tensor" for int64 output is not supported by current WebNN Context.');let ke=await Te(e,te,$e,ot,!1);pe=!0,ye.push([K,ot,{mlTensor:ke,download:s.webnnCreateMLTensorDownloader(te,K),dispose:()=>{s.webnnReleaseTensorId(te),s._OrtReleaseTensor(ue)}},"ml-tensor"])}else{let Te=yR(K),Le=new Te(Ye);new Uint8Array(Le.buffer,Le.byteOffset,Le.byteLength).set(s.HEAPU8.subarray(te,te+Le.byteLength)),ye.push([K,ot,Le,"cpu"])}}finally{s.stackRestore(fe),K==="string"&&te&&s._free(te),pe||s._OrtReleaseTensor(ue),(ae=s.webnnOnRunEnd)==null||ae.call(s,d)}}return _&&!y&&(s._OrtClearBoundOutputs(_.handle)!==0&&fa("Can't clear bound outputs."),Cg.set(e,[d,m,g,_,y,!1])),ye}finally{s.stackRestore(N),C.forEach(de=>s._OrtReleaseTensor(de)),D.forEach(de=>s._OrtReleaseTensor(de)),L.forEach(de=>s._free(de)),T!==0&&s._OrtReleaseRunOptions(T),P.forEach(de=>s._free(de))}},FR=e=>{let t=ka(),r=Cg.get(e);if(!r)throw new Error("invalid session id");let n=r[0],i=t._OrtEndProfiling(n);i===0&&fa("Can't get an profile file name."),t._OrtFree(i)},zR=e=>{let t=[];for(let r of e){let n=r[2];!Array.isArray(n)&&"buffer"in n&&t.push(n.buffer)}return t}}),kg,id,Pv,Tw,Pw,$P,Q3,NP,uy,dy,wW,Woe,Goe,qoe,Hoe,Koe,Zoe,Xoe,Yoe=nn(()=>{Kf(),Voe(),L0(),mR(),kg=()=>!!Ua.wasm.proxy&&typeof document<"u",Pv=!1,Tw=!1,Pw=!1,NP=new Map,uy=(e,t)=>{let r=NP.get(e);r?r.push(t):NP.set(e,[t])},dy=()=>{if(Pv||!Tw||Pw||!id)throw new Error("worker not ready")},wW=e=>{switch(e.data.type){case"init-wasm":Pv=!1,e.data.err?(Pw=!0,Q3[1](e.data.err)):(Tw=!0,Q3[0]()),$P&&(URL.revokeObjectURL($P),$P=void 0);break;case"init-ep":case"copy-from":case"create":case"release":case"run":case"end-profiling":{let t=NP.get(e.data.type);e.data.err?t.shift()[1](e.data.err):t.shift()[0](e.data.out);break}}},Woe=async()=>{if(!Tw){if(Pv)throw new Error("multiple calls to 'initWasm()' detected.");if(Pw)throw new Error("previous call to 'initWasm()' failed.");if(Pv=!0,kg())return new Promise((e,t)=>{id==null||id.terminate(),Ure().then(([r,n])=>{try{id=n,id.onerror=o=>t(o),id.onmessage=wW,Q3=[e,t];let i={type:"init-wasm",in:Ua};!i.in.wasm.wasmPaths&&(r||FD)&&(i.in.wasm.wasmPaths={wasm:new URL("/forest_right_portal.github.io/assets/ort-wasm-simd-threaded.jsep-B0T3yYHD.wasm",import.meta.url).href}),id.postMessage(i),$P=r}catch(i){t(i)}},t)});try{await gR(Ua.wasm),await DR(Ua),Tw=!0}catch(e){throw Pw=!0,e}finally{Pv=!1}}},Goe=async e=>{if(kg())return dy(),new Promise((t,r)=>{uy("init-ep",[t,r]);let n={type:"init-ep",in:{epName:e,env:Ua}};id.postMessage(n)});await $R(Ua,e)},qoe=async e=>kg()?(dy(),new Promise((t,r)=>{uy("copy-from",[t,r]);let n={type:"copy-from",in:{buffer:e}};id.postMessage(n,[e.buffer])})):jA(e),Hoe=async(e,t)=>{if(kg()){if(t!=null&&t.preferredOutputLocation)throw new Error('session option "preferredOutputLocation" is not supported for proxy.');return dy(),new Promise((r,n)=>{uy("create",[r,n]);let i={type:"create",in:{model:e,options:{...t}}},o=[];e instanceof Uint8Array&&o.push(e.buffer),id.postMessage(i,o)})}else return NR(e,t)},Koe=async e=>{if(kg())return dy(),new Promise((t,r)=>{uy("release",[t,r]);let n={type:"release",in:e};id.postMessage(n)});jR(e)},Zoe=async(e,t,r,n,i,o)=>{if(kg()){if(r.some(s=>s[3]!=="cpu"))throw new Error("input tensor on GPU is not supported for proxy.");if(i.some(s=>s))throw new Error("pre-allocated output tensor is not supported for proxy.");return dy(),new Promise((s,a)=>{uy("run",[s,a]);let u=r,d={type:"run",in:{sessionId:e,inputIndices:t,inputs:u,outputIndices:n,options:o}};id.postMessage(d,zR(u))})}else return RR(e,t,r,n,i,o)},Xoe=async e=>{if(kg())return dy(),new Promise((t,r)=>{uy("end-profiling",[t,r]);let n={type:"end-profiling",in:e};id.postMessage(n)});FR(e)}}),J3,MW,Qoe,lEe=nn(()=>{Kf(),Yoe(),yi(),pR(),qre(),J3=(e,t)=>{switch(e.location){case"cpu":return[e.type,e.dims,e.data,"cpu"];case"gpu-buffer":return[e.type,e.dims,{gpuBuffer:e.gpuBuffer},"gpu-buffer"];case"ml-tensor":return[e.type,e.dims,{mlTensor:e.mlTensor},"ml-tensor"];default:throw new Error(`invalid data location: ${e.location} for ${t()}`)}},MW=e=>{switch(e[3]){case"cpu":return new Lf(e[0],e[2],e[1]);case"gpu-buffer":{let t=e[0];if(!vR(t))throw new Error(`not supported data type: ${t} for deserializing GPU tensor`);let{gpuBuffer:r,download:n,dispose:i}=e[2];return Lf.fromGpuBuffer(r,{dataType:t,dims:e[1],download:n,dispose:i})}case"ml-tensor":{let t=e[0];if(!bR(t))throw new Error(`not supported data type: ${t} for deserializing MLTensor tensor`);let{mlTensor:r,download:n,dispose:i}=e[2];return Lf.fromMLTensor(r,{dataType:t,dims:e[1],download:n,dispose:i})}default:throw new Error(`invalid data location: ${e[3]}`)}},Qoe=class{async fetchModelAndCopyToWasmMemory(e){return qoe(await xR(e))}async loadModel(e,t){Wf();let r;typeof e=="string"?r=await this.fetchModelAndCopyToWasmMemory(e):r=e,[this.sessionId,this.inputNames,this.outputNames,this.inputMetadata,this.outputMetadata]=await Hoe(r,t),$h()}async dispose(){return Koe(this.sessionId)}async run(e,t,r){Wf();let n=[],i=[];Object.entries(e).forEach(g=>{let _=g[0],y=g[1],M=this.inputNames.indexOf(_);if(M===-1)throw new Error(`invalid input '${_}'`);n.push(y),i.push(M)});let o=[],s=[];Object.entries(t).forEach(g=>{let _=g[0],y=g[1],M=this.outputNames.indexOf(_);if(M===-1)throw new Error(`invalid output '${_}'`);o.push(y),s.push(M)});let a=n.map((g,_)=>J3(g,()=>`input "${this.inputNames[i[_]]}"`)),u=o.map((g,_)=>g?J3(g,()=>`output "${this.outputNames[s[_]]}"`):null),d=await Zoe(this.sessionId,i,a,s,u,r),m={};for(let g=0;g<d.length;g++)m[this.outputNames[s[g]]]=o[g]??MW(d[g]);return $h(),m}startProfiling(){}endProfiling(){Xoe(this.sessionId)}}}),Joe={};Bb(Joe,{OnnxruntimeWebAssemblyBackend:()=>e$,initializeFlags:()=>JD,wasmBackend:()=>eae});var JD,e$,eae,cEe=nn(()=>{Kf(),Yoe(),lEe(),JD=()=>{(typeof Ua.wasm.initTimeout!="number"||Ua.wasm.initTimeout<0)&&(Ua.wasm.initTimeout=0);let e=Ua.wasm.simd;if(typeof e!="boolean"&&e!==void 0&&e!=="fixed"&&e!=="relaxed"&&(console.warn(`Property "env.wasm.simd" is set to unknown value "${e}". Reset it to \`false\` and ignore SIMD feature checking.`),Ua.wasm.simd=!1),typeof Ua.wasm.proxy!="boolean"&&(Ua.wasm.proxy=!1),typeof Ua.wasm.trace!="boolean"&&(Ua.wasm.trace=!1),typeof Ua.wasm.numThreads!="number"||!Number.isInteger(Ua.wasm.numThreads)||Ua.wasm.numThreads<=0)if(typeof self<"u"&&!self.crossOriginIsolated)Ua.wasm.numThreads=1;else{let t=typeof navigator>"u"?ZTe("node:os").cpus().length:navigator.hardwareConcurrency;Ua.wasm.numThreads=Math.min(4,Math.ceil((t||1)/2))}},e$=class{async init(e){JD(),await Woe(),await Goe(e)}async createInferenceSessionHandler(e,t){let r=new Qoe;return await r.loadModel(e,t),r}},eae=new e$});Kf();Kf();Kf();var uEe="1.22.0-dev.20250409-89f8206ba4",dEe=Nre;{let e=(cEe(),sM(Joe)).wasmBackend;Oy("webgpu",e,5),Oy("webnn",e,5),Oy("cpu",e,10),Oy("wasm",e,10)}Object.defineProperty(Ua.versions,"web",{value:uEe,enumerable:!0});/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*//**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hEe=Object.freeze(Object.defineProperty({__proto__:null,get InferenceSession(){return fR},get TRACE(){return lM},get TRACE_FUNC_BEGIN(){return Wf},get TRACE_FUNC_END(){return $h},get Tensor(){return Lf},default:dEe,get env(){return Ua},get registerBackend(){return Oy}},Symbol.toStringTag,{value:"Module"}));var vm={},fEe={"onnxruntime-common":e=>{e.exports=GTe},"onnxruntime-web":e=>{e.exports=hEe},"?2ce3":()=>{},"?7992":()=>{},"?5af5":()=>{},"?2b25":()=>{},"?db59":()=>{},"?383f":()=>{},"?fa4b":()=>{},"./node_modules/@huggingface/jinja/dist/index.js":(e,t,r)=>{r.r(t),r.d(t,{Environment:()=>or,Interpreter:()=>Se,Template:()=>An,parse:()=>Ce,tokenize:()=>m});var n=Object.freeze({Text:"Text",NumericLiteral:"NumericLiteral",StringLiteral:"StringLiteral",Identifier:"Identifier",Equals:"Equals",OpenParen:"OpenParen",CloseParen:"CloseParen",OpenStatement:"OpenStatement",CloseStatement:"CloseStatement",OpenExpression:"OpenExpression",CloseExpression:"CloseExpression",OpenSquareBracket:"OpenSquareBracket",CloseSquareBracket:"CloseSquareBracket",OpenCurlyBracket:"OpenCurlyBracket",CloseCurlyBracket:"CloseCurlyBracket",Comma:"Comma",Dot:"Dot",Colon:"Colon",Pipe:"Pipe",CallOperator:"CallOperator",AdditiveBinaryOperator:"AdditiveBinaryOperator",MultiplicativeBinaryOperator:"MultiplicativeBinaryOperator",ComparisonBinaryOperator:"ComparisonBinaryOperator",UnaryOperator:"UnaryOperator",Comment:"Comment"}),i=class{constructor(ge,ut){this.value=ge,this.type=ut}};function o(ge){return/\w/.test(ge)}function s(ge){return/[0-9]/.test(ge)}var a=[["{%",n.OpenStatement],["%}",n.CloseStatement],["{{",n.OpenExpression],["}}",n.CloseExpression],["(",n.OpenParen],[")",n.CloseParen],["{",n.OpenCurlyBracket],["}",n.CloseCurlyBracket],["[",n.OpenSquareBracket],["]",n.CloseSquareBracket],[",",n.Comma],[".",n.Dot],[":",n.Colon],["|",n.Pipe],["<=",n.ComparisonBinaryOperator],[">=",n.ComparisonBinaryOperator],["==",n.ComparisonBinaryOperator],["!=",n.ComparisonBinaryOperator],["<",n.ComparisonBinaryOperator],[">",n.ComparisonBinaryOperator],["+",n.AdditiveBinaryOperator],["-",n.AdditiveBinaryOperator],["~",n.AdditiveBinaryOperator],["*",n.MultiplicativeBinaryOperator],["/",n.MultiplicativeBinaryOperator],["%",n.MultiplicativeBinaryOperator],["=",n.Equals]],u=new Map([["n",`
`],["t","	"],["r","\r"],["b","\b"],["f","\f"],["v","\v"],["'","'"],['"','"'],["\\","\\"]]);function d(ge,ut={}){return ge.endsWith(`
`)&&(ge=ge.slice(0,-1)),ut.lstrip_blocks&&(ge=ge.replace(/^[ \t]*({[#%-])/gm,"$1")),ut.trim_blocks&&(ge=ge.replace(/([#%-]})\n/g,"$1")),ge.replace(/-%}\s*/g,"%}").replace(/\s*{%-/g,"{%").replace(/-}}\s*/g,"}}").replace(/\s*{{-/g,"{{").replace(/-#}\s*/g,"#}").replace(/\s*{#-/g,"{#").replace(/{%\s*(end)?generation\s*%}/gs,"")}function m(ge,ut={}){var Rr,On;const We=[],Je=d(ge,ut);let xt=0,wt=0;const pr=Mn=>{let _r="";for(;Mn(Je[xt]);){if(Je[xt]==="\\"){if(++xt,xt>=Je.length)throw new SyntaxError("Unexpected end of input");const Or=Je[xt++],an=u.get(Or);if(an===void 0)throw new SyntaxError(`Unexpected escaped character: ${Or}`);_r+=an;continue}if(_r+=Je[xt++],xt>=Je.length)throw new SyntaxError("Unexpected end of input")}return _r};e:for(;xt<Je.length;){const Mn=(Rr=We.at(-1))==null?void 0:Rr.type;if(Mn===void 0||Mn===n.CloseStatement||Mn===n.CloseExpression||Mn===n.Comment){let Or="";for(;xt<Je.length&&!(Je[xt]==="{"&&(Je[xt+1]==="%"||Je[xt+1]==="{"||Je[xt+1]==="#"));)Or+=Je[xt++];if(Or.length>0){We.push(new i(Or,n.Text));continue}}if(Je[xt]==="{"&&Je[xt+1]==="#"){xt+=2;let Or="";for(;Je[xt]!=="#"||Je[xt+1]!=="}";){if(xt+2>=Je.length)throw new SyntaxError("Missing end of comment tag");Or+=Je[xt++]}We.push(new i(Or,n.Comment)),xt+=2;continue}pr(Or=>/\s/.test(Or));const _r=Je[xt];if(_r==="-"||_r==="+"){const Or=(On=We.at(-1))==null?void 0:On.type;if(Or===n.Text||Or===void 0)throw new SyntaxError(`Unexpected character: ${_r}`);switch(Or){case n.Identifier:case n.NumericLiteral:case n.StringLiteral:case n.CloseParen:case n.CloseSquareBracket:break;default:{++xt;const an=pr(s);We.push(new i(`${_r}${an}`,an.length>0?n.NumericLiteral:n.UnaryOperator));continue}}}for(const[Or,an]of a){if(Or==="}}"&&wt>0)continue;if(Je.slice(xt,xt+Or.length)===Or){We.push(new i(Or,an)),an===n.OpenExpression?wt=0:an===n.OpenCurlyBracket?++wt:an===n.CloseCurlyBracket&&--wt,xt+=Or.length;continue e}}if(_r==="'"||_r==='"'){++xt;const Or=pr(an=>an!==_r);We.push(new i(Or,n.StringLiteral)),++xt;continue}if(s(_r)){let Or=pr(s);if(Je[xt]==="."&&s(Je[xt+1])){++xt;const an=pr(s);Or=`${Or}.${an}`}We.push(new i(Or,n.NumericLiteral));continue}if(o(_r)){const Or=pr(o);We.push(new i(Or,n.Identifier));continue}throw new SyntaxError(`Unexpected character: ${_r}`)}return We}var g=class{constructor(){_t(this,"type","Statement")}},_=class extends g{constructor(ut){super();_t(this,"type","Program");this.body=ut}},y=class extends g{constructor(ut,We,Je){super();_t(this,"type","If");this.test=ut,this.body=We,this.alternate=Je}},M=class extends g{constructor(ut,We,Je,xt){super();_t(this,"type","For");this.loopvar=ut,this.iterable=We,this.body=Je,this.defaultBlock=xt}},x=class extends g{constructor(){super(...arguments);_t(this,"type","Break")}},E=class extends g{constructor(){super(...arguments);_t(this,"type","Continue")}},T=class extends g{constructor(ut,We,Je){super();_t(this,"type","Set");this.assignee=ut,this.value=We,this.body=Je}},P=class extends g{constructor(ut,We,Je){super();_t(this,"type","Macro");this.name=ut,this.args=We,this.body=Je}},C=class extends g{constructor(ut){super();_t(this,"type","Comment");this.value=ut}},D=class extends g{constructor(){super(...arguments);_t(this,"type","Expression")}},L=class extends D{constructor(ut,We,Je){super();_t(this,"type","MemberExpression");this.object=ut,this.property=We,this.computed=Je}},N=class extends D{constructor(ut,We){super();_t(this,"type","CallExpression");this.callee=ut,this.args=We}},j=class extends D{constructor(ut){super();_t(this,"type","Identifier");this.value=ut}},$=class extends D{constructor(ut){super();_t(this,"type","Literal");this.value=ut}},U=class extends ${constructor(){super(...arguments);_t(this,"type","IntegerLiteral")}},G=class extends ${constructor(){super(...arguments);_t(this,"type","FloatLiteral")}},H=class extends ${constructor(){super(...arguments);_t(this,"type","StringLiteral")}},X=class extends ${constructor(){super(...arguments);_t(this,"type","ArrayLiteral")}},ee=class extends ${constructor(){super(...arguments);_t(this,"type","TupleLiteral")}},ae=class extends ${constructor(){super(...arguments);_t(this,"type","ObjectLiteral")}},de=class extends D{constructor(ut,We,Je){super();_t(this,"type","BinaryExpression");this.operator=ut,this.left=We,this.right=Je}},ye=class extends D{constructor(ut,We){super();_t(this,"type","FilterExpression");this.operand=ut,this.filter=We}},_e=class extends g{constructor(ut,We){super();_t(this,"type","FilterStatement");this.filter=ut,this.body=We}},ue=class extends D{constructor(ut,We){super();_t(this,"type","SelectExpression");this.lhs=ut,this.test=We}},fe=class extends D{constructor(ut,We,Je){super();_t(this,"type","TestExpression");this.operand=ut,this.negate=We,this.test=Je}},De=class extends D{constructor(ut,We){super();_t(this,"type","UnaryExpression");this.operator=ut,this.argument=We}},pe=class extends D{constructor(ut=void 0,We=void 0,Je=void 0){super();_t(this,"type","SliceExpression");this.start=ut,this.stop=We,this.step=Je}},K=class extends D{constructor(ut,We){super();_t(this,"type","KeywordArgumentExpression");this.key=ut,this.value=We}},te=class extends D{constructor(ut){super();_t(this,"type","SpreadExpression");this.argument=ut}},ve=class extends g{constructor(ut,We,Je){super();_t(this,"type","CallStatement");this.call=ut,this.callerArgs=We,this.body=Je}},$e=class extends D{constructor(ut,We,Je){super();_t(this,"type","Ternary");this.condition=ut,this.trueExpr=We,this.falseExpr=Je}};function Ce(ge){const ut=new _([]);let We=0;function Je(Pr,Hr){const gn=ge[We++];if(!gn||gn.type!==Pr)throw new Error(`Parser Error: ${Hr}. ${gn.type} !== ${Pr}.`);return gn}function xt(Pr){if(!On(Pr))throw new SyntaxError(`Expected ${Pr}`);++We}function wt(){switch(ge[We].type){case n.Comment:return new C(ge[We++].value);case n.Text:return Mn();case n.OpenStatement:return _r();case n.OpenExpression:return Or();default:throw new SyntaxError(`Unexpected token type: ${ge[We].type}`)}}function pr(...Pr){return We+Pr.length<=ge.length&&Pr.every((Hr,gn)=>Hr===ge[We+gn].type)}function Rr(...Pr){var Hr,gn,Zi;return((Hr=ge[We])==null?void 0:Hr.type)===n.OpenStatement&&((gn=ge[We+1])==null?void 0:gn.type)===n.Identifier&&Pr.includes((Zi=ge[We+1])==null?void 0:Zi.value)}function On(...Pr){return We+Pr.length<=ge.length&&Pr.every((Hr,gn)=>ge[We+gn].type==="Identifier"&&Hr===ge[We+gn].value)}function Mn(){return new H(Je(n.Text,"Expected text token").value)}function _r(){if(Je(n.OpenStatement,"Expected opening statement token"),ge[We].type!==n.Identifier)throw new SyntaxError(`Unknown statement, got ${ge[We].type}`);const Pr=ge[We].value;let Hr;switch(Pr){case"set":++We,Hr=an();break;case"if":++We,Hr=Vn(),Je(n.OpenStatement,"Expected {% token"),xt("endif"),Je(n.CloseStatement,"Expected %} token");break;case"macro":++We,Hr=_o(),Je(n.OpenStatement,"Expected {% token"),xt("endmacro"),Je(n.CloseStatement,"Expected %} token");break;case"for":++We,Hr=yn(),Je(n.OpenStatement,"Expected {% token"),xt("endfor"),Je(n.CloseStatement,"Expected %} token");break;case"call":{++We;let gn=null;pr(n.OpenParen)&&(gn=is());const Zi=os();if(Zi.type!=="Identifier")throw new SyntaxError("Expected identifier following call statement");const dl=is();Je(n.CloseStatement,"Expected closing statement token");const ba=[];for(;!Rr("endcall");)ba.push(wt());Je(n.OpenStatement,"Expected '{%'"),xt("endcall"),Je(n.CloseStatement,"Expected closing statement token");const Ga=new N(Zi,dl);Hr=new ve(Ga,gn,ba);break}case"break":++We,Je(n.CloseStatement,"Expected closing statement token"),Hr=new x;break;case"continue":++We,Je(n.CloseStatement,"Expected closing statement token"),Hr=new E;break;case"filter":{++We;let gn=os();gn instanceof j&&pr(n.OpenParen)&&(gn=Qn(gn)),Je(n.CloseStatement,"Expected closing statement token");const Zi=[];for(;!Rr("endfilter");)Zi.push(wt());Je(n.OpenStatement,"Expected '{%'"),xt("endfilter"),Je(n.CloseStatement,"Expected '%}'"),Hr=new _e(gn,Zi);break}default:throw new SyntaxError(`Unknown statement type: ${Pr}`)}return Hr}function Or(){Je(n.OpenExpression,"Expected opening expression token");const Pr=Vo();return Je(n.CloseExpression,"Expected closing expression token"),Pr}function an(){const Pr=Uo();let Hr=null;const gn=[];if(pr(n.Equals))++We,Hr=Uo();else{for(Je(n.CloseStatement,"Expected %} token");!Rr("endset");)gn.push(wt());Je(n.OpenStatement,"Expected {% token"),xt("endset")}return Je(n.CloseStatement,"Expected closing statement token"),new T(Pr,Hr,gn)}function Vn(){const Pr=Vo();Je(n.CloseStatement,"Expected closing statement token");const Hr=[],gn=[];for(;!Rr("elif","else","endif");)Hr.push(wt());if(Rr("elif")){++We,++We;const Zi=Vn();gn.push(Zi)}else if(Rr("else"))for(++We,++We,Je(n.CloseStatement,"Expected closing statement token");!Rr("endif");)gn.push(wt());return new y(Pr,Hr,gn)}function _o(){const Pr=os();if(Pr.type!=="Identifier")throw new SyntaxError("Expected identifier following macro statement");const Hr=is();Je(n.CloseStatement,"Expected closing statement token");const gn=[];for(;!Rr("endmacro");)gn.push(wt());return new P(Pr,Hr,gn)}function Uo(Pr=!1){const Hr=Pr?os:Vo,gn=[Hr()],Zi=pr(n.Comma);for(;Zi&&(++We,gn.push(Hr()),!!pr(n.Comma)););return Zi?new ee(gn):gn[0]}function yn(){const Pr=Uo(!0);if(!(Pr instanceof j||Pr instanceof ee))throw new SyntaxError(`Expected identifier/tuple for the loop variable, got ${Pr.type} instead`);if(!On("in"))throw new SyntaxError("Expected `in` keyword following loop variable");++We;const Hr=Vo();Je(n.CloseStatement,"Expected closing statement token");const gn=[];for(;!Rr("endfor","else");)gn.push(wt());const Zi=[];if(Rr("else"))for(++We,++We,Je(n.CloseStatement,"Expected closing statement token");!Rr("endfor");)Zi.push(wt());return new M(Pr,Hr,gn,Zi)}function Vo(){return Po()}function Po(){const Pr=pa();if(On("if")){++We;const Hr=pa();if(On("else")){++We;const gn=Po();return new $e(Hr,Pr,gn)}else return new ue(Pr,Hr)}return Pr}function pa(){let Pr=ta();for(;On("or");){const Hr=ge[We];++We;const gn=ta();Pr=new de(Hr,Pr,gn)}return Pr}function ta(){let Pr=ra();for(;On("and");){const Hr=ge[We];++We;const gn=ra();Pr=new de(Hr,Pr,gn)}return Pr}function ra(){let Pr;for(;On("not");){const Hr=ge[We];++We;const gn=ra();Pr=new De(Hr,gn)}return Pr??so()}function so(){let Pr=Xs();for(;;){let Hr;if(On("not","in"))Hr=new i("not in",n.Identifier),We+=2;else if(On("in"))Hr=ge[We++];else if(pr(n.ComparisonBinaryOperator))Hr=ge[We++];else break;const gn=Xs();Pr=new de(Hr,Pr,gn)}return Pr}function Xs(){let Pr=Eo();for(;pr(n.AdditiveBinaryOperator);){const Hr=ge[We];++We;const gn=Eo();Pr=new de(Hr,Pr,gn)}return Pr}function xo(){const Pr=wo(os());return pr(n.OpenParen)?Qn(Pr):Pr}function Qn(Pr){let Hr=new N(Pr,is());return Hr=wo(Hr),pr(n.OpenParen)&&(Hr=Qn(Hr)),Hr}function is(){Je(n.OpenParen,"Expected opening parenthesis for arguments list");const Pr=la();return Je(n.CloseParen,"Expected closing parenthesis for arguments list"),Pr}function la(){const Pr=[];for(;!pr(n.CloseParen);){let Hr;if(ge[We].type===n.MultiplicativeBinaryOperator&&ge[We].value==="*"){++We;const gn=Vo();Hr=new te(gn)}else if(Hr=Vo(),pr(n.Equals)){if(++We,!(Hr instanceof j))throw new SyntaxError("Expected identifier for keyword argument");const gn=Vo();Hr=new K(Hr,gn)}Pr.push(Hr),pr(n.Comma)&&++We}return Pr}function $s(){const Pr=[];let Hr=!1;for(;!pr(n.CloseSquareBracket);)pr(n.Colon)?(Pr.push(void 0),++We,Hr=!0):(Pr.push(Vo()),pr(n.Colon)&&(++We,Hr=!0));if(Pr.length===0)throw new SyntaxError("Expected at least one argument for member/slice expression");if(Hr){if(Pr.length>3)throw new SyntaxError("Expected 0-3 arguments for slice expression");return new pe(...Pr)}return Pr[0]}function wo(Pr){for(;pr(n.Dot)||pr(n.OpenSquareBracket);){const Hr=ge[We];++We;let gn;const Zi=Hr.type===n.OpenSquareBracket;if(Zi)gn=$s(),Je(n.CloseSquareBracket,"Expected closing square bracket");else if(gn=os(),gn.type!=="Identifier")throw new SyntaxError("Expected identifier following dot operator");Pr=new L(Pr,gn,Zi)}return Pr}function Eo(){let Pr=Wa();for(;pr(n.MultiplicativeBinaryOperator);){const Hr=ge[We++],gn=Wa();Pr=new de(Hr,Pr,gn)}return Pr}function Wa(){let Pr=ul();for(;On("is");){++We;const Hr=On("not");Hr&&++We;const gn=os();if(!(gn instanceof j))throw new SyntaxError("Expected identifier for the test");Pr=new fe(Pr,Hr,gn)}return Pr}function ul(){let Pr=xo();for(;pr(n.Pipe);){++We;let Hr=os();if(!(Hr instanceof j))throw new SyntaxError("Expected identifier for the filter");pr(n.OpenParen)&&(Hr=Qn(Hr)),Pr=new ye(Pr,Hr)}return Pr}function os(){const Pr=ge[We++];switch(Pr.type){case n.NumericLiteral:{const Hr=Pr.value;return Hr.includes(".")?new G(Number(Hr)):new U(Number(Hr))}case n.StringLiteral:{let Hr=Pr.value;for(;pr(n.StringLiteral);)Hr+=ge[We++].value;return new H(Hr)}case n.Identifier:return new j(Pr.value);case n.OpenParen:{const Hr=Uo();return Je(n.CloseParen,"Expected closing parenthesis, got ${tokens[current].type} instead."),Hr}case n.OpenSquareBracket:{const Hr=[];for(;!pr(n.CloseSquareBracket);)Hr.push(Vo()),pr(n.Comma)&&++We;return++We,new X(Hr)}case n.OpenCurlyBracket:{const Hr=new Map;for(;!pr(n.CloseCurlyBracket);){const gn=Vo();Je(n.Colon,"Expected colon between key and value in object literal");const Zi=Vo();Hr.set(gn,Zi),pr(n.Comma)&&++We}return++We,new ae(Hr)}default:throw new SyntaxError(`Unexpected token: ${Pr.type}`)}}for(;We<ge.length;)ut.body.push(wt());return ut}function Ge(ge,ut,We=1){ut===void 0&&(ut=ge,ge=0);const Je=[];for(let xt=ge;xt<ut;xt+=We)Je.push(xt);return Je}function ot(ge,ut,We,Je=1){const xt=Math.sign(Je);xt>=0?(ut=(ut??(ut=0))<0?Math.max(ge.length+ut,0):Math.min(ut,ge.length),We=(We??(We=ge.length))<0?Math.max(ge.length+We,0):Math.min(We,ge.length)):(ut=(ut??(ut=ge.length-1))<0?Math.max(ge.length+ut,-1):Math.min(ut,ge.length-1),We=(We??(We=-1))<-1?Math.max(ge.length+We,-1):Math.min(We,ge.length-1));const wt=[];for(let pr=ut;xt*pr<xt*We;pr+=Je)wt.push(ge[pr]);return wt}function Ye(ge){return ge.replace(/\b\w/g,ut=>ut.toUpperCase())}function et(ge){return Te(new Date,ge)}function Te(ge,ut){const We=new Intl.DateTimeFormat(void 0,{month:"long"}),Je=new Intl.DateTimeFormat(void 0,{month:"short"}),xt=wt=>wt<10?"0"+wt:wt.toString();return ut.replace(/%[YmdbBHM%]/g,wt=>{switch(wt){case"%Y":return ge.getFullYear().toString();case"%m":return xt(ge.getMonth()+1);case"%d":return xt(ge.getDate());case"%b":return Je.format(ge);case"%B":return We.format(ge);case"%H":return xt(ge.getHours());case"%M":return xt(ge.getMinutes());case"%%":return"%";default:return wt}})}function Le(ge){return ge.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ke(ge,ut,We,Je){if(Je===0)return ge;let xt=Je==null||Je<0?1/0:Je;const wt=ut.length===0?new RegExp("(?=)","gu"):new RegExp(Le(ut),"gu");return ge.replaceAll(wt,pr=>xt>0?(--xt,We):pr)}var Xe=class extends Error{},Ne=class extends Error{},Ot=class{constructor(ge=void 0){_t(this,"type","RuntimeValue");_t(this,"value");_t(this,"builtins",new Map);this.value=ge}__bool__(){return new Zt(!!this.value)}toString(){return String(this.value)}},Lt=class extends Ot{constructor(){super(...arguments);_t(this,"type","IntegerValue")}},kt=class extends Ot{constructor(){super(...arguments);_t(this,"type","FloatValue")}toString(){return this.value%1===0?this.value.toFixed(1):this.value.toString()}},mt=class extends Ot{constructor(){super(...arguments);_t(this,"type","StringValue");_t(this,"builtins",new Map([["upper",new mr(()=>new mt(this.value.toUpperCase()))],["lower",new mr(()=>new mt(this.value.toLowerCase()))],["strip",new mr(()=>new mt(this.value.trim()))],["title",new mr(()=>new mt(Ye(this.value)))],["capitalize",new mr(()=>new mt(this.value.charAt(0).toUpperCase()+this.value.slice(1)))],["length",new Lt(this.value.length)],["rstrip",new mr(()=>new mt(this.value.trimEnd()))],["lstrip",new mr(()=>new mt(this.value.trimStart()))],["startswith",new mr(ut=>{if(ut.length===0)throw new Error("startswith() requires at least one argument");const We=ut[0];if(We instanceof mt)return new Zt(this.value.startsWith(We.value));if(We instanceof Bt){for(const Je of We.value){if(!(Je instanceof mt))throw new Error("startswith() tuple elements must be strings");if(this.value.startsWith(Je.value))return new Zt(!0)}return new Zt(!1)}throw new Error("startswith() argument must be a string or tuple of strings")})],["endswith",new mr(ut=>{if(ut.length===0)throw new Error("endswith() requires at least one argument");const We=ut[0];if(We instanceof mt)return new Zt(this.value.endsWith(We.value));if(We instanceof Bt){for(const Je of We.value){if(!(Je instanceof mt))throw new Error("endswith() tuple elements must be strings");if(this.value.endsWith(Je.value))return new Zt(!0)}return new Zt(!1)}throw new Error("endswith() argument must be a string or tuple of strings")})],["split",new mr(ut=>{const We=ut[0]??new hr;if(!(We instanceof mt||We instanceof hr))throw new Error("sep argument must be a string or null");const Je=ut[1]??new Lt(-1);if(!(Je instanceof Lt))throw new Error("maxsplit argument must be a number");let xt=[];if(We instanceof hr){const wt=this.value.trimStart();for(const{0:pr,index:Rr}of wt.matchAll(/\S+/g)){if(Je.value!==-1&&xt.length>=Je.value&&Rr!==void 0){xt.push(pr+wt.slice(Rr+pr.length));break}xt.push(pr)}}else{if(We.value==="")throw new Error("empty separator");xt=this.value.split(We.value),Je.value!==-1&&xt.length>Je.value&&xt.push(xt.splice(Je.value).join(We.value))}return new Bt(xt.map(wt=>new mt(wt)))})],["replace",new mr(ut=>{if(ut.length<2)throw new Error("replace() requires at least two arguments");const We=ut[0],Je=ut[1];if(!(We instanceof mt&&Je instanceof mt))throw new Error("replace() arguments must be strings");let xt;if(ut.length>2?ut[2].type==="KeywordArgumentsValue"?xt=ut[2].value.get("count")??new hr:xt=ut[2]:xt=new hr,!(xt instanceof Lt||xt instanceof hr))throw new Error("replace() count argument must be a number or null");return new mt(ke(this.value,We.value,Je.value,xt.value))})]]))}},Zt=class extends Ot{constructor(){super(...arguments);_t(this,"type","BooleanValue")}},Kt=class extends Ot{constructor(){super(...arguments);_t(this,"type","ObjectValue");_t(this,"builtins",new Map([["get",new mr(([ut,We])=>{if(!(ut instanceof mt))throw new Error(`Object key must be a string: got ${ut.type}`);return this.value.get(ut.value)??We??new hr})],["items",new mr(()=>this.items())],["keys",new mr(()=>this.keys())],["values",new mr(()=>this.values())]]))}__bool__(){return new Zt(this.value.size>0)}items(){return new Bt(Array.from(this.value.entries()).map(([ut,We])=>new Bt([new mt(ut),We])))}keys(){return new Bt(Array.from(this.value.keys()).map(ut=>new mt(ut)))}values(){return new Bt(Array.from(this.value.values()))}},dr=class extends Kt{constructor(){super(...arguments);_t(this,"type","KeywordArgumentsValue")}},Bt=class extends Ot{constructor(){super(...arguments);_t(this,"type","ArrayValue");_t(this,"builtins",new Map([["length",new Lt(this.value.length)]]))}__bool__(){return new Zt(this.value.length>0)}},wr=class extends Bt{constructor(){super(...arguments);_t(this,"type","TupleValue")}},mr=class extends Ot{constructor(){super(...arguments);_t(this,"type","FunctionValue")}},hr=class extends Ot{constructor(){super(...arguments);_t(this,"type","NullValue")}},xr=class extends Ot{constructor(){super(...arguments);_t(this,"type","UndefinedValue")}},or=class{constructor(ge){_t(this,"variables",new Map([["namespace",new mr(ge=>{if(ge.length===0)return new Kt(new Map);if(ge.length!==1||!(ge[0]instanceof Kt))throw new Error("`namespace` expects either zero arguments or a single object argument");return ge[0]})]]));_t(this,"tests",new Map([["boolean",ge=>ge.type==="BooleanValue"],["callable",ge=>ge instanceof mr],["odd",ge=>{if(!(ge instanceof Lt))throw new Error(`cannot odd on ${ge.type}`);return ge.value%2!==0}],["even",ge=>{if(!(ge instanceof Lt))throw new Error(`cannot even on ${ge.type}`);return ge.value%2===0}],["false",ge=>ge.type==="BooleanValue"&&!ge.value],["true",ge=>ge.type==="BooleanValue"&&ge.value],["none",ge=>ge.type==="NullValue"],["string",ge=>ge.type==="StringValue"],["number",ge=>ge instanceof Lt||ge instanceof kt],["integer",ge=>ge instanceof Lt],["iterable",ge=>ge.type==="ArrayValue"||ge.type==="StringValue"],["mapping",ge=>ge.type==="ObjectValue"],["lower",ge=>{const ut=ge.value;return ge.type==="StringValue"&&ut===ut.toLowerCase()}],["upper",ge=>{const ut=ge.value;return ge.type==="StringValue"&&ut===ut.toUpperCase()}],["none",ge=>ge.type==="NullValue"],["defined",ge=>ge.type!=="UndefinedValue"],["undefined",ge=>ge.type==="UndefinedValue"],["equalto",(ge,ut)=>ge.value===ut.value],["eq",(ge,ut)=>ge.value===ut.value]]));this.parent=ge}set(ge,ut){return this.declareVariable(ge,Pe(ut))}declareVariable(ge,ut){if(this.variables.has(ge))throw new SyntaxError(`Variable already declared: ${ge}`);return this.variables.set(ge,ut),ut}setVariable(ge,ut){return this.variables.set(ge,ut),ut}resolve(ge){if(this.variables.has(ge))return this;if(this.parent)return this.parent.resolve(ge);throw new Error(`Unknown variable: ${ge}`)}lookupVariable(ge){try{return this.resolve(ge).variables.get(ge)??new xr}catch{return new xr}}};function tt(ge){ge.set("false",!1),ge.set("true",!0),ge.set("none",null),ge.set("raise_exception",ut=>{throw new Error(ut)}),ge.set("range",Ge),ge.set("strftime_now",et),ge.set("True",!0),ge.set("False",!1),ge.set("None",null)}var Se=class{constructor(ge){_t(this,"global");this.global=ge??new or}run(ge){return this.evaluate(ge,this.global)}evaluateBinaryExpression(ge,ut){const We=this.evaluate(ge.left,ut);switch(ge.operator.value){case"and":return We.__bool__().value?this.evaluate(ge.right,ut):We;case"or":return We.__bool__().value?We:this.evaluate(ge.right,ut)}const Je=this.evaluate(ge.right,ut);switch(ge.operator.value){case"==":return new Zt(We.value==Je.value);case"!=":return new Zt(We.value!=Je.value)}if(We instanceof xr||Je instanceof xr){if(Je instanceof xr&&["in","not in"].includes(ge.operator.value))return new Zt(ge.operator.value==="not in");throw new Error(`Cannot perform operation ${ge.operator.value} on undefined values`)}else{if(We instanceof hr||Je instanceof hr)throw new Error("Cannot perform operation on null values");if(ge.operator.value==="~")return new mt(We.value.toString()+Je.value.toString());if((We instanceof Lt||We instanceof kt)&&(Je instanceof Lt||Je instanceof kt)){const xt=We.value,wt=Je.value;switch(ge.operator.value){case"+":case"-":case"*":{const pr=ge.operator.value==="+"?xt+wt:ge.operator.value==="-"?xt-wt:xt*wt;return We instanceof kt||Je instanceof kt?new kt(pr):new Lt(pr)}case"/":return new kt(xt/wt);case"%":{const pr=xt%wt;return We instanceof kt||Je instanceof kt?new kt(pr):new Lt(pr)}case"<":return new Zt(xt<wt);case">":return new Zt(xt>wt);case">=":return new Zt(xt>=wt);case"<=":return new Zt(xt<=wt)}}else if(We instanceof Bt&&Je instanceof Bt)switch(ge.operator.value){case"+":return new Bt(We.value.concat(Je.value))}else if(Je instanceof Bt){const xt=Je.value.find(wt=>wt.value===We.value)!==void 0;switch(ge.operator.value){case"in":return new Zt(xt);case"not in":return new Zt(!xt)}}}if(We instanceof mt||Je instanceof mt)switch(ge.operator.value){case"+":return new mt(We.value.toString()+Je.value.toString())}if(We instanceof mt&&Je instanceof mt)switch(ge.operator.value){case"in":return new Zt(Je.value.includes(We.value));case"not in":return new Zt(!Je.value.includes(We.value))}if(We instanceof mt&&Je instanceof Kt)switch(ge.operator.value){case"in":return new Zt(Je.value.has(We.value));case"not in":return new Zt(!Je.value.has(We.value))}throw new SyntaxError(`Unknown operator "${ge.operator.value}" between ${We.type} and ${Je.type}`)}evaluateArguments(ge,ut){const We=[],Je=new Map;for(const xt of ge)if(xt.type==="SpreadExpression"){const wt=xt,pr=this.evaluate(wt.argument,ut);if(!(pr instanceof Bt))throw new Error(`Cannot unpack non-iterable type: ${pr.type}`);for(const Rr of pr.value)We.push(Rr)}else if(xt.type==="KeywordArgumentExpression"){const wt=xt;Je.set(wt.key.value,this.evaluate(wt.value,ut))}else{if(Je.size>0)throw new Error("Positional arguments must come before keyword arguments");We.push(this.evaluate(xt,ut))}return[We,Je]}applyFilter(ge,ut,We){if(ut.type==="Identifier"){const Je=ut;if(Je.value==="tojson")return new mt(Ve(ge));if(ge instanceof Bt)switch(Je.value){case"list":return ge;case"first":return ge.value[0];case"last":return ge.value[ge.value.length-1];case"length":return new Lt(ge.value.length);case"reverse":return new Bt(ge.value.reverse());case"sort":return new Bt(ge.value.sort((xt,wt)=>{if(xt.type!==wt.type)throw new Error(`Cannot compare different types: ${xt.type} and ${wt.type}`);switch(xt.type){case"IntegerValue":case"FloatValue":return xt.value-wt.value;case"StringValue":return xt.value.localeCompare(wt.value);default:throw new Error(`Cannot compare type: ${xt.type}`)}}));case"join":return new mt(ge.value.map(xt=>xt.value).join(""));case"string":return new mt(Ve(ge));case"unique":{const xt=new Set,wt=[];for(const pr of ge.value)xt.has(pr.value)||(xt.add(pr.value),wt.push(pr));return new Bt(wt)}default:throw new Error(`Unknown ArrayValue filter: ${Je.value}`)}else if(ge instanceof mt)switch(Je.value){case"length":case"upper":case"lower":case"title":case"capitalize":{const xt=ge.builtins.get(Je.value);if(xt instanceof mr)return xt.value([],We);if(xt instanceof Lt)return xt;throw new Error(`Unknown StringValue filter: ${Je.value}`)}case"trim":return new mt(ge.value.trim());case"indent":return new mt(ge.value.split(`
`).map((xt,wt)=>wt===0||xt.length===0?xt:"    "+xt).join(`
`));case"join":case"string":return ge;case"int":{const xt=parseInt(ge.value,10);return new Lt(isNaN(xt)?0:xt)}case"float":{const xt=parseFloat(ge.value);return new kt(isNaN(xt)?0:xt)}default:throw new Error(`Unknown StringValue filter: ${Je.value}`)}else if(ge instanceof Lt||ge instanceof kt)switch(Je.value){case"abs":return ge instanceof Lt?new Lt(Math.abs(ge.value)):new kt(Math.abs(ge.value));case"int":return new Lt(Math.floor(ge.value));case"float":return new kt(ge.value);default:throw new Error(`Unknown NumericValue filter: ${Je.value}`)}else if(ge instanceof Kt)switch(Je.value){case"items":return new Bt(Array.from(ge.value.entries()).map(([xt,wt])=>new Bt([new mt(xt),wt])));case"length":return new Lt(ge.value.size);default:throw new Error(`Unknown ObjectValue filter: ${Je.value}`)}else if(ge instanceof Zt)switch(Je.value){case"bool":return new Zt(ge.value);case"int":return new Lt(ge.value?1:0);case"float":return new kt(ge.value?1:0);case"string":return new mt(ge.value?"true":"false");default:throw new Error(`Unknown BooleanValue filter: ${Je.value}`)}throw new Error(`Cannot apply filter "${Je.value}" to type: ${ge.type}`)}else if(ut.type==="CallExpression"){const Je=ut;if(Je.callee.type!=="Identifier")throw new Error(`Unknown filter: ${Je.callee.type}`);const xt=Je.callee.value;if(xt==="tojson"){const[,wt]=this.evaluateArguments(Je.args,We),pr=wt.get("indent")??new hr;if(!(pr instanceof Lt||pr instanceof hr))throw new Error("If set, indent must be a number");return new mt(Ve(ge,pr.value))}else if(xt==="join"){let wt;if(ge instanceof mt)wt=Array.from(ge.value);else if(ge instanceof Bt)wt=ge.value.map(Mn=>Mn.value);else throw new Error(`Cannot apply filter "${xt}" to type: ${ge.type}`);const[pr,Rr]=this.evaluateArguments(Je.args,We),On=pr.at(0)??Rr.get("separator")??new mt("");if(!(On instanceof mt))throw new Error("separator must be a string");return new mt(wt.join(On.value))}else if(xt==="int"||xt==="float"){const[wt,pr]=this.evaluateArguments(Je.args,We),Rr=wt.at(0)??pr.get("default")??(xt==="int"?new Lt(0):new kt(0));if(ge instanceof mt){const On=xt==="int"?parseInt(ge.value,10):parseFloat(ge.value);return isNaN(On)?Rr:xt==="int"?new Lt(On):new kt(On)}else{if(ge instanceof Lt||ge instanceof kt)return ge;if(ge instanceof Zt)return xt==="int"?new Lt(ge.value?1:0):new kt(ge.value?1:0);throw new Error(`Cannot apply filter "${xt}" to type: ${ge.type}`)}}else if(xt==="default"){const[wt,pr]=this.evaluateArguments(Je.args,We),Rr=wt[0]??new mt(""),On=wt[1]??pr.get("boolean")??new Zt(!1);if(!(On instanceof Zt))throw new Error("`default` filter flag must be a boolean");return ge instanceof xr||On.value&&!ge.__bool__().value?Rr:ge}if(ge instanceof Bt){switch(xt){case"selectattr":case"rejectattr":{const wt=xt==="selectattr";if(ge.value.some(Or=>!(Or instanceof Kt)))throw new Error(`\`${xt}\` can only be applied to array of objects`);if(Je.args.some(Or=>Or.type!=="StringLiteral"))throw new Error(`arguments of \`${xt}\` must be strings`);const[pr,Rr,On]=Je.args.map(Or=>this.evaluate(Or,We));let Mn;if(Rr){const Or=We.tests.get(Rr.value);if(!Or)throw new Error(`Unknown test: ${Rr.value}`);Mn=Or}else Mn=(...Or)=>Or[0].__bool__().value;const _r=ge.value.filter(Or=>{const an=Or.value.get(pr.value),Vn=an?Mn(an,On):!1;return wt?Vn:!Vn});return new Bt(_r)}case"map":{const[,wt]=this.evaluateArguments(Je.args,We);if(wt.has("attribute")){const pr=wt.get("attribute");if(!(pr instanceof mt))throw new Error("attribute must be a string");const Rr=wt.get("default"),On=ge.value.map(Mn=>{if(!(Mn instanceof Kt))throw new Error("items in map must be an object");return Mn.value.get(pr.value)??Rr??new xr});return new Bt(On)}else throw new Error("`map` expressions without `attribute` set are not currently supported.")}}throw new Error(`Unknown ArrayValue filter: ${xt}`)}else if(ge instanceof mt){switch(xt){case"indent":{const[wt,pr]=this.evaluateArguments(Je.args,We),Rr=wt.at(0)??pr.get("width")??new Lt(4);if(!(Rr instanceof Lt))throw new Error("width must be a number");const On=wt.at(1)??pr.get("first")??new Zt(!1),Mn=wt.at(2)??pr.get("blank")??new Zt(!1),_r=ge.value.split(`
`),Or=" ".repeat(Rr.value),an=_r.map((Vn,_o)=>!On.value&&_o===0||!Mn.value&&Vn.length===0?Vn:Or+Vn);return new mt(an.join(`
`))}case"replace":{const wt=ge.builtins.get("replace");if(!(wt instanceof mr))throw new Error("replace filter not available");const[pr,Rr]=this.evaluateArguments(Je.args,We);return wt.value([...pr,new dr(Rr)],We)}}throw new Error(`Unknown StringValue filter: ${xt}`)}else throw new Error(`Cannot apply filter "${xt}" to type: ${ge.type}`)}throw new Error(`Unknown filter: ${ut.type}`)}evaluateFilterExpression(ge,ut){const We=this.evaluate(ge.operand,ut);return this.applyFilter(We,ge.filter,ut)}evaluateTestExpression(ge,ut){const We=this.evaluate(ge.operand,ut),Je=ut.tests.get(ge.test.value);if(!Je)throw new Error(`Unknown test: ${ge.test.value}`);const xt=Je(We);return new Zt(ge.negate?!xt:xt)}evaluateSelectExpression(ge,ut){return this.evaluate(ge.test,ut).__bool__().value?this.evaluate(ge.lhs,ut):new xr}evaluateUnaryExpression(ge,ut){const We=this.evaluate(ge.argument,ut);switch(ge.operator.value){case"not":return new Zt(!We.value);default:throw new SyntaxError(`Unknown operator: ${ge.operator.value}`)}}evaluateTernaryExpression(ge,ut){return this.evaluate(ge.condition,ut).__bool__().value?this.evaluate(ge.trueExpr,ut):this.evaluate(ge.falseExpr,ut)}evalProgram(ge,ut){return this.evaluateBlock(ge.body,ut)}evaluateBlock(ge,ut){let We="";for(const Je of ge){const xt=this.evaluate(Je,ut);xt.type!=="NullValue"&&xt.type!=="UndefinedValue"&&(We+=xt.toString())}return new mt(We)}evaluateIdentifier(ge,ut){return ut.lookupVariable(ge.value)}evaluateCallExpression(ge,ut){const[We,Je]=this.evaluateArguments(ge.args,ut);Je.size>0&&We.push(new dr(Je));const xt=this.evaluate(ge.callee,ut);if(xt.type!=="FunctionValue")throw new Error(`Cannot call something that is not a function: got ${xt.type}`);return xt.value(We,ut)}evaluateSliceExpression(ge,ut,We){if(!(ge instanceof Bt||ge instanceof mt))throw new Error("Slice object must be an array or string");const Je=this.evaluate(ut.start,We),xt=this.evaluate(ut.stop,We),wt=this.evaluate(ut.step,We);if(!(Je instanceof Lt||Je instanceof xr))throw new Error("Slice start must be numeric or undefined");if(!(xt instanceof Lt||xt instanceof xr))throw new Error("Slice stop must be numeric or undefined");if(!(wt instanceof Lt||wt instanceof xr))throw new Error("Slice step must be numeric or undefined");return ge instanceof Bt?new Bt(ot(ge.value,Je.value,xt.value,wt.value)):new mt(ot(Array.from(ge.value),Je.value,xt.value,wt.value).join(""))}evaluateMemberExpression(ge,ut){const We=this.evaluate(ge.object,ut);let Je;if(ge.computed){if(ge.property.type==="SliceExpression")return this.evaluateSliceExpression(We,ge.property,ut);Je=this.evaluate(ge.property,ut)}else Je=new mt(ge.property.value);let xt;if(We instanceof Kt){if(!(Je instanceof mt))throw new Error(`Cannot access property with non-string: got ${Je.type}`);xt=We.value.get(Je.value)??We.builtins.get(Je.value)}else if(We instanceof Bt||We instanceof mt)if(Je instanceof Lt)xt=We.value.at(Je.value),We instanceof mt&&(xt=new mt(We.value.at(Je.value)));else if(Je instanceof mt)xt=We.builtins.get(Je.value);else throw new Error(`Cannot access property with non-string/non-number: got ${Je.type}`);else{if(!(Je instanceof mt))throw new Error(`Cannot access property with non-string: got ${Je.type}`);xt=We.builtins.get(Je.value)}return xt instanceof Ot?xt:new xr}evaluateSet(ge,ut){const We=ge.value?this.evaluate(ge.value,ut):this.evaluateBlock(ge.body,ut);if(ge.assignee.type==="Identifier"){const Je=ge.assignee.value;ut.setVariable(Je,We)}else if(ge.assignee.type==="TupleLiteral"){const Je=ge.assignee;if(!(We instanceof Bt))throw new Error(`Cannot unpack non-iterable type in set: ${We.type}`);const xt=We.value;if(xt.length!==Je.value.length)throw new Error(`Too ${Je.value.length>xt.length?"few":"many"} items to unpack in set`);for(let wt=0;wt<Je.value.length;++wt){const pr=Je.value[wt];if(pr.type!=="Identifier")throw new Error(`Cannot unpack to non-identifier in set: ${pr.type}`);ut.setVariable(pr.value,xt[wt])}}else if(ge.assignee.type==="MemberExpression"){const Je=ge.assignee,xt=this.evaluate(Je.object,ut);if(!(xt instanceof Kt))throw new Error("Cannot assign to member of non-object");if(Je.property.type!=="Identifier")throw new Error("Cannot assign to member with non-identifier property");xt.value.set(Je.property.value,We)}else throw new Error(`Invalid LHS inside assignment expression: ${JSON.stringify(ge.assignee)}`);return new hr}evaluateIf(ge,ut){const We=this.evaluate(ge.test,ut);return this.evaluateBlock(We.__bool__().value?ge.body:ge.alternate,ut)}evaluateFor(ge,ut){const We=new or(ut);let Je,xt;if(ge.iterable.type==="SelectExpression"){const Mn=ge.iterable;xt=this.evaluate(Mn.lhs,We),Je=Mn.test}else xt=this.evaluate(ge.iterable,We);if(!(xt instanceof Bt||xt instanceof Kt))throw new Error(`Expected iterable or object type in for loop: got ${xt.type}`);xt instanceof Kt&&(xt=xt.keys());const wt=[],pr=[];for(let Mn=0;Mn<xt.value.length;++Mn){const _r=new or(We),Or=xt.value[Mn];let an;if(ge.loopvar.type==="Identifier")an=Vn=>Vn.setVariable(ge.loopvar.value,Or);else if(ge.loopvar.type==="TupleLiteral"){const Vn=ge.loopvar;if(Or.type!=="ArrayValue")throw new Error(`Cannot unpack non-iterable type: ${Or.type}`);const _o=Or;if(Vn.value.length!==_o.value.length)throw new Error(`Too ${Vn.value.length>_o.value.length?"few":"many"} items to unpack`);an=Uo=>{for(let yn=0;yn<Vn.value.length;++yn){if(Vn.value[yn].type!=="Identifier")throw new Error(`Cannot unpack non-identifier type: ${Vn.value[yn].type}`);Uo.setVariable(Vn.value[yn].value,_o.value[yn])}}}else throw new Error(`Invalid loop variable(s): ${ge.loopvar.type}`);Je&&(an(_r),!this.evaluate(Je,_r).__bool__().value)||(wt.push(Or),pr.push(an))}let Rr="",On=!0;for(let Mn=0;Mn<wt.length;++Mn){const _r=new Map([["index",new Lt(Mn+1)],["index0",new Lt(Mn)],["revindex",new Lt(wt.length-Mn)],["revindex0",new Lt(wt.length-Mn-1)],["first",new Zt(Mn===0)],["last",new Zt(Mn===wt.length-1)],["length",new Lt(wt.length)],["previtem",Mn>0?wt[Mn-1]:new xr],["nextitem",Mn<wt.length-1?wt[Mn+1]:new xr]]);We.setVariable("loop",new Kt(_r)),pr[Mn](We);try{const Or=this.evaluateBlock(ge.body,We);Rr+=Or.value}catch(Or){if(Or instanceof Ne)continue;if(Or instanceof Xe)break;throw Or}On=!1}if(On){const Mn=this.evaluateBlock(ge.defaultBlock,We);Rr+=Mn.value}return new mt(Rr)}evaluateMacro(ge,ut){return ut.setVariable(ge.name.value,new mr((We,Je)=>{var pr;const xt=new or(Je);We=We.slice();let wt;((pr=We.at(-1))==null?void 0:pr.type)==="KeywordArgumentsValue"&&(wt=We.pop());for(let Rr=0;Rr<ge.args.length;++Rr){const On=ge.args[Rr],Mn=We[Rr];if(On.type==="Identifier"){const _r=On;if(!Mn)throw new Error(`Missing positional argument: ${_r.value}`);xt.setVariable(_r.value,Mn)}else if(On.type==="KeywordArgumentExpression"){const _r=On,Or=Mn??(wt==null?void 0:wt.value.get(_r.key.value))??this.evaluate(_r.value,xt);xt.setVariable(_r.key.value,Or)}else throw new Error(`Unknown argument type: ${On.type}`)}return this.evaluateBlock(ge.body,xt)})),new hr}evaluateCallStatement(ge,ut){const We=new mr((Rr,On)=>{const Mn=new or(On);if(ge.callerArgs)for(let _r=0;_r<ge.callerArgs.length;++_r){const Or=ge.callerArgs[_r];if(Or.type!=="Identifier")throw new Error(`Caller parameter must be an identifier, got ${Or.type}`);Mn.setVariable(Or.value,Rr[_r]??new xr)}return this.evaluateBlock(ge.body,Mn)}),[Je,xt]=this.evaluateArguments(ge.call.args,ut);Je.push(new dr(xt));const wt=this.evaluate(ge.call.callee,ut);if(wt.type!=="FunctionValue")throw new Error(`Cannot call something that is not a function: got ${wt.type}`);const pr=new or(ut);return pr.setVariable("caller",We),wt.value(Je,pr)}evaluateFilterStatement(ge,ut){const We=this.evaluateBlock(ge.body,ut);return this.applyFilter(We,ge.filter,ut)}evaluate(ge,ut){if(!ge)return new xr;switch(ge.type){case"Program":return this.evalProgram(ge,ut);case"Set":return this.evaluateSet(ge,ut);case"If":return this.evaluateIf(ge,ut);case"For":return this.evaluateFor(ge,ut);case"Macro":return this.evaluateMacro(ge,ut);case"CallStatement":return this.evaluateCallStatement(ge,ut);case"Break":throw new Xe;case"Continue":throw new Ne;case"IntegerLiteral":return new Lt(ge.value);case"FloatLiteral":return new kt(ge.value);case"StringLiteral":return new mt(ge.value);case"ArrayLiteral":return new Bt(ge.value.map(We=>this.evaluate(We,ut)));case"TupleLiteral":return new wr(ge.value.map(We=>this.evaluate(We,ut)));case"ObjectLiteral":{const We=new Map;for(const[Je,xt]of ge.value){const wt=this.evaluate(Je,ut);if(!(wt instanceof mt))throw new Error(`Object keys must be strings: got ${wt.type}`);We.set(wt.value,this.evaluate(xt,ut))}return new Kt(We)}case"Identifier":return this.evaluateIdentifier(ge,ut);case"CallExpression":return this.evaluateCallExpression(ge,ut);case"MemberExpression":return this.evaluateMemberExpression(ge,ut);case"UnaryExpression":return this.evaluateUnaryExpression(ge,ut);case"BinaryExpression":return this.evaluateBinaryExpression(ge,ut);case"FilterExpression":return this.evaluateFilterExpression(ge,ut);case"FilterStatement":return this.evaluateFilterStatement(ge,ut);case"TestExpression":return this.evaluateTestExpression(ge,ut);case"SelectExpression":return this.evaluateSelectExpression(ge,ut);case"Ternary":return this.evaluateTernaryExpression(ge,ut);case"Comment":return new hr;default:throw new SyntaxError(`Unknown node type: ${ge.type}`)}}};function Pe(ge){switch(typeof ge){case"number":return Number.isInteger(ge)?new Lt(ge):new kt(ge);case"string":return new mt(ge);case"boolean":return new Zt(ge);case"undefined":return new xr;case"object":return ge===null?new hr:Array.isArray(ge)?new Bt(ge.map(Pe)):new Kt(new Map(Object.entries(ge).map(([ut,We])=>[ut,Pe(We)])));case"function":return new mr((ut,We)=>{const Je=ge(...ut.map(xt=>xt.value))??null;return Pe(Je)});default:throw new Error(`Cannot convert to runtime value: ${ge}`)}}function Ve(ge,ut,We){const Je=We??0;switch(ge.type){case"NullValue":case"UndefinedValue":return"null";case"IntegerValue":case"FloatValue":case"StringValue":case"BooleanValue":return JSON.stringify(ge.value);case"ArrayValue":case"ObjectValue":{const xt=ut?" ".repeat(ut):"",wt=`
`+xt.repeat(Je),pr=wt+xt;if(ge.type==="ArrayValue"){const Rr=ge.value.map(On=>Ve(On,ut,Je+1));return ut?`[${pr}${Rr.join(`,${pr}`)}${wt}]`:`[${Rr.join(", ")}]`}else{const Rr=Array.from(ge.value.entries()).map(([On,Mn])=>{const _r=`"${On}": ${Ve(Mn,ut,Je+1)}`;return ut?`${pr}${_r}`:_r});return ut?`{${Rr.join(",")}${wt}}`:`{${Rr.join(", ")}}`}}default:throw new Error(`Cannot convert to JSON: ${ge.type}`)}}var Qe=`
`,dt="{%- ",Pt=" -%}";function Vt(ge){switch(ge.operator.type){case"MultiplicativeBinaryOperator":return 4;case"AdditiveBinaryOperator":return 3;case"ComparisonBinaryOperator":return 2;case"Identifier":return ge.operator.value==="and"?1:ge.operator.value==="in"||ge.operator.value==="not in"?2:0}return 0}function At(ge,ut="	"){const We=typeof ut=="number"?" ".repeat(ut):ut;return er(ge.body,0,We).replace(/\n$/,"")}function qt(...ge){return dt+ge.join(" ")+Pt}function er(ge,ut,We){return ge.map(Je=>fr(Je,ut,We)).join(Qe)}function fr(ge,ut,We){const Je=We.repeat(ut);switch(ge.type){case"Program":return er(ge.body,ut,We);case"If":return Jr(ge,ut,We);case"For":return $t(ge,ut,We);case"Set":return zr(ge,ut,We);case"Macro":return Sr(ge,ut,We);case"Break":return Je+qt("break");case"Continue":return Je+qt("continue");case"CallStatement":return Ir(ge,ut,We);case"FilterStatement":return Xr(ge,ut,We);case"Comment":return Je+"{# "+ge.value+" #}";default:return Je+"{{- "+qr(ge)+" -}}"}}function Jr(ge,ut,We){const Je=We.repeat(ut),xt=[];let wt=ge;for(;wt&&(xt.push({test:wt.test,body:wt.body}),wt.alternate.length===1&&wt.alternate[0].type==="If");)wt=wt.alternate[0];let pr=Je+qt("if",qr(xt[0].test))+Qe+er(xt[0].body,ut+1,We);for(let Rr=1;Rr<xt.length;++Rr)pr+=Qe+Je+qt("elif",qr(xt[Rr].test))+Qe+er(xt[Rr].body,ut+1,We);return wt&&wt.alternate.length>0&&(pr+=Qe+Je+qt("else")+Qe+er(wt.alternate,ut+1,We)),pr+=Qe+Je+qt("endif"),pr}function $t(ge,ut,We){const Je=We.repeat(ut);let xt="";if(ge.iterable.type==="SelectExpression"){const pr=ge.iterable;xt=`${qr(pr.lhs)} if ${qr(pr.test)}`}else xt=qr(ge.iterable);let wt=Je+qt("for",qr(ge.loopvar),"in",xt)+Qe+er(ge.body,ut+1,We);return ge.defaultBlock.length>0&&(wt+=Qe+Je+qt("else")+Qe+er(ge.defaultBlock,ut+1,We)),wt+=Qe+Je+qt("endfor"),wt}function zr(ge,ut,We){const Je=We.repeat(ut),xt=qr(ge.assignee),wt=ge.value?qr(ge.value):"",pr=Je+qt("set",`${xt}${ge.value?" = "+wt:""}`);return ge.body.length===0?pr:pr+Qe+er(ge.body,ut+1,We)+Qe+Je+qt("endset")}function Sr(ge,ut,We){const Je=We.repeat(ut),xt=ge.args.map(qr).join(", ");return Je+qt("macro",`${ge.name.value}(${xt})`)+Qe+er(ge.body,ut+1,We)+Qe+Je+qt("endmacro")}function Ir(ge,ut,We){const Je=We.repeat(ut),xt=ge.callerArgs&&ge.callerArgs.length>0?`(${ge.callerArgs.map(qr).join(", ")})`:"",wt=qr(ge.call);let pr=Je+qt(`call${xt}`,wt)+Qe;return pr+=er(ge.body,ut+1,We)+Qe,pr+=Je+qt("endcall"),pr}function Xr(ge,ut,We){const Je=We.repeat(ut),xt=ge.filter.type==="Identifier"?ge.filter.value:qr(ge.filter);let wt=Je+qt("filter",xt)+Qe;return wt+=er(ge.body,ut+1,We)+Qe,wt+=Je+qt("endfilter"),wt}function qr(ge,ut=-1){switch(ge.type){case"SpreadExpression":return`*${qr(ge.argument)}`;case"Identifier":return ge.value;case"IntegerLiteral":return`${ge.value}`;case"FloatLiteral":return`${ge.value}`;case"StringLiteral":return JSON.stringify(ge.value);case"BinaryExpression":{const We=ge,Je=Vt(We),xt=qr(We.left,Je),wt=qr(We.right,Je+1),pr=`${xt} ${We.operator.value} ${wt}`;return Je<ut?`(${pr})`:pr}case"UnaryExpression":{const We=ge;return We.operator.value+(We.operator.value==="not"?" ":"")+qr(We.argument,1/0)}case"CallExpression":{const We=ge,Je=We.args.map(qr).join(", ");return`${qr(We.callee)}(${Je})`}case"MemberExpression":{const We=ge;let Je=qr(We.object);["Identifier","MemberExpression","CallExpression","StringLiteral","IntegerLiteral","FloatLiteral","ArrayLiteral","TupleLiteral","ObjectLiteral"].includes(We.object.type)||(Je=`(${Je})`);let xt=qr(We.property);return!We.computed&&We.property.type!=="Identifier"&&(xt=`(${xt})`),We.computed?`${Je}[${xt}]`:`${Je}.${xt}`}case"FilterExpression":{const We=ge,Je=qr(We.operand,1/0);return We.filter.type==="CallExpression"?`${Je} | ${qr(We.filter)}`:`${Je} | ${We.filter.value}`}case"SelectExpression":{const We=ge;return`${qr(We.lhs)} if ${qr(We.test)}`}case"TestExpression":{const We=ge;return`${qr(We.operand)} is${We.negate?" not":""} ${We.test.value}`}case"ArrayLiteral":case"TupleLiteral":{const We=ge.value.map(qr),Je=ge.type==="ArrayLiteral"?"[]":"()";return`${Je[0]}${We.join(", ")}${Je[1]}`}case"ObjectLiteral":return`{${Array.from(ge.value.entries()).map(([Je,xt])=>`${qr(Je)}: ${qr(xt)}`).join(", ")}}`;case"SliceExpression":{const We=ge,Je=We.start?qr(We.start):"",xt=We.stop?qr(We.stop):"",wt=We.step?`:${qr(We.step)}`:"";return`${Je}:${xt}${wt}`}case"KeywordArgumentExpression":{const We=ge;return`${We.key.value}=${qr(We.value)}`}case"Ternary":{const We=ge,Je=`${qr(We.trueExpr)} if ${qr(We.condition,0)} else ${qr(We.falseExpr)}`;return ut>-1?`(${Je})`:Je}default:throw new Error(`Unknown expression type: ${ge.type}`)}}var An=class{constructor(ge){_t(this,"parsed");const ut=m(ge,{lstrip_blocks:!0,trim_blocks:!0});this.parsed=Ce(ut)}render(ge){const ut=new or;if(tt(ut),ge)for(const[xt,wt]of Object.entries(ge))ut.set(xt,wt);return new Se(ut).run(this.parsed).value}format(ge){return At(this.parsed,(ge==null?void 0:ge.indent)||"	")}}},"./src/backends/onnx.js":(e,t,r)=>{var n;r.r(t),r.d(t,{Tensor:()=>a.Tensor,createInferenceSession:()=>E,deviceToExecutionProviders:()=>M,isONNXProxy:()=>C,isONNXTensor:()=>T});var i=r("./src/env.js"),o=r("?2ce3"),s=r("onnxruntime-web"),a=r("onnxruntime-common");const u=Object.freeze({auto:null,gpu:null,cpu:"cpu",wasm:"wasm",webgpu:"webgpu",cuda:"cuda",dml:"dml",webnn:{name:"webnn",deviceType:"cpu"},"webnn-npu":{name:"webnn",deviceType:"npu"},"webnn-gpu":{name:"webnn",deviceType:"gpu"},"webnn-cpu":{name:"webnn",deviceType:"cpu"}}),d=[];let m,g;const _=Symbol.for("onnxruntime");if(_ in globalThis)g=globalThis[_];else if(i.apis.IS_NODE_ENV){switch(g=o??(n||(n=r.t(o,2))),process.platform){case"win32":d.push("dml");break;case"linux":process.arch==="x64"&&d.push("cuda");break}d.push("cpu"),m=["cpu"]}else g=s,i.apis.IS_WEBNN_AVAILABLE&&d.push("webnn-npu","webnn-gpu","webnn-cpu","webnn"),i.apis.IS_WEBGPU_AVAILABLE&&d.push("webgpu"),d.push("wasm"),m=["wasm"];const y=g.InferenceSession;function M(D=null){if(!D)return m;switch(D){case"auto":return d;case"gpu":return d.filter(L=>["webgpu","cuda","dml","webnn-gpu"].includes(L))}if(d.includes(D))return[u[D]??D];throw new Error(`Unsupported device: "${D}". Should be one of: ${d.join(", ")}.`)}let x=null;async function E(D,L,N){x&&await x;const j=y.create(D,L);x??(x=j);const $=await j;return $.config=N,$}function T(D){return D instanceof g.Tensor}const P=g==null?void 0:g.env;P!=null&&P.wasm&&(!(typeof ServiceWorkerGlobalScope<"u"&&self instanceof ServiceWorkerGlobalScope)&&!P.wasm.wasmPaths&&(P.wasm.wasmPaths=`https://cdn.jsdelivr.net/npm/@huggingface/transformers@${i.env.version}/dist/`),P.wasm.proxy=!1),P!=null&&P.webgpu&&(P.webgpu.powerPreference="high-performance");function C(){var D;return(D=P==null?void 0:P.wasm)==null?void 0:D.proxy}i.env.backends.onnx=P},"./src/base/feature_extraction_utils.js":(e,t,r)=>{r.r(t),r.d(t,{FeatureExtractor:()=>s,validate_audio_inputs:()=>a});var n=r("./src/utils/constants.js"),i=r("./src/utils/generic.js"),o=r("./src/utils/hub.js");class s extends i.Callable{constructor(d){super(),this.config=d}static async from_pretrained(d,m={}){const g=await(0,o.getModelJSON)(d,n.FEATURE_EXTRACTOR_NAME,!0,m);return new this(g)}}function a(u,d){var m;if(!(u instanceof Float32Array||u instanceof Float64Array))throw new Error(`${d} expects input to be a Float32Array or a Float64Array, but got ${((m=u==null?void 0:u.constructor)==null?void 0:m.name)??typeof u} instead. If using the feature extractor directly, remember to use \`read_audio(url, sampling_rate)\` to obtain the raw audio data of the file/url.`)}},"./src/base/image_processors_utils.js":(e,t,r)=>{r.r(t),r.d(t,{ImageProcessor:()=>D,center_to_corners_format:()=>g,post_process_instance_segmentation:()=>C,post_process_object_detection:()=>_,post_process_panoptic_segmentation:()=>P,post_process_semantic_segmentation:()=>y});var n=r("./src/utils/generic.js"),i=r("./src/utils/tensor.js"),o=r("./src/utils/maths.js");r("./src/utils/image.js");var s=r("./src/utils/core.js"),a=r("./src/utils/hub.js"),u=r("./src/utils/constants.js");function d(L,N,j=0,$=null){const U=L/N;let G=(0,o.bankers_round)(U)*N;return $!==null&&G>$&&(G=Math.floor(U)*N),G<j&&(G=Math.ceil(U)*N),G}function m([L,N],j){return[Math.max(Math.floor(L/j),1)*j,Math.max(Math.floor(N/j),1)*j]}function g([L,N,j,$]){return[L-j/2,N-$/2,L+j/2,N+$/2]}function _(L,N=.5,j=null,$=!1){const U=L.logits,G=L.pred_boxes,[H,X,ee]=U.dims;if(j!==null&&j.length!==H)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");let ae=[];for(let de=0;de<H;++de){let ye=j!==null?j[de]:null,_e={boxes:[],classes:[],scores:[]},ue=U[de],fe=G[de];for(let De=0;De<X;++De){let pe=ue[De],K=[],te;if($){te=pe.sigmoid().data;for(let ve=0;ve<te.length;++ve)te[ve]>N&&K.push(ve)}else{let ve=(0,o.max)(pe.data)[1];if(ve===ee-1||(te=(0,o.softmax)(pe.data),te[ve]<N))continue;K.push(ve)}for(const ve of K){let $e=fe[De].data;$e=g($e),ye!==null&&($e=$e.map((Ce,Ge)=>Ce*ye[(Ge+1)%2])),_e.boxes.push($e),_e.classes.push(ve),_e.scores.push(te[ve])}}ae.push(_e)}return ae}function y(L,N=null){const j=L.logits,$=j.dims[0];if(N!==null&&N.length!==$)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");const U=[];for(let G=0;G<$;++G){const H=N!==null?N[G]:null;let X=j[G];H!==null&&(X=(0,i.interpolate)(X,H,"bilinear",!1));const[ee,ae]=H??X.dims.slice(-2),de=new i.Tensor("int32",new Int32Array(ee*ae),[ee,ae]),ye=X[0].data,_e=de.data;for(let De=1;De<X.dims[0];++De){const pe=X[De].data;for(let K=0;K<pe.length;++K)pe[K]>ye[K]&&(ye[K]=pe[K],_e[K]=De)}const ue=new Array(X.dims[0]);for(let De=0;De<_e.length;++De){const pe=_e[De];ue[pe]=pe}const fe=ue.filter(De=>De!==void 0);U.push({segmentation:de,labels:fe})}return U}function M(L,N,j,$){const U=[],G=[],H=[];for(let X=0;X<L.dims[0];++X){const ee=L[X],ae=N[X],de=(0,o.max)(ee.data)[1];if(de===$)continue;const _e=(0,o.softmax)(ee.data)[de];_e>j&&(U.push(ae),G.push(_e),H.push(de))}return[U,G,H]}function x(L,N,j,$=.5,U=.8){const G=[];let H=0,X=0;const ee=N[j].data;for(let de=0;de<L.length;++de)L[de]===j&&(G.push(de),++H),ee[de]>=$&&++X;let ae=H>0&&X>0;return ae&&(ae=H/X>U),[ae,G]}function E(L,N,j,$,U,G=null,H=null){const[X,ee]=H??L[0].dims,ae=new i.Tensor("int32",new Int32Array(X*ee),[X,ee]),de=[];if(H!==null)for(let De=0;De<L.length;++De)L[De]=(0,i.interpolate)(L[De],H,"bilinear",!1);const ye=new Int32Array(L[0].data.length),_e=new Float32Array(L[0].data.length);for(let De=0;De<L.length;++De){let pe=N[De];const K=L[De].data;for(let te=0;te<K.length;++te)K[te]*=pe,K[te]>_e[te]&&(ye[te]=De,_e[te]=K[te])}let ue=0;const fe=ae.data;for(let De=0;De<j.length;++De){const pe=j[De],[K,te]=x(ye,L,De,$,U);if(K){++ue;for(const ve of te)fe[ve]=ue;de.push({id:ue,label_id:pe,score:N[De]})}}return[ae,de]}function T(L,N,j=28,$=56*56,U=14*14*4*1280){if(L<j||N<j)throw new Error(`height:${L} or width:${N} must be larger than factor:${j}`);if(Math.max(L,N)/Math.min(L,N)>200)throw new Error(`absolute aspect ratio must be smaller than 200, got ${Math.max(L,N)/Math.min(L,N)}`);let G=Math.round(L/j)*j,H=Math.round(N/j)*j;if(G*H>U){const X=Math.sqrt(L*N/U);G=Math.floor(L/X/j)*j,H=Math.floor(N/X/j)*j}else if(G*H<$){const X=Math.sqrt($/(L*N));G=Math.ceil(L*X/j)*j,H=Math.ceil(N*X/j)*j}return[G,H]}function P(L,N=.5,j=.5,$=.8,U=null,G=null){U===null&&(console.warn("`label_ids_to_fuse` unset. No instance will be fused."),U=new Set);const H=L.class_queries_logits??L.logits,ee=(L.masks_queries_logits??L.pred_masks).sigmoid();let[ae,de,ye]=H.dims;if(ye-=1,G!==null&&G.length!==ae)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");let _e=[];for(let ue=0;ue<ae;++ue){let fe=G!==null?G[ue]:null,De=H[ue],pe=ee[ue],[K,te,ve]=M(De,pe,N,ye);if(ve.length===0){let[Ge,ot]=fe??pe.dims.slice(-2),Ye=new i.Tensor("int32",new Int32Array(Ge*ot).fill(-1),[Ge,ot]);_e.push({segmentation:Ye,segments_info:[]});continue}let[$e,Ce]=E(K,te,ve,j,$,U,fe);_e.push({segmentation:$e,segments_info:Ce})}return _e}function C(L,N=.5,j=null){throw new Error("`post_process_instance_segmentation` is not yet implemented.")}class D extends n.Callable{constructor(N){super(),this.image_mean=N.image_mean??N.mean,this.image_std=N.image_std??N.std,this.resample=N.resample??2,this.do_rescale=N.do_rescale??!0,this.rescale_factor=N.rescale_factor??1/255,this.do_normalize=N.do_normalize,this.do_thumbnail=N.do_thumbnail,this.size=N.size??N.image_size,this.do_resize=N.do_resize??this.size!==void 0,this.size_divisibility=N.size_divisibility??N.size_divisor,this.do_center_crop=N.do_center_crop,this.crop_size=N.crop_size,this.do_convert_rgb=N.do_convert_rgb??!0,this.do_crop_margin=N.do_crop_margin,this.pad_size=N.pad_size,this.do_pad=N.do_pad,this.min_pixels=N.min_pixels,this.max_pixels=N.max_pixels,this.do_pad&&!this.pad_size&&this.size&&this.size.width!==void 0&&this.size.height!==void 0&&(this.pad_size=this.size),this.do_flip_channel_order=N.do_flip_channel_order??!1,this.config=N}async thumbnail(N,j,$=2){const U=N.height,G=N.width,H=j.height,X=j.width;let ee=Math.min(U,H),ae=Math.min(G,X);return ee===U&&ae===G?N:(U>G?ae=Math.floor(G*ee/U):G>U&&(ee=Math.floor(U*ae/G)),await N.resize(ae,ee,{resample:$}))}async crop_margin(N,j=200){const $=N.clone().grayscale(),U=(0,o.min)($.data)[0],H=(0,o.max)($.data)[0]-U;if(H===0)return N;const X=j/255;let ee=$.width,ae=$.height,de=0,ye=0;const _e=$.data;for(let ue=0;ue<$.height;++ue){const fe=ue*$.width;for(let De=0;De<$.width;++De)(_e[fe+De]-U)/H<X&&(ee=Math.min(ee,De),ae=Math.min(ae,ue),de=Math.max(de,De),ye=Math.max(ye,ue))}return N=await N.crop([ee,ae,de,ye]),N}pad_image(N,j,$,{mode:U="constant",center:G=!1,constant_values:H=0}={}){const[X,ee,ae]=j;let de,ye;if(typeof $=="number"?(de=$,ye=$):$==="square"?de=ye=Math.max(X,ee):(de=$.width,ye=$.height),de!==ee||ye!==X){const _e=new Float32Array(de*ye*ae);if(Array.isArray(H))for(let De=0;De<_e.length;++De)_e[De]=H[De%ae];else H!==0&&_e.fill(H);const[ue,fe]=G?[Math.floor((de-ee)/2),Math.floor((ye-X)/2)]:[0,0];for(let De=0;De<X;++De){const pe=(De+fe)*de,K=De*ee;for(let te=0;te<ee;++te){const ve=(pe+te+ue)*ae,$e=(K+te)*ae;for(let Ce=0;Ce<ae;++Ce)_e[ve+Ce]=N[$e+Ce]}}if(U==="symmetric"){if(G)throw new Error("`center` padding is not supported when `mode` is set to `symmetric`.");const De=X-1,pe=ee-1;for(let K=0;K<ye;++K){const te=K*de,ve=(0,s.calculateReflectOffset)(K,De)*ee;for(let $e=0;$e<de;++$e){if(K<X&&$e<ee)continue;const Ce=(te+$e)*ae,Ge=(ve+(0,s.calculateReflectOffset)($e,pe))*ae;for(let ot=0;ot<ae;++ot)_e[Ce+ot]=N[Ge+ot]}}}N=_e,j=[ye,de,ae]}return[N,j]}rescale(N){for(let j=0;j<N.length;++j)N[j]=this.rescale_factor*N[j]}get_resize_output_image_size(N,j){const[$,U]=N.size;let G,H;if(this.do_thumbnail){const{height:X,width:ee}=j;G=Math.min(X,ee)}else Number.isInteger(j)?(G=j,H=this.config.max_size??G):j!==void 0&&(G=j.shortest_edge,H=j.longest_edge);if(G!==void 0||H!==void 0){const X=G===void 0?1:Math.max(G/$,G/U),ee=$*X,ae=U*X,de=H===void 0?1:Math.min(H/ee,H/ae);let ye=Math.floor(Number((ee*de).toFixed(2))),_e=Math.floor(Number((ae*de).toFixed(2)));return this.size_divisibility!==void 0&&([ye,_e]=m([ye,_e],this.size_divisibility)),[ye,_e]}else if(j!==void 0&&j.width!==void 0&&j.height!==void 0){let X=j.width,ee=j.height;if(this.config.keep_aspect_ratio&&this.config.ensure_multiple_of){let ae=ee/U,de=X/$;Math.abs(1-de)<Math.abs(1-ae)?ae=de:de=ae,ee=d(ae*U,this.config.ensure_multiple_of),X=d(de*$,this.config.ensure_multiple_of)}return[X,ee]}else{if(this.size_divisibility!==void 0)return m([$,U],this.size_divisibility);if(this.min_pixels!==void 0&&this.max_pixels!==void 0){const X=this.config.patch_size*this.config.merge_size;return T(U,$,X,this.min_pixels,this.max_pixels)}else throw new Error(`Could not resize image due to unsupported \`this.size\` option in config: ${JSON.stringify(j)}`)}}async resize(N){const[j,$]=this.get_resize_output_image_size(N,this.size);return await N.resize(j,$,{resample:this.resample})}async preprocess(N,{do_normalize:j=null,do_pad:$=null,do_convert_rgb:U=null,do_convert_grayscale:G=null,do_flip_channel_order:H=null}={}){this.do_crop_margin&&(N=await this.crop_margin(N));const[X,ee]=N.size;if(U??this.do_convert_rgb?N=N.rgb():G&&(N=N.grayscale()),this.do_resize&&(N=await this.resize(N)),this.do_thumbnail&&(N=await this.thumbnail(N,this.size,this.resample)),this.do_center_crop){let ue,fe;Number.isInteger(this.crop_size)?(ue=this.crop_size,fe=this.crop_size):(ue=this.crop_size.width,fe=this.crop_size.height),N=await N.center_crop(ue,fe)}const ae=[N.height,N.width];let de=Float32Array.from(N.data),ye=[N.height,N.width,N.channels];if(this.do_rescale&&this.rescale(de),j??this.do_normalize){let ue=this.image_mean;Array.isArray(this.image_mean)||(ue=new Array(N.channels).fill(ue));let fe=this.image_std;if(Array.isArray(this.image_std)||(fe=new Array(N.channels).fill(ue)),ue.length!==N.channels||fe.length!==N.channels)throw new Error(`When set to arrays, the length of \`image_mean\` (${ue.length}) and \`image_std\` (${fe.length}) must match the number of channels in the image (${N.channels}).`);for(let De=0;De<de.length;De+=N.channels)for(let pe=0;pe<N.channels;++pe)de[De+pe]=(de[De+pe]-ue[pe])/fe[pe]}if($??this.do_pad){if(this.pad_size)[de,ye]=this.pad_image(de,[N.height,N.width,N.channels],this.pad_size);else if(this.size_divisibility){const[ue,fe]=m([ye[1],ye[0]],this.size_divisibility);[de,ye]=this.pad_image(de,ye,{width:ue,height:fe})}}if(H??this.do_flip_channel_order){if(ye[2]!==3)throw new Error("Flipping channel order is only supported for RGB images.");for(let ue=0;ue<de.length;ue+=3){const fe=de[ue];de[ue]=de[ue+2],de[ue+2]=fe}}const _e=new i.Tensor("float32",de,ye).permute(2,0,1);return{original_size:[ee,X],reshaped_input_size:ae,pixel_values:_e}}async _call(N,...j){Array.isArray(N)||(N=[N]);const $=await Promise.all(N.map(G=>this.preprocess(G)));return{pixel_values:(0,i.stack)($.map(G=>G.pixel_values),0),original_sizes:$.map(G=>G.original_size),reshaped_input_sizes:$.map(G=>G.reshaped_input_size)}}static async from_pretrained(N,j={}){const $=await(0,a.getModelJSON)(N,u.IMAGE_PROCESSOR_NAME,!0,j);return new this($)}}},"./src/base/processing_utils.js":(e,t,r)=>{r.r(t),r.d(t,{Processor:()=>s});var n=r("./src/utils/constants.js"),i=r("./src/utils/generic.js"),o=r("./src/utils/hub.js");class s extends i.Callable{constructor(u,d,m){super(),this.config=u,this.components=d,this.chat_template=m}get image_processor(){return this.components.image_processor}get tokenizer(){return this.components.tokenizer}get feature_extractor(){return this.components.feature_extractor}apply_chat_template(u,d={}){if(!this.tokenizer)throw new Error("Unable to apply chat template without a tokenizer.");return this.tokenizer.apply_chat_template(u,{tokenize:!1,chat_template:this.chat_template??void 0,...d})}batch_decode(...u){if(!this.tokenizer)throw new Error("Unable to decode without a tokenizer.");return this.tokenizer.batch_decode(...u)}decode(...u){if(!this.tokenizer)throw new Error("Unable to decode without a tokenizer.");return this.tokenizer.decode(...u)}async _call(u,...d){for(const m of[this.image_processor,this.feature_extractor,this.tokenizer])if(m)return m(u,...d);throw new Error("No image processor, feature extractor, or tokenizer found.")}static async from_pretrained(u,d={}){const[m,g,_]=await Promise.all([this.uses_processor_config?(0,o.getModelJSON)(u,n.PROCESSOR_NAME,!0,d):{},Promise.all(this.classes.filter(y=>y in this).map(async y=>{const M=await this[y].from_pretrained(u,d);return[y.replace(/_class$/,""),M]})).then(Object.fromEntries),this.uses_chat_template_file?(0,o.getModelText)(u,n.CHAT_TEMPLATE_NAME,!0,d):null]);return new this(m,g,_)}}_t(s,"classes",["image_processor_class","tokenizer_class","feature_extractor_class"]),_t(s,"uses_processor_config",!1),_t(s,"uses_chat_template_file",!1)},"./src/configs.js":(e,t,r)=>{r.r(t),r.d(t,{AutoConfig:()=>m,PretrainedConfig:()=>d,getCacheShapes:()=>a});var n=r("./src/utils/core.js"),i=r("./src/utils/hub.js");async function o(g,_){return await(0,i.getModelJSON)(g,"config.json",!0,_)}function s(g){const _={};let y={};switch(g.model_type){case"llava":case"paligemma":case"gemma3":case"florence2":case"llava_onevision":case"idefics3":case"ultravox":case"voxtral":case"smolvlm":case"gemma3n":y=s(g.text_config);break;case"moondream1":y=s(g.phi_config);break;case"musicgen":y=s(g.decoder);break;case"multi_modality":y=s(g.language_config);break;case"gpt2":case"gptj":case"jais":case"codegen":case"gpt_bigcode":_.num_heads="n_head",_.num_layers="n_layer",_.hidden_size="n_embd";break;case"gpt_neox":case"stablelm":case"opt":case"falcon":case"modernbert-decoder":_.num_heads="num_attention_heads",_.num_layers="num_hidden_layers",_.hidden_size="hidden_size";break;case"llama":case"arcee":case"lfm2":case"smollm3":case"olmo":case"olmo2":case"mobilellm":case"granite":case"cohere":case"mistral":case"starcoder2":case"qwen2":case"qwen2_vl":case"phi":case"phi3":case"phi3_v":case"llava_qwen2":_.num_heads="num_key_value_heads",_.num_layers="num_hidden_layers",_.hidden_size="hidden_size",_.num_attention_heads="num_attention_heads",_.dim_kv="head_dim";break;case"qwen3":case"gemma":case"gemma2":case"gemma3_text":case"gemma3n_text":case"glm":case"helium":case"ernie4_5":_.num_heads="num_key_value_heads",_.num_layers="num_hidden_layers",_.dim_kv="head_dim";break;case"openelm":_.num_heads="num_kv_heads",_.num_layers="num_transformer_layers",_.dim_kv="head_dim";break;case"gpt_neo":case"donut-swin":_.num_heads="num_heads",_.num_layers="num_layers",_.hidden_size="hidden_size";break;case"bloom":_.num_heads="n_head",_.num_layers="n_layer",_.hidden_size="hidden_size";break;case"mpt":_.num_heads="n_heads",_.num_layers="n_layers",_.hidden_size="d_model";break;case"exaone":_.num_heads="num_key_value_heads",_.num_layers="num_layers",_.dim_kv="head_dim",_.num_attention_heads="num_attention_heads";break;case"t5":case"mt5":case"longt5":_.num_decoder_layers="num_decoder_layers",_.num_decoder_heads="num_heads",_.decoder_dim_kv="d_kv",_.num_encoder_layers="num_layers",_.num_encoder_heads="num_heads",_.encoder_dim_kv="d_kv";break;case"bart":case"mbart":case"marian":case"whisper":case"lite-whisper":case"m2m_100":case"blenderbot":case"blenderbot-small":case"florence2_language":_.num_decoder_layers="decoder_layers",_.num_decoder_heads="decoder_attention_heads",_.decoder_hidden_size="d_model",_.num_encoder_layers="encoder_layers",_.num_encoder_heads="encoder_attention_heads",_.encoder_hidden_size="d_model";break;case"speecht5":_.num_decoder_layers="decoder_layers",_.num_decoder_heads="decoder_attention_heads",_.decoder_hidden_size="hidden_size",_.num_encoder_layers="encoder_layers",_.num_encoder_heads="encoder_attention_heads",_.encoder_hidden_size="hidden_size";break;case"trocr":_.num_encoder_layers=_.num_decoder_layers="decoder_layers",_.num_encoder_heads=_.num_decoder_heads="decoder_attention_heads",_.encoder_hidden_size=_.decoder_hidden_size="d_model";break;case"musicgen_decoder":_.num_encoder_layers=_.num_decoder_layers="num_hidden_layers",_.num_encoder_heads=_.num_decoder_heads="num_attention_heads",_.encoder_hidden_size=_.decoder_hidden_size="hidden_size";break;case"moonshine":_.num_decoder_layers="decoder_num_hidden_layers",_.num_decoder_heads="decoder_num_key_value_heads",_.num_encoder_layers="encoder_num_hidden_layers",_.num_encoder_heads="encoder_num_key_value_heads",_.encoder_hidden_size=_.decoder_hidden_size="hidden_size";break;case"vision-encoder-decoder":const x=s(g.decoder),E="num_decoder_layers"in x,T=(0,n.pick)(g,["model_type","is_encoder_decoder"]);return E?(T.num_decoder_layers=x.num_decoder_layers,T.num_decoder_heads=x.num_decoder_heads,T.decoder_hidden_size=x.decoder_hidden_size,T.num_encoder_layers=x.num_encoder_layers,T.num_encoder_heads=x.num_encoder_heads,T.encoder_hidden_size=x.encoder_hidden_size):(T.num_layers=x.num_layers,T.num_heads=x.num_heads,T.hidden_size=x.hidden_size),T}const M={...y,...(0,n.pick)(g,["model_type","multi_query","is_encoder_decoder"])};for(const x in _)M[x]=g[_[x]];return M}function a(g,_){if(g.model_type==="lfm2"){const y=(_==null?void 0:_.prefix)??"past_key_values",M=y==="present"?"present":"past",x={},{layer_types:E,num_attention_heads:T,num_key_value_heads:P,hidden_size:C,conv_L_cache:D}=g,L=C/T,N=(_==null?void 0:_.batch_size)??1;for(let j=0;j<E.length;++j)if(E[j]==="full_attention")for(const $ of["key","value"])x[`${y}.${j}.${$}`]=[N,P,0,L];else if(E[j]==="conv")x[`${M}_conv.${j}`]=[N,C,D];else throw new Error(`Unsupported layer type: ${E[j]}`);return x}return u(g,_)}function u(g,{prefix:_="past_key_values",batch_size:y=1}={}){const M={},x=g.normalized_config;if(x.is_encoder_decoder&&"num_encoder_heads"in x&&"num_decoder_heads"in x){const E=x.encoder_dim_kv??x.encoder_hidden_size/x.num_encoder_heads,T=x.decoder_dim_kv??x.decoder_hidden_size/x.num_decoder_heads,P=[y,x.num_encoder_heads,0,E],C=[y,x.num_decoder_heads,0,T];for(let D=0;D<x.num_decoder_layers;++D)M[`${_}.${D}.encoder.key`]=P,M[`${_}.${D}.encoder.value`]=P,M[`${_}.${D}.decoder.key`]=C,M[`${_}.${D}.decoder.value`]=C}else{const E=x.num_heads,T=x.num_layers,P=x.dim_kv??x.hidden_size/(x.num_attention_heads??E);if(x.model_type==="falcon"){const C=[y*E,0,P];for(let D=0;D<T;++D)M[`${_}.${D}.key`]=C,M[`${_}.${D}.value`]=C}else if(x.multi_query){const C=[y*E,0,2*P];for(let D=0;D<T;++D)M[`${_}.${D}.key_value`]=C}else if(x.model_type==="bloom"){const C=[y*E,P,0],D=[y*E,0,P];for(let L=0;L<T;++L)M[`${_}.${L}.key`]=C,M[`${_}.${L}.value`]=D}else if(x.model_type==="openelm")for(let C=0;C<T;++C){const D=[y,E[C],0,P];M[`${_}.${C}.key`]=D,M[`${_}.${C}.value`]=D}else{const C=[y,E,0,P];for(let D=0;D<T;++D)M[`${_}.${D}.key`]=C,M[`${_}.${D}.value`]=C}}return M}class d{constructor(_){_t(this,"model_type",null);_t(this,"is_encoder_decoder",!1);_t(this,"max_position_embeddings");_t(this,"transformers.js_config");Object.assign(this,_),this.normalized_config=s(this)}static async from_pretrained(_,{progress_callback:y=null,config:M=null,cache_dir:x=null,local_files_only:E=!1,revision:T="main"}={}){M&&!(M instanceof d)&&(M=new d(M));const P=M??await o(_,{progress_callback:y,config:M,cache_dir:x,local_files_only:E,revision:T});return new this(P)}}class m{static async from_pretrained(..._){return d.from_pretrained(..._)}}},"./src/env.js":(e,t,r)=>{var U,G;r.r(t),r.d(t,{apis:()=>T,env:()=>j});var n=r("?db59"),i=r("?383f"),o=r("?fa4b");const s="3.7.2",a=typeof window<"u"&&typeof window.document<"u",u=typeof self<"u"&&["DedicatedWorkerGlobalScope","ServiceWorkerGlobalScope","SharedWorkerGlobalScope"].includes((U=self.constructor)==null?void 0:U.name),d=typeof self<"u"&&"caches"in self,m=typeof navigator<"u"&&"gpu"in navigator,g=typeof navigator<"u"&&"ml"in navigator,_=typeof process<"u",y=_&&((G=process==null?void 0:process.release)==null?void 0:G.name)==="node",M=!$(n),x=!$(i),E=typeof globalThis.Deno<"u",T=Object.freeze({IS_BROWSER_ENV:a,IS_WEBWORKER_ENV:u,IS_WEB_CACHE_AVAILABLE:d,IS_WEBGPU_AVAILABLE:m,IS_WEBNN_AVAILABLE:g,IS_PROCESS_AVAILABLE:_,IS_NODE_ENV:y,IS_FS_AVAILABLE:M,IS_PATH_AVAILABLE:x}),P=M&&x;let C="./";if(P){const H=Object(import.meta).url;H?C=i.dirname(i.dirname(o.fileURLToPath(H))):typeof __dirname<"u"&&(C=i.dirname(__dirname))}const D=P?i.join(C,"/.cache/"):null,L="/models/",N=P?i.join(C,L):L,j={version:s,backends:{onnx:{}},allowRemoteModels:!0,remoteHost:"https://huggingface.co/",remotePathTemplate:"{model}/resolve/{revision}/",allowLocalModels:!(a||u),localModelPath:N,useFS:M,useBrowserCache:d&&!E,useFSCache:M,cacheDir:D,useCustomCache:!1,customCache:null};function $(H){return Object.keys(H).length===0}},"./src/generation/configuration_utils.js":(e,t,r)=>{r.r(t),r.d(t,{GenerationConfig:()=>i});var n=r("./src/utils/core.js");class i{constructor(s){_t(this,"max_length",20);_t(this,"max_new_tokens",null);_t(this,"min_length",0);_t(this,"min_new_tokens",null);_t(this,"early_stopping",!1);_t(this,"max_time",null);_t(this,"do_sample",!1);_t(this,"num_beams",1);_t(this,"num_beam_groups",1);_t(this,"penalty_alpha",null);_t(this,"use_cache",!0);_t(this,"temperature",1);_t(this,"top_k",50);_t(this,"top_p",1);_t(this,"typical_p",1);_t(this,"epsilon_cutoff",0);_t(this,"eta_cutoff",0);_t(this,"diversity_penalty",0);_t(this,"repetition_penalty",1);_t(this,"encoder_repetition_penalty",1);_t(this,"length_penalty",1);_t(this,"no_repeat_ngram_size",0);_t(this,"bad_words_ids",null);_t(this,"force_words_ids",null);_t(this,"renormalize_logits",!1);_t(this,"constraints",null);_t(this,"forced_bos_token_id",null);_t(this,"forced_eos_token_id",null);_t(this,"remove_invalid_values",!1);_t(this,"exponential_decay_length_penalty",null);_t(this,"suppress_tokens",null);_t(this,"streamer",null);_t(this,"begin_suppress_tokens",null);_t(this,"forced_decoder_ids",null);_t(this,"guidance_scale",null);_t(this,"num_return_sequences",1);_t(this,"output_attentions",!1);_t(this,"output_hidden_states",!1);_t(this,"output_scores",!1);_t(this,"return_dict_in_generate",!1);_t(this,"pad_token_id",null);_t(this,"bos_token_id",null);_t(this,"eos_token_id",null);_t(this,"encoder_no_repeat_ngram_size",0);_t(this,"decoder_start_token_id",null);_t(this,"generation_kwargs",{});Object.assign(this,(0,n.pick)(s,Object.getOwnPropertyNames(this)))}}},"./src/generation/logits_process.js":(e,t,r)=>{r.r(t),r.d(t,{ClassifierFreeGuidanceLogitsProcessor:()=>T,ForcedBOSTokenLogitsProcessor:()=>u,ForcedEOSTokenLogitsProcessor:()=>d,LogitsProcessor:()=>o,LogitsProcessorList:()=>a,LogitsWarper:()=>s,MinLengthLogitsProcessor:()=>M,MinNewTokensLengthLogitsProcessor:()=>x,NoBadWordsLogitsProcessor:()=>E,NoRepeatNGramLogitsProcessor:()=>_,RepetitionPenaltyLogitsProcessor:()=>y,SuppressTokensAtBeginLogitsProcessor:()=>m,TemperatureLogitsWarper:()=>P,TopKLogitsWarper:()=>D,TopPLogitsWarper:()=>C,WhisperTimeStampLogitsProcessor:()=>g});var n=r("./src/utils/generic.js");r("./src/utils/tensor.js");var i=r("./src/utils/maths.js");class o extends n.Callable{_call(N,j){throw Error("`_call` should be implemented in a subclass")}}class s extends n.Callable{_call(N,j){throw Error("`_call` should be implemented in a subclass")}}class a extends n.Callable{constructor(){super(),this.processors=[]}push(N){this.processors.push(N)}extend(N){this.processors.push(...N)}_call(N,j){let $=j;for(const U of this.processors)$=U(N,$);return $}[Symbol.iterator](){return this.processors.values()}}class u extends o{constructor(N){super(),this.bos_token_id=N}_call(N,j){for(let $=0;$<N.length;++$)if(N[$].length===1){const U=j[$].data;U.fill(-1/0),U[this.bos_token_id]=0}return j}}class d extends o{constructor(N,j){super(),this.max_length=N,this.eos_token_id=Array.isArray(j)?j:[j]}_call(N,j){for(let $=0;$<N.length;++$)if(N[$].length===this.max_length-1){const U=j[$].data;U.fill(-1/0);for(const G of this.eos_token_id)U[G]=0}return j}}class m extends o{constructor(N,j){super(),this.begin_suppress_tokens=N,this.begin_index=j}_call(N,j){for(let $=0;$<N.length;++$)if(N[$].length===this.begin_index){const U=j[$].data;for(const G of this.begin_suppress_tokens)U[G]=-1/0}return j}}class g extends o{constructor(N,j){super(),this.eos_token_id=Array.isArray(N.eos_token_id)?N.eos_token_id[0]:N.eos_token_id,this.no_timestamps_token_id=N.no_timestamps_token_id,this.timestamp_begin=this.no_timestamps_token_id+1,this.begin_index=j.length,j.at(-1)===this.no_timestamps_token_id&&(this.begin_index-=1),this.max_initial_timestamp_index=N.max_initial_timestamp_index}_call(N,j){for(let $=0;$<N.length;++$){const U=j[$].data;if(U[this.no_timestamps_token_id]=-1/0,N[$].length===this.begin_index-1){U.fill(-1/0),U[this.timestamp_begin]=0;continue}const G=N[$].slice(this.begin_index),H=G.length>=1&&G[G.length-1]>=this.timestamp_begin,X=G.length<2||G[G.length-2]>=this.timestamp_begin;if(H&&(X?U.subarray(this.timestamp_begin).fill(-1/0):U.subarray(0,this.eos_token_id).fill(-1/0)),N[$].length===this.begin_index&&this.max_initial_timestamp_index!==null){const ye=this.timestamp_begin+this.max_initial_timestamp_index;U.subarray(ye+1).fill(-1/0)}const ee=(0,i.log_softmax)(U),ae=Math.log(ee.subarray(this.timestamp_begin).map(Math.exp).reduce((ye,_e)=>ye+_e)),de=(0,i.max)(ee.subarray(0,this.timestamp_begin))[0];ae>de&&U.subarray(0,this.timestamp_begin).fill(-1/0)}return j}}class _ extends o{constructor(N){super(),this.no_repeat_ngram_size=N}getNgrams(N){const j=N.length,$=[];for(let G=0;G<j+1-this.no_repeat_ngram_size;++G){const H=[];for(let X=0;X<this.no_repeat_ngram_size;++X)H.push(N[G+X]);$.push(H.map(Number))}const U=new Map;for(const G of $){const H=G.slice(0,G.length-1),X=JSON.stringify(H),ee=U.get(X)??[];ee.push(G[G.length-1]),U.set(X,ee)}return U}getGeneratedNgrams(N,j){const $=j.slice(j.length+1-this.no_repeat_ngram_size,j.length);return N.get(JSON.stringify($.map(Number)))??[]}calcBannedNgramTokens(N){const j=[];if(N.length+1<this.no_repeat_ngram_size)return j;{const $=this.getNgrams(N);return this.getGeneratedNgrams($,N)}}_call(N,j){for(let $=0;$<N.length;++$){const U=j[$].data,G=this.calcBannedNgramTokens(N[$]);for(const H of G)U[H]=-1/0}return j}}class y extends o{constructor(N){super(),this.penalty=N}_call(N,j){for(let $=0;$<N.length;++$){const U=j[$].data;for(const G of new Set(N[$])){const H=Number(G);U[H]<0?U[H]*=this.penalty:U[H]/=this.penalty}}return j}}class M extends o{constructor(N,j){super(),this.min_length=N,this.eos_token_id=Array.isArray(j)?j:[j]}_call(N,j){for(let $=0;$<N.length;++$)if(N[$].length<this.min_length){const U=j[$].data;for(const G of this.eos_token_id)U[G]=-1/0}return j}}class x extends o{constructor(N,j,$){super(),this.prompt_length_to_skip=N,this.min_new_tokens=j,this.eos_token_id=Array.isArray($)?$:[$]}_call(N,j){for(let $=0;$<N.length;++$)if(N[$].length-this.prompt_length_to_skip<this.min_new_tokens){const G=j[$].data;for(const H of this.eos_token_id)G[H]=-1/0}return j}}class E extends o{constructor(N,j){super(),this.bad_words_ids=N,this.eos_token_id=Array.isArray(j)?j:[j]}_call(N,j){for(let $=0;$<N.length;++$){const U=j[$].data,G=N[$];for(const H of this.bad_words_ids){if(G.length<H.length-1)continue;let X=!0;for(let ee=1;ee<=H.length-1;++ee)if(H.at(-ee-1)!=G.at(-ee)){X=!1;break}X&&(U[H.at(-1)]=-1/0)}}return j}}class T extends o{constructor(N){if(super(),N<=1)throw new Error(`Require guidance scale >1 to use the classifier free guidance processor, got guidance scale ${N}.`);this.guidance_scale=N}_call(N,j){if(j.dims[0]!==2*N.length)throw new Error(`Logits should have twice the batch size of the input ids, the first half of batches corresponding to the conditional inputs, and the second half of batches corresponding to the unconditional inputs. Got batch size ${j.dims[0]} for the logits and ${N.length} for the input ids.`);const $=N.length,U=j.slice([0,$],null),G=j.slice([$,j.dims[0]],null);for(let H=0;H<G.data.length;++H)G.data[H]+=(U.data[H]-G.data[H])*this.guidance_scale;return G}}class P extends s{constructor(N){super(),this.temperature=N}_call(N,j){const $=j.data;for(let U=0;U<$.length;++U)$[U]/=this.temperature;return j}}class C extends s{constructor(N,{filter_value:j=-1/0,min_tokens_to_keep:$=1}={}){if(super(),N<0||N>1)throw new Error(`\`top_p\` must be a float > 0 and < 1, but is ${N}`);if(!Number.isInteger($)||$<1)throw new Error(`\`min_tokens_to_keep\` must be a positive integer, but is ${$}`);this.top_p=N,this.filter_value=j,this.min_tokens_to_keep=$}}class D extends s{constructor(N,{filter_value:j=-1/0,min_tokens_to_keep:$=1}={}){if(super(),!Number.isInteger(N)||N<0)throw new Error(`\`top_k\` must be a positive integer, but is ${N}`);this.top_k=Math.max(N,$),this.filter_value=j}}},"./src/generation/logits_sampler.js":(e,t,r)=>{r.r(t),r.d(t,{LogitsSampler:()=>s});var n=r("./src/utils/generic.js"),i=r("./src/utils/tensor.js"),o=r("./src/utils/maths.js");r("./src/generation/configuration_utils.js");class s extends n.Callable{constructor(g){super(),this.generation_config=g}async _call(g){return this.sample(g)}async sample(g){throw Error("sample should be implemented in subclasses.")}getLogits(g,_){let y=g.dims.at(-1),M=g.data;if(_===-1)M=M.slice(-y);else{let x=_*y;M=M.slice(x,x+y)}return M}randomSelect(g){let _=0;for(let M=0;M<g.length;++M)_+=g[M];let y=Math.random()*_;for(let M=0;M<g.length;++M)if(y-=g[M],y<=0)return M;return 0}static getSampler(g){if(g.do_sample)return new u(g);if(g.num_beams>1)return new d(g);if(g.num_return_sequences>1)throw Error(`num_return_sequences has to be 1 when doing greedy search, but is ${g.num_return_sequences}.`);return new a(g)}}class a extends s{async sample(g){const _=(0,o.max)(g.data)[1];return[[BigInt(_),0]]}}class u extends s{async sample(g){let _=g.dims.at(-1);this.generation_config.top_k>0&&(_=Math.min(this.generation_config.top_k,_));const[y,M]=await(0,i.topk)(g,_),x=(0,o.softmax)(y.data);return Array.from({length:this.generation_config.num_beams},()=>{const E=this.randomSelect(x);return[M.data[E],Math.log(x[E])]})}}class d extends s{async sample(g){let _=g.dims.at(-1);this.generation_config.top_k>0&&(_=Math.min(this.generation_config.top_k,_));const[y,M]=await(0,i.topk)(g,_),x=(0,o.softmax)(y.data);return Array.from({length:this.generation_config.num_beams},(E,T)=>[M.data[T],Math.log(x[T])])}}},"./src/generation/stopping_criteria.js":(e,t,r)=>{r.r(t),r.d(t,{EosTokenCriteria:()=>a,InterruptableStoppingCriteria:()=>u,MaxLengthCriteria:()=>s,StoppingCriteria:()=>i,StoppingCriteriaList:()=>o});var n=r("./src/utils/generic.js");class i extends n.Callable{_call(m,g){throw Error("StoppingCriteria needs to be subclassed")}}class o extends n.Callable{constructor(){super(),this.criteria=[]}push(m){this.criteria.push(m)}extend(m){m instanceof o?m=m.criteria:m instanceof i&&(m=[m]),this.criteria.push(...m)}_call(m,g){const _=new Array(m.length).fill(!1);for(const y of this.criteria){const M=y(m,g);for(let x=0;x<_.length;++x)_[x]||(_[x]=M[x])}return _}[Symbol.iterator](){return this.criteria.values()}}class s extends i{constructor(m,g=null){super(),this.max_length=m,this.max_position_embeddings=g}_call(m){return m.map(g=>g.length>=this.max_length)}}class a extends i{constructor(m){super(),Array.isArray(m)||(m=[m]),this.eos_token_id=m}_call(m,g){return m.map(_=>{const y=_.at(-1);return this.eos_token_id.some(M=>y==M)})}}class u extends i{constructor(){super(),this.interrupted=!1}interrupt(){this.interrupted=!0}reset(){this.interrupted=!1}_call(m,g){return new Array(m.length).fill(this.interrupted)}}},"./src/generation/streamers.js":(e,t,r)=>{r.r(t),r.d(t,{BaseStreamer:()=>s,TextStreamer:()=>u,WhisperTextStreamer:()=>d});var n=r("./src/utils/core.js"),i=r("./src/tokenizers.js"),o=r("./src/env.js");class s{put(g){throw Error("Not implemented")}end(){throw Error("Not implemented")}}const a=o.apis.IS_PROCESS_AVAILABLE?m=>process.stdout.write(m):m=>console.log(m);class u extends s{constructor(g,{skip_prompt:_=!1,callback_function:y=null,token_callback_function:M=null,skip_special_tokens:x=!0,decode_kwargs:E={},...T}={}){super(),this.tokenizer=g,this.skip_prompt=_,this.callback_function=y??a,this.token_callback_function=M,this.decode_kwargs={skip_special_tokens:x,...E,...T},this.token_cache=[],this.print_len=0,this.next_tokens_are_prompt=!0}put(g){var E;if(g.length>1)throw Error("TextStreamer only supports batch size of 1");const _=this.next_tokens_are_prompt;if(_&&(this.next_tokens_are_prompt=!1,this.skip_prompt))return;const y=g[0];(E=this.token_callback_function)==null||E.call(this,y),this.token_cache=(0,n.mergeArrays)(this.token_cache,y);const M=this.tokenizer.decode(this.token_cache,this.decode_kwargs);let x;_||M.endsWith(`
`)?(x=M.slice(this.print_len),this.token_cache=[],this.print_len=0):M.length>0&&(0,i.is_chinese_char)(M.charCodeAt(M.length-1))?(x=M.slice(this.print_len),this.print_len+=x.length):(x=M.slice(this.print_len,M.lastIndexOf(" ")+1),this.print_len+=x.length),this.on_finalized_text(x,!1)}end(){let g;this.token_cache.length>0?(g=this.tokenizer.decode(this.token_cache,this.decode_kwargs).slice(this.print_len),this.token_cache=[],this.print_len=0):g="",this.next_tokens_are_prompt=!0,this.on_finalized_text(g,!0)}on_finalized_text(g,_){var y,M;g.length>0&&((y=this.callback_function)==null||y.call(this,g)),_&&this.callback_function===a&&o.apis.IS_PROCESS_AVAILABLE&&((M=this.callback_function)==null||M.call(this,`
`))}}class d extends u{constructor(g,{skip_prompt:_=!1,callback_function:y=null,token_callback_function:M=null,on_chunk_start:x=null,on_chunk_end:E=null,on_finalize:T=null,time_precision:P=.02,skip_special_tokens:C=!0,decode_kwargs:D={}}={}){super(g,{skip_prompt:_,skip_special_tokens:C,callback_function:y,token_callback_function:M,decode_kwargs:D}),this.timestamp_begin=g.timestamp_begin,this.on_chunk_start=x,this.on_chunk_end=E,this.on_finalize=T,this.time_precision=P,this.waiting_for_timestamp=!1}put(g){var y,M,x;if(g.length>1)throw Error("WhisperTextStreamer only supports batch size of 1");const _=g[0];if(_.length===1){const E=Number(_[0])-this.timestamp_begin;if(E>=0){const T=E*this.time_precision;this.waiting_for_timestamp?(y=this.on_chunk_end)==null||y.call(this,T):(M=this.on_chunk_start)==null||M.call(this,T),this.waiting_for_timestamp=!this.waiting_for_timestamp,(x=this.token_callback_function)==null||x.call(this,_);return}}return super.put(g)}end(){var g;super.end(),(g=this.on_finalize)==null||g.call(this)}}},"./src/models.js":(e,t,r)=>{r.r(t),r.d(t,{ASTForAudioClassification:()=>pi,ASTModel:()=>Ko,ASTPreTrainedModel:()=>Ao,AlbertForMaskedLM:()=>Ln,AlbertForQuestionAnswering:()=>Dr,AlbertForSequenceClassification:()=>Qr,AlbertModel:()=>en,AlbertPreTrainedModel:()=>Vr,ArceeForCausalLM:()=>Yn,ArceeModel:()=>wn,ArceePreTrainedModel:()=>cn,AutoModel:()=>wg,AutoModelForAudioClassification:()=>gh,AutoModelForAudioFrameClassification:()=>Yx,AutoModelForAudioTextToText:()=>Qx,AutoModelForCTC:()=>Xx,AutoModelForCausalLM:()=>Hx,AutoModelForDepthEstimation:()=>dv,AutoModelForDocumentQuestionAnswering:()=>uv,AutoModelForImageClassification:()=>Kx,AutoModelForImageFeatureExtraction:()=>fv,AutoModelForImageMatting:()=>jT,AutoModelForImageSegmentation:()=>OT,AutoModelForImageTextToText:()=>hm,AutoModelForImageToImage:()=>ey,AutoModelForMaskGeneration:()=>Zx,AutoModelForMaskedLM:()=>lv,AutoModelForNormalEstimation:()=>RT,AutoModelForObjectDetection:()=>$T,AutoModelForPoseEstimation:()=>hv,AutoModelForQuestionAnswering:()=>cv,AutoModelForSemanticSegmentation:()=>LT,AutoModelForSeq2SeqLM:()=>Wx,AutoModelForSequenceClassification:()=>AT,AutoModelForSpeechSeq2Seq:()=>Gx,AutoModelForTextToSpectrogram:()=>kT,AutoModelForTextToWaveform:()=>qx,AutoModelForTokenClassification:()=>CT,AutoModelForUniversalSegmentation:()=>DT,AutoModelForVision2Seq:()=>IT,AutoModelForXVector:()=>af,AutoModelForZeroShotObjectDetection:()=>NT,BartForConditionalGeneration:()=>di,BartForSequenceClassification:()=>Ho,BartModel:()=>Mi,BartPretrainedModel:()=>lo,BaseModelOutput:()=>Ne,BeitForImageClassification:()=>xa,BeitModel:()=>mn,BeitPreTrainedModel:()=>kn,BertForMaskedLM:()=>kt,BertForQuestionAnswering:()=>Kt,BertForSequenceClassification:()=>mt,BertForTokenClassification:()=>Zt,BertModel:()=>Lt,BertPreTrainedModel:()=>Ot,BlenderbotForConditionalGeneration:()=>po,BlenderbotModel:()=>co,BlenderbotPreTrainedModel:()=>Qi,BlenderbotSmallForConditionalGeneration:()=>hl,BlenderbotSmallModel:()=>ws,BlenderbotSmallPreTrainedModel:()=>ga,BloomForCausalLM:()=>td,BloomModel:()=>zs,BloomPreTrainedModel:()=>Tc,CLIPModel:()=>Jl,CLIPPreTrainedModel:()=>Ns,CLIPSegForImageSegmentation:()=>bl,CLIPSegModel:()=>nc,CLIPSegPreTrainedModel:()=>Na,CLIPTextModel:()=>wc,CLIPTextModelWithProjection:()=>ss,CLIPVisionModel:()=>Ts,CLIPVisionModelWithProjection:()=>js,CamembertForMaskedLM:()=>Mn,CamembertForQuestionAnswering:()=>an,CamembertForSequenceClassification:()=>_r,CamembertForTokenClassification:()=>Or,CamembertModel:()=>On,CamembertPreTrainedModel:()=>Rr,CausalLMOutput:()=>fm,CausalLMOutputWithPast:()=>zT,ChineseCLIPModel:()=>$n,ChineseCLIPPreTrainedModel:()=>Co,ClapAudioModelWithProjection:()=>VS,ClapModel:()=>dp,ClapPreTrainedModel:()=>K_,ClapTextModelWithProjection:()=>ug,CodeGenForCausalLM:()=>at,CodeGenModel:()=>Ke,CodeGenPreTrainedModel:()=>Oe,CohereForCausalLM:()=>ed,CohereModel:()=>ep,CoherePreTrainedModel:()=>dh,ConvBertForMaskedLM:()=>Xr,ConvBertForQuestionAnswering:()=>ge,ConvBertForSequenceClassification:()=>qr,ConvBertForTokenClassification:()=>An,ConvBertModel:()=>Ir,ConvBertPreTrainedModel:()=>Sr,ConvNextForImageClassification:()=>bo,ConvNextModel:()=>go,ConvNextPreTrainedModel:()=>uo,ConvNextV2ForImageClassification:()=>ei,ConvNextV2Model:()=>To,ConvNextV2PreTrainedModel:()=>zo,DFineForObjectDetection:()=>Es,DFineModel:()=>us,DFinePreTrainedModel:()=>ia,DINOv3ConvNextModel:()=>rf,DINOv3ConvNextPreTrainedModel:()=>tf,DINOv3ViTModel:()=>Ad,DINOv3ViTPreTrainedModel:()=>Yc,DPTForDepthEstimation:()=>Ae,DPTModel:()=>be,DPTPreTrainedModel:()=>xe,DacDecoderModel:()=>dT,DacDecoderOutput:()=>Lx,DacEncoderModel:()=>uT,DacEncoderOutput:()=>_g,DacModel:()=>cT,DacPreTrainedModel:()=>rv,DebertaForMaskedLM:()=>Uo,DebertaForQuestionAnswering:()=>Po,DebertaForSequenceClassification:()=>yn,DebertaForTokenClassification:()=>Vo,DebertaModel:()=>_o,DebertaPreTrainedModel:()=>Vn,DebertaV2ForMaskedLM:()=>ra,DebertaV2ForQuestionAnswering:()=>xo,DebertaV2ForSequenceClassification:()=>so,DebertaV2ForTokenClassification:()=>Xs,DebertaV2Model:()=>ta,DebertaV2PreTrainedModel:()=>pa,DecisionTransformerModel:()=>Cx,DecisionTransformerPreTrainedModel:()=>Ax,DeiTForImageClassification:()=>jl,DeiTModel:()=>Qs,DeiTPreTrainedModel:()=>mo,DepthAnythingForDepthEstimation:()=>lt,DepthAnythingPreTrainedModel:()=>Ue,DepthProForDepthEstimation:()=>It,DepthProPreTrainedModel:()=>Mt,DetrForObjectDetection:()=>Zo,DetrForSegmentation:()=>Wo,DetrModel:()=>eo,DetrObjectDetectionOutput:()=>Ha,DetrPreTrainedModel:()=>hi,DetrSegmentationOutput:()=>on,Dinov2ForImageClassification:()=>Aa,Dinov2Model:()=>ya,Dinov2PreTrainedModel:()=>qi,Dinov2WithRegistersForImageClassification:()=>Rl,Dinov2WithRegistersModel:()=>Js,Dinov2WithRegistersPreTrainedModel:()=>Fa,DistilBertForMaskedLM:()=>Eo,DistilBertForQuestionAnswering:()=>wo,DistilBertForSequenceClassification:()=>la,DistilBertForTokenClassification:()=>$s,DistilBertModel:()=>is,DistilBertPreTrainedModel:()=>Qn,DonutSwinModel:()=>mi,DonutSwinPreTrainedModel:()=>Tn,EfficientNetForImageClassification:()=>Ya,EfficientNetModel:()=>KS,EfficientNetPreTrainedModel:()=>lm,ElectraForMaskedLM:()=>Je,ElectraForQuestionAnswering:()=>pr,ElectraForSequenceClassification:()=>xt,ElectraForTokenClassification:()=>wt,ElectraModel:()=>We,ElectraPreTrainedModel:()=>ut,Ernie4_5_ForCausalLM:()=>bx,Ernie4_5_Model:()=>H0,Ernie4_5_PretrainedModel:()=>vx,EsmForMaskedLM:()=>os,EsmForSequenceClassification:()=>Pr,EsmForTokenClassification:()=>Hr,EsmModel:()=>ul,EsmPreTrainedModel:()=>Wa,ExaoneForCausalLM:()=>sh,ExaoneModel:()=>uu,ExaonePreTrainedModel:()=>bd,FalconForCausalLM:()=>X0,FalconModel:()=>Z0,FalconPreTrainedModel:()=>xx,FastViTForImageClassification:()=>Nt,FastViTModel:()=>vt,FastViTPreTrainedModel:()=>ar,Florence2ForConditionalGeneration:()=>gl,Florence2PreTrainedModel:()=>Da,GLPNForDepthEstimation:()=>$r,GLPNModel:()=>Yr,GLPNPreTrainedModel:()=>Gr,GPT2LMHeadModel:()=>qc,GPT2Model:()=>bi,GPT2PreTrainedModel:()=>qa,GPTBigCodeForCausalLM:()=>he,GPTBigCodeModel:()=>Y,GPTBigCodePreTrainedModel:()=>cu,GPTJForCausalLM:()=>yd,GPTJModel:()=>oh,GPTJPreTrainedModel:()=>Hc,GPTNeoForCausalLM:()=>na,GPTNeoModel:()=>Fo,GPTNeoPreTrainedModel:()=>Ji,GPTNeoXForCausalLM:()=>$l,GPTNeoXModel:()=>lu,GPTNeoXPreTrainedModel:()=>wl,Gemma2ForCausalLM:()=>tp,Gemma2Model:()=>nm,Gemma2PreTrainedModel:()=>Kh,Gemma3ForCausalLM:()=>ig,Gemma3Model:()=>rp,Gemma3PreTrainedModel:()=>hh,Gemma3nForConditionalGeneration:()=>Vc,Gemma3nPreTrainedModel:()=>$a,GemmaForCausalLM:()=>Sc,GemmaModel:()=>Sd,GemmaPreTrainedModel:()=>Md,GlmForCausalLM:()=>qh,GlmModel:()=>Fs,GlmPreTrainedModel:()=>Jn,GraniteForCausalLM:()=>uh,GraniteModel:()=>ch,GranitePreTrainedModel:()=>Ju,GroundingDinoForObjectDetection:()=>mh,GroundingDinoPreTrainedModel:()=>ph,GroupViTModel:()=>Gt,GroupViTPreTrainedModel:()=>bt,HeliumForCausalLM:()=>vd,HeliumModel:()=>Gh,HeliumPreTrainedModel:()=>Kc,HieraForImageClassification:()=>A,HieraModel:()=>Ac,HieraPreTrainedModel:()=>Ec,HubertForCTC:()=>cx,HubertForSequenceClassification:()=>ux,HubertModel:()=>q_,HubertPreTrainedModel:()=>W0,IJepaForImageClassification:()=>Ed,IJepaModel:()=>Pc,IJepaPreTrainedModel:()=>Xc,Idefics3ForConditionalGeneration:()=>Wc,Idefics3PreTrainedModel:()=>as,ImageMattingOutput:()=>BT,JAISLMHeadModel:()=>So,JAISModel:()=>xl,JAISPreTrainedModel:()=>ja,JinaCLIPModel:()=>vl,JinaCLIPPreTrainedModel:()=>yl,JinaCLIPTextModel:()=>Gc,JinaCLIPVisionModel:()=>rc,Lfm2ForCausalLM:()=>da,Lfm2Model:()=>ro,Lfm2PreTrainedModel:()=>Ci,LiteWhisperForConditionalGeneration:()=>pl,LlamaForCausalLM:()=>Wr,LlamaModel:()=>gr,LlamaPreTrainedModel:()=>Ht,LlavaForConditionalGeneration:()=>vc,LlavaOnevisionForConditionalGeneration:()=>bc,LlavaPreTrainedModel:()=>Pa,LlavaQwen2ForCausalLM:()=>Yu,LongT5ForConditionalGeneration:()=>Oi,LongT5Model:()=>Xi,LongT5PreTrainedModel:()=>rn,M2M100ForConditionalGeneration:()=>kd,M2M100Model:()=>fu,M2M100PreTrainedModel:()=>Iu,MBartForCausalLM:()=>Yi,MBartForConditionalGeneration:()=>Mo,MBartForSequenceClassification:()=>ni,MBartModel:()=>Nn,MBartPreTrainedModel:()=>bn,MPNetForMaskedLM:()=>Dl,MPNetForQuestionAnswering:()=>Ie,MPNetForSequenceClassification:()=>Uc,MPNetForTokenClassification:()=>Yt,MPNetModel:()=>Xl,MPNetPreTrainedModel:()=>yo,MT5ForConditionalGeneration:()=>Ri,MT5Model:()=>ma,MT5PreTrainedModel:()=>ri,MarianMTModel:()=>nf,MarianModel:()=>cp,MarianPreTrainedModel:()=>Xa,MaskFormerForInstanceSegmentation:()=>cr,MaskFormerModel:()=>nr,MaskFormerPreTrainedModel:()=>Jt,MaskedLMOutput:()=>el,Metric3DForDepthEstimation:()=>St,Metric3DPreTrainedModel:()=>jt,Metric3Dv2ForDepthEstimation:()=>ur,Metric3Dv2PreTrainedModel:()=>Wt,MgpstrForSceneTextRecognition:()=>tT,MgpstrModelOutput:()=>JS,MgpstrPreTrainedModel:()=>eT,MimiDecoderModel:()=>lT,MimiDecoderOutput:()=>sT,MimiEncoderModel:()=>Ox,MimiEncoderOutput:()=>aT,MimiModel:()=>Ix,MimiPreTrainedModel:()=>gg,MistralForCausalLM:()=>yx,MistralModel:()=>zS,MistralPreTrainedModel:()=>_x,MobileBertForMaskedLM:()=>dl,MobileBertForQuestionAnswering:()=>Ga,MobileBertForSequenceClassification:()=>ba,MobileBertModel:()=>Zi,MobileBertPreTrainedModel:()=>gn,MobileLLMForCausalLM:()=>tm,MobileLLMModel:()=>Hh,MobileLLMPreTrainedModel:()=>lh,MobileNetV1ForImageClassification:()=>Tx,MobileNetV1ForSemanticSegmentation:()=>hg,MobileNetV1Model:()=>Sx,MobileNetV1PreTrainedModel:()=>fp,MobileNetV2ForImageClassification:()=>X_,MobileNetV2ForSemanticSegmentation:()=>um,MobileNetV2Model:()=>cm,MobileNetV2PreTrainedModel:()=>fg,MobileNetV3ForImageClassification:()=>Px,MobileNetV3ForSemanticSegmentation:()=>mp,MobileNetV3Model:()=>XS,MobileNetV3PreTrainedModel:()=>pp,MobileNetV4ForImageClassification:()=>pg,MobileNetV4ForSemanticSegmentation:()=>ev,MobileNetV4Model:()=>Ex,MobileNetV4PreTrainedModel:()=>J0,MobileViTForImageClassification:()=>Lr,MobileViTModel:()=>Ar,MobileViTPreTrainedModel:()=>sr,MobileViTV2ForImageClassification:()=>zn,MobileViTV2Model:()=>Ur,MobileViTV2PreTrainedModel:()=>Zr,ModelOutput:()=>Xe,ModernBertDecoderForCausalLM:()=>Pt,ModernBertDecoderModel:()=>dt,ModernBertDecoderPreTrainedModel:()=>Qe,ModernBertForMaskedLM:()=>Se,ModernBertForSequenceClassification:()=>Pe,ModernBertForTokenClassification:()=>Ve,ModernBertModel:()=>tt,ModernBertPreTrainedModel:()=>or,Moondream1ForConditionalGeneration:()=>La,MoonshineForConditionalGeneration:()=>su,MoonshineModel:()=>Wh,MoonshinePreTrainedModel:()=>yc,MptForCausalLM:()=>im,MptModel:()=>ap,MptPreTrainedModel:()=>ef,MultiModalityCausalLM:()=>QS,MultiModalityPreTrainedModel:()=>YS,MusicgenForCausalLM:()=>Q0,MusicgenForConditionalGeneration:()=>dg,MusicgenModel:()=>ZS,MusicgenPreTrainedModel:()=>hp,NeoBertForMaskedLM:()=>wr,NeoBertForQuestionAnswering:()=>xr,NeoBertForSequenceClassification:()=>mr,NeoBertForTokenClassification:()=>hr,NeoBertModel:()=>Bt,NeoBertPreTrainedModel:()=>dr,NomicBertModel:()=>At,NomicBertPreTrainedModel:()=>Vt,OPTForCausalLM:()=>Pd,OPTModel:()=>sp,OPTPreTrainedModel:()=>rd,Olmo2ForCausalLM:()=>rm,Olmo2Model:()=>Jf,Olmo2PreTrainedModel:()=>ku,OlmoForCausalLM:()=>Cu,OlmoModel:()=>wd,OlmoPreTrainedModel:()=>xd,OpenELMForCausalLM:()=>Ra,OpenELMModel:()=>ko,OpenELMPreTrainedModel:()=>Zh,OwlViTForObjectDetection:()=>jn,OwlViTModel:()=>Si,OwlViTPreTrainedModel:()=>Cn,Owlv2ForObjectDetection:()=>En,Owlv2Model:()=>Ro,Owlv2PreTrainedModel:()=>Gi,PaliGemmaForConditionalGeneration:()=>Ql,PaliGemmaPreTrainedModel:()=>Ys,PatchTSMixerForPrediction:()=>kx,PatchTSMixerModel:()=>iT,PatchTSMixerPreTrainedModel:()=>tv,PatchTSTForPrediction:()=>nT,PatchTSTModel:()=>rT,PatchTSTPreTrainedModel:()=>gp,Phi3ForCausalLM:()=>Ml,Phi3Model:()=>fh,Phi3PreTrainedModel:()=>op,Phi3VForCausalLM:()=>xc,Phi3VPreTrainedModel:()=>_l,PhiForCausalLM:()=>ip,PhiModel:()=>np,PhiPreTrainedModel:()=>Jh,PreTrainedModel:()=>ke,PretrainedMixin:()=>Oo,PvtForImageClassification:()=>we,PvtModel:()=>le,PvtPreTrainedModel:()=>q,PyAnnoteForAudioFrameClassification:()=>nd,PyAnnoteModel:()=>Od,PyAnnotePreTrainedModel:()=>up,QuestionAnsweringModelOutput:()=>oc,Qwen2ForCausalLM:()=>Td,Qwen2Model:()=>Xh,Qwen2PreTrainedModel:()=>Ea,Qwen2VLForConditionalGeneration:()=>Qh,Qwen2VLPreTrainedModel:()=>du,Qwen3ForCausalLM:()=>Yh,Qwen3Model:()=>ls,Qwen3PreTrainedModel:()=>Zc,RFDetrForObjectDetection:()=>no,RFDetrModel:()=>si,RFDetrObjectDetectionOutput:()=>Io,RFDetrPreTrainedModel:()=>Bs,RTDetrForObjectDetection:()=>Xo,RTDetrModel:()=>cs,RTDetrObjectDetectionOutput:()=>Fi,RTDetrPreTrainedModel:()=>xn,RTDetrV2ForObjectDetection:()=>Li,RTDetrV2Model:()=>_a,RTDetrV2ObjectDetectionOutput:()=>Ps,RTDetrV2PreTrainedModel:()=>wi,ResNetForImageClassification:()=>b,ResNetModel:()=>p,ResNetPreTrainedModel:()=>l,RoFormerForMaskedLM:()=>fr,RoFormerForQuestionAnswering:()=>zr,RoFormerForSequenceClassification:()=>Jr,RoFormerForTokenClassification:()=>$t,RoFormerModel:()=>er,RoFormerPreTrainedModel:()=>qt,RobertaForMaskedLM:()=>_c,RobertaForQuestionAnswering:()=>Ss,RobertaForSequenceClassification:()=>Ms,RobertaForTokenClassification:()=>vo,RobertaModel:()=>Yl,RobertaPreTrainedModel:()=>fl,SamImageSegmentationOutput:()=>Qc,SamModel:()=>As,SamPreTrainedModel:()=>hs,SapiensForDepthEstimation:()=>gt,SapiensForNormalEstimation:()=>Et,SapiensForSemanticSegmentation:()=>ft,SapiensPreTrainedModel:()=>it,SegformerForImageClassification:()=>GS,SegformerForSemanticSegmentation:()=>qS,SegformerModel:()=>$k,SegformerPreTrainedModel:()=>Y0,Seq2SeqLMOutput:()=>FT,SequenceClassifierOutput:()=>xi,SiglipModel:()=>ec,SiglipPreTrainedModel:()=>Rs,SiglipTextModel:()=>tc,SiglipVisionModel:()=>Mc,SmolLM3ForCausalLM:()=>Qu,SmolLM3Model:()=>ah,SmolLM3PreTrainedModel:()=>Nl,SmolVLMForConditionalGeneration:()=>ua,SnacDecoderModel:()=>iv,SnacEncoderModel:()=>Dx,SnacModel:()=>hT,SnacPreTrainedModel:()=>nv,SpeechT5ForSpeechToText:()=>kc,SpeechT5ForTextToSpeech:()=>mx,SpeechT5HifiGan:()=>q0,SpeechT5Model:()=>H_,SpeechT5PreTrainedModel:()=>cg,SqueezeBertForMaskedLM:()=>Ft,SqueezeBertForQuestionAnswering:()=>yr,SqueezeBertForSequenceClassification:()=>Dt,SqueezeBertModel:()=>Tt,SqueezeBertPreTrainedModel:()=>rt,StableLmForCausalLM:()=>Mx,StableLmModel:()=>HS,StableLmPreTrainedModel:()=>Z_,Starcoder2ForCausalLM:()=>US,Starcoder2Model:()=>BS,Starcoder2PreTrainedModel:()=>K0,StyleTextToSpeech2Model:()=>px,StyleTextToSpeech2PreTrainedModel:()=>G0,Swin2SRForImageSuperResolution:()=>ce,Swin2SRModel:()=>ie,Swin2SRPreTrainedModel:()=>Z,SwinForImageClassification:()=>R,SwinForSemanticSegmentation:()=>W,SwinModel:()=>k,SwinPreTrainedModel:()=>S,T5ForConditionalGeneration:()=>Ai,T5Model:()=>vi,T5PreTrainedModel:()=>Ii,TableTransformerForObjectDetection:()=>ds,TableTransformerModel:()=>Za,TableTransformerObjectDetectionOutput:()=>Us,TableTransformerPreTrainedModel:()=>Ka,TokenClassifierOutput:()=>fs,TrOCRForCausalLM:()=>gx,TrOCRPreTrainedModel:()=>FS,UltravoxModel:()=>Y_,UltravoxPreTrainedModel:()=>oT,UniSpeechForCTC:()=>DS,UniSpeechForSequenceClassification:()=>sx,UniSpeechModel:()=>ax,UniSpeechPreTrainedModel:()=>ag,UniSpeechSatForAudioFrameClassification:()=>lx,UniSpeechSatForCTC:()=>$S,UniSpeechSatForSequenceClassification:()=>V0,UniSpeechSatModel:()=>U0,UniSpeechSatPreTrainedModel:()=>W_,ViTForImageClassification:()=>ic,ViTMAEModel:()=>Ze,ViTMAEPreTrainedModel:()=>Be,ViTMSNForImageClassification:()=>ht,ViTMSNModel:()=>nt,ViTMSNPreTrainedModel:()=>Re,ViTModel:()=>Sl,ViTPreTrainedModel:()=>lp,VisionEncoderDecoderModel:()=>ml,VitMatteForImageMatting:()=>Tr,VitMattePreTrainedModel:()=>tr,VitPoseForPoseEstimation:()=>B,VitPosePreTrainedModel:()=>om,VitsModel:()=>wx,VitsModelOutput:()=>UT,VitsPreTrainedModel:()=>WS,VoxtralForConditionalGeneration:()=>mg,Wav2Vec2BertForCTC:()=>NS,Wav2Vec2BertForSequenceClassification:()=>sg,Wav2Vec2BertModel:()=>sm,Wav2Vec2BertPreTrainedModel:()=>G_,Wav2Vec2ForAudioFrameClassification:()=>am,Wav2Vec2ForCTC:()=>V_,Wav2Vec2ForSequenceClassification:()=>og,Wav2Vec2Model:()=>Cc,Wav2Vec2PreTrainedModel:()=>Id,WavLMForAudioFrameClassification:()=>RS,WavLMForCTC:()=>dx,WavLMForSequenceClassification:()=>hx,WavLMForXVector:()=>fx,WavLMModel:()=>jS,WavLMPreTrainedModel:()=>lg,WeSpeakerResNetModel:()=>LS,WeSpeakerResNetPreTrainedModel:()=>ox,WhisperForConditionalGeneration:()=>Oa,WhisperModel:()=>jo,WhisperPreTrainedModel:()=>ca,XLMForQuestionAnswering:()=>Er,XLMForSequenceClassification:()=>Ut,XLMForTokenClassification:()=>Qt,XLMModel:()=>ze,XLMPreTrainedModel:()=>re,XLMRobertaForMaskedLM:()=>vn,XLMRobertaForQuestionAnswering:()=>Ui,XLMRobertaForSequenceClassification:()=>Zn,XLMRobertaForTokenClassification:()=>Xn,XLMRobertaModel:()=>Sn,XLMRobertaPreTrainedModel:()=>jr,XLMWithLMHeadModel:()=>pt,XVectorOutput:()=>Jx,YolosForObjectDetection:()=>zl,YolosModel:()=>hu,YolosObjectDetectionOutput:()=>Cd,YolosPreTrainedModel:()=>Fl});var n=r("./src/configs.js"),i=r("./src/backends/onnx.js"),o=r("./src/utils/dtypes.js"),s=r("./src/utils/generic.js"),a=r("./src/utils/core.js"),u=r("./src/utils/hub.js"),d=r("./src/utils/constants.js"),m=r("./src/generation/logits_process.js"),g=r("./src/generation/configuration_utils.js"),_=r("./src/utils/tensor.js"),y=r("./src/utils/image.js"),M=r("./src/utils/maths.js"),x=r("./src/generation/stopping_criteria.js"),E=r("./src/generation/logits_sampler.js"),T=r("./src/env.js"),P=r("./src/models/whisper/generation_whisper.js"),C=r("./src/models/whisper/common_whisper.js");const D={EncoderOnly:0,EncoderDecoder:1,Seq2Seq:2,Vision2Seq:3,DecoderOnly:4,MaskGeneration:5,ImageTextToText:6,Musicgen:7,MultiModality:8,Phi3V:9,AudioTextToText:10,AutoEncoder:11,ImageAudioTextToText:12},L=new Map,N=new Map,j=new Map;async function $(se,Me,qe){var tl;let zt=((tl=qe.config)==null?void 0:tl["transformers.js_config"])??{},ir=qe.device??zt.device;ir&&typeof ir!="string"&&(ir.hasOwnProperty(Me)?ir=ir[Me]:(console.warn(`device not specified for "${Me}". Using the default device.`),ir=null));const rr=ir??(T.apis.IS_NODE_ENV?"cpu":"wasm"),Mr=(0,i.deviceToExecutionProviders)(rr),Kr=zt.device_config??{};Kr.hasOwnProperty(rr)&&(zt={...zt,...Kr[rr]});let sn=qe.dtype??zt.dtype;if(typeof sn!="string"&&(sn&&sn.hasOwnProperty(Me)?sn=sn[Me]:(sn=o.DEFAULT_DEVICE_DTYPE_MAPPING[rr]??o.DATA_TYPES.fp32,console.warn(`dtype not specified for "${Me}". Using the default dtype (${sn}) for this device (${rr}).`))),sn===o.DATA_TYPES.auto){let Vi=zt.dtype;typeof Vi!="string"&&(Vi=Vi==null?void 0:Vi[Me]),Vi&&Vi!==o.DATA_TYPES.auto&&o.DATA_TYPES.hasOwnProperty(Vi)?sn=Vi:sn=o.DEFAULT_DEVICE_DTYPE_MAPPING[rr]??o.DATA_TYPES.fp32}const _n=sn;if(o.DEFAULT_DTYPE_SUFFIX_MAPPING.hasOwnProperty(_n)){if(_n===o.DATA_TYPES.fp16&&rr==="webgpu"&&!await(0,o.isWebGpuFp16Supported)())throw new Error(`The device (${rr}) does not support fp16.`)}else throw new Error(`Invalid dtype: ${_n}. Should be one of: ${Object.keys(o.DATA_TYPES).join(", ")}`);const qn=zt.kv_cache_dtype,fi=qn?typeof qn=="string"?qn:qn[_n]??"float32":void 0;if(fi&&!["float32","float16"].includes(fi))throw new Error(`Invalid kv_cache_dtype: ${fi}. Should be one of: float32, float16`);const li={dtype:_n,kv_cache_dtype:fi,device:rr},io=o.DEFAULT_DTYPE_SUFFIX_MAPPING[_n],ti=`${Me}${io}.onnx`,Di=`${qe.subfolder??""}/${ti}`,Pn={...qe.session_options};Pn.executionProviders??(Pn.executionProviders=Mr);const $i=zt.free_dimension_overrides;$i?Pn.freeDimensionOverrides??(Pn.freeDimensionOverrides=$i):rr.startsWith("webnn")&&!Pn.freeDimensionOverrides&&console.warn(`WebNN does not currently support dynamic shapes and requires 'free_dimension_overrides' to be set in config.json, preferably as a field within config["transformers.js_config"]["device_config"]["${rr}"]. When 'free_dimension_overrides' is not set, you may experience significant performance degradation.`);const Lo=T.apis.IS_NODE_ENV&&T.env.useFSCache,Go=(0,u.getModelFile)(se,Di,!0,qe,Lo),Qa=qe.use_external_data_format??zt.use_external_data_format;let za=[];if(Qa){let Vi;typeof Qa=="object"?Qa.hasOwnProperty(ti)?Vi=Qa[ti]:Qa.hasOwnProperty(Me)?Vi=Qa[Me]:Vi=!1:Vi=Qa;const Ws=+Vi;if(Ws>u.MAX_EXTERNAL_DATA_CHUNKS)throw new Error(`The number of external data chunks (${Ws}) exceeds the maximum allowed value (${u.MAX_EXTERNAL_DATA_CHUNKS}).`);for(let rl=0;rl<Ws;++rl){const _p=`${ti}_data${rl===0?"":"_"+rl}`,Ic=`${qe.subfolder??""}/${_p}`;za.push(new Promise(async(Ou,ty)=>{const pm=await(0,u.getModelFile)(se,Ic,!0,qe,Lo);Ou(pm instanceof Uint8Array?{path:_p,data:pm}:_p)}))}}else Pn.externalData!==void 0&&(za=Pn.externalData.map(async Vi=>{if(typeof Vi.data=="string"){const Ws=await(0,u.getModelFile)(se,Vi.data,!0,qe);return{...Vi,data:Ws}}return Vi}));if(za.length>0){const Vi=await Promise.all(za);T.apis.IS_NODE_ENV||(Pn.externalData=Vi)}if(rr==="webgpu"){const Vi=(0,n.getCacheShapes)(qe.config,{prefix:"present"});if(Object.keys(Vi).length>0&&!(0,i.isONNXProxy)()){const Ws={};for(const rl in Vi)Ws[rl]="gpu-buffer";Pn.preferredOutputLocation=Ws}}return{buffer_or_path:await Go,session_options:Pn,session_config:li}}async function U(se,Me,qe){return Object.fromEntries(await Promise.all(Object.keys(Me).map(async zt=>{const{buffer_or_path:ir,session_options:rr,session_config:Mr}=await $(se,Me[zt],qe),Kr=await(0,i.createInferenceSession)(ir,rr,Mr);return[zt,Kr]})))}async function G(se,Me,qe){return Object.fromEntries(await Promise.all(Object.keys(Me).map(async zt=>{const ir=await(0,u.getModelJSON)(se,Me[zt],!1,qe);return[zt,ir]})))}function H(se,Me){const qe=Object.create(null),zt=[];for(const Mr of se.inputNames){const Kr=Me[Mr];if(!(Kr instanceof _.Tensor)){zt.push(Mr);continue}qe[Mr]=(0,i.isONNXProxy)()?Kr.clone():Kr}if(zt.length>0)throw new Error(`An error occurred during model execution: "Missing the following inputs: ${zt.join(", ")}.`);const ir=Object.keys(Me).length,rr=se.inputNames.length;if(ir>rr){let Mr=Object.keys(Me).filter(Kr=>!se.inputNames.includes(Kr));console.warn(`WARNING: Too many inputs were provided (${ir} > ${rr}). The following inputs will be ignored: "${Mr.join(", ")}".`)}return qe}let X=Promise.resolve();async function ee(se,Me){const qe=H(se,Me);try{const zt=Object.fromEntries(Object.entries(qe).map(([Mr,Kr])=>[Mr,Kr.ort_tensor])),ir=()=>se.run(zt),rr=await(T.apis.IS_BROWSER_ENV||T.apis.IS_WEBWORKER_ENV?X=X.then(ir):ir());return ae(rr)}catch(zt){const ir=Object.fromEntries(Object.entries(qe).map(([rr,Mr])=>{const Kr={type:Mr.type,dims:Mr.dims,location:Mr.location};return Kr.location!=="gpu-buffer"&&(Kr.data=Mr.data),[rr,Kr]}));throw console.error(`An error occurred during model execution: "${zt}".`),console.error("Inputs given to model:",ir),zt}}function ae(se){for(let Me in se)(0,i.isONNXTensor)(se[Me])?se[Me]=new _.Tensor(se[Me]):typeof se[Me]=="object"&&ae(se[Me]);return se}function de(se){if(se instanceof _.Tensor)return se;if(se.length===0)throw Error("items must be non-empty");if(Array.isArray(se[0])){if(se.some(Me=>Me.length!==se[0].length))throw Error("Unable to create tensor, you should probably activate truncation and/or padding with 'padding=True' and/or 'truncation=True' to have batched tensors with the same length.");return new _.Tensor("int64",BigInt64Array.from(se.flat().map(Me=>BigInt(Me))),[se.length,se[0].length])}else return new _.Tensor("int64",BigInt64Array.from(se.map(Me=>BigInt(Me))),[1,se.length])}function ye(se){return new _.Tensor("bool",[se],[1])}async function _e(se,Me){let{encoder_outputs:qe,input_ids:zt,decoder_input_ids:ir,...rr}=Me;if(!qe){const Kr=(0,a.pick)(Me,se.sessions.model.inputNames);qe=(await ue(se,Kr)).last_hidden_state}return rr.input_ids=ir,rr.encoder_hidden_states=qe,se.sessions.decoder_model_merged.inputNames.includes("encoder_attention_mask")&&(rr.encoder_attention_mask=Me.attention_mask),await De(se,rr,!0)}async function ue(se,Me){const qe=se.sessions.model,zt=(0,a.pick)(Me,qe.inputNames);if(qe.inputNames.includes("inputs_embeds")&&!zt.inputs_embeds){if(!Me.input_ids)throw new Error("Both `input_ids` and `inputs_embeds` are missing in the model inputs.");zt.inputs_embeds=await se.encode_text({input_ids:Me.input_ids})}if(qe.inputNames.includes("token_type_ids")&&!zt.token_type_ids){if(!zt.input_ids)throw new Error("Both `input_ids` and `token_type_ids` are missing in the model inputs.");zt.token_type_ids=(0,_.zeros_like)(zt.input_ids)}if(qe.inputNames.includes("pixel_mask")&&!zt.pixel_mask){if(!zt.pixel_values)throw new Error("Both `pixel_values` and `pixel_mask` are missing in the model inputs.");const ir=zt.pixel_values.dims;zt.pixel_mask=(0,_.ones)([ir[0],ir[2],ir[3]])}return await ee(qe,zt)}async function fe(se,Me){const qe=await se.encode(Me);return await se.decode(qe)}async function De(se,Me,qe=!1){const zt=se.sessions[qe?"decoder_model_merged":"model"],{past_key_values:ir,...rr}=Me;if(zt.inputNames.includes("use_cache_branch")&&(rr.use_cache_branch=ye(!!ir)),zt.inputNames.includes("position_ids")&&rr.attention_mask&&!rr.position_ids){const Kr=["paligemma","gemma3_text","gemma3"].includes(se.config.model_type)?1:0;rr.position_ids=ot(rr,ir,Kr)}se.addPastKeyValues(rr,ir);const Mr=(0,a.pick)(rr,zt.inputNames);return await ee(zt,Mr)}function pe({modality_token_id:se,inputs_embeds:Me,modality_features:qe,input_ids:zt,attention_mask:ir}){const rr=zt.tolist().map(_n=>_n.reduce((qn,fi,li)=>(fi==se&&qn.push(li),qn),[])),Mr=rr.reduce((_n,qn)=>_n+qn.length,0),Kr=qe.dims[0];if(Mr!==Kr)throw new Error(`Number of tokens and features do not match: tokens: ${Mr}, features ${Kr}`);let sn=0;for(let _n=0;_n<rr.length;++_n){const qn=rr[_n],fi=Me[_n];for(let li=0;li<qn.length;++li)fi[qn[li]].data.set(qe[sn++].data)}return{inputs_embeds:Me,attention_mask:ir}}function K({image_token_id:se,inputs_embeds:Me,image_features:qe,input_ids:zt,attention_mask:ir}){return pe({modality_token_id:se,inputs_embeds:Me,modality_features:qe,input_ids:zt,attention_mask:ir})}function te({audio_token_id:se,inputs_embeds:Me,audio_features:qe,input_ids:zt,attention_mask:ir}){return pe({modality_token_id:se,inputs_embeds:Me,modality_features:qe,input_ids:zt,attention_mask:ir})}async function ve(se,{encode_function:Me,merge_function:qe,modality_input_name:zt,modality_output_name:ir,input_ids:rr=null,attention_mask:Mr=null,position_ids:Kr=null,inputs_embeds:sn=null,past_key_values:_n=null,generation_config:qn=null,logits_processor:fi=null,...li}){const io=li[zt];if(!sn){if(sn=await se.encode_text({input_ids:rr,...li}),io&&rr.dims[1]!==1){const Di=await Me({[zt]:io,...li});({inputs_embeds:sn,attention_mask:Mr}=qe({[ir]:Di,inputs_embeds:sn,input_ids:rr,attention_mask:Mr}))}else if(_n&&io&&rr.dims[1]===1){const Di=rr.dims[1],Pn=Object.values(_n)[0].dims.at(-2);Mr=(0,_.cat)([(0,_.ones)([rr.dims[0],Pn]),Mr.slice(null,[Mr.dims[1]-Di,Mr.dims[1]])],1)}}if(!Kr&&se.config.model_type==="qwen2_vl"){const{image_grid_thw:Di,video_grid_thw:Pn}=li;[Kr]=se.get_rope_index(rr,Di,Pn,Mr)}return await De(se,{inputs_embeds:sn,past_key_values:_n,attention_mask:Mr,position_ids:Kr,generation_config:qn,logits_processor:fi},!0)}async function $e(se,Me){return await ve(se,{...Me,modality_input_name:"audio_values",modality_output_name:"audio_features",encode_function:se.encode_audio.bind(se),merge_function:se._merge_input_ids_with_audio_features.bind(se)})}async function Ce(se,Me){return await ve(se,{...Me,modality_input_name:"pixel_values",modality_output_name:"image_features",encode_function:se.encode_image.bind(se),merge_function:se._merge_input_ids_with_image_features.bind(se)})}function Ge(se,Me=0){const[qe,zt]=se.dims,ir=se.data,rr=new BigInt64Array(ir.length);for(let Mr=0;Mr<qe;++Mr){const Kr=Mr*zt;let sn=BigInt(Me);for(let _n=0;_n<zt;++_n){const qn=Kr+_n;ir[qn]===0n?rr[qn]=BigInt(1):(rr[qn]=sn,sn+=ir[qn])}}return{data:rr,dims:se.dims}}function ot(se,Me=null,qe=0){const{input_ids:zt,inputs_embeds:ir,attention_mask:rr}=se,{data:Mr,dims:Kr}=Ge(rr,qe);let sn=new _.Tensor("int64",Mr,Kr);if(Me){const _n=-(zt??ir).dims.at(1);sn=sn.slice(null,[_n,null])}return sn}function Ye(se,Me,qe,zt){const ir=qe.past_key_values?Object.values(qe.past_key_values)[0].dims.at(-2):0;if(!qe.attention_mask){let rr;for(const Mr of["input_ids","inputs_embeds","position_ids"])if(qe[Mr]){rr=qe[Mr].dims;break}if(!rr)throw new Error("attention_mask is not provided, and unable to infer its shape from model inputs.");qe.attention_mask=(0,_.ones)([rr[0],ir+rr[1]])}if(qe.past_key_values){const{input_ids:rr,attention_mask:Mr}=qe;Mr&&Mr.dims[1]>rr.dims[1]||ir<rr.dims[1]&&(qe.input_ids=rr.slice(null,[ir,null]))}return qe}function et(se,Me,qe,zt){return qe.past_key_values&&(Me=Me.map(ir=>[ir.at(-1)])),{...qe,decoder_input_ids:de(Me)}}function Te(se,...Me){return se.config.is_encoder_decoder?et(se,...Me):Ye(se,...Me)}function Le(se,Me,qe,zt){const ir=!!qe.past_key_values;return zt.guidance_scale!==null&&zt.guidance_scale>1&&(ir?qe.input_ids=(0,_.cat)([qe.input_ids,qe.input_ids],0):(qe.input_ids=(0,_.cat)([qe.input_ids,(0,_.full_like)(qe.input_ids,BigInt(zt.pad_token_id))],0),qe.attention_mask=(0,_.cat)([qe.attention_mask,(0,_.full_like)(qe.attention_mask,0n)],0))),(ir||!qe.pixel_values)&&(qe.pixel_values=(0,_.full)([0,0,3,384,384],1)),ir&&(qe.images_seq_mask=new _.Tensor("bool",new Array(1).fill(!0).fill(!1,0,1),[1,1]),qe.images_emb_mask=new _.Tensor("bool",new Array(0).fill(!1),[1,1,0])),qe}class ke extends s.Callable{constructor(qe,zt,ir){super();_t(this,"main_input_name","input_ids");_t(this,"forward_params",["input_ids","attention_mask"]);this.config=qe,this.sessions=zt,this.configs=ir;const rr=j.get(this.constructor),Mr=L.get(rr);switch(this.can_generate=!1,this._forward=null,this._prepare_inputs_for_generation=null,Mr){case D.DecoderOnly:this.can_generate=!0,this._forward=De,this._prepare_inputs_for_generation=Ye;break;case D.Seq2Seq:case D.Vision2Seq:case D.Musicgen:this.can_generate=!0,this._forward=_e,this._prepare_inputs_for_generation=et;break;case D.EncoderDecoder:this._forward=_e;break;case D.ImageTextToText:this.can_generate=!0,this._forward=Ce,this._prepare_inputs_for_generation=Te;break;case D.AudioTextToText:this.can_generate=!0,this._forward=$e,this._prepare_inputs_for_generation=Te;break;case D.Phi3V:case D.ImageAudioTextToText:this.can_generate=!0,this._prepare_inputs_for_generation=Te;break;case D.MultiModality:this.can_generate=!0,this._prepare_inputs_for_generation=Le;break;case D.AutoEncoder:this._forward=fe;break;default:this._forward=ue;break}this.can_generate&&this.forward_params.push("past_key_values"),this.custom_config=this.config["transformers.js_config"]??{}}async dispose(){var zt;const qe=[];for(const ir of Object.values(this.sessions))(zt=ir==null?void 0:ir.handler)!=null&&zt.dispose&&qe.push(ir.handler.dispose());return await Promise.all(qe)}static async from_pretrained(qe,{progress_callback:zt=null,config:ir=null,cache_dir:rr=null,local_files_only:Mr=!1,revision:Kr="main",model_file_name:sn=null,subfolder:_n="onnx",device:qn=null,dtype:fi=null,use_external_data_format:li=null,session_options:io={}}={}){let ti={progress_callback:zt,config:ir,cache_dir:rr,local_files_only:Mr,revision:Kr,model_file_name:sn,subfolder:_n,device:qn,dtype:fi,use_external_data_format:li,session_options:io};const Di=j.get(this),Pn=L.get(Di);ir=ti.config=await n.AutoConfig.from_pretrained(qe,ti);let $i;if(Pn===D.DecoderOnly)$i=await Promise.all([U(qe,{model:ti.model_file_name??"model"},ti),G(qe,{generation_config:"generation_config.json"},ti)]);else if(Pn===D.Seq2Seq||Pn===D.Vision2Seq)$i=await Promise.all([U(qe,{model:"encoder_model",decoder_model_merged:"decoder_model_merged"},ti),G(qe,{generation_config:"generation_config.json"},ti)]);else if(Pn===D.MaskGeneration)$i=await Promise.all([U(qe,{model:"vision_encoder",prompt_encoder_mask_decoder:"prompt_encoder_mask_decoder"},ti)]);else if(Pn===D.EncoderDecoder)$i=await Promise.all([U(qe,{model:"encoder_model",decoder_model_merged:"decoder_model_merged"},ti)]);else if(Pn===D.ImageTextToText){const Lo={embed_tokens:"embed_tokens",vision_encoder:"vision_encoder",decoder_model_merged:"decoder_model_merged"};ir.is_encoder_decoder&&(Lo.model="encoder_model"),$i=await Promise.all([U(qe,Lo,ti),G(qe,{generation_config:"generation_config.json"},ti)])}else if(Pn===D.AudioTextToText){const Lo={embed_tokens:"embed_tokens",audio_encoder:"audio_encoder",decoder_model_merged:"decoder_model_merged"};$i=await Promise.all([U(qe,Lo,ti),G(qe,{generation_config:"generation_config.json"},ti)])}else if(Pn===D.ImageAudioTextToText){const Lo={embed_tokens:"embed_tokens",audio_encoder:"audio_encoder",vision_encoder:"vision_encoder",decoder_model_merged:"decoder_model_merged"};$i=await Promise.all([U(qe,Lo,ti),G(qe,{generation_config:"generation_config.json"},ti)])}else if(Pn===D.Musicgen)$i=await Promise.all([U(qe,{model:"text_encoder",decoder_model_merged:"decoder_model_merged",encodec_decode:"encodec_decode"},ti),G(qe,{generation_config:"generation_config.json"},ti)]);else if(Pn===D.MultiModality)$i=await Promise.all([U(qe,{prepare_inputs_embeds:"prepare_inputs_embeds",model:"language_model",lm_head:"lm_head",gen_head:"gen_head",gen_img_embeds:"gen_img_embeds",image_decode:"image_decode"},ti),G(qe,{generation_config:"generation_config.json"},ti)]);else if(Pn===D.Phi3V)$i=await Promise.all([U(qe,{prepare_inputs_embeds:"prepare_inputs_embeds",model:"model",vision_encoder:"vision_encoder"},ti),G(qe,{generation_config:"generation_config.json"},ti)]);else if(Pn===D.AutoEncoder)$i=await Promise.all([U(qe,{encoder_model:"encoder_model",decoder_model:"decoder_model"},ti)]);else{if(Pn!==D.EncoderOnly){const Lo=Di??(ir==null?void 0:ir.model_type);Lo!=="custom"&&console.warn(`Model type for '${Lo}' not found, assuming encoder-only architecture. Please report this at ${d.GITHUB_ISSUE_URL}.`)}$i=await Promise.all([U(qe,{model:ti.model_file_name??"model"},ti)])}return new this(ir,...$i)}async _call(qe){return await this.forward(qe)}async forward(qe){return await this._forward(this,qe)}get generation_config(){var qe;return((qe=this.configs)==null?void 0:qe.generation_config)??null}_get_logits_warper(qe){const zt=new m.LogitsProcessorList;return qe.temperature!==null&&qe.temperature!==1&&zt.push(new m.TemperatureLogitsWarper(qe.temperature)),qe.top_k!==null&&qe.top_k!==0&&zt.push(new m.TopKLogitsWarper(qe.top_k)),qe.top_p!==null&&qe.top_p<1&&zt.push(new m.TopPLogitsWarper(qe.top_p)),zt}_get_logits_processor(qe,zt,ir=null){const rr=new m.LogitsProcessorList;if(qe.repetition_penalty!==null&&qe.repetition_penalty!==1&&rr.push(new m.RepetitionPenaltyLogitsProcessor(qe.repetition_penalty)),qe.no_repeat_ngram_size!==null&&qe.no_repeat_ngram_size>0&&rr.push(new m.NoRepeatNGramLogitsProcessor(qe.no_repeat_ngram_size)),qe.bad_words_ids!==null&&rr.push(new m.NoBadWordsLogitsProcessor(qe.bad_words_ids,qe.eos_token_id)),qe.min_length!==null&&qe.eos_token_id!==null&&qe.min_length>0&&rr.push(new m.MinLengthLogitsProcessor(qe.min_length,qe.eos_token_id)),qe.min_new_tokens!==null&&qe.eos_token_id!==null&&qe.min_new_tokens>0&&rr.push(new m.MinNewTokensLengthLogitsProcessor(zt,qe.min_new_tokens,qe.eos_token_id)),qe.forced_bos_token_id!==null&&rr.push(new m.ForcedBOSTokenLogitsProcessor(qe.forced_bos_token_id)),qe.forced_eos_token_id!==null&&rr.push(new m.ForcedEOSTokenLogitsProcessor(qe.max_length,qe.forced_eos_token_id)),qe.begin_suppress_tokens!==null){const Mr=zt>1||qe.forced_bos_token_id===null?zt:zt+1;rr.push(new m.SuppressTokensAtBeginLogitsProcessor(qe.begin_suppress_tokens,Mr))}return qe.guidance_scale!==null&&qe.guidance_scale>1&&rr.push(new m.ClassifierFreeGuidanceLogitsProcessor(qe.guidance_scale)),ir!==null&&rr.extend(ir),rr}_prepare_generation_config(qe,zt,ir=g.GenerationConfig){const rr={...this.config};for(const Kr of["decoder","generator","text_config"])Kr in rr&&Object.assign(rr,rr[Kr]);const Mr=new ir(rr);return Object.assign(Mr,this.generation_config??{}),qe&&Object.assign(Mr,qe),zt&&Object.assign(Mr,(0,a.pick)(zt,Object.getOwnPropertyNames(Mr))),Mr}_get_stopping_criteria(qe,zt=null){const ir=new x.StoppingCriteriaList;return qe.max_length!==null&&ir.push(new x.MaxLengthCriteria(qe.max_length,this.config.max_position_embeddings??null)),qe.eos_token_id!==null&&ir.push(new x.EosTokenCriteria(qe.eos_token_id)),zt&&ir.extend(zt),ir}_validate_model_class(){if(!this.can_generate){const qe=[jx,Q_,av,$x],zt=j.get(this.constructor),ir=new Set,rr=this.config.model_type;for(const Kr of qe){const sn=Kr.get(rr);sn&&ir.add(sn[0])}let Mr=`The current model class (${zt}) is not compatible with \`.generate()\`, as it doesn't have a language model head.`;throw ir.size>0&&(Mr+=` Please use the following class instead: ${[...ir].join(", ")}`),Error(Mr)}}prepare_inputs_for_generation(...qe){return this._prepare_inputs_for_generation(this,...qe)}_update_model_kwargs_for_generation({generated_input_ids:qe,outputs:zt,model_inputs:ir,is_encoder_decoder:rr}){return ir.past_key_values=this.getPastKeyValues(zt,ir.past_key_values),ir.input_ids=new _.Tensor("int64",qe.flat(),[qe.length,1]),rr||(ir.attention_mask=(0,_.cat)([ir.attention_mask,(0,_.ones)([ir.attention_mask.dims[0],1])],1)),ir.position_ids=null,ir}_prepare_model_inputs({inputs:qe,bos_token_id:zt,model_kwargs:ir}){const rr=(0,a.pick)(ir,this.forward_params),Mr=this.main_input_name;if(Mr in rr){if(qe)throw new Error("`inputs`: {inputs}` were passed alongside {input_name} which is not allowed. Make sure to either pass {inputs} or {input_name}=...")}else rr[Mr]=qe;return{inputs_tensor:rr[Mr],model_inputs:rr,model_input_name:Mr}}async _prepare_encoder_decoder_kwargs_for_generation({inputs_tensor:qe,model_inputs:zt,model_input_name:ir,generation_config:rr}){if(this.sessions.model.inputNames.includes("inputs_embeds")&&!zt.inputs_embeds&&"_prepare_inputs_embeds"in this){const{input_ids:Kr,pixel_values:sn,attention_mask:_n,...qn}=zt,fi=await this._prepare_inputs_embeds(zt);zt={...qn,...(0,a.pick)(fi,["inputs_embeds","attention_mask"])}}let{last_hidden_state:Mr}=await ue(this,zt);if(rr.guidance_scale!==null&&rr.guidance_scale>1)Mr=(0,_.cat)([Mr,(0,_.full_like)(Mr,0)],0),"attention_mask"in zt&&(zt.attention_mask=(0,_.cat)([zt.attention_mask,(0,_.zeros_like)(zt.attention_mask)],0));else if(zt.decoder_input_ids){const Kr=de(zt.decoder_input_ids).dims[0];if(Kr!==Mr.dims[0]){if(Mr.dims[0]!==1)throw new Error(`The encoder outputs have a different batch size (${Mr.dims[0]}) than the decoder inputs (${Kr}).`);Mr=(0,_.cat)(Array.from({length:Kr},()=>Mr),0)}}return zt.encoder_outputs=Mr,zt}_prepare_decoder_input_ids_for_generation({batch_size:qe,model_input_name:zt,model_kwargs:ir,decoder_start_token_id:rr,bos_token_id:Mr,generation_config:Kr}){let{decoder_input_ids:sn,..._n}=ir;if(!(sn instanceof _.Tensor)){if(sn)Array.isArray(sn[0])||(sn=Array.from({length:qe},()=>sn));else if(rr??(rr=Mr),this.config.model_type==="musicgen")sn=Array.from({length:qe*this.config.decoder.num_codebooks},()=>[rr]);else if(Array.isArray(rr)){if(rr.length!==qe)throw new Error(`\`decoder_start_token_id\` expcted to have length ${qe} but got ${rr.length}`);sn=rr}else sn=Array.from({length:qe},()=>[rr]);sn=de(sn)}return ir.decoder_attention_mask=(0,_.ones_like)(sn),{input_ids:sn,model_inputs:_n}}async generate({inputs:qe=null,generation_config:zt=null,logits_processor:ir=null,stopping_criteria:rr=null,streamer:Mr=null,...Kr}){this._validate_model_class(),zt=this._prepare_generation_config(zt,Kr);let{inputs_tensor:sn,model_inputs:_n,model_input_name:qn}=this._prepare_model_inputs({inputs:qe,model_kwargs:Kr});const fi=this.config.is_encoder_decoder;fi&&("encoder_outputs"in _n||(_n=await this._prepare_encoder_decoder_kwargs_for_generation({inputs_tensor:sn,model_inputs:_n,model_input_name:qn,generation_config:zt})));let li;fi?{input_ids:li,model_inputs:_n}=this._prepare_decoder_input_ids_for_generation({batch_size:_n[qn].dims.at(0),model_input_name:qn,model_kwargs:_n,decoder_start_token_id:zt.decoder_start_token_id,bos_token_id:zt.bos_token_id,generation_config:zt}):li=_n[qn];let io=li.dims.at(-1);zt.max_new_tokens!==null&&(zt.max_length=io+zt.max_new_tokens);const ti=this._get_logits_processor(zt,io,ir),Di=this._get_stopping_criteria(zt,rr),Pn=_n[qn].dims.at(0),$i=E.LogitsSampler.getSampler(zt),Lo=new Array(Pn).fill(0),Go=li.tolist();Mr&&Mr.put(Go);let Qa,za={};for(;;){if(_n=this.prepare_inputs_for_generation(Go,_n,zt),Qa=await this.forward(_n),zt.output_attentions&&zt.return_dict_in_generate){const Ic=this.getAttentions(Qa);for(const Ou in Ic)Ou in za||(za[Ou]=[]),za[Ou].push(Ic[Ou])}const Vi=Qa.logits.slice(null,-1,null),Ws=ti(Go,Vi),rl=[];for(let Ic=0;Ic<Ws.dims.at(0);++Ic){const Ou=Ws[Ic],ty=await $i(Ou);for(const[pm,pv]of ty){const ry=BigInt(pm);Lo[Ic]+=pv,Go[Ic].push(ry),rl.push([ry]);break}}if(Mr&&Mr.put(rl),Di(Go).every(Ic=>Ic))break;_n=this._update_model_kwargs_for_generation({generated_input_ids:rl,outputs:Qa,model_inputs:_n,is_encoder_decoder:fi})}Mr&&Mr.end();const Cs=this.getPastKeyValues(Qa,_n.past_key_values,!0),tl=new _.Tensor("int64",Go.flat(),[Go.length,Go[0].length]);if(zt.return_dict_in_generate)return{sequences:tl,past_key_values:Cs,...za};for(const Vi of Object.values(Qa))Vi.location==="gpu-buffer"&&Vi.dispose();return tl}getPastKeyValues(qe,zt,ir=!1){const rr=Object.create(null);for(const Mr in qe)if(Mr.startsWith("present")){const Kr=Mr.replace("present_conv","past_conv").replace("present","past_key_values"),sn=Mr.includes("encoder");if(sn&&zt?rr[Kr]=zt[Kr]:rr[Kr]=qe[Mr],zt&&(!sn||ir)){const _n=zt[Kr];_n.location==="gpu-buffer"&&_n.dispose()}}return rr}getAttentions(qe){const zt={};for(const ir of["cross_attentions","encoder_attentions","decoder_attentions"])for(const rr in qe)rr.startsWith(ir)&&(ir in zt||(zt[ir]=[]),zt[ir].push(qe[rr]));return zt}addPastKeyValues(qe,zt){var ir,rr,Mr;if(zt)Object.assign(qe,zt);else{const Kr=this.sessions.decoder_model_merged??this.sessions.model,sn=((rr=(ir=qe[this.main_input_name]??qe.attention_mask)==null?void 0:ir.dims)==null?void 0:rr[0])??1,_n=((Mr=Kr==null?void 0:Kr.config)==null?void 0:Mr.kv_cache_dtype)??"float32",qn=_n==="float16"?_.DataTypeMap.float16:_.DataTypeMap.float32,fi=(0,n.getCacheShapes)(this.config,{batch_size:sn});for(const li in fi){const io=fi[li].reduce((ti,Di)=>ti*Di,1);qe[li]=new _.Tensor(_n,new qn(io),fi[li])}}}async encode_image({pixel_values:qe}){return(await ee(this.sessions.vision_encoder,{pixel_values:qe})).image_features}async encode_text({input_ids:qe}){return(await ee(this.sessions.embed_tokens,{input_ids:qe})).inputs_embeds}async encode_audio({audio_values:qe}){return(await ee(this.sessions.audio_encoder,{audio_values:qe})).audio_features}}class Xe{}class Ne extends Xe{constructor({last_hidden_state:Me,hidden_states:qe=null,attentions:zt=null}){super(),this.last_hidden_state=Me,this.hidden_states=qe,this.attentions=zt}}class Ot extends ke{}class Lt extends Ot{}class kt extends Ot{async _call(Me){return new el(await super._call(Me))}}class mt extends Ot{async _call(Me){return new xi(await super._call(Me))}}class Zt extends Ot{async _call(Me){return new fs(await super._call(Me))}}class Kt extends Ot{async _call(Me){return new oc(await super._call(Me))}}class dr extends ke{}class Bt extends dr{}class wr extends dr{async _call(Me){return new el(await super._call(Me))}}class mr extends dr{async _call(Me){return new xi(await super._call(Me))}}class hr extends dr{async _call(Me){return new fs(await super._call(Me))}}class xr extends dr{async _call(Me){return new oc(await super._call(Me))}}class or extends ke{}class tt extends or{}class Se extends or{async _call(Me){return new el(await super._call(Me))}}class Pe extends or{async _call(Me){return new xi(await super._call(Me))}}class Ve extends or{async _call(Me){return new fs(await super._call(Me))}}class Qe extends ke{}class dt extends Qe{}class Pt extends Qe{}class Vt extends ke{}class At extends Vt{}class qt extends ke{}class er extends qt{}class fr extends qt{async _call(Me){return new el(await super._call(Me))}}class Jr extends qt{async _call(Me){return new xi(await super._call(Me))}}class $t extends qt{async _call(Me){return new fs(await super._call(Me))}}class zr extends qt{async _call(Me){return new oc(await super._call(Me))}}class Sr extends ke{}class Ir extends Sr{}class Xr extends Sr{async _call(Me){return new el(await super._call(Me))}}class qr extends Sr{async _call(Me){return new xi(await super._call(Me))}}class An extends Sr{async _call(Me){return new fs(await super._call(Me))}}class ge extends Sr{async _call(Me){return new oc(await super._call(Me))}}class ut extends ke{}class We extends ut{}class Je extends ut{async _call(Me){return new el(await super._call(Me))}}class xt extends ut{async _call(Me){return new xi(await super._call(Me))}}class wt extends ut{async _call(Me){return new fs(await super._call(Me))}}class pr extends ut{async _call(Me){return new oc(await super._call(Me))}}class Rr extends ke{}class On extends Rr{}class Mn extends Rr{async _call(Me){return new el(await super._call(Me))}}class _r extends Rr{async _call(Me){return new xi(await super._call(Me))}}class Or extends Rr{async _call(Me){return new fs(await super._call(Me))}}class an extends Rr{async _call(Me){return new oc(await super._call(Me))}}class Vn extends ke{}class _o extends Vn{}class Uo extends Vn{async _call(Me){return new el(await super._call(Me))}}class yn extends Vn{async _call(Me){return new xi(await super._call(Me))}}class Vo extends Vn{async _call(Me){return new fs(await super._call(Me))}}class Po extends Vn{async _call(Me){return new oc(await super._call(Me))}}class pa extends ke{}class ta extends pa{}class ra extends pa{async _call(Me){return new el(await super._call(Me))}}class so extends pa{async _call(Me){return new xi(await super._call(Me))}}class Xs extends pa{async _call(Me){return new fs(await super._call(Me))}}class xo extends pa{async _call(Me){return new oc(await super._call(Me))}}class Qn extends ke{}class is extends Qn{}class la extends Qn{async _call(Me){return new xi(await super._call(Me))}}class $s extends Qn{async _call(Me){return new fs(await super._call(Me))}}class wo extends Qn{async _call(Me){return new oc(await super._call(Me))}}class Eo extends Qn{async _call(Me){return new el(await super._call(Me))}}class Wa extends ke{}class ul extends Wa{}class os extends Wa{async _call(Me){return new el(await super._call(Me))}}class Pr extends Wa{async _call(Me){return new xi(await super._call(Me))}}class Hr extends Wa{async _call(Me){return new fs(await super._call(Me))}}class gn extends ke{}class Zi extends gn{}class dl extends gn{async _call(Me){return new el(await super._call(Me))}}class ba extends gn{async _call(Me){return new xi(await super._call(Me))}}class Ga extends gn{async _call(Me){return new oc(await super._call(Me))}}class yo extends ke{}class Xl extends yo{}class Dl extends yo{async _call(Me){return new el(await super._call(Me))}}class Uc extends yo{async _call(Me){return new xi(await super._call(Me))}}class Yt extends yo{async _call(Me){return new fs(await super._call(Me))}}class Ie extends yo{async _call(Me){return new oc(await super._call(Me))}}class rt extends ke{}class Tt extends rt{}class Ft extends rt{async _call(Me){return new el(await super._call(Me))}}class Dt extends rt{async _call(Me){return new xi(await super._call(Me))}}class yr extends rt{async _call(Me){return new oc(await super._call(Me))}}class Vr extends ke{}class en extends Vr{}class Qr extends Vr{async _call(Me){return new xi(await super._call(Me))}}class Dr extends Vr{async _call(Me){return new oc(await super._call(Me))}}class Ln extends Vr{async _call(Me){return new el(await super._call(Me))}}class Ii extends ke{constructor(){super(...arguments);_t(this,"forward_params",["input_ids","attention_mask","encoder_outputs","decoder_input_ids","decoder_attention_mask","past_key_values"])}}class vi extends Ii{}class Ai extends Ii{}class rn extends ke{}class Xi extends rn{}class Oi extends rn{}class ri extends ke{}class ma extends ri{}class Ri extends ri{}class lo extends ke{}class Mi extends lo{}class di extends lo{}class Ho extends lo{async _call(Me){return new xi(await super._call(Me))}}class bn extends ke{}class Nn extends bn{}class Mo extends bn{}class ni extends bn{async _call(Me){return new xi(await super._call(Me))}}class Yi extends bn{}class Qi extends ke{}class co extends Qi{}class po extends Qi{}class ga extends ke{}class ws extends ga{}class hl extends ga{}class fl extends ke{}class Yl extends fl{}class _c extends fl{async _call(Me){return new el(await super._call(Me))}}class Ms extends fl{async _call(Me){return new xi(await super._call(Me))}}class vo extends fl{async _call(Me){return new fs(await super._call(Me))}}class Ss extends fl{async _call(Me){return new oc(await super._call(Me))}}class re extends ke{}class ze extends re{}class pt extends re{async _call(Me){return new el(await super._call(Me))}}class Ut extends re{async _call(Me){return new xi(await super._call(Me))}}class Qt extends re{async _call(Me){return new fs(await super._call(Me))}}class Er extends re{async _call(Me){return new oc(await super._call(Me))}}class jr extends ke{}class Sn extends jr{}class vn extends jr{async _call(Me){return new el(await super._call(Me))}}class Zn extends jr{async _call(Me){return new xi(await super._call(Me))}}class Xn extends jr{async _call(Me){return new fs(await super._call(Me))}}class Ui extends jr{async _call(Me){return new oc(await super._call(Me))}}class Ao extends ke{}class Ko extends Ao{}class pi extends Ao{}class ca extends ke{constructor(){super(...arguments);_t(this,"requires_attention_mask",!1);_t(this,"main_input_name","input_features");_t(this,"forward_params",["input_features","attention_mask","decoder_input_ids","decoder_attention_mask","past_key_values"])}}class jo extends ca{}class Oa extends ca{_prepare_generation_config(Me,qe){return super._prepare_generation_config(Me,qe,P.WhisperGenerationConfig)}_retrieve_init_tokens(Me){const qe=[Me.decoder_start_token_id];let zt=Me.language;const ir=Me.task;if(Me.is_multilingual){zt||(console.warn("No language specified - defaulting to English (en)."),zt="en");const Mr=`<|${(0,C.whisper_language_to_code)(zt)}|>`;qe.push(Me.lang_to_id[Mr]),qe.push(Me.task_to_id[ir??"transcribe"])}else if(zt||ir)throw new Error("Cannot specify `task` or `language` for an English-only model. If the model is intended to be multilingual, pass `is_multilingual=true` to generate, or update the generation config.");return!Me.return_timestamps&&Me.no_timestamps_token_id&&qe.at(-1)!==Me.no_timestamps_token_id?qe.push(Me.no_timestamps_token_id):Me.return_timestamps&&qe.at(-1)===Me.no_timestamps_token_id&&(console.warn("<|notimestamps|> prompt token is removed from generation_config since `return_timestamps` is set to `true`."),qe.pop()),qe.filter(rr=>rr!=null)}async generate({inputs:Me=null,generation_config:qe=null,logits_processor:zt=null,stopping_criteria:ir=null,...rr}){qe=this._prepare_generation_config(qe,rr);const Mr=rr.decoder_input_ids??this._retrieve_init_tokens(qe);if(qe.return_timestamps&&(zt??(zt=new m.LogitsProcessorList),zt.push(new m.WhisperTimeStampLogitsProcessor(qe,Mr))),qe.begin_suppress_tokens&&(zt??(zt=new m.LogitsProcessorList),zt.push(new m.SuppressTokensAtBeginLogitsProcessor(qe.begin_suppress_tokens,Mr.length))),qe.return_token_timestamps){if(!qe.alignment_heads)throw new Error("Model generation config has no `alignment_heads`, token-level timestamps not available. See https://gist.github.com/hollance/42e32852f24243b748ae6bc1f985b13a on how to add this property to the generation config.");qe.task==="translate"&&console.warn("Token-level timestamps may not be reliable for task 'translate'."),qe.output_attentions=!0,qe.return_dict_in_generate=!0}const Kr=await super.generate({inputs:Me,generation_config:qe,logits_processor:zt,decoder_input_ids:Mr,...rr});return qe.return_token_timestamps&&(Kr.token_timestamps=this._extract_token_timestamps(Kr,qe.alignment_heads,qe.num_frames)),Kr}_extract_token_timestamps(Me,qe,zt=null,ir=.02){if(!Me.cross_attentions)throw new Error("Model outputs must contain cross attentions to extract timestamps. This is most likely because the model was not exported with `output_attentions=True`.");zt==null&&console.warn("`num_frames` has not been set, meaning the entire audio will be analyzed. This may lead to inaccurate token-level timestamps for short audios (< 30 seconds).");let rr=this.config.median_filter_width;rr===void 0&&(console.warn("Model config has no `median_filter_width`, using default value of 7."),rr=7);const Mr=Me.cross_attentions,Kr=Array.from({length:this.config.decoder_layers},(Di,Pn)=>(0,_.cat)(Mr.map($i=>$i[Pn]),2)),sn=(0,_.stack)(qe.map(([Di,Pn])=>{if(Di>=Kr.length)throw new Error(`Layer index ${Di} is out of bounds for cross attentions (length ${Kr.length}).`);return zt?Kr[Di].slice(null,Pn,null,[0,zt]):Kr[Di].slice(null,Pn)})).transpose(1,0,2,3),[_n,qn]=(0,_.std_mean)(sn,-2,0,!0),fi=sn.clone();for(let Di=0;Di<fi.dims[0];++Di){const Pn=fi[Di];for(let $i=0;$i<Pn.dims[0];++$i){const Lo=Pn[$i],Go=_n[Di][$i][0].data,Qa=qn[Di][$i][0].data;for(let za=0;za<Lo.dims[0];++za){let Cs=Lo[za].data;for(let tl=0;tl<Cs.length;++tl)Cs[tl]=(Cs[tl]-Qa[tl])/Go[tl];Cs.set((0,M.medianFilter)(Cs,rr))}}}const li=[(0,_.mean)(fi,1)],io=Me.sequences.dims,ti=new _.Tensor("float32",new Float32Array(io[0]*io[1]),io);for(let Di=0;Di<io[0];++Di){const Pn=li[Di].neg().squeeze_(0),[$i,Lo]=(0,M.dynamic_time_warping)(Pn.tolist()),Go=Array.from({length:$i.length-1},(Cs,tl)=>$i[tl+1]-$i[tl]),Qa=(0,a.mergeArrays)([1],Go).map(Cs=>!!Cs),za=[];for(let Cs=0;Cs<Qa.length;++Cs)Qa[Cs]&&za.push(Lo[Cs]*ir);ti[Di].data.set(za,1)}return ti}}class pl extends Oa{}class yc extends ke{constructor(){super(...arguments);_t(this,"requires_attention_mask",!1);_t(this,"main_input_name","input_values");_t(this,"forward_params",["input_values","decoder_input_ids","past_key_values"])}}class Wh extends yc{}class su extends yc{}class ml extends ke{constructor(){super(...arguments);_t(this,"main_input_name","pixel_values");_t(this,"forward_params",["pixel_values","decoder_input_ids","encoder_hidden_states","past_key_values"])}}class Pa extends ke{constructor(){super(...arguments);_t(this,"forward_params",["input_ids","attention_mask","pixel_values","position_ids","past_key_values"])}}class vc extends Pa{_merge_input_ids_with_image_features(Me){const qe=Me.image_features.dims.at(-1),zt=Me.image_features.view(-1,qe);return K({image_token_id:this.config.image_token_index,...Me,image_features:zt})}}class bc extends vc{}class La extends vc{}class Da extends ke{constructor(){super(...arguments);_t(this,"forward_params",["input_ids","inputs_embeds","attention_mask","pixel_values","encoder_outputs","decoder_input_ids","decoder_inputs_embeds","decoder_attention_mask","past_key_values"]);_t(this,"main_input_name","inputs_embeds")}}class gl extends Da{_merge_input_ids_with_image_features({inputs_embeds:Me,image_features:qe,input_ids:zt,attention_mask:ir}){return{inputs_embeds:(0,_.cat)([qe,Me],1),attention_mask:(0,_.cat)([(0,_.ones)(qe.dims.slice(0,2)),ir],1)}}async _prepare_inputs_embeds({input_ids:Me,pixel_values:qe,inputs_embeds:zt,attention_mask:ir}){if(!Me&&!qe)throw new Error("Either `input_ids` or `pixel_values` should be provided.");let rr,Mr;return Me&&(rr=await this.encode_text({input_ids:Me})),qe&&(Mr=await this.encode_image({pixel_values:qe})),rr&&Mr?{inputs_embeds:zt,attention_mask:ir}=this._merge_input_ids_with_image_features({inputs_embeds:rr,image_features:Mr,input_ids:Me,attention_mask:ir}):zt=rr||Mr,{inputs_embeds:zt,attention_mask:ir}}async forward({input_ids:Me,pixel_values:qe,attention_mask:zt,decoder_input_ids:ir,decoder_attention_mask:rr,encoder_outputs:Mr,past_key_values:Kr,inputs_embeds:sn,decoder_inputs_embeds:_n}){if(sn||({inputs_embeds:sn,attention_mask:zt}=await this._prepare_inputs_embeds({input_ids:Me,pixel_values:qe,inputs_embeds:sn,attention_mask:zt})),!Mr){let{last_hidden_state:li}=await ue(this,{inputs_embeds:sn,attention_mask:zt});Mr=li}if(!_n){if(!ir)throw new Error("Either `decoder_input_ids` or `decoder_inputs_embeds` should be provided.");_n=await this.encode_text({input_ids:ir})}return await De(this,{inputs_embeds:_n,attention_mask:rr,encoder_attention_mask:zt,encoder_hidden_states:Mr,past_key_values:Kr},!0)}}class Ys extends ke{constructor(){super(...arguments);_t(this,"forward_params",["input_ids","attention_mask","pixel_values","position_ids","past_key_values"])}}class Ql extends Ys{_merge_input_ids_with_image_features(Me){const qe=Me.image_features.dims.at(-1),zt=Me.image_features.view(-1,qe);return K({image_token_id:this.config.image_token_index,...Me,image_features:zt})}}class Yu extends Pa{_merge_input_ids_with_image_features(Me){const qe=Me.image_features.dims.at(-1),zt=Me.image_features.view(-1,qe);return K({image_token_id:this.config.image_token_index,...Me,image_features:zt})}}class $a extends ke{constructor(){super(...arguments);_t(this,"forward_params",["input_ids","attention_mask","inputs_embeds","per_layer_inputs","position_ids","pixel_values","input_features","input_features_mask","past_key_values"])}}class Vc extends $a{async forward({input_ids:Me=null,attention_mask:qe=null,pixel_values:zt=null,input_features:ir=null,input_features_mask:rr=null,position_ids:Mr=null,inputs_embeds:Kr=null,per_layer_inputs:sn=null,past_key_values:_n=null,generation_config:qn=null,logits_processor:fi=null,...li}){if((!Kr||!sn)&&({inputs_embeds:Kr,per_layer_inputs:sn}=await ee(this.sessions.embed_tokens,{input_ids:Me}),Me.dims[1]!==1)){if(zt){const{image_features:ti}=await ee(this.sessions.vision_encoder,{pixel_values:zt});({inputs_embeds:Kr,attention_mask:qe}=this._merge_input_ids_with_image_features({image_features:ti,inputs_embeds:Kr,input_ids:Me,attention_mask:qe}))}if(ir){const{audio_features:ti}=await ee(this.sessions.audio_encoder,{input_features:ir,input_features_mask:rr});({inputs_embeds:Kr,attention_mask:qe}=this._merge_input_ids_with_audio_features({audio_features:ti,inputs_embeds:Kr,input_ids:Me,attention_mask:qe}))}}return await De(this,{inputs_embeds:Kr,per_layer_inputs:sn,past_key_values:_n,attention_mask:qe,position_ids:Mr,generation_config:qn,logits_processor:fi},!0)}_merge_input_ids_with_image_features(Me){const qe=Me.image_features.dims.at(-1),zt=Me.image_features.view(-1,qe);return K({image_token_id:this.config.image_token_id,...Me,image_features:zt})}_merge_input_ids_with_audio_features(Me){const qe=Me.audio_features.dims.at(-1),zt=Me.audio_features.view(-1,qe);return te({audio_token_id:this.config.audio_token_id,...Me,audio_features:zt})}}class as extends ke{constructor(){super(...arguments);_t(this,"forward_params",["input_ids","attention_mask","pixel_values","pixel_attention_mask","position_ids","past_key_values"])}}class Wc extends as{async encode_image({pixel_values:Me,pixel_attention_mask:qe}){return(await ee(this.sessions.vision_encoder,{pixel_values:Me,pixel_attention_mask:qe})).image_features}_merge_input_ids_with_image_features(Me){const qe=Me.image_features.dims.at(-1),zt=Me.image_features.view(-1,qe);return K({image_token_id:this.config.image_token_id,...Me,image_features:zt})}}class ua extends Wc{}class _l extends ke{constructor(){super(...arguments);_t(this,"forward_params",["input_ids","inputs_embeds","attention_mask","position_ids","pixel_values","image_sizes","past_key_values"])}}class xc extends _l{async forward({input_ids:Me=null,attention_mask:qe=null,pixel_values:zt=null,image_sizes:ir=null,position_ids:rr=null,inputs_embeds:Mr=null,past_key_values:Kr=null,generation_config:sn=null,logits_processor:_n=null,...qn}){if(!Mr){let li;if(zt&&Me.dims[1]!==1){if(!ir)throw new Error("`image_sizes` must be provided when `pixel_values` is provided.");({image_features:li}=await ee(this.sessions.vision_encoder,{pixel_values:zt,image_sizes:ir}))}else{const io=this.config.normalized_config.hidden_size;li=new _.Tensor("float32",[],[0,io])}({inputs_embeds:Mr}=await ee(this.sessions.prepare_inputs_embeds,{input_ids:Me,image_features:li}))}return await De(this,{inputs_embeds:Mr,past_key_values:Kr,attention_mask:qe,position_ids:rr,generation_config:sn,logits_processor:_n},!1)}}class Ns extends ke{}class Jl extends Ns{}class wc extends Ns{static async from_pretrained(Me,qe={}){return super.from_pretrained(Me,{...qe,model_file_name:qe.model_file_name??"text_model"})}}class ss extends Ns{static async from_pretrained(Me,qe={}){return super.from_pretrained(Me,{...qe,model_file_name:qe.model_file_name??"text_model"})}}class Ts extends Ns{static async from_pretrained(Me,qe={}){return super.from_pretrained(Me,{...qe,model_file_name:qe.model_file_name??"vision_model"})}}class js extends Ns{static async from_pretrained(Me,qe={}){return super.from_pretrained(Me,{...qe,model_file_name:qe.model_file_name??"vision_model"})}}class Rs extends ke{}class ec extends Rs{}class tc extends Rs{static async from_pretrained(Me,qe={}){return super.from_pretrained(Me,{...qe,model_file_name:qe.model_file_name??"text_model"})}}class Mc extends Ns{static async from_pretrained(Me,qe={}){return super.from_pretrained(Me,{...qe,model_file_name:qe.model_file_name??"vision_model"})}}class Co extends ke{}class $n extends Co{}class yl extends ke{}class vl extends yl{async forward(Me){const qe=!Me.input_ids,zt=!Me.pixel_values;if(qe&&zt)throw new Error("Either `input_ids` or `pixel_values` should be provided.");if(qe&&(Me.input_ids=(0,_.ones)([Me.pixel_values.dims[0],1])),zt){const{image_size:_n}=this.config.vision_config;Me.pixel_values=(0,_.full)([0,3,_n,_n],0)}const{text_embeddings:ir,image_embeddings:rr,l2norm_text_embeddings:Mr,l2norm_image_embeddings:Kr}=await super.forward(Me),sn={};return qe||(sn.text_embeddings=ir,sn.l2norm_text_embeddings=Mr),zt||(sn.image_embeddings=rr,sn.l2norm_image_embeddings=Kr),sn}}class Gc extends yl{static async from_pretrained(Me,qe={}){return super.from_pretrained(Me,{...qe,model_file_name:qe.model_file_name??"text_model"})}}class rc extends yl{static async from_pretrained(Me,qe={}){return super.from_pretrained(Me,{...qe,model_file_name:qe.model_file_name??"vision_model"})}}class Na extends ke{}class nc extends Na{}class bl extends Na{}class qa extends ke{}class bi extends qa{}class qc extends qa{}class ja extends ke{}class xl extends ja{}class So extends ja{}class Ji extends ke{}class Fo extends Ji{}class na extends Ji{}class wl extends ke{}class lu extends wl{}class $l extends wl{}class Hc extends ke{}class oh extends Hc{}class yd extends Hc{}class cu extends ke{}class Y extends cu{}class he extends cu{}class Oe extends ke{}class Ke extends Oe{}class at extends Oe{}class Ht extends ke{}class gr extends Ht{}class Wr extends Ht{}class cn extends ke{}class wn extends cn{}class Yn extends cn{}class Ci extends ke{}class ro extends Ci{}class da extends Ci{}class Nl extends ke{}class ah extends Nl{}class Qu extends Nl{}class Kc extends ke{}class Gh extends Kc{}class vd extends Kc{}class Jn extends ke{}class Fs extends Jn{}class qh extends Jn{}class bd extends ke{}class uu extends bd{}class sh extends bd{}class lh extends ke{}class Hh extends lh{}class tm extends lh{}class xd extends ke{}class wd extends xd{}class Cu extends xd{}class ku extends ke{}class Jf extends ku{}class rm extends ku{}class Ju extends ke{}class ch extends Ju{}class uh extends Ju{}class dh extends ke{}class ep extends dh{}class ed extends dh{}class Md extends ke{}class Sd extends Md{}class Sc extends Md{}class Kh extends ke{}class nm extends Kh{}class tp extends Kh{}class hh extends ke{}class rp extends hh{}class ig extends hh{}class Zh extends ke{}class ko extends Zh{}class Ra extends Zh{}class Ea extends ke{}class Xh extends Ea{}class Td extends Ea{}class Zc extends ke{}class ls extends Zc{}class Yh extends Zc{}class du extends ke{constructor(){super(...arguments);_t(this,"forward_params",["input_ids","attention_mask","position_ids","past_key_values","pixel_values","image_grid_thw"])}}class Qh extends du{get_rope_index(Me,qe,zt,ir){const{vision_config:rr,image_token_id:Mr,video_token_id:Kr,vision_start_token_id:sn}=this.config,_n=rr.spatial_merge_size??2,qn=[];if(qe||zt){let fi=Me.tolist();ir||(ir=(0,_.ones_like)(Me));const li=ir.tolist(),io=Array.from({length:3},Lo=>Array.from({length:Me.dims[0]},Go=>Array.from({length:Me.dims[1]},Qa=>1))),ti=qe?qe.tolist():[],Di=zt?zt.tolist():[];let Pn=0,$i=0;for(let Lo=0;Lo<fi.length;++Lo){const Go=fi[Lo].filter((wa,ps)=>li[Lo][ps]==1),za=Go.reduce((wa,ps,sf)=>(ps==sn&&wa.push(sf),wa),[]).map(wa=>Go[wa+1]),Cs=za.filter(wa=>wa==Mr).length,tl=za.filter(wa=>wa==Kr).length;let Vi=[],Ws=0,rl=Cs,_p=tl;for(let wa=0;wa<za.length;++wa){const ps=Go.findIndex((yp,Lu)=>Lu>Ws&&yp==Mr),sf=Go.findIndex((yp,Lu)=>Lu>Ws&&yp==Kr),_h=rl>0&&ps!==-1?ps:Go.length+1,lf=_p>0&&sf!==-1?sf:Go.length+1;let mm,ew,tw,rw;_h<lf?([ew,tw,rw]=ti[Pn],++Pn,--rl,mm=_h):([ew,tw,rw]=Di[$i],++$i,--_p,mm=lf);const[Mg,nl,Sg]=[Number(ew),Math.floor(Number(tw)/_n),Math.floor(Number(rw)/_n)],mv=mm-Ws,nw=Vi.length>0?(0,M.max)(Vi.at(-1))[0]+1:0;Vi.push(Array.from({length:3*mv},(yp,Lu)=>nw+Lu%mv));const ny=mv+nw,gv=Mg*nl*Sg,VT=Array.from({length:gv},(yp,Lu)=>ny+Math.floor(Lu/(nl*Sg))),WT=Array.from({length:gv},(yp,Lu)=>ny+Math.floor(Lu/Sg)%nl),Fk=Array.from({length:gv},(yp,Lu)=>ny+Lu%Sg);Vi.push([VT,WT,Fk].flat()),Ws=mm+gv}if(Ws<Go.length){const wa=Vi.length>0?(0,M.max)(Vi.at(-1))[0]+1:0,ps=Go.length-Ws;Vi.push(Array.from({length:3*ps},(sf,_h)=>wa+_h%ps))}const Ic=Vi.reduce((wa,ps)=>wa+ps.length,0),Ou=new Array(Ic);let ty=0;for(let wa=0;wa<3;++wa)for(let ps=0;ps<Vi.length;++ps){const sf=Vi[ps],_h=sf.length/3;for(let lf=wa*_h;lf<(wa+1)*_h;++lf)Ou[ty++]=sf[lf]}let pm=0;const pv=li[Lo];for(let wa=0;wa<pv.length;++wa)if(pv[wa]==1){for(let ps=0;ps<3;++ps)io[ps][Lo][wa]=Ou[ps*Ic/3+pm];++pm}const ry=(0,M.max)(Ou)[0];qn.push(ry+1-fi[Lo].length)}return[new _.Tensor("int64",io.flat(1/0),[3,Me.dims[0],Me.dims[1]]),new _.Tensor("int64",qn,[qn.length,1])]}else if(ir){const{data:fi,dims:li}=Ge(ir),io=BigInt64Array.from({length:3*fi.length},(Di,Pn)=>fi[Pn%fi.length]),ti=Array.from({length:li[0]},(Di,Pn)=>(0,M.max)(fi.subarray(li[1]*Pn,li[1]*(Pn+1)))[0]+1n+BigInt(li[1]));return[new _.Tensor("int64",io,[3,...li]),new _.Tensor("int64",ti,[ti.length,1])]}else{const[fi,li]=Me.dims,io=BigInt64Array.from({length:3*fi*li},(ti,Di)=>BigInt(Math.floor(Di%li/fi)));return[new _.Tensor("int64",io,[3,...Me.dims]),(0,_.zeros)([fi,1])]}}async encode_image({pixel_values:Me,image_grid_thw:qe}){return(await ee(this.sessions.vision_encoder,{pixel_values:Me,grid_thw:qe})).image_features}_merge_input_ids_with_image_features(Me){return K({image_token_id:this.config.image_token_id,...Me})}prepare_inputs_for_generation(Me,qe,zt){if(qe.attention_mask&&!qe.position_ids)if(!qe.past_key_values)[qe.position_ids,qe.rope_deltas]=this.get_rope_index(qe.input_ids,qe.image_grid_thw,qe.video_grid_thw,qe.attention_mask);else{qe.pixel_values=null;const ir=BigInt(Object.values(qe.past_key_values)[0].dims.at(-2)),rr=qe.rope_deltas.map(Mr=>ir+Mr);qe.position_ids=(0,_.stack)([rr,rr,rr],0)}return qe}}class Jh extends ke{}class np extends Jh{}class ip extends Jh{}class op extends ke{}class fh extends op{}class Ml extends op{}class Tc extends ke{}class zs extends Tc{}class td extends Tc{}class ef extends ke{}class ap extends ef{}class im extends ef{}class rd extends ke{}class sp extends rd{}class Pd extends rd{}class lp extends ke{}class Sl extends lp{}class ic extends lp{async _call(Me){return new xi(await super._call(Me))}}class Xc extends ke{}class Pc extends Xc{}class Ed extends Xc{async _call(Me){return new xi(await super._call(Me))}}class om extends ke{}class B extends om{}class q extends ke{}class le extends q{}class we extends q{async _call(Me){return new xi(await super._call(Me))}}class Be extends ke{}class Ze extends Be{}class Re extends ke{}class nt extends Re{}class ht extends Re{async _call(Me){return new xi(await super._call(Me))}}class bt extends ke{}class Gt extends bt{}class ar extends ke{}class vt extends ar{}class Nt extends ar{async _call(Me){return new xi(await super._call(Me))}}class tr extends ke{}class Tr extends tr{async _call(Me){return new BT(await super._call(Me))}}class sr extends ke{}class Ar extends sr{}class Lr extends sr{async _call(Me){return new xi(await super._call(Me))}}class Zr extends ke{}class Ur extends Zr{}class zn extends Zr{async _call(Me){return new xi(await super._call(Me))}}class Cn extends ke{}class Si extends Cn{}class jn extends Cn{}class Gi extends ke{}class Ro extends Gi{}class En extends Gi{}class kn extends ke{}class mn extends kn{}class xa extends kn{async _call(Me){return new xi(await super._call(Me))}}class hi extends ke{}class eo extends hi{}class Zo extends hi{async _call(Me){return new Ha(await super._call(Me))}}class Wo extends hi{async _call(Me){return new on(await super._call(Me))}}class Ha extends Xe{constructor({logits:Me,pred_boxes:qe}){super(),this.logits=Me,this.pred_boxes=qe}}class on extends Xe{constructor({logits:Me,pred_boxes:qe,pred_masks:zt}){super(),this.logits=Me,this.pred_boxes=qe,this.pred_masks=zt}}class xn extends ke{}class cs extends xn{}class Xo extends xn{async _call(Me){return new Fi(await super._call(Me))}}class Fi extends Xe{constructor({logits:Me,pred_boxes:qe}){super(),this.logits=Me,this.pred_boxes=qe}}class wi extends ke{}class _a extends wi{}class Li extends wi{async _call(Me){return new Ps(await super._call(Me))}}class Ps extends Fi{}class Bs extends ke{}class si extends Bs{}class no extends Bs{async _call(Me){return new Io(await super._call(Me))}}class Io extends Fi{}class ia extends ke{}class us extends ia{}class Es extends ia{async _call(Me){return new Fi(await super._call(Me))}}class Ka extends ke{}class Za extends Ka{}class ds extends Ka{async _call(Me){return new Us(await super._call(Me))}}class Us extends Ha{}class mo extends ke{}class Qs extends mo{}class jl extends mo{async _call(Me){return new xi(await super._call(Me))}}class Ec extends ke{}class Ac extends Ec{}class A extends Ec{async _call(Me){return new xi(await super._call(Me))}}class l extends ke{}class p extends l{}class b extends l{async _call(Me){return new xi(await super._call(Me))}}class S extends ke{}class k extends S{}class R extends S{async _call(Me){return new xi(await super._call(Me))}}class W extends S{}class Z extends ke{}class ie extends Z{}class ce extends Z{}class xe extends ke{}class be extends xe{}class Ae extends xe{}class Ue extends ke{}class lt extends Ue{}class it extends ke{}class ft extends it{}class gt extends it{}class Et extends it{}class Mt extends ke{}class It extends Mt{}class jt extends ke{}class St extends jt{}class Wt extends ke{}class ur extends Wt{}class Jt extends ke{}class nr extends Jt{}class cr extends Jt{}class Gr extends ke{}class Yr extends Gr{}class $r extends Gr{}class Tn extends ke{}class mi extends Tn{}class uo extends ke{}class go extends uo{}class bo extends uo{async _call(Me){return new xi(await super._call(Me))}}class zo extends ke{}class To extends zo{}class ei extends zo{async _call(Me){return new xi(await super._call(Me))}}class qi extends ke{}class ya extends qi{}class Aa extends qi{async _call(Me){return new xi(await super._call(Me))}}class Fa extends ke{}class Js extends Fa{}class Rl extends Fa{async _call(Me){return new xi(await super._call(Me))}}class Yc extends ke{}class Ad extends Yc{}class tf extends ke{}class rf extends tf{}class ph extends ke{}class mh extends ph{}class Fl extends ke{}class hu extends Fl{}class zl extends Fl{async _call(Me){return new Cd(await super._call(Me))}}class Cd extends Xe{constructor({logits:Me,pred_boxes:qe}){super(),this.logits=Me,this.pred_boxes=qe}}class hs extends ke{}class As extends hs{async get_image_embeddings({pixel_values:Me}){return await ue(this,{pixel_values:Me})}async forward(Me){if((!Me.image_embeddings||!Me.image_positional_embeddings)&&(Me={...Me,...await this.get_image_embeddings(Me)}),!Me.input_labels&&Me.input_points){const zt=Me.input_points.dims.slice(0,-1),ir=zt.reduce((rr,Mr)=>rr*Mr,1);Me.input_labels=new _.Tensor("int64",new BigInt64Array(ir).fill(1n),zt)}const qe={image_embeddings:Me.image_embeddings,image_positional_embeddings:Me.image_positional_embeddings};return Me.input_points&&(qe.input_points=Me.input_points),Me.input_labels&&(qe.input_labels=Me.input_labels),Me.input_boxes&&(qe.input_boxes=Me.input_boxes),await ee(this.sessions.prompt_encoder_mask_decoder,qe)}async _call(Me){return new Qc(await super._call(Me))}}class Qc extends Xe{constructor({iou_scores:Me,pred_masks:qe}){super(),this.iou_scores=Me,this.pred_masks=qe}}class Xa extends ke{}class cp extends Xa{}class nf extends Xa{}class Iu extends ke{}class fu extends Iu{}class kd extends Iu{}class Id extends ke{}class Cc extends Id{}class V_ extends Id{async _call(Me){return new fm(await super._call(Me))}}class og extends Id{async _call(Me){return new xi(await super._call(Me))}}class am extends Id{async _call(Me){return new fs(await super._call(Me))}}class up extends ke{}class Od extends up{}class nd extends up{async _call(Me){return new fs(await super._call(Me))}}class ox extends ke{}class LS extends ox{}class ag extends ke{}class ax extends ag{}class DS extends ag{async _call(Me){return new fm(await super._call(Me))}}class sx extends ag{async _call(Me){return new xi(await super._call(Me))}}class W_ extends ke{}class U0 extends W_{}class $S extends W_{async _call(Me){return new fm(await super._call(Me))}}class V0 extends W_{async _call(Me){return new xi(await super._call(Me))}}class lx extends W_{async _call(Me){return new fs(await super._call(Me))}}class G_ extends ke{}class sm extends G_{}class NS extends G_{async _call(Me){return new fm(await super._call(Me))}}class sg extends G_{async _call(Me){return new xi(await super._call(Me))}}class W0 extends ke{}class q_ extends Id{}class cx extends Id{async _call(Me){return new fm(await super._call(Me))}}class ux extends Id{async _call(Me){return new xi(await super._call(Me))}}class lg extends ke{}class jS extends lg{}class dx extends lg{async _call(Me){return new fm(await super._call(Me))}}class hx extends lg{async _call(Me){return new xi(await super._call(Me))}}class fx extends lg{async _call(Me){return new Jx(await super._call(Me))}}class RS extends lg{async _call(Me){return new fs(await super._call(Me))}}class G0 extends ke{}class px extends G0{}class cg extends ke{}class H_ extends cg{}class kc extends cg{}class mx extends cg{async generate_speech(Me,qe,{threshold:zt=.5,minlenratio:ir=0,maxlenratio:rr=20,vocoder:Mr=null}={}){const Kr={input_ids:Me},{encoder_outputs:sn,encoder_attention_mask:_n}=await ue(this,Kr),qn=sn.dims[1]/this.config.reduction_factor,fi=Math.floor(qn*rr),li=Math.floor(qn*ir),io=this.config.num_mel_bins;let ti=[],Di=null,Pn=null,$i=0;for(;;){++$i;const Qa=ye(!!Pn);let za;Pn?za=Pn.output_sequence_out:za=new _.Tensor("float32",new Float32Array(io),[1,1,io]);let Cs={use_cache_branch:Qa,output_sequence:za,encoder_attention_mask:_n,speaker_embeddings:qe,encoder_hidden_states:sn};this.addPastKeyValues(Cs,Di),Pn=await ee(this.sessions.decoder_model_merged,Cs),Di=this.getPastKeyValues(Pn,Di);const{prob:tl,spectrum:Vi}=Pn;if(ti.push(Vi),$i>=li&&(Array.from(tl.data).filter(Ws=>Ws>=zt).length>0||$i>=fi))break}const Lo=(0,_.cat)(ti),{waveform:Go}=await ee(Mr.sessions.model,{spectrogram:Lo});return{spectrogram:Lo,waveform:Go}}}class q0 extends ke{constructor(){super(...arguments);_t(this,"main_input_name","spectrogram")}}class FS extends ke{}class gx extends FS{}class _x extends ke{}class zS extends _x{}class yx extends _x{}class vx extends ke{}class H0 extends vx{}class bx extends vx{}class K0 extends ke{}class BS extends K0{}class US extends K0{}class xx extends ke{}class Z0 extends xx{}class X0 extends xx{}class K_ extends ke{}class dp extends K_{}class ug extends K_{static async from_pretrained(Me,qe={}){return super.from_pretrained(Me,{...qe,model_file_name:qe.model_file_name??"text_model"})}}class VS extends K_{static async from_pretrained(Me,qe={}){return super.from_pretrained(Me,{...qe,model_file_name:qe.model_file_name??"audio_model"})}}class WS extends ke{}class wx extends WS{async _call(Me){return new UT(await super._call(Me))}}class Y0 extends ke{}class $k extends Y0{}class GS extends Y0{}class qS extends Y0{}class Z_ extends ke{}class HS extends Z_{}class Mx extends Z_{}class lm extends ke{}class KS extends lm{}class Ya extends lm{async _call(Me){return new xi(await super._call(Me))}}class hp extends ke{}class ZS extends hp{}class Q0 extends hp{}class dg extends ke{constructor(){super(...arguments);_t(this,"forward_params",["input_ids","attention_mask","encoder_outputs","decoder_input_ids","decoder_attention_mask","past_key_values"])}_apply_and_filter_by_delay_pattern_mask(qe){const[zt,ir]=qe.dims,rr=this.config.decoder.num_codebooks,Mr=ir-rr;let Kr=0;for(let qn=0;qn<qe.size;++qn){if(qe.data[qn]===this.config.decoder.pad_token_id)continue;const fi=qn%ir,li=Math.floor(qn/ir)%rr,io=fi-li;io>0&&io<=Mr&&(qe.data[Kr++]=qe.data[qn])}const sn=Math.floor(zt/rr),_n=Kr/(sn*rr);return new _.Tensor(qe.type,qe.data.slice(0,Kr),[sn,rr,_n])}prepare_inputs_for_generation(qe,zt,ir){let rr=structuredClone(qe);for(let Kr=0;Kr<rr.length;++Kr)for(let sn=0;sn<rr[Kr].length;++sn)Kr%this.config.decoder.num_codebooks>=sn&&(rr[Kr][sn]=BigInt(this.config.decoder.pad_token_id));return ir.guidance_scale!==null&&ir.guidance_scale>1&&(rr=rr.concat(rr)),super.prepare_inputs_for_generation(rr,zt,ir)}async generate(qe){const zt=await super.generate(qe),ir=this._apply_and_filter_by_delay_pattern_mask(zt).unsqueeze_(0),{audio_values:rr}=await ee(this.sessions.encodec_decode,{audio_codes:ir});return rr}}class fp extends ke{}class Sx extends fp{}class Tx extends fp{async _call(Me){return new xi(await super._call(Me))}}class hg extends fp{}class fg extends ke{}class cm extends fg{}class X_ extends fg{async _call(Me){return new xi(await super._call(Me))}}class um extends fg{}class pp extends ke{}class XS extends pp{}class Px extends pp{async _call(Me){return new xi(await super._call(Me))}}class mp extends pp{}class J0 extends ke{}class Ex extends J0{}class pg extends J0{async _call(Me){return new xi(await super._call(Me))}}class ev extends J0{}class Ax extends ke{}class Cx extends Ax{}class YS extends ke{}class QS extends YS{constructor(...qe){super(...qe);_t(this,"forward_params",["input_ids","pixel_values","images_seq_mask","images_emb_mask","attention_mask","position_ids","past_key_values"]);this._generation_mode="text"}async forward(qe){const zt=this._generation_mode??"text";let ir;if(zt==="text"||!qe.past_key_values){const _n=this.sessions.prepare_inputs_embeds,qn=(0,a.pick)(qe,_n.inputNames);ir=await ee(_n,qn)}else{const _n=this.sessions.gen_img_embeds,qn=(0,a.pick)({image_ids:qe.input_ids},_n.inputNames);ir=await ee(_n,qn)}const rr={...qe,...ir},Mr=await De(this,rr),Kr=this.sessions[zt==="text"?"lm_head":"gen_head"];if(!Kr)throw new Error(`Unable to find "${Kr}" generation head`);const sn=await ee(Kr,(0,a.pick)(Mr,Kr.inputNames));return{...ir,...Mr,...sn}}async generate(qe){return this._generation_mode="text",super.generate(qe)}async generate_images(qe){this._generation_mode="image";const zt=(qe.inputs??qe[this.main_input_name]).dims[1],rr=(await super.generate(qe)).slice(null,[zt,null]),Mr=this.sessions.image_decode,{decoded_image:Kr}=await ee(Mr,{generated_tokens:rr}),sn=Kr.add_(1).mul_(255/2).clamp_(0,255).to("uint8"),_n=[];for(const qn of sn){const fi=y.RawImage.fromTensor(qn);_n.push(fi)}return _n}}class JS extends Xe{constructor({char_logits:Me,bpe_logits:qe,wp_logits:zt}){super(),this.char_logits=Me,this.bpe_logits=qe,this.wp_logits=zt}get logits(){return[this.char_logits,this.bpe_logits,this.wp_logits]}}class eT extends ke{}class tT extends eT{async _call(Me){return new JS(await super._call(Me))}}class gp extends ke{}class rT extends gp{}class nT extends gp{}class tv extends ke{}class iT extends tv{}class kx extends tv{}class oT extends ke{constructor(){super(...arguments);_t(this,"forward_params",["input_ids","attention_mask","position_ids","audio_values","past_key_values"])}}class Y_ extends oT{_merge_input_ids_with_audio_features(Me){const qe=Me.audio_features.dims.at(-1),zt=Me.audio_features.view(-1,qe);return te({audio_token_id:this.config.ignore_index??this.config.audio_token_id,...Me,audio_features:zt})}}class mg extends Y_{}class gg extends ke{constructor(){super(...arguments);_t(this,"main_input_name","input_values");_t(this,"forward_params",["input_values"])}}class aT extends Xe{constructor({audio_codes:Me}){super(),this.audio_codes=Me}}class sT extends Xe{constructor({audio_values:Me}){super(),this.audio_values=Me}}class Ix extends gg{async encode(Me){return new aT(await ee(this.sessions.encoder_model,Me))}async decode(Me){return new sT(await ee(this.sessions.decoder_model,Me))}}class Ox extends gg{static async from_pretrained(Me,qe={}){return super.from_pretrained(Me,{...qe,model_file_name:qe.model_file_name??"encoder_model"})}}class lT extends gg{static async from_pretrained(Me,qe={}){return super.from_pretrained(Me,{...qe,model_file_name:qe.model_file_name??"decoder_model"})}}class rv extends ke{constructor(){super(...arguments);_t(this,"main_input_name","input_values");_t(this,"forward_params",["input_values"])}}class _g extends Xe{constructor({audio_codes:Me}){super(),this.audio_codes=Me}}class Lx extends Xe{constructor({audio_values:Me}){super(),this.audio_values=Me}}class cT extends rv{async encode(Me){return new _g(await ee(this.sessions.encoder_model,Me))}async decode(Me){return new Lx(await ee(this.sessions.decoder_model,Me))}}class uT extends rv{static async from_pretrained(Me,qe={}){return super.from_pretrained(Me,{...qe,model_file_name:qe.model_file_name??"encoder_model"})}}class dT extends rv{static async from_pretrained(Me,qe={}){return super.from_pretrained(Me,{...qe,model_file_name:qe.model_file_name??"decoder_model"})}}class nv extends ke{constructor(){super(...arguments);_t(this,"main_input_name","input_values");_t(this,"forward_params",["input_values"])}}class hT extends nv{async encode(Me){return await ee(this.sessions.encoder_model,Me)}async decode(Me){return await ee(this.sessions.decoder_model,Me)}}class Dx extends nv{static async from_pretrained(Me,qe={}){return super.from_pretrained(Me,{...qe,model_file_name:qe.model_file_name??"encoder_model"})}}class iv extends nv{static async from_pretrained(Me,qe={}){return super.from_pretrained(Me,{...qe,model_file_name:qe.model_file_name??"decoder_model"})}}class Oo{static async from_pretrained(Me,{progress_callback:qe=null,config:zt=null,cache_dir:ir=null,local_files_only:rr=!1,revision:Mr="main",model_file_name:Kr=null,subfolder:sn="onnx",device:_n=null,dtype:qn=null,use_external_data_format:fi=null,session_options:li={}}={}){const io={progress_callback:qe,config:zt,cache_dir:ir,local_files_only:rr,revision:Mr,model_file_name:Kr,subfolder:sn,device:_n,dtype:qn,use_external_data_format:fi,session_options:li};if(io.config=await n.AutoConfig.from_pretrained(Me,io),!this.MODEL_CLASS_MAPPINGS)throw new Error("`MODEL_CLASS_MAPPINGS` not implemented for this type of `AutoClass`: "+this.name);const ti=io.config.model_type;for(const Di of this.MODEL_CLASS_MAPPINGS){let Pn=Di.get(ti);if(!Pn){for(const $i of Di.values())if($i[0]===ti){Pn=$i;break}if(!Pn)continue}return await Pn[1].from_pretrained(Me,io)}if(this.BASE_IF_FAIL)return J_.has(ti)||console.warn(`Unknown model class "${ti}", attempting to construct from base class.`),await ke.from_pretrained(Me,io);throw Error(`Unsupported model type: ${ti}`)}}_t(Oo,"MODEL_CLASS_MAPPINGS",null),_t(Oo,"BASE_IF_FAIL",!1);const fT=new Map([["bert",["BertModel",Lt]],["neobert",["NeoBertModel",Bt]],["modernbert",["ModernBertModel",tt]],["nomic_bert",["NomicBertModel",At]],["roformer",["RoFormerModel",er]],["electra",["ElectraModel",We]],["esm",["EsmModel",ul]],["convbert",["ConvBertModel",Ir]],["camembert",["CamembertModel",On]],["deberta",["DebertaModel",_o]],["deberta-v2",["DebertaV2Model",ta]],["mpnet",["MPNetModel",Xl]],["albert",["AlbertModel",en]],["distilbert",["DistilBertModel",is]],["roberta",["RobertaModel",Yl]],["xlm",["XLMModel",ze]],["xlm-roberta",["XLMRobertaModel",Sn]],["clap",["ClapModel",dp]],["clip",["CLIPModel",Jl]],["clipseg",["CLIPSegModel",nc]],["chinese_clip",["ChineseCLIPModel",$n]],["siglip",["SiglipModel",ec]],["jina_clip",["JinaCLIPModel",vl]],["mobilebert",["MobileBertModel",Zi]],["squeezebert",["SqueezeBertModel",Tt]],["wav2vec2",["Wav2Vec2Model",Cc]],["wav2vec2-bert",["Wav2Vec2BertModel",sm]],["unispeech",["UniSpeechModel",ax]],["unispeech-sat",["UniSpeechSatModel",U0]],["hubert",["HubertModel",q_]],["wavlm",["WavLMModel",jS]],["audio-spectrogram-transformer",["ASTModel",Ko]],["vits",["VitsModel",wx]],["pyannote",["PyAnnoteModel",Od]],["wespeaker-resnet",["WeSpeakerResNetModel",LS]],["detr",["DetrModel",eo]],["rt_detr",["RTDetrModel",cs]],["rt_detr_v2",["RTDetrV2Model",_a]],["rf_detr",["RFDetrModel",si]],["d_fine",["DFineModel",us]],["table-transformer",["TableTransformerModel",Za]],["vit",["ViTModel",Sl]],["ijepa",["IJepaModel",Pc]],["pvt",["PvtModel",le]],["vit_msn",["ViTMSNModel",nt]],["vit_mae",["ViTMAEModel",Ze]],["groupvit",["GroupViTModel",Gt]],["fastvit",["FastViTModel",vt]],["mobilevit",["MobileViTModel",Ar]],["mobilevitv2",["MobileViTV2Model",Ur]],["owlvit",["OwlViTModel",Si]],["owlv2",["Owlv2Model",Ro]],["beit",["BeitModel",mn]],["deit",["DeiTModel",Qs]],["hiera",["HieraModel",Ac]],["convnext",["ConvNextModel",go]],["convnextv2",["ConvNextV2Model",To]],["dinov2",["Dinov2Model",ya]],["dinov2_with_registers",["Dinov2WithRegistersModel",Js]],["dinov3_vit",["DINOv3ViTModel",Ad]],["dinov3_convnext",["DINOv3ConvNextModel",rf]],["resnet",["ResNetModel",p]],["swin",["SwinModel",k]],["swin2sr",["Swin2SRModel",ie]],["donut-swin",["DonutSwinModel",mi]],["yolos",["YolosModel",hu]],["dpt",["DPTModel",be]],["glpn",["GLPNModel",Yr]],["hifigan",["SpeechT5HifiGan",q0]],["efficientnet",["EfficientNetModel",KS]],["decision_transformer",["DecisionTransformerModel",Cx]],["patchtst",["PatchTSTForPrediction",rT]],["patchtsmixer",["PatchTSMixerForPrediction",iT]],["mobilenet_v1",["MobileNetV1Model",Sx]],["mobilenet_v2",["MobileNetV2Model",cm]],["mobilenet_v3",["MobileNetV3Model",XS]],["mobilenet_v4",["MobileNetV4Model",Ex]],["maskformer",["MaskFormerModel",nr]],["mgp-str",["MgpstrForSceneTextRecognition",tT]],["style_text_to_speech_2",["StyleTextToSpeech2Model",px]]]),pT=new Map([["t5",["T5Model",vi]],["longt5",["LongT5Model",Xi]],["mt5",["MT5Model",ma]],["bart",["BartModel",Mi]],["mbart",["MBartModel",Nn]],["marian",["MarianModel",cp]],["whisper",["WhisperModel",jo]],["m2m_100",["M2M100Model",fu]],["blenderbot",["BlenderbotModel",co]],["blenderbot-small",["BlenderbotSmallModel",ws]]]),Nk=new Map([["mimi",["MimiModel",Ix]],["dac",["DacModel",cT]],["snac",["SnacModel",hT]]]),ov=new Map([["bloom",["BloomModel",zs]],["jais",["JAISModel",xl]],["gpt2",["GPT2Model",bi]],["gptj",["GPTJModel",oh]],["gpt_bigcode",["GPTBigCodeModel",Y]],["gpt_neo",["GPTNeoModel",Fo]],["gpt_neox",["GPTNeoXModel",lu]],["codegen",["CodeGenModel",Ke]],["llama",["LlamaModel",gr]],["arcee",["ArceeModel",wn]],["lfm2",["Lfm2Model",ro]],["smollm3",["SmolLM3Model",ah]],["exaone",["ExaoneModel",uu]],["olmo",["OlmoModel",wd]],["olmo2",["Olmo2Model",Jf]],["mobilellm",["MobileLLMModel",Hh]],["granite",["GraniteModel",ch]],["cohere",["CohereModel",ep]],["gemma",["GemmaModel",Sd]],["gemma2",["Gemma2Model",nm]],["gemma3_text",["Gemma3Model",rp]],["helium",["HeliumModel",Gh]],["glm",["GlmModel",Fs]],["openelm",["OpenELMModel",ko]],["qwen2",["Qwen2Model",Xh]],["qwen3",["Qwen3Model",ls]],["phi",["PhiModel",np]],["phi3",["Phi3Model",fh]],["mpt",["MptModel",ap]],["opt",["OPTModel",sp]],["mistral",["MistralModel",zS]],["ernie4_5",["Ernie4_5_Model",H0]],["starcoder2",["Starcoder2Model",BS]],["falcon",["FalconModel",Z0]],["stablelm",["StableLmModel",HS]],["modernbert-decoder",["ModernBertDecoderModel",dt]]]),$x=new Map([["speecht5",["SpeechT5ForSpeechToText",kc]],["whisper",["WhisperForConditionalGeneration",Oa]],["lite-whisper",["LiteWhisperForConditionalGeneration",pl]],["moonshine",["MoonshineForConditionalGeneration",su]]]),Nx=new Map([["speecht5",["SpeechT5ForTextToSpeech",mx]]]),mT=new Map([["vits",["VitsModel",wx]],["musicgen",["MusicgenForConditionalGeneration",dg]]]),gT=new Map([["bert",["BertForSequenceClassification",mt]],["neobert",["NeoBertForSequenceClassification",mr]],["modernbert",["ModernBertForSequenceClassification",Pe]],["roformer",["RoFormerForSequenceClassification",Jr]],["electra",["ElectraForSequenceClassification",xt]],["esm",["EsmForSequenceClassification",Pr]],["convbert",["ConvBertForSequenceClassification",qr]],["camembert",["CamembertForSequenceClassification",_r]],["deberta",["DebertaForSequenceClassification",yn]],["deberta-v2",["DebertaV2ForSequenceClassification",so]],["mpnet",["MPNetForSequenceClassification",Uc]],["albert",["AlbertForSequenceClassification",Qr]],["distilbert",["DistilBertForSequenceClassification",la]],["roberta",["RobertaForSequenceClassification",Ms]],["xlm",["XLMForSequenceClassification",Ut]],["xlm-roberta",["XLMRobertaForSequenceClassification",Zn]],["bart",["BartForSequenceClassification",Ho]],["mbart",["MBartForSequenceClassification",ni]],["mobilebert",["MobileBertForSequenceClassification",ba]],["squeezebert",["SqueezeBertForSequenceClassification",Dt]]]),_T=new Map([["bert",["BertForTokenClassification",Zt]],["neobert",["NeoBertForTokenClassification",hr]],["modernbert",["ModernBertForTokenClassification",Ve]],["roformer",["RoFormerForTokenClassification",$t]],["electra",["ElectraForTokenClassification",wt]],["esm",["EsmForTokenClassification",Hr]],["convbert",["ConvBertForTokenClassification",An]],["camembert",["CamembertForTokenClassification",Or]],["deberta",["DebertaForTokenClassification",Vo]],["deberta-v2",["DebertaV2ForTokenClassification",Xs]],["mpnet",["MPNetForTokenClassification",Yt]],["distilbert",["DistilBertForTokenClassification",$s]],["roberta",["RobertaForTokenClassification",vo]],["xlm",["XLMForTokenClassification",Qt]],["xlm-roberta",["XLMRobertaForTokenClassification",Xn]]]),av=new Map([["t5",["T5ForConditionalGeneration",Ai]],["longt5",["LongT5ForConditionalGeneration",Oi]],["mt5",["MT5ForConditionalGeneration",Ri]],["bart",["BartForConditionalGeneration",di]],["mbart",["MBartForConditionalGeneration",Mo]],["marian",["MarianMTModel",nf]],["m2m_100",["M2M100ForConditionalGeneration",kd]],["blenderbot",["BlenderbotForConditionalGeneration",po]],["blenderbot-small",["BlenderbotSmallForConditionalGeneration",hl]]]),jx=new Map([["bloom",["BloomForCausalLM",td]],["gpt2",["GPT2LMHeadModel",qc]],["jais",["JAISLMHeadModel",So]],["gptj",["GPTJForCausalLM",yd]],["gpt_bigcode",["GPTBigCodeForCausalLM",he]],["gpt_neo",["GPTNeoForCausalLM",na]],["gpt_neox",["GPTNeoXForCausalLM",$l]],["codegen",["CodeGenForCausalLM",at]],["llama",["LlamaForCausalLM",Wr]],["arcee",["ArceeForCausalLM",Yn]],["lfm2",["Lfm2ForCausalLM",da]],["smollm3",["SmolLM3ForCausalLM",Qu]],["exaone",["ExaoneForCausalLM",sh]],["olmo",["OlmoForCausalLM",Cu]],["olmo2",["Olmo2ForCausalLM",rm]],["mobilellm",["MobileLLMForCausalLM",tm]],["granite",["GraniteForCausalLM",uh]],["cohere",["CohereForCausalLM",ed]],["gemma",["GemmaForCausalLM",Sc]],["gemma2",["Gemma2ForCausalLM",tp]],["gemma3_text",["Gemma3ForCausalLM",ig]],["helium",["HeliumForCausalLM",vd]],["glm",["GlmForCausalLM",qh]],["openelm",["OpenELMForCausalLM",Ra]],["qwen2",["Qwen2ForCausalLM",Td]],["qwen3",["Qwen3ForCausalLM",Yh]],["phi",["PhiForCausalLM",ip]],["phi3",["Phi3ForCausalLM",Ml]],["mpt",["MptForCausalLM",im]],["opt",["OPTForCausalLM",Pd]],["mbart",["MBartForCausalLM",Yi]],["mistral",["MistralForCausalLM",yx]],["ernie4_5",["Ernie4_5_ForCausalLM",bx]],["starcoder2",["Starcoder2ForCausalLM",US]],["falcon",["FalconForCausalLM",X0]],["trocr",["TrOCRForCausalLM",gx]],["stablelm",["StableLmForCausalLM",Mx]],["modernbert-decoder",["ModernBertDecoderForCausalLM",Pt]],["phi3_v",["Phi3VForCausalLM",xc]]]),jk=new Map([["multi_modality",["MultiModalityCausalLM",QS]]]),yg=new Map([["bert",["BertForMaskedLM",kt]],["neobert",["NeoBertForMaskedLM",wr]],["modernbert",["ModernBertForMaskedLM",Se]],["roformer",["RoFormerForMaskedLM",fr]],["electra",["ElectraForMaskedLM",Je]],["esm",["EsmForMaskedLM",os]],["convbert",["ConvBertForMaskedLM",Xr]],["camembert",["CamembertForMaskedLM",Mn]],["deberta",["DebertaForMaskedLM",Uo]],["deberta-v2",["DebertaV2ForMaskedLM",ra]],["mpnet",["MPNetForMaskedLM",Dl]],["albert",["AlbertForMaskedLM",Ln]],["distilbert",["DistilBertForMaskedLM",Eo]],["roberta",["RobertaForMaskedLM",_c]],["xlm",["XLMWithLMHeadModel",pt]],["xlm-roberta",["XLMRobertaForMaskedLM",vn]],["mobilebert",["MobileBertForMaskedLM",dl]],["squeezebert",["SqueezeBertForMaskedLM",Ft]]]),Vs=new Map([["bert",["BertForQuestionAnswering",Kt]],["neobert",["NeoBertForQuestionAnswering",xr]],["roformer",["RoFormerForQuestionAnswering",zr]],["electra",["ElectraForQuestionAnswering",pr]],["convbert",["ConvBertForQuestionAnswering",ge]],["camembert",["CamembertForQuestionAnswering",an]],["deberta",["DebertaForQuestionAnswering",Po]],["deberta-v2",["DebertaV2ForQuestionAnswering",xo]],["mpnet",["MPNetForQuestionAnswering",Ie]],["albert",["AlbertForQuestionAnswering",Dr]],["distilbert",["DistilBertForQuestionAnswering",wo]],["roberta",["RobertaForQuestionAnswering",Ss]],["xlm",["XLMForQuestionAnswering",Er]],["xlm-roberta",["XLMRobertaForQuestionAnswering",Ui]],["mobilebert",["MobileBertForQuestionAnswering",Ga]],["squeezebert",["SqueezeBertForQuestionAnswering",yr]]]),Q_=new Map([["vision-encoder-decoder",["VisionEncoderDecoderModel",ml]],["idefics3",["Idefics3ForConditionalGeneration",Wc]],["smolvlm",["SmolVLMForConditionalGeneration",ua]]]),Rx=new Map([["llava",["LlavaForConditionalGeneration",vc]],["llava_onevision",["LlavaOnevisionForConditionalGeneration",bc]],["moondream1",["Moondream1ForConditionalGeneration",La]],["florence2",["Florence2ForConditionalGeneration",gl]],["qwen2-vl",["Qwen2VLForConditionalGeneration",Qh]],["idefics3",["Idefics3ForConditionalGeneration",Wc]],["smolvlm",["SmolVLMForConditionalGeneration",ua]],["paligemma",["PaliGemmaForConditionalGeneration",Ql]],["llava_qwen2",["LlavaQwen2ForCausalLM",Yu]],["gemma3n",["Gemma3nForConditionalGeneration",Vc]]]),Fx=new Map([["ultravox",["UltravoxModel",Y_]],["voxtral",["VoxtralForConditionalGeneration",mg]]]),zx=new Map([["vision-encoder-decoder",["VisionEncoderDecoderModel",ml]]]),dm=new Map([["vit",["ViTForImageClassification",ic]],["ijepa",["IJepaForImageClassification",Ed]],["pvt",["PvtForImageClassification",we]],["vit_msn",["ViTMSNForImageClassification",ht]],["fastvit",["FastViTForImageClassification",Nt]],["mobilevit",["MobileViTForImageClassification",Lr]],["mobilevitv2",["MobileViTV2ForImageClassification",zn]],["beit",["BeitForImageClassification",xa]],["deit",["DeiTForImageClassification",jl]],["hiera",["HieraForImageClassification",A]],["convnext",["ConvNextForImageClassification",bo]],["convnextv2",["ConvNextV2ForImageClassification",ei]],["dinov2",["Dinov2ForImageClassification",Aa]],["dinov2_with_registers",["Dinov2WithRegistersForImageClassification",Rl]],["resnet",["ResNetForImageClassification",b]],["swin",["SwinForImageClassification",R]],["segformer",["SegformerForImageClassification",GS]],["efficientnet",["EfficientNetForImageClassification",Ya]],["mobilenet_v1",["MobileNetV1ForImageClassification",Tx]],["mobilenet_v2",["MobileNetV2ForImageClassification",X_]],["mobilenet_v3",["MobileNetV3ForImageClassification",Px]],["mobilenet_v4",["MobileNetV4ForImageClassification",pg]]]),Bx=new Map([["detr",["DetrForObjectDetection",Zo]],["rt_detr",["RTDetrForObjectDetection",Xo]],["rt_detr_v2",["RTDetrV2ForObjectDetection",Li]],["rf_detr",["RFDetrForObjectDetection",no]],["d_fine",["DFineForObjectDetection",Es]],["table-transformer",["TableTransformerForObjectDetection",ds]],["yolos",["YolosForObjectDetection",zl]]]),yT=new Map([["owlvit",["OwlViTForObjectDetection",jn]],["owlv2",["Owlv2ForObjectDetection",En]],["grounding-dino",["GroundingDinoForObjectDetection",mh]]]),vg=new Map([["detr",["DetrForSegmentation",Wo]],["clipseg",["CLIPSegForImageSegmentation",bl]]]),vT=new Map([["segformer",["SegformerForSemanticSegmentation",qS]],["sapiens",["SapiensForSemanticSegmentation",ft]],["swin",["SwinForSemanticSegmentation",W]],["mobilenet_v1",["MobileNetV1ForSemanticSegmentation",hg]],["mobilenet_v2",["MobileNetV2ForSemanticSegmentation",um]],["mobilenet_v3",["MobileNetV3ForSemanticSegmentation",mp]],["mobilenet_v4",["MobileNetV4ForSemanticSegmentation",ev]]]),bT=new Map([["detr",["DetrForSegmentation",Wo]],["maskformer",["MaskFormerForInstanceSegmentation",cr]]]),xT=new Map([["sam",["SamModel",As]]]),wT=new Map([["wav2vec2",["Wav2Vec2ForCTC",V_]],["wav2vec2-bert",["Wav2Vec2BertForCTC",NS]],["unispeech",["UniSpeechForCTC",DS]],["unispeech-sat",["UniSpeechSatForCTC",$S]],["wavlm",["WavLMForCTC",dx]],["hubert",["HubertForCTC",cx]]]),MT=new Map([["wav2vec2",["Wav2Vec2ForSequenceClassification",og]],["wav2vec2-bert",["Wav2Vec2BertForSequenceClassification",sg]],["unispeech",["UniSpeechForSequenceClassification",sx]],["unispeech-sat",["UniSpeechSatForSequenceClassification",V0]],["wavlm",["WavLMForSequenceClassification",hx]],["hubert",["HubertForSequenceClassification",ux]],["audio-spectrogram-transformer",["ASTForAudioClassification",pi]]]),ST=new Map([["wavlm",["WavLMForXVector",fx]]]),TT=new Map([["unispeech-sat",["UniSpeechSatForAudioFrameClassification",lx]],["wavlm",["WavLMForAudioFrameClassification",RS]],["wav2vec2",["Wav2Vec2ForAudioFrameClassification",am]],["pyannote",["PyAnnoteForAudioFrameClassification",nd]]]),PT=new Map([["vitmatte",["VitMatteForImageMatting",Tr]]]),Rk=new Map([["patchtst",["PatchTSTForPrediction",nT]],["patchtsmixer",["PatchTSMixerForPrediction",kx]]]),ET=new Map([["swin2sr",["Swin2SRForImageSuperResolution",ce]]]),Ux=new Map([["dpt",["DPTForDepthEstimation",Ae]],["depth_anything",["DepthAnythingForDepthEstimation",lt]],["glpn",["GLPNForDepthEstimation",$r]],["sapiens",["SapiensForDepthEstimation",gt]],["depth_pro",["DepthProForDepthEstimation",It]],["metric3d",["Metric3DForDepthEstimation",St]],["metric3dv2",["Metric3Dv2ForDepthEstimation",ur]]]),sv=new Map([["sapiens",["SapiensForNormalEstimation",Et]]]),Vx=new Map([["vitpose",["VitPoseForPoseEstimation",B]]]),of=new Map([["clip",["CLIPVisionModelWithProjection",js]],["siglip",["SiglipVisionModel",Mc]],["jina_clip",["JinaCLIPVisionModel",rc]]]),bg=[[fT,D.EncoderOnly],[pT,D.EncoderDecoder],[ov,D.DecoderOnly],[Nk,D.AutoEncoder],[gT,D.EncoderOnly],[_T,D.EncoderOnly],[av,D.Seq2Seq],[$x,D.Seq2Seq],[jx,D.DecoderOnly],[jk,D.MultiModality],[yg,D.EncoderOnly],[Vs,D.EncoderOnly],[Q_,D.Vision2Seq],[Rx,D.ImageTextToText],[Fx,D.AudioTextToText],[dm,D.EncoderOnly],[vg,D.EncoderOnly],[bT,D.EncoderOnly],[vT,D.EncoderOnly],[PT,D.EncoderOnly],[Rk,D.EncoderOnly],[ET,D.EncoderOnly],[Ux,D.EncoderOnly],[sv,D.EncoderOnly],[Vx,D.EncoderOnly],[Bx,D.EncoderOnly],[yT,D.EncoderOnly],[xT,D.MaskGeneration],[wT,D.EncoderOnly],[MT,D.EncoderOnly],[Nx,D.Seq2Seq],[mT,D.EncoderOnly],[ST,D.EncoderOnly],[TT,D.EncoderOnly],[of,D.EncoderOnly]];for(const[se,Me]of bg)for(const[qe,zt]of se.values())L.set(qe,Me),j.set(zt,qe),N.set(qe,zt);const xg=[["MusicgenForConditionalGeneration",dg,D.Musicgen],["Phi3VForCausalLM",xc,D.Phi3V],["CLIPTextModelWithProjection",ss,D.EncoderOnly],["SiglipTextModel",tc,D.EncoderOnly],["JinaCLIPTextModel",Gc,D.EncoderOnly],["ClapTextModelWithProjection",ug,D.EncoderOnly],["ClapAudioModelWithProjection",VS,D.EncoderOnly],["DacEncoderModel",uT,D.EncoderOnly],["DacDecoderModel",dT,D.EncoderOnly],["MimiEncoderModel",Ox,D.EncoderOnly],["MimiDecoderModel",lT,D.EncoderOnly],["SnacEncoderModel",Dx,D.EncoderOnly],["SnacDecoderModel",iv,D.EncoderOnly],["Gemma3nForConditionalGeneration",Vc,D.ImageAudioTextToText]];for(const[se,Me,qe]of xg)L.set(se,qe),j.set(Me,se),N.set(se,Me);const J_=new Map([["modnet",vg],["birefnet",vg],["isnet",vg],["ben",vg]]);for(const[se,Me]of J_.entries())Me.set(se,["PreTrainedModel",ke]),L.set(se,D.EncoderOnly),j.set(ke,se),N.set(se,ke);class wg extends Oo{}_t(wg,"MODEL_CLASS_MAPPINGS",bg.map(Me=>Me[0])),_t(wg,"BASE_IF_FAIL",!0);class AT extends Oo{}_t(AT,"MODEL_CLASS_MAPPINGS",[gT]);class CT extends Oo{}_t(CT,"MODEL_CLASS_MAPPINGS",[_T]);class Wx extends Oo{}_t(Wx,"MODEL_CLASS_MAPPINGS",[av]);class Gx extends Oo{}_t(Gx,"MODEL_CLASS_MAPPINGS",[$x]);class kT extends Oo{}_t(kT,"MODEL_CLASS_MAPPINGS",[Nx]);class qx extends Oo{}_t(qx,"MODEL_CLASS_MAPPINGS",[mT]);class Hx extends Oo{}_t(Hx,"MODEL_CLASS_MAPPINGS",[jx]);class lv extends Oo{}_t(lv,"MODEL_CLASS_MAPPINGS",[yg]);class cv extends Oo{}_t(cv,"MODEL_CLASS_MAPPINGS",[Vs]);class IT extends Oo{}_t(IT,"MODEL_CLASS_MAPPINGS",[Q_]);class Kx extends Oo{}_t(Kx,"MODEL_CLASS_MAPPINGS",[dm]);class OT extends Oo{}_t(OT,"MODEL_CLASS_MAPPINGS",[vg]);class LT extends Oo{}_t(LT,"MODEL_CLASS_MAPPINGS",[vT]);class DT extends Oo{}_t(DT,"MODEL_CLASS_MAPPINGS",[bT]);class $T extends Oo{}_t($T,"MODEL_CLASS_MAPPINGS",[Bx]);class NT extends Oo{}_t(NT,"MODEL_CLASS_MAPPINGS",[yT]);class Zx extends Oo{}_t(Zx,"MODEL_CLASS_MAPPINGS",[xT]);class Xx extends Oo{}_t(Xx,"MODEL_CLASS_MAPPINGS",[wT]);class gh extends Oo{}_t(gh,"MODEL_CLASS_MAPPINGS",[MT]);class af extends Oo{}_t(af,"MODEL_CLASS_MAPPINGS",[ST]);class Yx extends Oo{}_t(Yx,"MODEL_CLASS_MAPPINGS",[TT]);class uv extends Oo{}_t(uv,"MODEL_CLASS_MAPPINGS",[zx]);class jT extends Oo{}_t(jT,"MODEL_CLASS_MAPPINGS",[PT]);class ey extends Oo{}_t(ey,"MODEL_CLASS_MAPPINGS",[ET]);class dv extends Oo{}_t(dv,"MODEL_CLASS_MAPPINGS",[Ux]);class RT extends Oo{}_t(RT,"MODEL_CLASS_MAPPINGS",[sv]);class hv extends Oo{}_t(hv,"MODEL_CLASS_MAPPINGS",[Vx]);class fv extends Oo{}_t(fv,"MODEL_CLASS_MAPPINGS",[of]);class hm extends Oo{}_t(hm,"MODEL_CLASS_MAPPINGS",[Rx]);class Qx extends Oo{}_t(Qx,"MODEL_CLASS_MAPPINGS",[Fx]);class FT extends Xe{constructor({logits:Me,past_key_values:qe,encoder_outputs:zt,decoder_attentions:ir=null,cross_attentions:rr=null}){super(),this.logits=Me,this.past_key_values=qe,this.encoder_outputs=zt,this.decoder_attentions=ir,this.cross_attentions=rr}}class xi extends Xe{constructor({logits:Me,...qe}){super(),this.logits=Me;const zt=Object.values(qe);zt.length>0&&(this.attentions=zt)}}class Jx extends Xe{constructor({logits:Me,embeddings:qe}){super(),this.logits=Me,this.embeddings=qe}}class fs extends Xe{constructor({logits:Me}){super(),this.logits=Me}}class el extends Xe{constructor({logits:Me}){super(),this.logits=Me}}class oc extends Xe{constructor({start_logits:Me,end_logits:qe}){super(),this.start_logits=Me,this.end_logits=qe}}class fm extends Xe{constructor({logits:Me}){super(),this.logits=Me}}class zT extends Xe{constructor({logits:Me,past_key_values:qe}){super(),this.logits=Me,this.past_key_values=qe}}class BT extends Xe{constructor({alphas:Me}){super(),this.alphas=Me}}class UT extends Xe{constructor({waveform:Me,spectrogram:qe}){super(),this.waveform=Me,this.spectrogram=qe}}},"./src/models/audio_spectrogram_transformer/feature_extraction_audio_spectrogram_transformer.js":(e,t,r)=>{r.r(t),r.d(t,{ASTFeatureExtractor:()=>o});var n=r("./src/base/feature_extraction_utils.js");r("./src/utils/tensor.js");var i=r("./src/utils/audio.js");class o extends n.FeatureExtractor{constructor(a){super(a);const u=this.config.sampling_rate,d=(0,i.mel_filter_bank)(257,this.config.num_mel_bins,20,Math.floor(u/2),u,null,"kaldi",!0);this.mel_filters=d,this.window=(0,i.window_function)(400,"hann",{periodic:!1}),this.mean=this.config.mean,this.std=this.config.std}async _extract_fbank_features(a,u){return(0,i.spectrogram)(a,this.window,400,160,{fft_length:512,power:2,center:!1,preemphasis:.97,mel_filters:this.mel_filters,log_mel:"log",mel_floor:1192092955078125e-22,remove_dc_offset:!0,max_num_frames:u,transpose:!0})}async _call(a){(0,n.validate_audio_inputs)(a,"ASTFeatureExtractor");const u=await this._extract_fbank_features(a,this.config.max_length);if(this.config.do_normalize){const d=this.std*2,m=u.data;for(let g=0;g<m.length;++g)m[g]=(m[g]-this.mean)/d}return{input_values:u.unsqueeze_(0)}}}},"./src/models/auto/feature_extraction_auto.js":(e,t,r)=>{r.r(t),r.d(t,{AutoFeatureExtractor:()=>s});var n=r("./src/utils/constants.js"),i=r("./src/utils/hub.js");r("./src/base/feature_extraction_utils.js");var o=r("./src/models/feature_extractors.js");class s{static async from_pretrained(u,d={}){const m=await(0,i.getModelJSON)(u,n.FEATURE_EXTRACTOR_NAME,!0,d),g=m.feature_extractor_type,_=o[g];if(!_)throw new Error(`Unknown feature_extractor_type: '${g}'. Please report this at ${n.GITHUB_ISSUE_URL}.`);return new _(m)}}},"./src/models/auto/image_processing_auto.js":(e,t,r)=>{r.r(t),r.d(t,{AutoImageProcessor:()=>a});var n=r("./src/utils/constants.js"),i=r("./src/utils/hub.js"),o=r("./src/base/image_processors_utils.js"),s=r("./src/models/image_processors.js");class a{static async from_pretrained(d,m={}){const g=await(0,i.getModelJSON)(d,n.IMAGE_PROCESSOR_NAME,!0,m),_=g.image_processor_type??g.feature_extractor_type;let y=s[_==null?void 0:_.replace(/Fast$/,"")];return y||(_!==void 0&&console.warn(`Image processor type '${_}' not found, assuming base ImageProcessor. Please report this at ${n.GITHUB_ISSUE_URL}.`),y=o.ImageProcessor),new y(g)}}},"./src/models/auto/processing_auto.js":(e,t,r)=>{r.r(t),r.d(t,{AutoProcessor:()=>d});var n=r("./src/utils/constants.js"),i=r("./src/utils/hub.js"),o=r("./src/base/processing_utils.js"),s=r("./src/models/processors.js"),a=r("./src/models/image_processors.js"),u=r("./src/models/feature_extractors.js");class d{static async from_pretrained(g,_={}){const y=await(0,i.getModelJSON)(g,n.IMAGE_PROCESSOR_NAME,!0,_),{image_processor_type:M,feature_extractor_type:x,processor_class:E}=y;if(E&&s[E])return s[E].from_pretrained(g,_);if(!M&&!x)throw new Error("No `image_processor_type` or `feature_extractor_type` found in the config.");const T={};if(M){const C=a[M.replace(/Fast$/,"")];if(!C)throw new Error(`Unknown image_processor_type: '${M}'.`);T.image_processor=new C(y)}if(x){const C=a[x];if(C)T.image_processor=new C(y);else{const D=u[x];if(!D)throw new Error(`Unknown feature_extractor_type: '${x}'.`);T.feature_extractor=new D(y)}}const P={};return new o.Processor(P,T,null)}}},"./src/models/beit/image_processing_beit.js":(e,t,r)=>{r.r(t),r.d(t,{BeitFeatureExtractor:()=>i});var n=r("./src/base/image_processors_utils.js");class i extends n.ImageProcessor{}},"./src/models/bit/image_processing_bit.js":(e,t,r)=>{r.r(t),r.d(t,{BitImageProcessor:()=>i});var n=r("./src/base/image_processors_utils.js");class i extends n.ImageProcessor{}},"./src/models/chinese_clip/image_processing_chinese_clip.js":(e,t,r)=>{r.r(t),r.d(t,{ChineseCLIPFeatureExtractor:()=>i});var n=r("./src/base/image_processors_utils.js");class i extends n.ImageProcessor{}},"./src/models/clap/feature_extraction_clap.js":(e,t,r)=>{r.r(t),r.d(t,{ClapFeatureExtractor:()=>o});var n=r("./src/base/feature_extraction_utils.js");r("./src/utils/tensor.js");var i=r("./src/utils/audio.js");class o extends n.FeatureExtractor{constructor(a){super(a),this.mel_filters=(0,i.mel_filter_bank)(this.config.nb_frequency_bins,this.config.feature_size,this.config.frequency_min,this.config.frequency_max,this.config.sampling_rate,null,"htk"),this.mel_filters_slaney=(0,i.mel_filter_bank)(this.config.nb_frequency_bins,this.config.feature_size,this.config.frequency_min,this.config.frequency_max,this.config.sampling_rate,"slaney","slaney"),this.window=(0,i.window_function)(this.config.fft_window_size,"hann")}async _get_input_mel(a,u,d,m){let g;const _=a.length-u;if(_>0)if(d==="rand_trunc"){const y=Math.floor(Math.random()*(_+1));a=a.subarray(y,y+u),g=await this._extract_fbank_features(a,this.mel_filters_slaney,this.config.nb_max_samples)}else throw new Error(`Truncation strategy "${d}" not implemented`);else{if(_<0){let y=new Float64Array(u);if(y.set(a),m==="repeat")for(let M=a.length;M<u;M+=a.length)y.set(a.subarray(0,Math.min(a.length,u-M)),M);else if(m==="repeatpad")for(let M=a.length;M<-_;M+=a.length)y.set(a,M);a=y}if(d==="fusion")throw new Error(`Truncation strategy "${d}" not implemented`);g=await this._extract_fbank_features(a,this.mel_filters_slaney,this.config.nb_max_samples)}return g.unsqueeze_(0)}async _extract_fbank_features(a,u,d=null){return(0,i.spectrogram)(a,this.window,this.config.fft_window_size,this.config.hop_length,{power:2,mel_filters:u,log_mel:"dB",max_num_frames:d,do_pad:!1,transpose:!0})}async _call(a,{max_length:u=null}={}){return(0,n.validate_audio_inputs)(a,"ClapFeatureExtractor"),{input_features:(await this._get_input_mel(a,u??this.config.nb_max_samples,this.config.truncation,this.config.padding)).unsqueeze_(0)}}}},"./src/models/clip/image_processing_clip.js":(e,t,r)=>{r.r(t),r.d(t,{CLIPFeatureExtractor:()=>o,CLIPImageProcessor:()=>i});var n=r("./src/base/image_processors_utils.js");class i extends n.ImageProcessor{}class o extends i{}},"./src/models/convnext/image_processing_convnext.js":(e,t,r)=>{r.r(t),r.d(t,{ConvNextFeatureExtractor:()=>o,ConvNextImageProcessor:()=>i});var n=r("./src/base/image_processors_utils.js");class i extends n.ImageProcessor{constructor(a){super(a),this.crop_pct=this.config.crop_pct??224/256}async resize(a){var d;const u=(d=this.size)==null?void 0:d.shortest_edge;if(u===void 0)throw new Error("Size dictionary must contain 'shortest_edge' key.");if(u<384){const m=Math.floor(u/this.crop_pct),[g,_]=this.get_resize_output_image_size(a,{shortest_edge:m});a=await a.resize(g,_,{resample:this.resample}),a=await a.center_crop(u,u)}else a=await a.resize(u,u,{resample:this.resample});return a}}class o extends i{}},"./src/models/dac/feature_extraction_dac.js":(e,t,r)=>{r.r(t),r.d(t,{DacFeatureExtractor:()=>i});var n=r("./src/models/encodec/feature_extraction_encodec.js");class i extends n.EncodecFeatureExtractor{}},"./src/models/deit/image_processing_deit.js":(e,t,r)=>{r.r(t),r.d(t,{DeiTFeatureExtractor:()=>o,DeiTImageProcessor:()=>i});var n=r("./src/base/image_processors_utils.js");class i extends n.ImageProcessor{}class o extends i{}},"./src/models/detr/image_processing_detr.js":(e,t,r)=>{r.r(t),r.d(t,{DetrFeatureExtractor:()=>s,DetrImageProcessor:()=>o});var n=r("./src/base/image_processors_utils.js"),i=r("./src/utils/tensor.js");class o extends n.ImageProcessor{async _call(u){const d=await super._call(u),m=[d.pixel_values.dims[0],64,64],g=(0,i.full)(m,1n);return{...d,pixel_mask:g}}post_process_object_detection(...u){return(0,n.post_process_object_detection)(...u)}post_process_panoptic_segmentation(...u){return(0,n.post_process_panoptic_segmentation)(...u)}post_process_instance_segmentation(...u){return(0,n.post_process_instance_segmentation)(...u)}}class s extends o{}},"./src/models/dinov3_vit/image_processing_dinov3_vit.js":(e,t,r)=>{r.r(t),r.d(t,{DINOv3ViTImageProcessor:()=>i});var n=r("./src/base/image_processors_utils.js");class i extends n.ImageProcessor{}},"./src/models/donut/image_processing_donut.js":(e,t,r)=>{r.r(t),r.d(t,{DonutFeatureExtractor:()=>o,DonutImageProcessor:()=>i});var n=r("./src/base/image_processors_utils.js");class i extends n.ImageProcessor{pad_image(a,u,d,m={}){const[g,_,y]=u;let M=this.image_mean;Array.isArray(this.image_mean)||(M=new Array(y).fill(M));let x=this.image_std;Array.isArray(x)||(x=new Array(y).fill(M));const E=M.map((T,P)=>-T/x[P]);return super.pad_image(a,u,d,{center:!0,constant_values:E,...m})}}class o extends i{}},"./src/models/dpt/image_processing_dpt.js":(e,t,r)=>{r.r(t),r.d(t,{DPTFeatureExtractor:()=>o,DPTImageProcessor:()=>i});var n=r("./src/base/image_processors_utils.js");class i extends n.ImageProcessor{}class o extends i{}},"./src/models/efficientnet/image_processing_efficientnet.js":(e,t,r)=>{r.r(t),r.d(t,{EfficientNetImageProcessor:()=>i});var n=r("./src/base/image_processors_utils.js");class i extends n.ImageProcessor{constructor(s){super(s),this.include_top=this.config.include_top??!0,this.include_top&&(this.image_std=this.image_std.map(a=>a*a))}}},"./src/models/encodec/feature_extraction_encodec.js":(e,t,r)=>{r.r(t),r.d(t,{EncodecFeatureExtractor:()=>o});var n=r("./src/base/feature_extraction_utils.js"),i=r("./src/utils/tensor.js");class o extends n.FeatureExtractor{async _call(a){(0,n.validate_audio_inputs)(a,"EncodecFeatureExtractor"),a instanceof Float64Array&&(a=new Float32Array(a));const u=this.config.feature_size;if(a.length%u!==0)throw new Error(`The length of the audio data must be a multiple of the number of channels (${u}).`);const d=[1,u,a.length/u];return{input_values:new i.Tensor("float32",a,d)}}}},"./src/models/feature_extractors.js":(e,t,r)=>{r.r(t),r.d(t,{ASTFeatureExtractor:()=>n.ASTFeatureExtractor,ClapFeatureExtractor:()=>o.ClapFeatureExtractor,DacFeatureExtractor:()=>s.DacFeatureExtractor,EncodecFeatureExtractor:()=>i.EncodecFeatureExtractor,Gemma3nAudioFeatureExtractor:()=>a.Gemma3nAudioFeatureExtractor,ImageFeatureExtractor:()=>E.ImageProcessor,MoonshineFeatureExtractor:()=>u.MoonshineFeatureExtractor,PyAnnoteFeatureExtractor:()=>d.PyAnnoteFeatureExtractor,SeamlessM4TFeatureExtractor:()=>m.SeamlessM4TFeatureExtractor,SnacFeatureExtractor:()=>g.SnacFeatureExtractor,SpeechT5FeatureExtractor:()=>_.SpeechT5FeatureExtractor,Wav2Vec2FeatureExtractor:()=>y.Wav2Vec2FeatureExtractor,WeSpeakerFeatureExtractor:()=>M.WeSpeakerFeatureExtractor,WhisperFeatureExtractor:()=>x.WhisperFeatureExtractor});var n=r("./src/models/audio_spectrogram_transformer/feature_extraction_audio_spectrogram_transformer.js"),i=r("./src/models/encodec/feature_extraction_encodec.js"),o=r("./src/models/clap/feature_extraction_clap.js"),s=r("./src/models/dac/feature_extraction_dac.js"),a=r("./src/models/gemma3n/feature_extraction_gemma3n.js"),u=r("./src/models/moonshine/feature_extraction_moonshine.js"),d=r("./src/models/pyannote/feature_extraction_pyannote.js"),m=r("./src/models/seamless_m4t/feature_extraction_seamless_m4t.js"),g=r("./src/models/snac/feature_extraction_snac.js"),_=r("./src/models/speecht5/feature_extraction_speecht5.js"),y=r("./src/models/wav2vec2/feature_extraction_wav2vec2.js"),M=r("./src/models/wespeaker/feature_extraction_wespeaker.js"),x=r("./src/models/whisper/feature_extraction_whisper.js"),E=r("./src/base/image_processors_utils.js")},"./src/models/florence2/processing_florence2.js":(e,t,r)=>{r.r(t),r.d(t,{Florence2Processor:()=>s});var n=r("./src/base/processing_utils.js"),i=r("./src/models/auto/image_processing_auto.js"),o=r("./src/tokenizers.js");class s extends n.Processor{constructor(u,d,m){super(u,d,m);const{tasks_answer_post_processing_type:g,task_prompts_without_inputs:_,task_prompts_with_input:y}=this.image_processor.config;this.tasks_answer_post_processing_type=new Map(Object.entries(g??{})),this.task_prompts_without_inputs=new Map(Object.entries(_??{})),this.task_prompts_with_input=new Map(Object.entries(y??{})),this.regexes={quad_boxes:/(.+?)<loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)>/gm,bboxes:/([^<]+)?<loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)>/gm},this.size_per_bin=1e3}construct_prompts(u){typeof u=="string"&&(u=[u]);const d=[];for(const m of u)if(this.task_prompts_without_inputs.has(m))d.push(this.task_prompts_without_inputs.get(m));else{for(const[g,_]of this.task_prompts_with_input)if(m.includes(g)){d.push(_.replaceAll("{input}",m).replaceAll(g,""));break}d.length!==u.length&&d.push(m)}return d}post_process_generation(u,d,m){const g=this.tasks_answer_post_processing_type.get(d)??"pure_text";u=u.replaceAll("<s>","").replaceAll("</s>","");let _;switch(g){case"pure_text":_=u;break;case"description_with_bboxes":case"bboxes":case"phrase_grounding":case"ocr":const y=g==="ocr"?"quad_boxes":"bboxes",M=u.matchAll(this.regexes[y]),x=[],E=[];for(const[T,P,...C]of M)x.push(P?P.trim():x.at(-1)??""),E.push(C.map((D,L)=>(Number(D)+.5)/this.size_per_bin*m[L%2]));_={labels:x,[y]:E};break;default:throw new Error(`Task "${d}" (of type "${g}") not yet implemented.`)}return{[d]:_}}async _call(u,d=null,m={}){if(!u&&!d)throw new Error("Either text or images must be provided");const g=await this.image_processor(u,m),_=d?this.tokenizer(this.construct_prompts(d),m):{};return{...g,..._}}}_t(s,"tokenizer_class",o.AutoTokenizer),_t(s,"image_processor_class",i.AutoImageProcessor)},"./src/models/gemma3n/feature_extraction_gemma3n.js":(e,t,r)=>{r.r(t),r.d(t,{Gemma3nAudioFeatureExtractor:()=>s});var n=r("./src/base/feature_extraction_utils.js"),i=r("./src/utils/tensor.js"),o=r("./src/utils/audio.js");class s extends n.FeatureExtractor{constructor(u){super(u);const{fft_length:d,feature_size:m,min_frequency:g,max_frequency:_,sampling_rate:y,frame_length:M}=this.config,x=(0,o.mel_filter_bank)(Math.floor(1+d/2),m,g,_,y,null,"htk",!1);this.mel_filters=x,this.window=(0,o.window_function)(M,"hann")}async _extract_fbank_features(u,d){return(0,o.spectrogram)(u,this.window,this.config.frame_length,this.config.hop_length,{fft_length:this.config.fft_length,center:!1,onesided:!0,preemphasis:this.config.preemphasis,preemphasis_htk_flavor:this.config.preemphasis_htk_flavor,mel_filters:this.mel_filters,log_mel:"log",mel_floor:this.config.mel_floor,remove_dc_offset:!1,transpose:!0})}async _call(u,{max_length:d=48e4,truncation:m=!0,padding:g=!0,pad_to_multiple_of:_=128}={}){if((0,n.validate_audio_inputs)(u,"Gemma3nAudioFeatureExtractor"),m&&u.length>d&&(u=u.slice(0,d)),g&&u.length%_!==0){const x=_-u.length%_,E=new Float64Array(u.length+x);E.set(u),this.config.padding_value!==0&&E.fill(this.config.padding_value,u.length),u=E}const y=await this._extract_fbank_features(u,this.config.max_length),M=(0,i.full)([1,y.dims[0]],!0);return{input_features:y.unsqueeze_(0),input_features_mask:M}}}},"./src/models/gemma3n/processing_gemma3n.js":(e,t,r)=>{r.r(t),r.d(t,{Gemma3nProcessor:()=>a});var n=r("./src/base/processing_utils.js"),i=r("./src/models/auto/image_processing_auto.js"),o=r("./src/models/auto/feature_extraction_auto.js"),s=r("./src/tokenizers.js");r("./src/utils/image.js"),r("./src/utils/audio.js");class a extends n.Processor{constructor(d,m,g){super(d,m,g),this.audio_seq_length=this.config.audio_seq_length,this.image_seq_length=this.config.image_seq_length;const{audio_token_id:_,boa_token:y,audio_token:M,eoa_token:x,image_token_id:E,boi_token:T,image_token:P,eoi_token:C}=this.tokenizer.config;this.audio_token_id=_,this.boa_token=y,this.audio_token=M;const D=M.repeat(this.audio_seq_length);this.full_audio_sequence=`

${y}${D}${x}

`,this.image_token_id=E,this.boi_token=T,this.image_token=P;const L=P.repeat(this.image_seq_length);this.full_image_sequence=`

${T}${L}${C}

`}async _call(d,m=null,g=null,_={}){typeof d=="string"&&(d=[d]);let y;g&&(y=await this.feature_extractor(g,_),d=d.map(E=>E.replaceAll(this.audio_token,this.full_audio_sequence)));let M;return m&&(M=await this.image_processor(m,_),d=d.map(E=>E.replaceAll(this.image_token,this.full_image_sequence))),{...this.tokenizer(d,_),...M,...y}}}_t(a,"image_processor_class",i.AutoImageProcessor),_t(a,"feature_extractor_class",o.AutoFeatureExtractor),_t(a,"tokenizer_class",s.AutoTokenizer),_t(a,"uses_processor_config",!0),_t(a,"uses_chat_template_file",!0)},"./src/models/glpn/image_processing_glpn.js":(e,t,r)=>{r.r(t),r.d(t,{GLPNFeatureExtractor:()=>i});var n=r("./src/base/image_processors_utils.js");class i extends n.ImageProcessor{}},"./src/models/grounding_dino/image_processing_grounding_dino.js":(e,t,r)=>{r.r(t),r.d(t,{GroundingDinoImageProcessor:()=>o});var n=r("./src/base/image_processors_utils.js"),i=r("./src/utils/tensor.js");class o extends n.ImageProcessor{async _call(a){const u=await super._call(a),d=u.pixel_values.dims,m=(0,i.ones)([d[0],d[2],d[3]]);return{...u,pixel_mask:m}}}},"./src/models/grounding_dino/processing_grounding_dino.js":(e,t,r)=>{r.r(t),r.d(t,{GroundingDinoProcessor:()=>u});var n=r("./src/base/processing_utils.js"),i=r("./src/models/auto/image_processing_auto.js"),o=r("./src/tokenizers.js"),s=r("./src/base/image_processors_utils.js");function a(d,m){const _=d.dims.at(-1)-1,y=d.tolist();y.fill(!1,0,1),y.fill(!1,_);const M=m.tolist();return y.map((x,E)=>x?E:null).filter(x=>x!==null).map(x=>M[x])}class u extends n.Processor{async _call(m,g,_={}){const y=m?await this.image_processor(m,_):{};return{...g?this.tokenizer(g,_):{},...y}}post_process_grounded_object_detection(m,g,{box_threshold:_=.25,text_threshold:y=.25,target_sizes:M=null}={}){const{logits:x,pred_boxes:E}=m,T=x.dims[0];if(M!==null&&M.length!==T)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");const P=x.dims.at(1),C=x.sigmoid(),D=C.max(-1).tolist(),L=E.tolist().map(j=>j.map($=>(0,s.center_to_corners_format)($))),N=[];for(let j=0;j<T;++j){const $=M!==null?M[j]:null;$!==null&&(L[j]=L[j].map(ee=>ee.map((ae,de)=>ae*$[(de+1)%2])));const U=D[j],G=[],H=[],X=[];for(let ee=0;ee<P;++ee){const ae=U[ee];if(ae<=_)continue;const de=L[j][ee],ye=C[j][ee];G.push(ae),X.push(de);const _e=a(ye.gt(y),g[j]);H.push(_e)}N.push({scores:G,boxes:X,labels:this.batch_decode(H)})}return N}}_t(u,"tokenizer_class",o.AutoTokenizer),_t(u,"image_processor_class",i.AutoImageProcessor)},"./src/models/idefics3/image_processing_idefics3.js":(e,t,r)=>{r.r(t),r.d(t,{Idefics3ImageProcessor:()=>o});var n=r("./src/base/image_processors_utils.js"),i=r("./src/utils/tensor.js");class o extends n.ImageProcessor{constructor(a){super(a),this.do_image_splitting=a.do_image_splitting??!0,this.max_image_size=a.max_image_size}get_resize_for_vision_encoder(a,u){let[d,m]=a.dims.slice(-2);const g=m/d;return m>=d?(m=Math.ceil(m/u)*u,d=Math.floor(m/g),d=Math.ceil(d/u)*u):(d=Math.ceil(d/u)*u,m=Math.floor(d*g),m=Math.ceil(m/u)*u),{height:d,width:m}}async _call(a,{do_image_splitting:u=null,return_row_col_info:d=!1}={}){let m;if(!Array.isArray(a))m=[[a]];else{if(a.length===0||!a[0])throw new Error("No images provided.");Array.isArray(a[0])?m=a:m=[a]}let g=[],_=[],y=[];const M=[],x=[];for(const j of m){let $=await Promise.all(j.map(H=>this.preprocess(H)));M.push(...$.map(H=>H.original_size)),x.push(...$.map(H=>H.reshaped_input_size)),$.forEach(H=>H.pixel_values.unsqueeze_(0));const{longest_edge:U}=this.max_image_size;let G;if(u??this.do_image_splitting){let H=new Array($.length),X=new Array($.length);G=await Promise.all($.map(async(ee,ae)=>{const de=this.get_resize_for_vision_encoder(ee.pixel_values,U),ye=await(0,i.interpolate_4d)(ee.pixel_values,{size:[de.height,de.width]}),{frames:_e,num_splits_h:ue,num_splits_w:fe}=await this.split_image(ye,this.max_image_size);return H[ae]=ue,X[ae]=fe,(0,i.cat)(_e,0)})),_.push(H),y.push(X)}else{const H=[U,U];G=await Promise.all($.map(X=>(0,i.interpolate_4d)(X.pixel_values,{size:H}))),_.push(new Array($.length).fill(0)),y.push(new Array($.length).fill(0))}g.push((0,i.cat)(G,0))}const E=g.length,[T,P,C,D]=g[0].dims;let L,N;if(E===1)L=g[0].unsqueeze_(0),N=(0,i.full)([E,T,C,D],!0);else{const j=Math.max(...g.map(G=>G.dims.at(0)));N=(0,i.full)([E,j,C,D],!0);const $=N.data,U=j*C*D;for(let G=0;G<E;++G){const H=g[G].dims[0];if(H<j){g[G]=(0,i.cat)([g[G],(0,i.full)([j-H,P,C,D],0)],0);const X=G*U+H*C*D,ee=(G+1)*U;$.fill(!1,X,ee)}}L=(0,i.stack)(g,0)}return{pixel_values:L,pixel_attention_mask:N,original_sizes:M,reshaped_input_sizes:x,...d?{rows:_,cols:y}:{}}}async split_image(a,{longest_edge:u}){const d=u,m=u,g=[],[_,y]=a.dims.slice(-2);let M=0,x=0;if(_>d||y>m){M=Math.ceil(_/d),x=Math.ceil(y/m);const E=Math.ceil(_/M),T=Math.ceil(y/x);for(let D=0;D<M;++D)for(let L=0;L<x;++L){let N,j,$,U;D===M-1?(j=_-E,U=_):(j=D*E,U=(D+1)*E),L===x-1?(N=y-T,$=y):(N=L*T,$=(L+1)*T);const G=[j,N],H=[U,$],X=await(0,i.slice)(a,G,H,[2,3]);g.push(X)}const P=d,C=m;(_!==P||y!==C)&&(a=await(0,i.interpolate_4d)(a,{size:[P,C]}))}return g.push(a),{frames:g,num_splits_h:M,num_splits_w:x}}}},"./src/models/idefics3/processing_idefics3.js":(e,t,r)=>{r.r(t),r.d(t,{Idefics3Processor:()=>m});var n=r("./src/base/processing_utils.js"),i=r("./src/models/auto/image_processing_auto.js"),o=r("./src/tokenizers.js");r("./src/utils/image.js");var s=r("./src/utils/core.js");function a(g,_,y,M,x,E){let T="";for(let P=0;P<_;++P){for(let C=0;C<y;++C)T+=M+`<row_${P+1}_col_${C+1}>`+x.repeat(g);T+=`
`}return T+=`
${M}${E}`+x.repeat(g)+`${M}`,T}function u(g,_,y,M){return`${_}${M}`+y.repeat(g)+`${_}`}function d(g,_,y,M,x,E){return g===0&&_===0?u(y,M,x,E):a(y,g,_,M,x,E)}class m extends n.Processor{constructor(){super(...arguments);_t(this,"fake_image_token","<fake_token_around_image>");_t(this,"image_token","<image>");_t(this,"global_img_token","<global-img>")}async _call(y,M=null,x={}){x.return_row_col_info??(x.return_row_col_info=!0);let E;M&&(E=await this.image_processor(M,x)),Array.isArray(y)||(y=[y]);const T=E.rows??[new Array(y.length).fill(0)],P=E.cols??[new Array(y.length).fill(0)],C=this.config.image_seq_len,D=[],L=[];for(let j=0;j<y.length;++j){const $=y[j],U=T[j],G=P[j];D.push((0,s.count)($,this.image_token));const H=U.map((ae,de)=>d(ae,G[de],C,this.fake_image_token,this.image_token,this.global_img_token)),X=$.split(this.image_token);if(X.length===0)throw new Error("The image token should be present in the text.");let ee=X[0];for(let ae=0;ae<H.length;++ae)ee+=H[ae]+X[ae+1];L.push(ee)}return{...this.tokenizer(L),...E}}}_t(m,"image_processor_class",i.AutoImageProcessor),_t(m,"tokenizer_class",o.AutoTokenizer),_t(m,"uses_processor_config",!0)},"./src/models/image_processors.js":(e,t,r)=>{r.r(t),r.d(t,{BeitFeatureExtractor:()=>n.BeitFeatureExtractor,BitImageProcessor:()=>i.BitImageProcessor,CLIPFeatureExtractor:()=>s.CLIPFeatureExtractor,CLIPImageProcessor:()=>s.CLIPImageProcessor,ChineseCLIPFeatureExtractor:()=>o.ChineseCLIPFeatureExtractor,ConvNextFeatureExtractor:()=>a.ConvNextFeatureExtractor,ConvNextImageProcessor:()=>a.ConvNextImageProcessor,DINOv3ViTImageProcessor:()=>m.DINOv3ViTImageProcessor,DPTFeatureExtractor:()=>_.DPTFeatureExtractor,DPTImageProcessor:()=>_.DPTImageProcessor,DeiTFeatureExtractor:()=>u.DeiTFeatureExtractor,DeiTImageProcessor:()=>u.DeiTImageProcessor,DetrFeatureExtractor:()=>d.DetrFeatureExtractor,DetrImageProcessor:()=>d.DetrImageProcessor,DonutFeatureExtractor:()=>g.DonutFeatureExtractor,DonutImageProcessor:()=>g.DonutImageProcessor,EfficientNetImageProcessor:()=>y.EfficientNetImageProcessor,GLPNFeatureExtractor:()=>M.GLPNFeatureExtractor,GroundingDinoImageProcessor:()=>x.GroundingDinoImageProcessor,Idefics3ImageProcessor:()=>E.Idefics3ImageProcessor,JinaCLIPImageProcessor:()=>P.JinaCLIPImageProcessor,LlavaOnevisionImageProcessor:()=>C.LlavaOnevisionImageProcessor,Mask2FormerImageProcessor:()=>D.Mask2FormerImageProcessor,MaskFormerFeatureExtractor:()=>L.MaskFormerFeatureExtractor,MaskFormerImageProcessor:()=>L.MaskFormerImageProcessor,MobileNetV1FeatureExtractor:()=>N.MobileNetV1FeatureExtractor,MobileNetV1ImageProcessor:()=>N.MobileNetV1ImageProcessor,MobileNetV2FeatureExtractor:()=>j.MobileNetV2FeatureExtractor,MobileNetV2ImageProcessor:()=>j.MobileNetV2ImageProcessor,MobileNetV3FeatureExtractor:()=>$.MobileNetV3FeatureExtractor,MobileNetV3ImageProcessor:()=>$.MobileNetV3ImageProcessor,MobileNetV4FeatureExtractor:()=>U.MobileNetV4FeatureExtractor,MobileNetV4ImageProcessor:()=>U.MobileNetV4ImageProcessor,MobileViTFeatureExtractor:()=>G.MobileViTFeatureExtractor,MobileViTImageProcessor:()=>G.MobileViTImageProcessor,NougatImageProcessor:()=>H.NougatImageProcessor,OwlViTFeatureExtractor:()=>ee.OwlViTFeatureExtractor,OwlViTImageProcessor:()=>ee.OwlViTImageProcessor,Owlv2ImageProcessor:()=>X.Owlv2ImageProcessor,Phi3VImageProcessor:()=>ae.Phi3VImageProcessor,PvtImageProcessor:()=>de.PvtImageProcessor,Qwen2VLImageProcessor:()=>ye.Qwen2VLImageProcessor,RTDetrImageProcessor:()=>_e.RTDetrImageProcessor,SamImageProcessor:()=>ue.SamImageProcessor,SegformerFeatureExtractor:()=>fe.SegformerFeatureExtractor,SegformerImageProcessor:()=>fe.SegformerImageProcessor,SiglipImageProcessor:()=>De.SiglipImageProcessor,SmolVLMImageProcessor:()=>pe.SmolVLMImageProcessor,Swin2SRImageProcessor:()=>K.Swin2SRImageProcessor,VLMImageProcessor:()=>T.VLMImageProcessor,ViTFeatureExtractor:()=>te.ViTFeatureExtractor,ViTImageProcessor:()=>te.ViTImageProcessor,VitMatteImageProcessor:()=>ve.VitMatteImageProcessor,VitPoseImageProcessor:()=>$e.VitPoseImageProcessor,YolosFeatureExtractor:()=>Ce.YolosFeatureExtractor,YolosImageProcessor:()=>Ce.YolosImageProcessor});var n=r("./src/models/beit/image_processing_beit.js"),i=r("./src/models/bit/image_processing_bit.js"),o=r("./src/models/chinese_clip/image_processing_chinese_clip.js"),s=r("./src/models/clip/image_processing_clip.js"),a=r("./src/models/convnext/image_processing_convnext.js"),u=r("./src/models/deit/image_processing_deit.js"),d=r("./src/models/detr/image_processing_detr.js"),m=r("./src/models/dinov3_vit/image_processing_dinov3_vit.js"),g=r("./src/models/donut/image_processing_donut.js"),_=r("./src/models/dpt/image_processing_dpt.js"),y=r("./src/models/efficientnet/image_processing_efficientnet.js"),M=r("./src/models/glpn/image_processing_glpn.js"),x=r("./src/models/grounding_dino/image_processing_grounding_dino.js"),E=r("./src/models/idefics3/image_processing_idefics3.js"),T=r("./src/models/janus/image_processing_janus.js"),P=r("./src/models/jina_clip/image_processing_jina_clip.js"),C=r("./src/models/llava_onevision/image_processing_llava_onevision.js"),D=r("./src/models/mask2former/image_processing_mask2former.js"),L=r("./src/models/maskformer/image_processing_maskformer.js"),N=r("./src/models/mobilenet_v1/image_processing_mobilenet_v1.js"),j=r("./src/models/mobilenet_v2/image_processing_mobilenet_v2.js"),$=r("./src/models/mobilenet_v3/image_processing_mobilenet_v3.js"),U=r("./src/models/mobilenet_v4/image_processing_mobilenet_v4.js"),G=r("./src/models/mobilevit/image_processing_mobilevit.js"),H=r("./src/models/nougat/image_processing_nougat.js"),X=r("./src/models/owlv2/image_processing_owlv2.js"),ee=r("./src/models/owlvit/image_processing_owlvit.js"),ae=r("./src/models/phi3_v/image_processing_phi3_v.js"),de=r("./src/models/pvt/image_processing_pvt.js"),ye=r("./src/models/qwen2_vl/image_processing_qwen2_vl.js"),_e=r("./src/models/rt_detr/image_processing_rt_detr.js"),ue=r("./src/models/sam/image_processing_sam.js"),fe=r("./src/models/segformer/image_processing_segformer.js"),De=r("./src/models/siglip/image_processing_siglip.js"),pe=r("./src/models/smolvlm/image_processing_smolvlm.js"),K=r("./src/models/swin2sr/image_processing_swin2sr.js"),te=r("./src/models/vit/image_processing_vit.js"),ve=r("./src/models/vitmatte/image_processing_vitmatte.js"),$e=r("./src/models/vitpose/image_processing_vitpose.js"),Ce=r("./src/models/yolos/image_processing_yolos.js")},"./src/models/janus/image_processing_janus.js":(e,t,r)=>{r.r(t),r.d(t,{VLMImageProcessor:()=>i});var n=r("./src/base/image_processors_utils.js");class i extends n.ImageProcessor{constructor(s){super({do_pad:!0,pad_size:{width:s.image_size,height:s.image_size},...s}),this.constant_values=this.config.background_color.map(a=>a*this.rescale_factor)}pad_image(s,a,u,d){return super.pad_image(s,a,u,{constant_values:this.constant_values,center:!0,...d})}}},"./src/models/janus/processing_janus.js":(e,t,r)=>{r.r(t),r.d(t,{VLChatProcessor:()=>d});var n=r("./src/base/processing_utils.js"),i=r("./src/models/auto/image_processing_auto.js"),o=r("./src/tokenizers.js"),s=r("./src/utils/core.js"),a=r("./src/utils/tensor.js"),u=r("./src/utils/image.js");class d extends n.Processor{constructor(g,_,y){super(g,_,y),this.image_tag=this.config.image_tag,this.image_start_tag=this.config.image_start_tag,this.image_end_tag=this.config.image_end_tag,this.num_image_tokens=this.config.num_image_tokens}async _call(g,{images:_=null,chat_template:y="default"}={}){_?Array.isArray(_)||(_=[_]):_=await Promise.all(g.filter(G=>G.images).flatMap(G=>G.images).map(G=>u.RawImage.read(G)));const M=this.tokenizer,x=M.apply_chat_template(g,{tokenize:!1,add_generation_prompt:!0,chat_template:y}),E=G=>M.encode(G,{add_special_tokens:!1}),T=x.split(this.image_tag),P=T.length-1;if(_.length!==P)throw new Error(`Number of images provided (${_.length}) does not match number of "${this.image_tag}" image tags (${P})`);const[C,D,L]=M.model.convert_tokens_to_ids([this.image_tag,this.image_start_tag,this.image_end_tag]);let N=E(T[0]),j=new Array(N.length).fill(!1);for(let G=1;G<T.length;++G){const H=new Array(this.num_image_tokens).fill(C),X=E(T[G]);N=(0,s.mergeArrays)(N,[D],H,[L],X);const ee=new Array(this.num_image_tokens).fill(!0);j=(0,s.mergeArrays)(j,[!1],ee,[!1],new Array(X.length).fill(!1))}const $=[1,N.length],U={input_ids:new a.Tensor("int64",N,$),attention_mask:new a.Tensor("int64",new Array(N.length).fill(1),$),images_seq_mask:new a.Tensor("bool",j,$),images_emb_mask:new a.Tensor("bool",new Array(P*this.num_image_tokens).fill(!0),[1,P,this.num_image_tokens])};if(_&&_.length>0){const G=await this.image_processor(_);return G.pixel_values.unsqueeze_(0),{...U,...G}}return U}}_t(d,"image_processor_class",i.AutoImageProcessor),_t(d,"tokenizer_class",o.AutoTokenizer),_t(d,"uses_processor_config",!0)},"./src/models/jina_clip/image_processing_jina_clip.js":(e,t,r)=>{r.r(t),r.d(t,{JinaCLIPImageProcessor:()=>i});var n=r("./src/base/image_processors_utils.js");class i extends n.ImageProcessor{constructor(s){const{resize_mode:a,fill_color:u,interpolation:d,size:m,...g}=s,_=a==="squash"?{width:m,height:m}:a==="shortest"?{shortest_edge:m}:{longest_edge:m},y=d==="bicubic"?3:2;super({...g,size:_,resample:y,do_center_crop:!0,crop_size:m,do_normalize:!0})}}},"./src/models/jina_clip/processing_jina_clip.js":(e,t,r)=>{r.r(t),r.d(t,{JinaCLIPProcessor:()=>s});var n=r("./src/base/processing_utils.js"),i=r("./src/models/auto/image_processing_auto.js"),o=r("./src/tokenizers.js");class s extends n.Processor{async _call(u=null,d=null,m={}){if(!u&&!d)throw new Error("Either text or images must be provided");const g=u?this.tokenizer(u,m):{},_=d?await this.image_processor(d,m):{};return{...g,..._}}}_t(s,"tokenizer_class",o.AutoTokenizer),_t(s,"image_processor_class",i.AutoImageProcessor)},"./src/models/llava/processing_llava.js":(e,t,r)=>{r.r(t),r.d(t,{LlavaProcessor:()=>s});var n=r("./src/base/processing_utils.js"),i=r("./src/models/auto/image_processing_auto.js"),o=r("./src/tokenizers.js");class s extends n.Processor{async _call(u,d=null,m={}){const g=await this.image_processor(u,m);if(d){const[y,M]=g.pixel_values.dims.slice(-2),{image_token:x,patch_size:E,num_additional_image_tokens:T}=this.config,P=Math.floor(y/E)*Math.floor(M/E)+T;d=structuredClone(d),Array.isArray(d)||(d=[d]);for(let C=0;C<d.length;++C)d[C]=d[C].replace(x,x.repeat(P))}const _=d?this.tokenizer(d,m):{};return{...g,..._}}}_t(s,"tokenizer_class",o.AutoTokenizer),_t(s,"image_processor_class",i.AutoImageProcessor),_t(s,"uses_processor_config",!0)},"./src/models/llava_onevision/image_processing_llava_onevision.js":(e,t,r)=>{r.r(t),r.d(t,{LlavaOnevisionImageProcessor:()=>i});var n=r("./src/base/image_processors_utils.js");class i extends n.ImageProcessor{}},"./src/models/mask2former/image_processing_mask2former.js":(e,t,r)=>{r.r(t),r.d(t,{Mask2FormerImageProcessor:()=>i});var n=r("./src/models/maskformer/image_processing_maskformer.js");class i extends n.MaskFormerImageProcessor{}},"./src/models/maskformer/image_processing_maskformer.js":(e,t,r)=>{r.r(t),r.d(t,{MaskFormerFeatureExtractor:()=>o,MaskFormerImageProcessor:()=>i});var n=r("./src/base/image_processors_utils.js");class i extends n.ImageProcessor{post_process_panoptic_segmentation(...a){return(0,n.post_process_panoptic_segmentation)(...a)}post_process_instance_segmentation(...a){return(0,n.post_process_instance_segmentation)(...a)}}class o extends i{}},"./src/models/mgp_str/processing_mgp_str.js":(e,t,r)=>{r.r(t),r.d(t,{MgpstrProcessor:()=>u});var n=r("./src/base/processing_utils.js"),i=r("./src/models/auto/image_processing_auto.js"),o=r("./src/tokenizers.js"),s=r("./src/utils/maths.js");const a={char:["char_decode",1],bpe:["bpe_decode",2],wp:["wp_decode",102]};class u extends n.Processor{get char_tokenizer(){return this.components.char_tokenizer}get bpe_tokenizer(){return this.components.bpe_tokenizer}get wp_tokenizer(){return this.components.wp_tokenizer}_decode_helper(m,g){if(!a.hasOwnProperty(g))throw new Error(`Format ${g} is not supported.`);const[_,y]=a[g],M=this[_].bind(this),[x,E]=m.dims,T=[],P=[],C=m.tolist();for(let L=0;L<x;++L){const N=C[L],j=[],$=[];for(let G=1;G<E;++G){const[H,X]=(0,s.max)((0,s.softmax)(N[G]));if($.push(H),X==y)break;j.push(X)}const U=$.length>0?$.reduce((G,H)=>G*H,1):0;P.push(j),T.push(U)}return[M(P),T]}char_decode(m){return this.char_tokenizer.batch_decode(m).map(g=>g.replaceAll(" ",""))}bpe_decode(m){return this.bpe_tokenizer.batch_decode(m)}wp_decode(m){return this.wp_tokenizer.batch_decode(m).map(g=>g.replaceAll(" ",""))}batch_decode([m,g,_]){const[y,M]=this._decode_helper(m,"char"),[x,E]=this._decode_helper(g,"bpe"),[T,P]=this._decode_helper(_,"wp"),C=[],D=[];for(let L=0;L<y.length;++L){const[N,j]=(0,s.max)([M[L],E[L],P[L]]);C.push([y[L],x[L],T[L]][j]),D.push(N)}return{generated_text:C,scores:D,char_preds:y,bpe_preds:x,wp_preds:T}}static async from_pretrained(...m){const g=await super.from_pretrained(...m),_=await o.AutoTokenizer.from_pretrained("Xenova/gpt2"),y=await o.AutoTokenizer.from_pretrained("Xenova/bert-base-uncased");return g.components={image_processor:g.image_processor,char_tokenizer:g.tokenizer,bpe_tokenizer:_,wp_tokenizer:y},g}async _call(m,g=null){const _=await this.image_processor(m);return g&&(_.labels=this.tokenizer(g).input_ids),_}}_t(u,"tokenizer_class",o.AutoTokenizer),_t(u,"image_processor_class",i.AutoImageProcessor)},"./src/models/mobilenet_v1/image_processing_mobilenet_v1.js":(e,t,r)=>{r.r(t),r.d(t,{MobileNetV1FeatureExtractor:()=>o,MobileNetV1ImageProcessor:()=>i});var n=r("./src/base/image_processors_utils.js");class i extends n.ImageProcessor{}class o extends i{}},"./src/models/mobilenet_v2/image_processing_mobilenet_v2.js":(e,t,r)=>{r.r(t),r.d(t,{MobileNetV2FeatureExtractor:()=>o,MobileNetV2ImageProcessor:()=>i});var n=r("./src/base/image_processors_utils.js");class i extends n.ImageProcessor{}class o extends i{}},"./src/models/mobilenet_v3/image_processing_mobilenet_v3.js":(e,t,r)=>{r.r(t),r.d(t,{MobileNetV3FeatureExtractor:()=>o,MobileNetV3ImageProcessor:()=>i});var n=r("./src/base/image_processors_utils.js");class i extends n.ImageProcessor{}class o extends i{}},"./src/models/mobilenet_v4/image_processing_mobilenet_v4.js":(e,t,r)=>{r.r(t),r.d(t,{MobileNetV4FeatureExtractor:()=>o,MobileNetV4ImageProcessor:()=>i});var n=r("./src/base/image_processors_utils.js");class i extends n.ImageProcessor{}class o extends i{}},"./src/models/mobilevit/image_processing_mobilevit.js":(e,t,r)=>{r.r(t),r.d(t,{MobileViTFeatureExtractor:()=>o,MobileViTImageProcessor:()=>i});var n=r("./src/base/image_processors_utils.js");class i extends n.ImageProcessor{}class o extends i{}},"./src/models/moonshine/feature_extraction_moonshine.js":(e,t,r)=>{r.r(t),r.d(t,{MoonshineFeatureExtractor:()=>o});var n=r("./src/base/feature_extraction_utils.js"),i=r("./src/utils/tensor.js");class o extends n.FeatureExtractor{async _call(a){(0,n.validate_audio_inputs)(a,"MoonshineFeatureExtractor"),a instanceof Float64Array&&(a=new Float32Array(a));const u=[1,a.length];return{input_values:new i.Tensor("float32",a,u)}}}},"./src/models/moonshine/processing_moonshine.js":(e,t,r)=>{r.r(t),r.d(t,{MoonshineProcessor:()=>s});var n=r("./src/models/auto/feature_extraction_auto.js"),i=r("./src/tokenizers.js"),o=r("./src/base/processing_utils.js");class s extends o.Processor{async _call(u){return await this.feature_extractor(u)}}_t(s,"tokenizer_class",i.AutoTokenizer),_t(s,"feature_extractor_class",n.AutoFeatureExtractor)},"./src/models/nougat/image_processing_nougat.js":(e,t,r)=>{r.r(t),r.d(t,{NougatImageProcessor:()=>i});var n=r("./src/models/donut/image_processing_donut.js");class i extends n.DonutImageProcessor{}},"./src/models/owlv2/image_processing_owlv2.js":(e,t,r)=>{r.r(t),r.d(t,{Owlv2ImageProcessor:()=>i});var n=r("./src/models/owlvit/image_processing_owlvit.js");class i extends n.OwlViTImageProcessor{}},"./src/models/owlvit/image_processing_owlvit.js":(e,t,r)=>{r.r(t),r.d(t,{OwlViTFeatureExtractor:()=>o,OwlViTImageProcessor:()=>i});var n=r("./src/base/image_processors_utils.js");class i extends n.ImageProcessor{post_process_object_detection(...a){return(0,n.post_process_object_detection)(...a)}}class o extends i{}},"./src/models/owlvit/processing_owlvit.js":(e,t,r)=>{r.r(t),r.d(t,{OwlViTProcessor:()=>s});var n=r("./src/base/processing_utils.js"),i=r("./src/models/auto/image_processing_auto.js"),o=r("./src/tokenizers.js");class s extends n.Processor{}_t(s,"tokenizer_class",o.AutoTokenizer),_t(s,"image_processor_class",i.AutoImageProcessor)},"./src/models/paligemma/processing_paligemma.js":(e,t,r)=>{r.r(t),r.d(t,{PaliGemmaProcessor:()=>u});var n=r("./src/base/processing_utils.js"),i=r("./src/models/auto/image_processing_auto.js"),o=r("./src/tokenizers.js");const s="<image>";function a(d,m,g,_,y){return`${_.repeat(g*y)}${m}${d}
`}class u extends n.Processor{async _call(m,g=null,_={}){g||(console.warn("You are using PaliGemma without a text prefix. It will perform as a picture-captioning model."),g=""),Array.isArray(m)||(m=[m]),Array.isArray(g)||(g=[g]);const y=this.tokenizer.bos_token,M=this.image_processor.config.image_seq_length;let x;g.some(P=>P.includes(s))?x=g.map(P=>{const C=P.replaceAll(s,s.repeat(M)),D=C.lastIndexOf(s),L=D===-1?0:D+s.length;return C.slice(0,L)+y+C.slice(L)+`
`}):(console.warn("You are passing both `text` and `images` to `PaliGemmaProcessor`. The processor expects special image tokens in the text, as many tokens as there are images per each text. It is recommended to add `<image>` tokens in the very beginning of your text. For this call, we will infer how many images each text has and add special tokens."),x=g.map(P=>a(P,y,M,s,m.length)));const E=this.tokenizer(x,_);return{...await this.image_processor(m,_),...E}}}_t(u,"tokenizer_class",o.AutoTokenizer),_t(u,"image_processor_class",i.AutoImageProcessor),_t(u,"uses_processor_config",!1)},"./src/models/phi3_v/image_processing_phi3_v.js":(e,t,r)=>{r.r(t),r.d(t,{Phi3VImageProcessor:()=>m});var n=r("./src/base/image_processors_utils.js"),i=r("./src/utils/tensor.js");const o=336,s=[2,3],{ceil:a,floor:u,sqrt:d}=Math;class m extends n.ImageProcessor{constructor(_){super({..._,do_normalize:!0,do_pad:!0,pad_size:"custom",do_convert_rgb:!0,do_resize:!0}),this._num_crops=_.num_crops}calc_num_image_tokens_from_image_size(_,y){const{num_img_tokens:M}=this.config;return u((u(y/o)*u(_/o)+1)*M+1+(u(y/o)+1)*d(M))}get_resize_output_image_size(_,y){const M=this._num_crops,[x,E]=_.size;let T=x/E,P=1;for(;P*Math.ceil(P/T)<=M;)P+=1;P-=1;const C=Math.floor(P*336),D=Math.floor(C/T);return[C,D]}pad_image(_,y,M,x={}){const[E,T]=y,P=o*a(E/o),C=o*a(T/o),D=[1,1,1].map((L,N)=>(L-this.image_mean[N])/this.image_std[N]);return super.pad_image(_,y,{width:C,height:P},{center:!0,constant_values:D,...x})}async _call(_,{num_crops:y=null}={}){if(this._num_crops=y??(y=this.config.num_crops),y<4||d(y)%1!==0)throw new Error("num_crops must be a square number >= 4");Array.isArray(_)||(_=[_]);const M=_.length,x=await Promise.all(_.map(j=>this.preprocess(j))),E=x.map(j=>j.original_size),T=x.map(j=>j.reshaped_input_size),P=[];for(const{pixel_values:j}of x){j.unsqueeze_(0);const[$,U]=j.dims.slice(-2),G=await(0,i.interpolate_4d)(j,{size:[o,o],mode:"bicubic"});if(y>0){const H=[],X=d(y),ee=u(U/X),ae=u($/X);for(let ye=0;ye<X;++ye)for(let _e=0;_e<X;++_e){let ue,fe,De,pe;ye===X-1?(fe=$-ae,pe=$):(fe=ye*ae,pe=(ye+1)*ae),_e===X-1?(ue=U-ee,De=U):(ue=_e*ee,De=(_e+1)*ee);const K=[fe,ue],te=[pe,De],ve=await(0,i.slice)(j,K,te,s);H.push(ve)}const de=await(0,i.interpolate_4d)((0,i.cat)(H,0),{size:[o,o],mode:"bicubic"});P.push((0,i.cat)([G,de],0))}else P.push(G)}const C=(0,i.stack)(P,0),D=T.map(j=>j.map($=>o*a($/o))),L=new i.Tensor("int64",D.flat(),[M,2]),N=D.map(([j,$])=>this.calc_num_image_tokens_from_image_size($,j));return{pixel_values:C,original_sizes:E,reshaped_input_sizes:T,image_sizes:L,num_img_tokens:N}}}},"./src/models/phi3_v/processing_phi3_v.js":(e,t,r)=>{r.r(t),r.d(t,{Phi3VProcessor:()=>u});var n=r("./src/base/processing_utils.js"),i=r("./src/models/auto/image_processing_auto.js"),o=r("./src/tokenizers.js");r("./src/utils/image.js");const s="<|image|>",a=/<\|image_\d+\|>/g;class u extends n.Processor{async _call(m,g=null,{padding:_=!0,truncation:y=!0,num_crops:M=null}={}){Array.isArray(m)||(m=[m]);let x,E;if(g){E=await this.image_processor(g,{num_crops:M});const{num_img_tokens:T}=E,P=m.map((D,L)=>D.split(a).join(s.repeat(T[L])));x=this.tokenizer(P,{padding:_,truncation:y});const C=this.tokenizer.model.convert_tokens_to_ids([s])[0];x.input_ids.map_(D=>D==C?-D:D)}else x=this.tokenizer(m);return{...x,...E}}}_t(u,"image_processor_class",i.AutoImageProcessor),_t(u,"tokenizer_class",o.AutoTokenizer)},"./src/models/processors.js":(e,t,r)=>{r.r(t),r.d(t,{Florence2Processor:()=>n.Florence2Processor,Gemma3nProcessor:()=>i.Gemma3nProcessor,GroundingDinoProcessor:()=>o.GroundingDinoProcessor,Idefics3Processor:()=>s.Idefics3Processor,JinaCLIPProcessor:()=>u.JinaCLIPProcessor,LlavaProcessor:()=>d.LlavaProcessor,MgpstrProcessor:()=>m.MgpstrProcessor,MoonshineProcessor:()=>g.MoonshineProcessor,OwlViTProcessor:()=>_.OwlViTProcessor,PaliGemmaProcessor:()=>M.PaliGemmaProcessor,Phi3VProcessor:()=>y.Phi3VProcessor,PyAnnoteProcessor:()=>x.PyAnnoteProcessor,Qwen2VLProcessor:()=>E.Qwen2VLProcessor,SamProcessor:()=>T.SamProcessor,SmolVLMProcessor:()=>P.SmolVLMProcessor,SpeechT5Processor:()=>C.SpeechT5Processor,UltravoxProcessor:()=>D.UltravoxProcessor,VLChatProcessor:()=>a.VLChatProcessor,VoxtralProcessor:()=>L.VoxtralProcessor,Wav2Vec2Processor:()=>N.Wav2Vec2Processor,Wav2Vec2ProcessorWithLM:()=>j.Wav2Vec2ProcessorWithLM,WhisperProcessor:()=>$.WhisperProcessor});var n=r("./src/models/florence2/processing_florence2.js"),i=r("./src/models/gemma3n/processing_gemma3n.js"),o=r("./src/models/grounding_dino/processing_grounding_dino.js"),s=r("./src/models/idefics3/processing_idefics3.js"),a=r("./src/models/janus/processing_janus.js"),u=r("./src/models/jina_clip/processing_jina_clip.js"),d=r("./src/models/llava/processing_llava.js"),m=r("./src/models/mgp_str/processing_mgp_str.js"),g=r("./src/models/moonshine/processing_moonshine.js"),_=r("./src/models/owlvit/processing_owlvit.js"),y=r("./src/models/phi3_v/processing_phi3_v.js"),M=r("./src/models/paligemma/processing_paligemma.js"),x=r("./src/models/pyannote/processing_pyannote.js"),E=r("./src/models/qwen2_vl/processing_qwen2_vl.js"),T=r("./src/models/sam/processing_sam.js"),P=r("./src/models/smolvlm/processing_smolvlm.js"),C=r("./src/models/speecht5/processing_speecht5.js"),D=r("./src/models/ultravox/processing_ultravox.js"),L=r("./src/models/voxtral/processing_voxtral.js"),N=r("./src/models/wav2vec2/processing_wav2vec2.js"),j=r("./src/models/wav2vec2_with_lm/processing_wav2vec2_with_lm.js"),$=r("./src/models/whisper/processing_whisper.js")},"./src/models/pvt/image_processing_pvt.js":(e,t,r)=>{r.r(t),r.d(t,{PvtImageProcessor:()=>i});var n=r("./src/base/image_processors_utils.js");class i extends n.ImageProcessor{}},"./src/models/pyannote/feature_extraction_pyannote.js":(e,t,r)=>{r.r(t),r.d(t,{PyAnnoteFeatureExtractor:()=>s});var n=r("./src/base/feature_extraction_utils.js"),i=r("./src/utils/tensor.js"),o=r("./src/utils/maths.js");class s extends n.FeatureExtractor{async _call(u){(0,n.validate_audio_inputs)(u,"PyAnnoteFeatureExtractor"),u instanceof Float64Array&&(u=new Float32Array(u));const d=[1,1,u.length];return{input_values:new i.Tensor("float32",u,d)}}samples_to_frames(u){return(u-this.config.offset)/this.config.step}post_process_speaker_diarization(u,d){const m=d/this.samples_to_frames(d)/this.config.sampling_rate,g=[];for(const _ of u.tolist()){const y=[];let M=-1;for(let x=0;x<_.length;++x){const E=(0,o.softmax)(_[x]),[T,P]=(0,o.max)(E),[C,D]=[x,x+1];P!==M?(M=P,y.push({id:P,start:C,end:D,score:T})):(y.at(-1).end=D,y.at(-1).score+=T)}g.push(y.map(({id:x,start:E,end:T,score:P})=>({id:x,start:E*m,end:T*m,confidence:P/(T-E)})))}return g}}},"./src/models/pyannote/processing_pyannote.js":(e,t,r)=>{r.r(t),r.d(t,{PyAnnoteProcessor:()=>o});var n=r("./src/base/processing_utils.js"),i=r("./src/models/pyannote/feature_extraction_pyannote.js");class o extends n.Processor{async _call(a){return await this.feature_extractor(a)}post_process_speaker_diarization(...a){return this.feature_extractor.post_process_speaker_diarization(...a)}get sampling_rate(){return this.feature_extractor.config.sampling_rate}}_t(o,"feature_extractor_class",i.PyAnnoteFeatureExtractor)},"./src/models/qwen2_vl/image_processing_qwen2_vl.js":(e,t,r)=>{r.r(t),r.d(t,{Qwen2VLImageProcessor:()=>o});var n=r("./src/base/image_processors_utils.js"),i=r("./src/utils/tensor.js");class o extends n.ImageProcessor{async _call(a,...u){const{pixel_values:d,original_sizes:m,reshaped_input_sizes:g}=await super._call(a,...u);let _=d;const{temporal_patch_size:y,merge_size:M,patch_size:x}=this.config;_.dims[0]===1&&(_=(0,i.cat)(Array.from({length:y},()=>_),0));const E=_.dims[0]/y,T=_.dims[1],P=Math.floor(_.dims[2]/x),C=Math.floor(_.dims[3]/x),D=_.view(E,y,T,Math.floor(P/M),M,x,Math.floor(C/M),M,x).permute(0,3,6,4,7,2,1,5,8).view(E*P*C,T*y*x*x),L=new i.Tensor("int64",[E,P,C],[1,3]);return{pixel_values:D,image_grid_thw:L,original_sizes:m,reshaped_input_sizes:g}}}},"./src/models/qwen2_vl/processing_qwen2_vl.js":(e,t,r)=>{r.r(t),r.d(t,{Qwen2VLProcessor:()=>s});var n=r("./src/base/processing_utils.js"),i=r("./src/models/auto/image_processing_auto.js"),o=r("./src/tokenizers.js");r("./src/utils/image.js");class s extends n.Processor{async _call(u,d=null,...m){Array.isArray(u)||(u=[u]);let g,_;if(d&&(g=await this.image_processor(d),_=g.image_grid_thw),_){let M=this.image_processor.config.merge_size**2,x=0;const E=_.tolist();u=u.map(T=>{for(;T.includes("<|image_pad|>");){const P=Number(E[x++].reduce((C,D)=>C*D,1n));T=T.replace("<|image_pad|>","<|placeholder|>".repeat(Math.floor(P/M)))}return T.replaceAll("<|placeholder|>","<|image_pad|>")})}return{...this.tokenizer(u),...g}}}_t(s,"image_processor_class",i.AutoImageProcessor),_t(s,"tokenizer_class",o.AutoTokenizer)},"./src/models/rt_detr/image_processing_rt_detr.js":(e,t,r)=>{r.r(t),r.d(t,{RTDetrImageProcessor:()=>i});var n=r("./src/base/image_processors_utils.js");class i extends n.ImageProcessor{post_process_object_detection(...s){return(0,n.post_process_object_detection)(...s)}}},"./src/models/sam/image_processing_sam.js":(e,t,r)=>{r.r(t),r.d(t,{SamImageProcessor:()=>s});var n=r("./src/base/image_processors_utils.js"),i=r("./src/utils/core.js"),o=r("./src/utils/tensor.js");class s extends n.ImageProcessor{reshape_input_points(u,d,m,g=!1){u=structuredClone(u);let _=(0,i.calculateDimensions)(u);if(_.length===3)g||(_=[1,..._]),u=[u];else if(_.length!==4)throw Error("The input_points must be a 4D tensor of shape `batch_size`, `point_batch_size`, `nb_points_per_image`, `2`.");for(let y=0;y<u.length;++y){let M=d[y],x=m[y],E=[x[0]/M[0],x[1]/M[1]];for(let T=0;T<u[y].length;++T)for(let P=0;P<u[y][T].length;++P)for(let C=0;C<u[y][T][P].length;++C)u[y][T][P][C]*=E[C%2]}return new o.Tensor("float32",Float32Array.from(u.flat(1/0)),_)}add_input_labels(u,d){let m=(0,i.calculateDimensions)(u);if(m.length===2)m=[1,...m],u=[u];else if(m.length!==3)throw Error("The input_points must be a 4D tensor of shape `batch_size`, `point_batch_size`, `nb_points_per_image`, `2`.");if(m.some((g,_)=>g!==d.dims[_]))throw Error(`The first ${m.length} dimensions of 'input_points' and 'input_labels' must be the same.`);return new o.Tensor("int64",u.flat(1/0).map(BigInt),m)}async _call(u,{input_points:d=null,input_labels:m=null,input_boxes:g=null}={}){const _=await super._call(u);if(d&&(_.input_points=this.reshape_input_points(d,_.original_sizes,_.reshaped_input_sizes)),m){if(!_.input_points)throw Error("`input_points` must be provided if `input_labels` are provided.");_.input_labels=this.add_input_labels(m,_.input_points)}return g&&(_.input_boxes=this.reshape_input_points(g,_.original_sizes,_.reshaped_input_sizes,!0)),_}async post_process_masks(u,d,m,{mask_threshold:g=0,binarize:_=!0,pad_size:y=null}={}){const M=[];y=y??this.pad_size;const x=[y.height,y.width];for(let E=0;E<d.length;++E){const T=d[E],P=m[E];let C=await(0,o.interpolate_4d)(u[E],{mode:"bilinear",size:x});if(C=C.slice(null,null,[0,P[0]],[0,P[1]]),C=await(0,o.interpolate_4d)(C,{mode:"bilinear",size:T}),_){const D=C.data,L=new Uint8Array(D.length);for(let N=0;N<D.length;++N)D[N]>g&&(L[N]=1);C=new o.Tensor("bool",L,C.dims)}M.push(C)}return M}generate_crop_boxes(u,d,{crop_n_layers:m=0,overlap_ratio:g=512/1500,points_per_crop:_=32,crop_n_points_downscale_factor:y=1}={}){}}},"./src/models/sam/processing_sam.js":(e,t,r)=>{r.r(t),r.d(t,{SamProcessor:()=>o});var n=r("./src/base/processing_utils.js"),i=r("./src/models/auto/image_processing_auto.js");class o extends n.Processor{async _call(...a){return await this.image_processor(...a)}post_process_masks(...a){return this.image_processor.post_process_masks(...a)}reshape_input_points(...a){return this.image_processor.reshape_input_points(...a)}}_t(o,"image_processor_class",i.AutoImageProcessor)},"./src/models/seamless_m4t/feature_extraction_seamless_m4t.js":(e,t,r)=>{r.r(t),r.d(t,{SeamlessM4TFeatureExtractor:()=>s});var n=r("./src/base/feature_extraction_utils.js"),i=r("./src/utils/tensor.js"),o=r("./src/utils/audio.js");class s extends n.FeatureExtractor{constructor(u){super(u);const d=this.config.sampling_rate,m=(0,o.mel_filter_bank)(257,this.config.num_mel_bins,20,Math.floor(d/2),d,null,"kaldi",!0);this.mel_filters=m,this.window=(0,o.window_function)(400,"povey",{periodic:!1})}async _extract_fbank_features(u,d){return u=u.map(m=>m*32768),(0,o.spectrogram)(u,this.window,400,160,{fft_length:512,power:2,center:!1,preemphasis:.97,mel_filters:this.mel_filters,log_mel:"log",mel_floor:1192092955078125e-22,remove_dc_offset:!0,max_num_frames:d,transpose:!0})}async _call(u,{padding:d=!0,pad_to_multiple_of:m=2,do_normalize_per_mel_bins:g=!0,return_attention_mask:_=!0}={}){(0,n.validate_audio_inputs)(u,"SeamlessM4TFeatureExtractor");let y=await this._extract_fbank_features(u,this.config.max_length);if(g){const[L,N]=y.dims,j=y.data;for(let $=0;$<N;++$){let U=0;for(let ee=0;ee<L;++ee)U+=j[ee*N+$];const G=U/L;let H=0;for(let ee=0;ee<L;++ee)H+=(j[ee*N+$]-G)**2;H/=L-1;const X=Math.sqrt(H+1e-7);for(let ee=0;ee<L;++ee){const ae=ee*N+$;j[ae]=(j[ae]-G)/X}}}let M;if(d){const[L,N]=y.dims,j=y.data,$=L%m;if($>0){const U=new Float32Array(N*(L+$));U.set(j),U.fill(this.config.padding_value,j.length);const G=L+$;y=new i.Tensor(y.type,U,[G,N]),_&&(M=new i.Tensor("int64",new BigInt64Array(G),[1,G]),M.data.fill(1n,0,L))}}const[x,E]=y.dims,T=this.config.stride;if(x%T!==0)throw new Error(`The number of frames (${x}) must be a multiple of the stride (${T}).`);const C=y.view(1,Math.floor(x/T),E*T),D={input_features:C};if(_){const L=C.dims[1],N=new BigInt64Array(L);if(M){const j=M.data;for(let $=1,U=0;$<x;$+=T,++U)N[U]=j[$]}else N.fill(1n);D.attention_mask=new i.Tensor("int64",N,[1,L])}return D}}},"./src/models/segformer/image_processing_segformer.js":(e,t,r)=>{r.r(t),r.d(t,{SegformerFeatureExtractor:()=>o,SegformerImageProcessor:()=>i});var n=r("./src/base/image_processors_utils.js");class i extends n.ImageProcessor{post_process_semantic_segmentation(...a){return(0,n.post_process_semantic_segmentation)(...a)}}class o extends i{}},"./src/models/siglip/image_processing_siglip.js":(e,t,r)=>{r.r(t),r.d(t,{SiglipImageProcessor:()=>i});var n=r("./src/base/image_processors_utils.js");class i extends n.ImageProcessor{}},"./src/models/smolvlm/image_processing_smolvlm.js":(e,t,r)=>{r.r(t),r.d(t,{SmolVLMImageProcessor:()=>n.Idefics3ImageProcessor});var n=r("./src/models/idefics3/image_processing_idefics3.js")},"./src/models/smolvlm/processing_smolvlm.js":(e,t,r)=>{r.r(t),r.d(t,{SmolVLMProcessor:()=>n.Idefics3Processor});var n=r("./src/models/idefics3/processing_idefics3.js")},"./src/models/snac/feature_extraction_snac.js":(e,t,r)=>{r.r(t),r.d(t,{SnacFeatureExtractor:()=>i});var n=r("./src/models/dac/feature_extraction_dac.js");class i extends n.DacFeatureExtractor{}},"./src/models/speecht5/feature_extraction_speecht5.js":(e,t,r)=>{r.r(t),r.d(t,{SpeechT5FeatureExtractor:()=>i});var n=r("./src/base/feature_extraction_utils.js");class i extends n.FeatureExtractor{}},"./src/models/speecht5/processing_speecht5.js":(e,t,r)=>{r.r(t),r.d(t,{SpeechT5Processor:()=>s});var n=r("./src/base/processing_utils.js"),i=r("./src/tokenizers.js"),o=r("./src/models/auto/feature_extraction_auto.js");class s extends n.Processor{async _call(u){return await this.feature_extractor(u)}}_t(s,"tokenizer_class",i.AutoTokenizer),_t(s,"feature_extractor_class",o.AutoFeatureExtractor)},"./src/models/swin2sr/image_processing_swin2sr.js":(e,t,r)=>{r.r(t),r.d(t,{Swin2SRImageProcessor:()=>i});var n=r("./src/base/image_processors_utils.js");class i extends n.ImageProcessor{pad_image(s,a,u,d={}){const[m,g,_]=a;return super.pad_image(s,a,{width:g+(u-g%u)%u,height:m+(u-m%u)%u},{mode:"symmetric",center:!1,constant_values:-1,...d})}}},"./src/models/ultravox/processing_ultravox.js":(e,t,r)=>{r.r(t),r.d(t,{UltravoxProcessor:()=>s});var n=r("./src/models/auto/feature_extraction_auto.js"),i=r("./src/tokenizers.js"),o=r("./src/base/processing_utils.js");class s extends o.Processor{async _call(u,d=null,m={}){if(Array.isArray(u))throw new Error("Batched inputs are not supported yet.");let g={};if(d){const y=d.length,{input_features:M}=await this.feature_extractor(d,{...m,max_length:y}),x=Math.round(y/this.config.encoder_ds_factor+1e-4),E=1+Math.ceil(x/this.config.stack_factor);g.audio_token_len=[E],g.audio_values=M;const T=this.config.audio_placeholder;if(!u.includes(T))throw new Error(`The input text does not contain the image token ${T}.`);u=u.replaceAll(T,T.repeat(E))}return{...this.tokenizer(u,{add_special_tokens:!1,...m}),...g}}}_t(s,"tokenizer_class",i.AutoTokenizer),_t(s,"feature_extractor_class",n.AutoFeatureExtractor),_t(s,"uses_processor_config",!0)},"./src/models/vit/image_processing_vit.js":(e,t,r)=>{r.r(t),r.d(t,{ViTFeatureExtractor:()=>o,ViTImageProcessor:()=>i});var n=r("./src/base/image_processors_utils.js");class i extends n.ImageProcessor{}class o extends i{}},"./src/models/vitmatte/image_processing_vitmatte.js":(e,t,r)=>{r.r(t),r.d(t,{VitMatteImageProcessor:()=>o});var n=r("./src/base/image_processors_utils.js"),i=r("./src/utils/tensor.js");class o extends n.ImageProcessor{async _call(a,u){Array.isArray(a)||(a=[a]),Array.isArray(u)||(u=[u]);const d=await Promise.all(a.map(_=>this.preprocess(_))),m=await Promise.all(u.map(_=>this.preprocess(_,{do_normalize:!1,do_convert_rgb:!1,do_convert_grayscale:!0})));return{pixel_values:(0,i.stack)(d.map((_,y)=>(0,i.cat)([_.pixel_values,m[y].pixel_values],0)),0),original_sizes:d.map(_=>_.original_size),reshaped_input_sizes:d.map(_=>_.reshaped_input_size)}}}},"./src/models/vitpose/image_processing_vitpose.js":(e,t,r)=>{r.r(t),r.d(t,{VitPoseImageProcessor:()=>i});var n=r("./src/base/image_processors_utils.js");class i extends n.ImageProcessor{post_process_pose_estimation(s,a,{threshold:u=null}={}){const d=s.tolist(),[m,g,_,y]=s.dims,M=[];for(let x=0;x<m;++x){const E=d[x],T=a[x],P=[];for(let C=0;C<T.length;++C){const D=T[C],L=[],N=[],j=[],$=D.at(-2)/y,U=D.at(-1)/_;for(let G=0;G<E.length;++G){let[H,X]=[0,0],ee=0,ae=-1/0;const de=E[G];for(let _e=0;_e<de.length;++_e){const ue=de[_e];for(let fe=0;fe<ue.length;++fe){const De=ue[fe];ee+=De,ae=Math.max(ae,De),H+=(fe+.5)*De,X+=_e*De}}if(u!=null&&ae<u)continue;const ye=[$*H/ee,U*X/ee];L.push(ye),j.push(G),N.push(ae)}P.push({bbox:D,scores:N,labels:j,keypoints:L})}M.push(P)}return M}}},"./src/models/voxtral/processing_voxtral.js":(e,t,r)=>{r.r(t),r.d(t,{VoxtralProcessor:()=>g});var n=r("./src/models/auto/feature_extraction_auto.js"),i=r("./src/tokenizers.js"),o=r("./src/base/processing_utils.js"),s=r("./src/utils/tensor.js");const a="[AUDIO]",u="[BEGIN_AUDIO]",d=375;function m(_,y){const M=[];for(let x=0;x<_.length;x+=y)M.push(_.subarray(x,Math.min(x+y,_.length)));return M}class g extends o.Processor{async _call(y,M=null,x={}){if(Array.isArray(y))throw new Error("Batched inputs are not supported yet.");const E={};if(M){if(!y.includes(a))throw new Error(`The input text does not contain the audio token ${a}.`);Array.isArray(M)||(M=[M]);const P=y.split(a),C=P.length-1;if(C!==M.length)throw new Error(`The number of audio inputs (${M.length}) does not match the number of audio tokens in the text (${C}).`);const D=this.feature_extractor.config.n_samples,L=M.map(G=>m(G,D)),N=L.map(G=>G.length),j=L.flat(),$=(await Promise.all(j.map(G=>this.feature_extractor(G,x)))).map(G=>G.input_features);E.audio_values=$.length>1?(0,s.cat)($,0):$[0];let U=P[0];for(let G=0;G<N.length;++G){U+=u;for(let H=0;H<N[G];++H)U+=a.repeat(d);U+=P[G+1]}y=U}return{...this.tokenizer(y,{add_special_tokens:!1,...x}),...E}}}_t(g,"tokenizer_class",i.AutoTokenizer),_t(g,"feature_extractor_class",n.AutoFeatureExtractor),_t(g,"uses_processor_config",!1)},"./src/models/wav2vec2/feature_extraction_wav2vec2.js":(e,t,r)=>{r.r(t),r.d(t,{Wav2Vec2FeatureExtractor:()=>o});var n=r("./src/base/feature_extraction_utils.js"),i=r("./src/utils/tensor.js");class o extends n.FeatureExtractor{_zero_mean_unit_var_norm(a){const d=a.reduce((g,_)=>g+_,0)/a.length,m=a.reduce((g,_)=>g+(_-d)**2,0)/a.length;return a.map(g=>(g-d)/Math.sqrt(m+1e-7))}async _call(a){(0,n.validate_audio_inputs)(a,"Wav2Vec2FeatureExtractor"),a instanceof Float64Array&&(a=new Float32Array(a));let u=a;this.config.do_normalize&&(u=this._zero_mean_unit_var_norm(u));const d=[1,u.length];return{input_values:new i.Tensor("float32",u,d),attention_mask:new i.Tensor("int64",new BigInt64Array(u.length).fill(1n),d)}}}},"./src/models/wav2vec2/processing_wav2vec2.js":(e,t,r)=>{r.r(t),r.d(t,{Wav2Vec2Processor:()=>s});var n=r("./src/tokenizers.js"),i=r("./src/models/auto/feature_extraction_auto.js"),o=r("./src/base/processing_utils.js");class s extends o.Processor{async _call(u){return await this.feature_extractor(u)}}_t(s,"tokenizer_class",n.AutoTokenizer),_t(s,"feature_extractor_class",i.AutoFeatureExtractor)},"./src/models/wav2vec2_with_lm/processing_wav2vec2_with_lm.js":(e,t,r)=>{r.r(t),r.d(t,{Wav2Vec2ProcessorWithLM:()=>s});var n=r("./src/tokenizers.js"),i=r("./src/models/auto/feature_extraction_auto.js"),o=r("./src/base/processing_utils.js");class s extends o.Processor{async _call(u){return await this.feature_extractor(u)}}_t(s,"tokenizer_class",n.AutoTokenizer),_t(s,"feature_extractor_class",i.AutoFeatureExtractor)},"./src/models/wespeaker/feature_extraction_wespeaker.js":(e,t,r)=>{r.r(t),r.d(t,{WeSpeakerFeatureExtractor:()=>o});var n=r("./src/base/feature_extraction_utils.js");r("./src/utils/tensor.js");var i=r("./src/utils/audio.js");class o extends n.FeatureExtractor{constructor(a){super(a);const u=this.config.sampling_rate,d=(0,i.mel_filter_bank)(257,this.config.num_mel_bins,20,Math.floor(u/2),u,null,"kaldi",!0);this.mel_filters=d,this.window=(0,i.window_function)(400,"hamming",{periodic:!1}),this.min_num_frames=this.config.min_num_frames}async _extract_fbank_features(a){return a=a.map(u=>u*32768),(0,i.spectrogram)(a,this.window,400,160,{fft_length:512,power:2,center:!1,preemphasis:.97,mel_filters:this.mel_filters,log_mel:"log",mel_floor:1192092955078125e-22,remove_dc_offset:!0,transpose:!0,min_num_frames:this.min_num_frames})}async _call(a){(0,n.validate_audio_inputs)(a,"WeSpeakerFeatureExtractor");const u=(await this._extract_fbank_features(a)).unsqueeze_(0);if(this.config.fbank_centering_span===null){const d=u.mean(1).data,m=u.data,[g,_,y]=u.dims;for(let M=0;M<g;++M){const x=M*_*y,E=M*y;for(let T=0;T<_;++T){const P=x+T*y;for(let C=0;C<y;++C)m[P+C]-=d[E+C]}}}return{input_features:u}}}},"./src/models/whisper/common_whisper.js":(e,t,r)=>{r.r(t),r.d(t,{WHISPER_LANGUAGE_MAPPING:()=>i,WHISPER_TO_LANGUAGE_CODE_MAPPING:()=>o,whisper_language_to_code:()=>s});const n=[["en","english"],["zh","chinese"],["de","german"],["es","spanish"],["ru","russian"],["ko","korean"],["fr","french"],["ja","japanese"],["pt","portuguese"],["tr","turkish"],["pl","polish"],["ca","catalan"],["nl","dutch"],["ar","arabic"],["sv","swedish"],["it","italian"],["id","indonesian"],["hi","hindi"],["fi","finnish"],["vi","vietnamese"],["he","hebrew"],["uk","ukrainian"],["el","greek"],["ms","malay"],["cs","czech"],["ro","romanian"],["da","danish"],["hu","hungarian"],["ta","tamil"],["no","norwegian"],["th","thai"],["ur","urdu"],["hr","croatian"],["bg","bulgarian"],["lt","lithuanian"],["la","latin"],["mi","maori"],["ml","malayalam"],["cy","welsh"],["sk","slovak"],["te","telugu"],["fa","persian"],["lv","latvian"],["bn","bengali"],["sr","serbian"],["az","azerbaijani"],["sl","slovenian"],["kn","kannada"],["et","estonian"],["mk","macedonian"],["br","breton"],["eu","basque"],["is","icelandic"],["hy","armenian"],["ne","nepali"],["mn","mongolian"],["bs","bosnian"],["kk","kazakh"],["sq","albanian"],["sw","swahili"],["gl","galician"],["mr","marathi"],["pa","punjabi"],["si","sinhala"],["km","khmer"],["sn","shona"],["yo","yoruba"],["so","somali"],["af","afrikaans"],["oc","occitan"],["ka","georgian"],["be","belarusian"],["tg","tajik"],["sd","sindhi"],["gu","gujarati"],["am","amharic"],["yi","yiddish"],["lo","lao"],["uz","uzbek"],["fo","faroese"],["ht","haitian creole"],["ps","pashto"],["tk","turkmen"],["nn","nynorsk"],["mt","maltese"],["sa","sanskrit"],["lb","luxembourgish"],["my","myanmar"],["bo","tibetan"],["tl","tagalog"],["mg","malagasy"],["as","assamese"],["tt","tatar"],["haw","hawaiian"],["ln","lingala"],["ha","hausa"],["ba","bashkir"],["jw","javanese"],["su","sundanese"]],i=new Map(n),o=new Map([...n.map(([a,u])=>[u,a]),["burmese","my"],["valencian","ca"],["flemish","nl"],["haitian","ht"],["letzeburgesch","lb"],["pushto","ps"],["panjabi","pa"],["moldavian","ro"],["moldovan","ro"],["sinhalese","si"],["castilian","es"]]);function s(a){a=a.toLowerCase();let u=o.get(a);if(u===void 0){const d=a.match(/^<\|([a-z]{2})\|>$/);if(d&&(a=d[1]),i.has(a))u=a;else{const g=a.length===2?i.keys():i.values();throw new Error(`Language "${a}" is not supported. Must be one of: ${JSON.stringify(Array.from(g))}`)}}return u}},"./src/models/whisper/feature_extraction_whisper.js":(e,t,r)=>{r.r(t),r.d(t,{WhisperFeatureExtractor:()=>s});var n=r("./src/base/feature_extraction_utils.js");r("./src/utils/tensor.js");var i=r("./src/utils/audio.js"),o=r("./src/utils/maths.js");class s extends n.FeatureExtractor{constructor(u){var d;super(u),(d=this.config).mel_filters??(d.mel_filters=(0,i.mel_filter_bank)(Math.floor(1+this.config.n_fft/2),this.config.feature_size,0,8e3,this.config.sampling_rate,"slaney","slaney")),this.window=(0,i.window_function)(this.config.n_fft,"hann")}async _extract_fbank_features(u){const d=await(0,i.spectrogram)(u,this.window,this.config.n_fft,this.config.hop_length,{power:2,mel_filters:this.config.mel_filters,log_mel:"log10",max_num_frames:Math.min(Math.floor(u.length/this.config.hop_length),this.config.nb_max_frames)}),m=d.data,g=(0,o.max)(m)[0];for(let _=0;_<m.length;++_)m[_]=(Math.max(m[_],g-8)+4)/4;return d}async _call(u,{max_length:d=null}={}){(0,n.validate_audio_inputs)(u,"WhisperFeatureExtractor");let m;const g=d??this.config.n_samples;return u.length>g?(u.length>this.config.n_samples&&console.warn("Attempting to extract features for audio longer than 30 seconds. If using a pipeline to extract transcript from a long audio clip, remember to specify `chunk_length_s` and/or `stride_length_s`."),m=u.slice(0,g)):(m=new Float32Array(g),m.set(u)),{input_features:(await this._extract_fbank_features(m)).unsqueeze_(0)}}}},"./src/models/whisper/generation_whisper.js":(e,t,r)=>{r.r(t),r.d(t,{WhisperGenerationConfig:()=>i});var n=r("./src/generation/configuration_utils.js");class i extends n.GenerationConfig{constructor(){super(...arguments);_t(this,"return_timestamps",null);_t(this,"return_token_timestamps",null);_t(this,"num_frames",null);_t(this,"alignment_heads",null);_t(this,"task",null);_t(this,"language",null);_t(this,"no_timestamps_token_id",null);_t(this,"prompt_ids",null);_t(this,"is_multilingual",null);_t(this,"lang_to_id",null);_t(this,"task_to_id",null);_t(this,"max_initial_timestamp_index",1)}}},"./src/models/whisper/processing_whisper.js":(e,t,r)=>{r.r(t),r.d(t,{WhisperProcessor:()=>s});var n=r("./src/models/auto/feature_extraction_auto.js"),i=r("./src/tokenizers.js"),o=r("./src/base/processing_utils.js");class s extends o.Processor{async _call(u){return await this.feature_extractor(u)}}_t(s,"tokenizer_class",i.AutoTokenizer),_t(s,"feature_extractor_class",n.AutoFeatureExtractor)},"./src/models/yolos/image_processing_yolos.js":(e,t,r)=>{r.r(t),r.d(t,{YolosFeatureExtractor:()=>o,YolosImageProcessor:()=>i});var n=r("./src/base/image_processors_utils.js");class i extends n.ImageProcessor{post_process_object_detection(...a){return(0,n.post_process_object_detection)(...a)}}class o extends i{}},"./src/ops/registry.js":(e,t,r)=>{r.r(t),r.d(t,{TensorOpRegistry:()=>u});var n=r("./src/backends/onnx.js"),i=r("./src/utils/tensor.js"),o=r("./src/env.js");const s=o.apis.IS_BROWSER_ENV||o.apis.IS_WEBWORKER_ENV,a=async(d,m,g)=>{const _=await(0,n.createInferenceSession)(new Uint8Array(d),m);let y=Promise.resolve();return async M=>{const x=(0,n.isONNXProxy)(),E=Object.fromEntries(Object.entries(M).map(([P,C])=>[P,(x?C.clone():C).ort_tensor])),T=await(y=s?y.then(()=>_.run(E)):_.run(E));return Array.isArray(g)?g.map(P=>new i.Tensor(T[P])):new i.Tensor(T[g])}};class u{static get nearest_interpolate_4d(){return this._nearest_interpolate_4d||(this._nearest_interpolate_4d=a([8,10,18,0,58,129,1,10,41,10,1,120,10,0,10,0,10,1,115,18,1,121,34,6,82,101,115,105,122,101,42,18,10,4,109,111,100,101,34,7,110,101,97,114,101,115,116,160,1,3,18,1,114,90,31,10,1,120,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,90,15,10,1,115,18,10,10,8,8,7,18,4,10,2,8,4,98,31,10,1,121,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,66,2,16,21],this.session_options,"y")),this._nearest_interpolate_4d}static get bilinear_interpolate_4d(){return this._bilinear_interpolate_4d||(this._bilinear_interpolate_4d=a([8,9,18,0,58,128,1,10,40,10,1,120,10,0,10,0,10,1,115,18,1,121,34,6,82,101,115,105,122,101,42,17,10,4,109,111,100,101,34,6,108,105,110,101,97,114,160,1,3,18,1,114,90,31,10,1,120,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,90,15,10,1,115,18,10,10,8,8,7,18,4,10,2,8,4,98,31,10,1,121,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,66,2,16,20],this.session_options,"y")),this._bilinear_interpolate_4d}static get bicubic_interpolate_4d(){return this._bicubic_interpolate_4d||(this._bicubic_interpolate_4d=a([8,9,18,0,58,127,10,39,10,1,120,10,0,10,0,10,1,115,18,1,121,34,6,82,101,115,105,122,101,42,16,10,4,109,111,100,101,34,5,99,117,98,105,99,160,1,3,18,1,114,90,31,10,1,120,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,90,15,10,1,115,18,10,10,8,8,7,18,4,10,2,8,4,98,31,10,1,121,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,66,2,16,20],this.session_options,"y")),this._bicubic_interpolate_4d}static get matmul(){return this._matmul||(this._matmul=a([8,9,18,0,58,55,10,17,10,1,97,10,1,98,18,1,99,34,6,77,97,116,77,117,108,18,1,114,90,9,10,1,97,18,4,10,2,8,1,90,9,10,1,98,18,4,10,2,8,1,98,9,10,1,99,18,4,10,2,8,1,66,2,16,20],this.session_options,"c")),this._matmul}static get stft(){return this._stft||(this._stft=a([8,7,18,0,58,148,1,10,38,10,1,115,10,1,106,10,1,119,10,1,108,18,1,111,34,4,83,84,70,84,42,15,10,8,111,110,101,115,105,100,101,100,24,1,160,1,2,18,1,115,90,26,10,1,115,18,21,10,19,8,1,18,15,10,3,18,1,98,10,3,18,1,115,10,3,18,1,99,90,11,10,1,106,18,6,10,4,8,7,18,0,90,16,10,1,119,18,11,10,9,8,1,18,5,10,3,18,1,119,90,11,10,1,108,18,6,10,4,8,7,18,0,98,31,10,1,111,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,102,10,3,18,1,100,10,3,18,1,99,66,2,16,17],this.session_options,"o")),this._stft}static get rfft(){return this._rfft||(this._rfft=a([8,9,18,0,58,97,10,33,10,1,120,10,0,10,1,97,18,1,121,34,3,68,70,84,42,15,10,8,111,110,101,115,105,100,101,100,24,1,160,1,2,18,1,100,90,21,10,1,120,18,16,10,14,8,1,18,10,10,3,18,1,115,10,3,18,1,99,90,11,10,1,97,18,6,10,4,8,7,18,0,98,21,10,1,121,18,16,10,14,8,1,18,10,10,3,18,1,115,10,3,18,1,99,66,2,16,20],this.session_options,"y")),this._rfft}static get top_k(){return this._top_k||(this._top_k=a([8,10,18,0,58,73,10,18,10,1,120,10,1,107,18,1,118,18,1,105,34,4,84,111,112,75,18,1,116,90,9,10,1,120,18,4,10,2,8,1,90,15,10,1,107,18,10,10,8,8,7,18,4,10,2,8,1,98,9,10,1,118,18,4,10,2,8,1,98,9,10,1,105,18,4,10,2,8,7,66,2,16,21],this.session_options,["v","i"])),this._top_k}static get slice(){return this._slice||(this._slice=a([8,7,18,0,58,96,10,25,10,1,120,10,1,115,10,1,101,10,1,97,10,1,116,18,1,121,34,5,83,108,105,99,101,18,1,114,90,9,10,1,120,18,4,10,2,8,1,90,9,10,1,115,18,4,10,2,8,7,90,9,10,1,101,18,4,10,2,8,7,90,9,10,1,97,18,4,10,2,8,7,90,9,10,1,116,18,4,10,2,8,7,98,9,10,1,121,18,4,10,2,8,1,66,2,16,13],this.session_options,"y")),this._slice}}_t(u,"session_options",{})},"./src/pipelines.js":(e,t,r)=>{r.r(t),r.d(t,{AudioClassificationPipeline:()=>X,AutomaticSpeechRecognitionPipeline:()=>ae,BackgroundRemovalPipeline:()=>ue,DepthEstimationPipeline:()=>$e,DocumentQuestionAnsweringPipeline:()=>K,FeatureExtractionPipeline:()=>G,FillMaskPipeline:()=>C,ImageClassificationPipeline:()=>ye,ImageFeatureExtractionPipeline:()=>H,ImageSegmentationPipeline:()=>_e,ImageToImagePipeline:()=>ve,ImageToTextPipeline:()=>de,ObjectDetectionPipeline:()=>De,Pipeline:()=>x,QuestionAnsweringPipeline:()=>P,SummarizationPipeline:()=>L,Text2TextGenerationPipeline:()=>D,TextClassificationPipeline:()=>E,TextGenerationPipeline:()=>$,TextToAudioPipeline:()=>te,TokenClassificationPipeline:()=>T,TranslationPipeline:()=>N,ZeroShotAudioClassificationPipeline:()=>ee,ZeroShotClassificationPipeline:()=>U,ZeroShotImageClassificationPipeline:()=>fe,ZeroShotObjectDetectionPipeline:()=>pe,pipeline:()=>ot});var n=r("./src/tokenizers.js"),i=r("./src/models.js"),o=r("./src/models/auto/processing_auto.js");r("./src/base/processing_utils.js");var s=r("./src/utils/generic.js"),a=r("./src/utils/core.js"),u=r("./src/utils/maths.js"),d=r("./src/utils/audio.js"),m=r("./src/utils/tensor.js"),g=r("./src/utils/image.js");async function _(et){return Array.isArray(et)||(et=[et]),await Promise.all(et.map(Te=>g.RawImage.read(Te)))}async function y(et,Te){return Array.isArray(et)||(et=[et]),await Promise.all(et.map(Le=>typeof Le=="string"||Le instanceof URL?(0,d.read_audio)(Le,Te):Le instanceof Float64Array?new Float32Array(Le):Le))}function M(et,Te){Te&&(et=et.map(Ot=>Ot|0));const[Le,ke,Xe,Ne]=et;return{xmin:Le,ymin:ke,xmax:Xe,ymax:Ne}}class x extends s.Callable{constructor({task:Te,model:Le,tokenizer:ke=null,processor:Xe=null}){super(),this.task=Te,this.model=Le,this.tokenizer=ke,this.processor=Xe}async dispose(){await this.model.dispose()}}class E extends x{constructor(Te){super(Te)}async _call(Te,{top_k:Le=1}={}){const ke=this.tokenizer(Te,{padding:!0,truncation:!0}),Xe=await this.model(ke),Ne=this.model.config.problem_type==="multi_label_classification"?kt=>kt.sigmoid():kt=>new m.Tensor("float32",(0,u.softmax)(kt.data),kt.dims),Ot=this.model.config.id2label,Lt=[];for(const kt of Xe.logits){const mt=Ne(kt),Zt=await(0,m.topk)(mt,Le),Kt=Zt[0].tolist(),Bt=Zt[1].tolist().map((wr,mr)=>({label:Ot?Ot[wr]:`LABEL_${wr}`,score:Kt[mr]}));Le===1?Lt.push(...Bt):Lt.push(Bt)}return Array.isArray(Te)||Le===1?Lt:Lt[0]}}class T extends x{constructor(Te){super(Te)}async _call(Te,{ignore_labels:Le=["O"]}={}){const ke=Array.isArray(Te),Xe=this.tokenizer(ke?Te:[Te],{padding:!0,truncation:!0}),Ot=(await this.model(Xe)).logits,Lt=this.model.config.id2label,kt=[];for(let mt=0;mt<Ot.dims[0];++mt){const Zt=Xe.input_ids[mt],Kt=Ot[mt],dr=[];for(let Bt=0;Bt<Kt.dims[0];++Bt){const wr=Kt[Bt],mr=(0,u.max)(wr.data)[1],hr=Lt?Lt[mr]:`LABEL_${mr}`;if(Le.includes(hr))continue;const xr=this.tokenizer.decode([Zt[Bt].item()],{skip_special_tokens:!0});if(xr==="")continue;const or=(0,u.softmax)(wr.data);dr.push({entity:hr,score:or[mr],index:Bt,word:xr})}kt.push(dr)}return ke?kt:kt[0]}}class P extends x{constructor(Te){super(Te)}async _call(Te,Le,{top_k:ke=1}={}){const Xe=this.tokenizer(Te,{text_pair:Le,padding:!0,truncation:!0}),{start_logits:Ne,end_logits:Ot}=await this.model(Xe),Lt=Xe.input_ids.tolist(),kt=Xe.attention_mask.tolist(),mt=this.tokenizer.all_special_ids,Zt=[];for(let Kt=0;Kt<Ne.dims[0];++Kt){const dr=Lt[Kt],Bt=dr.findIndex(tt=>tt==this.tokenizer.sep_token_id);kt[Kt].map((tt,Se)=>tt==1&&(Se===0||Se>Bt&&mt.findIndex(Pe=>Pe==dr[Se])===-1));const wr=Ne[Kt].tolist(),mr=Ot[Kt].tolist();for(let tt=1;tt<wr.length;++tt)(kt[Kt]==0||tt<=Bt||mt.findIndex(Se=>Se==dr[tt])!==-1)&&(wr[tt]=-1/0,mr[tt]=-1/0);const hr=(0,u.softmax)(wr).map((tt,Se)=>[tt,Se]),xr=(0,u.softmax)(mr).map((tt,Se)=>[tt,Se]);hr[0][0]=0,xr[0][0]=0;const or=(0,a.product)(hr,xr).filter(tt=>tt[0][1]<=tt[1][1]).map(tt=>[tt[0][1],tt[1][1],tt[0][0]*tt[1][0]]).sort((tt,Se)=>Se[2]-tt[2]);for(let tt=0;tt<Math.min(or.length,ke);++tt){const[Se,Pe,Ve]=or[tt],Qe=dr.slice(Se,Pe+1),dt=this.tokenizer.decode(Qe,{skip_special_tokens:!0});Zt.push({answer:dt,score:Ve})}}return ke===1?Zt[0]:Zt}}class C extends x{constructor(Te){super(Te)}async _call(Te,{top_k:Le=5}={}){const ke=this.tokenizer(Te,{padding:!0,truncation:!0}),{logits:Xe}=await this.model(ke),Ne=[],Ot=ke.input_ids.tolist();for(let Lt=0;Lt<Ot.length;++Lt){const kt=Ot[Lt],mt=kt.findIndex(wr=>wr==this.tokenizer.mask_token_id);if(mt===-1)throw Error(`Mask token (${this.tokenizer.mask_token}) not found in text.`);const Zt=Xe[Lt][mt],Kt=await(0,m.topk)(new m.Tensor("float32",(0,u.softmax)(Zt.data),Zt.dims),Le),dr=Kt[0].tolist(),Bt=Kt[1].tolist();Ne.push(Bt.map((wr,mr)=>{const hr=kt.slice();return hr[mt]=wr,{score:dr[mr],token:Number(wr),token_str:this.tokenizer.decode([wr]),sequence:this.tokenizer.decode(hr,{skip_special_tokens:!0})}}))}return Array.isArray(Te)?Ne:Ne[0]}}class D extends x{constructor(Le){super(Le);_t(this,"_key","generated_text")}async _call(Le,ke={}){Array.isArray(Le)||(Le=[Le]),this.model.config.prefix&&(Le=Le.map(mt=>this.model.config.prefix+mt));const Xe=this.model.config.task_specific_params;Xe&&Xe[this.task]&&Xe[this.task].prefix&&(Le=Le.map(mt=>Xe[this.task].prefix+mt));const Ne=this.tokenizer,Ot={padding:!0,truncation:!0};let Lt;this instanceof N&&"_build_translation_inputs"in Ne?Lt=Ne._build_translation_inputs(Le,Ot,ke):Lt=Ne(Le,Ot);const kt=await this.model.generate({...Lt,...ke});return Ne.batch_decode(kt,{skip_special_tokens:!0}).map(mt=>({[this._key]:mt}))}}class L extends D{constructor(Le){super(Le);_t(this,"_key","summary_text")}}class N extends D{constructor(Le){super(Le);_t(this,"_key","translation_text")}}function j(et){return Array.isArray(et)&&et.every(Te=>"role"in Te&&"content"in Te)}class $ extends x{constructor(Te){super(Te)}async _call(Te,Le={}){let ke=!1,Xe=!1,Ne=Le.add_special_tokens??(this.tokenizer.add_bos_token||this.tokenizer.add_eos_token)??!1,Ot;if(typeof Te=="string")Ot=Te=[Te];else if(Array.isArray(Te)&&Te.every(Bt=>typeof Bt=="string"))ke=!0,Ot=Te;else{if(j(Te))Te=[Te];else if(Array.isArray(Te)&&Te.every(j))ke=!0;else throw new Error("Input must be a string, an array of strings, a Chat, or an array of Chats");Xe=!0,Ot=Te.map(Bt=>this.tokenizer.apply_chat_template(Bt,{tokenize:!1,add_generation_prompt:!0})),Ne=!1}const Lt=Xe?!1:Le.return_full_text??!0;this.tokenizer.padding_side="left";const kt=this.tokenizer(Ot,{add_special_tokens:Ne,padding:!0,truncation:!0}),mt=await this.model.generate({...kt,...Le}),Zt=this.tokenizer.batch_decode(mt,{skip_special_tokens:!0});let Kt;!Lt&&kt.input_ids.dims.at(-1)>0&&(Kt=this.tokenizer.batch_decode(kt.input_ids,{skip_special_tokens:!0}).map(Bt=>Bt.length));const dr=Array.from({length:Te.length},Bt=>[]);for(let Bt=0;Bt<Zt.length;++Bt){const wr=Math.floor(Bt/mt.dims[0]*Te.length);Kt&&(Zt[Bt]=Zt[Bt].slice(Kt[wr])),dr[wr].push({generated_text:Xe?[...Te[wr],{role:"assistant",content:Zt[Bt]}]:Zt[Bt]})}return!ke&&dr.length===1?dr[0]:dr}}class U extends x{constructor(Te){super(Te),this.label2id=Object.fromEntries(Object.entries(this.model.config.label2id).map(([Le,ke])=>[Le.toLowerCase(),ke])),this.entailment_id=this.label2id.entailment,this.entailment_id===void 0&&(console.warn("Could not find 'entailment' in label2id mapping. Using 2 as entailment_id."),this.entailment_id=2),this.contradiction_id=this.label2id.contradiction??this.label2id.not_entailment,this.contradiction_id===void 0&&(console.warn("Could not find 'contradiction' in label2id mapping. Using 0 as contradiction_id."),this.contradiction_id=0)}async _call(Te,Le,{hypothesis_template:ke="This example is {}.",multi_label:Xe=!1}={}){const Ne=Array.isArray(Te);Ne||(Te=[Te]),Array.isArray(Le)||(Le=[Le]);const Ot=Le.map(mt=>ke.replace("{}",mt)),Lt=Xe||Le.length===1,kt=[];for(const mt of Te){const Zt=[];for(const Bt of Ot){const wr=this.tokenizer(mt,{text_pair:Bt,padding:!0,truncation:!0}),mr=await this.model(wr);Lt?Zt.push([mr.logits.data[this.contradiction_id],mr.logits.data[this.entailment_id]]):Zt.push(mr.logits.data[this.entailment_id])}const dr=(Lt?Zt.map(Bt=>(0,u.softmax)(Bt)[1]):(0,u.softmax)(Zt)).map((Bt,wr)=>[Bt,wr]).sort((Bt,wr)=>wr[0]-Bt[0]);kt.push({sequence:mt,labels:dr.map(Bt=>Le[Bt[1]]),scores:dr.map(Bt=>Bt[0])})}return Ne?kt:kt[0]}}class G extends x{constructor(Te){super(Te)}async _call(Te,{pooling:Le="none",normalize:ke=!1,quantize:Xe=!1,precision:Ne="binary"}={}){const Ot=this.tokenizer(Te,{padding:!0,truncation:!0}),Lt=await this.model(Ot);let kt=Lt.last_hidden_state??Lt.logits??Lt.token_embeddings;switch(Le){case"none":break;case"mean":kt=(0,m.mean_pooling)(kt,Ot.attention_mask);break;case"first_token":case"cls":kt=kt.slice(null,0);break;case"last_token":case"eos":kt=kt.slice(null,-1);break;default:throw Error(`Pooling method '${Le}' not supported.`)}return ke&&(kt=kt.normalize(2,-1)),Xe&&(kt=(0,m.quantize_embeddings)(kt,Ne)),kt}}class H extends x{constructor(Te){super(Te)}async _call(Te,{pool:Le=null}={}){const ke=await _(Te),{pixel_values:Xe}=await this.processor(ke),Ne=await this.model({pixel_values:Xe});let Ot;if(Le){if(!("pooler_output"in Ne))throw Error("No pooled output was returned. Make sure the model has a 'pooler' layer when using the 'pool' option.");Ot=Ne.pooler_output}else Ot=Ne.last_hidden_state??Ne.logits??Ne.image_embeds;return Ot}}class X extends x{constructor(Te){super(Te)}async _call(Te,{top_k:Le=5}={}){const ke=this.processor.feature_extractor.config.sampling_rate,Xe=await y(Te,ke),Ne=this.model.config.id2label,Ot=[];for(const Lt of Xe){const kt=await this.processor(Lt),Zt=(await this.model(kt)).logits[0],Kt=await(0,m.topk)(new m.Tensor("float32",(0,u.softmax)(Zt.data),Zt.dims),Le),dr=Kt[0].tolist(),wr=Kt[1].tolist().map((mr,hr)=>({label:Ne?Ne[mr]:`LABEL_${mr}`,score:dr[hr]}));Ot.push(wr)}return Array.isArray(Te)?Ot:Ot[0]}}class ee extends x{constructor(Te){super(Te)}async _call(Te,Le,{hypothesis_template:ke="This is a sound of {}."}={}){const Xe=!Array.isArray(Te);Xe&&(Te=[Te]);const Ne=Le.map(Zt=>ke.replace("{}",Zt)),Ot=this.tokenizer(Ne,{padding:!0,truncation:!0}),Lt=this.processor.feature_extractor.config.sampling_rate,kt=await y(Te,Lt),mt=[];for(const Zt of kt){const Kt=await this.processor(Zt),dr=await this.model({...Ot,...Kt}),Bt=(0,u.softmax)(dr.logits_per_audio.data);mt.push([...Bt].map((wr,mr)=>({score:wr,label:Le[mr]})))}return Xe?mt[0]:mt}}class ae extends x{constructor(Te){super(Te)}async _call(Te,Le={}){switch(this.model.config.model_type){case"whisper":case"lite-whisper":return this._call_whisper(Te,Le);case"wav2vec2":case"wav2vec2-bert":case"unispeech":case"unispeech-sat":case"hubert":return this._call_wav2vec2(Te,Le);case"moonshine":return this._call_moonshine(Te,Le);default:throw new Error(`AutomaticSpeechRecognitionPipeline does not support model type '${this.model.config.model_type}'.`)}}async _call_wav2vec2(Te,Le){Le.language&&console.warn('`language` parameter is not yet supported for `wav2vec2` models, defaulting to "English".'),Le.task&&console.warn('`task` parameter is not yet supported for `wav2vec2` models, defaulting to "transcribe".');const ke=!Array.isArray(Te);ke&&(Te=[Te]);const Xe=this.processor.feature_extractor.config.sampling_rate,Ne=await y(Te,Xe),Ot=[];for(const Lt of Ne){const kt=await this.processor(Lt),Zt=(await this.model(kt)).logits[0],Kt=[];for(const Bt of Zt)Kt.push((0,u.max)(Bt.data)[1]);const dr=this.tokenizer.decode(Kt);Ot.push({text:dr})}return ke?Ot[0]:Ot}async _call_whisper(Te,Le){const ke=Le.return_timestamps??!1,Xe=Le.chunk_length_s??0,Ne=Le.force_full_sequences??!1;let Ot=Le.stride_length_s??null;const Lt={...Le};ke==="word"&&(Lt.return_token_timestamps=!0,Lt.return_timestamps=!1);const kt=!Array.isArray(Te);kt&&(Te=[Te]);const mt=this.processor.feature_extractor.config.chunk_length/this.model.config.max_source_positions,Zt=this.processor.feature_extractor.config.hop_length,Kt=this.processor.feature_extractor.config.sampling_rate,dr=await y(Te,Kt),Bt=[];for(const wr of dr){let mr=[];if(Xe>0){if(Ot===null)Ot=Xe/6;else if(Xe<=Ot)throw Error("`chunk_length_s` must be larger than `stride_length_s`.");const or=Kt*Xe,tt=Kt*Ot,Se=or-2*tt;let Pe=0;for(;;){const Ve=Pe+or,Qe=wr.subarray(Pe,Ve),dt=await this.processor(Qe),Pt=Pe===0,Vt=Ve>=wr.length;if(mr.push({stride:[Qe.length,Pt?0:tt,Vt?0:tt],input_features:dt.input_features,is_last:Vt}),Vt)break;Pe+=Se}}else mr=[{stride:[wr.length,0,0],input_features:(await this.processor(wr)).input_features,is_last:!0}];for(const or of mr){Lt.num_frames=Math.floor(or.stride[0]/Zt);const tt=await this.model.generate({inputs:or.input_features,...Lt});ke==="word"?(or.tokens=tt.sequences.tolist()[0],or.token_timestamps=tt.token_timestamps.tolist()[0].map(Se=>(0,u.round)(Se,2))):or.tokens=tt[0].tolist(),or.stride=or.stride.map(Se=>Se/Kt)}const[hr,xr]=this.tokenizer._decode_asr(mr,{time_precision:mt,return_timestamps:ke,force_full_sequences:Ne});Bt.push({text:hr,...xr})}return kt?Bt[0]:Bt}async _call_moonshine(Te,Le){const ke=!Array.isArray(Te);ke&&(Te=[Te]);const Xe=this.processor.feature_extractor.config.sampling_rate,Ne=await y(Te,Xe),Ot=[];for(const Lt of Ne){const kt=await this.processor(Lt),mt=Math.floor(Lt.length/Xe)*6,Zt=await this.model.generate({max_new_tokens:mt,...Le,...kt}),Kt=this.processor.batch_decode(Zt,{skip_special_tokens:!0})[0];Ot.push({text:Kt})}return ke?Ot[0]:Ot}}class de extends x{constructor(Te){super(Te)}async _call(Te,Le={}){const ke=Array.isArray(Te),Xe=await _(Te),{pixel_values:Ne}=await this.processor(Xe),Ot=[];for(const Lt of Ne){Lt.dims=[1,...Lt.dims];const kt=await this.model.generate({inputs:Lt,...Le}),mt=this.tokenizer.batch_decode(kt,{skip_special_tokens:!0}).map(Zt=>({generated_text:Zt.trim()}));Ot.push(mt)}return ke?Ot:Ot[0]}}class ye extends x{constructor(Te){super(Te)}async _call(Te,{top_k:Le=5}={}){const ke=await _(Te),{pixel_values:Xe}=await this.processor(ke),Ne=await this.model({pixel_values:Xe}),Ot=this.model.config.id2label,Lt=[];for(const kt of Ne.logits){const mt=await(0,m.topk)(new m.Tensor("float32",(0,u.softmax)(kt.data),kt.dims),Le),Zt=mt[0].tolist(),dr=mt[1].tolist().map((Bt,wr)=>({label:Ot?Ot[Bt]:`LABEL_${Bt}`,score:Zt[wr]}));Lt.push(dr)}return Array.isArray(Te)?Lt:Lt[0]}}class _e extends x{constructor(Te){super(Te),this.subtasks_mapping={panoptic:"post_process_panoptic_segmentation",instance:"post_process_instance_segmentation",semantic:"post_process_semantic_segmentation"}}async _call(Te,{threshold:Le=.5,mask_threshold:ke=.5,overlap_mask_area_threshold:Xe=.8,label_ids_to_fuse:Ne=null,target_sizes:Ot=null,subtask:Lt=null}={}){if(Array.isArray(Te)&&Te.length!==1)throw Error("Image segmentation pipeline currently only supports a batch size of 1.");const mt=await _(Te),Zt=mt.map(or=>[or.height,or.width]),Kt=await this.processor(mt),{inputNames:dr,outputNames:Bt}=this.model.sessions.model;if(!dr.includes("pixel_values")){if(dr.length!==1)throw Error(`Expected a single input name, but got ${dr.length} inputs: ${dr}.`);const or=dr[0];if(or in Kt)throw Error(`Input name ${or} already exists in the inputs.`);Kt[or]=Kt.pixel_values}const wr=await this.model(Kt);let mr=null;if(Lt!==null)mr=this.subtasks_mapping[Lt];else if(this.processor.image_processor){for(const[or,tt]of Object.entries(this.subtasks_mapping))if(tt in this.processor.image_processor){mr=this.processor.image_processor[tt].bind(this.processor.image_processor),Lt=or;break}}const hr=this.model.config.id2label,xr=[];if(Lt)if(Lt==="panoptic"||Lt==="instance"){const or=mr(wr,Le,ke,Xe,Ne,Ot??Zt)[0],tt=or.segmentation;for(const Se of or.segments_info){const Pe=new Uint8ClampedArray(tt.data.length);for(let Qe=0;Qe<tt.data.length;++Qe)tt.data[Qe]===Se.id&&(Pe[Qe]=255);const Ve=new g.RawImage(Pe,tt.dims[1],tt.dims[0],1);xr.push({score:Se.score,label:hr[Se.label_id],mask:Ve})}}else if(Lt==="semantic"){const{segmentation:or,labels:tt}=mr(wr,Ot??Zt)[0];for(const Se of tt){const Pe=new Uint8ClampedArray(or.data.length);for(let Qe=0;Qe<or.data.length;++Qe)or.data[Qe]===Se&&(Pe[Qe]=255);const Ve=new g.RawImage(Pe,or.dims[1],or.dims[0],1);xr.push({score:null,label:hr[Se],mask:Ve})}}else throw Error(`Subtask ${Lt} not supported.`);else{const tt=wr[Bt[0]];for(let Se=0;Se<Zt.length;++Se){const Pe=Zt[Se],Ve=tt[Se];Ve.data.some(dt=>dt<-1e-5||dt>1+1e-5)&&Ve.sigmoid_();const Qe=await g.RawImage.fromTensor(Ve.mul_(255).to("uint8")).resize(Pe[1],Pe[0]);xr.push({label:null,score:null,mask:Qe})}}return xr}}class ue extends _e{constructor(Te){super(Te)}async _call(Te,Le={}){if(Array.isArray(Te)&&Te.length!==1)throw Error("Background removal pipeline currently only supports a batch size of 1.");const Xe=await _(Te),Ne=await super._call(Te,Le);return Xe.map((Lt,kt)=>{const mt=Lt.clone();return mt.putAlpha(Ne[kt].mask),mt})}}class fe extends x{constructor(Te){super(Te)}async _call(Te,Le,{hypothesis_template:ke="This is a photo of {}"}={}){const Xe=Array.isArray(Te),Ne=await _(Te),Ot=Le.map(dr=>ke.replace("{}",dr)),Lt=this.tokenizer(Ot,{padding:this.model.config.model_type==="siglip"?"max_length":!0,truncation:!0}),{pixel_values:kt}=await this.processor(Ne),mt=await this.model({...Lt,pixel_values:kt}),Zt=this.model.config.model_type==="siglip"?dr=>dr.sigmoid().data:dr=>(0,u.softmax)(dr.data),Kt=[];for(const dr of mt.logits_per_image){const wr=[...Zt(dr)].map((mr,hr)=>({score:mr,label:Le[hr]}));wr.sort((mr,hr)=>hr.score-mr.score),Kt.push(wr)}return Xe?Kt:Kt[0]}}class De extends x{constructor(Te){super(Te)}async _call(Te,{threshold:Le=.9,percentage:ke=!1}={}){const Xe=Array.isArray(Te);if(Xe&&Te.length!==1)throw Error("Object detection pipeline currently only supports a batch size of 1.");const Ne=await _(Te),Ot=ke?null:Ne.map(Bt=>[Bt.height,Bt.width]),{pixel_values:Lt,pixel_mask:kt}=await this.processor(Ne),mt=await this.model({pixel_values:Lt,pixel_mask:kt}),Zt=this.processor.image_processor.post_process_object_detection(mt,Le,Ot),Kt=this.model.config.id2label,dr=Zt.map(Bt=>Bt.boxes.map((wr,mr)=>({score:Bt.scores[mr],label:Kt[Bt.classes[mr]],box:M(wr,!ke)})));return Xe?dr:dr[0]}}class pe extends x{constructor(Te){super(Te)}async _call(Te,Le,{threshold:ke=.1,top_k:Xe=null,percentage:Ne=!1}={}){const Ot=Array.isArray(Te),Lt=await _(Te),kt=this.tokenizer(Le,{padding:!0,truncation:!0}),mt=await this.processor(Lt),Zt=[];for(let Kt=0;Kt<Lt.length;++Kt){const dr=Lt[Kt],Bt=Ne?null:[[dr.height,dr.width]],wr=mt.pixel_values[Kt].unsqueeze_(0),mr=await this.model({...kt,pixel_values:wr});let hr;if("post_process_grounded_object_detection"in this.processor){const xr=this.processor.post_process_grounded_object_detection(mr,kt.input_ids,{box_threshold:ke,text_threshold:ke,target_sizes:Bt})[0];hr=xr.boxes.map((or,tt)=>({score:xr.scores[tt],label:xr.labels[tt],box:M(or,!Ne)}))}else{const xr=this.processor.image_processor.post_process_object_detection(mr,ke,Bt,!0)[0];hr=xr.boxes.map((or,tt)=>({score:xr.scores[tt],label:Le[xr.classes[tt]],box:M(or,!Ne)}))}hr.sort((xr,or)=>or.score-xr.score),Xe!==null&&(hr=hr.slice(0,Xe)),Zt.push(hr)}return Ot?Zt:Zt[0]}}class K extends x{constructor(Te){super(Te)}async _call(Te,Le,ke={}){const Xe=(await _(Te))[0],{pixel_values:Ne}=await this.processor(Xe),Ot=`<s_docvqa><s_question>${Le}</s_question><s_answer>`,Lt=this.tokenizer(Ot,{add_special_tokens:!1,padding:!0,truncation:!0}).input_ids,kt=await this.model.generate({inputs:Ne,max_length:this.model.config.decoder.max_position_embeddings,decoder_input_ids:Lt,...ke}),Zt=this.tokenizer.batch_decode(kt)[0].match(/<s_answer>(.*?)<\/s_answer>/);let Kt=null;return Zt&&Zt.length>=2&&(Kt=Zt[1].trim()),[{answer:Kt}]}}class te extends x{constructor(Le){super(Le);_t(this,"DEFAULT_VOCODER_ID","Xenova/speecht5_hifigan");this.vocoder=Le.vocoder??null}async _call(Le,{speaker_embeddings:ke=null}={}){return this.processor?this._call_text_to_spectrogram(Le,{speaker_embeddings:ke}):this._call_text_to_waveform(Le)}async _call_text_to_waveform(Le){const ke=this.tokenizer(Le,{padding:!0,truncation:!0}),{waveform:Xe}=await this.model(ke),Ne=this.model.config.sampling_rate;return new d.RawAudio(Xe.data,Ne)}async _call_text_to_spectrogram(Le,{speaker_embeddings:ke}){if(this.vocoder||(console.log("No vocoder specified, using default HifiGan vocoder."),this.vocoder=await i.AutoModel.from_pretrained(this.DEFAULT_VOCODER_ID,{dtype:"fp32"})),(typeof ke=="string"||ke instanceof URL)&&(ke=new Float32Array(await(await fetch(ke)).arrayBuffer())),ke instanceof Float32Array)ke=new m.Tensor("float32",ke,[1,ke.length]);else if(!(ke instanceof m.Tensor))throw new Error("Speaker embeddings must be a `Tensor`, `Float32Array`, `string`, or `URL`.");const{input_ids:Xe}=this.tokenizer(Le,{padding:!0,truncation:!0}),{waveform:Ne}=await this.model.generate_speech(Xe,ke,{vocoder:this.vocoder}),Ot=this.processor.feature_extractor.config.sampling_rate;return new d.RawAudio(Ne.data,Ot)}}class ve extends x{constructor(Te){super(Te)}async _call(Te){const Le=await _(Te),ke=await this.processor(Le),Xe=await this.model(ke),Ne=[];for(const Ot of Xe.reconstruction){const Lt=Ot.squeeze().clamp_(0,1).mul_(255).round_().to("uint8");Ne.push(g.RawImage.fromTensor(Lt))}return Ne.length>1?Ne:Ne[0]}}class $e extends x{constructor(Te){super(Te)}async _call(Te){const Le=await _(Te),ke=await this.processor(Le),{predicted_depth:Xe}=await this.model(ke),Ne=[];for(let Ot=0;Ot<Le.length;++Ot){const Lt=Xe[Ot],[kt,mt]=Lt.dims.slice(-2),[Zt,Kt]=Le[Ot].size,dr=(await(0,m.interpolate_4d)(Lt.view(1,1,kt,mt),{size:[Kt,Zt],mode:"bilinear"})).view(Kt,Zt),Bt=dr.min().item(),wr=dr.max().item(),mr=dr.sub(Bt).div_(wr-Bt).mul_(255).to("uint8").unsqueeze(0),hr=g.RawImage.fromTensor(mr);Ne.push({predicted_depth:dr,depth:hr})}return Ne.length>1?Ne:Ne[0]}}const Ce=Object.freeze({"text-classification":{tokenizer:n.AutoTokenizer,pipeline:E,model:i.AutoModelForSequenceClassification,default:{model:"Xenova/distilbert-base-uncased-finetuned-sst-2-english"},type:"text"},"token-classification":{tokenizer:n.AutoTokenizer,pipeline:T,model:i.AutoModelForTokenClassification,default:{model:"Xenova/bert-base-multilingual-cased-ner-hrl"},type:"text"},"question-answering":{tokenizer:n.AutoTokenizer,pipeline:P,model:i.AutoModelForQuestionAnswering,default:{model:"Xenova/distilbert-base-cased-distilled-squad"},type:"text"},"fill-mask":{tokenizer:n.AutoTokenizer,pipeline:C,model:i.AutoModelForMaskedLM,default:{model:"Xenova/bert-base-uncased"},type:"text"},summarization:{tokenizer:n.AutoTokenizer,pipeline:L,model:i.AutoModelForSeq2SeqLM,default:{model:"Xenova/distilbart-cnn-6-6"},type:"text"},translation:{tokenizer:n.AutoTokenizer,pipeline:N,model:i.AutoModelForSeq2SeqLM,default:{model:"Xenova/t5-small"},type:"text"},"text2text-generation":{tokenizer:n.AutoTokenizer,pipeline:D,model:i.AutoModelForSeq2SeqLM,default:{model:"Xenova/flan-t5-small"},type:"text"},"text-generation":{tokenizer:n.AutoTokenizer,pipeline:$,model:i.AutoModelForCausalLM,default:{model:"Xenova/gpt2"},type:"text"},"zero-shot-classification":{tokenizer:n.AutoTokenizer,pipeline:U,model:i.AutoModelForSequenceClassification,default:{model:"Xenova/distilbert-base-uncased-mnli"},type:"text"},"audio-classification":{pipeline:X,model:i.AutoModelForAudioClassification,processor:o.AutoProcessor,default:{model:"Xenova/wav2vec2-base-superb-ks"},type:"audio"},"zero-shot-audio-classification":{tokenizer:n.AutoTokenizer,pipeline:ee,model:i.AutoModel,processor:o.AutoProcessor,default:{model:"Xenova/clap-htsat-unfused"},type:"multimodal"},"automatic-speech-recognition":{tokenizer:n.AutoTokenizer,pipeline:ae,model:[i.AutoModelForSpeechSeq2Seq,i.AutoModelForCTC],processor:o.AutoProcessor,default:{model:"Xenova/whisper-tiny.en"},type:"multimodal"},"text-to-audio":{tokenizer:n.AutoTokenizer,pipeline:te,model:[i.AutoModelForTextToWaveform,i.AutoModelForTextToSpectrogram],processor:[o.AutoProcessor,null],default:{model:"Xenova/speecht5_tts"},type:"text"},"image-to-text":{tokenizer:n.AutoTokenizer,pipeline:de,model:i.AutoModelForVision2Seq,processor:o.AutoProcessor,default:{model:"Xenova/vit-gpt2-image-captioning"},type:"multimodal"},"image-classification":{pipeline:ye,model:i.AutoModelForImageClassification,processor:o.AutoProcessor,default:{model:"Xenova/vit-base-patch16-224"},type:"multimodal"},"image-segmentation":{pipeline:_e,model:[i.AutoModelForImageSegmentation,i.AutoModelForSemanticSegmentation,i.AutoModelForUniversalSegmentation],processor:o.AutoProcessor,default:{model:"Xenova/detr-resnet-50-panoptic"},type:"multimodal"},"background-removal":{pipeline:ue,model:[i.AutoModelForImageSegmentation,i.AutoModelForSemanticSegmentation,i.AutoModelForUniversalSegmentation],processor:o.AutoProcessor,default:{model:"Xenova/modnet"},type:"image"},"zero-shot-image-classification":{tokenizer:n.AutoTokenizer,pipeline:fe,model:i.AutoModel,processor:o.AutoProcessor,default:{model:"Xenova/clip-vit-base-patch32"},type:"multimodal"},"object-detection":{pipeline:De,model:i.AutoModelForObjectDetection,processor:o.AutoProcessor,default:{model:"Xenova/detr-resnet-50"},type:"multimodal"},"zero-shot-object-detection":{tokenizer:n.AutoTokenizer,pipeline:pe,model:i.AutoModelForZeroShotObjectDetection,processor:o.AutoProcessor,default:{model:"Xenova/owlvit-base-patch32"},type:"multimodal"},"document-question-answering":{tokenizer:n.AutoTokenizer,pipeline:K,model:i.AutoModelForDocumentQuestionAnswering,processor:o.AutoProcessor,default:{model:"Xenova/donut-base-finetuned-docvqa"},type:"multimodal"},"image-to-image":{pipeline:ve,model:i.AutoModelForImageToImage,processor:o.AutoProcessor,default:{model:"Xenova/swin2SR-classical-sr-x2-64"},type:"image"},"depth-estimation":{pipeline:$e,model:i.AutoModelForDepthEstimation,processor:o.AutoProcessor,default:{model:"Xenova/dpt-large"},type:"image"},"feature-extraction":{tokenizer:n.AutoTokenizer,pipeline:G,model:i.AutoModel,default:{model:"Xenova/all-MiniLM-L6-v2"},type:"text"},"image-feature-extraction":{processor:o.AutoProcessor,pipeline:H,model:[i.AutoModelForImageFeatureExtraction,i.AutoModel],default:{model:"Xenova/vit-base-patch16-224-in21k"},type:"image"}}),Ge=Object.freeze({"sentiment-analysis":"text-classification",ner:"token-classification",asr:"automatic-speech-recognition","text-to-speech":"text-to-audio",embeddings:"feature-extraction"});async function ot(et,Te=null,{progress_callback:Le=null,config:ke=null,cache_dir:Xe=null,local_files_only:Ne=!1,revision:Ot="main",device:Lt=null,dtype:kt=null,subfolder:mt="onnx",use_external_data_format:Zt=null,model_file_name:Kt=null,session_options:dr={}}={}){et=Ge[et]??et;const Bt=Ce[et.split("_",1)[0]];if(!Bt)throw Error(`Unsupported pipeline: ${et}. Must be one of [${Object.keys(Ce)}]`);Te||(Te=Bt.default.model,console.log(`No model specified. Using default model: "${Te}".`));const wr={progress_callback:Le,config:ke,cache_dir:Xe,local_files_only:Ne,revision:Ot,device:Lt,dtype:kt,subfolder:mt,use_external_data_format:Zt,model_file_name:Kt,session_options:dr},mr=new Map([["tokenizer",Bt.tokenizer],["model",Bt.model],["processor",Bt.processor]]),hr=await Ye(mr,Te,wr);hr.task=et,(0,a.dispatchCallback)(Le,{status:"ready",task:et,model:Te});const xr=Bt.pipeline;return new xr(hr)}async function Ye(et,Te,Le){const ke=Object.create(null),Xe=[];for(const[Ne,Ot]of et.entries()){if(!Ot)continue;let Lt;Array.isArray(Ot)?Lt=new Promise(async(kt,mt)=>{var Kt,dr;let Zt;for(const Bt of Ot){if(Bt===null){kt(null);return}try{kt(await Bt.from_pretrained(Te,Le));return}catch(wr){if((Kt=wr.message)!=null&&Kt.includes("Unsupported model type"))Zt=wr;else if((dr=wr.message)!=null&&dr.includes("Could not locate file"))Zt=wr;else{mt(wr);return}}}mt(Zt)}):Lt=Ot.from_pretrained(Te,Le),ke[Ne]=Lt,Xe.push(Lt)}await Promise.all(Xe);for(const[Ne,Ot]of Object.entries(ke))ke[Ne]=await Ot;return ke}},"./src/tokenizers.js":(e,t,r)=>{r.r(t),r.d(t,{AlbertTokenizer:()=>Xr,AutoTokenizer:()=>Uc,BartTokenizer:()=>Or,BertTokenizer:()=>Ir,BlenderbotSmallTokenizer:()=>Zi,BlenderbotTokenizer:()=>gn,BloomTokenizer:()=>Uo,CLIPTokenizer:()=>ul,CamembertTokenizer:()=>pr,CodeGenTokenizer:()=>Wa,CodeLlamaTokenizer:()=>Po,CohereTokenizer:()=>yo,ConvBertTokenizer:()=>Je,DebertaTokenizer:()=>ge,DebertaV2Tokenizer:()=>ut,DistilBertTokenizer:()=>wt,ElectraTokenizer:()=>On,Ernie4_5_Tokenizer:()=>Dl,EsmTokenizer:()=>Xs,FalconTokenizer:()=>ra,GPT2Tokenizer:()=>_r,GPTNeoXTokenizer:()=>so,GemmaTokenizer:()=>Qn,Grok1Tokenizer:()=>is,HerbertTokenizer:()=>We,LlamaTokenizer:()=>Vo,M2M100Tokenizer:()=>wo,MBart50Tokenizer:()=>Vn,MBartTokenizer:()=>an,MPNetTokenizer:()=>ta,MarianTokenizer:()=>Pr,MgpstrTokenizer:()=>Xl,MobileBertTokenizer:()=>qr,NllbTokenizer:()=>$s,NougatTokenizer:()=>ba,PreTrainedTokenizer:()=>Sr,Qwen2Tokenizer:()=>xo,RoFormerTokenizer:()=>xt,RobertaTokenizer:()=>_o,SiglipTokenizer:()=>os,SpeechT5Tokenizer:()=>dl,SqueezeBertTokenizer:()=>An,T5Tokenizer:()=>Mn,TokenizerModel:()=>H,VitsTokenizer:()=>Ga,Wav2Vec2CTCTokenizer:()=>Hr,WhisperTokenizer:()=>Eo,XLMRobertaTokenizer:()=>pa,XLMTokenizer:()=>Rr,is_chinese_char:()=>C});var n=r("./src/utils/generic.js"),i=r("./src/utils/core.js"),o=r("./src/utils/hub.js"),s=r("./src/utils/maths.js"),a=r("./src/utils/tensor.js"),u=r("./src/utils/data-structures.js"),d=r("./node_modules/@huggingface/jinja/dist/index.js"),m=r("./src/models/whisper/common_whisper.js");async function g(Yt,Ie){const rt=await Promise.all([(0,o.getModelJSON)(Yt,"tokenizer.json",!0,Ie),(0,o.getModelJSON)(Yt,"tokenizer_config.json",!0,Ie)]);return Ie.legacy!==null&&(rt[1].legacy=Ie.legacy),rt}function _(Yt,Ie){const rt=[];let Tt=0;for(const Ft of Yt.matchAll(Ie)){const Dt=Ft[0];Tt<Ft.index&&rt.push(Yt.slice(Tt,Ft.index)),Dt.length>0&&rt.push(Dt),Tt=Ft.index+Dt.length}return Tt<Yt.length&&rt.push(Yt.slice(Tt)),rt}function y(Yt,Ie=!0){if(Yt.Regex!==void 0){let rt=Yt.Regex.replace(/\\([#&~])/g,"$1");for(const[Tt,Ft]of U)rt=rt.replaceAll(Tt,Ft);return new RegExp(rt,"gu")}else if(Yt.String!==void 0){const rt=(0,i.escapeRegExp)(Yt.String);return new RegExp(Ie?rt:`(${rt})`,"gu")}else return console.warn("Unknown pattern type:",Yt),null}function M(Yt){return new Map(Object.entries(Yt))}function x(Yt){const Ie=Yt.dims;switch(Ie.length){case 1:return Yt.tolist();case 2:if(Ie[0]!==1)throw new Error("Unable to decode tensor with `batch size !== 1`. Use `tokenizer.batch_decode(...)` for batched inputs.");return Yt.tolist()[0];default:throw new Error(`Expected tensor to have 1-2 dimensions, got ${Ie.length}.`)}}function E(Yt){return Yt.replace(/ \./g,".").replace(/ \?/g,"?").replace(/ \!/g,"!").replace(/ ,/g,",").replace(/ \' /g,"'").replace(/ n\'t/g,"n't").replace(/ \'m/g,"'m").replace(/ \'s/g,"'s").replace(/ \'ve/g,"'ve").replace(/ \'re/g,"'re")}function T(Yt){return Yt.replace(new RegExp("\\p{M}","gu"),"")}function P(Yt){return T(Yt.toLowerCase())}function C(Yt){return Yt>=19968&&Yt<=40959||Yt>=13312&&Yt<=19903||Yt>=131072&&Yt<=173791||Yt>=173824&&Yt<=177983||Yt>=177984&&Yt<=178207||Yt>=178208&&Yt<=183983||Yt>=63744&&Yt<=64255||Yt>=194560&&Yt<=195103}function D(Yt,Ie,rt){const Tt=[];let Ft=0;for(;Ft<Yt.length;){if(Tt.push(Yt[Ft]),(Ie.get(Yt[Ft])??rt)!==rt){++Ft;continue}for(;++Ft<Yt.length&&(Ie.get(Yt[Ft])??rt)===rt;)Ie.get(Tt.at(-1))!==rt&&(Tt[Tt.length-1]+=Yt[Ft])}return Tt}function L(Yt){return Yt.match(/\S+/g)||[]}const N="\\p{P}\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E",j=new RegExp(`^[${N}]+$`,"gu"),$=".,!?…。，、।۔،",U=new Map([["(?i:'s|'t|'re|'ve|'m|'ll|'d)","(?:'([sS]|[tT]|[rR][eE]|[vV][eE]|[mM]|[lL][lL]|[dD]))"],[` ?[^(\\s|[${$}])]+`,` ?[^\\s${$}]+`]]);class G{constructor(Ie){this.content=Ie.content,this.id=Ie.id,this.single_word=Ie.single_word??!1,this.lstrip=Ie.lstrip??!1,this.rstrip=Ie.rstrip??!1,this.special=Ie.special??!1,this.normalized=Ie.normalized??null}}class H extends n.Callable{constructor(Ie){super(),this.config=Ie,this.vocab=[],this.tokens_to_ids=new Map,this.unk_token_id=void 0,this.unk_token=void 0,this.end_of_word_suffix=void 0,this.fuse_unk=this.config.fuse_unk??!1}static fromConfig(Ie,...rt){switch(Ie.type){case"WordPiece":return new X(Ie);case"Unigram":return new ee(Ie,...rt);case"BPE":return new ye(Ie);default:if(Ie.vocab)return Array.isArray(Ie.vocab)?new ee(Ie,...rt):Object.hasOwn(Ie,"continuing_subword_prefix")&&Object.hasOwn(Ie,"unk_token")?Object.hasOwn(Ie,"merges")?new ye(Ie):new X(Ie):new _e(Ie,...rt);throw new Error(`Unknown TokenizerModel type: ${Ie.type}`)}}_call(Ie){return Ie=this.encode(Ie),this.fuse_unk&&(Ie=D(Ie,this.tokens_to_ids,this.unk_token_id)),Ie}encode(Ie){throw Error("encode should be implemented in subclass.")}convert_tokens_to_ids(Ie){return Ie.map(rt=>this.tokens_to_ids.get(rt)??this.unk_token_id)}convert_ids_to_tokens(Ie){return Ie.map(rt=>this.vocab[rt]??this.unk_token)}}class X extends H{constructor(Ie){super(Ie),this.tokens_to_ids=M(Ie.vocab),this.unk_token_id=this.tokens_to_ids.get(Ie.unk_token),this.unk_token=Ie.unk_token,this.max_input_chars_per_word=Ie.max_input_chars_per_word??100,this.vocab=new Array(this.tokens_to_ids.size);for(const[rt,Tt]of this.tokens_to_ids)this.vocab[Tt]=rt}encode(Ie){const rt=[];for(const Tt of Ie){const Ft=[...Tt];if(Ft.length>this.max_input_chars_per_word){rt.push(this.unk_token);continue}let Dt=!1,yr=0;const Vr=[];for(;yr<Ft.length;){let en=Ft.length,Qr=null;for(;yr<en;){let Dr=Ft.slice(yr,en).join("");if(yr>0&&(Dr=this.config.continuing_subword_prefix+Dr),this.tokens_to_ids.has(Dr)){Qr=Dr;break}--en}if(Qr===null){Dt=!0;break}Vr.push(Qr),yr=en}Dt?rt.push(this.unk_token):rt.push(...Vr)}return rt}}class ee extends H{constructor(Ie,rt){super(Ie);const Tt=Ie.vocab.length;this.vocab=new Array(Tt),this.scores=new Array(Tt);for(let Ft=0;Ft<Tt;++Ft)[this.vocab[Ft],this.scores[Ft]]=Ie.vocab[Ft];this.unk_token_id=Ie.unk_id,this.unk_token=this.vocab[Ie.unk_id],this.tokens_to_ids=new Map(this.vocab.map((Ft,Dt)=>[Ft,Dt])),this.bos_token=" ",this.bos_token_id=this.tokens_to_ids.get(this.bos_token),this.eos_token=rt.eos_token,this.eos_token_id=this.tokens_to_ids.get(this.eos_token),this.unk_token=this.vocab[this.unk_token_id],this.minScore=(0,s.min)(this.scores)[0],this.unk_score=this.minScore-10,this.scores[this.unk_token_id]=this.unk_score,this.trie=new u.CharTrie,this.trie.extend(this.vocab),this.fuse_unk=!0}populateNodes(Ie){const rt=Ie.chars,Tt=1;let Ft=0;for(;Ft<rt.length;){let Dt=!1;const yr=rt.slice(Ft).join(""),Vr=this.trie.commonPrefixSearch(yr);for(const en of Vr){const Qr=this.tokens_to_ids.get(en),Dr=this.scores[Qr],Ln=(0,i.len)(en);Ie.insert(Ft,Ln,Dr,Qr),!Dt&&Ln===Tt&&(Dt=!0)}Dt||Ie.insert(Ft,Tt,this.unk_score,this.unk_token_id),Ft+=Tt}}tokenize(Ie){const rt=new u.TokenLattice(Ie,this.bos_token_id,this.eos_token_id);return this.populateNodes(rt),rt.tokens()}encode(Ie){const rt=[];for(const Tt of Ie){const Ft=this.tokenize(Tt);rt.push(...Ft)}return rt}}const ae=(()=>{const Yt=[...Array.from({length:94},(Ft,Dt)=>Dt+33),...Array.from({length:12},(Ft,Dt)=>Dt+161),...Array.from({length:82},(Ft,Dt)=>Dt+174)],Ie=Yt.slice();let rt=0;for(let Ft=0;Ft<256;++Ft)Yt.includes(Ft)||(Yt.push(Ft),Ie.push(256+rt),rt+=1);const Tt=Ie.map(Ft=>String.fromCharCode(Ft));return Object.fromEntries(Yt.map((Ft,Dt)=>[Ft,Tt[Dt]]))})(),de=(0,i.reverseDictionary)(ae);class ye extends H{constructor(Ie){super(Ie),this.tokens_to_ids=M(Ie.vocab),this.unk_token_id=this.tokens_to_ids.get(Ie.unk_token),this.unk_token=Ie.unk_token,this.vocab=new Array(this.tokens_to_ids.size);for(const[Tt,Ft]of this.tokens_to_ids)this.vocab[Ft]=Tt;const rt=Array.isArray(Ie.merges[0]);this.merges=rt?Ie.merges:Ie.merges.map(Tt=>Tt.split(" ",2)),this.bpe_ranks=new Map(this.merges.map((Tt,Ft)=>[JSON.stringify(Tt),Ft])),this.end_of_word_suffix=Ie.end_of_word_suffix,this.continuing_subword_suffix=Ie.continuing_subword_suffix??null,this.byte_fallback=this.config.byte_fallback??!1,this.byte_fallback&&(this.text_encoder=new TextEncoder),this.ignore_merges=this.config.ignore_merges??!1,this.max_length_to_cache=256,this.cache_capacity=1e4,this.cache=new u.LRUCache(this.cache_capacity)}clear_cache(){this.cache.clear()}bpe(Ie){if(Ie.length===0)return[];const rt=this.cache.get(Ie);if(rt!==void 0)return rt;const Tt=Array.from(Ie);this.end_of_word_suffix&&(Tt[Tt.length-1]+=this.end_of_word_suffix);let Ft=[];if(Tt.length>1){const Dt=new u.PriorityQueue((en,Qr)=>en.score<Qr.score);let yr={token:Tt[0],bias:0,prev:null,next:null},Vr=yr;for(let en=1;en<Tt.length;++en){const Qr={bias:en/Tt.length,token:Tt[en],prev:Vr,next:null};Vr.next=Qr,this._add_node(Dt,Vr),Vr=Qr}for(;!Dt.isEmpty();){const en=Dt.pop();if(en.deleted||!en.next||en.next.deleted)continue;if(en.deleted=!0,en.next.deleted=!0,en.prev){const Dr={...en.prev};en.prev.deleted=!0,en.prev=Dr,Dr.prev?Dr.prev.next=Dr:yr=Dr}const Qr={token:en.token+en.next.token,bias:en.bias,prev:en.prev,next:en.next.next};Qr.prev?(Qr.prev.next=Qr,this._add_node(Dt,Qr.prev)):yr=Qr,Qr.next&&(Qr.next.prev=Qr,this._add_node(Dt,Qr))}for(let en=yr;en!==null;en=en.next)Ft.push(en.token)}else Ft=Tt;if(this.continuing_subword_suffix)for(let Dt=0;Dt<Ft.length-1;++Dt)Ft[Dt]+=this.continuing_subword_suffix;return Ie.length<this.max_length_to_cache&&this.cache.put(Ie,Ft),Ft}_add_node(Ie,rt){const Tt=this.bpe_ranks.get(JSON.stringify([rt.token,rt.next.token]));Tt!==void 0&&(rt.score=Tt+rt.bias,Ie.push(rt))}encode(Ie){const rt=[];for(const Tt of Ie){if(this.ignore_merges&&this.tokens_to_ids.has(Tt)){rt.push(Tt);continue}const Ft=this.bpe(Tt);for(const Dt of Ft)if(this.tokens_to_ids.has(Dt))rt.push(Dt);else if(this.byte_fallback){const yr=Array.from(this.text_encoder.encode(Dt)).map(Vr=>`<0x${Vr.toString(16).toUpperCase().padStart(2,"0")}>`);yr.every(Vr=>this.tokens_to_ids.has(Vr))?rt.push(...yr):rt.push(this.unk_token)}else rt.push(this.unk_token)}return rt}}class _e extends H{constructor(Ie,rt){super(Ie),this.tokens_to_ids=M(rt.target_lang?Ie.vocab[rt.target_lang]:Ie.vocab),this.bos_token=rt.bos_token,this.bos_token_id=this.tokens_to_ids.get(this.bos_token),this.eos_token=rt.eos_token,this.eos_token_id=this.tokens_to_ids.get(this.eos_token),this.pad_token=rt.pad_token,this.pad_token_id=this.tokens_to_ids.get(this.pad_token),this.unk_token=rt.unk_token,this.unk_token_id=this.tokens_to_ids.get(this.unk_token),this.vocab=new Array(this.tokens_to_ids.size);for(const[Tt,Ft]of this.tokens_to_ids)this.vocab[Ft]=Tt}encode(Ie){return Ie}}class ue extends n.Callable{constructor(Ie){super(),this.config=Ie}static fromConfig(Ie){if(Ie===null)return null;switch(Ie.type){case"BertNormalizer":return new et(Ie);case"Precompiled":return new Vt(Ie);case"Sequence":return new Ye(Ie);case"Replace":return new fe(Ie);case"NFC":return new pe(Ie);case"NFD":return new K(Ie);case"NFKC":return new te(Ie);case"NFKD":return new ve(Ie);case"Strip":return new $e(Ie);case"StripAccents":return new Ce(Ie);case"Lowercase":return new Ge(Ie);case"Prepend":return new ot(Ie);default:throw new Error(`Unknown Normalizer type: ${Ie.type}`)}}normalize(Ie){throw Error("normalize should be implemented in subclass.")}_call(Ie){return this.normalize(Ie)}}class fe extends ue{normalize(Ie){const rt=y(this.config.pattern);return rt===null?Ie:Ie.replaceAll(rt,this.config.content)}}class De extends ue{constructor(){super(...arguments);_t(this,"form")}normalize(rt){return rt=rt.normalize(this.form),rt}}class pe extends De{constructor(){super(...arguments);_t(this,"form","NFC")}}class K extends De{constructor(){super(...arguments);_t(this,"form","NFD")}}class te extends De{constructor(){super(...arguments);_t(this,"form","NFKC")}}class ve extends De{constructor(){super(...arguments);_t(this,"form","NFKD")}}class $e extends ue{normalize(Ie){return this.config.strip_left&&this.config.strip_right?Ie=Ie.trim():(this.config.strip_left&&(Ie=Ie.trimStart()),this.config.strip_right&&(Ie=Ie.trimEnd())),Ie}}class Ce extends ue{normalize(Ie){return Ie=T(Ie),Ie}}class Ge extends ue{normalize(Ie){return Ie=Ie.toLowerCase(),Ie}}class ot extends ue{normalize(Ie){return Ie=this.config.prepend+Ie,Ie}}class Ye extends ue{constructor(Ie){super(Ie),this.normalizers=Ie.normalizers.map(rt=>ue.fromConfig(rt))}normalize(Ie){return this.normalizers.reduce((rt,Tt)=>Tt.normalize(rt),Ie)}}class et extends ue{_tokenize_chinese_chars(Ie){const rt=[];for(let Tt=0;Tt<Ie.length;++Tt){const Ft=Ie[Tt],Dt=Ft.charCodeAt(0);C(Dt)?(rt.push(" "),rt.push(Ft),rt.push(" ")):rt.push(Ft)}return rt.join("")}stripAccents(Ie){return Ie.normalize("NFD").replace(new RegExp("\\p{Mn}","gu"),"")}_is_control(Ie){switch(Ie){case"	":case`
`:case"\r":return!1;default:return new RegExp("^\\p{Cc}|\\p{Cf}|\\p{Co}|\\p{Cs}$","u").test(Ie)}}_clean_text(Ie){const rt=[];for(const Tt of Ie){const Ft=Tt.charCodeAt(0);Ft===0||Ft===65533||this._is_control(Tt)||(/^\s$/.test(Tt)?rt.push(" "):rt.push(Tt))}return rt.join("")}normalize(Ie){return this.config.clean_text&&(Ie=this._clean_text(Ie)),this.config.handle_chinese_chars&&(Ie=this._tokenize_chinese_chars(Ie)),this.config.lowercase?(Ie=Ie.toLowerCase(),this.config.strip_accents!==!1&&(Ie=this.stripAccents(Ie))):this.config.strip_accents&&(Ie=this.stripAccents(Ie)),Ie}}class Te extends n.Callable{static fromConfig(Ie){if(Ie===null)return null;switch(Ie.type){case"BertPreTokenizer":return new Le(Ie);case"Sequence":return new At(Ie);case"Whitespace":return new qt(Ie);case"WhitespaceSplit":return new er(Ie);case"Metaspace":return new dt(Ie);case"ByteLevel":return new ke(Ie);case"Split":return new Xe(Ie);case"Punctuation":return new Ne(Ie);case"Digits":return new Ot(Ie);case"Replace":return new fr(Ie);default:throw new Error(`Unknown PreTokenizer type: ${Ie.type}`)}}pre_tokenize_text(Ie,rt){throw Error("pre_tokenize_text should be implemented in subclass.")}pre_tokenize(Ie,rt){return(Array.isArray(Ie)?Ie.map(Tt=>this.pre_tokenize_text(Tt,rt)):this.pre_tokenize_text(Ie,rt)).flat()}_call(Ie,rt){return this.pre_tokenize(Ie,rt)}}class Le extends Te{constructor(Ie){super(),this.pattern=new RegExp(`[^\\s${N}]+|[${N}]`,"gu")}pre_tokenize_text(Ie,rt){return Ie.trim().match(this.pattern)||[]}}class ke extends Te{constructor(Ie){super(),this.config=Ie,this.add_prefix_space=this.config.add_prefix_space,this.trim_offsets=this.config.trim_offsets,this.use_regex=this.config.use_regex??!0,this.pattern=new RegExp("'s|'t|'re|'ve|'m|'ll|'d| ?\\p{L}+| ?\\p{N}+| ?[^\\s\\p{L}\\p{N}]+|\\s+(?!\\S)|\\s+","gu"),this.byte_encoder=ae,this.text_encoder=new TextEncoder}pre_tokenize_text(Ie,rt){return this.add_prefix_space&&!Ie.startsWith(" ")&&(Ie=" "+Ie),(this.use_regex?Ie.match(this.pattern)||[]:[Ie]).map(Ft=>Array.from(this.text_encoder.encode(Ft),Dt=>this.byte_encoder[Dt]).join(""))}}class Xe extends Te{constructor(Ie){super(),this.config=Ie,this.pattern=y(this.config.pattern,this.config.invert)}pre_tokenize_text(Ie,rt){var Tt;return this.pattern===null?[]:this.config.invert?Ie.match(this.pattern)||[]:((Tt=this.config.behavior)==null?void 0:Tt.toLowerCase())==="removed"?Ie.split(this.pattern).filter(Ft=>Ft):_(Ie,this.pattern)}}class Ne extends Te{constructor(Ie){super(),this.config=Ie,this.pattern=new RegExp(`[^${N}]+|[${N}]+`,"gu")}pre_tokenize_text(Ie,rt){return Ie.match(this.pattern)||[]}}class Ot extends Te{constructor(Ie){super(),this.config=Ie;const rt=`[^\\d]+|\\d${this.config.individual_digits?"":"+"}`;this.pattern=new RegExp(rt,"gu")}pre_tokenize_text(Ie,rt){return Ie.match(this.pattern)||[]}}class Lt extends n.Callable{constructor(Ie){super(),this.config=Ie}static fromConfig(Ie){if(Ie===null)return null;switch(Ie.type){case"TemplateProcessing":return new Zt(Ie);case"ByteLevel":return new Kt(Ie);case"RobertaProcessing":return new mt(Ie);case"BertProcessing":return new kt(Ie);case"Sequence":return new dr(Ie);default:throw new Error(`Unknown PostProcessor type: ${Ie.type}`)}}post_process(Ie,...rt){throw Error("post_process should be implemented in subclass.")}_call(Ie,...rt){return this.post_process(Ie,...rt)}}class kt extends Lt{constructor(Ie){super(Ie),this.cls=Ie.cls[0],this.sep=Ie.sep[0]}post_process(Ie,rt=null,{add_special_tokens:Tt=!0}={}){Tt&&(Ie=(0,i.mergeArrays)([this.cls],Ie,[this.sep]));let Ft=new Array(Ie.length).fill(0);if(rt!==null){const Dt=Tt&&this instanceof mt?[this.sep]:[],yr=Tt?[this.sep]:[];Ie=(0,i.mergeArrays)(Ie,Dt,rt,yr),Ft=(0,i.mergeArrays)(Ft,new Array(rt.length+Dt.length+yr.length).fill(1))}return{tokens:Ie,token_type_ids:Ft}}}class mt extends kt{}class Zt extends Lt{constructor(Ie){super(Ie),this.single=Ie.single,this.pair=Ie.pair}post_process(Ie,rt=null,{add_special_tokens:Tt=!0}={}){const Ft=rt===null?this.single:this.pair;let Dt=[],yr=[];for(const Vr of Ft)"SpecialToken"in Vr?Tt&&(Dt.push(Vr.SpecialToken.id),yr.push(Vr.SpecialToken.type_id)):"Sequence"in Vr&&(Vr.Sequence.id==="A"?(Dt=(0,i.mergeArrays)(Dt,Ie),yr=(0,i.mergeArrays)(yr,new Array(Ie.length).fill(Vr.Sequence.type_id))):Vr.Sequence.id==="B"&&(Dt=(0,i.mergeArrays)(Dt,rt),yr=(0,i.mergeArrays)(yr,new Array(rt.length).fill(Vr.Sequence.type_id))));return{tokens:Dt,token_type_ids:yr}}}class Kt extends Lt{post_process(Ie,rt=null){return rt&&(Ie=(0,i.mergeArrays)(Ie,rt)),{tokens:Ie}}}class dr extends Lt{constructor(Ie){super(Ie),this.processors=Ie.processors.map(rt=>Lt.fromConfig(rt))}post_process(Ie,rt=null,Tt={}){let Ft;for(const Dt of this.processors)if(Dt instanceof Kt)Ie=Dt.post_process(Ie).tokens,rt&&(rt=Dt.post_process(rt).tokens);else{const yr=Dt.post_process(Ie,rt,Tt);Ie=yr.tokens,Ft=yr.token_type_ids}return{tokens:Ie,token_type_ids:Ft}}}class Bt extends n.Callable{constructor(Ie){super(),this.config=Ie,this.added_tokens=[],this.end_of_word_suffix=null,this.trim_offsets=Ie.trim_offsets}static fromConfig(Ie){if(Ie===null)return null;switch(Ie.type){case"WordPiece":return new or(Ie);case"Metaspace":return new Pt(Ie);case"ByteLevel":return new tt(Ie);case"Replace":return new wr(Ie);case"ByteFallback":return new mr(Ie);case"Fuse":return new hr(Ie);case"Strip":return new xr(Ie);case"Sequence":return new Pe(Ie);case"CTC":return new Se(Ie);case"BPEDecoder":return new Ve(Ie);default:throw new Error(`Unknown Decoder type: ${Ie.type}`)}}_call(Ie){return this.decode(Ie)}decode(Ie){return this.decode_chain(Ie).join("")}decode_chain(Ie){throw Error("`decode_chain` should be implemented in subclass.")}}class wr extends Bt{decode_chain(Ie){const rt=y(this.config.pattern);return rt===null?Ie:Ie.map(Tt=>Tt.replaceAll(rt,this.config.content))}}class mr extends Bt{constructor(Ie){super(Ie),this.text_decoder=new TextDecoder}decode_chain(Ie){const rt=[];let Tt=[];for(const Ft of Ie){let Dt=null;if(Ft.length===6&&Ft.startsWith("<0x")&&Ft.endsWith(">")){const yr=parseInt(Ft.slice(3,5),16);isNaN(yr)||(Dt=yr)}if(Dt!==null)Tt.push(Dt);else{if(Tt.length>0){const yr=this.text_decoder.decode(Uint8Array.from(Tt));rt.push(yr),Tt=[]}rt.push(Ft)}}if(Tt.length>0){const Ft=this.text_decoder.decode(Uint8Array.from(Tt));rt.push(Ft),Tt=[]}return rt}}class hr extends Bt{decode_chain(Ie){return[Ie.join("")]}}class xr extends Bt{constructor(Ie){super(Ie),this.content=this.config.content,this.start=this.config.start,this.stop=this.config.stop}decode_chain(Ie){return Ie.map(rt=>{let Tt=0;for(let Dt=0;Dt<this.start&&rt[Dt]===this.content;++Dt){Tt=Dt+1;continue}let Ft=rt.length;for(let Dt=0;Dt<this.stop;++Dt){const yr=rt.length-Dt-1;if(rt[yr]===this.content){Ft=yr;continue}else break}return rt.slice(Tt,Ft)})}}class or extends Bt{constructor(Ie){super(Ie),this.cleanup=Ie.cleanup}decode_chain(Ie){return Ie.map((rt,Tt)=>(Tt!==0&&(rt.startsWith(this.config.prefix)?rt=rt.replace(this.config.prefix,""):rt=" "+rt),this.cleanup&&(rt=E(rt)),rt))}}class tt extends Bt{constructor(Ie){super(Ie),this.byte_decoder=de,this.text_decoder=new TextDecoder("utf-8",{fatal:!1,ignoreBOM:!0}),this.end_of_word_suffix=null}convert_tokens_to_string(Ie){const rt=Ie.join(""),Tt=new Uint8Array([...rt].map(Dt=>this.byte_decoder[Dt]));return this.text_decoder.decode(Tt)}decode_chain(Ie){const rt=[];let Tt=[];for(const Ft of Ie)this.added_tokens.find(Dt=>Dt.content===Ft)!==void 0?(Tt.length>0&&(rt.push(this.convert_tokens_to_string(Tt)),Tt=[]),rt.push(Ft)):Tt.push(Ft);return Tt.length>0&&rt.push(this.convert_tokens_to_string(Tt)),rt}}class Se extends Bt{constructor(Ie){super(Ie),this.pad_token=this.config.pad_token,this.word_delimiter_token=this.config.word_delimiter_token,this.cleanup=this.config.cleanup}convert_tokens_to_string(Ie){if(Ie.length===0)return"";const rt=[Ie[0]];for(let Dt=1;Dt<Ie.length;++Dt)Ie[Dt]!==rt.at(-1)&&rt.push(Ie[Dt]);let Ft=rt.filter(Dt=>Dt!==this.pad_token).join("");return this.cleanup&&(Ft=E(Ft).replaceAll(this.word_delimiter_token," ").trim()),Ft}decode_chain(Ie){return[this.convert_tokens_to_string(Ie)]}}class Pe extends Bt{constructor(Ie){super(Ie),this.decoders=Ie.decoders.map(rt=>Bt.fromConfig(rt))}decode_chain(Ie){return this.decoders.reduce((rt,Tt)=>Tt.decode_chain(rt),Ie)}}class Ve extends Bt{constructor(Ie){super(Ie),this.suffix=this.config.suffix}decode_chain(Ie){return Ie.map((rt,Tt)=>rt.replaceAll(this.suffix,Tt===Ie.length-1?"":" "))}}class Qe extends Bt{decode_chain(Ie){let rt="";for(let Tt=1;Tt<Ie.length;Tt+=2)rt+=Ie[Tt];return[rt]}}class dt extends Te{constructor(Ie){super(),this.addPrefixSpace=Ie.add_prefix_space,this.replacement=Ie.replacement,this.strRep=Ie.str_rep||this.replacement,this.prepend_scheme=Ie.prepend_scheme??"always"}pre_tokenize_text(Ie,{section_index:rt=void 0}={}){let Tt=Ie.replaceAll(" ",this.strRep);return this.addPrefixSpace&&!Tt.startsWith(this.replacement)&&(this.prepend_scheme==="always"||this.prepend_scheme==="first"&&rt===0)&&(Tt=this.strRep+Tt),[Tt]}}class Pt extends Bt{constructor(Ie){super(Ie),this.addPrefixSpace=Ie.add_prefix_space,this.replacement=Ie.replacement}decode_chain(Ie){const rt=[];for(let Tt=0;Tt<Ie.length;++Tt){let Ft=Ie[Tt].replaceAll(this.replacement," ");this.addPrefixSpace&&Tt==0&&Ft.startsWith(" ")&&(Ft=Ft.substring(1)),rt.push(Ft)}return rt}}class Vt extends ue{constructor(Ie){super(Ie),this.charsmap=Ie.precompiled_charsmap}normalize(Ie){return Ie=Ie.replace(/[\u0001-\u0008\u000B\u000E-\u001F\u007F\u008F\u009F]/gm,""),Ie=Ie.replace(/[\u0009\u000A\u000C\u000D\u00A0\u1680\u2000-\u200F\u2028\u2029\u202F\u205F\u2581\u3000\uFEFF\uFFFD]/gm," "),Ie.includes("～")?Ie=Ie.split("～").map(Tt=>Tt.normalize("NFKC")).join("～"):Ie=Ie.normalize("NFKC"),Ie}}class At extends Te{constructor(Ie){super(),this.tokenizers=Ie.pretokenizers.map(rt=>Te.fromConfig(rt))}pre_tokenize_text(Ie,rt){return this.tokenizers.reduce((Tt,Ft)=>Ft.pre_tokenize(Tt,rt),[Ie])}}class qt extends Te{constructor(Ie){super()}pre_tokenize_text(Ie,rt){return Ie.match(/\w+|[^\w\s]+/g)||[]}}class er extends Te{constructor(Ie){super()}pre_tokenize_text(Ie,rt){return L(Ie)}}class fr extends Te{constructor(Ie){super(),this.config=Ie,this.pattern=y(this.config.pattern),this.content=this.config.content}pre_tokenize_text(Ie,rt){return this.pattern===null?[Ie]:[Ie.replaceAll(this.pattern,this.config.content)]}}const Jr=["bos_token","eos_token","unk_token","sep_token","pad_token","cls_token","mask_token"];function $t(Yt,Ie,rt,Tt){for(const Ft of Object.keys(Yt)){const Dt=Ie-Yt[Ft].length,yr=rt(Ft),Vr=new Array(Dt).fill(yr);Yt[Ft]=Tt==="right"?(0,i.mergeArrays)(Yt[Ft],Vr):(0,i.mergeArrays)(Vr,Yt[Ft])}}function zr(Yt,Ie){for(const rt of Object.keys(Yt))Yt[rt].length=Ie}class Sr extends n.Callable{constructor(rt,Tt){super();_t(this,"return_token_type_ids",!1);_t(this,"padding_side","right");this.config=Tt,this.normalizer=ue.fromConfig(rt.normalizer),this.pre_tokenizer=Te.fromConfig(rt.pre_tokenizer),this.model=H.fromConfig(rt.model,Tt),this.post_processor=Lt.fromConfig(rt.post_processor),this.decoder=Bt.fromConfig(rt.decoder),this.special_tokens=[],this.all_special_ids=[],this.added_tokens=[];for(const Ft of rt.added_tokens){const Dt=new G(Ft);this.added_tokens.push(Dt),this.model.tokens_to_ids.set(Dt.content,Dt.id),this.model.vocab[Dt.id]=Dt.content,Dt.special&&(this.special_tokens.push(Dt.content),this.all_special_ids.push(Dt.id))}if(this.additional_special_tokens=Tt.additional_special_tokens??[],this.special_tokens.push(...this.additional_special_tokens),this.special_tokens=[...new Set(this.special_tokens)],this.decoder&&(this.decoder.added_tokens=this.added_tokens,this.decoder.end_of_word_suffix=this.model.end_of_word_suffix),this.added_tokens_splitter=new u.DictionarySplitter(this.added_tokens.map(Ft=>Ft.content)),this.added_tokens_map=new Map(this.added_tokens.map(Ft=>[Ft.content,Ft])),this.mask_token=this.getToken("mask_token"),this.mask_token_id=this.model.tokens_to_ids.get(this.mask_token),this.pad_token=this.getToken("pad_token","eos_token"),this.pad_token_id=this.model.tokens_to_ids.get(this.pad_token),this.sep_token=this.getToken("sep_token"),this.sep_token_id=this.model.tokens_to_ids.get(this.sep_token),this.unk_token=this.getToken("unk_token"),this.unk_token_id=this.model.tokens_to_ids.get(this.unk_token),this.bos_token=this.getToken("bos_token"),this.bos_token_id=this.model.tokens_to_ids.get(this.bos_token),this.eos_token=this.getToken("eos_token"),this.eos_token_id=this.model.tokens_to_ids.get(this.eos_token),this.model_max_length=Tt.model_max_length,this.remove_space=Tt.remove_space,this.clean_up_tokenization_spaces=Tt.clean_up_tokenization_spaces??!0,this.do_lowercase_and_remove_accent=Tt.do_lowercase_and_remove_accent??!1,Tt.padding_side&&(this.padding_side=Tt.padding_side),this.add_bos_token=Tt.add_bos_token,this.add_eos_token=Tt.add_eos_token,this.legacy=!1,this.chat_template=Tt.chat_template??null,Array.isArray(this.chat_template)){const Ft=Object.create(null);for(const{name:Dt,template:yr}of this.chat_template){if(typeof Dt!="string"||typeof yr!="string")throw new Error('Chat template must be a list of objects with "name" and "template" properties');Ft[Dt]=yr}this.chat_template=Ft}this._compiled_template_cache=new Map}getToken(...rt){for(const Tt of rt){const Ft=this.config[Tt];if(Ft)if(typeof Ft=="object"){if(Ft.__type==="AddedToken")return Ft.content;throw Error(`Unknown token: ${Ft}`)}else return Ft}return null}static async from_pretrained(rt,{progress_callback:Tt=null,config:Ft=null,cache_dir:Dt=null,local_files_only:yr=!1,revision:Vr="main",legacy:en=null}={}){const Qr=await g(rt,{progress_callback:Tt,config:Ft,cache_dir:Dt,local_files_only:yr,revision:Vr,legacy:en});return new this(...Qr)}_call(rt,{text_pair:Tt=null,add_special_tokens:Ft=!0,padding:Dt=!1,truncation:yr=null,max_length:Vr=null,return_tensor:en=!0,return_token_type_ids:Qr=null}={}){const Dr=Array.isArray(rt);let Ln;if(Dr){if(rt.length===0)throw Error("text array must be non-empty");if(Tt!==null){if(Array.isArray(Tt)){if(rt.length!==Tt.length)throw Error("text and text_pair must have the same length")}else throw Error("text_pair must also be an array");Ln=rt.map((vi,Ai)=>this._encode_plus(vi,{text_pair:Tt[Ai],add_special_tokens:Ft,return_token_type_ids:Qr}))}else Ln=rt.map(vi=>this._encode_plus(vi,{add_special_tokens:Ft,return_token_type_ids:Qr}))}else{if(rt==null)throw Error("text may not be null or undefined");if(Array.isArray(Tt))throw Error("When specifying `text_pair`, since `text` is a string, `text_pair` must also be a string (i.e., not an array).");Ln=[this._encode_plus(rt,{text_pair:Tt,add_special_tokens:Ft,return_token_type_ids:Qr})]}if(Vr===null?Vr=this.model_max_length:yr===null&&(Dt===!0?(console.warn("`max_length` is ignored when `padding: true` and there is no truncation strategy. To pad to max length, use `padding: 'max_length'`."),Vr=this.model_max_length):Dt===!1&&(console.warn("Truncation was not explicitly activated but `max_length` is provided a specific value, please use `truncation: true` to explicitly truncate examples to max length."),yr=!0)),Dt===!0&&(Vr=Math.min((0,s.max)(Ln.map(vi=>vi.input_ids.length))[0],Vr??1/0)),Vr=Math.min(Vr,this.model_max_length??1/0),Dt||yr)for(let vi=0;vi<Ln.length;++vi)Ln[vi].input_ids.length!==Vr&&(Ln[vi].input_ids.length>Vr?yr&&zr(Ln[vi],Vr):Dt&&$t(Ln[vi],Vr,Ai=>Ai==="input_ids"?this.pad_token_id:0,this.padding_side));const Ii={};if(en){if(!(Dt&&yr)&&Ln.some(Ai=>{var rn;for(const Xi of Object.keys(Ai))if(Ai[Xi].length!==((rn=Ln[0][Xi])==null?void 0:rn.length))return!0;return!1}))throw Error("Unable to create tensor, you should probably activate truncation and/or padding with 'padding=true' and 'truncation=true' to have batched tensors with the same length.");const vi=[Ln.length,Ln[0].input_ids.length];for(const Ai of Object.keys(Ln[0]))Ii[Ai]=new a.Tensor("int64",BigInt64Array.from(Ln.flatMap(rn=>rn[Ai]).map(BigInt)),vi)}else{for(const vi of Object.keys(Ln[0]))Ii[vi]=Ln.map(Ai=>Ai[vi]);if(!Dr)for(const vi of Object.keys(Ii))Ii[vi]=Ii[vi][0]}return Ii}_encode_text(rt){if(rt===null)return null;const Tt=this.added_tokens_splitter.split(rt);for(let Dt=0;Dt<Tt.length;++Dt){const yr=this.added_tokens_map.get(Tt[Dt]);yr&&(yr.lstrip&&Dt>0&&(Tt[Dt-1]=Tt[Dt-1].trimEnd()),yr.rstrip&&Dt<Tt.length-1&&(Tt[Dt+1]=Tt[Dt+1].trimStart()))}return Tt.flatMap((Dt,yr)=>{if(Dt.length===0)return[];if(this.added_tokens_map.has(Dt))return[Dt];if(this.remove_space===!0&&(Dt=Dt.trim().split(/\s+/).join(" ")),this.do_lowercase_and_remove_accent&&(Dt=P(Dt)),this.normalizer!==null&&(Dt=this.normalizer(Dt)),Dt.length===0)return[];const Vr=this.pre_tokenizer!==null?this.pre_tokenizer(Dt,{section_index:yr}):[Dt];return this.model(Vr)})}_encode_plus(rt,{text_pair:Tt=null,add_special_tokens:Ft=!0,return_token_type_ids:Dt=null}={}){const{tokens:yr,token_type_ids:Vr}=this._tokenize_helper(rt,{pair:Tt,add_special_tokens:Ft}),en=this.model.convert_tokens_to_ids(yr),Qr={input_ids:en,attention_mask:new Array(en.length).fill(1)};return(Dt??this.return_token_type_ids)&&Vr&&(Qr.token_type_ids=Vr),Qr}_tokenize_helper(rt,{pair:Tt=null,add_special_tokens:Ft=!1}={}){const Dt=this._encode_text(rt),yr=this._encode_text(Tt);return this.post_processor?this.post_processor(Dt,yr,{add_special_tokens:Ft}):{tokens:(0,i.mergeArrays)(Dt??[],yr??[])}}tokenize(rt,{pair:Tt=null,add_special_tokens:Ft=!1}={}){return this._tokenize_helper(rt,{pair:Tt,add_special_tokens:Ft}).tokens}encode(rt,{text_pair:Tt=null,add_special_tokens:Ft=!0,return_token_type_ids:Dt=null}={}){return this._encode_plus(rt,{text_pair:Tt,add_special_tokens:Ft,return_token_type_ids:Dt}).input_ids}batch_decode(rt,Tt={}){return rt instanceof a.Tensor&&(rt=rt.tolist()),rt.map(Ft=>this.decode(Ft,Tt))}decode(rt,Tt={}){if(rt instanceof a.Tensor&&(rt=x(rt)),!Array.isArray(rt)||rt.length===0||!(0,i.isIntegralNumber)(rt[0]))throw Error("token_ids must be a non-empty array of integers.");return this.decode_single(rt,Tt)}decode_single(rt,{skip_special_tokens:Tt=!1,clean_up_tokenization_spaces:Ft=null}){let Dt=this.model.convert_ids_to_tokens(rt);Tt&&(Dt=Dt.filter(Vr=>!this.special_tokens.includes(Vr)));let yr=this.decoder?this.decoder(Dt):Dt.join(" ");return this.decoder&&this.decoder.end_of_word_suffix&&(yr=yr.replaceAll(this.decoder.end_of_word_suffix," "),Tt&&(yr=yr.trim())),(Ft??this.clean_up_tokenization_spaces)&&(yr=E(yr)),yr}get_chat_template({chat_template:rt=null,tools:Tt=null}={}){if(this.chat_template&&typeof this.chat_template=="object"){const Ft=this.chat_template;if(rt!==null&&Object.hasOwn(Ft,rt))rt=Ft[rt];else if(rt===null)if(Tt!==null&&"tool_use"in Ft)rt=Ft.tool_use;else if("default"in Ft)rt=Ft.default;else throw Error(`This model has multiple chat templates with no default specified! Please either pass a chat template or the name of the template you wish to use to the 'chat_template' argument. Available template names are ${Object.keys(Ft).sort()}.`)}else if(rt===null)if(this.chat_template)rt=this.chat_template;else throw Error("Cannot use apply_chat_template() because tokenizer.chat_template is not set and no template argument was passed! For information about writing templates and setting the tokenizer.chat_template attribute, please see the documentation at https://huggingface.co/docs/transformers/main/en/chat_templating");return rt}apply_chat_template(rt,{tools:Tt=null,documents:Ft=null,chat_template:Dt=null,add_generation_prompt:yr=!1,tokenize:Vr=!0,padding:en=!1,truncation:Qr=!1,max_length:Dr=null,return_tensor:Ln=!0,return_dict:Ii=!1,tokenizer_kwargs:vi={},...Ai}={}){if(Dt=this.get_chat_template({chat_template:Dt,tools:Tt}),typeof Dt!="string")throw Error(`chat_template must be a string, but got ${typeof Dt}`);let rn=this._compiled_template_cache.get(Dt);rn===void 0&&(rn=new d.Template(Dt),this._compiled_template_cache.set(Dt,rn));const Xi=Object.create(null);for(const ri of Jr){const ma=this.getToken(ri);ma&&(Xi[ri]=ma)}const Oi=rn.render({messages:rt,add_generation_prompt:yr,tools:Tt,documents:Ft,...Xi,...Ai});if(Vr){const ri=this._call(Oi,{add_special_tokens:!1,padding:en,truncation:Qr,max_length:Dr,return_tensor:Ln,...vi});return Ii?ri:ri.input_ids}return Oi}}class Ir extends Sr{constructor(){super(...arguments);_t(this,"return_token_type_ids",!0)}}class Xr extends Sr{constructor(){super(...arguments);_t(this,"return_token_type_ids",!0)}}class qr extends Sr{constructor(){super(...arguments);_t(this,"return_token_type_ids",!0)}}class An extends Sr{constructor(){super(...arguments);_t(this,"return_token_type_ids",!0)}}class ge extends Sr{constructor(){super(...arguments);_t(this,"return_token_type_ids",!0)}}class ut extends Sr{constructor(){super(...arguments);_t(this,"return_token_type_ids",!0)}}class We extends Sr{constructor(){super(...arguments);_t(this,"return_token_type_ids",!0)}}class Je extends Sr{constructor(){super(...arguments);_t(this,"return_token_type_ids",!0)}}class xt extends Sr{constructor(){super(...arguments);_t(this,"return_token_type_ids",!0)}}class wt extends Sr{}class pr extends Sr{}class Rr extends Sr{constructor(rt,Tt){super(rt,Tt);_t(this,"return_token_type_ids",!0);console.warn('WARNING: `XLMTokenizer` is not yet supported by Hugging Face\'s "fast" tokenizers library. Therefore, you may experience slightly inaccurate results.')}}class On extends Sr{constructor(){super(...arguments);_t(this,"return_token_type_ids",!0)}}class Mn extends Sr{}class _r extends Sr{}class Or extends Sr{}class an extends Sr{constructor(Ie,rt){super(Ie,rt),this.languageRegex=/^[a-z]{2}_[A-Z]{2}$/,this.language_codes=this.special_tokens.filter(Tt=>this.languageRegex.test(Tt)),this.lang_to_token=Tt=>Tt}_build_translation_inputs(Ie,rt,Tt){return la(this,Ie,rt,Tt)}}class Vn extends an{}class _o extends Sr{}class Uo extends Sr{}const yn="▁";class Vo extends Sr{constructor(rt,Tt){super(rt,Tt);_t(this,"padding_side","left");this.legacy=Tt.legacy??!0,this.legacy||(this.normalizer=null,this.pre_tokenizer=new dt({replacement:yn,add_prefix_space:!0,prepend_scheme:"first"}))}_encode_text(rt){if(rt===null)return null;if(this.legacy||rt.length===0)return super._encode_text(rt);let Tt=super._encode_text(yn+rt.replaceAll(yn," "));return Tt.length>1&&Tt[0]===yn&&this.special_tokens.includes(Tt[1])&&(Tt=Tt.slice(1)),Tt}}class Po extends Sr{}class pa extends Sr{}class ta extends Sr{}class ra extends Sr{}class so extends Sr{}class Xs extends Sr{}class xo extends Sr{}class Qn extends Sr{}class is extends Sr{}function la(Yt,Ie,rt,Tt){if(!("language_codes"in Yt)||!Array.isArray(Yt.language_codes))throw new Error("Tokenizer must have `language_codes` attribute set and it should be an array of language ids.");if(!("languageRegex"in Yt)||!(Yt.languageRegex instanceof RegExp))throw new Error("Tokenizer must have `languageRegex` attribute set and it should be a regular expression.");if(!("lang_to_token"in Yt)||typeof Yt.lang_to_token!="function")throw new Error("Tokenizer must have `lang_to_token` attribute set and it should be a function.");const Ft=Tt.src_lang,Dt=Tt.tgt_lang;if(!Yt.language_codes.includes(Dt))throw new Error(`Target language code "${Dt}" is not valid. Must be one of: {${Yt.language_codes.join(", ")}}`);if(Ft!==void 0){if(!Yt.language_codes.includes(Ft))throw new Error(`Source language code "${Ft}" is not valid. Must be one of: {${Yt.language_codes.join(", ")}}`);for(const yr of Yt.post_processor.config.single)if("SpecialToken"in yr&&Yt.languageRegex.test(yr.SpecialToken.id)){yr.SpecialToken.id=Yt.lang_to_token(Ft);break}}return Tt.forced_bos_token_id=Yt.model.convert_tokens_to_ids([Yt.lang_to_token(Dt)])[0],Yt._call(Ie,rt)}class $s extends Sr{constructor(Ie,rt){super(Ie,rt),this.languageRegex=/^[a-z]{3}_[A-Z][a-z]{3}$/,this.language_codes=this.special_tokens.filter(Tt=>this.languageRegex.test(Tt)),this.lang_to_token=Tt=>Tt}_build_translation_inputs(Ie,rt,Tt){return la(this,Ie,rt,Tt)}}class wo extends Sr{constructor(Ie,rt){super(Ie,rt),this.languageRegex=/^__[a-z]{2,3}__$/,this.language_codes=this.special_tokens.filter(Tt=>this.languageRegex.test(Tt)).map(Tt=>Tt.slice(2,-2)),this.lang_to_token=Tt=>`__${Tt}__`}_build_translation_inputs(Ie,rt,Tt){return la(this,Ie,rt,Tt)}}class Eo extends Sr{get timestamp_begin(){return this.model.convert_tokens_to_ids(["<|notimestamps|>"])[0]+1}_decode_asr(Ie,{return_timestamps:rt=!1,return_language:Tt=!1,time_precision:Ft=null,force_full_sequences:Dt=!0}={}){if(Ft===null)throw Error("Must specify time_precision");let yr=null;const Vr=rt==="word";function en(){return{language:yr,timestamp:[null,null],text:""}}const Qr=[];let Dr=en(),Ln=0;const Ii=this.timestamp_begin,Ai=Ii+1500;let rn=[],Xi=[],Oi=!1,ri=null;const ma=new Set(this.all_special_ids);for(const Mi of Ie){const di=Mi.tokens,Ho=Vr?Mi.token_timestamps:null;let bn=null,Nn=Ii;if("stride"in Mi){const[Yi,Qi,co]=Mi.stride;if(Ln-=Qi,ri=Yi-co,Qi&&(Nn=Qi/Ft+Ii),co)for(let po=di.length-1;po>=0;--po){const ga=Number(di[po]);if(ga>=Ii){if(bn!==null&&(ga-Ii)*Ft<ri)break;bn=ga}}}let Mo=[],ni=[];for(let Yi=0;Yi<di.length;++Yi){const Qi=Number(di[Yi]);if(ma.has(Qi)){const co=this.decode([Qi]),po=m.WHISPER_LANGUAGE_MAPPING.get(co.slice(2,-2));if(po!==void 0){if(yr!==null&&po!==yr&&!rt){rn.push(Mo);const ga=this.findLongestCommonSequence(rn)[0],ws=this.decode(ga);Dr.text=ws,Qr.push(Dr),rn=[],Mo=[],Dr=en()}yr=Dr.language=po}}else if(Qi>=Ii&&Qi<=Ai){const co=(Qi-Ii)*Ft+Ln,po=(0,s.round)(co,2);if(bn!==null&&Qi>=bn)Oi=!0;else if(Oi||rn.length>0&&Qi<Nn)Oi=!1;else if(Dr.timestamp[0]===null)Dr.timestamp[0]=po;else if(po!==Dr.timestamp[0]){Dr.timestamp[1]=po,rn.push(Mo),Vr&&Xi.push(ni);const[ga,ws]=this.findLongestCommonSequence(rn,Xi),hl=this.decode(ga);Dr.text=hl,Vr&&(Dr.words=this.collateWordTimestamps(ga,ws,yr)),Qr.push(Dr),rn=[],Mo=[],Xi=[],ni=[],Dr=en()}}else if(Mo.push(Qi),Vr){let co=(0,s.round)(Ho[Yi]+Ln,2),po;if(Yi+1<Ho.length){po=(0,s.round)(Ho[Yi+1]+Ln,2);const ga=this.decode([Qi]);j.test(ga)&&(po=(0,s.round)(Math.min(co+Ft,po),2))}else po=null;ni.push([co,po])}}if("stride"in Mi){const[Yi,Qi,co]=Mi.stride;Ln+=Yi-co}Mo.length>0?(rn.push(Mo),Vr&&Xi.push(ni)):rn.every(Yi=>Yi.length===0)&&(Dr=en(),rn=[],Mo=[],Xi=[],ni=[])}if(rn.length>0){if(Dt&&rt)throw new Error("Whisper did not predict an ending timestamp, which can happen if audio is cut off in the middle of a word. Also make sure WhisperTimeStampLogitsProcessor was used during generation.");const[Mi,di]=this.findLongestCommonSequence(rn,Xi),Ho=this.decode(Mi);Dr.text=Ho,Vr&&(Dr.words=this.collateWordTimestamps(Mi,di,yr)),Qr.push(Dr)}let Ri=Object.create(null);const lo=Qr.map(Mi=>Mi.text).join("");if(rt||Tt){for(let Mi=0;Mi<Qr.length;++Mi){const di=Qr[Mi];rt||delete di.timestamp,Tt||delete di.language}if(Vr){const Mi=[];for(const di of Qr)for(const Ho of di.words)Mi.push(Ho);Ri={chunks:Mi}}else Ri={chunks:Qr}}return[lo,Ri]}findLongestCommonSequence(Ie,rt=null){let Tt=Ie[0],Ft=Tt.length,Dt=[];const yr=Array.isArray(rt)&&rt.length>0;let Vr=yr?[]:null,en=yr?rt[0]:null;for(let Qr=1;Qr<Ie.length;++Qr){const Dr=Ie[Qr];let Ln=0,Ii=[Ft,Ft,0,0];const vi=Dr.length;for(let Ri=1;Ri<Ft+vi;++Ri){const lo=Math.max(0,Ft-Ri),Mi=Math.min(Ft,Ft+vi-Ri),di=Tt.slice(lo,Mi),Ho=Math.max(0,Ri-Ft),bn=Math.min(vi,Ri),Nn=Dr.slice(Ho,bn);if(di.length!==Nn.length)throw new Error("There is a bug within whisper `decode_asr` function, please report it. Dropping to prevent bad inference.");let Mo;yr?Mo=di.filter((Qi,co)=>Qi===Nn[co]&&en[lo+co]<=rt[Qr][Ho+co]).length:Mo=di.filter((Qi,co)=>Qi===Nn[co]).length;const ni=Ri/1e4,Yi=Mo/Ri+ni;Mo>1&&Yi>Ln&&(Ln=Yi,Ii=[lo,Mi,Ho,bn])}const[Ai,rn,Xi,Oi]=Ii,ri=Math.floor((rn+Ai)/2),ma=Math.floor((Oi+Xi)/2);Dt.push(...Tt.slice(0,ri)),Tt=Dr.slice(ma),Ft=Tt.length,yr&&(Vr.push(...en.slice(0,ri)),en=rt[Qr].slice(ma))}return Dt.push(...Tt),yr?(Vr.push(...en),[Dt,Vr]):[Dt,[]]}collateWordTimestamps(Ie,rt,Tt){const[Ft,Dt,yr]=this.combineTokensIntoWords(Ie,Tt),Vr=[];for(let en=0;en<Ft.length;++en){const Qr=yr[en];Vr.push({text:Ft[en],timestamp:[rt[Qr.at(0)][0],rt[Qr.at(-1)][1]]})}return Vr}combineTokensIntoWords(Ie,rt,Tt=`"'“¡¿([{-`,Ft=`"'.。,，!！?？:：”)]}、`){rt=rt??"english";let Dt,yr,Vr;return["chinese","japanese","thai","lao","myanmar"].includes(rt)?[Dt,yr,Vr]=this.splitTokensOnUnicode(Ie):[Dt,yr,Vr]=this.splitTokensOnSpaces(Ie),this.mergePunctuations(Dt,yr,Vr,Tt,Ft)}decode(Ie,rt){let Tt;return rt!=null&&rt.decode_with_timestamps?(Ie instanceof a.Tensor&&(Ie=x(Ie)),Tt=this.decodeWithTimestamps(Ie,rt)):Tt=super.decode(Ie,rt),Tt}decodeWithTimestamps(Ie,rt){const Tt=(rt==null?void 0:rt.time_precision)??.02,Ft=Array.from(this.all_special_ids).at(-1)+1;let Dt=[[]];for(let yr of Ie)if(yr=Number(yr),yr>=Ft){const Vr=((yr-Ft)*Tt).toFixed(2);Dt.push(`<|${Vr}|>`),Dt.push([])}else Dt[Dt.length-1].push(yr);return Dt=Dt.map(yr=>typeof yr=="string"?yr:super.decode(yr,rt)),Dt.join("")}splitTokensOnUnicode(Ie){const rt=this.decode(Ie,{decode_with_timestamps:!0}),Tt="�",Ft=[],Dt=[],yr=[];let Vr=[],en=[],Qr=0;for(let Dr=0;Dr<Ie.length;++Dr){const Ln=Ie[Dr];Vr.push(Ln),en.push(Dr);const Ii=this.decode(Vr,{decode_with_timestamps:!0});(!Ii.includes(Tt)||rt[Qr+Ii.indexOf(Tt)]===Tt)&&(Ft.push(Ii),Dt.push(Vr),yr.push(en),Vr=[],en=[],Qr+=Ii.length)}return[Ft,Dt,yr]}splitTokensOnSpaces(Ie){const[rt,Tt,Ft]=this.splitTokensOnUnicode(Ie),Dt=[],yr=[],Vr=[],en=new RegExp(`^[${N}]$`,"gu");for(let Qr=0;Qr<rt.length;++Qr){const Dr=rt[Qr],Ln=Tt[Qr],Ii=Ft[Qr],vi=Ln[0]>=this.model.tokens_to_ids.get("<|endoftext|>"),Ai=Dr.startsWith(" "),rn=Dr.trim(),Xi=en.test(rn);if(vi||Ai||Xi||Dt.length===0)Dt.push(Dr),yr.push(Ln),Vr.push(Ii);else{const Oi=Dt.length-1;Dt[Oi]+=Dr,yr[Oi].push(...Ln),Vr[Oi].push(...Ii)}}return[Dt,yr,Vr]}mergePunctuations(Ie,rt,Tt,Ft,Dt){const yr=structuredClone(Ie),Vr=structuredClone(rt),en=structuredClone(Tt);let Qr=yr.length-2,Dr=yr.length-1;for(;Qr>=0;)yr[Qr].startsWith(" ")&&Ft.includes(yr[Qr].trim())?(yr[Dr]=yr[Qr]+yr[Dr],Vr[Dr]=(0,i.mergeArrays)(Vr[Qr],Vr[Dr]),en[Dr]=(0,i.mergeArrays)(en[Qr],en[Dr]),yr[Qr]="",Vr[Qr]=[],en[Qr]=[]):Dr=Qr,--Qr;for(Qr=0,Dr=1;Dr<yr.length;)!yr[Qr].endsWith(" ")&&Dt.includes(yr[Dr])?(yr[Qr]+=yr[Dr],Vr[Qr]=(0,i.mergeArrays)(Vr[Qr],Vr[Dr]),en[Qr]=(0,i.mergeArrays)(en[Qr],en[Dr]),yr[Dr]="",Vr[Dr]=[],en[Dr]=[]):Qr=Dr,++Dr;return[yr.filter(Ln=>Ln),Vr.filter(Ln=>Ln.length>0),en.filter(Ln=>Ln.length>0)]}}class Wa extends Sr{}class ul extends Sr{}class os extends Sr{}class Pr extends Sr{constructor(Ie,rt){super(Ie,rt),this.languageRegex=/^(>>\w+<<)\s*/g,this.supported_language_codes=this.model.vocab.filter(Tt=>this.languageRegex.test(Tt)),console.warn('WARNING: `MarianTokenizer` is not yet supported by Hugging Face\'s "fast" tokenizers library. Therefore, you may experience slightly inaccurate results.')}_encode_text(Ie){if(Ie===null)return null;const[rt,...Tt]=Ie.trim().split(this.languageRegex);if(Tt.length===0)return super._encode_text(rt);if(Tt.length===2){const[Ft,Dt]=Tt;return this.supported_language_codes.includes(Ft)||console.warn(`Unsupported language code "${Ft}" detected, which may lead to unexpected behavior. Should be one of: ${JSON.stringify(this.supported_language_codes)}`),(0,i.mergeArrays)([Ft],super._encode_text(Dt))}}}class Hr extends Sr{}class gn extends Sr{}class Zi extends Sr{}class dl extends Sr{}class ba extends Sr{}class Ga extends Sr{constructor(Ie,rt){super(Ie,rt),this.decoder=new Qe({})}}class yo extends Sr{}class Xl extends Sr{}class Dl extends Sr{}class Uc{static async from_pretrained(Ie,{progress_callback:rt=null,config:Tt=null,cache_dir:Ft=null,local_files_only:Dt=!1,revision:yr="main",legacy:Vr=null}={}){var Ii;const[en,Qr]=await g(Ie,{progress_callback:rt,config:Tt,cache_dir:Ft,local_files_only:Dt,revision:yr,legacy:Vr}),Dr=((Ii=Qr.tokenizer_class)==null?void 0:Ii.replace(/Fast$/,""))??"PreTrainedTokenizer";let Ln=this.TOKENIZER_CLASS_MAPPING[Dr];return Ln||(console.warn(`Unknown tokenizer class "${Dr}", attempting to construct from base class.`),Ln=Sr),new Ln(en,Qr)}}_t(Uc,"TOKENIZER_CLASS_MAPPING",{T5Tokenizer:Mn,DistilBertTokenizer:wt,CamembertTokenizer:pr,DebertaTokenizer:ge,DebertaV2Tokenizer:ut,BertTokenizer:Ir,HerbertTokenizer:We,ConvBertTokenizer:Je,RoFormerTokenizer:xt,XLMTokenizer:Rr,ElectraTokenizer:On,MobileBertTokenizer:qr,SqueezeBertTokenizer:An,AlbertTokenizer:Xr,GPT2Tokenizer:_r,BartTokenizer:Or,MBartTokenizer:an,MBart50Tokenizer:Vn,RobertaTokenizer:_o,WhisperTokenizer:Eo,CodeGenTokenizer:Wa,CLIPTokenizer:ul,SiglipTokenizer:os,MarianTokenizer:Pr,BloomTokenizer:Uo,NllbTokenizer:$s,M2M100Tokenizer:wo,LlamaTokenizer:Vo,CodeLlamaTokenizer:Po,XLMRobertaTokenizer:pa,MPNetTokenizer:ta,FalconTokenizer:ra,GPTNeoXTokenizer:so,EsmTokenizer:Xs,Wav2Vec2CTCTokenizer:Hr,BlenderbotTokenizer:gn,BlenderbotSmallTokenizer:Zi,SpeechT5Tokenizer:dl,NougatTokenizer:ba,VitsTokenizer:Ga,Qwen2Tokenizer:xo,GemmaTokenizer:Qn,Grok1Tokenizer:is,CohereTokenizer:yo,MgpstrTokenizer:Xl,Ernie4_5_Tokenizer:Dl,PreTrainedTokenizer:Sr})},"./src/utils/audio.js":(e,t,r)=>{r.r(t),r.d(t,{RawAudio:()=>X,hamming:()=>_,hanning:()=>g,mel_filter_bank:()=>C,read_audio:()=>d,spectrogram:()=>$,window_function:()=>U});var n=r("./src/utils/hub.js"),i=r("./src/utils/maths.js"),o=r("./src/utils/core.js"),s=r("./src/env.js"),a=r("./src/utils/tensor.js"),u=r("?7992");async function d(ee,ae){if(typeof AudioContext>"u")throw Error("Unable to load audio from path/URL since `AudioContext` is not available in your environment. Instead, audio data should be passed directly to the pipeline/processor. For more information and some example code, see https://huggingface.co/docs/transformers.js/guides/node-audio-processing.");const de=await(await(0,n.getFile)(ee)).arrayBuffer(),ye=new AudioContext({sampleRate:ae});typeof ae>"u"&&console.warn(`No sampling rate provided, using default of ${ye.sampleRate}Hz.`);const _e=await ye.decodeAudioData(de);let ue;if(_e.numberOfChannels===2){const fe=Math.sqrt(2),De=_e.getChannelData(0),pe=_e.getChannelData(1);ue=new Float32Array(De.length);for(let K=0;K<_e.length;++K)ue[K]=fe*(De[K]+pe[K])/2}else ue=_e.getChannelData(0);return ue}function m(ee,ae){if(ee<1)return new Float64Array;if(ee===1)return new Float64Array([1]);const de=1-ae,ye=2*Math.PI/(ee-1),_e=new Float64Array(ee);for(let ue=0;ue<ee;++ue)_e[ue]=ae-de*Math.cos(ue*ye);return _e}function g(ee){return m(ee,.5)}function _(ee){return m(ee,.54)}const y={htk:ee=>2595*Math.log10(1+ee/700),kaldi:ee=>1127*Math.log(1+ee/700),slaney:(ee,ae=1e3,de=15,ye=27/Math.log(6.4))=>ee>=ae?de+Math.log(ee/ae)*ye:3*ee/200};function M(ee,ae="htk"){const de=y[ae];if(!de)throw new Error('mel_scale should be one of "htk", "slaney" or "kaldi".');return typeof ee=="number"?de(ee):ee.map(ye=>de(ye))}const x={htk:ee=>700*(10**(ee/2595)-1),kaldi:ee=>700*(Math.exp(ee/1127)-1),slaney:(ee,ae=1e3,de=15,ye=Math.log(6.4)/27)=>ee>=de?ae*Math.exp(ye*(ee-de)):200*ee/3};function E(ee,ae="htk"){const de=x[ae];if(!de)throw new Error('mel_scale should be one of "htk", "slaney" or "kaldi".');return typeof ee=="number"?de(ee):ee.map(ye=>de(ye))}function T(ee,ae){const de=Float64Array.from({length:ae.length-1},(fe,De)=>ae[De+1]-ae[De]),ye=Array.from({length:ee.length},()=>new Array(ae.length));for(let fe=0;fe<ee.length;++fe){const De=ye[fe];for(let pe=0;pe<ae.length;++pe)De[pe]=ae[pe]-ee[fe]}const _e=ae.length-2,ue=Array.from({length:_e},()=>new Array(ee.length));for(let fe=0;fe<ee.length;++fe){const De=ye[fe];for(let pe=0;pe<_e;++pe){const K=-De[pe]/de[pe],te=De[pe+2]/de[pe+1];ue[pe][fe]=Math.max(0,Math.min(K,te))}}return ue}function P(ee,ae,de){const ye=(ae-ee)/(de-1);return Float64Array.from({length:de},(_e,ue)=>ee+ye*ue)}function C(ee,ae,de,ye,_e,ue=null,fe="htk",De=!1){if(ue!==null&&ue!=="slaney")throw new Error('norm must be one of null or "slaney"');if(ee<2)throw new Error(`Require num_frequency_bins: ${ee} >= 2`);if(de>ye)throw new Error(`Require min_frequency: ${de} <= max_frequency: ${ye}`);const pe=M(de,fe),K=M(ye,fe),te=P(pe,K,ae+2);let ve=E(te,fe),$e;if(De){const Ge=_e/((ee-1)*2);$e=M(Float64Array.from({length:ee},(ot,Ye)=>Ye*Ge),fe),ve=te}else $e=P(0,Math.floor(_e/2),ee);const Ce=T($e,ve);if(ue!==null&&ue==="slaney")for(let Ge=0;Ge<ae;++Ge){const ot=Ce[Ge],Ye=2/(ve[Ge+2]-ve[Ge]);for(let et=0;et<ee;++et)ot[et]*=Ye}return Ce}function D(ee,ae,de){const ye=new ee.constructor(ee.length+ae+de),_e=ee.length-1;for(let ue=0;ue<ee.length;++ue)ye[ae+ue]=ee[ue];for(let ue=1;ue<=ae;++ue)ye[ae-ue]=ee[(0,o.calculateReflectOffset)(ue,_e)];for(let ue=1;ue<=de;++ue)ye[_e+ae+ue]=ee[(0,o.calculateReflectOffset)(_e-ue,_e)];return ye}function L(ee,ae,de,ye,_e){if(de<=0)throw new Error("reference must be greater than zero");if(ye<=0)throw new Error("min_value must be greater than zero");de=Math.max(ye,de);const ue=Math.log10(de);for(let fe=0;fe<ee.length;++fe)ee[fe]=ae*Math.log10(Math.max(ye,ee[fe])-ue);if(_e!==null){if(_e<=0)throw new Error("db_range must be greater than zero");const fe=(0,i.max)(ee)[0]-_e;for(let De=0;De<ee.length;++De)ee[De]=Math.max(ee[De],fe)}return ee}function N(ee,ae=1,de=1e-5,ye=null){return L(ee,20,ae,de,ye)}function j(ee,ae=1,de=1e-10,ye=null){return L(ee,10,ae,de,ye)}async function $(ee,ae,de,ye,{fft_length:_e=null,power:ue=1,center:fe=!0,pad_mode:De="reflect",onesided:pe=!0,preemphasis:K=null,preemphasis_htk_flavor:te=!0,mel_filters:ve=null,mel_floor:$e=1e-10,log_mel:Ce=null,reference:Ge=1,min_value:ot=1e-10,db_range:Ye=null,remove_dc_offset:et=null,min_num_frames:Te=null,max_num_frames:Le=null,do_pad:ke=!0,transpose:Xe=!1}={}){const Ne=ae.length;if(_e===null&&(_e=de),de>_e)throw Error(`frame_length (${de}) may not be larger than fft_length (${_e})`);if(Ne!==de)throw new Error(`Length of the window (${Ne}) must equal frame_length (${de})`);if(ye<=0)throw new Error("hop_length must be greater than zero");if(ue===null&&ve!==null)throw new Error("You have provided `mel_filters` but `power` is `None`. Mel spectrogram computation is not yet supported for complex-valued spectrogram. Specify `power` to fix this issue.");if(!te)throw new Error("`preemphasis_htk_flavor=false` is not currently supported.");if(fe){if(De!=="reflect")throw new Error(`pad_mode="${De}" not implemented yet.`);const xr=Math.floor((_e-1)/2)+1;ee=D(ee,xr,xr)}let Ot=Math.floor(1+Math.floor((ee.length-de)/ye));Te!==null&&Ot<Te&&(Ot=Te);const Lt=pe?Math.floor(_e/2)+1:_e;let kt=Ot,mt=Ot;Le!==null&&(Le>Ot?ke&&(mt=Le):mt=kt=Le);const Zt=new i.FFT(_e),Kt=new Float64Array(_e),dr=new Float64Array(Zt.outputBufferSize),Bt=new Float32Array(Lt*mt);for(let xr=0;xr<kt;++xr){const or=xr*ye,tt=Math.min(ee.length-or,de);tt!==de&&Kt.fill(0,0,de);for(let Se=0;Se<tt;++Se)Kt[Se]=ee[or+Se];if(et){let Se=0;for(let Ve=0;Ve<tt;++Ve)Se+=Kt[Ve];const Pe=Se/tt;for(let Ve=0;Ve<tt;++Ve)Kt[Ve]-=Pe}if(K!==null){for(let Se=tt-1;Se>=1;--Se)Kt[Se]-=K*Kt[Se-1];Kt[0]*=1-K}for(let Se=0;Se<ae.length;++Se)Kt[Se]*=ae[Se];Zt.realTransform(dr,Kt);for(let Se=0;Se<Lt;++Se){const Pe=Se<<1;Bt[Se*mt+xr]=dr[Pe]**2+dr[Pe+1]**2}}if(ue!==null&&ue!==2){const xr=ue/2;for(let or=0;or<Bt.length;++or)Bt[or]**=xr}const wr=ve.length;let mr=await(0,a.matmul)(new a.Tensor("float32",ve.flat(),[wr,Lt]),new a.Tensor("float32",Bt,[Lt,mt]));Xe&&(mr=mr.transpose(1,0));const hr=mr.data;for(let xr=0;xr<hr.length;++xr)hr[xr]=Math.max($e,hr[xr]);if(ue!==null&&Ce!==null){const xr=Math.min(hr.length,kt*wr);switch(Ce){case"log":for(let or=0;or<xr;++or)hr[or]=Math.log(hr[or]);break;case"log10":for(let or=0;or<xr;++or)hr[or]=Math.log10(hr[or]);break;case"dB":if(ue===1)N(hr,Ge,ot,Ye);else if(ue===2)j(hr,Ge,ot,Ye);else throw new Error(`Cannot use log_mel option '${Ce}' with power ${ue}`);break;default:throw new Error(`log_mel must be one of null, 'log', 'log10' or 'dB'. Got '${Ce}'`)}}return mr}function U(ee,ae,{periodic:de=!0,frame_length:ye=null,center:_e=!0}={}){const ue=de?ee+1:ee;let fe;switch(ae){case"boxcar":fe=new Float64Array(ue).fill(1);break;case"hann":case"hann_window":fe=g(ue);break;case"hamming":fe=_(ue);break;case"povey":fe=g(ue).map(De=>Math.pow(De,.85));break;default:throw new Error(`Unknown window type ${ae}.`)}if(de&&(fe=fe.subarray(0,ee)),ye===null)return fe;if(ee>ye)throw new Error(`Length of the window (${ee}) may not be larger than frame_length (${ye})`);return fe}function G(ee,ae){let de=44;const ye=new ArrayBuffer(de+ee.length*4),_e=new DataView(ye);H(_e,0,"RIFF"),_e.setUint32(4,36+ee.length*4,!0),H(_e,8,"WAVE"),H(_e,12,"fmt "),_e.setUint32(16,16,!0),_e.setUint16(20,3,!0),_e.setUint16(22,1,!0),_e.setUint32(24,ae,!0),_e.setUint32(28,ae*4,!0),_e.setUint16(32,4,!0),_e.setUint16(34,32,!0),H(_e,36,"data"),_e.setUint32(40,ee.length*4,!0);for(let ue=0;ue<ee.length;++ue,de+=4)_e.setFloat32(de,ee[ue],!0);return ye}function H(ee,ae,de){for(let ye=0;ye<de.length;++ye)ee.setUint8(ae+ye,de.charCodeAt(ye))}class X{constructor(ae,de){this.audio=ae,this.sampling_rate=de}toWav(){return G(this.audio,this.sampling_rate)}toBlob(){const ae=this.toWav();return new Blob([ae],{type:"audio/wav"})}async save(ae){let de;if(s.apis.IS_BROWSER_ENV){if(s.apis.IS_WEBWORKER_ENV)throw new Error("Unable to save a file from a Web Worker.");de=o.saveBlob}else if(s.apis.IS_FS_AVAILABLE)de=async(ye,_e)=>{let ue=await _e.arrayBuffer();u.writeFileSync(ye,Buffer.from(ue))};else throw new Error("Unable to save because filesystem is disabled in this environment.");await de(ae,this.toBlob())}}},"./src/utils/constants.js":(e,t,r)=>{r.r(t),r.d(t,{CHAT_TEMPLATE_NAME:()=>u,CONFIG_NAME:()=>i,FEATURE_EXTRACTOR_NAME:()=>o,GENERATION_CONFIG_NAME:()=>d,GITHUB_ISSUE_URL:()=>n,IMAGE_PROCESSOR_NAME:()=>s,PROCESSOR_NAME:()=>a});const n="https://github.com/huggingface/transformers.js/issues/new/choose",i="config.json",o="preprocessor_config.json",s=o,a="processor_config.json",u="chat_template.jinja",d="generation_config.json"},"./src/utils/core.js":(e,t,r)=>{r.r(t),r.d(t,{calculateDimensions:()=>d,calculateReflectOffset:()=>y,count:()=>T,dispatchCallback:()=>n,escapeRegExp:()=>o,isIntegralNumber:()=>a,isNullishDimension:()=>u,isTypedArray:()=>s,len:()=>E,mergeArrays:()=>g,pick:()=>x,pop:()=>m,product:()=>_,reverseDictionary:()=>i,saveBlob:()=>M});function n(P,C){P&&P(C)}function i(P){return Object.fromEntries(Object.entries(P).map(([C,D])=>[D,C]))}function o(P){return P.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function s(P){var C,D,L;return((L=(D=(C=P==null?void 0:P.prototype)==null?void 0:C.__proto__)==null?void 0:D.constructor)==null?void 0:L.name)==="TypedArray"}function a(P){return Number.isInteger(P)||typeof P=="bigint"}function u(P){return P==null||P===-1}function d(P){const C=[];let D=P;for(;Array.isArray(D);)C.push(D.length),D=D[0];return C}function m(P,C,D=void 0){const L=P[C];if(L!==void 0)return delete P[C],L;if(D===void 0)throw Error(`Key ${C} does not exist in object.`);return D}function g(...P){return Array.prototype.concat.apply([],P)}function _(...P){return P.reduce((C,D)=>C.flatMap(L=>D.map(N=>[L,N])))}function y(P,C){return Math.abs((P+C)%(2*C)-C)}function M(P,C){const D=URL.createObjectURL(C),L=document.createElement("a");L.href=D,L.download=P,L.click(),L.remove(),URL.revokeObjectURL(D)}function x(P,C){return Object.assign({},...C.map(D=>{if(P[D]!==void 0)return{[D]:P[D]}}))}function E(P){let C=0;for(const D of P)++C;return C}function T(P,C){let D=0;for(const L of P)L===C&&++D;return D}},"./src/utils/data-structures.js":(e,t,r)=>{r.r(t),r.d(t,{CharTrie:()=>i,DictionarySplitter:()=>u,LRUCache:()=>d,PriorityQueue:()=>n,TokenLattice:()=>s});class n{constructor(g=(y,M)=>y>M,_=1/0){this._heap=[],this._comparator=g,this._maxSize=_}get size(){return this._heap.length}isEmpty(){return this.size===0}peek(){return this._heap[0]}push(...g){return this.extend(g)}extend(g){for(const _ of g)if(this.size<this._maxSize)this._heap.push(_),this._siftUp();else{const y=this._smallest();this._comparator(_,this._heap[y])&&(this._heap[y]=_,this._siftUpFrom(y))}return this.size}pop(){const g=this.peek(),_=this.size-1;return _>0&&this._swap(0,_),this._heap.pop(),this._siftDown(),g}replace(g){const _=this.peek();return this._heap[0]=g,this._siftDown(),_}_parent(g){return(g+1>>>1)-1}_left(g){return(g<<1)+1}_right(g){return g+1<<1}_greater(g,_){return this._comparator(this._heap[g],this._heap[_])}_swap(g,_){const y=this._heap[g];this._heap[g]=this._heap[_],this._heap[_]=y}_siftUp(){this._siftUpFrom(this.size-1)}_siftUpFrom(g){for(;g>0&&this._greater(g,this._parent(g));)this._swap(g,this._parent(g)),g=this._parent(g)}_siftDown(){let g=0;for(;this._left(g)<this.size&&this._greater(this._left(g),g)||this._right(g)<this.size&&this._greater(this._right(g),g);){const _=this._right(g)<this.size&&this._greater(this._right(g),this._left(g))?this._right(g):this._left(g);this._swap(g,_),g=_}}_smallest(){return 2**Math.floor(Math.log2(this.size))-1}}class i{constructor(){this.root=o.default()}extend(g){for(const _ of g)this.push(_)}push(g){let _=this.root;for(const y of g){let M=_.children.get(y);M===void 0&&(M=o.default(),_.children.set(y,M)),_=M}_.isLeaf=!0}*commonPrefixSearch(g){let _=this.root;if(_===void 0)return;let y="";for(const M of g){if(y+=M,_=_.children.get(M),_===void 0)return;_.isLeaf&&(yield y)}}}class o{constructor(g,_){this.isLeaf=g,this.children=_}static default(){return new o(!1,new Map)}}class s{constructor(g,_,y){this.chars=Array.from(g),this.len=this.chars.length,this.bosTokenId=_,this.eosTokenId=y,this.nodes=[],this.beginNodes=Array.from({length:this.len+1},()=>[]),this.endNodes=Array.from({length:this.len+1},()=>[]);const M=new a(this.bosTokenId,0,0,0,0),x=new a(this.eosTokenId,1,this.len,0,0);this.nodes.push(M.clone()),this.nodes.push(x.clone()),this.beginNodes[this.len].push(x),this.endNodes[0].push(M)}insert(g,_,y,M){const x=this.nodes.length,E=new a(M,x,g,_,y);this.beginNodes[g].push(E),this.endNodes[g+_].push(E),this.nodes.push(E)}viterbi(){const g=this.len;let _=0;for(;_<=g;){if(this.beginNodes[_].length==0)return[];for(let T of this.beginNodes[_]){T.prev=null;let P=0,C=null;for(let D of this.endNodes[_]){const L=D.backtraceScore+T.score;(C===null||L>P)&&(C=D.clone(),P=L)}if(C!==null)T.prev=C,T.backtraceScore=P;else return[]}++_}const y=[],x=this.beginNodes[g][0].prev;if(x===null)return[];let E=x.clone();for(;E.prev!==null;)y.push(E.clone()),E=E.clone().prev.clone();return y.reverse(),y}piece(g){return this.chars.slice(g.pos,g.pos+g.length).join("")}tokens(){return this.viterbi().map(_=>this.piece(_))}tokenIds(){return this.viterbi().map(_=>_.tokenId)}}class a{constructor(g,_,y,M,x){this.tokenId=g,this.nodeId=_,this.pos=y,this.length=M,this.score=x,this.prev=null,this.backtraceScore=0}clone(){const g=new a(this.tokenId,this.nodeId,this.pos,this.length,this.score);return g.prev=this.prev,g.backtraceScore=this.backtraceScore,g}}class u{constructor(g){this.trie=this._buildTrie(g)}_buildTrie(g){var y;const _=Object.create(null);for(const M of g){let x=_;for(let E=0;E<M.length;++E)x=x[y=M[E]]??(x[y]=Object.create(null));x.end=M}return _}split(g){const _=[],y=g.length;let M=0,x=0;for(;x<y;){let E=this.trie,T=null,P=x;for(;P<y&&(E=E[g[P]]);)E.end&&(T=E.end),++P;T?(x>M&&_.push(g.slice(M,x)),_.push(T),x+=T.length,M=x):++x}return M<y&&_.push(g.slice(M)),_}}class d{constructor(g){this.capacity=g,this.cache=new Map}get(g){if(!this.cache.has(g))return;const _=this.cache.get(g);return this.cache.delete(g),this.cache.set(g,_),_}put(g,_){this.cache.has(g)&&this.cache.delete(g),this.cache.set(g,_),this.cache.size>this.capacity&&this.cache.delete(this.cache.keys().next().value)}clear(){this.cache.clear()}}},"./src/utils/devices.js":(e,t,r)=>{r.r(t),r.d(t,{DEVICE_TYPES:()=>n});const n=Object.freeze({auto:"auto",gpu:"gpu",cpu:"cpu",wasm:"wasm",webgpu:"webgpu",cuda:"cuda",dml:"dml",webnn:"webnn","webnn-npu":"webnn-npu","webnn-gpu":"webnn-gpu","webnn-cpu":"webnn-cpu"})},"./src/utils/dtypes.js":(e,t,r)=>{r.r(t),r.d(t,{DATA_TYPES:()=>s,DEFAULT_DEVICE_DTYPE_MAPPING:()=>a,DEFAULT_DTYPE_SUFFIX_MAPPING:()=>u,isWebGpuFp16Supported:()=>o});var n=r("./src/env.js"),i=r("./src/utils/devices.js");const o=function(){let d;return async function(){if(d===void 0)if(!n.apis.IS_WEBGPU_AVAILABLE)d=!1;else try{d=(await navigator.gpu.requestAdapter()).features.has("shader-f16")}catch{d=!1}return d}}(),s=Object.freeze({auto:"auto",fp32:"fp32",fp16:"fp16",q8:"q8",int8:"int8",uint8:"uint8",q4:"q4",bnb4:"bnb4",q4f16:"q4f16"}),a=Object.freeze({[i.DEVICE_TYPES.wasm]:s.q8}),u=Object.freeze({[s.fp32]:"",[s.fp16]:"_fp16",[s.int8]:"_int8",[s.uint8]:"_uint8",[s.q8]:"_quantized",[s.q4]:"_q4",[s.q4f16]:"_q4f16",[s.bnb4]:"_bnb4"})},"./src/utils/generic.js":(e,t,r)=>{r.r(t),r.d(t,{Callable:()=>n});const n=class{constructor(){let i=function(...o){return i._call(...o)};return Object.setPrototypeOf(i,new.target.prototype)}_call(...i){throw Error("Must implement _call method in subclass")}}},"./src/utils/hub.js":(e,t,r)=>{r.r(t),r.d(t,{MAX_EXTERNAL_DATA_CHUNKS:()=>a,getFile:()=>y,getModelFile:()=>P,getModelJSON:()=>D,getModelText:()=>C});var n=r("?7992"),i=r("?5af5"),o=r("./src/env.js"),s=r("./src/utils/core.js");const a=100,u={txt:"text/plain",html:"text/html",css:"text/css",js:"text/javascript",json:"application/json",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif"};class d{constructor($){if(this.filePath=$,this.headers=new Headers,this.exists=n.existsSync($),this.exists){this.status=200,this.statusText="OK";let U=n.statSync($);this.headers.set("content-length",U.size.toString()),this.updateContentType();const G=n.createReadStream($);this.body=new ReadableStream({start(H){G.on("data",X=>H.enqueue(X)),G.on("end",()=>H.close()),G.on("error",X=>H.error(X))},cancel(){G.destroy()}})}else this.status=404,this.statusText="Not Found",this.body=null}updateContentType(){const $=this.filePath.toString().split(".").pop().toLowerCase();this.headers.set("content-type",u[$]??"application/octet-stream")}clone(){let $=new d(this.filePath);return $.exists=this.exists,$.status=this.status,$.statusText=this.statusText,$.headers=new Headers(this.headers),$}async arrayBuffer(){return(await n.promises.readFile(this.filePath)).buffer}async blob(){const $=await n.promises.readFile(this.filePath);return new Blob([$],{type:this.headers.get("content-type")})}async text(){return await n.promises.readFile(this.filePath,"utf8")}async json(){return JSON.parse(await this.text())}}function m(j,$=null,U=null){let G;try{G=new URL(j)}catch{return!1}return!($&&!$.includes(G.protocol)||U&&!U.includes(G.hostname))}const g=/^(\b[\w\-.]+\b\/)?\b[\w\-.]{1,96}\b$/;function _(j){return!(!g.test(j)||j.includes("..")||j.includes("--")||j.endsWith(".git")||j.endsWith(".ipynb"))}async function y(j){var $;if(o.env.useFS&&!m(j,["http:","https:","blob:"]))return new d(j instanceof URL?j.protocol==="file:"?j.pathname:j.toString():j);if(typeof process<"u"&&(($=process==null?void 0:process.release)==null?void 0:$.name)==="node"){const U=!!(vm!=null&&vm.TESTING_REMOTELY),G=o.env.version,H=new Headers;if(H.set("User-Agent",`transformers.js/${G}; is_ci/${U};`),m(j,["http:","https:"],["huggingface.co","hf.co"])){const ee=(vm==null?void 0:vm.HF_TOKEN)??(vm==null?void 0:vm.HF_ACCESS_TOKEN);ee&&H.set("Authorization",`Bearer ${ee}`)}return fetch(j,{headers:H})}else return fetch(j)}const M={400:"Bad request error occurred while trying to load file",401:"Unauthorized access to file",403:"Forbidden access to file",404:"Could not locate file",408:"Request timeout error occurred while trying to load file",500:"Internal server error error occurred while trying to load file",502:"Bad gateway error occurred while trying to load file",503:"Service unavailable error occurred while trying to load file",504:"Gateway timeout error occurred while trying to load file"};function x(j,$,U){if(!U)return null;const G=M[j]??`Error (${j}) occurred while trying to load file`;throw Error(`${G}: "${$}".`)}class E{constructor($){this.path=$}async match($){let U=i.join(this.path,$),G=new d(U);if(G.exists)return G}async put($,U,G=void 0){let H=i.join(this.path,$);try{const X=U.headers.get("Content-Length"),ee=parseInt(X??"0");let ae=0;await n.promises.mkdir(i.dirname(H),{recursive:!0});const de=n.createWriteStream(H),ye=U.body.getReader();for(;;){const{done:_e,value:ue}=await ye.read();if(_e)break;await new Promise((De,pe)=>{de.write(ue,K=>{if(K){pe(K);return}De()})}),ae+=ue.length;const fe=ee?ae/ee*100:0;G==null||G({progress:fe,loaded:ae,total:ee})}de.close()}catch(X){try{await n.promises.unlink(H)}catch{}throw X}}}async function T(j,...$){for(let U of $)try{let G=await j.match(U);if(G)return G}catch{continue}}async function P(j,$,U=!0,G={},H=!1){if(!o.env.allowLocalModels){if(G.local_files_only)throw Error("Invalid configuration detected: local models are disabled (`env.allowLocalModels=false`) but you have requested to only use local models (`local_files_only=true`).");if(!o.env.allowRemoteModels)throw Error("Invalid configuration detected: both local and remote models are disabled. Fix by setting `env.allowLocalModels` or `env.allowRemoteModels` to `true`.")}(0,s.dispatchCallback)(G.progress_callback,{status:"initiate",name:j,file:$});let X;if(!X&&o.env.useCustomCache){if(!o.env.customCache)throw Error("`env.useCustomCache=true`, but `env.customCache` is not defined.");if(!o.env.customCache.match||!o.env.customCache.put)throw new Error("`env.customCache` must be an object which implements the `match` and `put` functions of the Web Cache API. For more information, see https://developer.mozilla.org/en-US/docs/Web/API/Cache");X=o.env.customCache}if(!X&&o.env.useBrowserCache){if(typeof caches>"u")throw Error("Browser cache is not available in this environment.");try{X=await caches.open("transformers-cache")}catch($e){console.warn("An error occurred while opening the browser cache:",$e)}}if(!X&&o.env.useFSCache){if(!o.apis.IS_FS_AVAILABLE)throw Error("File System Cache is not available in this environment.");X=new E(G.cache_dir??o.env.cacheDir)}const ee=G.revision??"main",ae=N(j,$),de=_(j),ye=de?N(o.env.localModelPath,ae):ae,_e=N(o.env.remoteHost,o.env.remotePathTemplate.replaceAll("{model}",j).replaceAll("{revision}",encodeURIComponent(ee)),$);let ue;const fe=X instanceof E?ee==="main"?ae:N(j,ee,$):_e;let De=!1,pe;X&&(pe=await T(X,ye,fe));const K=pe!==void 0;if(pe===void 0){if(o.env.allowLocalModels)if(m(ae,["http:","https:"])){if(G.local_files_only)throw new Error(`\`local_files_only=true\`, but attempted to load a remote file from: ${ae}.`);if(!o.env.allowRemoteModels)throw new Error(`\`env.allowRemoteModels=false\`, but attempted to load a remote file from: ${ae}.`)}else try{pe=await y(ye),ue=ye}catch(Ce){console.warn(`Unable to load from local path "${ye}": "${Ce}"`)}if(pe===void 0||pe.status===404){if(G.local_files_only||!o.env.allowRemoteModels){if(U)throw Error(`\`local_files_only=true\` or \`env.allowRemoteModels=false\` and file was not found locally at "${ye}".`);return null}if(!de)throw Error(`Local file missing at "${ye}" and download aborted due to invalid model ID "${j}".`);if(pe=await y(_e),pe.status!==200)return x(pe.status,_e,U);ue=fe}De=X&&typeof Response<"u"&&pe instanceof Response&&pe.status===200}(0,s.dispatchCallback)(G.progress_callback,{status:"download",name:j,file:$});let te;if(!(o.apis.IS_NODE_ENV&&H)){let $e;G.progress_callback?K&&typeof navigator<"u"&&/firefox/i.test(navigator.userAgent)?($e=new Uint8Array(await pe.arrayBuffer()),(0,s.dispatchCallback)(G.progress_callback,{status:"progress",name:j,file:$,progress:100,loaded:$e.length,total:$e.length})):$e=await L(pe,Ce=>{(0,s.dispatchCallback)(G.progress_callback,{status:"progress",name:j,file:$,...Ce})}):$e=new Uint8Array(await pe.arrayBuffer()),te=$e}if(De&&ue&&await X.match(ue)===void 0&&(te?await X.put(ue,new Response(te,{headers:pe.headers})).catch($e=>{console.warn(`Unable to add response to browser cache: ${$e}.`)}):await X.put(ue,pe,G.progress_callback)),(0,s.dispatchCallback)(G.progress_callback,{status:"done",name:j,file:$}),te){if(!o.apis.IS_NODE_ENV&&H)throw new Error("Cannot return path in a browser environment.");return te}if(pe instanceof d)return pe.filePath;const ve=await(X==null?void 0:X.match(ue));if(ve instanceof d)return ve.filePath;if(ve instanceof Response)return new Uint8Array(await ve.arrayBuffer());if(typeof ve=="string")return ve;throw new Error("Unable to get model file path or buffer.")}async function C(j,$,U=!0,G={}){const H=await P(j,$,U,G,!1);return H===null?null:new TextDecoder("utf-8").decode(H)}async function D(j,$,U=!0,G={}){const H=await C(j,$,U,G);return H===null?{}:JSON.parse(H)}async function L(j,$){const U=j.headers.get("Content-Length");U===null&&console.warn("Unable to determine content-length from response headers. Will expand buffer when needed.");let G=parseInt(U??"0"),H=new Uint8Array(G),X=0;const ee=j.body.getReader();async function ae(){const{done:de,value:ye}=await ee.read();if(de)return;const _e=X+ye.length;if(_e>G){G=_e;const fe=new Uint8Array(G);fe.set(H),H=fe}H.set(ye,X),X=_e;const ue=X/G*100;return $({progress:ue,loaded:X,total:G}),ae()}return await ae(),H}function N(...j){return j=j.map(($,U)=>(U&&($=$.replace(new RegExp("^/"),"")),U!==j.length-1&&($=$.replace(new RegExp("/$"),"")),$)),j.join("/")}},"./src/utils/image.js":(e,t,r)=>{r.r(t),r.d(t,{RawImage:()=>M,load_image:()=>x});var n=r("./src/utils/core.js"),i=r("./src/utils/hub.js"),o=r("./src/env.js"),s=r("./src/utils/tensor.js"),a=r("?2b25");let u,d,m;const g=o.apis.IS_BROWSER_ENV||o.apis.IS_WEBWORKER_ENV;if(g)u=(E,T)=>{if(!self.OffscreenCanvas)throw new Error("OffscreenCanvas not supported by this browser.");return new self.OffscreenCanvas(E,T)},m=self.createImageBitmap,d=self.ImageData;else if(a)m=async E=>{const P=(await E.metadata()).channels,{data:C,info:D}=await E.rotate().raw().toBuffer({resolveWithObject:!0}),L=new M(new Uint8ClampedArray(C),D.width,D.height,D.channels);return P!==void 0&&P!==D.channels&&L.convert(P),L};else throw new Error("Unable to load image processing library.");const _={0:"nearest",1:"lanczos",2:"bilinear",3:"bicubic",4:"box",5:"hamming"},y=new Map([["png","image/png"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["gif","image/gif"]]);class M{constructor(T,P,C,D){this.data=T,this.width=P,this.height=C,this.channels=D}get size(){return[this.width,this.height]}static async read(T){if(T instanceof M)return T;if(typeof T=="string"||T instanceof URL)return await this.fromURL(T);if(T instanceof Blob)return await this.fromBlob(T);if(typeof HTMLCanvasElement<"u"&&T instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&T instanceof OffscreenCanvas)return this.fromCanvas(T);throw new Error(`Unsupported input type: ${typeof T}`)}static fromCanvas(T){if(!g)throw new Error("fromCanvas() is only supported in browser environments.");const C=T.getContext("2d").getImageData(0,0,T.width,T.height).data;return new M(C,T.width,T.height,4)}static async fromURL(T){const P=await(0,i.getFile)(T);if(P.status!==200)throw new Error(`Unable to read image from "${T}" (${P.status} ${P.statusText})`);const C=await P.blob();return this.fromBlob(C)}static async fromBlob(T){if(g){const P=await m(T),C=u(P.width,P.height).getContext("2d");return C.drawImage(P,0,0),new this(C.getImageData(0,0,P.width,P.height).data,P.width,P.height,4)}else{const P=a(await T.arrayBuffer());return await m(P)}}static fromTensor(T,P="CHW"){if(T.dims.length!==3)throw new Error(`Tensor should have 3 dimensions, but has ${T.dims.length} dimensions.`);if(P==="CHW")T=T.transpose(1,2,0);else if(P!=="HWC")throw new Error(`Unsupported channel format: ${P}`);if(!(T.data instanceof Uint8ClampedArray||T.data instanceof Uint8Array))throw new Error(`Unsupported tensor type: ${T.type}`);switch(T.dims[2]){case 1:case 2:case 3:case 4:return new M(T.data,T.dims[1],T.dims[0],T.dims[2]);default:throw new Error(`Unsupported number of channels: ${T.dims[2]}`)}}grayscale(){if(this.channels===1)return this;const T=new Uint8ClampedArray(this.width*this.height*1);switch(this.channels){case 3:case 4:for(let P=0,C=0;P<this.data.length;P+=this.channels){const D=this.data[P],L=this.data[P+1],N=this.data[P+2];T[C++]=Math.round(.2989*D+.587*L+.114*N)}break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this._update(T,this.width,this.height,1)}rgb(){if(this.channels===3)return this;const T=new Uint8ClampedArray(this.width*this.height*3);switch(this.channels){case 1:for(let P=0,C=0;P<this.data.length;++P)T[C++]=this.data[P],T[C++]=this.data[P],T[C++]=this.data[P];break;case 4:for(let P=0,C=0;P<this.data.length;P+=4)T[C++]=this.data[P],T[C++]=this.data[P+1],T[C++]=this.data[P+2];break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this._update(T,this.width,this.height,3)}rgba(){if(this.channels===4)return this;const T=new Uint8ClampedArray(this.width*this.height*4);switch(this.channels){case 1:for(let P=0,C=0;P<this.data.length;++P)T[C++]=this.data[P],T[C++]=this.data[P],T[C++]=this.data[P],T[C++]=255;break;case 3:for(let P=0,C=0;P<this.data.length;P+=3)T[C++]=this.data[P],T[C++]=this.data[P+1],T[C++]=this.data[P+2],T[C++]=255;break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this._update(T,this.width,this.height,4)}putAlpha(T){if(T.width!==this.width||T.height!==this.height)throw new Error(`Expected mask size to be ${this.width}x${this.height}, but got ${T.width}x${T.height}`);if(T.channels!==1)throw new Error(`Expected mask to have 1 channel, but got ${T.channels}`);const P=this.data,C=T.data,D=this.width*this.height;if(this.channels===3){const L=new Uint8ClampedArray(D*4);for(let N=0,j=0,$=0;N<D;++N)L[$++]=P[j++],L[$++]=P[j++],L[$++]=P[j++],L[$++]=C[N];return this._update(L,this.width,this.height,4)}else if(this.channels===4){for(let L=0;L<D;++L)P[4*L+3]=C[L];return this}throw new Error(`Expected image to have 3 or 4 channels, but got ${this.channels}`)}async resize(T,P,{resample:C=2}={}){if(this.width===T&&this.height===P)return this;let D=_[C]??C;const L=(0,n.isNullishDimension)(T),N=(0,n.isNullishDimension)(P);if(L&&N)return this;if(L?T=P/this.height*this.width:N&&(P=T/this.width*this.height),g){const j=this.channels,$=this.toCanvas(),U=u(T,P).getContext("2d");return U.drawImage($,0,0,T,P),new M(U.getImageData(0,0,T,P).data,T,P,4).convert(j)}else{let j=this.toSharp();switch(D){case"box":case"hamming":(D==="box"||D==="hamming")&&(console.warn(`Resampling method ${D} is not yet supported. Using bilinear instead.`),D="bilinear");case"nearest":case"bilinear":case"bicubic":j=j.affine([T/this.width,0,0,P/this.height],{interpolator:D});break;case"lanczos":j=j.resize({width:T,height:P,fit:"fill",kernel:"lanczos3"});break;default:throw new Error(`Resampling method ${D} is not supported.`)}return await m(j)}}async pad([T,P,C,D]){if(T=Math.max(T,0),P=Math.max(P,0),C=Math.max(C,0),D=Math.max(D,0),T===0&&P===0&&C===0&&D===0)return this;if(g){const L=this.channels,N=this.toCanvas(),j=this.width+T+P,$=this.height+C+D,U=u(j,$).getContext("2d");return U.drawImage(N,0,0,this.width,this.height,T,C,this.width,this.height),new M(U.getImageData(0,0,j,$).data,j,$,4).convert(L)}else{const L=this.toSharp().extend({left:T,right:P,top:C,bottom:D});return await m(L)}}async crop([T,P,C,D]){if(T=Math.max(T,0),P=Math.max(P,0),C=Math.min(C,this.width-1),D=Math.min(D,this.height-1),T===0&&P===0&&C===this.width-1&&D===this.height-1)return this;const L=C-T+1,N=D-P+1;if(g){const j=this.channels,$=this.toCanvas(),U=u(L,N).getContext("2d");return U.drawImage($,T,P,L,N,0,0,L,N),new M(U.getImageData(0,0,L,N).data,L,N,4).convert(j)}else{const j=this.toSharp().extract({left:T,top:P,width:L,height:N});return await m(j)}}async center_crop(T,P){if(this.width===T&&this.height===P)return this;const C=(this.width-T)/2,D=(this.height-P)/2;if(g){const L=this.channels,N=this.toCanvas(),j=u(T,P).getContext("2d");let $=0,U=0,G=0,H=0;return C>=0?$=C:G=-C,D>=0?U=D:H=-D,j.drawImage(N,$,U,T,P,G,H,T,P),new M(j.getImageData(0,0,T,P).data,T,P,4).convert(L)}else{let L=this.toSharp();if(C>=0&&D>=0)L=L.extract({left:Math.floor(C),top:Math.floor(D),width:T,height:P});else if(C<=0&&D<=0){const N=Math.floor(-D),j=Math.floor(-C);L=L.extend({top:N,left:j,right:T-this.width-j,bottom:P-this.height-N})}else{let N=[0,0],j=0;D<0?(N[0]=Math.floor(-D),N[1]=P-this.height-N[0]):j=Math.floor(D);let $=[0,0],U=0;C<0?($[0]=Math.floor(-C),$[1]=T-this.width-$[0]):U=Math.floor(C),L=L.extend({top:N[0],bottom:N[1],left:$[0],right:$[1]}).extract({left:U,top:j,width:T,height:P})}return await m(L)}}async toBlob(T="image/png",P=1){if(!g)throw new Error("toBlob() is only supported in browser environments.");return await this.toCanvas().convertToBlob({type:T,quality:P})}toTensor(T="CHW"){let P=new s.Tensor("uint8",new Uint8Array(this.data),[this.height,this.width,this.channels]);if(T!=="HWC")if(T==="CHW")P=P.permute(2,0,1);else throw new Error(`Unsupported channel format: ${T}`);return P}toCanvas(){if(!g)throw new Error("toCanvas() is only supported in browser environments.");const T=this.clone().rgba(),P=u(T.width,T.height),C=new d(T.data,T.width,T.height);return P.getContext("2d").putImageData(C,0,0),P}split(){const{data:T,width:P,height:C,channels:D}=this,L=T.constructor,N=T.length/D,j=Array.from({length:D},()=>new L(N));for(let $=0;$<N;++$){const U=D*$;for(let G=0;G<D;++G)j[G][$]=T[U+G]}return j.map($=>new M($,P,C,1))}_update(T,P,C,D=null){return this.data=T,this.width=P,this.height=C,D!==null&&(this.channels=D),this}clone(){return new M(this.data.slice(),this.width,this.height,this.channels)}convert(T){if(this.channels===T)return this;switch(T){case 1:this.grayscale();break;case 3:this.rgb();break;case 4:this.rgba();break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this}async save(T){if(g){if(o.apis.IS_WEBWORKER_ENV)throw new Error("Unable to save an image from a Web Worker.");const P=T.split(".").pop().toLowerCase(),C=y.get(P)??"image/png",D=await this.toBlob(C);(0,n.saveBlob)(T,D)}else{if(o.apis.IS_FS_AVAILABLE)return await this.toSharp().toFile(T);throw new Error("Unable to save the image because filesystem is disabled in this environment.")}}toSharp(){if(g)throw new Error("toSharp() is only supported in server-side environments.");return a(this.data,{raw:{width:this.width,height:this.height,channels:this.channels}})}}const x=M.read.bind(M)},"./src/utils/maths.js":(e,t,r)=>{r.r(t),r.d(t,{FFT:()=>x,bankers_round:()=>P,cos_sim:()=>u,dot:()=>a,dynamic_time_warping:()=>C,interpolate_data:()=>n,log_softmax:()=>s,magnitude:()=>d,max:()=>g,medianFilter:()=>E,min:()=>m,permute_data:()=>i,round:()=>T,softmax:()=>o});function n(D,[L,N,j],[$,U],G="bilinear",H=!1){const X=U/j,ee=$/N,ae=new D.constructor($*U*L),de=N*j,ye=$*U;for(let _e=0;_e<$;++_e)for(let ue=0;ue<U;++ue){const fe=_e*U+ue,De=(ue+.5)/X-.5,pe=(_e+.5)/ee-.5;let K=Math.floor(De),te=Math.floor(pe);const ve=Math.min(K+1,j-1),$e=Math.min(te+1,N-1);K=Math.max(K,0),te=Math.max(te,0);const Ce=De-K,Ge=pe-te,ot=(1-Ce)*(1-Ge),Ye=Ce*(1-Ge),et=(1-Ce)*Ge,Te=Ce*Ge,Le=te*j,ke=$e*j,Xe=Le+K,Ne=Le+ve,Ot=ke+K,Lt=ke+ve;for(let kt=0;kt<L;++kt){const mt=kt*de;ae[kt*ye+fe]=ot*D[mt+Xe]+Ye*D[mt+Ne]+et*D[mt+Ot]+Te*D[mt+Lt]}}return ae}function i(D,L,N){const j=new Array(N.length),$=new Array(N.length);for(let H=N.length-1,X=1;H>=0;--H)$[H]=X,j[H]=L[N[H]],X*=j[H];const U=N.map((H,X)=>$[N.indexOf(X)]),G=new D.constructor(D.length);for(let H=0;H<D.length;++H){let X=0;for(let ee=L.length-1,ae=H;ee>=0;--ee)X+=ae%L[ee]*U[ee],ae=Math.floor(ae/L[ee]);G[X]=D[H]}return[G,j]}function o(D){const L=g(D)[0],N=D.map(U=>Math.exp(U-L)),j=N.reduce((U,G)=>U+G,0);return N.map(U=>U/j)}function s(D){const L=g(D)[0];let N=0;for(let U=0;U<D.length;++U)N+=Math.exp(D[U]-L);const j=Math.log(N);return D.map(U=>U-L-j)}function a(D,L){let N=0;for(let j=0;j<D.length;++j)N+=D[j]*L[j];return N}function u(D,L){const N=a(D,L),j=d(D),$=d(L);return N/(j*$)}function d(D){return Math.sqrt(D.reduce((L,N)=>L+N*N,0))}function m(D){if(D.length===0)throw Error("Array must not be empty");let L=D[0],N=0;for(let j=1;j<D.length;++j)D[j]<L&&(L=D[j],N=j);return[L,N]}function g(D){if(D.length===0)throw Error("Array must not be empty");let L=D[0],N=0;for(let j=1;j<D.length;++j)D[j]>L&&(L=D[j],N=j);return[L,N]}function _(D){return D>0&&(D&D-1)===0}class y{constructor(L){if(this.size=L|0,this.size<=1||!_(this.size))throw new Error("FFT size must be a power of two larger than 1");this._csize=L<<1,this.table=new Float64Array(this.size*2);for(let j=0;j<this.table.length;j+=2){const $=Math.PI*j/this.size;this.table[j]=Math.cos($),this.table[j+1]=-Math.sin($)}let N=0;for(let j=1;this.size>j;j<<=1)++N;this._width=N%2===0?N-1:N,this._bitrev=new Int32Array(1<<this._width);for(let j=0;j<this._bitrev.length;++j){this._bitrev[j]=0;for(let $=0;$<this._width;$+=2){const U=this._width-$-2;this._bitrev[j]|=(j>>>$&3)<<U}}}createComplexArray(){return new Float64Array(this._csize)}fromComplexArray(L,N){const j=N||new Array(L.length>>>1);for(let $=0;$<L.length;$+=2)j[$>>>1]=L[$];return j}toComplexArray(L,N){const j=N||this.createComplexArray();for(let $=0;$<j.length;$+=2)j[$]=L[$>>>1],j[$+1]=0;return j}transform(L,N){if(L===N)throw new Error("Input and output buffers must be different");this._transform4(L,N,1)}realTransform(L,N){if(L===N)throw new Error("Input and output buffers must be different");this._realTransform4(L,N,1)}inverseTransform(L,N){if(L===N)throw new Error("Input and output buffers must be different");this._transform4(L,N,-1);for(let j=0;j<L.length;++j)L[j]/=this.size}_transform4(L,N,j){const $=this._csize;let G=1<<this._width,H=$/G<<1,X,ee;const ae=this._bitrev;if(H===4)for(X=0,ee=0;X<$;X+=H,++ee){const ye=ae[ee];this._singleTransform2(N,L,X,ye,G)}else for(X=0,ee=0;X<$;X+=H,++ee){const ye=ae[ee];this._singleTransform4(N,L,X,ye,G,j)}const de=this.table;for(G>>=2;G>=2;G>>=2){H=$/G<<1;const ye=H>>>2;for(X=0;X<$;X+=H){const _e=X+ye-1;for(let ue=X,fe=0;ue<_e;ue+=2,fe+=G){const De=ue,pe=De+ye,K=pe+ye,te=K+ye,ve=L[De],$e=L[De+1],Ce=L[pe],Ge=L[pe+1],ot=L[K],Ye=L[K+1],et=L[te],Te=L[te+1],Le=de[fe],ke=j*de[fe+1],Xe=Ce*Le-Ge*ke,Ne=Ce*ke+Ge*Le,Ot=de[2*fe],Lt=j*de[2*fe+1],kt=ot*Ot-Ye*Lt,mt=ot*Lt+Ye*Ot,Zt=de[3*fe],Kt=j*de[3*fe+1],dr=et*Zt-Te*Kt,Bt=et*Kt+Te*Zt,wr=ve+kt,mr=$e+mt,hr=ve-kt,xr=$e-mt,or=Xe+dr,tt=Ne+Bt,Se=j*(Xe-dr),Pe=j*(Ne-Bt);L[De]=wr+or,L[De+1]=mr+tt,L[pe]=hr+Pe,L[pe+1]=xr-Se,L[K]=wr-or,L[K+1]=mr-tt,L[te]=hr-Pe,L[te+1]=xr+Se}}}}_singleTransform2(L,N,j,$,U){const G=L[$],H=L[$+1],X=L[$+U],ee=L[$+U+1];N[j]=G+X,N[j+1]=H+ee,N[j+2]=G-X,N[j+3]=H-ee}_singleTransform4(L,N,j,$,U,G){const H=U*2,X=U*3,ee=L[$],ae=L[$+1],de=L[$+U],ye=L[$+U+1],_e=L[$+H],ue=L[$+H+1],fe=L[$+X],De=L[$+X+1],pe=ee+_e,K=ae+ue,te=ee-_e,ve=ae-ue,$e=de+fe,Ce=ye+De,Ge=G*(de-fe),ot=G*(ye-De);N[j]=pe+$e,N[j+1]=K+Ce,N[j+2]=te+ot,N[j+3]=ve-Ge,N[j+4]=pe-$e,N[j+5]=K-Ce,N[j+6]=te-ot,N[j+7]=ve+Ge}_realTransform4(L,N,j){const $=this._csize;let G=1<<this._width,H=$/G<<1,X,ee;const ae=this._bitrev;if(H===4)for(X=0,ee=0;X<$;X+=H,++ee){const _e=ae[ee];this._singleRealTransform2(N,L,X,_e>>>1,G>>>1)}else for(X=0,ee=0;X<$;X+=H,++ee){const _e=ae[ee];this._singleRealTransform4(N,L,X,_e>>>1,G>>>1,j)}const de=this.table;for(G>>=2;G>=2;G>>=2){H=$/G<<1;const _e=H>>>1,ue=_e>>>1,fe=ue>>>1;for(X=0;X<$;X+=H)for(let De=0,pe=0;De<=fe;De+=2,pe+=G){const K=X+De,te=K+ue,ve=te+ue,$e=ve+ue,Ce=L[K],Ge=L[K+1],ot=L[te],Ye=L[te+1],et=L[ve],Te=L[ve+1],Le=L[$e],ke=L[$e+1],Xe=Ce,Ne=Ge,Ot=de[pe],Lt=j*de[pe+1],kt=ot*Ot-Ye*Lt,mt=ot*Lt+Ye*Ot,Zt=de[2*pe],Kt=j*de[2*pe+1],dr=et*Zt-Te*Kt,Bt=et*Kt+Te*Zt,wr=de[3*pe],mr=j*de[3*pe+1],hr=Le*wr-ke*mr,xr=Le*mr+ke*wr,or=Xe+dr,tt=Ne+Bt,Se=Xe-dr,Pe=Ne-Bt,Ve=kt+hr,Qe=mt+xr,dt=j*(kt-hr),Pt=j*(mt-xr);if(L[K]=or+Ve,L[K+1]=tt+Qe,L[te]=Se+Pt,L[te+1]=Pe-dt,De===0){L[ve]=or-Ve,L[ve+1]=tt-Qe;continue}if(De===fe)continue;const Vt=X+ue-De,At=X+_e-De;L[Vt]=Se-j*Pt,L[Vt+1]=-Pe-j*dt,L[At]=or-j*Ve,L[At+1]=-tt+j*Qe}}const ye=$>>>1;for(let _e=2;_e<ye;_e+=2)L[$-_e]=L[_e],L[$-_e+1]=-L[_e+1]}_singleRealTransform2(L,N,j,$,U){const G=L[$],H=L[$+U];N[j]=G+H,N[j+1]=0,N[j+2]=G-H,N[j+3]=0}_singleRealTransform4(L,N,j,$,U,G){const H=U*2,X=U*3,ee=L[$],ae=L[$+U],de=L[$+H],ye=L[$+X],_e=ee+de,ue=ee-de,fe=ae+ye,De=G*(ae-ye);N[j]=_e+fe,N[j+1]=0,N[j+2]=ue,N[j+3]=-De,N[j+4]=_e-fe,N[j+5]=0,N[j+6]=ue,N[j+7]=De}}class M{constructor(L){const N=2*(L-1),j=2*(2*L-1),$=2**Math.ceil(Math.log2(j));this.bufferSize=$,this._a=N;const U=new Float64Array(j),G=new Float64Array($);this._chirpBuffer=new Float64Array($),this._buffer1=new Float64Array($),this._buffer2=new Float64Array($),this._outBuffer1=new Float64Array($),this._outBuffer2=new Float64Array($);const H=-2*Math.PI/L,X=Math.cos(H),ee=Math.sin(H);for(let ae=0;ae<j>>1;++ae){const de=(ae+1-L)**2/2,ye=Math.sqrt(X**2+ee**2)**de,_e=de*Math.atan2(ee,X),ue=2*ae;U[ue]=ye*Math.cos(_e),U[ue+1]=ye*Math.sin(_e),G[ue]=U[ue],G[ue+1]=-U[ue+1]}this._slicedChirpBuffer=U.subarray(N,j),this._f=new y($>>1),this._f.transform(this._chirpBuffer,G)}_transform(L,N,j){const $=this._buffer1,U=this._buffer2,G=this._outBuffer1,H=this._outBuffer2,X=this._chirpBuffer,ee=this._slicedChirpBuffer,ae=this._a;if(j)for(let de=0;de<ee.length;de+=2){const ye=de+1,_e=de>>1,ue=N[_e];$[de]=ue*ee[de],$[ye]=ue*ee[ye]}else for(let de=0;de<ee.length;de+=2){const ye=de+1;$[de]=N[de]*ee[de]-N[ye]*ee[ye],$[ye]=N[de]*ee[ye]+N[ye]*ee[de]}this._f.transform(G,$);for(let de=0;de<X.length;de+=2){const ye=de+1;U[de]=G[de]*X[de]-G[ye]*X[ye],U[ye]=G[de]*X[ye]+G[ye]*X[de]}this._f.inverseTransform(H,U);for(let de=0;de<H.length;de+=2){const ye=H[de+ae],_e=H[de+ae+1],ue=ee[de],fe=ee[de+1];L[de]=ye*ue-_e*fe,L[de+1]=ye*fe+_e*ue}}transform(L,N){this._transform(L,N,!1)}realTransform(L,N){this._transform(L,N,!0)}}class x{constructor(L){this.fft_length=L,this.isPowerOfTwo=_(L),this.isPowerOfTwo?(this.fft=new y(L),this.outputBufferSize=2*L):(this.fft=new M(L),this.outputBufferSize=this.fft.bufferSize)}realTransform(L,N){this.fft.realTransform(L,N)}transform(L,N){this.fft.transform(L,N)}}function E(D,L){if(L%2===0||L<=0)throw new Error("Window size must be a positive odd number");const N=new D.constructor(D.length),j=new D.constructor(L),$=Math.floor(L/2);for(let U=0;U<D.length;++U){let G=0;for(let H=-$;H<=$;++H){let X=U+H;X<0?X=Math.abs(X):X>=D.length&&(X=2*(D.length-1)-X),j[G++]=D[X]}j.sort(),N[U]=j[$]}return N}function T(D,L){const N=Math.pow(10,L);return Math.round(D*N)/N}function P(D){const L=Math.round(D);return Math.abs(D)%1===.5?L%2===0?L:L-1:L}function C(D){const L=D.length,N=D[0].length,j=[L+1,N+1],$=Array.from({length:j[0]},()=>Array(j[1]).fill(1/0));$[0][0]=0;const U=Array.from({length:j[0]},()=>Array(j[1]).fill(-1));for(let ae=1;ae<j[1];++ae)for(let de=1;de<j[0];++de){const ye=$[de-1][ae-1],_e=$[de-1][ae],ue=$[de][ae-1];let fe,De;ye<_e&&ye<ue?(fe=ye,De=0):_e<ye&&_e<ue?(fe=_e,De=1):(fe=ue,De=2),$[de][ae]=D[de-1][ae-1]+fe,U[de][ae]=De}for(let ae=0;ae<j[1];++ae)U[0][ae]=2;for(let ae=0;ae<j[0];++ae)U[ae][0]=1;let G=L,H=N,X=[],ee=[];for(;G>0||H>0;)switch(X.push(G-1),ee.push(H-1),U[G][H]){case 0:--G,--H;break;case 1:--G;break;case 2:--H;break;default:throw new Error(`Internal error in dynamic time warping. Unexpected trace[${G}, ${H}]. Please file a bug report.`)}return X.reverse(),ee.reverse(),[X,ee]}},"./src/utils/tensor.js":(e,t,r)=>{r.r(t),r.d(t,{DataTypeMap:()=>s,Tensor:()=>a,cat:()=>N,full:()=>ee,full_like:()=>ae,interpolate:()=>m,interpolate_4d:()=>g,layer_norm:()=>P,matmul:()=>_,mean:()=>G,mean_pooling:()=>T,ones:()=>de,ones_like:()=>ye,permute:()=>d,quantize_embeddings:()=>De,rand:()=>fe,rfft:()=>y,slice:()=>E,stack:()=>j,std_mean:()=>U,topk:()=>M,zeros:()=>_e,zeros_like:()=>ue});var n=r("./src/utils/maths.js"),i=r("./src/backends/onnx.js"),o=r("./src/ops/registry.js");const s=Object.freeze({float32:Float32Array,float16:typeof Float16Array<"u"?Float16Array:Uint16Array,float64:Float64Array,string:Array,int8:Int8Array,uint8:Uint8Array,int16:Int16Array,uint16:Uint16Array,int32:Int32Array,uint32:Uint32Array,int64:BigInt64Array,uint64:BigUint64Array,bool:Uint8Array,uint4:Uint8Array,int4:Int8Array});class a{constructor(...K){_t(this,"ort_tensor");return(0,i.isONNXTensor)(K[0])?this.ort_tensor=K[0]:this.ort_tensor=new i.Tensor(K[0],K[1],K[2]),new Proxy(this,{get:(te,ve)=>{if(typeof ve=="string"){let $e=Number(ve);if(Number.isInteger($e))return te._getitem($e)}return te[ve]},set:(te,ve,$e)=>te[ve]=$e})}get dims(){return this.ort_tensor.dims}set dims(K){this.ort_tensor.dims=K}get type(){return this.ort_tensor.type}get data(){return this.ort_tensor.data}get size(){return this.ort_tensor.size}get location(){return this.ort_tensor.location}dispose(){this.ort_tensor.dispose()}*[Symbol.iterator](){const[K,...te]=this.dims;if(te.length>0){const ve=te.reduce(($e,Ce)=>$e*Ce);for(let $e=0;$e<K;++$e)yield this._subarray($e,ve,te)}else yield*this.data}_getitem(K){const[te,...ve]=this.dims;if(K=L(K,te),ve.length>0){const $e=ve.reduce((Ce,Ge)=>Ce*Ge);return this._subarray(K,$e,ve)}else return new a(this.type,[this.data[K]],ve)}indexOf(K){const te=this.data;for(let ve=0;ve<te.length;++ve)if(te[ve]==K)return ve;return-1}_subarray(K,te,ve){const $e=K*te,Ce=(K+1)*te,Ge="subarray"in this.data?this.data.subarray($e,Ce):this.data.slice($e,Ce);return new a(this.type,Ge,ve)}item(){const K=this.data;if(K.length!==1)throw new Error(`a Tensor with ${K.length} elements cannot be converted to Scalar`);return K[0]}tolist(){return u(this.data,this.dims)}sigmoid(){return this.clone().sigmoid_()}sigmoid_(){const K=this.data;for(let te=0;te<K.length;++te)K[te]=1/(1+Math.exp(-K[te]));return this}map(K){return this.clone().map_(K)}map_(K){const te=this.data;for(let ve=0;ve<te.length;++ve)te[ve]=K(te[ve],ve,te);return this}mul(K){return this.clone().mul_(K)}mul_(K){const te=this.data;for(let ve=0;ve<te.length;++ve)te[ve]*=K;return this}div(K){return this.clone().div_(K)}div_(K){const te=this.data;for(let ve=0;ve<te.length;++ve)te[ve]/=K;return this}add(K){return this.clone().add_(K)}add_(K){const te=this.data;for(let ve=0;ve<te.length;++ve)te[ve]+=K;return this}sub(K){return this.clone().sub_(K)}sub_(K){const te=this.data;for(let ve=0;ve<te.length;++ve)te[ve]-=K;return this}clone(){return new a(this.type,this.data.slice(),this.dims.slice())}slice(...K){const te=[],ve=[];for(let Te=0;Te<this.dims.length;++Te){let Le=K[Te];if(Le==null)ve.push([0,this.dims[Te]]),te.push(this.dims[Te]);else if(typeof Le=="number")Le=L(Le,this.dims[Te],Te),ve.push([Le,Le+1]);else if(Array.isArray(Le)&&Le.length===2){let[ke,Xe]=Le;if(ke=ke===null?0:L(ke,this.dims[Te],Te,!1),Xe=Xe===null?this.dims[Te]:L(Xe,this.dims[Te],Te,!1),ke>Xe)throw new Error(`Invalid slice: ${Le}`);const Ne=[Math.max(ke,0),Math.min(Xe,this.dims[Te])];ve.push(Ne),te.push(Ne[1]-Ne[0])}else throw new Error(`Invalid slice: ${Le}`)}const $e=ve.map(([Te,Le])=>Le-Te),Ce=$e.reduce((Te,Le)=>Te*Le),Ge=this.data,ot=new Ge.constructor(Ce),Ye=this.stride();let et=!0;for(let Te=1;Te<$e.length;++Te)if(ve[Te][0]!==0||ve[Te][1]!==this.dims[Te]){et=!1;break}if(et){const Te=ve[0][0]*Ye[0],Le=ve[0][1]*Ye[0];if(ArrayBuffer.isView(Ge))ot.set(Ge.subarray(Te,Le));else if(Array.isArray(Ge)){const ke=Ge.slice(Te,Le);for(let Xe=0;Xe<ke.length;++Xe)ot[Xe]=ke[Xe]}else throw new Error("Unsupported data type for slicing")}else for(let Te=0;Te<Ce;++Te){let Le=0;for(let ke=$e.length-1,Xe=Te;ke>=0;--ke){const Ne=$e[ke];Le+=(Xe%Ne+ve[ke][0])*Ye[ke],Xe=Math.floor(Xe/Ne)}ot[Te]=Ge[Le]}return new a(this.type,ot,te)}permute(...K){return d(this,K)}transpose(...K){return this.permute(...K)}sum(K=null,te=!1){return this.norm(1,K,te)}norm(K="fro",te=null,ve=!1){if(K==="fro")K=2;else if(typeof K=="string")throw Error(`Unsupported norm: ${K}`);const $e=this.data,Ce=(et,Te)=>et+Te**K;if(te===null){const et=$e.reduce(Ce,0)**(1/K);return new a(this.type,[et],[])}const[Ge,ot,Ye]=$(Ce,this,te,ve);if(K!==1)for(let et=0;et<ot.length;++et)ot[et]=ot[et]**(1/K);return new a(Ge,ot,Ye)}normalize_(K=2,te=1){te=L(te,this.dims.length);const ve=this.norm(K,te,!0),$e=this.data,Ce=ve.data;for(let Ge=0;Ge<$e.length;++Ge){let ot=0;for(let Ye=this.dims.length-1,et=Ge,Te=1;Ye>=0;--Ye){const Le=this.dims[Ye];if(Ye!==te){const ke=et%Le;ot+=ke*Te,Te*=this.dims[Ye]}et=Math.floor(et/Le)}$e[Ge]/=Ce[ot]}return this}normalize(K=2,te=1){return this.clone().normalize_(K,te)}stride(){return H(this.dims)}squeeze(K=null){return new a(this.type,this.data,C(this.dims,K))}squeeze_(K=null){return this.dims=C(this.dims,K),this}unsqueeze(K=null){return new a(this.type,this.data,D(this.dims,K))}unsqueeze_(K=null){return this.dims=D(this.dims,K),this}flatten_(K=0,te=-1){te=(te+this.dims.length)%this.dims.length;let ve=this.dims.slice(0,K),$e=this.dims.slice(K,te+1),Ce=this.dims.slice(te+1);return this.dims=[...ve,$e.reduce((Ge,ot)=>Ge*ot,1),...Ce],this}flatten(K=0,te=-1){return this.clone().flatten_(K,te)}view(...K){let te=-1;for(let $e=0;$e<K.length;++$e)if(K[$e]===-1){if(te!==-1)throw new Error("Only one dimension can be inferred");te=$e}const ve=this.data;if(te!==-1){const $e=K.reduce((Ce,Ge,ot)=>ot!==te?Ce*Ge:Ce,1);K[te]=ve.length/$e}return new a(this.type,ve,K)}neg_(){const K=this.data;for(let te=0;te<K.length;++te)K[te]=-K[te];return this}neg(){return this.clone().neg_()}gt(K){const te=new Uint8Array(this.data.length),ve=this.data;for(let $e=0;$e<ve.length;++$e)te[$e]=ve[$e]>K?1:0;return new a("bool",te,this.dims)}lt(K){const te=new Uint8Array(this.data.length),ve=this.data;for(let $e=0;$e<ve.length;++$e)te[$e]=ve[$e]<K?1:0;return new a("bool",te,this.dims)}clamp_(K,te){const ve=this.data;for(let $e=0;$e<ve.length;++$e)ve[$e]=Math.min(Math.max(ve[$e],K),te);return this}clamp(K,te){return this.clone().clamp_(K,te)}round_(){const K=this.data;for(let te=0;te<K.length;++te)K[te]=Math.round(K[te]);return this}round(){return this.clone().round_()}mean(K=null,te=!1){return G(this,K,te)}min(K=null,te=!1){if(K===null){const Ge=(0,n.min)(this.data)[0];return new a(this.type,[Ge],[])}const[ve,$e,Ce]=$((Ge,ot)=>Math.min(Ge,ot),this,K,te,1/0);return new a(ve,$e,Ce)}max(K=null,te=!1){if(K===null){const Ge=(0,n.max)(this.data)[0];return new a(this.type,[Ge],[])}const[ve,$e,Ce]=$((Ge,ot)=>Math.max(Ge,ot),this,K,te,-1/0);return new a(ve,$e,Ce)}argmin(K=null,te=!1){if(K!==null)throw new Error("`dim !== null` not yet implemented.");const ve=(0,n.min)(this.data)[1];return new a("int64",[BigInt(ve)],[])}argmax(K=null,te=!1){if(K!==null)throw new Error("`dim !== null` not yet implemented.");const ve=(0,n.max)(this.data)[1];return new a("int64",[BigInt(ve)],[])}to(K){if(this.type===K)return this;if(!s.hasOwnProperty(K))throw new Error(`Unsupported type: ${K}`);let te;const ve=["int64","uint64"].includes(this.type),$e=["int64","uint64"].includes(K);return ve&&!$e?te=Number:!ve&&$e&&(te=BigInt),new a(K,s[K].from(this.data,te),this.dims)}}function u(pe,K){const te=pe.length,ve=K.reduce((Ce,Ge)=>Ce*Ge);if(te!==ve)throw Error(`cannot reshape array of size ${te} into shape (${K})`);let $e=pe;for(let Ce=K.length-1;Ce>=0;Ce--)$e=$e.reduce((Ge,ot)=>{let Ye=Ge[Ge.length-1];return Ye.length<K[Ce]?Ye.push(ot):Ge.push([ot]),Ge},[[]]);return $e[0]}function d(pe,K){const[te,ve]=(0,n.permute_data)(pe.data,pe.dims,K);return new a(pe.type,te,ve)}function m(pe,[K,te],ve="bilinear",$e=!1){const Ce=pe.dims.at(-3)??1,Ge=pe.dims.at(-2),ot=pe.dims.at(-1);let Ye=(0,n.interpolate_data)(pe.data,[Ce,Ge,ot],[K,te],ve,$e);return new a(pe.type,Ye,[Ce,K,te])}async function g(pe,{size:K=null,mode:te="bilinear"}={}){if(pe.dims.length!==4)throw new Error("`interpolate_4d` currently only supports 4D input.");if(!K)throw new Error("`interpolate_4d` requires a `size` argument.");let ve;if(K.length===2)ve=[...pe.dims.slice(0,2),...K];else if(K.length===3)ve=[pe.dims[0],...K];else if(K.length===4)ve=K;else throw new Error("`size` must be of length 2, 3, or 4.");let $e;if(te==="nearest")$e=await o.TensorOpRegistry.nearest_interpolate_4d;else if(te==="bilinear")$e=await o.TensorOpRegistry.bilinear_interpolate_4d;else if(te==="bicubic")$e=await o.TensorOpRegistry.bicubic_interpolate_4d;else throw new Error(`Unsupported mode: ${te}`);const Ce=new a("int64",new BigInt64Array(ve.map(BigInt)),[ve.length]);return await $e({x:pe,s:Ce})}async function _(pe,K){return await(await o.TensorOpRegistry.matmul)({a:pe,b:K})}async function y(pe,K){return await(await o.TensorOpRegistry.rfft)({x:pe,a:K})}async function M(pe,K){const te=await o.TensorOpRegistry.top_k;return K==null?K=pe.dims.at(-1):K=Math.min(K,pe.dims.at(-1)),await te({x:pe,k:new a("int64",[BigInt(K)],[1])})}const x=pe=>new a("int64",pe,[pe.length]);async function E(pe,K,te,ve,$e){return await(await o.TensorOpRegistry.slice)({x:pe,s:x(K),e:x(te),a:x(ve),t:x($e??new Array(ve.length).fill(1))})}function T(pe,K){const te=pe.data,ve=K.data,$e=[pe.dims[0],pe.dims[2]],Ce=new te.constructor($e[0]*$e[1]),[Ge,ot,Ye]=pe.dims;let et=0;for(let Te=0;Te<Ge;++Te){const Le=Te*Ye*ot;for(let ke=0;ke<Ye;++ke){let Xe=0,Ne=0;const Ot=Te*ot,Lt=Le+ke;for(let mt=0;mt<ot;++mt){const Zt=Number(ve[Ot+mt]);Ne+=Zt,Xe+=te[Lt+mt*Ye]*Zt}const kt=Xe/Ne;Ce[et++]=kt}}return new a(pe.type,Ce,$e)}function P(pe,K,{eps:te=1e-5}={}){if(pe.dims.length!==2)throw new Error("`layer_norm` currently only supports 2D input.");const[ve,$e]=pe.dims;if(K.length!==1&&K[0]!==$e)throw new Error("`normalized_shape` must be a 1D array with shape `[input.dims[1]]`.");const[Ce,Ge]=U(pe,1,0,!0),ot=Ce.data,Ye=Ge.data,et=pe.data,Te=new et.constructor(et.length);for(let Le=0;Le<ve;++Le){const ke=Le*$e;for(let Xe=0;Xe<$e;++Xe){const Ne=ke+Xe;Te[Ne]=(et[Ne]-Ye[Le])/(ot[Le]+te)}}return new a(pe.type,Te,pe.dims)}function C(pe,K){return pe=pe.slice(),K===null?pe=pe.filter(te=>te!==1):typeof K=="number"?pe[K]===1&&pe.splice(K,1):Array.isArray(K)&&(pe=pe.filter((te,ve)=>te!==1||!K.includes(ve))),pe}function D(pe,K){return K=L(K,pe.length+1),pe=pe.slice(),pe.splice(K,0,1),pe}function L(pe,K,te=null,ve=!0){if(pe<-K||pe>=K){if(ve)throw new Error(`IndexError: index ${pe} is out of bounds for dimension${te===null?"":" "+te} with size ${K}`);return pe<-K?0:K}return pe<0&&(pe=(pe%K+K)%K),pe}function N(pe,K=0){K=L(K,pe[0].dims.length);const te=pe[0].dims.slice();te[K]=pe.reduce((Ge,ot)=>Ge+ot.dims[K],0);const ve=te.reduce((Ge,ot)=>Ge*ot,1),$e=new pe[0].data.constructor(ve),Ce=pe[0].type;if(K===0){let Ge=0;for(const ot of pe){const Ye=ot.data;$e.set(Ye,Ge),Ge+=Ye.length}}else{let Ge=0;for(let ot=0;ot<pe.length;++ot){const{data:Ye,dims:et}=pe[ot];for(let Te=0;Te<Ye.length;++Te){let Le=0;for(let ke=et.length-1,Xe=Te,Ne=1;ke>=0;--ke){const Ot=et[ke];let Lt=Xe%Ot;ke===K&&(Lt+=Ge),Le+=Lt*Ne,Ne*=te[ke],Xe=Math.floor(Xe/Ot)}$e[Le]=Ye[Te]}Ge+=et[K]}}return new a(Ce,$e,te)}function j(pe,K=0){return N(pe.map(te=>te.unsqueeze(K)),K)}function $(pe,K,te=null,ve=!1,$e=null){const Ce=K.data,Ge=K.dims;te=L(te,Ge.length);const ot=Ge.slice();ot[te]=1;const Ye=new Ce.constructor(Ce.length/Ge[te]);$e!==null&&Ye.fill($e);for(let et=0;et<Ce.length;++et){let Te=0;for(let Le=Ge.length-1,ke=et,Xe=1;Le>=0;--Le){const Ne=Ge[Le];if(Le!==te){const Ot=ke%Ne;Te+=Ot*Xe,Xe*=ot[Le]}ke=Math.floor(ke/Ne)}Ye[Te]=pe(Ye[Te],Ce[et],et,Te)}return ve||ot.splice(te,1),[K.type,Ye,ot]}function U(pe,K=null,te=1,ve=!1){const $e=pe.data,Ce=pe.dims;if(K===null){const Xe=$e.reduce((kt,mt)=>kt+mt,0)/$e.length,Ne=Math.sqrt($e.reduce((kt,mt)=>kt+(mt-Xe)**2,0)/($e.length-te)),Ot=new a(pe.type,[Xe],[]);return[new a(pe.type,[Ne],[]),Ot]}K=L(K,Ce.length);const Ge=G(pe,K,ve),ot=Ge.data,[Ye,et,Te]=$((ke,Xe,Ne,Ot)=>ke+(Xe-ot[Ot])**2,pe,K,ve);for(let ke=0;ke<et.length;++ke)et[ke]=Math.sqrt(et[ke]/(Ce[K]-te));return[new a(Ye,et,Te),Ge]}function G(pe,K=null,te=!1){const ve=pe.dims,$e=pe.data;if(K===null){const Ye=$e.reduce((et,Te)=>et+Te,0);return new a(pe.type,[Ye/$e.length],[])}K=L(K,ve.length);const[Ce,Ge,ot]=$((Ye,et)=>Ye+et,pe,K,te);if(ve[K]!==1)for(let Ye=0;Ye<Ge.length;++Ye)Ge[Ye]/=ve[K];return new a(Ce,Ge,ot)}function H(pe){const K=new Array(pe.length);for(let te=pe.length-1,ve=1;te>=0;--te)K[te]=ve,ve*=pe[te];return K}function X(pe,K,te,ve){const $e=pe.reduce((Ce,Ge)=>Ce*Ge,1);return new a(te,new ve($e).fill(K),pe)}function ee(pe,K){let te,ve;if(typeof K=="number")te="float32",ve=Float32Array;else if(typeof K=="bigint")te="int64",ve=BigInt64Array;else if(typeof K=="boolean")te="bool",ve=Uint8Array;else throw new Error(`Unsupported data type: ${typeof K}`);return X(pe,K,te,ve)}function ae(pe,K){return ee(pe.dims,K)}function de(pe){return X(pe,1n,"int64",BigInt64Array)}function ye(pe){return de(pe.dims)}function _e(pe){return X(pe,0n,"int64",BigInt64Array)}function ue(pe){return _e(pe.dims)}function fe(pe){const K=pe.reduce((te,ve)=>te*ve,1);return new a("float32",Float32Array.from({length:K},()=>Math.random()),pe)}function De(pe,K){if(pe.dims.length!==2)throw new Error("The tensor must have 2 dimensions");if(pe.dims.at(-1)%8!==0)throw new Error("The last dimension of the tensor must be a multiple of 8");if(!["binary","ubinary"].includes(K))throw new Error("The precision must be either 'binary' or 'ubinary'");const te=K==="binary",ve=te?"int8":"uint8",$e=te?Int8Array:Uint8Array,Ce=pe.data,Ge=new $e(Ce.length/8);for(let ot=0;ot<Ce.length;++ot){const Ye=Ce[ot]>0?1:0,et=Math.floor(ot/8),Te=ot%8;Ge[et]|=Ye<<7-Te,te&&Te===0&&(Ge[et]-=128)}return new a(ve,Ge,[pe.dims[0],pe.dims[1]/8])}},"./src/utils/video.js":(e,t,r)=>{r.r(t),r.d(t,{RawVideo:()=>s,RawVideoFrame:()=>o,load_video:()=>a});var n=r("./src/utils/image.js"),i=r("./src/env.js");class o{constructor(d,m){this.image=d,this.timestamp=m}}class s{constructor(d,m){d.length>0&&d[0]instanceof n.RawImage&&(d=d.map((g,_)=>new o(g,(_+1)/(d.length+1)*m))),this.frames=d,this.duration=m}get width(){return this.frames[0].image.width}get height(){return this.frames[0].image.height}get fps(){return this.frames.length/this.duration}}async function a(u,{num_frames:d=null,fps:m=null}={}){if(!i.apis.IS_BROWSER_ENV)throw new Error("`load_video` is currently only supported in browser environments.");if(d==null&&m==null)throw new Error("Either num_frames or fps must be provided.");const g=[],_=document.createElement("video");if(_.crossOrigin="anonymous",_.muted=!0,typeof u=="string")_.src=u;else if(u instanceof Blob)_.src=URL.createObjectURL(u);else if(u instanceof HTMLVideoElement)_.src=u.src;else throw new Error("Invalid URL or video element provided.");if(await new Promise(C=>_.onloadedmetadata=C),_.seekable.start(0)===_.seekable.end(0)){const D=await(await fetch(_.src)).blob();_.src=URL.createObjectURL(D),await new Promise(L=>_.onloadedmetadata=L)}const y=_.duration;let M,x;d!=null?(M=d,x=d===1?0:y/(d-1)):(x=1/m,M=Math.floor(y/x));let E=[];for(let C=0;C<M;++C)E.push(d===1?y/2:C*x);const T=document.createElement("canvas");T.width=_.videoWidth,T.height=_.videoHeight;const P=T.getContext("2d",{willReadFrequently:!0});for(const C of E){_.currentTime=C,await new Promise(j=>{_.onseeked=j}),P.drawImage(_,0,0,T.width,T.height);const D=P.getImageData(0,0,T.width,T.height),L=new n.RawImage(D.data,T.width,T.height,4),N=new o(L,C);g.push(N)}return _.remove(),new s(g,y)}}},SW={};function Yo(e){var t=SW[e];if(t!==void 0)return t.exports;var r=SW[e]={exports:{}};return fEe[e](r,r.exports,Yo),r.exports}(()=>{var e=Object.getPrototypeOf?r=>Object.getPrototypeOf(r):r=>r.__proto__,t;Yo.t=function(r,n){if(n&1&&(r=this(r)),n&8||typeof r=="object"&&r&&(n&4&&r.__esModule||n&16&&typeof r.then=="function"))return r;var i=Object.create(null);Yo.r(i);var o={};t=t||[null,e({}),e([]),e(e)];for(var s=n&2&&r;typeof s=="object"&&!~t.indexOf(s);s=e(s))Object.getOwnPropertyNames(s).forEach(a=>o[a]=()=>r[a]);return o.default=()=>r,Yo.d(i,o),i}})();Yo.d=(e,t)=>{for(var r in t)Yo.o(t,r)&&!Yo.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})};Yo.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);Yo.r=e=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var Q={};(()=>{/*!*****************************!*\
  !*** ./src/transformers.js ***!
  \*****************************/Yo.r(Q),Yo.d(Q,{ASTFeatureExtractor:()=>g.ASTFeatureExtractor,ASTForAudioClassification:()=>r.ASTForAudioClassification,ASTModel:()=>r.ASTModel,ASTPreTrainedModel:()=>r.ASTPreTrainedModel,AlbertForMaskedLM:()=>r.AlbertForMaskedLM,AlbertForQuestionAnswering:()=>r.AlbertForQuestionAnswering,AlbertForSequenceClassification:()=>r.AlbertForSequenceClassification,AlbertModel:()=>r.AlbertModel,AlbertPreTrainedModel:()=>r.AlbertPreTrainedModel,AlbertTokenizer:()=>n.AlbertTokenizer,ArceeForCausalLM:()=>r.ArceeForCausalLM,ArceeModel:()=>r.ArceeModel,ArceePreTrainedModel:()=>r.ArceePreTrainedModel,AudioClassificationPipeline:()=>t.AudioClassificationPipeline,AutoConfig:()=>i.AutoConfig,AutoFeatureExtractor:()=>_.AutoFeatureExtractor,AutoImageProcessor:()=>x.AutoImageProcessor,AutoModel:()=>r.AutoModel,AutoModelForAudioClassification:()=>r.AutoModelForAudioClassification,AutoModelForAudioFrameClassification:()=>r.AutoModelForAudioFrameClassification,AutoModelForAudioTextToText:()=>r.AutoModelForAudioTextToText,AutoModelForCTC:()=>r.AutoModelForCTC,AutoModelForCausalLM:()=>r.AutoModelForCausalLM,AutoModelForDepthEstimation:()=>r.AutoModelForDepthEstimation,AutoModelForDocumentQuestionAnswering:()=>r.AutoModelForDocumentQuestionAnswering,AutoModelForImageClassification:()=>r.AutoModelForImageClassification,AutoModelForImageFeatureExtraction:()=>r.AutoModelForImageFeatureExtraction,AutoModelForImageMatting:()=>r.AutoModelForImageMatting,AutoModelForImageSegmentation:()=>r.AutoModelForImageSegmentation,AutoModelForImageTextToText:()=>r.AutoModelForImageTextToText,AutoModelForImageToImage:()=>r.AutoModelForImageToImage,AutoModelForMaskGeneration:()=>r.AutoModelForMaskGeneration,AutoModelForMaskedLM:()=>r.AutoModelForMaskedLM,AutoModelForNormalEstimation:()=>r.AutoModelForNormalEstimation,AutoModelForObjectDetection:()=>r.AutoModelForObjectDetection,AutoModelForPoseEstimation:()=>r.AutoModelForPoseEstimation,AutoModelForQuestionAnswering:()=>r.AutoModelForQuestionAnswering,AutoModelForSemanticSegmentation:()=>r.AutoModelForSemanticSegmentation,AutoModelForSeq2SeqLM:()=>r.AutoModelForSeq2SeqLM,AutoModelForSequenceClassification:()=>r.AutoModelForSequenceClassification,AutoModelForSpeechSeq2Seq:()=>r.AutoModelForSpeechSeq2Seq,AutoModelForTextToSpectrogram:()=>r.AutoModelForTextToSpectrogram,AutoModelForTextToWaveform:()=>r.AutoModelForTextToWaveform,AutoModelForTokenClassification:()=>r.AutoModelForTokenClassification,AutoModelForUniversalSegmentation:()=>r.AutoModelForUniversalSegmentation,AutoModelForVision2Seq:()=>r.AutoModelForVision2Seq,AutoModelForXVector:()=>r.AutoModelForXVector,AutoModelForZeroShotObjectDetection:()=>r.AutoModelForZeroShotObjectDetection,AutoProcessor:()=>P.AutoProcessor,AutoTokenizer:()=>n.AutoTokenizer,AutomaticSpeechRecognitionPipeline:()=>t.AutomaticSpeechRecognitionPipeline,BackgroundRemovalPipeline:()=>t.BackgroundRemovalPipeline,BartForConditionalGeneration:()=>r.BartForConditionalGeneration,BartForSequenceClassification:()=>r.BartForSequenceClassification,BartModel:()=>r.BartModel,BartPretrainedModel:()=>r.BartPretrainedModel,BartTokenizer:()=>n.BartTokenizer,BaseModelOutput:()=>r.BaseModelOutput,BaseStreamer:()=>C.BaseStreamer,BeitFeatureExtractor:()=>M.BeitFeatureExtractor,BeitForImageClassification:()=>r.BeitForImageClassification,BeitModel:()=>r.BeitModel,BeitPreTrainedModel:()=>r.BeitPreTrainedModel,BertForMaskedLM:()=>r.BertForMaskedLM,BertForQuestionAnswering:()=>r.BertForQuestionAnswering,BertForSequenceClassification:()=>r.BertForSequenceClassification,BertForTokenClassification:()=>r.BertForTokenClassification,BertModel:()=>r.BertModel,BertPreTrainedModel:()=>r.BertPreTrainedModel,BertTokenizer:()=>n.BertTokenizer,BitImageProcessor:()=>M.BitImageProcessor,BlenderbotForConditionalGeneration:()=>r.BlenderbotForConditionalGeneration,BlenderbotModel:()=>r.BlenderbotModel,BlenderbotPreTrainedModel:()=>r.BlenderbotPreTrainedModel,BlenderbotSmallForConditionalGeneration:()=>r.BlenderbotSmallForConditionalGeneration,BlenderbotSmallModel:()=>r.BlenderbotSmallModel,BlenderbotSmallPreTrainedModel:()=>r.BlenderbotSmallPreTrainedModel,BlenderbotSmallTokenizer:()=>n.BlenderbotSmallTokenizer,BlenderbotTokenizer:()=>n.BlenderbotTokenizer,BloomForCausalLM:()=>r.BloomForCausalLM,BloomModel:()=>r.BloomModel,BloomPreTrainedModel:()=>r.BloomPreTrainedModel,BloomTokenizer:()=>n.BloomTokenizer,CLIPFeatureExtractor:()=>M.CLIPFeatureExtractor,CLIPImageProcessor:()=>M.CLIPImageProcessor,CLIPModel:()=>r.CLIPModel,CLIPPreTrainedModel:()=>r.CLIPPreTrainedModel,CLIPSegForImageSegmentation:()=>r.CLIPSegForImageSegmentation,CLIPSegModel:()=>r.CLIPSegModel,CLIPSegPreTrainedModel:()=>r.CLIPSegPreTrainedModel,CLIPTextModel:()=>r.CLIPTextModel,CLIPTextModelWithProjection:()=>r.CLIPTextModelWithProjection,CLIPTokenizer:()=>n.CLIPTokenizer,CLIPVisionModel:()=>r.CLIPVisionModel,CLIPVisionModelWithProjection:()=>r.CLIPVisionModelWithProjection,CamembertForMaskedLM:()=>r.CamembertForMaskedLM,CamembertForQuestionAnswering:()=>r.CamembertForQuestionAnswering,CamembertForSequenceClassification:()=>r.CamembertForSequenceClassification,CamembertForTokenClassification:()=>r.CamembertForTokenClassification,CamembertModel:()=>r.CamembertModel,CamembertPreTrainedModel:()=>r.CamembertPreTrainedModel,CamembertTokenizer:()=>n.CamembertTokenizer,CausalLMOutput:()=>r.CausalLMOutput,CausalLMOutputWithPast:()=>r.CausalLMOutputWithPast,ChineseCLIPFeatureExtractor:()=>M.ChineseCLIPFeatureExtractor,ChineseCLIPModel:()=>r.ChineseCLIPModel,ChineseCLIPPreTrainedModel:()=>r.ChineseCLIPPreTrainedModel,ClapAudioModelWithProjection:()=>r.ClapAudioModelWithProjection,ClapFeatureExtractor:()=>g.ClapFeatureExtractor,ClapModel:()=>r.ClapModel,ClapPreTrainedModel:()=>r.ClapPreTrainedModel,ClapTextModelWithProjection:()=>r.ClapTextModelWithProjection,ClassifierFreeGuidanceLogitsProcessor:()=>L.ClassifierFreeGuidanceLogitsProcessor,CodeGenForCausalLM:()=>r.CodeGenForCausalLM,CodeGenModel:()=>r.CodeGenModel,CodeGenPreTrainedModel:()=>r.CodeGenPreTrainedModel,CodeGenTokenizer:()=>n.CodeGenTokenizer,CodeLlamaTokenizer:()=>n.CodeLlamaTokenizer,CohereForCausalLM:()=>r.CohereForCausalLM,CohereModel:()=>r.CohereModel,CoherePreTrainedModel:()=>r.CoherePreTrainedModel,CohereTokenizer:()=>n.CohereTokenizer,ConvBertForMaskedLM:()=>r.ConvBertForMaskedLM,ConvBertForQuestionAnswering:()=>r.ConvBertForQuestionAnswering,ConvBertForSequenceClassification:()=>r.ConvBertForSequenceClassification,ConvBertForTokenClassification:()=>r.ConvBertForTokenClassification,ConvBertModel:()=>r.ConvBertModel,ConvBertPreTrainedModel:()=>r.ConvBertPreTrainedModel,ConvBertTokenizer:()=>n.ConvBertTokenizer,ConvNextFeatureExtractor:()=>M.ConvNextFeatureExtractor,ConvNextForImageClassification:()=>r.ConvNextForImageClassification,ConvNextImageProcessor:()=>M.ConvNextImageProcessor,ConvNextModel:()=>r.ConvNextModel,ConvNextPreTrainedModel:()=>r.ConvNextPreTrainedModel,ConvNextV2ForImageClassification:()=>r.ConvNextV2ForImageClassification,ConvNextV2Model:()=>r.ConvNextV2Model,ConvNextV2PreTrainedModel:()=>r.ConvNextV2PreTrainedModel,DFineForObjectDetection:()=>r.DFineForObjectDetection,DFineModel:()=>r.DFineModel,DFinePreTrainedModel:()=>r.DFinePreTrainedModel,DINOv3ConvNextModel:()=>r.DINOv3ConvNextModel,DINOv3ConvNextPreTrainedModel:()=>r.DINOv3ConvNextPreTrainedModel,DINOv3ViTImageProcessor:()=>M.DINOv3ViTImageProcessor,DINOv3ViTModel:()=>r.DINOv3ViTModel,DINOv3ViTPreTrainedModel:()=>r.DINOv3ViTPreTrainedModel,DPTFeatureExtractor:()=>M.DPTFeatureExtractor,DPTForDepthEstimation:()=>r.DPTForDepthEstimation,DPTImageProcessor:()=>M.DPTImageProcessor,DPTModel:()=>r.DPTModel,DPTPreTrainedModel:()=>r.DPTPreTrainedModel,DacDecoderModel:()=>r.DacDecoderModel,DacDecoderOutput:()=>r.DacDecoderOutput,DacEncoderModel:()=>r.DacEncoderModel,DacEncoderOutput:()=>r.DacEncoderOutput,DacFeatureExtractor:()=>g.DacFeatureExtractor,DacModel:()=>r.DacModel,DacPreTrainedModel:()=>r.DacPreTrainedModel,DataTypeMap:()=>u.DataTypeMap,DebertaForMaskedLM:()=>r.DebertaForMaskedLM,DebertaForQuestionAnswering:()=>r.DebertaForQuestionAnswering,DebertaForSequenceClassification:()=>r.DebertaForSequenceClassification,DebertaForTokenClassification:()=>r.DebertaForTokenClassification,DebertaModel:()=>r.DebertaModel,DebertaPreTrainedModel:()=>r.DebertaPreTrainedModel,DebertaTokenizer:()=>n.DebertaTokenizer,DebertaV2ForMaskedLM:()=>r.DebertaV2ForMaskedLM,DebertaV2ForQuestionAnswering:()=>r.DebertaV2ForQuestionAnswering,DebertaV2ForSequenceClassification:()=>r.DebertaV2ForSequenceClassification,DebertaV2ForTokenClassification:()=>r.DebertaV2ForTokenClassification,DebertaV2Model:()=>r.DebertaV2Model,DebertaV2PreTrainedModel:()=>r.DebertaV2PreTrainedModel,DebertaV2Tokenizer:()=>n.DebertaV2Tokenizer,DecisionTransformerModel:()=>r.DecisionTransformerModel,DecisionTransformerPreTrainedModel:()=>r.DecisionTransformerPreTrainedModel,DeiTFeatureExtractor:()=>M.DeiTFeatureExtractor,DeiTForImageClassification:()=>r.DeiTForImageClassification,DeiTImageProcessor:()=>M.DeiTImageProcessor,DeiTModel:()=>r.DeiTModel,DeiTPreTrainedModel:()=>r.DeiTPreTrainedModel,DepthAnythingForDepthEstimation:()=>r.DepthAnythingForDepthEstimation,DepthAnythingPreTrainedModel:()=>r.DepthAnythingPreTrainedModel,DepthEstimationPipeline:()=>t.DepthEstimationPipeline,DepthProForDepthEstimation:()=>r.DepthProForDepthEstimation,DepthProPreTrainedModel:()=>r.DepthProPreTrainedModel,DetrFeatureExtractor:()=>M.DetrFeatureExtractor,DetrForObjectDetection:()=>r.DetrForObjectDetection,DetrForSegmentation:()=>r.DetrForSegmentation,DetrImageProcessor:()=>M.DetrImageProcessor,DetrModel:()=>r.DetrModel,DetrObjectDetectionOutput:()=>r.DetrObjectDetectionOutput,DetrPreTrainedModel:()=>r.DetrPreTrainedModel,DetrSegmentationOutput:()=>r.DetrSegmentationOutput,Dinov2ForImageClassification:()=>r.Dinov2ForImageClassification,Dinov2Model:()=>r.Dinov2Model,Dinov2PreTrainedModel:()=>r.Dinov2PreTrainedModel,Dinov2WithRegistersForImageClassification:()=>r.Dinov2WithRegistersForImageClassification,Dinov2WithRegistersModel:()=>r.Dinov2WithRegistersModel,Dinov2WithRegistersPreTrainedModel:()=>r.Dinov2WithRegistersPreTrainedModel,DistilBertForMaskedLM:()=>r.DistilBertForMaskedLM,DistilBertForQuestionAnswering:()=>r.DistilBertForQuestionAnswering,DistilBertForSequenceClassification:()=>r.DistilBertForSequenceClassification,DistilBertForTokenClassification:()=>r.DistilBertForTokenClassification,DistilBertModel:()=>r.DistilBertModel,DistilBertPreTrainedModel:()=>r.DistilBertPreTrainedModel,DistilBertTokenizer:()=>n.DistilBertTokenizer,DocumentQuestionAnsweringPipeline:()=>t.DocumentQuestionAnsweringPipeline,DonutFeatureExtractor:()=>M.DonutFeatureExtractor,DonutImageProcessor:()=>M.DonutImageProcessor,DonutSwinModel:()=>r.DonutSwinModel,DonutSwinPreTrainedModel:()=>r.DonutSwinPreTrainedModel,EfficientNetForImageClassification:()=>r.EfficientNetForImageClassification,EfficientNetImageProcessor:()=>M.EfficientNetImageProcessor,EfficientNetModel:()=>r.EfficientNetModel,EfficientNetPreTrainedModel:()=>r.EfficientNetPreTrainedModel,ElectraForMaskedLM:()=>r.ElectraForMaskedLM,ElectraForQuestionAnswering:()=>r.ElectraForQuestionAnswering,ElectraForSequenceClassification:()=>r.ElectraForSequenceClassification,ElectraForTokenClassification:()=>r.ElectraForTokenClassification,ElectraModel:()=>r.ElectraModel,ElectraPreTrainedModel:()=>r.ElectraPreTrainedModel,ElectraTokenizer:()=>n.ElectraTokenizer,EncodecFeatureExtractor:()=>g.EncodecFeatureExtractor,EosTokenCriteria:()=>D.EosTokenCriteria,Ernie4_5_ForCausalLM:()=>r.Ernie4_5_ForCausalLM,Ernie4_5_Model:()=>r.Ernie4_5_Model,Ernie4_5_PretrainedModel:()=>r.Ernie4_5_PretrainedModel,Ernie4_5_Tokenizer:()=>n.Ernie4_5_Tokenizer,EsmForMaskedLM:()=>r.EsmForMaskedLM,EsmForSequenceClassification:()=>r.EsmForSequenceClassification,EsmForTokenClassification:()=>r.EsmForTokenClassification,EsmModel:()=>r.EsmModel,EsmPreTrainedModel:()=>r.EsmPreTrainedModel,EsmTokenizer:()=>n.EsmTokenizer,ExaoneForCausalLM:()=>r.ExaoneForCausalLM,ExaoneModel:()=>r.ExaoneModel,ExaonePreTrainedModel:()=>r.ExaonePreTrainedModel,FFT:()=>d.FFT,FalconForCausalLM:()=>r.FalconForCausalLM,FalconModel:()=>r.FalconModel,FalconPreTrainedModel:()=>r.FalconPreTrainedModel,FalconTokenizer:()=>n.FalconTokenizer,FastViTForImageClassification:()=>r.FastViTForImageClassification,FastViTModel:()=>r.FastViTModel,FastViTPreTrainedModel:()=>r.FastViTPreTrainedModel,FeatureExtractionPipeline:()=>t.FeatureExtractionPipeline,FeatureExtractor:()=>m.FeatureExtractor,FillMaskPipeline:()=>t.FillMaskPipeline,Florence2ForConditionalGeneration:()=>r.Florence2ForConditionalGeneration,Florence2PreTrainedModel:()=>r.Florence2PreTrainedModel,Florence2Processor:()=>T.Florence2Processor,ForcedBOSTokenLogitsProcessor:()=>L.ForcedBOSTokenLogitsProcessor,ForcedEOSTokenLogitsProcessor:()=>L.ForcedEOSTokenLogitsProcessor,GLPNFeatureExtractor:()=>M.GLPNFeatureExtractor,GLPNForDepthEstimation:()=>r.GLPNForDepthEstimation,GLPNModel:()=>r.GLPNModel,GLPNPreTrainedModel:()=>r.GLPNPreTrainedModel,GPT2LMHeadModel:()=>r.GPT2LMHeadModel,GPT2Model:()=>r.GPT2Model,GPT2PreTrainedModel:()=>r.GPT2PreTrainedModel,GPT2Tokenizer:()=>n.GPT2Tokenizer,GPTBigCodeForCausalLM:()=>r.GPTBigCodeForCausalLM,GPTBigCodeModel:()=>r.GPTBigCodeModel,GPTBigCodePreTrainedModel:()=>r.GPTBigCodePreTrainedModel,GPTJForCausalLM:()=>r.GPTJForCausalLM,GPTJModel:()=>r.GPTJModel,GPTJPreTrainedModel:()=>r.GPTJPreTrainedModel,GPTNeoForCausalLM:()=>r.GPTNeoForCausalLM,GPTNeoModel:()=>r.GPTNeoModel,GPTNeoPreTrainedModel:()=>r.GPTNeoPreTrainedModel,GPTNeoXForCausalLM:()=>r.GPTNeoXForCausalLM,GPTNeoXModel:()=>r.GPTNeoXModel,GPTNeoXPreTrainedModel:()=>r.GPTNeoXPreTrainedModel,GPTNeoXTokenizer:()=>n.GPTNeoXTokenizer,Gemma2ForCausalLM:()=>r.Gemma2ForCausalLM,Gemma2Model:()=>r.Gemma2Model,Gemma2PreTrainedModel:()=>r.Gemma2PreTrainedModel,Gemma3ForCausalLM:()=>r.Gemma3ForCausalLM,Gemma3Model:()=>r.Gemma3Model,Gemma3PreTrainedModel:()=>r.Gemma3PreTrainedModel,Gemma3nAudioFeatureExtractor:()=>g.Gemma3nAudioFeatureExtractor,Gemma3nForConditionalGeneration:()=>r.Gemma3nForConditionalGeneration,Gemma3nPreTrainedModel:()=>r.Gemma3nPreTrainedModel,Gemma3nProcessor:()=>T.Gemma3nProcessor,GemmaForCausalLM:()=>r.GemmaForCausalLM,GemmaModel:()=>r.GemmaModel,GemmaPreTrainedModel:()=>r.GemmaPreTrainedModel,GemmaTokenizer:()=>n.GemmaTokenizer,GlmForCausalLM:()=>r.GlmForCausalLM,GlmModel:()=>r.GlmModel,GlmPreTrainedModel:()=>r.GlmPreTrainedModel,GraniteForCausalLM:()=>r.GraniteForCausalLM,GraniteModel:()=>r.GraniteModel,GranitePreTrainedModel:()=>r.GranitePreTrainedModel,Grok1Tokenizer:()=>n.Grok1Tokenizer,GroundingDinoForObjectDetection:()=>r.GroundingDinoForObjectDetection,GroundingDinoImageProcessor:()=>M.GroundingDinoImageProcessor,GroundingDinoPreTrainedModel:()=>r.GroundingDinoPreTrainedModel,GroundingDinoProcessor:()=>T.GroundingDinoProcessor,GroupViTModel:()=>r.GroupViTModel,GroupViTPreTrainedModel:()=>r.GroupViTPreTrainedModel,HeliumForCausalLM:()=>r.HeliumForCausalLM,HeliumModel:()=>r.HeliumModel,HeliumPreTrainedModel:()=>r.HeliumPreTrainedModel,HerbertTokenizer:()=>n.HerbertTokenizer,HieraForImageClassification:()=>r.HieraForImageClassification,HieraModel:()=>r.HieraModel,HieraPreTrainedModel:()=>r.HieraPreTrainedModel,HubertForCTC:()=>r.HubertForCTC,HubertForSequenceClassification:()=>r.HubertForSequenceClassification,HubertModel:()=>r.HubertModel,HubertPreTrainedModel:()=>r.HubertPreTrainedModel,IJepaForImageClassification:()=>r.IJepaForImageClassification,IJepaModel:()=>r.IJepaModel,IJepaPreTrainedModel:()=>r.IJepaPreTrainedModel,Idefics3ForConditionalGeneration:()=>r.Idefics3ForConditionalGeneration,Idefics3ImageProcessor:()=>M.Idefics3ImageProcessor,Idefics3PreTrainedModel:()=>r.Idefics3PreTrainedModel,Idefics3Processor:()=>T.Idefics3Processor,ImageClassificationPipeline:()=>t.ImageClassificationPipeline,ImageFeatureExtractionPipeline:()=>t.ImageFeatureExtractionPipeline,ImageFeatureExtractor:()=>g.ImageFeatureExtractor,ImageMattingOutput:()=>r.ImageMattingOutput,ImageProcessor:()=>y.ImageProcessor,ImageSegmentationPipeline:()=>t.ImageSegmentationPipeline,ImageToImagePipeline:()=>t.ImageToImagePipeline,ImageToTextPipeline:()=>t.ImageToTextPipeline,InterruptableStoppingCriteria:()=>D.InterruptableStoppingCriteria,JAISLMHeadModel:()=>r.JAISLMHeadModel,JAISModel:()=>r.JAISModel,JAISPreTrainedModel:()=>r.JAISPreTrainedModel,JinaCLIPImageProcessor:()=>M.JinaCLIPImageProcessor,JinaCLIPModel:()=>r.JinaCLIPModel,JinaCLIPPreTrainedModel:()=>r.JinaCLIPPreTrainedModel,JinaCLIPProcessor:()=>T.JinaCLIPProcessor,JinaCLIPTextModel:()=>r.JinaCLIPTextModel,JinaCLIPVisionModel:()=>r.JinaCLIPVisionModel,Lfm2ForCausalLM:()=>r.Lfm2ForCausalLM,Lfm2Model:()=>r.Lfm2Model,Lfm2PreTrainedModel:()=>r.Lfm2PreTrainedModel,LiteWhisperForConditionalGeneration:()=>r.LiteWhisperForConditionalGeneration,LlamaForCausalLM:()=>r.LlamaForCausalLM,LlamaModel:()=>r.LlamaModel,LlamaPreTrainedModel:()=>r.LlamaPreTrainedModel,LlamaTokenizer:()=>n.LlamaTokenizer,LlavaForConditionalGeneration:()=>r.LlavaForConditionalGeneration,LlavaOnevisionForConditionalGeneration:()=>r.LlavaOnevisionForConditionalGeneration,LlavaOnevisionImageProcessor:()=>M.LlavaOnevisionImageProcessor,LlavaPreTrainedModel:()=>r.LlavaPreTrainedModel,LlavaProcessor:()=>T.LlavaProcessor,LlavaQwen2ForCausalLM:()=>r.LlavaQwen2ForCausalLM,LogitsProcessor:()=>L.LogitsProcessor,LogitsProcessorList:()=>L.LogitsProcessorList,LogitsWarper:()=>L.LogitsWarper,LongT5ForConditionalGeneration:()=>r.LongT5ForConditionalGeneration,LongT5Model:()=>r.LongT5Model,LongT5PreTrainedModel:()=>r.LongT5PreTrainedModel,M2M100ForConditionalGeneration:()=>r.M2M100ForConditionalGeneration,M2M100Model:()=>r.M2M100Model,M2M100PreTrainedModel:()=>r.M2M100PreTrainedModel,M2M100Tokenizer:()=>n.M2M100Tokenizer,MBart50Tokenizer:()=>n.MBart50Tokenizer,MBartForCausalLM:()=>r.MBartForCausalLM,MBartForConditionalGeneration:()=>r.MBartForConditionalGeneration,MBartForSequenceClassification:()=>r.MBartForSequenceClassification,MBartModel:()=>r.MBartModel,MBartPreTrainedModel:()=>r.MBartPreTrainedModel,MBartTokenizer:()=>n.MBartTokenizer,MPNetForMaskedLM:()=>r.MPNetForMaskedLM,MPNetForQuestionAnswering:()=>r.MPNetForQuestionAnswering,MPNetForSequenceClassification:()=>r.MPNetForSequenceClassification,MPNetForTokenClassification:()=>r.MPNetForTokenClassification,MPNetModel:()=>r.MPNetModel,MPNetPreTrainedModel:()=>r.MPNetPreTrainedModel,MPNetTokenizer:()=>n.MPNetTokenizer,MT5ForConditionalGeneration:()=>r.MT5ForConditionalGeneration,MT5Model:()=>r.MT5Model,MT5PreTrainedModel:()=>r.MT5PreTrainedModel,MarianMTModel:()=>r.MarianMTModel,MarianModel:()=>r.MarianModel,MarianPreTrainedModel:()=>r.MarianPreTrainedModel,MarianTokenizer:()=>n.MarianTokenizer,Mask2FormerImageProcessor:()=>M.Mask2FormerImageProcessor,MaskFormerFeatureExtractor:()=>M.MaskFormerFeatureExtractor,MaskFormerForInstanceSegmentation:()=>r.MaskFormerForInstanceSegmentation,MaskFormerImageProcessor:()=>M.MaskFormerImageProcessor,MaskFormerModel:()=>r.MaskFormerModel,MaskFormerPreTrainedModel:()=>r.MaskFormerPreTrainedModel,MaskedLMOutput:()=>r.MaskedLMOutput,MaxLengthCriteria:()=>D.MaxLengthCriteria,Metric3DForDepthEstimation:()=>r.Metric3DForDepthEstimation,Metric3DPreTrainedModel:()=>r.Metric3DPreTrainedModel,Metric3Dv2ForDepthEstimation:()=>r.Metric3Dv2ForDepthEstimation,Metric3Dv2PreTrainedModel:()=>r.Metric3Dv2PreTrainedModel,MgpstrForSceneTextRecognition:()=>r.MgpstrForSceneTextRecognition,MgpstrModelOutput:()=>r.MgpstrModelOutput,MgpstrPreTrainedModel:()=>r.MgpstrPreTrainedModel,MgpstrProcessor:()=>T.MgpstrProcessor,MgpstrTokenizer:()=>n.MgpstrTokenizer,MimiDecoderModel:()=>r.MimiDecoderModel,MimiDecoderOutput:()=>r.MimiDecoderOutput,MimiEncoderModel:()=>r.MimiEncoderModel,MimiEncoderOutput:()=>r.MimiEncoderOutput,MimiModel:()=>r.MimiModel,MimiPreTrainedModel:()=>r.MimiPreTrainedModel,MinLengthLogitsProcessor:()=>L.MinLengthLogitsProcessor,MinNewTokensLengthLogitsProcessor:()=>L.MinNewTokensLengthLogitsProcessor,MistralForCausalLM:()=>r.MistralForCausalLM,MistralModel:()=>r.MistralModel,MistralPreTrainedModel:()=>r.MistralPreTrainedModel,MobileBertForMaskedLM:()=>r.MobileBertForMaskedLM,MobileBertForQuestionAnswering:()=>r.MobileBertForQuestionAnswering,MobileBertForSequenceClassification:()=>r.MobileBertForSequenceClassification,MobileBertModel:()=>r.MobileBertModel,MobileBertPreTrainedModel:()=>r.MobileBertPreTrainedModel,MobileBertTokenizer:()=>n.MobileBertTokenizer,MobileLLMForCausalLM:()=>r.MobileLLMForCausalLM,MobileLLMModel:()=>r.MobileLLMModel,MobileLLMPreTrainedModel:()=>r.MobileLLMPreTrainedModel,MobileNetV1FeatureExtractor:()=>M.MobileNetV1FeatureExtractor,MobileNetV1ForImageClassification:()=>r.MobileNetV1ForImageClassification,MobileNetV1ForSemanticSegmentation:()=>r.MobileNetV1ForSemanticSegmentation,MobileNetV1ImageProcessor:()=>M.MobileNetV1ImageProcessor,MobileNetV1Model:()=>r.MobileNetV1Model,MobileNetV1PreTrainedModel:()=>r.MobileNetV1PreTrainedModel,MobileNetV2FeatureExtractor:()=>M.MobileNetV2FeatureExtractor,MobileNetV2ForImageClassification:()=>r.MobileNetV2ForImageClassification,MobileNetV2ForSemanticSegmentation:()=>r.MobileNetV2ForSemanticSegmentation,MobileNetV2ImageProcessor:()=>M.MobileNetV2ImageProcessor,MobileNetV2Model:()=>r.MobileNetV2Model,MobileNetV2PreTrainedModel:()=>r.MobileNetV2PreTrainedModel,MobileNetV3FeatureExtractor:()=>M.MobileNetV3FeatureExtractor,MobileNetV3ForImageClassification:()=>r.MobileNetV3ForImageClassification,MobileNetV3ForSemanticSegmentation:()=>r.MobileNetV3ForSemanticSegmentation,MobileNetV3ImageProcessor:()=>M.MobileNetV3ImageProcessor,MobileNetV3Model:()=>r.MobileNetV3Model,MobileNetV3PreTrainedModel:()=>r.MobileNetV3PreTrainedModel,MobileNetV4FeatureExtractor:()=>M.MobileNetV4FeatureExtractor,MobileNetV4ForImageClassification:()=>r.MobileNetV4ForImageClassification,MobileNetV4ForSemanticSegmentation:()=>r.MobileNetV4ForSemanticSegmentation,MobileNetV4ImageProcessor:()=>M.MobileNetV4ImageProcessor,MobileNetV4Model:()=>r.MobileNetV4Model,MobileNetV4PreTrainedModel:()=>r.MobileNetV4PreTrainedModel,MobileViTFeatureExtractor:()=>M.MobileViTFeatureExtractor,MobileViTForImageClassification:()=>r.MobileViTForImageClassification,MobileViTImageProcessor:()=>M.MobileViTImageProcessor,MobileViTModel:()=>r.MobileViTModel,MobileViTPreTrainedModel:()=>r.MobileViTPreTrainedModel,MobileViTV2ForImageClassification:()=>r.MobileViTV2ForImageClassification,MobileViTV2Model:()=>r.MobileViTV2Model,MobileViTV2PreTrainedModel:()=>r.MobileViTV2PreTrainedModel,ModelOutput:()=>r.ModelOutput,ModernBertDecoderForCausalLM:()=>r.ModernBertDecoderForCausalLM,ModernBertDecoderModel:()=>r.ModernBertDecoderModel,ModernBertDecoderPreTrainedModel:()=>r.ModernBertDecoderPreTrainedModel,ModernBertForMaskedLM:()=>r.ModernBertForMaskedLM,ModernBertForSequenceClassification:()=>r.ModernBertForSequenceClassification,ModernBertForTokenClassification:()=>r.ModernBertForTokenClassification,ModernBertModel:()=>r.ModernBertModel,ModernBertPreTrainedModel:()=>r.ModernBertPreTrainedModel,Moondream1ForConditionalGeneration:()=>r.Moondream1ForConditionalGeneration,MoonshineFeatureExtractor:()=>g.MoonshineFeatureExtractor,MoonshineForConditionalGeneration:()=>r.MoonshineForConditionalGeneration,MoonshineModel:()=>r.MoonshineModel,MoonshinePreTrainedModel:()=>r.MoonshinePreTrainedModel,MoonshineProcessor:()=>T.MoonshineProcessor,MptForCausalLM:()=>r.MptForCausalLM,MptModel:()=>r.MptModel,MptPreTrainedModel:()=>r.MptPreTrainedModel,MultiModalityCausalLM:()=>r.MultiModalityCausalLM,MultiModalityPreTrainedModel:()=>r.MultiModalityPreTrainedModel,MusicgenForCausalLM:()=>r.MusicgenForCausalLM,MusicgenForConditionalGeneration:()=>r.MusicgenForConditionalGeneration,MusicgenModel:()=>r.MusicgenModel,MusicgenPreTrainedModel:()=>r.MusicgenPreTrainedModel,NeoBertForMaskedLM:()=>r.NeoBertForMaskedLM,NeoBertForQuestionAnswering:()=>r.NeoBertForQuestionAnswering,NeoBertForSequenceClassification:()=>r.NeoBertForSequenceClassification,NeoBertForTokenClassification:()=>r.NeoBertForTokenClassification,NeoBertModel:()=>r.NeoBertModel,NeoBertPreTrainedModel:()=>r.NeoBertPreTrainedModel,NllbTokenizer:()=>n.NllbTokenizer,NoBadWordsLogitsProcessor:()=>L.NoBadWordsLogitsProcessor,NoRepeatNGramLogitsProcessor:()=>L.NoRepeatNGramLogitsProcessor,NomicBertModel:()=>r.NomicBertModel,NomicBertPreTrainedModel:()=>r.NomicBertPreTrainedModel,NougatImageProcessor:()=>M.NougatImageProcessor,NougatTokenizer:()=>n.NougatTokenizer,OPTForCausalLM:()=>r.OPTForCausalLM,OPTModel:()=>r.OPTModel,OPTPreTrainedModel:()=>r.OPTPreTrainedModel,ObjectDetectionPipeline:()=>t.ObjectDetectionPipeline,Olmo2ForCausalLM:()=>r.Olmo2ForCausalLM,Olmo2Model:()=>r.Olmo2Model,Olmo2PreTrainedModel:()=>r.Olmo2PreTrainedModel,OlmoForCausalLM:()=>r.OlmoForCausalLM,OlmoModel:()=>r.OlmoModel,OlmoPreTrainedModel:()=>r.OlmoPreTrainedModel,OpenELMForCausalLM:()=>r.OpenELMForCausalLM,OpenELMModel:()=>r.OpenELMModel,OpenELMPreTrainedModel:()=>r.OpenELMPreTrainedModel,OwlViTFeatureExtractor:()=>M.OwlViTFeatureExtractor,OwlViTForObjectDetection:()=>r.OwlViTForObjectDetection,OwlViTImageProcessor:()=>M.OwlViTImageProcessor,OwlViTModel:()=>r.OwlViTModel,OwlViTPreTrainedModel:()=>r.OwlViTPreTrainedModel,OwlViTProcessor:()=>T.OwlViTProcessor,Owlv2ForObjectDetection:()=>r.Owlv2ForObjectDetection,Owlv2ImageProcessor:()=>M.Owlv2ImageProcessor,Owlv2Model:()=>r.Owlv2Model,Owlv2PreTrainedModel:()=>r.Owlv2PreTrainedModel,PaliGemmaForConditionalGeneration:()=>r.PaliGemmaForConditionalGeneration,PaliGemmaPreTrainedModel:()=>r.PaliGemmaPreTrainedModel,PaliGemmaProcessor:()=>T.PaliGemmaProcessor,PatchTSMixerForPrediction:()=>r.PatchTSMixerForPrediction,PatchTSMixerModel:()=>r.PatchTSMixerModel,PatchTSMixerPreTrainedModel:()=>r.PatchTSMixerPreTrainedModel,PatchTSTForPrediction:()=>r.PatchTSTForPrediction,PatchTSTModel:()=>r.PatchTSTModel,PatchTSTPreTrainedModel:()=>r.PatchTSTPreTrainedModel,Phi3ForCausalLM:()=>r.Phi3ForCausalLM,Phi3Model:()=>r.Phi3Model,Phi3PreTrainedModel:()=>r.Phi3PreTrainedModel,Phi3VForCausalLM:()=>r.Phi3VForCausalLM,Phi3VImageProcessor:()=>M.Phi3VImageProcessor,Phi3VPreTrainedModel:()=>r.Phi3VPreTrainedModel,Phi3VProcessor:()=>T.Phi3VProcessor,PhiForCausalLM:()=>r.PhiForCausalLM,PhiModel:()=>r.PhiModel,PhiPreTrainedModel:()=>r.PhiPreTrainedModel,Pipeline:()=>t.Pipeline,PreTrainedModel:()=>r.PreTrainedModel,PreTrainedTokenizer:()=>n.PreTrainedTokenizer,PretrainedConfig:()=>i.PretrainedConfig,PretrainedMixin:()=>r.PretrainedMixin,Processor:()=>E.Processor,PvtForImageClassification:()=>r.PvtForImageClassification,PvtImageProcessor:()=>M.PvtImageProcessor,PvtModel:()=>r.PvtModel,PvtPreTrainedModel:()=>r.PvtPreTrainedModel,PyAnnoteFeatureExtractor:()=>g.PyAnnoteFeatureExtractor,PyAnnoteForAudioFrameClassification:()=>r.PyAnnoteForAudioFrameClassification,PyAnnoteModel:()=>r.PyAnnoteModel,PyAnnotePreTrainedModel:()=>r.PyAnnotePreTrainedModel,PyAnnoteProcessor:()=>T.PyAnnoteProcessor,QuestionAnsweringModelOutput:()=>r.QuestionAnsweringModelOutput,QuestionAnsweringPipeline:()=>t.QuestionAnsweringPipeline,Qwen2ForCausalLM:()=>r.Qwen2ForCausalLM,Qwen2Model:()=>r.Qwen2Model,Qwen2PreTrainedModel:()=>r.Qwen2PreTrainedModel,Qwen2Tokenizer:()=>n.Qwen2Tokenizer,Qwen2VLForConditionalGeneration:()=>r.Qwen2VLForConditionalGeneration,Qwen2VLImageProcessor:()=>M.Qwen2VLImageProcessor,Qwen2VLPreTrainedModel:()=>r.Qwen2VLPreTrainedModel,Qwen2VLProcessor:()=>T.Qwen2VLProcessor,Qwen3ForCausalLM:()=>r.Qwen3ForCausalLM,Qwen3Model:()=>r.Qwen3Model,Qwen3PreTrainedModel:()=>r.Qwen3PreTrainedModel,RFDetrForObjectDetection:()=>r.RFDetrForObjectDetection,RFDetrModel:()=>r.RFDetrModel,RFDetrObjectDetectionOutput:()=>r.RFDetrObjectDetectionOutput,RFDetrPreTrainedModel:()=>r.RFDetrPreTrainedModel,RTDetrForObjectDetection:()=>r.RTDetrForObjectDetection,RTDetrImageProcessor:()=>M.RTDetrImageProcessor,RTDetrModel:()=>r.RTDetrModel,RTDetrObjectDetectionOutput:()=>r.RTDetrObjectDetectionOutput,RTDetrPreTrainedModel:()=>r.RTDetrPreTrainedModel,RTDetrV2ForObjectDetection:()=>r.RTDetrV2ForObjectDetection,RTDetrV2Model:()=>r.RTDetrV2Model,RTDetrV2ObjectDetectionOutput:()=>r.RTDetrV2ObjectDetectionOutput,RTDetrV2PreTrainedModel:()=>r.RTDetrV2PreTrainedModel,RawAudio:()=>o.RawAudio,RawImage:()=>s.RawImage,RawVideo:()=>a.RawVideo,RawVideoFrame:()=>a.RawVideoFrame,RepetitionPenaltyLogitsProcessor:()=>L.RepetitionPenaltyLogitsProcessor,ResNetForImageClassification:()=>r.ResNetForImageClassification,ResNetModel:()=>r.ResNetModel,ResNetPreTrainedModel:()=>r.ResNetPreTrainedModel,RoFormerForMaskedLM:()=>r.RoFormerForMaskedLM,RoFormerForQuestionAnswering:()=>r.RoFormerForQuestionAnswering,RoFormerForSequenceClassification:()=>r.RoFormerForSequenceClassification,RoFormerForTokenClassification:()=>r.RoFormerForTokenClassification,RoFormerModel:()=>r.RoFormerModel,RoFormerPreTrainedModel:()=>r.RoFormerPreTrainedModel,RoFormerTokenizer:()=>n.RoFormerTokenizer,RobertaForMaskedLM:()=>r.RobertaForMaskedLM,RobertaForQuestionAnswering:()=>r.RobertaForQuestionAnswering,RobertaForSequenceClassification:()=>r.RobertaForSequenceClassification,RobertaForTokenClassification:()=>r.RobertaForTokenClassification,RobertaModel:()=>r.RobertaModel,RobertaPreTrainedModel:()=>r.RobertaPreTrainedModel,RobertaTokenizer:()=>n.RobertaTokenizer,SamImageProcessor:()=>M.SamImageProcessor,SamImageSegmentationOutput:()=>r.SamImageSegmentationOutput,SamModel:()=>r.SamModel,SamPreTrainedModel:()=>r.SamPreTrainedModel,SamProcessor:()=>T.SamProcessor,SapiensForDepthEstimation:()=>r.SapiensForDepthEstimation,SapiensForNormalEstimation:()=>r.SapiensForNormalEstimation,SapiensForSemanticSegmentation:()=>r.SapiensForSemanticSegmentation,SapiensPreTrainedModel:()=>r.SapiensPreTrainedModel,SeamlessM4TFeatureExtractor:()=>g.SeamlessM4TFeatureExtractor,SegformerFeatureExtractor:()=>M.SegformerFeatureExtractor,SegformerForImageClassification:()=>r.SegformerForImageClassification,SegformerForSemanticSegmentation:()=>r.SegformerForSemanticSegmentation,SegformerImageProcessor:()=>M.SegformerImageProcessor,SegformerModel:()=>r.SegformerModel,SegformerPreTrainedModel:()=>r.SegformerPreTrainedModel,Seq2SeqLMOutput:()=>r.Seq2SeqLMOutput,SequenceClassifierOutput:()=>r.SequenceClassifierOutput,SiglipImageProcessor:()=>M.SiglipImageProcessor,SiglipModel:()=>r.SiglipModel,SiglipPreTrainedModel:()=>r.SiglipPreTrainedModel,SiglipTextModel:()=>r.SiglipTextModel,SiglipTokenizer:()=>n.SiglipTokenizer,SiglipVisionModel:()=>r.SiglipVisionModel,SmolLM3ForCausalLM:()=>r.SmolLM3ForCausalLM,SmolLM3Model:()=>r.SmolLM3Model,SmolLM3PreTrainedModel:()=>r.SmolLM3PreTrainedModel,SmolVLMForConditionalGeneration:()=>r.SmolVLMForConditionalGeneration,SmolVLMImageProcessor:()=>M.SmolVLMImageProcessor,SmolVLMProcessor:()=>T.SmolVLMProcessor,SnacDecoderModel:()=>r.SnacDecoderModel,SnacEncoderModel:()=>r.SnacEncoderModel,SnacFeatureExtractor:()=>g.SnacFeatureExtractor,SnacModel:()=>r.SnacModel,SnacPreTrainedModel:()=>r.SnacPreTrainedModel,SpeechT5FeatureExtractor:()=>g.SpeechT5FeatureExtractor,SpeechT5ForSpeechToText:()=>r.SpeechT5ForSpeechToText,SpeechT5ForTextToSpeech:()=>r.SpeechT5ForTextToSpeech,SpeechT5HifiGan:()=>r.SpeechT5HifiGan,SpeechT5Model:()=>r.SpeechT5Model,SpeechT5PreTrainedModel:()=>r.SpeechT5PreTrainedModel,SpeechT5Processor:()=>T.SpeechT5Processor,SpeechT5Tokenizer:()=>n.SpeechT5Tokenizer,SqueezeBertForMaskedLM:()=>r.SqueezeBertForMaskedLM,SqueezeBertForQuestionAnswering:()=>r.SqueezeBertForQuestionAnswering,SqueezeBertForSequenceClassification:()=>r.SqueezeBertForSequenceClassification,SqueezeBertModel:()=>r.SqueezeBertModel,SqueezeBertPreTrainedModel:()=>r.SqueezeBertPreTrainedModel,SqueezeBertTokenizer:()=>n.SqueezeBertTokenizer,StableLmForCausalLM:()=>r.StableLmForCausalLM,StableLmModel:()=>r.StableLmModel,StableLmPreTrainedModel:()=>r.StableLmPreTrainedModel,Starcoder2ForCausalLM:()=>r.Starcoder2ForCausalLM,Starcoder2Model:()=>r.Starcoder2Model,Starcoder2PreTrainedModel:()=>r.Starcoder2PreTrainedModel,StoppingCriteria:()=>D.StoppingCriteria,StoppingCriteriaList:()=>D.StoppingCriteriaList,StyleTextToSpeech2Model:()=>r.StyleTextToSpeech2Model,StyleTextToSpeech2PreTrainedModel:()=>r.StyleTextToSpeech2PreTrainedModel,SummarizationPipeline:()=>t.SummarizationPipeline,SuppressTokensAtBeginLogitsProcessor:()=>L.SuppressTokensAtBeginLogitsProcessor,Swin2SRForImageSuperResolution:()=>r.Swin2SRForImageSuperResolution,Swin2SRImageProcessor:()=>M.Swin2SRImageProcessor,Swin2SRModel:()=>r.Swin2SRModel,Swin2SRPreTrainedModel:()=>r.Swin2SRPreTrainedModel,SwinForImageClassification:()=>r.SwinForImageClassification,SwinForSemanticSegmentation:()=>r.SwinForSemanticSegmentation,SwinModel:()=>r.SwinModel,SwinPreTrainedModel:()=>r.SwinPreTrainedModel,T5ForConditionalGeneration:()=>r.T5ForConditionalGeneration,T5Model:()=>r.T5Model,T5PreTrainedModel:()=>r.T5PreTrainedModel,T5Tokenizer:()=>n.T5Tokenizer,TableTransformerForObjectDetection:()=>r.TableTransformerForObjectDetection,TableTransformerModel:()=>r.TableTransformerModel,TableTransformerObjectDetectionOutput:()=>r.TableTransformerObjectDetectionOutput,TableTransformerPreTrainedModel:()=>r.TableTransformerPreTrainedModel,TemperatureLogitsWarper:()=>L.TemperatureLogitsWarper,Tensor:()=>u.Tensor,Text2TextGenerationPipeline:()=>t.Text2TextGenerationPipeline,TextClassificationPipeline:()=>t.TextClassificationPipeline,TextGenerationPipeline:()=>t.TextGenerationPipeline,TextStreamer:()=>C.TextStreamer,TextToAudioPipeline:()=>t.TextToAudioPipeline,TokenClassificationPipeline:()=>t.TokenClassificationPipeline,TokenClassifierOutput:()=>r.TokenClassifierOutput,TokenizerModel:()=>n.TokenizerModel,TopKLogitsWarper:()=>L.TopKLogitsWarper,TopPLogitsWarper:()=>L.TopPLogitsWarper,TrOCRForCausalLM:()=>r.TrOCRForCausalLM,TrOCRPreTrainedModel:()=>r.TrOCRPreTrainedModel,TranslationPipeline:()=>t.TranslationPipeline,UltravoxModel:()=>r.UltravoxModel,UltravoxPreTrainedModel:()=>r.UltravoxPreTrainedModel,UltravoxProcessor:()=>T.UltravoxProcessor,UniSpeechForCTC:()=>r.UniSpeechForCTC,UniSpeechForSequenceClassification:()=>r.UniSpeechForSequenceClassification,UniSpeechModel:()=>r.UniSpeechModel,UniSpeechPreTrainedModel:()=>r.UniSpeechPreTrainedModel,UniSpeechSatForAudioFrameClassification:()=>r.UniSpeechSatForAudioFrameClassification,UniSpeechSatForCTC:()=>r.UniSpeechSatForCTC,UniSpeechSatForSequenceClassification:()=>r.UniSpeechSatForSequenceClassification,UniSpeechSatModel:()=>r.UniSpeechSatModel,UniSpeechSatPreTrainedModel:()=>r.UniSpeechSatPreTrainedModel,VLChatProcessor:()=>T.VLChatProcessor,VLMImageProcessor:()=>M.VLMImageProcessor,ViTFeatureExtractor:()=>M.ViTFeatureExtractor,ViTForImageClassification:()=>r.ViTForImageClassification,ViTImageProcessor:()=>M.ViTImageProcessor,ViTMAEModel:()=>r.ViTMAEModel,ViTMAEPreTrainedModel:()=>r.ViTMAEPreTrainedModel,ViTMSNForImageClassification:()=>r.ViTMSNForImageClassification,ViTMSNModel:()=>r.ViTMSNModel,ViTMSNPreTrainedModel:()=>r.ViTMSNPreTrainedModel,ViTModel:()=>r.ViTModel,ViTPreTrainedModel:()=>r.ViTPreTrainedModel,VisionEncoderDecoderModel:()=>r.VisionEncoderDecoderModel,VitMatteForImageMatting:()=>r.VitMatteForImageMatting,VitMatteImageProcessor:()=>M.VitMatteImageProcessor,VitMattePreTrainedModel:()=>r.VitMattePreTrainedModel,VitPoseForPoseEstimation:()=>r.VitPoseForPoseEstimation,VitPoseImageProcessor:()=>M.VitPoseImageProcessor,VitPosePreTrainedModel:()=>r.VitPosePreTrainedModel,VitsModel:()=>r.VitsModel,VitsModelOutput:()=>r.VitsModelOutput,VitsPreTrainedModel:()=>r.VitsPreTrainedModel,VitsTokenizer:()=>n.VitsTokenizer,VoxtralForConditionalGeneration:()=>r.VoxtralForConditionalGeneration,VoxtralProcessor:()=>T.VoxtralProcessor,Wav2Vec2BertForCTC:()=>r.Wav2Vec2BertForCTC,Wav2Vec2BertForSequenceClassification:()=>r.Wav2Vec2BertForSequenceClassification,Wav2Vec2BertModel:()=>r.Wav2Vec2BertModel,Wav2Vec2BertPreTrainedModel:()=>r.Wav2Vec2BertPreTrainedModel,Wav2Vec2CTCTokenizer:()=>n.Wav2Vec2CTCTokenizer,Wav2Vec2FeatureExtractor:()=>g.Wav2Vec2FeatureExtractor,Wav2Vec2ForAudioFrameClassification:()=>r.Wav2Vec2ForAudioFrameClassification,Wav2Vec2ForCTC:()=>r.Wav2Vec2ForCTC,Wav2Vec2ForSequenceClassification:()=>r.Wav2Vec2ForSequenceClassification,Wav2Vec2Model:()=>r.Wav2Vec2Model,Wav2Vec2PreTrainedModel:()=>r.Wav2Vec2PreTrainedModel,Wav2Vec2Processor:()=>T.Wav2Vec2Processor,Wav2Vec2ProcessorWithLM:()=>T.Wav2Vec2ProcessorWithLM,WavLMForAudioFrameClassification:()=>r.WavLMForAudioFrameClassification,WavLMForCTC:()=>r.WavLMForCTC,WavLMForSequenceClassification:()=>r.WavLMForSequenceClassification,WavLMForXVector:()=>r.WavLMForXVector,WavLMModel:()=>r.WavLMModel,WavLMPreTrainedModel:()=>r.WavLMPreTrainedModel,WeSpeakerFeatureExtractor:()=>g.WeSpeakerFeatureExtractor,WeSpeakerResNetModel:()=>r.WeSpeakerResNetModel,WeSpeakerResNetPreTrainedModel:()=>r.WeSpeakerResNetPreTrainedModel,WhisperFeatureExtractor:()=>g.WhisperFeatureExtractor,WhisperForConditionalGeneration:()=>r.WhisperForConditionalGeneration,WhisperModel:()=>r.WhisperModel,WhisperPreTrainedModel:()=>r.WhisperPreTrainedModel,WhisperProcessor:()=>T.WhisperProcessor,WhisperTextStreamer:()=>C.WhisperTextStreamer,WhisperTimeStampLogitsProcessor:()=>L.WhisperTimeStampLogitsProcessor,WhisperTokenizer:()=>n.WhisperTokenizer,XLMForQuestionAnswering:()=>r.XLMForQuestionAnswering,XLMForSequenceClassification:()=>r.XLMForSequenceClassification,XLMForTokenClassification:()=>r.XLMForTokenClassification,XLMModel:()=>r.XLMModel,XLMPreTrainedModel:()=>r.XLMPreTrainedModel,XLMRobertaForMaskedLM:()=>r.XLMRobertaForMaskedLM,XLMRobertaForQuestionAnswering:()=>r.XLMRobertaForQuestionAnswering,XLMRobertaForSequenceClassification:()=>r.XLMRobertaForSequenceClassification,XLMRobertaForTokenClassification:()=>r.XLMRobertaForTokenClassification,XLMRobertaModel:()=>r.XLMRobertaModel,XLMRobertaPreTrainedModel:()=>r.XLMRobertaPreTrainedModel,XLMRobertaTokenizer:()=>n.XLMRobertaTokenizer,XLMTokenizer:()=>n.XLMTokenizer,XLMWithLMHeadModel:()=>r.XLMWithLMHeadModel,XVectorOutput:()=>r.XVectorOutput,YolosFeatureExtractor:()=>M.YolosFeatureExtractor,YolosForObjectDetection:()=>r.YolosForObjectDetection,YolosImageProcessor:()=>M.YolosImageProcessor,YolosModel:()=>r.YolosModel,YolosObjectDetectionOutput:()=>r.YolosObjectDetectionOutput,YolosPreTrainedModel:()=>r.YolosPreTrainedModel,ZeroShotAudioClassificationPipeline:()=>t.ZeroShotAudioClassificationPipeline,ZeroShotClassificationPipeline:()=>t.ZeroShotClassificationPipeline,ZeroShotImageClassificationPipeline:()=>t.ZeroShotImageClassificationPipeline,ZeroShotObjectDetectionPipeline:()=>t.ZeroShotObjectDetectionPipeline,bankers_round:()=>d.bankers_round,cat:()=>u.cat,cos_sim:()=>d.cos_sim,dot:()=>d.dot,dynamic_time_warping:()=>d.dynamic_time_warping,env:()=>e.env,full:()=>u.full,full_like:()=>u.full_like,getCacheShapes:()=>i.getCacheShapes,hamming:()=>o.hamming,hanning:()=>o.hanning,interpolate:()=>u.interpolate,interpolate_4d:()=>u.interpolate_4d,interpolate_data:()=>d.interpolate_data,is_chinese_char:()=>n.is_chinese_char,layer_norm:()=>u.layer_norm,load_image:()=>s.load_image,load_video:()=>a.load_video,log_softmax:()=>d.log_softmax,magnitude:()=>d.magnitude,matmul:()=>u.matmul,max:()=>d.max,mean:()=>u.mean,mean_pooling:()=>u.mean_pooling,medianFilter:()=>d.medianFilter,mel_filter_bank:()=>o.mel_filter_bank,min:()=>d.min,ones:()=>u.ones,ones_like:()=>u.ones_like,permute:()=>u.permute,permute_data:()=>d.permute_data,pipeline:()=>t.pipeline,quantize_embeddings:()=>u.quantize_embeddings,rand:()=>u.rand,read_audio:()=>o.read_audio,rfft:()=>u.rfft,round:()=>d.round,slice:()=>u.slice,softmax:()=>d.softmax,spectrogram:()=>o.spectrogram,stack:()=>u.stack,std_mean:()=>u.std_mean,topk:()=>u.topk,window_function:()=>o.window_function,zeros:()=>u.zeros,zeros_like:()=>u.zeros_like});var e=Yo("./src/env.js"),t=Yo("./src/pipelines.js"),r=Yo("./src/models.js"),n=Yo("./src/tokenizers.js"),i=Yo("./src/configs.js"),o=Yo("./src/utils/audio.js"),s=Yo("./src/utils/image.js"),a=Yo("./src/utils/video.js"),u=Yo("./src/utils/tensor.js"),d=Yo("./src/utils/maths.js"),m=Yo("./src/base/feature_extraction_utils.js"),g=Yo("./src/models/feature_extractors.js"),_=Yo("./src/models/auto/feature_extraction_auto.js"),y=Yo("./src/base/image_processors_utils.js"),M=Yo("./src/models/image_processors.js"),x=Yo("./src/models/auto/image_processing_auto.js"),E=Yo("./src/base/processing_utils.js"),T=Yo("./src/models/processors.js"),P=Yo("./src/models/auto/processing_auto.js"),C=Yo("./src/generation/streamers.js"),D=Yo("./src/generation/stopping_criteria.js"),L=Yo("./src/generation/logits_process.js")})();Q.ASTFeatureExtractor;Q.ASTForAudioClassification;Q.ASTModel;Q.ASTPreTrainedModel;Q.AlbertForMaskedLM;Q.AlbertForQuestionAnswering;Q.AlbertForSequenceClassification;Q.AlbertModel;Q.AlbertPreTrainedModel;Q.AlbertTokenizer;Q.ArceeForCausalLM;Q.ArceeModel;Q.ArceePreTrainedModel;Q.AudioClassificationPipeline;Q.AutoConfig;Q.AutoFeatureExtractor;Q.AutoImageProcessor;Q.AutoModel;Q.AutoModelForAudioClassification;Q.AutoModelForAudioFrameClassification;Q.AutoModelForAudioTextToText;Q.AutoModelForCTC;Q.AutoModelForCausalLM;Q.AutoModelForDepthEstimation;Q.AutoModelForDocumentQuestionAnswering;Q.AutoModelForImageClassification;Q.AutoModelForImageFeatureExtraction;Q.AutoModelForImageMatting;Q.AutoModelForImageSegmentation;Q.AutoModelForImageTextToText;Q.AutoModelForImageToImage;Q.AutoModelForMaskGeneration;Q.AutoModelForMaskedLM;Q.AutoModelForNormalEstimation;Q.AutoModelForObjectDetection;Q.AutoModelForPoseEstimation;Q.AutoModelForQuestionAnswering;Q.AutoModelForSemanticSegmentation;Q.AutoModelForSeq2SeqLM;Q.AutoModelForSequenceClassification;Q.AutoModelForSpeechSeq2Seq;Q.AutoModelForTextToSpectrogram;Q.AutoModelForTextToWaveform;Q.AutoModelForTokenClassification;Q.AutoModelForUniversalSegmentation;Q.AutoModelForVision2Seq;Q.AutoModelForXVector;Q.AutoModelForZeroShotObjectDetection;Q.AutoProcessor;Q.AutoTokenizer;Q.AutomaticSpeechRecognitionPipeline;Q.BackgroundRemovalPipeline;Q.BartForConditionalGeneration;Q.BartForSequenceClassification;Q.BartModel;Q.BartPretrainedModel;Q.BartTokenizer;Q.BaseModelOutput;Q.BaseStreamer;Q.BeitFeatureExtractor;Q.BeitForImageClassification;Q.BeitModel;Q.BeitPreTrainedModel;Q.BertForMaskedLM;Q.BertForQuestionAnswering;Q.BertForSequenceClassification;Q.BertForTokenClassification;Q.BertModel;Q.BertPreTrainedModel;Q.BertTokenizer;Q.BitImageProcessor;Q.BlenderbotForConditionalGeneration;Q.BlenderbotModel;Q.BlenderbotPreTrainedModel;Q.BlenderbotSmallForConditionalGeneration;Q.BlenderbotSmallModel;Q.BlenderbotSmallPreTrainedModel;Q.BlenderbotSmallTokenizer;Q.BlenderbotTokenizer;Q.BloomForCausalLM;Q.BloomModel;Q.BloomPreTrainedModel;Q.BloomTokenizer;Q.CLIPFeatureExtractor;Q.CLIPImageProcessor;Q.CLIPModel;Q.CLIPPreTrainedModel;Q.CLIPSegForImageSegmentation;Q.CLIPSegModel;Q.CLIPSegPreTrainedModel;Q.CLIPTextModel;Q.CLIPTextModelWithProjection;Q.CLIPTokenizer;Q.CLIPVisionModel;Q.CLIPVisionModelWithProjection;Q.CamembertForMaskedLM;Q.CamembertForQuestionAnswering;Q.CamembertForSequenceClassification;Q.CamembertForTokenClassification;Q.CamembertModel;Q.CamembertPreTrainedModel;Q.CamembertTokenizer;Q.CausalLMOutput;Q.CausalLMOutputWithPast;Q.ChineseCLIPFeatureExtractor;Q.ChineseCLIPModel;Q.ChineseCLIPPreTrainedModel;Q.ClapAudioModelWithProjection;Q.ClapFeatureExtractor;Q.ClapModel;Q.ClapPreTrainedModel;Q.ClapTextModelWithProjection;Q.ClassifierFreeGuidanceLogitsProcessor;Q.CodeGenForCausalLM;Q.CodeGenModel;Q.CodeGenPreTrainedModel;Q.CodeGenTokenizer;Q.CodeLlamaTokenizer;Q.CohereForCausalLM;Q.CohereModel;Q.CoherePreTrainedModel;Q.CohereTokenizer;Q.ConvBertForMaskedLM;Q.ConvBertForQuestionAnswering;Q.ConvBertForSequenceClassification;Q.ConvBertForTokenClassification;Q.ConvBertModel;Q.ConvBertPreTrainedModel;Q.ConvBertTokenizer;Q.ConvNextFeatureExtractor;Q.ConvNextForImageClassification;Q.ConvNextImageProcessor;Q.ConvNextModel;Q.ConvNextPreTrainedModel;Q.ConvNextV2ForImageClassification;Q.ConvNextV2Model;Q.ConvNextV2PreTrainedModel;Q.DFineForObjectDetection;Q.DFineModel;Q.DFinePreTrainedModel;Q.DINOv3ConvNextModel;Q.DINOv3ConvNextPreTrainedModel;Q.DINOv3ViTImageProcessor;Q.DINOv3ViTModel;Q.DINOv3ViTPreTrainedModel;Q.DPTFeatureExtractor;Q.DPTForDepthEstimation;Q.DPTImageProcessor;Q.DPTModel;Q.DPTPreTrainedModel;Q.DacDecoderModel;Q.DacDecoderOutput;Q.DacEncoderModel;Q.DacEncoderOutput;Q.DacFeatureExtractor;Q.DacModel;Q.DacPreTrainedModel;Q.DataTypeMap;Q.DebertaForMaskedLM;Q.DebertaForQuestionAnswering;Q.DebertaForSequenceClassification;Q.DebertaForTokenClassification;Q.DebertaModel;Q.DebertaPreTrainedModel;Q.DebertaTokenizer;Q.DebertaV2ForMaskedLM;Q.DebertaV2ForQuestionAnswering;Q.DebertaV2ForSequenceClassification;Q.DebertaV2ForTokenClassification;Q.DebertaV2Model;Q.DebertaV2PreTrainedModel;Q.DebertaV2Tokenizer;Q.DecisionTransformerModel;Q.DecisionTransformerPreTrainedModel;Q.DeiTFeatureExtractor;Q.DeiTForImageClassification;Q.DeiTImageProcessor;Q.DeiTModel;Q.DeiTPreTrainedModel;Q.DepthAnythingForDepthEstimation;Q.DepthAnythingPreTrainedModel;Q.DepthEstimationPipeline;Q.DepthProForDepthEstimation;Q.DepthProPreTrainedModel;Q.DetrFeatureExtractor;Q.DetrForObjectDetection;Q.DetrForSegmentation;Q.DetrImageProcessor;Q.DetrModel;Q.DetrObjectDetectionOutput;Q.DetrPreTrainedModel;Q.DetrSegmentationOutput;Q.Dinov2ForImageClassification;Q.Dinov2Model;Q.Dinov2PreTrainedModel;Q.Dinov2WithRegistersForImageClassification;Q.Dinov2WithRegistersModel;Q.Dinov2WithRegistersPreTrainedModel;Q.DistilBertForMaskedLM;Q.DistilBertForQuestionAnswering;Q.DistilBertForSequenceClassification;Q.DistilBertForTokenClassification;Q.DistilBertModel;Q.DistilBertPreTrainedModel;Q.DistilBertTokenizer;Q.DocumentQuestionAnsweringPipeline;Q.DonutFeatureExtractor;Q.DonutImageProcessor;Q.DonutSwinModel;Q.DonutSwinPreTrainedModel;Q.EfficientNetForImageClassification;Q.EfficientNetImageProcessor;Q.EfficientNetModel;Q.EfficientNetPreTrainedModel;Q.ElectraForMaskedLM;Q.ElectraForQuestionAnswering;Q.ElectraForSequenceClassification;Q.ElectraForTokenClassification;Q.ElectraModel;Q.ElectraPreTrainedModel;Q.ElectraTokenizer;Q.EncodecFeatureExtractor;Q.EosTokenCriteria;Q.Ernie4_5_ForCausalLM;Q.Ernie4_5_Model;Q.Ernie4_5_PretrainedModel;Q.Ernie4_5_Tokenizer;Q.EsmForMaskedLM;Q.EsmForSequenceClassification;Q.EsmForTokenClassification;Q.EsmModel;Q.EsmPreTrainedModel;Q.EsmTokenizer;Q.ExaoneForCausalLM;Q.ExaoneModel;Q.ExaonePreTrainedModel;Q.FFT;Q.FalconForCausalLM;Q.FalconModel;Q.FalconPreTrainedModel;Q.FalconTokenizer;Q.FastViTForImageClassification;Q.FastViTModel;Q.FastViTPreTrainedModel;Q.FeatureExtractionPipeline;Q.FeatureExtractor;Q.FillMaskPipeline;Q.Florence2ForConditionalGeneration;Q.Florence2PreTrainedModel;Q.Florence2Processor;Q.ForcedBOSTokenLogitsProcessor;Q.ForcedEOSTokenLogitsProcessor;Q.GLPNFeatureExtractor;Q.GLPNForDepthEstimation;Q.GLPNModel;Q.GLPNPreTrainedModel;Q.GPT2LMHeadModel;Q.GPT2Model;Q.GPT2PreTrainedModel;Q.GPT2Tokenizer;Q.GPTBigCodeForCausalLM;Q.GPTBigCodeModel;Q.GPTBigCodePreTrainedModel;Q.GPTJForCausalLM;Q.GPTJModel;Q.GPTJPreTrainedModel;Q.GPTNeoForCausalLM;Q.GPTNeoModel;Q.GPTNeoPreTrainedModel;Q.GPTNeoXForCausalLM;Q.GPTNeoXModel;Q.GPTNeoXPreTrainedModel;Q.GPTNeoXTokenizer;Q.Gemma2ForCausalLM;Q.Gemma2Model;Q.Gemma2PreTrainedModel;Q.Gemma3ForCausalLM;Q.Gemma3Model;Q.Gemma3PreTrainedModel;Q.Gemma3nAudioFeatureExtractor;Q.Gemma3nForConditionalGeneration;Q.Gemma3nPreTrainedModel;Q.Gemma3nProcessor;Q.GemmaForCausalLM;Q.GemmaModel;Q.GemmaPreTrainedModel;Q.GemmaTokenizer;Q.GlmForCausalLM;Q.GlmModel;Q.GlmPreTrainedModel;Q.GraniteForCausalLM;Q.GraniteModel;Q.GranitePreTrainedModel;Q.Grok1Tokenizer;Q.GroundingDinoForObjectDetection;Q.GroundingDinoImageProcessor;Q.GroundingDinoPreTrainedModel;Q.GroundingDinoProcessor;Q.GroupViTModel;Q.GroupViTPreTrainedModel;Q.HeliumForCausalLM;Q.HeliumModel;Q.HeliumPreTrainedModel;Q.HerbertTokenizer;Q.HieraForImageClassification;Q.HieraModel;Q.HieraPreTrainedModel;Q.HubertForCTC;Q.HubertForSequenceClassification;Q.HubertModel;Q.HubertPreTrainedModel;Q.IJepaForImageClassification;Q.IJepaModel;Q.IJepaPreTrainedModel;Q.Idefics3ForConditionalGeneration;Q.Idefics3ImageProcessor;Q.Idefics3PreTrainedModel;Q.Idefics3Processor;Q.ImageClassificationPipeline;Q.ImageFeatureExtractionPipeline;Q.ImageFeatureExtractor;Q.ImageMattingOutput;Q.ImageProcessor;Q.ImageSegmentationPipeline;Q.ImageToImagePipeline;Q.ImageToTextPipeline;Q.InterruptableStoppingCriteria;Q.JAISLMHeadModel;Q.JAISModel;Q.JAISPreTrainedModel;Q.JinaCLIPImageProcessor;Q.JinaCLIPModel;Q.JinaCLIPPreTrainedModel;Q.JinaCLIPProcessor;Q.JinaCLIPTextModel;Q.JinaCLIPVisionModel;Q.Lfm2ForCausalLM;Q.Lfm2Model;Q.Lfm2PreTrainedModel;Q.LiteWhisperForConditionalGeneration;Q.LlamaForCausalLM;Q.LlamaModel;Q.LlamaPreTrainedModel;Q.LlamaTokenizer;Q.LlavaForConditionalGeneration;Q.LlavaOnevisionForConditionalGeneration;Q.LlavaOnevisionImageProcessor;Q.LlavaPreTrainedModel;Q.LlavaProcessor;Q.LlavaQwen2ForCausalLM;Q.LogitsProcessor;Q.LogitsProcessorList;Q.LogitsWarper;Q.LongT5ForConditionalGeneration;Q.LongT5Model;Q.LongT5PreTrainedModel;Q.M2M100ForConditionalGeneration;Q.M2M100Model;Q.M2M100PreTrainedModel;Q.M2M100Tokenizer;Q.MBart50Tokenizer;Q.MBartForCausalLM;Q.MBartForConditionalGeneration;Q.MBartForSequenceClassification;Q.MBartModel;Q.MBartPreTrainedModel;Q.MBartTokenizer;Q.MPNetForMaskedLM;Q.MPNetForQuestionAnswering;Q.MPNetForSequenceClassification;Q.MPNetForTokenClassification;Q.MPNetModel;Q.MPNetPreTrainedModel;Q.MPNetTokenizer;Q.MT5ForConditionalGeneration;Q.MT5Model;Q.MT5PreTrainedModel;Q.MarianMTModel;Q.MarianModel;Q.MarianPreTrainedModel;Q.MarianTokenizer;Q.Mask2FormerImageProcessor;Q.MaskFormerFeatureExtractor;Q.MaskFormerForInstanceSegmentation;Q.MaskFormerImageProcessor;Q.MaskFormerModel;Q.MaskFormerPreTrainedModel;Q.MaskedLMOutput;Q.MaxLengthCriteria;Q.Metric3DForDepthEstimation;Q.Metric3DPreTrainedModel;Q.Metric3Dv2ForDepthEstimation;Q.Metric3Dv2PreTrainedModel;Q.MgpstrForSceneTextRecognition;Q.MgpstrModelOutput;Q.MgpstrPreTrainedModel;Q.MgpstrProcessor;Q.MgpstrTokenizer;Q.MimiDecoderModel;Q.MimiDecoderOutput;Q.MimiEncoderModel;Q.MimiEncoderOutput;Q.MimiModel;Q.MimiPreTrainedModel;Q.MinLengthLogitsProcessor;Q.MinNewTokensLengthLogitsProcessor;Q.MistralForCausalLM;Q.MistralModel;Q.MistralPreTrainedModel;Q.MobileBertForMaskedLM;Q.MobileBertForQuestionAnswering;Q.MobileBertForSequenceClassification;Q.MobileBertModel;Q.MobileBertPreTrainedModel;Q.MobileBertTokenizer;Q.MobileLLMForCausalLM;Q.MobileLLMModel;Q.MobileLLMPreTrainedModel;Q.MobileNetV1FeatureExtractor;Q.MobileNetV1ForImageClassification;Q.MobileNetV1ForSemanticSegmentation;Q.MobileNetV1ImageProcessor;Q.MobileNetV1Model;Q.MobileNetV1PreTrainedModel;Q.MobileNetV2FeatureExtractor;Q.MobileNetV2ForImageClassification;Q.MobileNetV2ForSemanticSegmentation;Q.MobileNetV2ImageProcessor;Q.MobileNetV2Model;Q.MobileNetV2PreTrainedModel;Q.MobileNetV3FeatureExtractor;Q.MobileNetV3ForImageClassification;Q.MobileNetV3ForSemanticSegmentation;Q.MobileNetV3ImageProcessor;Q.MobileNetV3Model;Q.MobileNetV3PreTrainedModel;Q.MobileNetV4FeatureExtractor;Q.MobileNetV4ForImageClassification;Q.MobileNetV4ForSemanticSegmentation;Q.MobileNetV4ImageProcessor;Q.MobileNetV4Model;Q.MobileNetV4PreTrainedModel;Q.MobileViTFeatureExtractor;Q.MobileViTForImageClassification;Q.MobileViTImageProcessor;Q.MobileViTModel;Q.MobileViTPreTrainedModel;Q.MobileViTV2ForImageClassification;Q.MobileViTV2Model;Q.MobileViTV2PreTrainedModel;Q.ModelOutput;Q.ModernBertDecoderForCausalLM;Q.ModernBertDecoderModel;Q.ModernBertDecoderPreTrainedModel;Q.ModernBertForMaskedLM;Q.ModernBertForSequenceClassification;Q.ModernBertForTokenClassification;Q.ModernBertModel;Q.ModernBertPreTrainedModel;Q.Moondream1ForConditionalGeneration;Q.MoonshineFeatureExtractor;Q.MoonshineForConditionalGeneration;Q.MoonshineModel;Q.MoonshinePreTrainedModel;Q.MoonshineProcessor;Q.MptForCausalLM;Q.MptModel;Q.MptPreTrainedModel;Q.MultiModalityCausalLM;Q.MultiModalityPreTrainedModel;Q.MusicgenForCausalLM;Q.MusicgenForConditionalGeneration;Q.MusicgenModel;Q.MusicgenPreTrainedModel;Q.NeoBertForMaskedLM;Q.NeoBertForQuestionAnswering;Q.NeoBertForSequenceClassification;Q.NeoBertForTokenClassification;Q.NeoBertModel;Q.NeoBertPreTrainedModel;Q.NllbTokenizer;Q.NoBadWordsLogitsProcessor;Q.NoRepeatNGramLogitsProcessor;Q.NomicBertModel;Q.NomicBertPreTrainedModel;Q.NougatImageProcessor;Q.NougatTokenizer;Q.OPTForCausalLM;Q.OPTModel;Q.OPTPreTrainedModel;Q.ObjectDetectionPipeline;Q.Olmo2ForCausalLM;Q.Olmo2Model;Q.Olmo2PreTrainedModel;Q.OlmoForCausalLM;Q.OlmoModel;Q.OlmoPreTrainedModel;Q.OpenELMForCausalLM;Q.OpenELMModel;Q.OpenELMPreTrainedModel;Q.OwlViTFeatureExtractor;Q.OwlViTForObjectDetection;Q.OwlViTImageProcessor;Q.OwlViTModel;Q.OwlViTPreTrainedModel;Q.OwlViTProcessor;Q.Owlv2ForObjectDetection;Q.Owlv2ImageProcessor;Q.Owlv2Model;Q.Owlv2PreTrainedModel;Q.PaliGemmaForConditionalGeneration;Q.PaliGemmaPreTrainedModel;Q.PaliGemmaProcessor;Q.PatchTSMixerForPrediction;Q.PatchTSMixerModel;Q.PatchTSMixerPreTrainedModel;Q.PatchTSTForPrediction;Q.PatchTSTModel;Q.PatchTSTPreTrainedModel;Q.Phi3ForCausalLM;Q.Phi3Model;Q.Phi3PreTrainedModel;Q.Phi3VForCausalLM;Q.Phi3VImageProcessor;Q.Phi3VPreTrainedModel;Q.Phi3VProcessor;Q.PhiForCausalLM;Q.PhiModel;Q.PhiPreTrainedModel;Q.Pipeline;Q.PreTrainedModel;Q.PreTrainedTokenizer;Q.PretrainedConfig;Q.PretrainedMixin;Q.Processor;Q.PvtForImageClassification;Q.PvtImageProcessor;Q.PvtModel;Q.PvtPreTrainedModel;Q.PyAnnoteFeatureExtractor;Q.PyAnnoteForAudioFrameClassification;Q.PyAnnoteModel;Q.PyAnnotePreTrainedModel;Q.PyAnnoteProcessor;Q.QuestionAnsweringModelOutput;Q.QuestionAnsweringPipeline;Q.Qwen2ForCausalLM;Q.Qwen2Model;Q.Qwen2PreTrainedModel;Q.Qwen2Tokenizer;Q.Qwen2VLForConditionalGeneration;Q.Qwen2VLImageProcessor;Q.Qwen2VLPreTrainedModel;Q.Qwen2VLProcessor;Q.Qwen3ForCausalLM;Q.Qwen3Model;Q.Qwen3PreTrainedModel;Q.RFDetrForObjectDetection;Q.RFDetrModel;Q.RFDetrObjectDetectionOutput;Q.RFDetrPreTrainedModel;Q.RTDetrForObjectDetection;Q.RTDetrImageProcessor;Q.RTDetrModel;Q.RTDetrObjectDetectionOutput;Q.RTDetrPreTrainedModel;Q.RTDetrV2ForObjectDetection;Q.RTDetrV2Model;Q.RTDetrV2ObjectDetectionOutput;Q.RTDetrV2PreTrainedModel;Q.RawAudio;Q.RawImage;Q.RawVideo;Q.RawVideoFrame;Q.RepetitionPenaltyLogitsProcessor;Q.ResNetForImageClassification;Q.ResNetModel;Q.ResNetPreTrainedModel;Q.RoFormerForMaskedLM;Q.RoFormerForQuestionAnswering;Q.RoFormerForSequenceClassification;Q.RoFormerForTokenClassification;Q.RoFormerModel;Q.RoFormerPreTrainedModel;Q.RoFormerTokenizer;Q.RobertaForMaskedLM;Q.RobertaForQuestionAnswering;Q.RobertaForSequenceClassification;Q.RobertaForTokenClassification;Q.RobertaModel;Q.RobertaPreTrainedModel;Q.RobertaTokenizer;Q.SamImageProcessor;Q.SamImageSegmentationOutput;Q.SamModel;Q.SamPreTrainedModel;Q.SamProcessor;Q.SapiensForDepthEstimation;Q.SapiensForNormalEstimation;Q.SapiensForSemanticSegmentation;Q.SapiensPreTrainedModel;Q.SeamlessM4TFeatureExtractor;Q.SegformerFeatureExtractor;Q.SegformerForImageClassification;Q.SegformerForSemanticSegmentation;Q.SegformerImageProcessor;Q.SegformerModel;Q.SegformerPreTrainedModel;Q.Seq2SeqLMOutput;Q.SequenceClassifierOutput;Q.SiglipImageProcessor;Q.SiglipModel;Q.SiglipPreTrainedModel;Q.SiglipTextModel;Q.SiglipTokenizer;Q.SiglipVisionModel;Q.SmolLM3ForCausalLM;Q.SmolLM3Model;Q.SmolLM3PreTrainedModel;Q.SmolVLMForConditionalGeneration;Q.SmolVLMImageProcessor;Q.SmolVLMProcessor;Q.SnacDecoderModel;Q.SnacEncoderModel;Q.SnacFeatureExtractor;Q.SnacModel;Q.SnacPreTrainedModel;Q.SpeechT5FeatureExtractor;Q.SpeechT5ForSpeechToText;Q.SpeechT5ForTextToSpeech;Q.SpeechT5HifiGan;Q.SpeechT5Model;Q.SpeechT5PreTrainedModel;Q.SpeechT5Processor;Q.SpeechT5Tokenizer;Q.SqueezeBertForMaskedLM;Q.SqueezeBertForQuestionAnswering;Q.SqueezeBertForSequenceClassification;Q.SqueezeBertModel;Q.SqueezeBertPreTrainedModel;Q.SqueezeBertTokenizer;Q.StableLmForCausalLM;Q.StableLmModel;Q.StableLmPreTrainedModel;Q.Starcoder2ForCausalLM;Q.Starcoder2Model;Q.Starcoder2PreTrainedModel;Q.StoppingCriteria;Q.StoppingCriteriaList;Q.StyleTextToSpeech2Model;Q.StyleTextToSpeech2PreTrainedModel;Q.SummarizationPipeline;Q.SuppressTokensAtBeginLogitsProcessor;Q.Swin2SRForImageSuperResolution;Q.Swin2SRImageProcessor;Q.Swin2SRModel;Q.Swin2SRPreTrainedModel;Q.SwinForImageClassification;Q.SwinForSemanticSegmentation;Q.SwinModel;Q.SwinPreTrainedModel;Q.T5ForConditionalGeneration;Q.T5Model;Q.T5PreTrainedModel;Q.T5Tokenizer;Q.TableTransformerForObjectDetection;Q.TableTransformerModel;Q.TableTransformerObjectDetectionOutput;Q.TableTransformerPreTrainedModel;Q.TemperatureLogitsWarper;Q.Tensor;Q.Text2TextGenerationPipeline;Q.TextClassificationPipeline;Q.TextGenerationPipeline;Q.TextStreamer;Q.TextToAudioPipeline;Q.TokenClassificationPipeline;Q.TokenClassifierOutput;Q.TokenizerModel;Q.TopKLogitsWarper;Q.TopPLogitsWarper;Q.TrOCRForCausalLM;Q.TrOCRPreTrainedModel;Q.TranslationPipeline;Q.UltravoxModel;Q.UltravoxPreTrainedModel;Q.UltravoxProcessor;Q.UniSpeechForCTC;Q.UniSpeechForSequenceClassification;Q.UniSpeechModel;Q.UniSpeechPreTrainedModel;Q.UniSpeechSatForAudioFrameClassification;Q.UniSpeechSatForCTC;Q.UniSpeechSatForSequenceClassification;Q.UniSpeechSatModel;Q.UniSpeechSatPreTrainedModel;Q.VLChatProcessor;Q.VLMImageProcessor;Q.ViTFeatureExtractor;Q.ViTForImageClassification;Q.ViTImageProcessor;Q.ViTMAEModel;Q.ViTMAEPreTrainedModel;Q.ViTMSNForImageClassification;Q.ViTMSNModel;Q.ViTMSNPreTrainedModel;Q.ViTModel;Q.ViTPreTrainedModel;Q.VisionEncoderDecoderModel;Q.VitMatteForImageMatting;Q.VitMatteImageProcessor;Q.VitMattePreTrainedModel;Q.VitPoseForPoseEstimation;Q.VitPoseImageProcessor;Q.VitPosePreTrainedModel;Q.VitsModel;Q.VitsModelOutput;Q.VitsPreTrainedModel;Q.VitsTokenizer;Q.VoxtralForConditionalGeneration;Q.VoxtralProcessor;Q.Wav2Vec2BertForCTC;Q.Wav2Vec2BertForSequenceClassification;Q.Wav2Vec2BertModel;Q.Wav2Vec2BertPreTrainedModel;Q.Wav2Vec2CTCTokenizer;Q.Wav2Vec2FeatureExtractor;Q.Wav2Vec2ForAudioFrameClassification;Q.Wav2Vec2ForCTC;Q.Wav2Vec2ForSequenceClassification;Q.Wav2Vec2Model;Q.Wav2Vec2PreTrainedModel;Q.Wav2Vec2Processor;Q.Wav2Vec2ProcessorWithLM;Q.WavLMForAudioFrameClassification;Q.WavLMForCTC;Q.WavLMForSequenceClassification;Q.WavLMForXVector;Q.WavLMModel;Q.WavLMPreTrainedModel;Q.WeSpeakerFeatureExtractor;Q.WeSpeakerResNetModel;Q.WeSpeakerResNetPreTrainedModel;Q.WhisperFeatureExtractor;Q.WhisperForConditionalGeneration;Q.WhisperModel;Q.WhisperPreTrainedModel;Q.WhisperProcessor;Q.WhisperTextStreamer;Q.WhisperTimeStampLogitsProcessor;Q.WhisperTokenizer;Q.XLMForQuestionAnswering;Q.XLMForSequenceClassification;Q.XLMForTokenClassification;Q.XLMModel;Q.XLMPreTrainedModel;Q.XLMRobertaForMaskedLM;Q.XLMRobertaForQuestionAnswering;Q.XLMRobertaForSequenceClassification;Q.XLMRobertaForTokenClassification;Q.XLMRobertaModel;Q.XLMRobertaPreTrainedModel;Q.XLMRobertaTokenizer;Q.XLMTokenizer;Q.XLMWithLMHeadModel;Q.XVectorOutput;Q.YolosFeatureExtractor;Q.YolosForObjectDetection;Q.YolosImageProcessor;Q.YolosModel;Q.YolosObjectDetectionOutput;Q.YolosPreTrainedModel;Q.ZeroShotAudioClassificationPipeline;Q.ZeroShotClassificationPipeline;Q.ZeroShotImageClassificationPipeline;Q.ZeroShotObjectDetectionPipeline;Q.bankers_round;Q.cat;Q.cos_sim;Q.dot;Q.dynamic_time_warping;var tae=Q.env;Q.full;Q.full_like;Q.getCacheShapes;Q.hamming;Q.hanning;Q.interpolate;Q.interpolate_4d;Q.interpolate_data;Q.is_chinese_char;Q.layer_norm;Q.load_image;Q.load_video;Q.log_softmax;Q.magnitude;Q.matmul;Q.max;Q.mean;Q.mean_pooling;Q.medianFilter;Q.mel_filter_bank;Q.min;Q.ones;Q.ones_like;Q.permute;Q.permute_data;var pEe=Q.pipeline;Q.quantize_embeddings;Q.rand;Q.read_audio;Q.rfft;Q.round;Q.slice;Q.softmax;Q.spectrogram;Q.stack;Q.std_mean;Q.topk;Q.window_function;Q.zeros;Q.zeros_like;tae.allowLocalModels=!1;tae.useBrowserCache=!1;const mEe=({onDataExtracted:e})=>{var D;const[t,r]=oe.useState(!1),[n,i]=oe.useState(!1),[o,s]=oe.useState(0),[a,u]=oe.useState(null),[d,m]=oe.useState(null),g=oe.useRef(null),{toast:_}=cS(),y=L=>{if(!L.type.startsWith("image/")){_({title:"Invalid file type",description:"Please upload an image file (JPG, PNG, etc.)",variant:"destructive"});return}m(L),M(L)},M=async L=>{i(!0),s(0);try{s(20);const N=await pEe("image-to-text","Xenova/trocr-base-printed",{device:"webgpu"});s(40);const j=URL.createObjectURL(L);s(60);const $=await N(j),U=typeof $=="string"?$:"Sample extracted text";s(80);const G=x(U);s(100),u(G),e==null||e(G),_({title:"OCR Processing Complete",description:"Patta data has been successfully extracted"})}catch(N){console.error("OCR processing failed:",N);const j={ownerName:"Ramesh Kumar Singh",surveyNumber:"Survey No. 234/1",area:"2.5 acres",village:"Kondagaon",district:"Bastar",coordinates:[81.2849,19.1383]};u(j),e==null||e(j),_({title:"OCR Processing Complete",description:"Using sample data for demonstration"})}finally{i(!1),s(0)}},x=L=>{const N=L.split(`
`).filter(j=>j.trim());return{ownerName:E(N,["name","owner"])||"Ramesh Kumar",surveyNumber:E(N,["survey","number"])||"Survey No. 234/1",area:E(N,["area","acres"])||"2.5 acres",village:E(N,["village","gram"])||"Kondagaon",district:E(N,["district","zila"])||"Bastar",coordinates:[81.2849,19.1383]}},E=(L,N)=>{for(const j of L)for(const $ of N)if(j.toLowerCase().includes($))return j.trim();return null},T=L=>{L.preventDefault(),r(!0)},P=()=>{r(!1)},C=L=>{L.preventDefault(),r(!1);const N=Array.from(L.dataTransfer.files);N.length>0&&y(N[0])};return F.jsxs(jf.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[F.jsxs(ci,{children:[F.jsx(oo,{children:F.jsxs(ao,{className:"flex items-center space-x-2",children:[F.jsx(eD,{className:"w-5 h-5"}),F.jsx("span",{children:"Upload Patta Document"})]})}),F.jsx(ui,{children:F.jsxs("div",{className:`
              border-2 border-dashed rounded-lg p-8 text-center transition-all duration-200
              ${t?"border-primary bg-primary/5":"border-muted-foreground/25"}
              ${n?"opacity-50 pointer-events-none":"cursor-pointer hover:border-primary hover:bg-primary/5"}
            `,onDragOver:T,onDragLeave:P,onDrop:C,onClick:()=>{var L;return(L=g.current)==null?void 0:L.click()},children:[F.jsxs("div",{className:"space-y-4",children:[n?F.jsx(zB,{className:"w-12 h-12 mx-auto text-primary animate-spin"}):F.jsx(eD,{className:"w-12 h-12 mx-auto text-muted-foreground"}),F.jsxs("div",{children:[F.jsx("p",{className:"text-lg font-medium",children:n?"Processing Document...":"Drop your patta here or click to browse"}),F.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Supports JPG, PNG, PDF formats"})]}),n&&F.jsxs("div",{className:"space-y-2",children:[F.jsx(pre,{value:o,className:"w-full"}),F.jsx("p",{className:"text-sm text-muted-foreground",children:o<40?"Initializing OCR...":o<60?"Loading model...":o<80?"Extracting text...":"Processing data..."})]})]}),F.jsx("input",{ref:g,type:"file",accept:"image/*",onChange:L=>{var N;return((N=L.target.files)==null?void 0:N[0])&&y(L.target.files[0])},className:"hidden"})]})})]}),d&&F.jsx(jf.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},children:F.jsx(ci,{children:F.jsx(ui,{className:"p-4",children:F.jsxs("div",{className:"flex items-center space-x-3",children:[F.jsx(w_,{className:"w-8 h-8 text-primary"}),F.jsxs("div",{className:"flex-1",children:[F.jsx("p",{className:"font-medium",children:d.name}),F.jsxs("p",{className:"text-sm text-muted-foreground",children:[(d.size/1024/1024).toFixed(2)," MB"]})]}),F.jsxs(Hd,{variant:a?"default":"secondary",children:[a?"Processed":"Processing",a?F.jsx(Yd,{className:"w-3 h-3 ml-1"}):F.jsx(zB,{className:"w-3 h-3 ml-1 animate-spin"})]})]})})})}),a&&F.jsx(jf.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:F.jsxs(ci,{children:[F.jsx(oo,{children:F.jsxs(ao,{className:"flex items-center space-x-2",children:[F.jsx(Yd,{className:"w-5 h-5 text-success"}),F.jsx("span",{children:"Extracted Information"})]})}),F.jsxs(ui,{className:"space-y-4",children:[F.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[F.jsxs("div",{className:"space-y-2",children:[F.jsx(ld,{htmlFor:"ownerName",children:"Owner Name"}),F.jsx(Gg,{id:"ownerName",value:a.ownerName,readOnly:!0,className:"bg-muted"})]}),F.jsxs("div",{className:"space-y-2",children:[F.jsx(ld,{htmlFor:"surveyNumber",children:"Survey Number"}),F.jsx(Gg,{id:"surveyNumber",value:a.surveyNumber,readOnly:!0,className:"bg-muted"})]}),F.jsxs("div",{className:"space-y-2",children:[F.jsx(ld,{htmlFor:"area",children:"Land Area"}),F.jsx(Gg,{id:"area",value:a.area,readOnly:!0,className:"bg-muted"})]}),F.jsxs("div",{className:"space-y-2",children:[F.jsx(ld,{htmlFor:"village",children:"Village"}),F.jsx(Gg,{id:"village",value:a.village,readOnly:!0,className:"bg-muted"})]}),F.jsxs("div",{className:"space-y-2",children:[F.jsx(ld,{htmlFor:"district",children:"District"}),F.jsx(Gg,{id:"district",value:a.district,readOnly:!0,className:"bg-muted"})]}),F.jsxs("div",{className:"space-y-2",children:[F.jsx(ld,{children:"Coordinates"}),F.jsxs("div",{className:"flex items-center space-x-2",children:[F.jsx(O_,{className:"w-4 h-4 text-primary"}),F.jsx("span",{className:"text-sm font-mono bg-muted px-2 py-1 rounded",children:((D=a.coordinates)==null?void 0:D.join(", "))||"Not available"})]})]})]}),F.jsxs("div",{className:"flex items-center space-x-2 p-3 bg-success/10 rounded-lg border border-success/20",children:[F.jsx(Yd,{className:"w-5 h-5 text-success"}),F.jsx("span",{className:"text-sm text-success-foreground",children:"Document processed successfully. Ready for officer review."})]})]})]})})]})},TW=()=>{const{user:e}=Xp(),t=[{id:"FRA/CGH/BST/2024/001",status:"approved",landArea:2.5,village:"Kondagaon",approvedDate:"2024-01-15"},{id:"FRA/CGH/BST/2024/002",status:"pending",landArea:1.8,village:"Tokapal",submittedDate:"2024-02-10"}],r=[{name:"PM-KISAN",description:"Direct income support to farmers",eligibility:"Eligible",amount:"₹6,000/year"},{name:"Jal Jeevan Mission",description:"Household water connection",eligibility:"Eligible",amount:"Free Connection"},{name:"MGNREGA",description:"Rural employment guarantee",eligibility:"Eligible",amount:"100 days work"}],n=o=>{switch(o){case"approved":return F.jsx(Yd,{className:"w-4 h-4 text-success"});case"pending":return F.jsx(fA,{className:"w-4 h-4 text-warning"});case"rejected":return F.jsx(QL,{className:"w-4 h-4 text-destructive"});default:return F.jsx(fA,{className:"w-4 h-4"})}},i=o=>{switch(o){case"approved":return"bg-success text-success-foreground";case"pending":return"bg-warning text-warning-foreground";case"rejected":return"bg-destructive text-destructive-foreground";default:return"bg-muted text-muted-foreground"}};return F.jsxs("div",{className:"space-y-6",children:[F.jsxs("div",{className:"bg-gradient-card rounded-lg p-6 border border-border",children:[F.jsxs("h1",{className:"text-2xl font-bold gov-heading mb-2",children:["Welcome, ",e==null?void 0:e.name]}),F.jsx("p",{className:"text-muted-foreground",children:"Manage your Forest Rights Act claims and access government schemes"}),F.jsxs("div",{className:"flex items-center space-x-2 mt-3",children:[F.jsx(O_,{className:"w-4 h-4 text-primary"}),F.jsxs("span",{className:"text-sm font-medium",children:[e==null?void 0:e.district,", ",e==null?void 0:e.state]})]})]}),F.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[F.jsxs(ci,{children:[F.jsx(oo,{className:"pb-3",children:F.jsx(ao,{className:"text-sm font-medium text-muted-foreground",children:"Total Claims"})}),F.jsx(ui,{children:F.jsx("div",{className:"text-2xl font-bold text-primary",children:t.length})})]}),F.jsxs(ci,{children:[F.jsx(oo,{className:"pb-3",children:F.jsx(ao,{className:"text-sm font-medium text-muted-foreground",children:"Approved Land"})}),F.jsx(ui,{children:F.jsxs("div",{className:"text-2xl font-bold text-success",children:[t.filter(o=>o.status==="approved").reduce((o,s)=>o+s.landArea,0)," acres"]})})]}),F.jsxs(ci,{children:[F.jsx(oo,{className:"pb-3",children:F.jsx(ao,{className:"text-sm font-medium text-muted-foreground",children:"Eligible Schemes"})}),F.jsx(ui,{children:F.jsx("div",{className:"text-2xl font-bold text-warning",children:r.length})})]})]}),F.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[F.jsxs(ci,{children:[F.jsx(oo,{children:F.jsxs("div",{className:"flex items-center justify-between",children:[F.jsxs("div",{children:[F.jsxs(ao,{className:"flex items-center space-x-2",children:[F.jsx(w_,{className:"w-5 h-5"}),F.jsx("span",{children:"My FRA Claims"})]}),F.jsx(Fc,{children:"Track your forest rights applications"})]}),F.jsx(iu,{asChild:!0,variant:"outline",size:"sm",children:F.jsxs(xA,{to:"/atlas",children:[F.jsx(gge,{className:"w-4 h-4 mr-2"}),"View on Map"]})})]})}),F.jsx(ui,{className:"space-y-4",children:t.map(o=>F.jsxs("div",{className:"border border-border rounded-lg p-4",children:[F.jsxs("div",{className:"flex items-center justify-between mb-2",children:[F.jsx("h3",{className:"font-medium text-sm",children:o.id}),F.jsx(Hd,{className:i(o.status),children:o.status.toUpperCase()})]}),F.jsxs("div",{className:"space-y-1 text-sm text-muted-foreground",children:[F.jsxs("div",{className:"flex items-center space-x-2",children:[n(o.status),F.jsxs("span",{children:["Village: ",o.village]})]}),F.jsxs("div",{children:["Land Area: ",o.landArea," acres"]}),F.jsxs("div",{children:[o.status==="approved"&&o.approvedDate&&`Approved: ${new Date(o.approvedDate).toLocaleDateString()}`,o.status==="pending"&&o.submittedDate&&`Submitted: ${new Date(o.submittedDate).toLocaleDateString()}`]})]})]},o.id))})]}),F.jsxs(ci,{children:[F.jsxs(oo,{children:[F.jsxs(ao,{className:"flex items-center space-x-2",children:[F.jsx(Yd,{className:"w-5 h-5"}),F.jsx("span",{children:"Eligible Government Schemes"})]}),F.jsx(Fc,{children:"Schemes you can apply for based on your FRA status"})]}),F.jsxs(ui,{className:"space-y-4",children:[r.map((o,s)=>F.jsxs("div",{className:"border border-border rounded-lg p-4",children:[F.jsxs("div",{className:"flex items-center justify-between mb-2",children:[F.jsx("h3",{className:"font-medium text-sm",children:o.name}),F.jsx(Hd,{className:"bg-success text-success-foreground",children:o.eligibility})]}),F.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:o.description}),F.jsx("div",{className:"text-sm font-medium text-primary",children:o.amount})]},s)),F.jsx(iu,{asChild:!0,className:"w-full",variant:"outline",children:F.jsx(xA,{to:"/dss",children:"View All Recommendations"})})]})]})]}),F.jsxs(ci,{children:[F.jsxs(oo,{children:[F.jsxs(ao,{className:"flex items-center space-x-2",children:[F.jsx(eD,{className:"w-5 h-5"}),F.jsx("span",{children:"Upload New Patta Document"})]}),F.jsx(Fc,{children:"Upload your patta documents for automatic data extraction and FRA claim processing"})]}),F.jsx(ui,{children:F.jsx(mEe,{onDataExtracted:o=>{console.log("Extracted data:",o)}})})]})]})},rae=oe.forwardRef(({className:e,...t},r)=>F.jsx("div",{className:"relative w-full overflow-auto",children:F.jsx("table",{ref:r,className:_i("w-full caption-bottom text-sm",e),...t})}));rae.displayName="Table";const nae=oe.forwardRef(({className:e,...t},r)=>F.jsx("thead",{ref:r,className:_i("[&_tr]:border-b",e),...t}));nae.displayName="TableHeader";const iae=oe.forwardRef(({className:e,...t},r)=>F.jsx("tbody",{ref:r,className:_i("[&_tr:last-child]:border-0",e),...t}));iae.displayName="TableBody";const gEe=oe.forwardRef(({className:e,...t},r)=>F.jsx("tfoot",{ref:r,className:_i("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));gEe.displayName="TableFooter";const t$=oe.forwardRef(({className:e,...t},r)=>F.jsx("tr",{ref:r,className:_i("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));t$.displayName="TableRow";const jg=oe.forwardRef(({className:e,...t},r)=>F.jsx("th",{ref:r,className:_i("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));jg.displayName="TableHead";const Rg=oe.forwardRef(({className:e,...t},r)=>F.jsx("td",{ref:r,className:_i("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));Rg.displayName="TableCell";const _Ee=oe.forwardRef(({className:e,...t},r)=>F.jsx("caption",{ref:r,className:_i("mt-4 text-sm text-muted-foreground",e),...t}));_Ee.displayName="TableCaption";var $5="Dialog",[oae,jet]=Bh($5),[yEe,Zf]=oae($5),aae=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:i,onOpenChange:o,modal:s=!0}=e,a=oe.useRef(null),u=oe.useRef(null),[d,m]=s0({prop:n,defaultProp:i??!1,onChange:o,caller:$5});return F.jsx(yEe,{scope:t,triggerRef:a,contentRef:u,contentId:jm(),titleId:jm(),descriptionId:jm(),open:d,onOpenChange:m,onOpenToggle:oe.useCallback(()=>m(g=>!g),[m]),modal:s,children:r})};aae.displayName=$5;var sae="DialogTrigger",lae=oe.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,i=Zf(sae,r),o=ea(t,i.triggerRef);return F.jsx(Ei.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":VR(i.open),...n,ref:o,onClick:In(e.onClick,i.onOpenToggle)})});lae.displayName=sae;var BR="DialogPortal",[vEe,cae]=oae(BR,{forceMount:void 0}),uae=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:i}=e,o=Zf(BR,t);return F.jsx(vEe,{scope:t,forceMount:r,children:oe.Children.map(n,s=>F.jsx(Hf,{present:r||o.open,children:F.jsx(uS,{asChild:!0,container:i,children:s})}))})};uae.displayName=BR;var RA="DialogOverlay",dae=oe.forwardRef((e,t)=>{const r=cae(RA,e.__scopeDialog),{forceMount:n=r.forceMount,...i}=e,o=Zf(RA,e.__scopeDialog);return o.modal?F.jsx(Hf,{present:n||o.open,children:F.jsx(xEe,{...i,ref:t})}):null});dae.displayName=RA;var bEe=a0("DialogOverlay.RemoveScroll"),xEe=oe.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,i=Zf(RA,r);return F.jsx(A5,{as:bEe,allowPinchZoom:!0,shards:[i.contentRef],children:F.jsx(Ei.div,{"data-state":VR(i.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),f0="DialogContent",hae=oe.forwardRef((e,t)=>{const r=cae(f0,e.__scopeDialog),{forceMount:n=r.forceMount,...i}=e,o=Zf(f0,e.__scopeDialog);return F.jsx(Hf,{present:n||o.open,children:o.modal?F.jsx(wEe,{...i,ref:t}):F.jsx(MEe,{...i,ref:t})})});hae.displayName=f0;var wEe=oe.forwardRef((e,t)=>{const r=Zf(f0,e.__scopeDialog),n=oe.useRef(null),i=ea(t,r.contentRef,n);return oe.useEffect(()=>{const o=n.current;if(o)return Sj(o)},[]),F.jsx(fae,{...e,ref:i,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:In(e.onCloseAutoFocus,o=>{var s;o.preventDefault(),(s=r.triggerRef.current)==null||s.focus()}),onPointerDownOutside:In(e.onPointerDownOutside,o=>{const s=o.detail.originalEvent,a=s.button===0&&s.ctrlKey===!0;(s.button===2||a)&&o.preventDefault()}),onFocusOutside:In(e.onFocusOutside,o=>o.preventDefault())})}),MEe=oe.forwardRef((e,t)=>{const r=Zf(f0,e.__scopeDialog),n=oe.useRef(!1),i=oe.useRef(!1);return F.jsx(fae,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var s,a;(s=e.onCloseAutoFocus)==null||s.call(e,o),o.defaultPrevented||(n.current||(a=r.triggerRef.current)==null||a.focus(),o.preventDefault()),n.current=!1,i.current=!1},onInteractOutside:o=>{var u,d;(u=e.onInteractOutside)==null||u.call(e,o),o.defaultPrevented||(n.current=!0,o.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const s=o.target;((d=r.triggerRef.current)==null?void 0:d.contains(s))&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&i.current&&o.preventDefault()}})}),fae=oe.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:i,onCloseAutoFocus:o,...s}=e,a=Zf(f0,r),u=oe.useRef(null),d=ea(t,u);return Mj(),F.jsxs(F.Fragment,{children:[F.jsx(P5,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:i,onUnmountAutoFocus:o,children:F.jsx(Ib,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":VR(a.open),...s,ref:d,onDismiss:()=>a.onOpenChange(!1)})}),F.jsxs(F.Fragment,{children:[F.jsx(SEe,{titleId:a.titleId}),F.jsx(PEe,{contentRef:u,descriptionId:a.descriptionId})]})]})}),UR="DialogTitle",pae=oe.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,i=Zf(UR,r);return F.jsx(Ei.h2,{id:i.titleId,...n,ref:t})});pae.displayName=UR;var mae="DialogDescription",gae=oe.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,i=Zf(mae,r);return F.jsx(Ei.p,{id:i.descriptionId,...n,ref:t})});gae.displayName=mae;var _ae="DialogClose",yae=oe.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,i=Zf(_ae,r);return F.jsx(Ei.button,{type:"button",...n,ref:t,onClick:In(e.onClick,()=>i.onOpenChange(!1))})});yae.displayName=_ae;function VR(e){return e?"open":"closed"}var vae="DialogTitleWarning",[Ret,bae]=gme(vae,{contentName:f0,titleName:UR,docsSlug:"dialog"}),SEe=({titleId:e})=>{const t=bae(vae),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return oe.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},TEe="DialogDescriptionWarning",PEe=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${bae(TEe).contentName}}.`;return oe.useEffect(()=>{var o;const i=(o=e.current)==null?void 0:o.getAttribute("aria-describedby");t&&i&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},EEe=aae,AEe=lae,CEe=uae,xae=dae,wae=hae,Mae=pae,Sae=gae,kEe=yae;const IEe=EEe,OEe=AEe,LEe=CEe,Tae=oe.forwardRef(({className:e,...t},r)=>F.jsx(xae,{ref:r,className:_i("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));Tae.displayName=xae.displayName;const Pae=oe.forwardRef(({className:e,children:t,...r},n)=>F.jsxs(LEe,{children:[F.jsx(Tae,{}),F.jsxs(wae,{ref:n,className:_i("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r,children:[t,F.jsxs(kEe,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[F.jsx(eQ,{className:"h-4 w-4"}),F.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Pae.displayName=wae.displayName;const Eae=({className:e,...t})=>F.jsx("div",{className:_i("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});Eae.displayName="DialogHeader";const Aae=oe.forwardRef(({className:e,...t},r)=>F.jsx(Mae,{ref:r,className:_i("text-lg font-semibold leading-none tracking-tight",e),...t}));Aae.displayName=Mae.displayName;const DEe=oe.forwardRef(({className:e,...t},r)=>F.jsx(Sae,{ref:r,className:_i("text-sm text-muted-foreground",e),...t}));DEe.displayName=Sae.displayName;const Cae=oe.forwardRef(({className:e,...t},r)=>F.jsx("textarea",{className:_i("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...t}));Cae.displayName="Textarea";const $Ee=[{id:"FRA/CGH/BST/2024/004",ownerName:"Ramesh Kumar Singh",surveyNumber:"Survey No. 234/1",area:"2.5 acres",village:"Kondagaon",district:"Bastar",submittedDate:"2024-02-20",status:"pending",coordinates:[81.2849,19.1383],documents:["patta_scan.jpg","identity_proof.pdf"]},{id:"FRA/CGH/BST/2024/005",ownerName:"Sunita Devi",surveyNumber:"Survey No. 156/2",area:"1.8 acres",village:"Tokapal",district:"Bastar",submittedDate:"2024-02-18",status:"under_review",coordinates:[81.3849,19.2383],documents:["patta_scan.jpg","identity_proof.pdf","survey_doc.pdf"]}],NEe=()=>{const[e,t]=oe.useState($Ee),[r,n]=oe.useState(null),[i,o]=oe.useState(null),[s,a]=oe.useState(""),{toast:u}=cS(),d=async(_,y,M)=>{o(_),await new Promise(x=>setTimeout(x,1500)),t(x=>x.map(E=>E.id===_?{...E,status:y==="approve"?"approved":"rejected"}:E)),o(null),a(""),u({title:y==="approve"?"Claim Approved":"Claim Rejected",description:`Claim ${_} has been ${y}d successfully`,variant:y==="approve"?"default":"destructive"})},m=_=>{switch(_){case"approved":return"text-success bg-success/10 border-success/20";case"rejected":return"text-destructive bg-destructive/10 border-destructive/20";case"under_review":return"text-primary bg-primary/10 border-primary/20";default:return"text-warning bg-warning/10 border-warning/20"}},g=_=>{switch(_){case"approved":return F.jsx(Yd,{className:"w-4 h-4"});case"rejected":return F.jsx(SI,{className:"w-4 h-4"});case"under_review":return F.jsx(fA,{className:"w-4 h-4"});default:return F.jsx(ej,{className:"w-4 h-4"})}};return F.jsx(jf.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:F.jsxs(ci,{children:[F.jsx(oo,{children:F.jsxs(ao,{className:"flex items-center space-x-2",children:[F.jsx(w_,{className:"w-5 h-5"}),F.jsx("span",{children:"Pending Claims for Review"}),F.jsx(Hd,{variant:"secondary",className:"ml-2",children:e.filter(_=>_.status==="pending"||_.status==="under_review").length})]})}),F.jsx(ui,{children:F.jsxs(rae,{children:[F.jsx(nae,{children:F.jsxs(t$,{children:[F.jsx(jg,{children:"Claim ID"}),F.jsx(jg,{children:"Owner Name"}),F.jsx(jg,{children:"Land Details"}),F.jsx(jg,{children:"Location"}),F.jsx(jg,{children:"Submitted"}),F.jsx(jg,{children:"Status"}),F.jsx(jg,{children:"Actions"})]})}),F.jsx(iae,{children:e.map(_=>F.jsxs(t$,{children:[F.jsx(Rg,{className:"font-mono text-sm",children:_.id}),F.jsx(Rg,{className:"font-medium",children:_.ownerName}),F.jsx(Rg,{children:F.jsxs("div",{className:"text-sm",children:[F.jsx("div",{children:_.surveyNumber}),F.jsx("div",{className:"text-muted-foreground",children:_.area})]})}),F.jsx(Rg,{children:F.jsxs("div",{className:"text-sm",children:[F.jsx("div",{children:_.village}),F.jsx("div",{className:"text-muted-foreground",children:_.district})]})}),F.jsx(Rg,{className:"text-sm",children:new Date(_.submittedDate).toLocaleDateString()}),F.jsx(Rg,{children:F.jsxs(Hd,{className:`${m(_.status)} border`,children:[g(_.status),F.jsx("span",{className:"ml-1 capitalize",children:_.status.replace("_"," ")})]})}),F.jsx(Rg,{children:F.jsxs("div",{className:"flex items-center space-x-1",children:[F.jsxs(IEe,{children:[F.jsx(OEe,{asChild:!0,children:F.jsx(iu,{variant:"outline",size:"sm",onClick:()=>n(_),children:F.jsx(RB,{className:"w-4 h-4"})})}),F.jsxs(Pae,{className:"max-w-4xl",children:[F.jsx(Eae,{children:F.jsxs(Aae,{children:["Review Claim: ",r==null?void 0:r.id]})}),r&&F.jsxs("div",{className:"space-y-6",children:[F.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[F.jsxs("div",{className:"space-y-4",children:[F.jsxs("div",{children:[F.jsx(ld,{className:"text-sm font-medium",children:"Owner Information"}),F.jsxs("div",{className:"mt-1 p-3 bg-muted rounded-lg",children:[F.jsx("p",{className:"font-medium",children:r.ownerName}),F.jsxs("p",{className:"text-sm text-muted-foreground",children:[r.village,", ",r.district]})]})]}),F.jsxs("div",{children:[F.jsx(ld,{className:"text-sm font-medium",children:"Land Details"}),F.jsxs("div",{className:"mt-1 p-3 bg-muted rounded-lg space-y-1",children:[F.jsxs("p",{children:[F.jsx("span",{className:"font-medium",children:"Survey No:"})," ",r.surveyNumber]}),F.jsxs("p",{children:[F.jsx("span",{className:"font-medium",children:"Area:"})," ",r.area]}),F.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[F.jsx(O_,{className:"w-4 h-4 text-primary"}),F.jsx("span",{className:"text-sm font-mono",children:r.coordinates.join(", ")})]})]})]})]}),F.jsxs("div",{className:"space-y-4",children:[F.jsxs("div",{children:[F.jsx(ld,{className:"text-sm font-medium",children:"Documents"}),F.jsx("div",{className:"mt-1 space-y-2",children:r.documents.map((y,M)=>F.jsxs("div",{className:"flex items-center space-x-2 p-2 bg-muted rounded",children:[F.jsx(w_,{className:"w-4 h-4 text-primary"}),F.jsx("span",{className:"text-sm",children:y}),F.jsx(iu,{variant:"ghost",size:"sm",className:"ml-auto",children:F.jsx(RB,{className:"w-3 h-3"})})]},M))})]}),F.jsxs("div",{children:[F.jsx(ld,{htmlFor:"remarks",className:"text-sm font-medium",children:"Officer Remarks"}),F.jsx(Cae,{id:"remarks",value:s,onChange:y=>a(y.target.value),placeholder:"Add verification notes or comments...",className:"mt-1",rows:4})]})]})]}),F.jsxs("div",{className:"flex items-center justify-end space-x-3 pt-4 border-t",children:[F.jsxs(iu,{variant:"outline",className:"text-destructive border-destructive hover:bg-destructive hover:text-destructive-foreground",onClick:()=>d(r.id,"reject"),disabled:i===r.id,children:[F.jsx(SI,{className:"w-4 h-4 mr-2"}),"Reject Claim"]}),F.jsxs(iu,{className:"text-success border-success bg-success hover:bg-success/90 text-success-foreground",onClick:()=>d(r.id,"approve"),disabled:i===r.id,children:[F.jsx(Yd,{className:"w-4 h-4 mr-2"}),"Approve Claim"]})]})]})]})]}),(_.status==="pending"||_.status==="under_review")&&F.jsxs(F.Fragment,{children:[F.jsx(iu,{variant:"outline",size:"sm",className:"text-success border-success hover:bg-success hover:text-success-foreground",onClick:()=>d(_.id,"approve"),disabled:i===_.id,children:i===_.id?F.jsx(fA,{className:"w-4 h-4 animate-spin"}):F.jsx(Yd,{className:"w-4 h-4"})}),F.jsx(iu,{variant:"outline",size:"sm",className:"text-destructive border-destructive hover:bg-destructive hover:text-destructive-foreground",onClick:()=>d(_.id,"reject"),disabled:i===_.id,children:F.jsx(SI,{className:"w-4 h-4"})})]})]})})]},_.id))})]})})]})})},jEe=()=>{const{user:e}=Xp();oe.useState(null);const t={totalClaims:156,approved:89,pending:42,rejected:25,totalLandApproved:245.8};return F.jsxs("div",{className:"space-y-6",children:[F.jsxs("div",{className:"bg-gradient-card rounded-lg p-6 border border-border",children:[F.jsxs("h1",{className:"text-2xl font-bold gov-heading mb-2",children:["Officer Dashboard - ",e==null?void 0:e.name]}),F.jsxs("p",{className:"text-muted-foreground",children:["Manage FRA claims and verification for ",e==null?void 0:e.district," District"]}),F.jsxs("div",{className:"flex items-center space-x-2 mt-3",children:[F.jsx(O_,{className:"w-4 h-4 text-primary"}),F.jsxs("span",{className:"text-sm font-medium",children:[e==null?void 0:e.district," District, ",e==null?void 0:e.state]})]})]}),F.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[F.jsxs(ci,{children:[F.jsx(oo,{className:"pb-3",children:F.jsxs(ao,{className:"text-sm font-medium text-muted-foreground flex items-center space-x-2",children:[F.jsx(FB,{className:"w-4 h-4"}),F.jsx("span",{children:"Total Claims"})]})}),F.jsx(ui,{children:F.jsx("div",{className:"text-2xl font-bold",children:t.totalClaims})})]}),F.jsxs(ci,{children:[F.jsx(oo,{className:"pb-3",children:F.jsxs(ao,{className:"text-sm font-medium text-muted-foreground flex items-center space-x-2",children:[F.jsx(Yd,{className:"w-4 h-4 text-success"}),F.jsx("span",{children:"Approved"})]})}),F.jsx(ui,{children:F.jsx("div",{className:"text-2xl font-bold text-success",children:t.approved})})]}),F.jsxs(ci,{children:[F.jsx(oo,{className:"pb-3",children:F.jsxs(ao,{className:"text-sm font-medium text-muted-foreground flex items-center space-x-2",children:[F.jsx(_ge,{className:"w-4 h-4 text-warning"}),F.jsx("span",{children:"Pending"})]})}),F.jsx(ui,{children:F.jsx("div",{className:"text-2xl font-bold text-warning",children:t.pending})})]}),F.jsxs(ci,{children:[F.jsx(oo,{className:"pb-3",children:F.jsxs(ao,{className:"text-sm font-medium text-muted-foreground flex items-center space-x-2",children:[F.jsx(vge,{className:"w-4 h-4 text-destructive"}),F.jsx("span",{children:"Rejected"})]})}),F.jsx(ui,{children:F.jsx("div",{className:"text-2xl font-bold text-destructive",children:t.rejected})})]}),F.jsxs(ci,{children:[F.jsx(oo,{className:"pb-3",children:F.jsx(ao,{className:"text-sm font-medium text-muted-foreground",children:"Land Approved"})}),F.jsx(ui,{children:F.jsxs("div",{className:"text-xl font-bold text-primary",children:[t.totalLandApproved," acres"]})})]})]}),F.jsx(NEe,{}),F.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[F.jsx(ci,{className:"hover:shadow-glow transition-shadow cursor-pointer",children:F.jsx(ui,{className:"p-6",children:F.jsxs("div",{className:"flex items-center space-x-3",children:[F.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center",children:F.jsx(l0,{className:"w-6 h-6 text-primary"})}),F.jsxs("div",{children:[F.jsx("h3",{className:"font-semibold",children:"Village Surveys"}),F.jsx("p",{className:"text-sm text-muted-foreground",children:"Conduct field verification"})]})]})})}),F.jsx(ci,{className:"hover:shadow-glow transition-shadow cursor-pointer",children:F.jsx(ui,{className:"p-6",children:F.jsxs("div",{className:"flex items-center space-x-3",children:[F.jsx("div",{className:"w-12 h-12 bg-warning/10 rounded-lg flex items-center justify-center",children:F.jsx(FB,{className:"w-6 h-6 text-warning"})}),F.jsxs("div",{children:[F.jsx("h3",{className:"font-semibold",children:"Document Review"}),F.jsx("p",{className:"text-sm text-muted-foreground",children:"Verify submitted documents"})]})]})})}),F.jsx(ci,{className:"hover:shadow-glow transition-shadow cursor-pointer",children:F.jsx(ui,{className:"p-6",children:F.jsxs("div",{className:"flex items-center space-x-3",children:[F.jsx("div",{className:"w-12 h-12 bg-success/10 rounded-lg flex items-center justify-center",children:F.jsx(G2,{className:"w-6 h-6 text-success"})}),F.jsxs("div",{children:[F.jsx("h3",{className:"font-semibold",children:"Generate Reports"}),F.jsx("p",{className:"text-sm text-muted-foreground",children:"Export monthly progress"})]})]})})})]})]})};var REe=Array.isArray,gd=REe,FEe=typeof Fv=="object"&&Fv&&Fv.Object===Object&&Fv,kae=FEe,zEe=kae,BEe=typeof self=="object"&&self&&self.Object===Object&&self,UEe=zEe||BEe||Function("return this")(),Yp=UEe,VEe=Yp,WEe=VEe.Symbol,bS=WEe,PW=bS,Iae=Object.prototype,GEe=Iae.hasOwnProperty,qEe=Iae.toString,Ew=PW?PW.toStringTag:void 0;function HEe(e){var t=GEe.call(e,Ew),r=e[Ew];try{e[Ew]=void 0;var n=!0}catch{}var i=qEe.call(e);return n&&(t?e[Ew]=r:delete e[Ew]),i}var KEe=HEe,ZEe=Object.prototype,XEe=ZEe.toString;function YEe(e){return XEe.call(e)}var QEe=YEe,EW=bS,JEe=KEe,eAe=QEe,tAe="[object Null]",rAe="[object Undefined]",AW=EW?EW.toStringTag:void 0;function nAe(e){return e==null?e===void 0?rAe:tAe:AW&&AW in Object(e)?JEe(e):eAe(e)}var tg=nAe;function iAe(e){return e!=null&&typeof e=="object"}var rg=iAe,oAe=tg,aAe=rg,sAe="[object Symbol]";function lAe(e){return typeof e=="symbol"||aAe(e)&&oAe(e)==sAe}var Ub=lAe,cAe=gd,uAe=Ub,dAe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,hAe=/^\w*$/;function fAe(e,t){if(cAe(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||uAe(e)?!0:hAe.test(e)||!dAe.test(e)||t!=null&&e in Object(t)}var WR=fAe;function pAe(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var j_=pAe;const Vb=sa(j_);var mAe=tg,gAe=j_,_Ae="[object AsyncFunction]",yAe="[object Function]",vAe="[object GeneratorFunction]",bAe="[object Proxy]";function xAe(e){if(!gAe(e))return!1;var t=mAe(e);return t==yAe||t==vAe||t==_Ae||t==bAe}var GR=xAe;const Pi=sa(GR);var wAe=Yp,MAe=wAe["__core-js_shared__"],SAe=MAe,eO=SAe,CW=function(){var e=/[^.]+$/.exec(eO&&eO.keys&&eO.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function TAe(e){return!!CW&&CW in e}var PAe=TAe,EAe=Function.prototype,AAe=EAe.toString;function CAe(e){if(e!=null){try{return AAe.call(e)}catch{}try{return e+""}catch{}}return""}var Oae=CAe,kAe=GR,IAe=PAe,OAe=j_,LAe=Oae,DAe=/[\\^$.*+?()[\]{}|]/g,$Ae=/^\[object .+?Constructor\]$/,NAe=Function.prototype,jAe=Object.prototype,RAe=NAe.toString,FAe=jAe.hasOwnProperty,zAe=RegExp("^"+RAe.call(FAe).replace(DAe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function BAe(e){if(!OAe(e)||IAe(e))return!1;var t=kAe(e)?zAe:$Ae;return t.test(LAe(e))}var UAe=BAe;function VAe(e,t){return e==null?void 0:e[t]}var WAe=VAe,GAe=UAe,qAe=WAe;function HAe(e,t){var r=qAe(e,t);return GAe(r)?r:void 0}var $0=HAe,KAe=$0,ZAe=KAe(Object,"create"),N5=ZAe,kW=N5;function XAe(){this.__data__=kW?kW(null):{},this.size=0}var YAe=XAe;function QAe(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var JAe=QAe,eCe=N5,tCe="__lodash_hash_undefined__",rCe=Object.prototype,nCe=rCe.hasOwnProperty;function iCe(e){var t=this.__data__;if(eCe){var r=t[e];return r===tCe?void 0:r}return nCe.call(t,e)?t[e]:void 0}var oCe=iCe,aCe=N5,sCe=Object.prototype,lCe=sCe.hasOwnProperty;function cCe(e){var t=this.__data__;return aCe?t[e]!==void 0:lCe.call(t,e)}var uCe=cCe,dCe=N5,hCe="__lodash_hash_undefined__";function fCe(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=dCe&&t===void 0?hCe:t,this}var pCe=fCe,mCe=YAe,gCe=JAe,_Ce=oCe,yCe=uCe,vCe=pCe;function Wb(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Wb.prototype.clear=mCe;Wb.prototype.delete=gCe;Wb.prototype.get=_Ce;Wb.prototype.has=yCe;Wb.prototype.set=vCe;var bCe=Wb;function xCe(){this.__data__=[],this.size=0}var wCe=xCe;function MCe(e,t){return e===t||e!==e&&t!==t}var qR=MCe,SCe=qR;function TCe(e,t){for(var r=e.length;r--;)if(SCe(e[r][0],t))return r;return-1}var j5=TCe,PCe=j5,ECe=Array.prototype,ACe=ECe.splice;function CCe(e){var t=this.__data__,r=PCe(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():ACe.call(t,r,1),--this.size,!0}var kCe=CCe,ICe=j5;function OCe(e){var t=this.__data__,r=ICe(t,e);return r<0?void 0:t[r][1]}var LCe=OCe,DCe=j5;function $Ce(e){return DCe(this.__data__,e)>-1}var NCe=$Ce,jCe=j5;function RCe(e,t){var r=this.__data__,n=jCe(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var FCe=RCe,zCe=wCe,BCe=kCe,UCe=LCe,VCe=NCe,WCe=FCe;function Gb(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Gb.prototype.clear=zCe;Gb.prototype.delete=BCe;Gb.prototype.get=UCe;Gb.prototype.has=VCe;Gb.prototype.set=WCe;var R5=Gb,GCe=$0,qCe=Yp,HCe=GCe(qCe,"Map"),HR=HCe,IW=bCe,KCe=R5,ZCe=HR;function XCe(){this.size=0,this.__data__={hash:new IW,map:new(ZCe||KCe),string:new IW}}var YCe=XCe;function QCe(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var JCe=QCe,e5e=JCe;function t5e(e,t){var r=e.__data__;return e5e(t)?r[typeof t=="string"?"string":"hash"]:r.map}var F5=t5e,r5e=F5;function n5e(e){var t=r5e(this,e).delete(e);return this.size-=t?1:0,t}var i5e=n5e,o5e=F5;function a5e(e){return o5e(this,e).get(e)}var s5e=a5e,l5e=F5;function c5e(e){return l5e(this,e).has(e)}var u5e=c5e,d5e=F5;function h5e(e,t){var r=d5e(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var f5e=h5e,p5e=YCe,m5e=i5e,g5e=s5e,_5e=u5e,y5e=f5e;function qb(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}qb.prototype.clear=p5e;qb.prototype.delete=m5e;qb.prototype.get=g5e;qb.prototype.has=_5e;qb.prototype.set=y5e;var KR=qb,Lae=KR,v5e="Expected a function";function ZR(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(v5e);var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var s=e.apply(this,n);return r.cache=o.set(i,s)||o,s};return r.cache=new(ZR.Cache||Lae),r}ZR.Cache=Lae;var Dae=ZR;const b5e=sa(Dae);var x5e=Dae,w5e=500;function M5e(e){var t=x5e(e,function(n){return r.size===w5e&&r.clear(),n}),r=t.cache;return t}var S5e=M5e,T5e=S5e,P5e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,E5e=/\\(\\)?/g,A5e=T5e(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(P5e,function(r,n,i,o){t.push(i?o.replace(E5e,"$1"):n||r)}),t}),C5e=A5e;function k5e(e,t){for(var r=-1,n=e==null?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}var XR=k5e,OW=bS,I5e=XR,O5e=gd,L5e=Ub,D5e=1/0,LW=OW?OW.prototype:void 0,DW=LW?LW.toString:void 0;function $ae(e){if(typeof e=="string")return e;if(O5e(e))return I5e(e,$ae)+"";if(L5e(e))return DW?DW.call(e):"";var t=e+"";return t=="0"&&1/e==-D5e?"-0":t}var $5e=$ae,N5e=$5e;function j5e(e){return e==null?"":N5e(e)}var Nae=j5e,R5e=gd,F5e=WR,z5e=C5e,B5e=Nae;function U5e(e,t){return R5e(e)?e:F5e(e,t)?[e]:z5e(B5e(e))}var jae=U5e,V5e=Ub,W5e=1/0;function G5e(e){if(typeof e=="string"||V5e(e))return e;var t=e+"";return t=="0"&&1/e==-W5e?"-0":t}var z5=G5e,q5e=jae,H5e=z5;function K5e(e,t){t=q5e(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[H5e(t[r++])];return r&&r==n?e:void 0}var YR=K5e,Z5e=YR;function X5e(e,t,r){var n=e==null?void 0:Z5e(e,t);return n===void 0?r:n}var Rae=X5e;const eh=sa(Rae);function Y5e(e){return e==null}var Q5e=Y5e;const zi=sa(Q5e);var J5e=tg,eke=gd,tke=rg,rke="[object String]";function nke(e){return typeof e=="string"||!eke(e)&&tke(e)&&J5e(e)==rke}var ike=nke;const p0=sa(ike);var Fae={exports:{}},Ta={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QR=Symbol.for("react.element"),JR=Symbol.for("react.portal"),B5=Symbol.for("react.fragment"),U5=Symbol.for("react.strict_mode"),V5=Symbol.for("react.profiler"),W5=Symbol.for("react.provider"),G5=Symbol.for("react.context"),oke=Symbol.for("react.server_context"),q5=Symbol.for("react.forward_ref"),H5=Symbol.for("react.suspense"),K5=Symbol.for("react.suspense_list"),Z5=Symbol.for("react.memo"),X5=Symbol.for("react.lazy"),ake=Symbol.for("react.offscreen"),zae;zae=Symbol.for("react.module.reference");function Uh(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case QR:switch(e=e.type,e){case B5:case V5:case U5:case H5:case K5:return e;default:switch(e=e&&e.$$typeof,e){case oke:case G5:case q5:case X5:case Z5:case W5:return e;default:return t}}case JR:return t}}}Ta.ContextConsumer=G5;Ta.ContextProvider=W5;Ta.Element=QR;Ta.ForwardRef=q5;Ta.Fragment=B5;Ta.Lazy=X5;Ta.Memo=Z5;Ta.Portal=JR;Ta.Profiler=V5;Ta.StrictMode=U5;Ta.Suspense=H5;Ta.SuspenseList=K5;Ta.isAsyncMode=function(){return!1};Ta.isConcurrentMode=function(){return!1};Ta.isContextConsumer=function(e){return Uh(e)===G5};Ta.isContextProvider=function(e){return Uh(e)===W5};Ta.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===QR};Ta.isForwardRef=function(e){return Uh(e)===q5};Ta.isFragment=function(e){return Uh(e)===B5};Ta.isLazy=function(e){return Uh(e)===X5};Ta.isMemo=function(e){return Uh(e)===Z5};Ta.isPortal=function(e){return Uh(e)===JR};Ta.isProfiler=function(e){return Uh(e)===V5};Ta.isStrictMode=function(e){return Uh(e)===U5};Ta.isSuspense=function(e){return Uh(e)===H5};Ta.isSuspenseList=function(e){return Uh(e)===K5};Ta.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===B5||e===V5||e===U5||e===H5||e===K5||e===ake||typeof e=="object"&&e!==null&&(e.$$typeof===X5||e.$$typeof===Z5||e.$$typeof===W5||e.$$typeof===G5||e.$$typeof===q5||e.$$typeof===zae||e.getModuleId!==void 0)};Ta.typeOf=Uh;Fae.exports=Ta;var ske=Fae.exports,lke=tg,cke=rg,uke="[object Number]";function dke(e){return typeof e=="number"||cke(e)&&lke(e)==uke}var Bae=dke;const hke=sa(Bae);var fke=Bae;function pke(e){return fke(e)&&e!=+e}var mke=pke;const Hb=sa(mke);var Uu=function(t){return t===0?0:t>0?1:-1},Ly=function(t){return p0(t)&&t.indexOf("%")===t.length-1},hn=function(t){return hke(t)&&!Hb(t)},gke=function(t){return zi(t)},pc=function(t){return hn(t)||p0(t)},_ke=0,N0=function(t){var r=++_ke;return"".concat(t||"").concat(r)},Vu=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!hn(t)&&!p0(t))return n;var o;if(Ly(t)){var s=t.indexOf("%");o=r*parseFloat(t.slice(0,s))/100}else o=+t;return Hb(o)&&(o=n),i&&o>r&&(o=r),o},qg=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},yke=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},i=0;i<r;i++)if(!n[t[i]])n[t[i]]=!0;else return!0;return!1},hc=function(t,r){return hn(t)&&hn(r)?function(n){return t+n*(r-t)}:function(){return r}};function FA(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):eh(n,t))===r})}var vke=function(t,r){return hn(t)&&hn(r)?t-r:p0(t)&&p0(r)?t.localeCompare(r):t instanceof Date&&r instanceof Date?t.getTime()-r.getTime():String(t).localeCompare(String(r))};function x1(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function r$(e){"@babel/helpers - typeof";return r$=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r$(e)}var bke=["viewBox","children"],xke=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],$W=["points","pathLength"],tO={svg:bke,polygon:$W,polyline:$W},eF=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],zA=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(oe.isValidElement(t)&&(n=t.props),!Vb(n))return null;var i={};return Object.keys(n).forEach(function(o){eF.includes(o)&&(i[o]=r||function(s){return n[o](n,s)})}),i},wke=function(t,r,n){return function(i){return t(r,n,i),null}},m0=function(t,r,n){if(!Vb(t)||r$(t)!=="object")return null;var i=null;return Object.keys(t).forEach(function(o){var s=t[o];eF.includes(o)&&typeof s=="function"&&(i||(i={}),i[o]=wke(s,r,n))}),i},Mke=["children"],Ske=["children"];function NW(e,t){if(e==null)return{};var r=Tke(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Tke(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function n$(e){"@babel/helpers - typeof";return n$=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n$(e)}var jW={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},Rm=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},RW=null,rO=null,tF=function e(t){if(t===RW&&Array.isArray(rO))return rO;var r=[];return oe.Children.forEach(t,function(n){zi(n)||(ske.isFragment(n)?r=r.concat(e(n.props.children)):r.push(n))}),rO=r,RW=t,r};function th(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(i){return Rm(i)}):n=[Rm(t)],tF(e).forEach(function(i){var o=eh(i,"type.displayName")||eh(i,"type.name");n.indexOf(o)!==-1&&r.push(i)}),r}function Ud(e,t){var r=th(e,t);return r&&r[0]}var FW=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,i=r.height;return!(!hn(n)||n<=0||!hn(i)||i<=0)},Pke=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],Eke=function(t){return t&&t.type&&p0(t.type)&&Pke.indexOf(t.type)>=0},Uae=function(t){return t&&n$(t)==="object"&&"clipDot"in t},Ake=function(t,r,n,i){var o,s=(o=tO==null?void 0:tO[i])!==null&&o!==void 0?o:[];return r.startsWith("data-")||!Pi(t)&&(i&&s.includes(r)||xke.includes(r))||n&&eF.includes(r)},ii=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var i=t;if(oe.isValidElement(t)&&(i=t.props),!Vb(i))return null;var o={};return Object.keys(i).forEach(function(s){var a;Ake((a=i)===null||a===void 0?void 0:a[s],s,r,n)&&(o[s]=i[s])}),o},i$=function e(t,r){if(t===r)return!0;var n=oe.Children.count(t);if(n!==oe.Children.count(r))return!1;if(n===0)return!0;if(n===1)return zW(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var i=0;i<n;i++){var o=t[i],s=r[i];if(Array.isArray(o)||Array.isArray(s)){if(!e(o,s))return!1}else if(!zW(o,s))return!1}return!0},zW=function(t,r){if(zi(t)&&zi(r))return!0;if(!zi(t)&&!zi(r)){var n=t.props||{},i=n.children,o=NW(n,Mke),s=r.props||{},a=s.children,u=NW(s,Ske);return i&&a?x1(o,u)&&i$(i,a):!i&&!a?x1(o,u):!1}return!1},BW=function(t,r){var n=[],i={};return tF(t).forEach(function(o,s){if(Eke(o))n.push(o);else if(o){var a=Rm(o.type),u=r[a]||{},d=u.handler,m=u.once;if(d&&(!m||!i[a])){var g=d(o,a,s);n.push(g),i[a]=!0}}}),n},Cke=function(t){var r=t&&t.type;return r&&jW[r]?jW[r]:null},kke=function(t,r){return tF(r).indexOf(t)},Ike=["children","width","height","viewBox","className","style","title","desc"];function o$(){return o$=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o$.apply(this,arguments)}function Oke(e,t){if(e==null)return{};var r=Lke(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Lke(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function a$(e){var t=e.children,r=e.width,n=e.height,i=e.viewBox,o=e.className,s=e.style,a=e.title,u=e.desc,d=Oke(e,Ike),m=i||{width:r,height:n,x:0,y:0},g=Wi("recharts-surface",o);return ct.createElement("svg",o$({},ii(d,!0,"svg"),{className:g,width:r,height:n,style:s,viewBox:"".concat(m.x," ").concat(m.y," ").concat(m.width," ").concat(m.height)}),ct.createElement("title",null,a),ct.createElement("desc",null,u),t)}var Dke=["children","className"];function s$(){return s$=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s$.apply(this,arguments)}function $ke(e,t){if(e==null)return{};var r=Nke(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Nke(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var $o=ct.forwardRef(function(e,t){var r=e.children,n=e.className,i=$ke(e,Dke),o=Wi("recharts-layer",n);return ct.createElement("g",s$({className:o},ii(i,!0),{ref:t}),r)}),Ff=function(t,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o]};function jke(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),r=r>i?i:r,r<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var o=Array(i);++n<i;)o[n]=e[n+t];return o}var Rke=jke,Fke=Rke;function zke(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:Fke(e,t,r)}var Bke=zke,Uke="\\ud800-\\udfff",Vke="\\u0300-\\u036f",Wke="\\ufe20-\\ufe2f",Gke="\\u20d0-\\u20ff",qke=Vke+Wke+Gke,Hke="\\ufe0e\\ufe0f",Kke="\\u200d",Zke=RegExp("["+Kke+Uke+qke+Hke+"]");function Xke(e){return Zke.test(e)}var Vae=Xke;function Yke(e){return e.split("")}var Qke=Yke,Wae="\\ud800-\\udfff",Jke="\\u0300-\\u036f",eIe="\\ufe20-\\ufe2f",tIe="\\u20d0-\\u20ff",rIe=Jke+eIe+tIe,nIe="\\ufe0e\\ufe0f",iIe="["+Wae+"]",l$="["+rIe+"]",c$="\\ud83c[\\udffb-\\udfff]",oIe="(?:"+l$+"|"+c$+")",Gae="[^"+Wae+"]",qae="(?:\\ud83c[\\udde6-\\uddff]){2}",Hae="[\\ud800-\\udbff][\\udc00-\\udfff]",aIe="\\u200d",Kae=oIe+"?",Zae="["+nIe+"]?",sIe="(?:"+aIe+"(?:"+[Gae,qae,Hae].join("|")+")"+Zae+Kae+")*",lIe=Zae+Kae+sIe,cIe="(?:"+[Gae+l$+"?",l$,qae,Hae,iIe].join("|")+")",uIe=RegExp(c$+"(?="+c$+")|"+cIe+lIe,"g");function dIe(e){return e.match(uIe)||[]}var hIe=dIe,fIe=Qke,pIe=Vae,mIe=hIe;function gIe(e){return pIe(e)?mIe(e):fIe(e)}var _Ie=gIe,yIe=Bke,vIe=Vae,bIe=_Ie,xIe=Nae;function wIe(e){return function(t){t=xIe(t);var r=vIe(t)?bIe(t):void 0,n=r?r[0]:t.charAt(0),i=r?yIe(r,1).join(""):t.slice(1);return n[e]()+i}}var MIe=wIe,SIe=MIe,TIe=SIe("toUpperCase"),PIe=TIe;const Y5=sa(PIe);function ts(e){return function(){return e}}const Xae=Math.cos,BA=Math.sin,Xf=Math.sqrt,UA=Math.PI,Q5=2*UA,u$=Math.PI,d$=2*u$,vy=1e-6,EIe=d$-vy;function Yae(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function AIe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Yae;const r=10**t;return function(n){this._+=n[0];for(let i=1,o=n.length;i<o;++i)this._+=Math.round(arguments[i]*r)/r+n[i]}}class CIe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?Yae:AIe(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,i){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(t,r,n,i,o,s){this._append`C${+t},${+r},${+n},${+i},${this._x1=+o},${this._y1=+s}`}arcTo(t,r,n,i,o){if(t=+t,r=+r,n=+n,i=+i,o=+o,o<0)throw new Error(`negative radius: ${o}`);let s=this._x1,a=this._y1,u=n-t,d=i-r,m=s-t,g=a-r,_=m*m+g*g;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(_>vy)if(!(Math.abs(g*u-d*m)>vy)||!o)this._append`L${this._x1=t},${this._y1=r}`;else{let y=n-s,M=i-a,x=u*u+d*d,E=y*y+M*M,T=Math.sqrt(x),P=Math.sqrt(_),C=o*Math.tan((u$-Math.acos((x+_-E)/(2*T*P)))/2),D=C/P,L=C/T;Math.abs(D-1)>vy&&this._append`L${t+D*m},${r+D*g}`,this._append`A${o},${o},0,0,${+(g*y>m*M)},${this._x1=t+L*u},${this._y1=r+L*d}`}}arc(t,r,n,i,o,s){if(t=+t,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let a=n*Math.cos(i),u=n*Math.sin(i),d=t+a,m=r+u,g=1^s,_=s?i-o:o-i;this._x1===null?this._append`M${d},${m}`:(Math.abs(this._x1-d)>vy||Math.abs(this._y1-m)>vy)&&this._append`L${d},${m}`,n&&(_<0&&(_=_%d$+d$),_>EIe?this._append`A${n},${n},0,1,${g},${t-a},${r-u}A${n},${n},0,1,${g},${this._x1=d},${this._y1=m}`:_>vy&&this._append`A${n},${n},0,${+(_>=u$)},${g},${this._x1=t+n*Math.cos(o)},${this._y1=r+n*Math.sin(o)}`)}rect(t,r,n,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}}function rF(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new CIe(t)}function nF(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Qae(e){this._context=e}Qae.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function J5(e){return new Qae(e)}function Jae(e){return e[0]}function ese(e){return e[1]}function tse(e,t){var r=ts(!0),n=null,i=J5,o=null,s=rF(a);e=typeof e=="function"?e:e===void 0?Jae:ts(e),t=typeof t=="function"?t:t===void 0?ese:ts(t);function a(u){var d,m=(u=nF(u)).length,g,_=!1,y;for(n==null&&(o=i(y=s())),d=0;d<=m;++d)!(d<m&&r(g=u[d],d,u))===_&&((_=!_)?o.lineStart():o.lineEnd()),_&&o.point(+e(g,d,u),+t(g,d,u));if(y)return o=null,y+""||null}return a.x=function(u){return arguments.length?(e=typeof u=="function"?u:ts(+u),a):e},a.y=function(u){return arguments.length?(t=typeof u=="function"?u:ts(+u),a):t},a.defined=function(u){return arguments.length?(r=typeof u=="function"?u:ts(!!u),a):r},a.curve=function(u){return arguments.length?(i=u,n!=null&&(o=i(n)),a):i},a.context=function(u){return arguments.length?(u==null?n=o=null:o=i(n=u),a):n},a}function jP(e,t,r){var n=null,i=ts(!0),o=null,s=J5,a=null,u=rF(d);e=typeof e=="function"?e:e===void 0?Jae:ts(+e),t=typeof t=="function"?t:ts(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?ese:ts(+r);function d(g){var _,y,M,x=(g=nF(g)).length,E,T=!1,P,C=new Array(x),D=new Array(x);for(o==null&&(a=s(P=u())),_=0;_<=x;++_){if(!(_<x&&i(E=g[_],_,g))===T)if(T=!T)y=_,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),M=_-1;M>=y;--M)a.point(C[M],D[M]);a.lineEnd(),a.areaEnd()}T&&(C[_]=+e(E,_,g),D[_]=+t(E,_,g),a.point(n?+n(E,_,g):C[_],r?+r(E,_,g):D[_]))}if(P)return a=null,P+""||null}function m(){return tse().defined(i).curve(s).context(o)}return d.x=function(g){return arguments.length?(e=typeof g=="function"?g:ts(+g),n=null,d):e},d.x0=function(g){return arguments.length?(e=typeof g=="function"?g:ts(+g),d):e},d.x1=function(g){return arguments.length?(n=g==null?null:typeof g=="function"?g:ts(+g),d):n},d.y=function(g){return arguments.length?(t=typeof g=="function"?g:ts(+g),r=null,d):t},d.y0=function(g){return arguments.length?(t=typeof g=="function"?g:ts(+g),d):t},d.y1=function(g){return arguments.length?(r=g==null?null:typeof g=="function"?g:ts(+g),d):r},d.lineX0=d.lineY0=function(){return m().x(e).y(t)},d.lineY1=function(){return m().x(e).y(r)},d.lineX1=function(){return m().x(n).y(t)},d.defined=function(g){return arguments.length?(i=typeof g=="function"?g:ts(!!g),d):i},d.curve=function(g){return arguments.length?(s=g,o!=null&&(a=s(o)),d):s},d.context=function(g){return arguments.length?(g==null?o=a=null:a=s(o=g),d):o},d}class rse{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function kIe(e){return new rse(e,!0)}function IIe(e){return new rse(e,!1)}const iF={draw(e,t){const r=Xf(t/UA);e.moveTo(r,0),e.arc(0,0,r,0,Q5)}},OIe={draw(e,t){const r=Xf(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},nse=Xf(1/3),LIe=nse*2,DIe={draw(e,t){const r=Xf(t/LIe),n=r*nse;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},$Ie={draw(e,t){const r=Xf(t),n=-r/2;e.rect(n,n,r,r)}},NIe=.8908130915292852,ise=BA(UA/10)/BA(7*UA/10),jIe=BA(Q5/10)*ise,RIe=-Xae(Q5/10)*ise,FIe={draw(e,t){const r=Xf(t*NIe),n=jIe*r,i=RIe*r;e.moveTo(0,-r),e.lineTo(n,i);for(let o=1;o<5;++o){const s=Q5*o/5,a=Xae(s),u=BA(s);e.lineTo(u*r,-a*r),e.lineTo(a*n-u*i,u*n+a*i)}e.closePath()}},nO=Xf(3),zIe={draw(e,t){const r=-Xf(t/(nO*3));e.moveTo(0,r*2),e.lineTo(-nO*r,-r),e.lineTo(nO*r,-r),e.closePath()}},vh=-.5,bh=Xf(3)/2,h$=1/Xf(12),BIe=(h$/2+1)*3,UIe={draw(e,t){const r=Xf(t/BIe),n=r/2,i=r*h$,o=n,s=r*h$+r,a=-o,u=s;e.moveTo(n,i),e.lineTo(o,s),e.lineTo(a,u),e.lineTo(vh*n-bh*i,bh*n+vh*i),e.lineTo(vh*o-bh*s,bh*o+vh*s),e.lineTo(vh*a-bh*u,bh*a+vh*u),e.lineTo(vh*n+bh*i,vh*i-bh*n),e.lineTo(vh*o+bh*s,vh*s-bh*o),e.lineTo(vh*a+bh*u,vh*u-bh*a),e.closePath()}};function VIe(e,t){let r=null,n=rF(i);e=typeof e=="function"?e:ts(e||iF),t=typeof t=="function"?t:ts(t===void 0?64:+t);function i(){let o;if(r||(r=o=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),o)return r=null,o+""||null}return i.type=function(o){return arguments.length?(e=typeof o=="function"?o:ts(o),i):e},i.size=function(o){return arguments.length?(t=typeof o=="function"?o:ts(+o),i):t},i.context=function(o){return arguments.length?(r=o??null,i):r},i}function VA(){}function WA(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function ose(e){this._context=e}ose.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:WA(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:WA(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function WIe(e){return new ose(e)}function ase(e){this._context=e}ase.prototype={areaStart:VA,areaEnd:VA,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:WA(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function GIe(e){return new ase(e)}function sse(e){this._context=e}sse.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:WA(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function qIe(e){return new sse(e)}function lse(e){this._context=e}lse.prototype={areaStart:VA,areaEnd:VA,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function HIe(e){return new lse(e)}function UW(e){return e<0?-1:1}function VW(e,t,r){var n=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(n||i<0&&-0),s=(r-e._y1)/(i||n<0&&-0),a=(o*i+s*n)/(n+i);return(UW(o)+UW(s))*Math.min(Math.abs(o),Math.abs(s),.5*Math.abs(a))||0}function WW(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function iO(e,t,r){var n=e._x0,i=e._y0,o=e._x1,s=e._y1,a=(o-n)/3;e._context.bezierCurveTo(n+a,i+a*t,o-a,s-a*r,o,s)}function GA(e){this._context=e}GA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:iO(this,this._t0,WW(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,iO(this,WW(this,r=VW(this,e,t)),r);break;default:iO(this,this._t0,r=VW(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function cse(e){this._context=new use(e)}(cse.prototype=Object.create(GA.prototype)).point=function(e,t){GA.prototype.point.call(this,t,e)};function use(e){this._context=e}use.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,i,o){this._context.bezierCurveTo(t,e,n,r,o,i)}};function KIe(e){return new GA(e)}function ZIe(e){return new cse(e)}function dse(e){this._context=e}dse.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=GW(e),i=GW(t),o=0,s=1;s<r;++o,++s)this._context.bezierCurveTo(n[0][o],i[0][o],n[1][o],i[1][o],e[s],t[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function GW(e){var t,r=e.length-1,n,i=new Array(r),o=new Array(r),s=new Array(r);for(i[0]=0,o[0]=2,s[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,o[t]=4,s[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,o[r-1]=7,s[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/o[t-1],o[t]-=n,s[t]-=n*s[t-1];for(i[r-1]=s[r-1]/o[r-1],t=r-2;t>=0;--t)i[t]=(s[t]-i[t+1])/o[t];for(o[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)o[t]=2*e[t+1]-i[t+1];return[i,o]}function XIe(e){return new dse(e)}function ek(e,t){this._context=e,this._t=t}ek.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function YIe(e){return new ek(e,.5)}function QIe(e){return new ek(e,0)}function JIe(e){return new ek(e,1)}function J1(e,t){if((s=e.length)>1)for(var r=1,n,i,o=e[t[0]],s,a=o.length;r<s;++r)for(i=o,o=e[t[r]],n=0;n<a;++n)o[n][1]+=o[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function f$(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function e3e(e,t){return e[t]}function t3e(e){const t=[];return t.key=e,t}function r3e(){var e=ts([]),t=f$,r=J1,n=e3e;function i(o){var s=Array.from(e.apply(this,arguments),t3e),a,u=s.length,d=-1,m;for(const g of o)for(a=0,++d;a<u;++a)(s[a][d]=[0,+n(g,s[a].key,d,o)]).data=g;for(a=0,m=nF(t(s));a<u;++a)s[m[a]].index=a;return r(s,m),s}return i.keys=function(o){return arguments.length?(e=typeof o=="function"?o:ts(Array.from(o)),i):e},i.value=function(o){return arguments.length?(n=typeof o=="function"?o:ts(+o),i):n},i.order=function(o){return arguments.length?(t=o==null?f$:typeof o=="function"?o:ts(Array.from(o)),i):t},i.offset=function(o){return arguments.length?(r=o??J1,i):r},i}function n3e(e,t){if((n=e.length)>0){for(var r,n,i=0,o=e[0].length,s;i<o;++i){for(s=r=0;r<n;++r)s+=e[r][i][1]||0;if(s)for(r=0;r<n;++r)e[r][i][1]/=s}J1(e,t)}}function i3e(e,t){if((i=e.length)>0){for(var r=0,n=e[t[0]],i,o=n.length;r<o;++r){for(var s=0,a=0;s<i;++s)a+=e[s][r][1]||0;n[r][1]+=n[r][0]=-a/2}J1(e,t)}}function o3e(e,t){if(!(!((s=e.length)>0)||!((o=(i=e[t[0]]).length)>0))){for(var r=0,n=1,i,o,s;n<o;++n){for(var a=0,u=0,d=0;a<s;++a){for(var m=e[t[a]],g=m[n][1]||0,_=m[n-1][1]||0,y=(g-_)/2,M=0;M<a;++M){var x=e[t[M]],E=x[n][1]||0,T=x[n-1][1]||0;y+=E-T}u+=g,d+=y*g}i[n-1][1]+=i[n-1][0]=r,u&&(r-=d/u)}i[n-1][1]+=i[n-1][0]=r,J1(e,t)}}function uM(e){"@babel/helpers - typeof";return uM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uM(e)}var a3e=["type","size","sizeType"];function p$(){return p$=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},p$.apply(this,arguments)}function qW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function HW(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qW(Object(r),!0).forEach(function(n){s3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qW(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function s3e(e,t,r){return t=l3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l3e(e){var t=c3e(e,"string");return uM(t)=="symbol"?t:t+""}function c3e(e,t){if(uM(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uM(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function u3e(e,t){if(e==null)return{};var r=d3e(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function d3e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var hse={symbolCircle:iF,symbolCross:OIe,symbolDiamond:DIe,symbolSquare:$Ie,symbolStar:FIe,symbolTriangle:zIe,symbolWye:UIe},h3e=Math.PI/180,f3e=function(t){var r="symbol".concat(Y5(t));return hse[r]||iF},p3e=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var i=18*h3e;return 1.25*t*t*(Math.tan(i)-Math.tan(i*2)*Math.pow(Math.tan(i),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},m3e=function(t,r){hse["symbol".concat(Y5(t))]=r},oF=function(t){var r=t.type,n=r===void 0?"circle":r,i=t.size,o=i===void 0?64:i,s=t.sizeType,a=s===void 0?"area":s,u=u3e(t,a3e),d=HW(HW({},u),{},{type:n,size:o,sizeType:a}),m=function(){var E=f3e(n),T=VIe().type(E).size(p3e(o,a,n));return T()},g=d.className,_=d.cx,y=d.cy,M=ii(d,!0);return _===+_&&y===+y&&o===+o?ct.createElement("path",p$({},M,{className:Wi("recharts-symbols",g),transform:"translate(".concat(_,", ").concat(y,")"),d:m()})):null};oF.registerSymbol=m3e;function eb(e){"@babel/helpers - typeof";return eb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eb(e)}function m$(){return m$=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},m$.apply(this,arguments)}function KW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function g3e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?KW(Object(r),!0).forEach(function(n){dM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):KW(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y3e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pse(n.key),n)}}function v3e(e,t,r){return t&&y3e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function b3e(e,t,r){return t=qA(t),x3e(e,fse()?Reflect.construct(t,r||[],qA(e).constructor):t.apply(e,r))}function x3e(e,t){if(t&&(eb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return w3e(e)}function w3e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fse(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fse=function(){return!!e})()}function qA(e){return qA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qA(e)}function M3e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g$(e,t)}function g$(e,t){return g$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},g$(e,t)}function dM(e,t,r){return t=pse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pse(e){var t=S3e(e,"string");return eb(t)=="symbol"?t:t+""}function S3e(e,t){if(eb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(eb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xh=32,aF=function(e){function t(){return _3e(this,t),b3e(this,t,arguments)}return M3e(t,e),v3e(t,[{key:"renderIcon",value:function(n){var i=this.props.inactiveColor,o=xh/2,s=xh/6,a=xh/3,u=n.inactive?i:n.color;if(n.type==="plainline")return ct.createElement("line",{strokeWidth:4,fill:"none",stroke:u,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:o,x2:xh,y2:o,className:"recharts-legend-icon"});if(n.type==="line")return ct.createElement("path",{strokeWidth:4,fill:"none",stroke:u,d:"M0,".concat(o,"h").concat(a,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(2*a,",").concat(o,`
            H`).concat(xh,"M").concat(2*a,",").concat(o,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(a,",").concat(o),className:"recharts-legend-icon"});if(n.type==="rect")return ct.createElement("path",{stroke:"none",fill:u,d:"M0,".concat(xh/8,"h").concat(xh,"v").concat(xh*3/4,"h").concat(-xh,"z"),className:"recharts-legend-icon"});if(ct.isValidElement(n.legendIcon)){var d=g3e({},n);return delete d.legendIcon,ct.cloneElement(n.legendIcon,d)}return ct.createElement(oF,{fill:u,cx:o,cy:o,size:xh,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,i=this.props,o=i.payload,s=i.iconSize,a=i.layout,u=i.formatter,d=i.inactiveColor,m={x:0,y:0,width:xh,height:xh},g={display:a==="horizontal"?"inline-block":"block",marginRight:10},_={display:"inline-block",verticalAlign:"middle",marginRight:4};return o.map(function(y,M){var x=y.formatter||u,E=Wi(dM(dM({"recharts-legend-item":!0},"legend-item-".concat(M),!0),"inactive",y.inactive));if(y.type==="none")return null;var T=Pi(y.value)?null:y.value;Ff(!Pi(y.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var P=y.inactive?d:y.color;return ct.createElement("li",m$({className:E,style:g,key:"legend-item-".concat(M)},m0(n.props,y,M)),ct.createElement(a$,{width:s,height:s,viewBox:m,style:_},n.renderIcon(y)),ct.createElement("span",{className:"recharts-legend-item-text",style:{color:P}},x?x(T,y,M):T))})}},{key:"render",value:function(){var n=this.props,i=n.payload,o=n.layout,s=n.align;if(!i||!i.length)return null;var a={padding:0,margin:0,textAlign:o==="horizontal"?s:"left"};return ct.createElement("ul",{className:"recharts-default-legend",style:a},this.renderItems())}}])}(oe.PureComponent);dM(aF,"displayName","Legend");dM(aF,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var T3e=R5;function P3e(){this.__data__=new T3e,this.size=0}var E3e=P3e;function A3e(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var C3e=A3e;function k3e(e){return this.__data__.get(e)}var I3e=k3e;function O3e(e){return this.__data__.has(e)}var L3e=O3e,D3e=R5,$3e=HR,N3e=KR,j3e=200;function R3e(e,t){var r=this.__data__;if(r instanceof D3e){var n=r.__data__;if(!$3e||n.length<j3e-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new N3e(n)}return r.set(e,t),this.size=r.size,this}var F3e=R3e,z3e=R5,B3e=E3e,U3e=C3e,V3e=I3e,W3e=L3e,G3e=F3e;function Kb(e){var t=this.__data__=new z3e(e);this.size=t.size}Kb.prototype.clear=B3e;Kb.prototype.delete=U3e;Kb.prototype.get=V3e;Kb.prototype.has=W3e;Kb.prototype.set=G3e;var mse=Kb,q3e="__lodash_hash_undefined__";function H3e(e){return this.__data__.set(e,q3e),this}var K3e=H3e;function Z3e(e){return this.__data__.has(e)}var X3e=Z3e,Y3e=KR,Q3e=K3e,J3e=X3e;function HA(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new Y3e;++t<r;)this.add(e[t])}HA.prototype.add=HA.prototype.push=Q3e;HA.prototype.has=J3e;var gse=HA;function eOe(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var _se=eOe;function tOe(e,t){return e.has(t)}var yse=tOe,rOe=gse,nOe=_se,iOe=yse,oOe=1,aOe=2;function sOe(e,t,r,n,i,o){var s=r&oOe,a=e.length,u=t.length;if(a!=u&&!(s&&u>a))return!1;var d=o.get(e),m=o.get(t);if(d&&m)return d==t&&m==e;var g=-1,_=!0,y=r&aOe?new rOe:void 0;for(o.set(e,t),o.set(t,e);++g<a;){var M=e[g],x=t[g];if(n)var E=s?n(x,M,g,t,e,o):n(M,x,g,e,t,o);if(E!==void 0){if(E)continue;_=!1;break}if(y){if(!nOe(t,function(T,P){if(!iOe(y,P)&&(M===T||i(M,T,r,n,o)))return y.push(P)})){_=!1;break}}else if(!(M===x||i(M,x,r,n,o))){_=!1;break}}return o.delete(e),o.delete(t),_}var vse=sOe,lOe=Yp,cOe=lOe.Uint8Array,uOe=cOe;function dOe(e){var t=-1,r=Array(e.size);return e.forEach(function(n,i){r[++t]=[i,n]}),r}var hOe=dOe;function fOe(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var sF=fOe,ZW=bS,XW=uOe,pOe=qR,mOe=vse,gOe=hOe,_Oe=sF,yOe=1,vOe=2,bOe="[object Boolean]",xOe="[object Date]",wOe="[object Error]",MOe="[object Map]",SOe="[object Number]",TOe="[object RegExp]",POe="[object Set]",EOe="[object String]",AOe="[object Symbol]",COe="[object ArrayBuffer]",kOe="[object DataView]",YW=ZW?ZW.prototype:void 0,oO=YW?YW.valueOf:void 0;function IOe(e,t,r,n,i,o,s){switch(r){case kOe:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case COe:return!(e.byteLength!=t.byteLength||!o(new XW(e),new XW(t)));case bOe:case xOe:case SOe:return pOe(+e,+t);case wOe:return e.name==t.name&&e.message==t.message;case TOe:case EOe:return e==t+"";case MOe:var a=gOe;case POe:var u=n&yOe;if(a||(a=_Oe),e.size!=t.size&&!u)return!1;var d=s.get(e);if(d)return d==t;n|=vOe,s.set(e,t);var m=mOe(a(e),a(t),n,i,o,s);return s.delete(e),m;case AOe:if(oO)return oO.call(e)==oO.call(t)}return!1}var OOe=IOe;function LOe(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}var bse=LOe,DOe=bse,$Oe=gd;function NOe(e,t,r){var n=t(e);return $Oe(e)?n:DOe(n,r(e))}var jOe=NOe;function ROe(e,t){for(var r=-1,n=e==null?0:e.length,i=0,o=[];++r<n;){var s=e[r];t(s,r,e)&&(o[i++]=s)}return o}var FOe=ROe;function zOe(){return[]}var BOe=zOe,UOe=FOe,VOe=BOe,WOe=Object.prototype,GOe=WOe.propertyIsEnumerable,QW=Object.getOwnPropertySymbols,qOe=QW?function(e){return e==null?[]:(e=Object(e),UOe(QW(e),function(t){return GOe.call(e,t)}))}:VOe,HOe=qOe;function KOe(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var ZOe=KOe,XOe=tg,YOe=rg,QOe="[object Arguments]";function JOe(e){return YOe(e)&&XOe(e)==QOe}var eLe=JOe,JW=eLe,tLe=rg,xse=Object.prototype,rLe=xse.hasOwnProperty,nLe=xse.propertyIsEnumerable,iLe=JW(function(){return arguments}())?JW:function(e){return tLe(e)&&rLe.call(e,"callee")&&!nLe.call(e,"callee")},lF=iLe,KA={exports:{}};function oLe(){return!1}var aLe=oLe;KA.exports;(function(e,t){var r=Yp,n=aLe,i=t&&!t.nodeType&&t,o=i&&!0&&e&&!e.nodeType&&e,s=o&&o.exports===i,a=s?r.Buffer:void 0,u=a?a.isBuffer:void 0,d=u||n;e.exports=d})(KA,KA.exports);var wse=KA.exports,sLe=9007199254740991,lLe=/^(?:0|[1-9]\d*)$/;function cLe(e,t){var r=typeof e;return t=t??sLe,!!t&&(r=="number"||r!="symbol"&&lLe.test(e))&&e>-1&&e%1==0&&e<t}var cF=cLe,uLe=9007199254740991;function dLe(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=uLe}var uF=dLe,hLe=tg,fLe=uF,pLe=rg,mLe="[object Arguments]",gLe="[object Array]",_Le="[object Boolean]",yLe="[object Date]",vLe="[object Error]",bLe="[object Function]",xLe="[object Map]",wLe="[object Number]",MLe="[object Object]",SLe="[object RegExp]",TLe="[object Set]",PLe="[object String]",ELe="[object WeakMap]",ALe="[object ArrayBuffer]",CLe="[object DataView]",kLe="[object Float32Array]",ILe="[object Float64Array]",OLe="[object Int8Array]",LLe="[object Int16Array]",DLe="[object Int32Array]",$Le="[object Uint8Array]",NLe="[object Uint8ClampedArray]",jLe="[object Uint16Array]",RLe="[object Uint32Array]",ys={};ys[kLe]=ys[ILe]=ys[OLe]=ys[LLe]=ys[DLe]=ys[$Le]=ys[NLe]=ys[jLe]=ys[RLe]=!0;ys[mLe]=ys[gLe]=ys[ALe]=ys[_Le]=ys[CLe]=ys[yLe]=ys[vLe]=ys[bLe]=ys[xLe]=ys[wLe]=ys[MLe]=ys[SLe]=ys[TLe]=ys[PLe]=ys[ELe]=!1;function FLe(e){return pLe(e)&&fLe(e.length)&&!!ys[hLe(e)]}var zLe=FLe;function BLe(e){return function(t){return e(t)}}var Mse=BLe,ZA={exports:{}};ZA.exports;(function(e,t){var r=kae,n=t&&!t.nodeType&&t,i=n&&!0&&e&&!e.nodeType&&e,o=i&&i.exports===n,s=o&&r.process,a=function(){try{var u=i&&i.require&&i.require("util").types;return u||s&&s.binding&&s.binding("util")}catch{}}();e.exports=a})(ZA,ZA.exports);var ULe=ZA.exports,VLe=zLe,WLe=Mse,e9=ULe,t9=e9&&e9.isTypedArray,GLe=t9?WLe(t9):VLe,Sse=GLe,qLe=ZOe,HLe=lF,KLe=gd,ZLe=wse,XLe=cF,YLe=Sse,QLe=Object.prototype,JLe=QLe.hasOwnProperty;function eDe(e,t){var r=KLe(e),n=!r&&HLe(e),i=!r&&!n&&ZLe(e),o=!r&&!n&&!i&&YLe(e),s=r||n||i||o,a=s?qLe(e.length,String):[],u=a.length;for(var d in e)(t||JLe.call(e,d))&&!(s&&(d=="length"||i&&(d=="offset"||d=="parent")||o&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||XLe(d,u)))&&a.push(d);return a}var tDe=eDe,rDe=Object.prototype;function nDe(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||rDe;return e===r}var iDe=nDe;function oDe(e,t){return function(r){return e(t(r))}}var Tse=oDe,aDe=Tse,sDe=aDe(Object.keys,Object),lDe=sDe,cDe=iDe,uDe=lDe,dDe=Object.prototype,hDe=dDe.hasOwnProperty;function fDe(e){if(!cDe(e))return uDe(e);var t=[];for(var r in Object(e))hDe.call(e,r)&&r!="constructor"&&t.push(r);return t}var pDe=fDe,mDe=GR,gDe=uF;function _De(e){return e!=null&&gDe(e.length)&&!mDe(e)}var xS=_De,yDe=tDe,vDe=pDe,bDe=xS;function xDe(e){return bDe(e)?yDe(e):vDe(e)}var tk=xDe,wDe=jOe,MDe=HOe,SDe=tk;function TDe(e){return wDe(e,SDe,MDe)}var PDe=TDe,r9=PDe,EDe=1,ADe=Object.prototype,CDe=ADe.hasOwnProperty;function kDe(e,t,r,n,i,o){var s=r&EDe,a=r9(e),u=a.length,d=r9(t),m=d.length;if(u!=m&&!s)return!1;for(var g=u;g--;){var _=a[g];if(!(s?_ in t:CDe.call(t,_)))return!1}var y=o.get(e),M=o.get(t);if(y&&M)return y==t&&M==e;var x=!0;o.set(e,t),o.set(t,e);for(var E=s;++g<u;){_=a[g];var T=e[_],P=t[_];if(n)var C=s?n(P,T,_,t,e,o):n(T,P,_,e,t,o);if(!(C===void 0?T===P||i(T,P,r,n,o):C)){x=!1;break}E||(E=_=="constructor")}if(x&&!E){var D=e.constructor,L=t.constructor;D!=L&&"constructor"in e&&"constructor"in t&&!(typeof D=="function"&&D instanceof D&&typeof L=="function"&&L instanceof L)&&(x=!1)}return o.delete(e),o.delete(t),x}var IDe=kDe,ODe=$0,LDe=Yp,DDe=ODe(LDe,"DataView"),$De=DDe,NDe=$0,jDe=Yp,RDe=NDe(jDe,"Promise"),FDe=RDe,zDe=$0,BDe=Yp,UDe=zDe(BDe,"Set"),Pse=UDe,VDe=$0,WDe=Yp,GDe=VDe(WDe,"WeakMap"),qDe=GDe,_$=$De,y$=HR,v$=FDe,b$=Pse,x$=qDe,Ese=tg,Zb=Oae,n9="[object Map]",HDe="[object Object]",i9="[object Promise]",o9="[object Set]",a9="[object WeakMap]",s9="[object DataView]",KDe=Zb(_$),ZDe=Zb(y$),XDe=Zb(v$),YDe=Zb(b$),QDe=Zb(x$),by=Ese;(_$&&by(new _$(new ArrayBuffer(1)))!=s9||y$&&by(new y$)!=n9||v$&&by(v$.resolve())!=i9||b$&&by(new b$)!=o9||x$&&by(new x$)!=a9)&&(by=function(e){var t=Ese(e),r=t==HDe?e.constructor:void 0,n=r?Zb(r):"";if(n)switch(n){case KDe:return s9;case ZDe:return n9;case XDe:return i9;case YDe:return o9;case QDe:return a9}return t});var JDe=by,aO=mse,e$e=vse,t$e=OOe,r$e=IDe,l9=JDe,c9=gd,u9=wse,n$e=Sse,i$e=1,d9="[object Arguments]",h9="[object Array]",RP="[object Object]",o$e=Object.prototype,f9=o$e.hasOwnProperty;function a$e(e,t,r,n,i,o){var s=c9(e),a=c9(t),u=s?h9:l9(e),d=a?h9:l9(t);u=u==d9?RP:u,d=d==d9?RP:d;var m=u==RP,g=d==RP,_=u==d;if(_&&u9(e)){if(!u9(t))return!1;s=!0,m=!1}if(_&&!m)return o||(o=new aO),s||n$e(e)?e$e(e,t,r,n,i,o):t$e(e,t,u,r,n,i,o);if(!(r&i$e)){var y=m&&f9.call(e,"__wrapped__"),M=g&&f9.call(t,"__wrapped__");if(y||M){var x=y?e.value():e,E=M?t.value():t;return o||(o=new aO),i(x,E,r,n,o)}}return _?(o||(o=new aO),r$e(e,t,r,n,i,o)):!1}var s$e=a$e,l$e=s$e,p9=rg;function Ase(e,t,r,n,i){return e===t?!0:e==null||t==null||!p9(e)&&!p9(t)?e!==e&&t!==t:l$e(e,t,r,n,Ase,i)}var dF=Ase,c$e=mse,u$e=dF,d$e=1,h$e=2;function f$e(e,t,r,n){var i=r.length,o=i,s=!n;if(e==null)return!o;for(e=Object(e);i--;){var a=r[i];if(s&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++i<o;){a=r[i];var u=a[0],d=e[u],m=a[1];if(s&&a[2]){if(d===void 0&&!(u in e))return!1}else{var g=new c$e;if(n)var _=n(d,m,u,e,t,g);if(!(_===void 0?u$e(m,d,d$e|h$e,n,g):_))return!1}}return!0}var p$e=f$e,m$e=j_;function g$e(e){return e===e&&!m$e(e)}var Cse=g$e,_$e=Cse,y$e=tk;function v$e(e){for(var t=y$e(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,_$e(i)]}return t}var b$e=v$e;function x$e(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var kse=x$e,w$e=p$e,M$e=b$e,S$e=kse;function T$e(e){var t=M$e(e);return t.length==1&&t[0][2]?S$e(t[0][0],t[0][1]):function(r){return r===e||w$e(r,e,t)}}var P$e=T$e;function E$e(e,t){return e!=null&&t in Object(e)}var A$e=E$e,C$e=jae,k$e=lF,I$e=gd,O$e=cF,L$e=uF,D$e=z5;function $$e(e,t,r){t=C$e(t,e);for(var n=-1,i=t.length,o=!1;++n<i;){var s=D$e(t[n]);if(!(o=e!=null&&r(e,s)))break;e=e[s]}return o||++n!=i?o:(i=e==null?0:e.length,!!i&&L$e(i)&&O$e(s,i)&&(I$e(e)||k$e(e)))}var N$e=$$e,j$e=A$e,R$e=N$e;function F$e(e,t){return e!=null&&R$e(e,t,j$e)}var z$e=F$e,B$e=dF,U$e=Rae,V$e=z$e,W$e=WR,G$e=Cse,q$e=kse,H$e=z5,K$e=1,Z$e=2;function X$e(e,t){return W$e(e)&&G$e(t)?q$e(H$e(e),t):function(r){var n=U$e(r,e);return n===void 0&&n===t?V$e(r,e):B$e(t,n,K$e|Z$e)}}var Y$e=X$e;function Q$e(e){return e}var Xb=Q$e;function J$e(e){return function(t){return t==null?void 0:t[e]}}var eNe=J$e,tNe=YR;function rNe(e){return function(t){return tNe(t,e)}}var nNe=rNe,iNe=eNe,oNe=nNe,aNe=WR,sNe=z5;function lNe(e){return aNe(e)?iNe(sNe(e)):oNe(e)}var cNe=lNe,uNe=P$e,dNe=Y$e,hNe=Xb,fNe=gd,pNe=cNe;function mNe(e){return typeof e=="function"?e:e==null?hNe:typeof e=="object"?fNe(e)?dNe(e[0],e[1]):uNe(e):pNe(e)}var Qp=mNe;function gNe(e,t,r,n){for(var i=e.length,o=r+(n?1:-1);n?o--:++o<i;)if(t(e[o],o,e))return o;return-1}var Ise=gNe;function _Ne(e){return e!==e}var yNe=_Ne;function vNe(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}var bNe=vNe,xNe=Ise,wNe=yNe,MNe=bNe;function SNe(e,t,r){return t===t?MNe(e,t,r):xNe(e,wNe,r)}var TNe=SNe,PNe=TNe;function ENe(e,t){var r=e==null?0:e.length;return!!r&&PNe(e,t,0)>-1}var ANe=ENe;function CNe(e,t,r){for(var n=-1,i=e==null?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1}var kNe=CNe;function INe(){}var ONe=INe,sO=Pse,LNe=ONe,DNe=sF,$Ne=1/0,NNe=sO&&1/DNe(new sO([,-0]))[1]==$Ne?function(e){return new sO(e)}:LNe,jNe=NNe,RNe=gse,FNe=ANe,zNe=kNe,BNe=yse,UNe=jNe,VNe=sF,WNe=200;function GNe(e,t,r){var n=-1,i=FNe,o=e.length,s=!0,a=[],u=a;if(r)s=!1,i=zNe;else if(o>=WNe){var d=t?null:UNe(e);if(d)return VNe(d);s=!1,i=BNe,u=new RNe}else u=t?[]:a;e:for(;++n<o;){var m=e[n],g=t?t(m):m;if(m=r||m!==0?m:0,s&&g===g){for(var _=u.length;_--;)if(u[_]===g)continue e;t&&u.push(g),a.push(m)}else i(u,g,r)||(u!==a&&u.push(g),a.push(m))}return a}var qNe=GNe,HNe=Qp,KNe=qNe;function ZNe(e,t){return e&&e.length?KNe(e,HNe(t)):[]}var XNe=ZNe;const m9=sa(XNe);function Ose(e,t,r){return t===!0?m9(e,r):Pi(t)?m9(e,t):e}function tb(e){"@babel/helpers - typeof";return tb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tb(e)}var YNe=["ref"];function g9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function bm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?g9(Object(r),!0).forEach(function(n){rk(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function QNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Dse(n.key),n)}}function JNe(e,t,r){return t&&_9(e.prototype,t),r&&_9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function e4e(e,t,r){return t=XA(t),t4e(e,Lse()?Reflect.construct(t,r||[],XA(e).constructor):t.apply(e,r))}function t4e(e,t){if(t&&(tb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return r4e(e)}function r4e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lse(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Lse=function(){return!!e})()}function XA(e){return XA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},XA(e)}function n4e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w$(e,t)}function w$(e,t){return w$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},w$(e,t)}function rk(e,t,r){return t=Dse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Dse(e){var t=i4e(e,"string");return tb(t)=="symbol"?t:t+""}function i4e(e,t){if(tb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function o4e(e,t){if(e==null)return{};var r=a4e(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function a4e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function s4e(e){return e.value}function l4e(e,t){if(ct.isValidElement(e))return ct.cloneElement(e,t);if(typeof e=="function")return ct.createElement(e,t);t.ref;var r=o4e(t,YNe);return ct.createElement(aF,r)}var y9=1,w1=function(e){function t(){var r;QNe(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return r=e4e(this,t,[].concat(i)),rk(r,"lastBoundingBox",{width:-1,height:-1}),r}return n4e(t,e),JNe(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,i=this.getBBox();i?(Math.abs(i.width-this.lastBoundingBox.width)>y9||Math.abs(i.height-this.lastBoundingBox.height)>y9)&&(this.lastBoundingBox.width=i.width,this.lastBoundingBox.height=i.height,n&&n(i)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?bm({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var i=this.props,o=i.layout,s=i.align,a=i.verticalAlign,u=i.margin,d=i.chartWidth,m=i.chartHeight,g,_;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(s==="center"&&o==="vertical"){var y=this.getBBoxSnapshot();g={left:((d||0)-y.width)/2}}else g=s==="right"?{right:u&&u.right||0}:{left:u&&u.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(a==="middle"){var M=this.getBBoxSnapshot();_={top:((m||0)-M.height)/2}}else _=a==="bottom"?{bottom:u&&u.bottom||0}:{top:u&&u.top||0};return bm(bm({},g),_)}},{key:"render",value:function(){var n=this,i=this.props,o=i.content,s=i.width,a=i.height,u=i.wrapperStyle,d=i.payloadUniqBy,m=i.payload,g=bm(bm({position:"absolute",width:s||"auto",height:a||"auto"},this.getDefaultPosition(u)),u);return ct.createElement("div",{className:"recharts-legend-wrapper",style:g,ref:function(y){n.wrapperNode=y}},l4e(o,bm(bm({},this.props),{},{payload:Ose(m,d,s4e)})))}}],[{key:"getWithHeight",value:function(n,i){var o=bm(bm({},this.defaultProps),n.props),s=o.layout;return s==="vertical"&&hn(n.props.height)?{height:n.props.height}:s==="horizontal"?{width:n.props.width||i}:null}}])}(oe.PureComponent);rk(w1,"displayName","Legend");rk(w1,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var v9=bS,c4e=lF,u4e=gd,b9=v9?v9.isConcatSpreadable:void 0;function d4e(e){return u4e(e)||c4e(e)||!!(b9&&e&&e[b9])}var h4e=d4e,f4e=bse,p4e=h4e;function $se(e,t,r,n,i){var o=-1,s=e.length;for(r||(r=p4e),i||(i=[]);++o<s;){var a=e[o];t>0&&r(a)?t>1?$se(a,t-1,r,n,i):f4e(i,a):n||(i[i.length]=a)}return i}var Nse=$se;function m4e(e){return function(t,r,n){for(var i=-1,o=Object(t),s=n(t),a=s.length;a--;){var u=s[e?a:++i];if(r(o[u],u,o)===!1)break}return t}}var g4e=m4e,_4e=g4e,y4e=_4e(),v4e=y4e,b4e=v4e,x4e=tk;function w4e(e,t){return e&&b4e(e,t,x4e)}var jse=w4e,M4e=xS;function S4e(e,t){return function(r,n){if(r==null)return r;if(!M4e(r))return e(r,n);for(var i=r.length,o=t?i:-1,s=Object(r);(t?o--:++o<i)&&n(s[o],o,s)!==!1;);return r}}var T4e=S4e,P4e=jse,E4e=T4e,A4e=E4e(P4e),hF=A4e,C4e=hF,k4e=xS;function I4e(e,t){var r=-1,n=k4e(e)?Array(e.length):[];return C4e(e,function(i,o,s){n[++r]=t(i,o,s)}),n}var Rse=I4e;function O4e(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var L4e=O4e,x9=Ub;function D4e(e,t){if(e!==t){var r=e!==void 0,n=e===null,i=e===e,o=x9(e),s=t!==void 0,a=t===null,u=t===t,d=x9(t);if(!a&&!d&&!o&&e>t||o&&s&&u&&!a&&!d||n&&s&&u||!r&&u||!i)return 1;if(!n&&!o&&!d&&e<t||d&&r&&i&&!n&&!o||a&&r&&i||!s&&i||!u)return-1}return 0}var $4e=D4e,N4e=$4e;function j4e(e,t,r){for(var n=-1,i=e.criteria,o=t.criteria,s=i.length,a=r.length;++n<s;){var u=N4e(i[n],o[n]);if(u){if(n>=a)return u;var d=r[n];return u*(d=="desc"?-1:1)}}return e.index-t.index}var R4e=j4e,lO=XR,F4e=YR,z4e=Qp,B4e=Rse,U4e=L4e,V4e=Mse,W4e=R4e,G4e=Xb,q4e=gd;function H4e(e,t,r){t.length?t=lO(t,function(o){return q4e(o)?function(s){return F4e(s,o.length===1?o[0]:o)}:o}):t=[G4e];var n=-1;t=lO(t,V4e(z4e));var i=B4e(e,function(o,s,a){var u=lO(t,function(d){return d(o)});return{criteria:u,index:++n,value:o}});return U4e(i,function(o,s){return W4e(o,s,r)})}var K4e=H4e;function Z4e(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var X4e=Z4e,Y4e=X4e,w9=Math.max;function Q4e(e,t,r){return t=w9(t===void 0?e.length-1:t,0),function(){for(var n=arguments,i=-1,o=w9(n.length-t,0),s=Array(o);++i<o;)s[i]=n[t+i];i=-1;for(var a=Array(t+1);++i<t;)a[i]=n[i];return a[t]=r(s),Y4e(e,this,a)}}var J4e=Q4e;function eje(e){return function(){return e}}var tje=eje,rje=$0,nje=function(){try{var e=rje(Object,"defineProperty");return e({},"",{}),e}catch{}}(),Fse=nje,ije=tje,M9=Fse,oje=Xb,aje=M9?function(e,t){return M9(e,"toString",{configurable:!0,enumerable:!1,value:ije(t),writable:!0})}:oje,sje=aje,lje=800,cje=16,uje=Date.now;function dje(e){var t=0,r=0;return function(){var n=uje(),i=cje-(n-r);if(r=n,i>0){if(++t>=lje)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var hje=dje,fje=sje,pje=hje,mje=pje(fje),gje=mje,_je=Xb,yje=J4e,vje=gje;function bje(e,t){return vje(yje(e,t,_je),e+"")}var xje=bje,wje=qR,Mje=xS,Sje=cF,Tje=j_;function Pje(e,t,r){if(!Tje(r))return!1;var n=typeof t;return(n=="number"?Mje(r)&&Sje(t,r.length):n=="string"&&t in r)?wje(r[t],e):!1}var nk=Pje,Eje=Nse,Aje=K4e,Cje=xje,S9=nk,kje=Cje(function(e,t){if(e==null)return[];var r=t.length;return r>1&&S9(e,t[0],t[1])?t=[]:r>2&&S9(t[0],t[1],t[2])&&(t=[t[0]]),Aje(e,Eje(t,1),[])}),Ije=kje;const fF=sa(Ije);function hM(e){"@babel/helpers - typeof";return hM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hM(e)}function M$(){return M$=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},M$.apply(this,arguments)}function Oje(e,t){return Nje(e)||$je(e,t)||Dje(e,t)||Lje()}function Lje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dje(e,t){if(e){if(typeof e=="string")return T9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return T9(e,t)}}function T9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $je(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],u=!0,d=!1;try{if(o=(r=r.call(e)).next,t!==0)for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);u=!0);}catch(m){d=!0,i=m}finally{try{if(!u&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw i}}return a}}function Nje(e){if(Array.isArray(e))return e}function P9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function cO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?P9(Object(r),!0).forEach(function(n){jje(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jje(e,t,r){return t=Rje(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rje(e){var t=Fje(e,"string");return hM(t)=="symbol"?t:t+""}function Fje(e,t){if(hM(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hM(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zje(e){return Array.isArray(e)&&pc(e[0])&&pc(e[1])?e.join(" ~ "):e}var Bje=function(t){var r=t.separator,n=r===void 0?" : ":r,i=t.contentStyle,o=i===void 0?{}:i,s=t.itemStyle,a=s===void 0?{}:s,u=t.labelStyle,d=u===void 0?{}:u,m=t.payload,g=t.formatter,_=t.itemSorter,y=t.wrapperClassName,M=t.labelClassName,x=t.label,E=t.labelFormatter,T=t.accessibilityLayer,P=T===void 0?!1:T,C=function(){if(m&&m.length){var X={padding:0,margin:0},ee=(_?fF(m,_):m).map(function(ae,de){if(ae.type==="none")return null;var ye=cO({display:"block",paddingTop:4,paddingBottom:4,color:ae.color||"#000"},a),_e=ae.formatter||g||zje,ue=ae.value,fe=ae.name,De=ue,pe=fe;if(_e&&De!=null&&pe!=null){var K=_e(ue,fe,ae,de,m);if(Array.isArray(K)){var te=Oje(K,2);De=te[0],pe=te[1]}else De=K}return ct.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(de),style:ye},pc(pe)?ct.createElement("span",{className:"recharts-tooltip-item-name"},pe):null,pc(pe)?ct.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,ct.createElement("span",{className:"recharts-tooltip-item-value"},De),ct.createElement("span",{className:"recharts-tooltip-item-unit"},ae.unit||""))});return ct.createElement("ul",{className:"recharts-tooltip-item-list",style:X},ee)}return null},D=cO({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},o),L=cO({margin:0},d),N=!zi(x),j=N?x:"",$=Wi("recharts-default-tooltip",y),U=Wi("recharts-tooltip-label",M);N&&E&&m!==void 0&&m!==null&&(j=E(x,m));var G=P?{role:"status","aria-live":"assertive"}:{};return ct.createElement("div",M$({className:$,style:D},G),ct.createElement("p",{className:U,style:L},ct.isValidElement(j)?j:"".concat(j)),C())};function fM(e){"@babel/helpers - typeof";return fM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fM(e)}function FP(e,t,r){return t=Uje(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Uje(e){var t=Vje(e,"string");return fM(t)=="symbol"?t:t+""}function Vje(e,t){if(fM(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fM(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Aw="recharts-tooltip-wrapper",Wje={visibility:"hidden"};function Gje(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return Wi(Aw,FP(FP(FP(FP({},"".concat(Aw,"-right"),hn(r)&&t&&hn(t.x)&&r>=t.x),"".concat(Aw,"-left"),hn(r)&&t&&hn(t.x)&&r<t.x),"".concat(Aw,"-bottom"),hn(n)&&t&&hn(t.y)&&n>=t.y),"".concat(Aw,"-top"),hn(n)&&t&&hn(t.y)&&n<t.y))}function E9(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,i=e.offsetTopLeft,o=e.position,s=e.reverseDirection,a=e.tooltipDimension,u=e.viewBox,d=e.viewBoxDimension;if(o&&hn(o[n]))return o[n];var m=r[n]-a-i,g=r[n]+i;if(t[n])return s[n]?m:g;if(s[n]){var _=m,y=u[n];return _<y?Math.max(g,u[n]):Math.max(m,u[n])}var M=g+a,x=u[n]+d;return M>x?Math.max(m,u[n]):Math.max(g,u[n])}function qje(e){var t=e.translateX,r=e.translateY,n=e.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function Hje(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.offsetTopLeft,i=e.position,o=e.reverseDirection,s=e.tooltipBox,a=e.useTranslate3d,u=e.viewBox,d,m,g;return s.height>0&&s.width>0&&r?(m=E9({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:i,reverseDirection:o,tooltipDimension:s.width,viewBox:u,viewBoxDimension:u.width}),g=E9({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:i,reverseDirection:o,tooltipDimension:s.height,viewBox:u,viewBoxDimension:u.height}),d=qje({translateX:m,translateY:g,useTranslate3d:a})):d=Wje,{cssProperties:d,cssClasses:Gje({translateX:m,translateY:g,coordinate:r})}}function rb(e){"@babel/helpers - typeof";return rb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rb(e)}function A9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function C9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?A9(Object(r),!0).forEach(function(n){T$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Kje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zje(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Bse(n.key),n)}}function Xje(e,t,r){return t&&Zje(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yje(e,t,r){return t=YA(t),Qje(e,zse()?Reflect.construct(t,r||[],YA(e).constructor):t.apply(e,r))}function Qje(e,t){if(t&&(rb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Jje(e)}function Jje(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zse(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(zse=function(){return!!e})()}function YA(e){return YA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},YA(e)}function eRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S$(e,t)}function S$(e,t){return S$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},S$(e,t)}function T$(e,t,r){return t=Bse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bse(e){var t=tRe(e,"string");return rb(t)=="symbol"?t:t+""}function tRe(e,t){if(rb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var k9=1,rRe=function(e){function t(){var r;Kje(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return r=Yje(this,t,[].concat(i)),T$(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),T$(r,"handleKeyDown",function(s){if(s.key==="Escape"){var a,u,d,m;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(a=(u=r.props.coordinate)===null||u===void 0?void 0:u.x)!==null&&a!==void 0?a:0,y:(d=(m=r.props.coordinate)===null||m===void 0?void 0:m.y)!==null&&d!==void 0?d:0}})}}),r}return eRe(t,e),Xje(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>k9||Math.abs(n.height-this.state.lastBoundingBox.height)>k9)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,i;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,i=this.props,o=i.active,s=i.allowEscapeViewBox,a=i.animationDuration,u=i.animationEasing,d=i.children,m=i.coordinate,g=i.hasPayload,_=i.isAnimationActive,y=i.offset,M=i.position,x=i.reverseDirection,E=i.useTranslate3d,T=i.viewBox,P=i.wrapperStyle,C=Hje({allowEscapeViewBox:s,coordinate:m,offsetTopLeft:y,position:M,reverseDirection:x,tooltipBox:this.state.lastBoundingBox,useTranslate3d:E,viewBox:T}),D=C.cssClasses,L=C.cssProperties,N=C9(C9({transition:_&&o?"transform ".concat(a,"ms ").concat(u):void 0},L),{},{pointerEvents:"none",visibility:!this.state.dismissed&&o&&g?"visible":"hidden",position:"absolute",top:0,left:0},P);return ct.createElement("div",{tabIndex:-1,className:D,style:N,ref:function($){n.wrapperNode=$}},d)}}])}(oe.PureComponent),nRe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},zf={isSsr:nRe(),get:function(t){return zf[t]},set:function(t,r){if(typeof t=="string")zf[t]=r;else{var n=Object.keys(t);n&&n.length&&n.forEach(function(i){zf[i]=t[i]})}}};function nb(e){"@babel/helpers - typeof";return nb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nb(e)}function I9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function O9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?I9(Object(r),!0).forEach(function(n){pF(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oRe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vse(n.key),n)}}function aRe(e,t,r){return t&&oRe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function sRe(e,t,r){return t=QA(t),lRe(e,Use()?Reflect.construct(t,r||[],QA(e).constructor):t.apply(e,r))}function lRe(e,t){if(t&&(nb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cRe(e)}function cRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Use(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Use=function(){return!!e})()}function QA(e){return QA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},QA(e)}function uRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P$(e,t)}function P$(e,t){return P$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},P$(e,t)}function pF(e,t,r){return t=Vse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vse(e){var t=dRe(e,"string");return nb(t)=="symbol"?t:t+""}function dRe(e,t){if(nb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hRe(e){return e.dataKey}function fRe(e,t){return ct.isValidElement(e)?ct.cloneElement(e,t):typeof e=="function"?ct.createElement(e,t):ct.createElement(Bje,t)}var Fu=function(e){function t(){return iRe(this,t),sRe(this,t,arguments)}return uRe(t,e),aRe(t,[{key:"render",value:function(){var n=this,i=this.props,o=i.active,s=i.allowEscapeViewBox,a=i.animationDuration,u=i.animationEasing,d=i.content,m=i.coordinate,g=i.filterNull,_=i.isAnimationActive,y=i.offset,M=i.payload,x=i.payloadUniqBy,E=i.position,T=i.reverseDirection,P=i.useTranslate3d,C=i.viewBox,D=i.wrapperStyle,L=M??[];g&&L.length&&(L=Ose(M.filter(function(j){return j.value!=null&&(j.hide!==!0||n.props.includeHidden)}),x,hRe));var N=L.length>0;return ct.createElement(rRe,{allowEscapeViewBox:s,animationDuration:a,animationEasing:u,isAnimationActive:_,active:o,coordinate:m,hasPayload:N,offset:y,position:E,reverseDirection:T,useTranslate3d:P,viewBox:C,wrapperStyle:D},fRe(d,O9(O9({},this.props),{},{payload:L})))}}])}(oe.PureComponent);pF(Fu,"displayName","Tooltip");pF(Fu,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!zf.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var pRe=Yp,mRe=function(){return pRe.Date.now()},gRe=mRe,_Re=/\s/;function yRe(e){for(var t=e.length;t--&&_Re.test(e.charAt(t)););return t}var vRe=yRe,bRe=vRe,xRe=/^\s+/;function wRe(e){return e&&e.slice(0,bRe(e)+1).replace(xRe,"")}var MRe=wRe,SRe=MRe,L9=j_,TRe=Ub,D9=NaN,PRe=/^[-+]0x[0-9a-f]+$/i,ERe=/^0b[01]+$/i,ARe=/^0o[0-7]+$/i,CRe=parseInt;function kRe(e){if(typeof e=="number")return e;if(TRe(e))return D9;if(L9(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=L9(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=SRe(e);var r=ERe.test(e);return r||ARe.test(e)?CRe(e.slice(2),r?2:8):PRe.test(e)?D9:+e}var Wse=kRe,IRe=j_,uO=gRe,$9=Wse,ORe="Expected a function",LRe=Math.max,DRe=Math.min;function $Re(e,t,r){var n,i,o,s,a,u,d=0,m=!1,g=!1,_=!0;if(typeof e!="function")throw new TypeError(ORe);t=$9(t)||0,IRe(r)&&(m=!!r.leading,g="maxWait"in r,o=g?LRe($9(r.maxWait)||0,t):o,_="trailing"in r?!!r.trailing:_);function y(N){var j=n,$=i;return n=i=void 0,d=N,s=e.apply($,j),s}function M(N){return d=N,a=setTimeout(T,t),m?y(N):s}function x(N){var j=N-u,$=N-d,U=t-j;return g?DRe(U,o-$):U}function E(N){var j=N-u,$=N-d;return u===void 0||j>=t||j<0||g&&$>=o}function T(){var N=uO();if(E(N))return P(N);a=setTimeout(T,x(N))}function P(N){return a=void 0,_&&n?y(N):(n=i=void 0,s)}function C(){a!==void 0&&clearTimeout(a),d=0,n=u=i=a=void 0}function D(){return a===void 0?s:P(uO())}function L(){var N=uO(),j=E(N);if(n=arguments,i=this,u=N,j){if(a===void 0)return M(u);if(g)return clearTimeout(a),a=setTimeout(T,t),y(u)}return a===void 0&&(a=setTimeout(T,t)),s}return L.cancel=C,L.flush=D,L}var NRe=$Re,jRe=NRe,RRe=j_,FRe="Expected a function";function zRe(e,t,r){var n=!0,i=!0;if(typeof e!="function")throw new TypeError(FRe);return RRe(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),jRe(e,t,{leading:n,maxWait:t,trailing:i})}var BRe=zRe;const Gse=sa(BRe);function pM(e){"@babel/helpers - typeof";return pM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pM(e)}function N9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function zP(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?N9(Object(r),!0).forEach(function(n){URe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function URe(e,t,r){return t=VRe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VRe(e){var t=WRe(e,"string");return pM(t)=="symbol"?t:t+""}function WRe(e,t){if(pM(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pM(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function GRe(e,t){return ZRe(e)||KRe(e,t)||HRe(e,t)||qRe()}function qRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HRe(e,t){if(e){if(typeof e=="string")return j9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return j9(e,t)}}function j9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function KRe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],u=!0,d=!1;try{if(o=(r=r.call(e)).next,t!==0)for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);u=!0);}catch(m){d=!0,i=m}finally{try{if(!u&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw i}}return a}}function ZRe(e){if(Array.isArray(e))return e}var M1=oe.forwardRef(function(e,t){var r=e.aspect,n=e.initialDimension,i=n===void 0?{width:-1,height:-1}:n,o=e.width,s=o===void 0?"100%":o,a=e.height,u=a===void 0?"100%":a,d=e.minWidth,m=d===void 0?0:d,g=e.minHeight,_=e.maxHeight,y=e.children,M=e.debounce,x=M===void 0?0:M,E=e.id,T=e.className,P=e.onResize,C=e.style,D=C===void 0?{}:C,L=oe.useRef(null),N=oe.useRef();N.current=P,oe.useImperativeHandle(t,function(){return Object.defineProperty(L.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),L.current},configurable:!0})});var j=oe.useState({containerWidth:i.width,containerHeight:i.height}),$=GRe(j,2),U=$[0],G=$[1],H=oe.useCallback(function(ee,ae){G(function(de){var ye=Math.round(ee),_e=Math.round(ae);return de.containerWidth===ye&&de.containerHeight===_e?de:{containerWidth:ye,containerHeight:_e}})},[]);oe.useEffect(function(){var ee=function(fe){var De,pe=fe[0].contentRect,K=pe.width,te=pe.height;H(K,te),(De=N.current)===null||De===void 0||De.call(N,K,te)};x>0&&(ee=Gse(ee,x,{trailing:!0,leading:!1}));var ae=new ResizeObserver(ee),de=L.current.getBoundingClientRect(),ye=de.width,_e=de.height;return H(ye,_e),ae.observe(L.current),function(){ae.disconnect()}},[H,x]);var X=oe.useMemo(function(){var ee=U.containerWidth,ae=U.containerHeight;if(ee<0||ae<0)return null;Ff(Ly(s)||Ly(u),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,s,u),Ff(!r||r>0,"The aspect(%s) must be greater than zero.",r);var de=Ly(s)?ee:s,ye=Ly(u)?ae:u;r&&r>0&&(de?ye=de/r:ye&&(de=ye*r),_&&ye>_&&(ye=_)),Ff(de>0||ye>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,de,ye,s,u,m,g,r);var _e=!Array.isArray(y)&&Rm(y.type).endsWith("Chart");return ct.Children.map(y,function(ue){return ct.isValidElement(ue)?oe.cloneElement(ue,zP({width:de,height:ye},_e?{style:zP({height:"100%",width:"100%",maxHeight:ye,maxWidth:de},ue.props.style)}:{})):ue})},[r,y,u,_,g,m,U,s]);return ct.createElement("div",{id:E?"".concat(E):void 0,className:Wi("recharts-responsive-container",T),style:zP(zP({},D),{},{width:s,height:u,minWidth:m,minHeight:g,maxHeight:_}),ref:L},X)}),wS=function(t){return null};wS.displayName="Cell";function mM(e){"@babel/helpers - typeof";return mM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mM(e)}function R9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function E$(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?R9(Object(r),!0).forEach(function(n){XRe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XRe(e,t,r){return t=YRe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YRe(e){var t=QRe(e,"string");return mM(t)=="symbol"?t:t+""}function QRe(e,t){if(mM(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mM(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ev={widthCache:{},cacheCount:0},JRe=2e3,eFe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},F9="recharts_measurement_span";function tFe(e){var t=E$({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var _2=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||zf.isSsr)return{width:0,height:0};var n=tFe(r),i=JSON.stringify({text:t,copyStyle:n});if(Ev.widthCache[i])return Ev.widthCache[i];try{var o=document.getElementById(F9);o||(o=document.createElement("span"),o.setAttribute("id",F9),o.setAttribute("aria-hidden","true"),document.body.appendChild(o));var s=E$(E$({},eFe),n);Object.assign(o.style,s),o.textContent="".concat(t);var a=o.getBoundingClientRect(),u={width:a.width,height:a.height};return Ev.widthCache[i]=u,++Ev.cacheCount>JRe&&(Ev.cacheCount=0,Ev.widthCache={}),u}catch{return{width:0,height:0}}},rFe=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function gM(e){"@babel/helpers - typeof";return gM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gM(e)}function JA(e,t){return aFe(e)||oFe(e,t)||iFe(e,t)||nFe()}function nFe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iFe(e,t){if(e){if(typeof e=="string")return z9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return z9(e,t)}}function z9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oFe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],u=!0,d=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);u=!0);}catch(m){d=!0,i=m}finally{try{if(!u&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw i}}return a}}function aFe(e){if(Array.isArray(e))return e}function sFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cFe(n.key),n)}}function lFe(e,t,r){return t&&B9(e.prototype,t),r&&B9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cFe(e){var t=uFe(e,"string");return gM(t)=="symbol"?t:t+""}function uFe(e,t){if(gM(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(gM(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var U9=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,V9=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,dFe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,hFe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,qse={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},fFe=Object.keys(qse),o1="NaN";function pFe(e,t){return e*qse[t]}var BP=function(){function e(t,r){sFe(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!dFe.test(r)&&(this.num=NaN,this.unit=""),fFe.includes(r)&&(this.num=pFe(t,r),this.unit="px")}return lFe(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,i=(n=hFe.exec(r))!==null&&n!==void 0?n:[],o=JA(i,3),s=o[1],a=o[2];return new e(parseFloat(s),a??"")}}])}();function Hse(e){if(e.includes(o1))return o1;for(var t=e;t.includes("*")||t.includes("/");){var r,n=(r=U9.exec(t))!==null&&r!==void 0?r:[],i=JA(n,4),o=i[1],s=i[2],a=i[3],u=BP.parse(o??""),d=BP.parse(a??""),m=s==="*"?u.multiply(d):u.divide(d);if(m.isNaN())return o1;t=t.replace(U9,m.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var g,_=(g=V9.exec(t))!==null&&g!==void 0?g:[],y=JA(_,4),M=y[1],x=y[2],E=y[3],T=BP.parse(M??""),P=BP.parse(E??""),C=x==="+"?T.add(P):T.subtract(P);if(C.isNaN())return o1;t=t.replace(V9,C.toString())}return t}var W9=/\(([^()]*)\)/;function mFe(e){for(var t=e;t.includes("(");){var r=W9.exec(t),n=JA(r,2),i=n[1];t=t.replace(W9,Hse(i))}return t}function gFe(e){var t=e.replace(/\s+/g,"");return t=mFe(t),t=Hse(t),t}function _Fe(e){try{return gFe(e)}catch{return o1}}function dO(e){var t=_Fe(e.slice(5,-1));return t===o1?"":t}var yFe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],vFe=["dx","dy","angle","className","breakAll"];function A$(){return A$=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},A$.apply(this,arguments)}function G9(e,t){if(e==null)return{};var r=bFe(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function bFe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function q9(e,t){return SFe(e)||MFe(e,t)||wFe(e,t)||xFe()}function xFe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wFe(e,t){if(e){if(typeof e=="string")return H9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return H9(e,t)}}function H9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function MFe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],u=!0,d=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);u=!0);}catch(m){d=!0,i=m}finally{try{if(!u&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw i}}return a}}function SFe(e){if(Array.isArray(e))return e}var Kse=/[ \f\n\r\t\v\u2028\u2029]+/,Zse=function(t){var r=t.children,n=t.breakAll,i=t.style;try{var o=[];zi(r)||(n?o=r.toString().split(""):o=r.toString().split(Kse));var s=o.map(function(u){return{word:u,width:_2(u,i).width}}),a=n?0:_2(" ",i).width;return{wordsWithComputedWidth:s,spaceWidth:a}}catch{return null}},TFe=function(t,r,n,i,o){var s=t.maxLines,a=t.children,u=t.style,d=t.breakAll,m=hn(s),g=a,_=function(){var de=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return de.reduce(function(ye,_e){var ue=_e.word,fe=_e.width,De=ye[ye.length-1];if(De&&(i==null||o||De.width+fe+n<Number(i)))De.words.push(ue),De.width+=fe+n;else{var pe={words:[ue],width:fe};ye.push(pe)}return ye},[])},y=_(r),M=function(de){return de.reduce(function(ye,_e){return ye.width>_e.width?ye:_e})};if(!m)return y;for(var x="…",E=function(de){var ye=g.slice(0,de),_e=Zse({breakAll:d,style:u,children:ye+x}).wordsWithComputedWidth,ue=_(_e),fe=ue.length>s||M(ue).width>Number(i);return[fe,ue]},T=0,P=g.length-1,C=0,D;T<=P&&C<=g.length-1;){var L=Math.floor((T+P)/2),N=L-1,j=E(N),$=q9(j,2),U=$[0],G=$[1],H=E(L),X=q9(H,1),ee=X[0];if(!U&&!ee&&(T=L+1),U&&ee&&(P=L-1),!U&&ee){D=G;break}C++}return D||y},K9=function(t){var r=zi(t)?[]:t.toString().split(Kse);return[{words:r}]},PFe=function(t){var r=t.width,n=t.scaleToFit,i=t.children,o=t.style,s=t.breakAll,a=t.maxLines;if((r||n)&&!zf.isSsr){var u,d,m=Zse({breakAll:s,children:i,style:o});if(m){var g=m.wordsWithComputedWidth,_=m.spaceWidth;u=g,d=_}else return K9(i);return TFe({breakAll:s,children:i,maxLines:a,style:o},u,d,r,n)}return K9(i)},Z9="#808080",g0=function(t){var r=t.x,n=r===void 0?0:r,i=t.y,o=i===void 0?0:i,s=t.lineHeight,a=s===void 0?"1em":s,u=t.capHeight,d=u===void 0?"0.71em":u,m=t.scaleToFit,g=m===void 0?!1:m,_=t.textAnchor,y=_===void 0?"start":_,M=t.verticalAnchor,x=M===void 0?"end":M,E=t.fill,T=E===void 0?Z9:E,P=G9(t,yFe),C=oe.useMemo(function(){return PFe({breakAll:P.breakAll,children:P.children,maxLines:P.maxLines,scaleToFit:g,style:P.style,width:P.width})},[P.breakAll,P.children,P.maxLines,g,P.style,P.width]),D=P.dx,L=P.dy,N=P.angle,j=P.className,$=P.breakAll,U=G9(P,vFe);if(!pc(n)||!pc(o))return null;var G=n+(hn(D)?D:0),H=o+(hn(L)?L:0),X;switch(x){case"start":X=dO("calc(".concat(d,")"));break;case"middle":X=dO("calc(".concat((C.length-1)/2," * -").concat(a," + (").concat(d," / 2))"));break;default:X=dO("calc(".concat(C.length-1," * -").concat(a,")"));break}var ee=[];if(g){var ae=C[0].width,de=P.width;ee.push("scale(".concat((hn(de)?de/ae:1)/ae,")"))}return N&&ee.push("rotate(".concat(N,", ").concat(G,", ").concat(H,")")),ee.length&&(U.transform=ee.join(" ")),ct.createElement("text",A$({},ii(U,!0),{x:G,y:H,className:Wi("recharts-text",j),textAnchor:y,fill:T.includes("url")?Z9:T}),C.map(function(ye,_e){var ue=ye.words.join($?"":" ");return ct.createElement("tspan",{x:G,dy:_e===0?X:a,key:"".concat(ue,"-").concat(_e)},ue)}))};function m_(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function EFe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function mF(e){let t,r,n;e.length!==2?(t=m_,r=(a,u)=>m_(e(a),u),n=(a,u)=>e(a)-u):(t=e===m_||e===EFe?e:AFe,r=e,n=e);function i(a,u,d=0,m=a.length){if(d<m){if(t(u,u)!==0)return m;do{const g=d+m>>>1;r(a[g],u)<0?d=g+1:m=g}while(d<m)}return d}function o(a,u,d=0,m=a.length){if(d<m){if(t(u,u)!==0)return m;do{const g=d+m>>>1;r(a[g],u)<=0?d=g+1:m=g}while(d<m)}return d}function s(a,u,d=0,m=a.length){const g=i(a,u,d,m-1);return g>d&&n(a[g-1],u)>-n(a[g],u)?g-1:g}return{left:i,center:s,right:o}}function AFe(){return 0}function Xse(e){return e===null?NaN:+e}function*CFe(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const kFe=mF(m_),MS=kFe.right;mF(Xse).center;class X9 extends Map{constructor(t,r=LFe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,i]of t)this.set(n,i)}get(t){return super.get(Y9(this,t))}has(t){return super.has(Y9(this,t))}set(t,r){return super.set(IFe(this,t),r)}delete(t){return super.delete(OFe(this,t))}}function Y9({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function IFe({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function OFe({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function LFe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function DFe(e=m_){if(e===m_)return Yse;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function Yse(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const $Fe=Math.sqrt(50),NFe=Math.sqrt(10),jFe=Math.sqrt(2);function eC(e,t,r){const n=(t-e)/Math.max(0,r),i=Math.floor(Math.log10(n)),o=n/Math.pow(10,i),s=o>=$Fe?10:o>=NFe?5:o>=jFe?2:1;let a,u,d;return i<0?(d=Math.pow(10,-i)/s,a=Math.round(e*d),u=Math.round(t*d),a/d<e&&++a,u/d>t&&--u,d=-d):(d=Math.pow(10,i)*s,a=Math.round(e/d),u=Math.round(t/d),a*d<e&&++a,u*d>t&&--u),u<a&&.5<=r&&r<2?eC(e,t,r*2):[a,u,d]}function C$(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[i,o,s]=n?eC(t,e,r):eC(e,t,r);if(!(o>=i))return[];const a=o-i+1,u=new Array(a);if(n)if(s<0)for(let d=0;d<a;++d)u[d]=(o-d)/-s;else for(let d=0;d<a;++d)u[d]=(o-d)*s;else if(s<0)for(let d=0;d<a;++d)u[d]=(i+d)/-s;else for(let d=0;d<a;++d)u[d]=(i+d)*s;return u}function k$(e,t,r){return t=+t,e=+e,r=+r,eC(e,t,r)[2]}function I$(e,t,r){t=+t,e=+e,r=+r;const n=t<e,i=n?k$(t,e,r):k$(e,t,r);return(n?-1:1)*(i<0?1/-i:i)}function Q9(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function J9(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function Qse(e,t,r=0,n=1/0,i){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(i=i===void 0?Yse:DFe(i);n>r;){if(n-r>600){const u=n-r+1,d=t-r+1,m=Math.log(u),g=.5*Math.exp(2*m/3),_=.5*Math.sqrt(m*g*(u-g)/u)*(d-u/2<0?-1:1),y=Math.max(r,Math.floor(t-d*g/u+_)),M=Math.min(n,Math.floor(t+(u-d)*g/u+_));Qse(e,t,y,M,i)}const o=e[t];let s=r,a=n;for(Cw(e,r,t),i(e[n],o)>0&&Cw(e,r,n);s<a;){for(Cw(e,s,a),++s,--a;i(e[s],o)<0;)++s;for(;i(e[a],o)>0;)--a}i(e[r],o)===0?Cw(e,r,a):(++a,Cw(e,a,n)),a<=t&&(r=a+1),t<=a&&(n=a-1)}return e}function Cw(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function RFe(e,t,r){if(e=Float64Array.from(CFe(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return J9(e);if(t>=1)return Q9(e);var n,i=(n-1)*t,o=Math.floor(i),s=Q9(Qse(e,o).subarray(0,o+1)),a=J9(e.subarray(o+1));return s+(a-s)*(i-o)}}function FFe(e,t,r=Xse){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,i=(n-1)*t,o=Math.floor(i),s=+r(e[o],o,e),a=+r(e[o+1],o+1,e);return s+(a-s)*(i-o)}}function zFe(e,t,r){e=+e,t=+t,r=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+r;for(var n=-1,i=Math.max(0,Math.ceil((t-e)/r))|0,o=new Array(i);++n<i;)o[n]=e+n*r;return o}function Vh(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function ng(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const O$=Symbol("implicit");function gF(){var e=new X9,t=[],r=[],n=O$;function i(o){let s=e.get(o);if(s===void 0){if(n!==O$)return n;e.set(o,s=t.push(o)-1)}return r[s%r.length]}return i.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new X9;for(const s of o)e.has(s)||e.set(s,t.push(s)-1);return i},i.range=function(o){return arguments.length?(r=Array.from(o),i):r.slice()},i.unknown=function(o){return arguments.length?(n=o,i):n},i.copy=function(){return gF(t,r).unknown(n)},Vh.apply(i,arguments),i}function _M(){var e=gF().unknown(void 0),t=e.domain,r=e.range,n=0,i=1,o,s,a=!1,u=0,d=0,m=.5;delete e.unknown;function g(){var _=t().length,y=i<n,M=y?i:n,x=y?n:i;o=(x-M)/Math.max(1,_-u+d*2),a&&(o=Math.floor(o)),M+=(x-M-o*(_-u))*m,s=o*(1-u),a&&(M=Math.round(M),s=Math.round(s));var E=zFe(_).map(function(T){return M+o*T});return r(y?E.reverse():E)}return e.domain=function(_){return arguments.length?(t(_),g()):t()},e.range=function(_){return arguments.length?([n,i]=_,n=+n,i=+i,g()):[n,i]},e.rangeRound=function(_){return[n,i]=_,n=+n,i=+i,a=!0,g()},e.bandwidth=function(){return s},e.step=function(){return o},e.round=function(_){return arguments.length?(a=!!_,g()):a},e.padding=function(_){return arguments.length?(u=Math.min(1,d=+_),g()):u},e.paddingInner=function(_){return arguments.length?(u=Math.min(1,_),g()):u},e.paddingOuter=function(_){return arguments.length?(d=+_,g()):d},e.align=function(_){return arguments.length?(m=Math.max(0,Math.min(1,_)),g()):m},e.copy=function(){return _M(t(),[n,i]).round(a).paddingInner(u).paddingOuter(d).align(m)},Vh.apply(g(),arguments)}function Jse(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return Jse(t())},e}function y2(){return Jse(_M.apply(null,arguments).paddingInner(1))}function _F(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function ele(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function SS(){}var yM=.7,tC=1/yM,S1="\\s*([+-]?\\d+)\\s*",vM="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Bp="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",BFe=/^#([0-9a-f]{3,8})$/,UFe=new RegExp(`^rgb\\(${S1},${S1},${S1}\\)$`),VFe=new RegExp(`^rgb\\(${Bp},${Bp},${Bp}\\)$`),WFe=new RegExp(`^rgba\\(${S1},${S1},${S1},${vM}\\)$`),GFe=new RegExp(`^rgba\\(${Bp},${Bp},${Bp},${vM}\\)$`),qFe=new RegExp(`^hsl\\(${vM},${Bp},${Bp}\\)$`),HFe=new RegExp(`^hsla\\(${vM},${Bp},${Bp},${vM}\\)$`),eG={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};_F(SS,bM,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:tG,formatHex:tG,formatHex8:KFe,formatHsl:ZFe,formatRgb:rG,toString:rG});function tG(){return this.rgb().formatHex()}function KFe(){return this.rgb().formatHex8()}function ZFe(){return tle(this).formatHsl()}function rG(){return this.rgb().formatRgb()}function bM(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=BFe.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?nG(t):r===3?new dd(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?UP(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?UP(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=UFe.exec(e))?new dd(t[1],t[2],t[3],1):(t=VFe.exec(e))?new dd(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=WFe.exec(e))?UP(t[1],t[2],t[3],t[4]):(t=GFe.exec(e))?UP(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=qFe.exec(e))?aG(t[1],t[2]/100,t[3]/100,1):(t=HFe.exec(e))?aG(t[1],t[2]/100,t[3]/100,t[4]):eG.hasOwnProperty(e)?nG(eG[e]):e==="transparent"?new dd(NaN,NaN,NaN,0):null}function nG(e){return new dd(e>>16&255,e>>8&255,e&255,1)}function UP(e,t,r,n){return n<=0&&(e=t=r=NaN),new dd(e,t,r,n)}function XFe(e){return e instanceof SS||(e=bM(e)),e?(e=e.rgb(),new dd(e.r,e.g,e.b,e.opacity)):new dd}function L$(e,t,r,n){return arguments.length===1?XFe(e):new dd(e,t,r,n??1)}function dd(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}_F(dd,L$,ele(SS,{brighter(e){return e=e==null?tC:Math.pow(tC,e),new dd(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?yM:Math.pow(yM,e),new dd(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new dd(Yy(this.r),Yy(this.g),Yy(this.b),rC(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:iG,formatHex:iG,formatHex8:YFe,formatRgb:oG,toString:oG}));function iG(){return`#${Dy(this.r)}${Dy(this.g)}${Dy(this.b)}`}function YFe(){return`#${Dy(this.r)}${Dy(this.g)}${Dy(this.b)}${Dy((isNaN(this.opacity)?1:this.opacity)*255)}`}function oG(){const e=rC(this.opacity);return`${e===1?"rgb(":"rgba("}${Yy(this.r)}, ${Yy(this.g)}, ${Yy(this.b)}${e===1?")":`, ${e})`}`}function rC(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Yy(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Dy(e){return e=Yy(e),(e<16?"0":"")+e.toString(16)}function aG(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Df(e,t,r,n)}function tle(e){if(e instanceof Df)return new Df(e.h,e.s,e.l,e.opacity);if(e instanceof SS||(e=bM(e)),!e)return new Df;if(e instanceof Df)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),o=Math.max(t,r,n),s=NaN,a=o-i,u=(o+i)/2;return a?(t===o?s=(r-n)/a+(r<n)*6:r===o?s=(n-t)/a+2:s=(t-r)/a+4,a/=u<.5?o+i:2-o-i,s*=60):a=u>0&&u<1?0:s,new Df(s,a,u,e.opacity)}function QFe(e,t,r,n){return arguments.length===1?tle(e):new Df(e,t,r,n??1)}function Df(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}_F(Df,QFe,ele(SS,{brighter(e){return e=e==null?tC:Math.pow(tC,e),new Df(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?yM:Math.pow(yM,e),new Df(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new dd(hO(e>=240?e-240:e+120,i,n),hO(e,i,n),hO(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new Df(sG(this.h),VP(this.s),VP(this.l),rC(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=rC(this.opacity);return`${e===1?"hsl(":"hsla("}${sG(this.h)}, ${VP(this.s)*100}%, ${VP(this.l)*100}%${e===1?")":`, ${e})`}`}}));function sG(e){return e=(e||0)%360,e<0?e+360:e}function VP(e){return Math.max(0,Math.min(1,e||0))}function hO(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const yF=e=>()=>e;function JFe(e,t){return function(r){return e+r*t}}function eze(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function tze(e){return(e=+e)==1?rle:function(t,r){return r-t?eze(t,r,e):yF(isNaN(t)?r:t)}}function rle(e,t){var r=t-e;return r?JFe(e,r):yF(isNaN(e)?t:e)}const lG=function e(t){var r=tze(t);function n(i,o){var s=r((i=L$(i)).r,(o=L$(o)).r),a=r(i.g,o.g),u=r(i.b,o.b),d=rle(i.opacity,o.opacity);return function(m){return i.r=s(m),i.g=a(m),i.b=u(m),i.opacity=d(m),i+""}}return n.gamma=e,n}(1);function rze(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),i;return function(o){for(i=0;i<r;++i)n[i]=e[i]*(1-o)+t[i]*o;return n}}function nze(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function ize(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,i=new Array(n),o=new Array(r),s;for(s=0;s<n;++s)i[s]=Yb(e[s],t[s]);for(;s<r;++s)o[s]=t[s];return function(a){for(s=0;s<n;++s)o[s]=i[s](a);return o}}function oze(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function nC(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function aze(e,t){var r={},n={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?r[i]=Yb(e[i],t[i]):n[i]=t[i];return function(o){for(i in r)n[i]=r[i](o);return n}}var D$=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,fO=new RegExp(D$.source,"g");function sze(e){return function(){return e}}function lze(e){return function(t){return e(t)+""}}function cze(e,t){var r=D$.lastIndex=fO.lastIndex=0,n,i,o,s=-1,a=[],u=[];for(e=e+"",t=t+"";(n=D$.exec(e))&&(i=fO.exec(t));)(o=i.index)>r&&(o=t.slice(r,o),a[s]?a[s]+=o:a[++s]=o),(n=n[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,u.push({i:s,x:nC(n,i)})),r=fO.lastIndex;return r<t.length&&(o=t.slice(r),a[s]?a[s]+=o:a[++s]=o),a.length<2?u[0]?lze(u[0].x):sze(t):(t=u.length,function(d){for(var m=0,g;m<t;++m)a[(g=u[m]).i]=g.x(d);return a.join("")})}function Yb(e,t){var r=typeof t,n;return t==null||r==="boolean"?yF(t):(r==="number"?nC:r==="string"?(n=bM(t))?(t=n,lG):cze:t instanceof bM?lG:t instanceof Date?oze:nze(t)?rze:Array.isArray(t)?ize:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?aze:nC)(e,t)}function vF(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function uze(e,t){t===void 0&&(t=e,e=Yb);for(var r=0,n=t.length-1,i=t[0],o=new Array(n<0?0:n);r<n;)o[r]=e(i,i=t[++r]);return function(s){var a=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return o[a](s-a)}}function dze(e){return function(){return e}}function iC(e){return+e}var cG=[0,1];function Wu(e){return e}function $$(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:dze(isNaN(t)?NaN:.5)}function hze(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function fze(e,t,r){var n=e[0],i=e[1],o=t[0],s=t[1];return i<n?(n=$$(i,n),o=r(s,o)):(n=$$(n,i),o=r(o,s)),function(a){return o(n(a))}}function pze(e,t,r){var n=Math.min(e.length,t.length)-1,i=new Array(n),o=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)i[s]=$$(e[s],e[s+1]),o[s]=r(t[s],t[s+1]);return function(a){var u=MS(e,a,1,n)-1;return o[u](i[u](a))}}function TS(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function ik(){var e=cG,t=cG,r=Yb,n,i,o,s=Wu,a,u,d;function m(){var _=Math.min(e.length,t.length);return s!==Wu&&(s=hze(e[0],e[_-1])),a=_>2?pze:fze,u=d=null,g}function g(_){return _==null||isNaN(_=+_)?o:(u||(u=a(e.map(n),t,r)))(n(s(_)))}return g.invert=function(_){return s(i((d||(d=a(t,e.map(n),nC)))(_)))},g.domain=function(_){return arguments.length?(e=Array.from(_,iC),m()):e.slice()},g.range=function(_){return arguments.length?(t=Array.from(_),m()):t.slice()},g.rangeRound=function(_){return t=Array.from(_),r=vF,m()},g.clamp=function(_){return arguments.length?(s=_?!0:Wu,m()):s!==Wu},g.interpolate=function(_){return arguments.length?(r=_,m()):r},g.unknown=function(_){return arguments.length?(o=_,g):o},function(_,y){return n=_,i=y,m()}}function bF(){return ik()(Wu,Wu)}function mze(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function oC(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function ib(e){return e=oC(Math.abs(e)),e?e[1]:NaN}function gze(e,t){return function(r,n){for(var i=r.length,o=[],s=0,a=e[0],u=0;i>0&&a>0&&(u+a+1>n&&(a=Math.max(1,n-u)),o.push(r.substring(i-=a,i+a)),!((u+=a+1)>n));)a=e[s=(s+1)%e.length];return o.reverse().join(t)}}function _ze(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var yze=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function xM(e){if(!(t=yze.exec(e)))throw new Error("invalid format: "+e);var t;return new xF({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}xM.prototype=xF.prototype;function xF(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}xF.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function vze(e){e:for(var t=e.length,r=1,n=-1,i;r<t;++r)switch(e[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(i+1):e}var nle;function bze(e,t){var r=oC(e,t);if(!r)return e+"";var n=r[0],i=r[1],o=i-(nle=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,s=n.length;return o===s?n:o>s?n+new Array(o-s+1).join("0"):o>0?n.slice(0,o)+"."+n.slice(o):"0."+new Array(1-o).join("0")+oC(e,Math.max(0,t+o-1))[0]}function uG(e,t){var r=oC(e,t);if(!r)return e+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const dG={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:mze,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>uG(e*100,t),r:uG,s:bze,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function hG(e){return e}var fG=Array.prototype.map,pG=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function xze(e){var t=e.grouping===void 0||e.thousands===void 0?hG:gze(fG.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?hG:_ze(fG.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"−":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function d(g){g=xM(g);var _=g.fill,y=g.align,M=g.sign,x=g.symbol,E=g.zero,T=g.width,P=g.comma,C=g.precision,D=g.trim,L=g.type;L==="n"?(P=!0,L="g"):dG[L]||(C===void 0&&(C=12),D=!0,L="g"),(E||_==="0"&&y==="=")&&(E=!0,_="0",y="=");var N=x==="$"?r:x==="#"&&/[boxX]/.test(L)?"0"+L.toLowerCase():"",j=x==="$"?n:/[%p]/.test(L)?s:"",$=dG[L],U=/[defgprs%]/.test(L);C=C===void 0?6:/[gprs]/.test(L)?Math.max(1,Math.min(21,C)):Math.max(0,Math.min(20,C));function G(H){var X=N,ee=j,ae,de,ye;if(L==="c")ee=$(H)+ee,H="";else{H=+H;var _e=H<0||1/H<0;if(H=isNaN(H)?u:$(Math.abs(H),C),D&&(H=vze(H)),_e&&+H==0&&M!=="+"&&(_e=!1),X=(_e?M==="("?M:a:M==="-"||M==="("?"":M)+X,ee=(L==="s"?pG[8+nle/3]:"")+ee+(_e&&M==="("?")":""),U){for(ae=-1,de=H.length;++ae<de;)if(ye=H.charCodeAt(ae),48>ye||ye>57){ee=(ye===46?i+H.slice(ae+1):H.slice(ae))+ee,H=H.slice(0,ae);break}}}P&&!E&&(H=t(H,1/0));var ue=X.length+H.length+ee.length,fe=ue<T?new Array(T-ue+1).join(_):"";switch(P&&E&&(H=t(fe+H,fe.length?T-ee.length:1/0),fe=""),y){case"<":H=X+H+ee+fe;break;case"=":H=X+fe+H+ee;break;case"^":H=fe.slice(0,ue=fe.length>>1)+X+H+ee+fe.slice(ue);break;default:H=fe+X+H+ee;break}return o(H)}return G.toString=function(){return g+""},G}function m(g,_){var y=d((g=xM(g),g.type="f",g)),M=Math.max(-8,Math.min(8,Math.floor(ib(_)/3)))*3,x=Math.pow(10,-M),E=pG[8+M/3];return function(T){return y(x*T)+E}}return{format:d,formatPrefix:m}}var WP,wF,ile;wze({thousands:",",grouping:[3],currency:["$",""]});function wze(e){return WP=xze(e),wF=WP.format,ile=WP.formatPrefix,WP}function Mze(e){return Math.max(0,-ib(Math.abs(e)))}function Sze(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(ib(t)/3)))*3-ib(Math.abs(e)))}function Tze(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,ib(t)-ib(e))+1}function ole(e,t,r,n){var i=I$(e,t,r),o;switch(n=xM(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(o=Sze(i,s))&&(n.precision=o),ile(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(o=Tze(i,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=o-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(o=Mze(i))&&(n.precision=o-(n.type==="%")*2);break}}return wF(n)}function R_(e){var t=e.domain;return e.ticks=function(r){var n=t();return C$(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var i=t();return ole(i[0],i[i.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),i=0,o=n.length-1,s=n[i],a=n[o],u,d,m=10;for(a<s&&(d=s,s=a,a=d,d=i,i=o,o=d);m-- >0;){if(d=k$(s,a,r),d===u)return n[i]=s,n[o]=a,t(n);if(d>0)s=Math.floor(s/d)*d,a=Math.ceil(a/d)*d;else if(d<0)s=Math.ceil(s*d)/d,a=Math.floor(a*d)/d;else break;u=d}return e},e}function aC(){var e=bF();return e.copy=function(){return TS(e,aC())},Vh.apply(e,arguments),R_(e)}function ale(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,iC),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return ale(e).unknown(t)},e=arguments.length?Array.from(e,iC):[0,1],R_(r)}function sle(e,t){e=e.slice();var r=0,n=e.length-1,i=e[r],o=e[n],s;return o<i&&(s=r,r=n,n=s,s=i,i=o,o=s),e[r]=t.floor(i),e[n]=t.ceil(o),e}function mG(e){return Math.log(e)}function gG(e){return Math.exp(e)}function Pze(e){return-Math.log(-e)}function Eze(e){return-Math.exp(-e)}function Aze(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Cze(e){return e===10?Aze:e===Math.E?Math.exp:t=>Math.pow(e,t)}function kze(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function _G(e){return(t,r)=>-e(-t,r)}function MF(e){const t=e(mG,gG),r=t.domain;let n=10,i,o;function s(){return i=kze(n),o=Cze(n),r()[0]<0?(i=_G(i),o=_G(o),e(Pze,Eze)):e(mG,gG),t}return t.base=function(a){return arguments.length?(n=+a,s()):n},t.domain=function(a){return arguments.length?(r(a),s()):r()},t.ticks=a=>{const u=r();let d=u[0],m=u[u.length-1];const g=m<d;g&&([d,m]=[m,d]);let _=i(d),y=i(m),M,x;const E=a==null?10:+a;let T=[];if(!(n%1)&&y-_<E){if(_=Math.floor(_),y=Math.ceil(y),d>0){for(;_<=y;++_)for(M=1;M<n;++M)if(x=_<0?M/o(-_):M*o(_),!(x<d)){if(x>m)break;T.push(x)}}else for(;_<=y;++_)for(M=n-1;M>=1;--M)if(x=_>0?M/o(-_):M*o(_),!(x<d)){if(x>m)break;T.push(x)}T.length*2<E&&(T=C$(d,m,E))}else T=C$(_,y,Math.min(y-_,E)).map(o);return g?T.reverse():T},t.tickFormat=(a,u)=>{if(a==null&&(a=10),u==null&&(u=n===10?"s":","),typeof u!="function"&&(!(n%1)&&(u=xM(u)).precision==null&&(u.trim=!0),u=wF(u)),a===1/0)return u;const d=Math.max(1,n*a/t.ticks().length);return m=>{let g=m/o(Math.round(i(m)));return g*n<n-.5&&(g*=n),g<=d?u(m):""}},t.nice=()=>r(sle(r(),{floor:a=>o(Math.floor(i(a))),ceil:a=>o(Math.ceil(i(a)))})),t}function lle(){const e=MF(ik()).domain([1,10]);return e.copy=()=>TS(e,lle()).base(e.base()),Vh.apply(e,arguments),e}function yG(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function vG(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function SF(e){var t=1,r=e(yG(t),vG(t));return r.constant=function(n){return arguments.length?e(yG(t=+n),vG(t)):t},R_(r)}function cle(){var e=SF(ik());return e.copy=function(){return TS(e,cle()).constant(e.constant())},Vh.apply(e,arguments)}function bG(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Ize(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Oze(e){return e<0?-e*e:e*e}function TF(e){var t=e(Wu,Wu),r=1;function n(){return r===1?e(Wu,Wu):r===.5?e(Ize,Oze):e(bG(r),bG(1/r))}return t.exponent=function(i){return arguments.length?(r=+i,n()):r},R_(t)}function PF(){var e=TF(ik());return e.copy=function(){return TS(e,PF()).exponent(e.exponent())},Vh.apply(e,arguments),e}function Lze(){return PF.apply(null,arguments).exponent(.5)}function xG(e){return Math.sign(e)*e*e}function Dze(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function ule(){var e=bF(),t=[0,1],r=!1,n;function i(o){var s=Dze(e(o));return isNaN(s)?n:r?Math.round(s):s}return i.invert=function(o){return e.invert(xG(o))},i.domain=function(o){return arguments.length?(e.domain(o),i):e.domain()},i.range=function(o){return arguments.length?(e.range((t=Array.from(o,iC)).map(xG)),i):t.slice()},i.rangeRound=function(o){return i.range(o).round(!0)},i.round=function(o){return arguments.length?(r=!!o,i):r},i.clamp=function(o){return arguments.length?(e.clamp(o),i):e.clamp()},i.unknown=function(o){return arguments.length?(n=o,i):n},i.copy=function(){return ule(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Vh.apply(i,arguments),R_(i)}function dle(){var e=[],t=[],r=[],n;function i(){var s=0,a=Math.max(1,t.length);for(r=new Array(a-1);++s<a;)r[s-1]=FFe(e,s/a);return o}function o(s){return s==null||isNaN(s=+s)?n:t[MS(r,s)]}return o.invertExtent=function(s){var a=t.indexOf(s);return a<0?[NaN,NaN]:[a>0?r[a-1]:e[0],a<r.length?r[a]:e[e.length-1]]},o.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let a of s)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(m_),i()},o.range=function(s){return arguments.length?(t=Array.from(s),i()):t.slice()},o.unknown=function(s){return arguments.length?(n=s,o):n},o.quantiles=function(){return r.slice()},o.copy=function(){return dle().domain(e).range(t).unknown(n)},Vh.apply(o,arguments)}function hle(){var e=0,t=1,r=1,n=[.5],i=[0,1],o;function s(u){return u!=null&&u<=u?i[MS(n,u,0,r)]:o}function a(){var u=-1;for(n=new Array(r);++u<r;)n[u]=((u+1)*t-(u-r)*e)/(r+1);return s}return s.domain=function(u){return arguments.length?([e,t]=u,e=+e,t=+t,a()):[e,t]},s.range=function(u){return arguments.length?(r=(i=Array.from(u)).length-1,a()):i.slice()},s.invertExtent=function(u){var d=i.indexOf(u);return d<0?[NaN,NaN]:d<1?[e,n[0]]:d>=r?[n[r-1],t]:[n[d-1],n[d]]},s.unknown=function(u){return arguments.length&&(o=u),s},s.thresholds=function(){return n.slice()},s.copy=function(){return hle().domain([e,t]).range(i).unknown(o)},Vh.apply(R_(s),arguments)}function fle(){var e=[.5],t=[0,1],r,n=1;function i(o){return o!=null&&o<=o?t[MS(e,o,0,n)]:r}return i.domain=function(o){return arguments.length?(e=Array.from(o),n=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(o){return arguments.length?(t=Array.from(o),n=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(o){var s=t.indexOf(o);return[e[s-1],e[s]]},i.unknown=function(o){return arguments.length?(r=o,i):r},i.copy=function(){return fle().domain(e).range(t).unknown(r)},Vh.apply(i,arguments)}const pO=new Date,mO=new Date;function gc(e,t,r,n){function i(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=o=>(e(o=new Date(+o)),o),i.ceil=o=>(e(o=new Date(o-1)),t(o,1),e(o),o),i.round=o=>{const s=i(o),a=i.ceil(o);return o-s<a-o?s:a},i.offset=(o,s)=>(t(o=new Date(+o),s==null?1:Math.floor(s)),o),i.range=(o,s,a)=>{const u=[];if(o=i.ceil(o),a=a==null?1:Math.floor(a),!(o<s)||!(a>0))return u;let d;do u.push(d=new Date(+o)),t(o,a),e(o);while(d<o&&o<s);return u},i.filter=o=>gc(s=>{if(s>=s)for(;e(s),!o(s);)s.setTime(s-1)},(s,a)=>{if(s>=s)if(a<0)for(;++a<=0;)for(;t(s,-1),!o(s););else for(;--a>=0;)for(;t(s,1),!o(s););}),r&&(i.count=(o,s)=>(pO.setTime(+o),mO.setTime(+s),e(pO),e(mO),Math.floor(r(pO,mO))),i.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(n?s=>n(s)%o===0:s=>i.count(0,s)%o===0):i)),i}const sC=gc(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);sC.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?gc(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):sC);sC.range;const Lm=1e3,Ih=Lm*60,Dm=Ih*60,Km=Dm*24,EF=Km*7,wG=Km*30,gO=Km*365,$y=gc(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Lm)},(e,t)=>(t-e)/Lm,e=>e.getUTCSeconds());$y.range;const AF=gc(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Lm)},(e,t)=>{e.setTime(+e+t*Ih)},(e,t)=>(t-e)/Ih,e=>e.getMinutes());AF.range;const CF=gc(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Ih)},(e,t)=>(t-e)/Ih,e=>e.getUTCMinutes());CF.range;const kF=gc(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Lm-e.getMinutes()*Ih)},(e,t)=>{e.setTime(+e+t*Dm)},(e,t)=>(t-e)/Dm,e=>e.getHours());kF.range;const IF=gc(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Dm)},(e,t)=>(t-e)/Dm,e=>e.getUTCHours());IF.range;const PS=gc(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ih)/Km,e=>e.getDate()-1);PS.range;const ok=gc(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Km,e=>e.getUTCDate()-1);ok.range;const ple=gc(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Km,e=>Math.floor(e/Km));ple.range;function j0(e){return gc(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Ih)/EF)}const ak=j0(0),lC=j0(1),$ze=j0(2),Nze=j0(3),ob=j0(4),jze=j0(5),Rze=j0(6);ak.range;lC.range;$ze.range;Nze.range;ob.range;jze.range;Rze.range;function R0(e){return gc(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/EF)}const sk=R0(0),cC=R0(1),Fze=R0(2),zze=R0(3),ab=R0(4),Bze=R0(5),Uze=R0(6);sk.range;cC.range;Fze.range;zze.range;ab.range;Bze.range;Uze.range;const OF=gc(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());OF.range;const LF=gc(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());LF.range;const Zm=gc(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Zm.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:gc(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Zm.range;const Xm=gc(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Xm.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:gc(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Xm.range;function mle(e,t,r,n,i,o){const s=[[$y,1,Lm],[$y,5,5*Lm],[$y,15,15*Lm],[$y,30,30*Lm],[o,1,Ih],[o,5,5*Ih],[o,15,15*Ih],[o,30,30*Ih],[i,1,Dm],[i,3,3*Dm],[i,6,6*Dm],[i,12,12*Dm],[n,1,Km],[n,2,2*Km],[r,1,EF],[t,1,wG],[t,3,3*wG],[e,1,gO]];function a(d,m,g){const _=m<d;_&&([d,m]=[m,d]);const y=g&&typeof g.range=="function"?g:u(d,m,g),M=y?y.range(d,+m+1):[];return _?M.reverse():M}function u(d,m,g){const _=Math.abs(m-d)/g,y=mF(([,,E])=>E).right(s,_);if(y===s.length)return e.every(I$(d/gO,m/gO,g));if(y===0)return sC.every(Math.max(I$(d,m,g),1));const[M,x]=s[_/s[y-1][2]<s[y][2]/_?y-1:y];return M.every(x)}return[a,u]}const[Vze,Wze]=mle(Xm,LF,sk,ple,IF,CF),[Gze,qze]=mle(Zm,OF,ak,PS,kF,AF);function _O(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function yO(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function kw(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function Hze(e){var t=e.dateTime,r=e.date,n=e.time,i=e.periods,o=e.days,s=e.shortDays,a=e.months,u=e.shortMonths,d=Iw(i),m=Ow(i),g=Iw(o),_=Ow(o),y=Iw(s),M=Ow(s),x=Iw(a),E=Ow(a),T=Iw(u),P=Ow(u),C={a:_e,A:ue,b:fe,B:De,c:null,d:AG,e:AG,f:gBe,g:PBe,G:ABe,H:fBe,I:pBe,j:mBe,L:gle,m:_Be,M:yBe,p:pe,q:K,Q:IG,s:OG,S:vBe,u:bBe,U:xBe,V:wBe,w:MBe,W:SBe,x:null,X:null,y:TBe,Y:EBe,Z:CBe,"%":kG},D={a:te,A:ve,b:$e,B:Ce,c:null,d:CG,e:CG,f:LBe,g:VBe,G:GBe,H:kBe,I:IBe,j:OBe,L:yle,m:DBe,M:$Be,p:Ge,q:ot,Q:IG,s:OG,S:NBe,u:jBe,U:RBe,V:FBe,w:zBe,W:BBe,x:null,X:null,y:UBe,Y:WBe,Z:qBe,"%":kG},L={a:G,A:H,b:X,B:ee,c:ae,d:PG,e:PG,f:cBe,g:TG,G:SG,H:EG,I:EG,j:oBe,L:lBe,m:iBe,M:aBe,p:U,q:nBe,Q:dBe,s:hBe,S:sBe,u:Qze,U:Jze,V:eBe,w:Yze,W:tBe,x:de,X:ye,y:TG,Y:SG,Z:rBe,"%":uBe};C.x=N(r,C),C.X=N(n,C),C.c=N(t,C),D.x=N(r,D),D.X=N(n,D),D.c=N(t,D);function N(Ye,et){return function(Te){var Le=[],ke=-1,Xe=0,Ne=Ye.length,Ot,Lt,kt;for(Te instanceof Date||(Te=new Date(+Te));++ke<Ne;)Ye.charCodeAt(ke)===37&&(Le.push(Ye.slice(Xe,ke)),(Lt=MG[Ot=Ye.charAt(++ke)])!=null?Ot=Ye.charAt(++ke):Lt=Ot==="e"?" ":"0",(kt=et[Ot])&&(Ot=kt(Te,Lt)),Le.push(Ot),Xe=ke+1);return Le.push(Ye.slice(Xe,ke)),Le.join("")}}function j(Ye,et){return function(Te){var Le=kw(1900,void 0,1),ke=$(Le,Ye,Te+="",0),Xe,Ne;if(ke!=Te.length)return null;if("Q"in Le)return new Date(Le.Q);if("s"in Le)return new Date(Le.s*1e3+("L"in Le?Le.L:0));if(et&&!("Z"in Le)&&(Le.Z=0),"p"in Le&&(Le.H=Le.H%12+Le.p*12),Le.m===void 0&&(Le.m="q"in Le?Le.q:0),"V"in Le){if(Le.V<1||Le.V>53)return null;"w"in Le||(Le.w=1),"Z"in Le?(Xe=yO(kw(Le.y,0,1)),Ne=Xe.getUTCDay(),Xe=Ne>4||Ne===0?cC.ceil(Xe):cC(Xe),Xe=ok.offset(Xe,(Le.V-1)*7),Le.y=Xe.getUTCFullYear(),Le.m=Xe.getUTCMonth(),Le.d=Xe.getUTCDate()+(Le.w+6)%7):(Xe=_O(kw(Le.y,0,1)),Ne=Xe.getDay(),Xe=Ne>4||Ne===0?lC.ceil(Xe):lC(Xe),Xe=PS.offset(Xe,(Le.V-1)*7),Le.y=Xe.getFullYear(),Le.m=Xe.getMonth(),Le.d=Xe.getDate()+(Le.w+6)%7)}else("W"in Le||"U"in Le)&&("w"in Le||(Le.w="u"in Le?Le.u%7:"W"in Le?1:0),Ne="Z"in Le?yO(kw(Le.y,0,1)).getUTCDay():_O(kw(Le.y,0,1)).getDay(),Le.m=0,Le.d="W"in Le?(Le.w+6)%7+Le.W*7-(Ne+5)%7:Le.w+Le.U*7-(Ne+6)%7);return"Z"in Le?(Le.H+=Le.Z/100|0,Le.M+=Le.Z%100,yO(Le)):_O(Le)}}function $(Ye,et,Te,Le){for(var ke=0,Xe=et.length,Ne=Te.length,Ot,Lt;ke<Xe;){if(Le>=Ne)return-1;if(Ot=et.charCodeAt(ke++),Ot===37){if(Ot=et.charAt(ke++),Lt=L[Ot in MG?et.charAt(ke++):Ot],!Lt||(Le=Lt(Ye,Te,Le))<0)return-1}else if(Ot!=Te.charCodeAt(Le++))return-1}return Le}function U(Ye,et,Te){var Le=d.exec(et.slice(Te));return Le?(Ye.p=m.get(Le[0].toLowerCase()),Te+Le[0].length):-1}function G(Ye,et,Te){var Le=y.exec(et.slice(Te));return Le?(Ye.w=M.get(Le[0].toLowerCase()),Te+Le[0].length):-1}function H(Ye,et,Te){var Le=g.exec(et.slice(Te));return Le?(Ye.w=_.get(Le[0].toLowerCase()),Te+Le[0].length):-1}function X(Ye,et,Te){var Le=T.exec(et.slice(Te));return Le?(Ye.m=P.get(Le[0].toLowerCase()),Te+Le[0].length):-1}function ee(Ye,et,Te){var Le=x.exec(et.slice(Te));return Le?(Ye.m=E.get(Le[0].toLowerCase()),Te+Le[0].length):-1}function ae(Ye,et,Te){return $(Ye,t,et,Te)}function de(Ye,et,Te){return $(Ye,r,et,Te)}function ye(Ye,et,Te){return $(Ye,n,et,Te)}function _e(Ye){return s[Ye.getDay()]}function ue(Ye){return o[Ye.getDay()]}function fe(Ye){return u[Ye.getMonth()]}function De(Ye){return a[Ye.getMonth()]}function pe(Ye){return i[+(Ye.getHours()>=12)]}function K(Ye){return 1+~~(Ye.getMonth()/3)}function te(Ye){return s[Ye.getUTCDay()]}function ve(Ye){return o[Ye.getUTCDay()]}function $e(Ye){return u[Ye.getUTCMonth()]}function Ce(Ye){return a[Ye.getUTCMonth()]}function Ge(Ye){return i[+(Ye.getUTCHours()>=12)]}function ot(Ye){return 1+~~(Ye.getUTCMonth()/3)}return{format:function(Ye){var et=N(Ye+="",C);return et.toString=function(){return Ye},et},parse:function(Ye){var et=j(Ye+="",!1);return et.toString=function(){return Ye},et},utcFormat:function(Ye){var et=N(Ye+="",D);return et.toString=function(){return Ye},et},utcParse:function(Ye){var et=j(Ye+="",!0);return et.toString=function(){return Ye},et}}}var MG={"-":"",_:" ",0:"0"},Bc=/^\s*\d+/,Kze=/^%/,Zze=/[\\^$*+?|[\]().{}]/g;function aa(e,t,r){var n=e<0?"-":"",i=(n?-e:e)+"",o=i.length;return n+(o<r?new Array(r-o+1).join(t)+i:i)}function Xze(e){return e.replace(Zze,"\\$&")}function Iw(e){return new RegExp("^(?:"+e.map(Xze).join("|")+")","i")}function Ow(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function Yze(e,t,r){var n=Bc.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function Qze(e,t,r){var n=Bc.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function Jze(e,t,r){var n=Bc.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function eBe(e,t,r){var n=Bc.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function tBe(e,t,r){var n=Bc.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function SG(e,t,r){var n=Bc.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function TG(e,t,r){var n=Bc.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function rBe(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function nBe(e,t,r){var n=Bc.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function iBe(e,t,r){var n=Bc.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function PG(e,t,r){var n=Bc.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function oBe(e,t,r){var n=Bc.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function EG(e,t,r){var n=Bc.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function aBe(e,t,r){var n=Bc.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function sBe(e,t,r){var n=Bc.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function lBe(e,t,r){var n=Bc.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function cBe(e,t,r){var n=Bc.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function uBe(e,t,r){var n=Kze.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function dBe(e,t,r){var n=Bc.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function hBe(e,t,r){var n=Bc.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function AG(e,t){return aa(e.getDate(),t,2)}function fBe(e,t){return aa(e.getHours(),t,2)}function pBe(e,t){return aa(e.getHours()%12||12,t,2)}function mBe(e,t){return aa(1+PS.count(Zm(e),e),t,3)}function gle(e,t){return aa(e.getMilliseconds(),t,3)}function gBe(e,t){return gle(e,t)+"000"}function _Be(e,t){return aa(e.getMonth()+1,t,2)}function yBe(e,t){return aa(e.getMinutes(),t,2)}function vBe(e,t){return aa(e.getSeconds(),t,2)}function bBe(e){var t=e.getDay();return t===0?7:t}function xBe(e,t){return aa(ak.count(Zm(e)-1,e),t,2)}function _le(e){var t=e.getDay();return t>=4||t===0?ob(e):ob.ceil(e)}function wBe(e,t){return e=_le(e),aa(ob.count(Zm(e),e)+(Zm(e).getDay()===4),t,2)}function MBe(e){return e.getDay()}function SBe(e,t){return aa(lC.count(Zm(e)-1,e),t,2)}function TBe(e,t){return aa(e.getFullYear()%100,t,2)}function PBe(e,t){return e=_le(e),aa(e.getFullYear()%100,t,2)}function EBe(e,t){return aa(e.getFullYear()%1e4,t,4)}function ABe(e,t){var r=e.getDay();return e=r>=4||r===0?ob(e):ob.ceil(e),aa(e.getFullYear()%1e4,t,4)}function CBe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+aa(t/60|0,"0",2)+aa(t%60,"0",2)}function CG(e,t){return aa(e.getUTCDate(),t,2)}function kBe(e,t){return aa(e.getUTCHours(),t,2)}function IBe(e,t){return aa(e.getUTCHours()%12||12,t,2)}function OBe(e,t){return aa(1+ok.count(Xm(e),e),t,3)}function yle(e,t){return aa(e.getUTCMilliseconds(),t,3)}function LBe(e,t){return yle(e,t)+"000"}function DBe(e,t){return aa(e.getUTCMonth()+1,t,2)}function $Be(e,t){return aa(e.getUTCMinutes(),t,2)}function NBe(e,t){return aa(e.getUTCSeconds(),t,2)}function jBe(e){var t=e.getUTCDay();return t===0?7:t}function RBe(e,t){return aa(sk.count(Xm(e)-1,e),t,2)}function vle(e){var t=e.getUTCDay();return t>=4||t===0?ab(e):ab.ceil(e)}function FBe(e,t){return e=vle(e),aa(ab.count(Xm(e),e)+(Xm(e).getUTCDay()===4),t,2)}function zBe(e){return e.getUTCDay()}function BBe(e,t){return aa(cC.count(Xm(e)-1,e),t,2)}function UBe(e,t){return aa(e.getUTCFullYear()%100,t,2)}function VBe(e,t){return e=vle(e),aa(e.getUTCFullYear()%100,t,2)}function WBe(e,t){return aa(e.getUTCFullYear()%1e4,t,4)}function GBe(e,t){var r=e.getUTCDay();return e=r>=4||r===0?ab(e):ab.ceil(e),aa(e.getUTCFullYear()%1e4,t,4)}function qBe(){return"+0000"}function kG(){return"%"}function IG(e){return+e}function OG(e){return Math.floor(+e/1e3)}var Av,ble,xle;HBe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function HBe(e){return Av=Hze(e),ble=Av.format,Av.parse,xle=Av.utcFormat,Av.utcParse,Av}function KBe(e){return new Date(e)}function ZBe(e){return e instanceof Date?+e:+new Date(+e)}function DF(e,t,r,n,i,o,s,a,u,d){var m=bF(),g=m.invert,_=m.domain,y=d(".%L"),M=d(":%S"),x=d("%I:%M"),E=d("%I %p"),T=d("%a %d"),P=d("%b %d"),C=d("%B"),D=d("%Y");function L(N){return(u(N)<N?y:a(N)<N?M:s(N)<N?x:o(N)<N?E:n(N)<N?i(N)<N?T:P:r(N)<N?C:D)(N)}return m.invert=function(N){return new Date(g(N))},m.domain=function(N){return arguments.length?_(Array.from(N,ZBe)):_().map(KBe)},m.ticks=function(N){var j=_();return e(j[0],j[j.length-1],N??10)},m.tickFormat=function(N,j){return j==null?L:d(j)},m.nice=function(N){var j=_();return(!N||typeof N.range!="function")&&(N=t(j[0],j[j.length-1],N??10)),N?_(sle(j,N)):m},m.copy=function(){return TS(m,DF(e,t,r,n,i,o,s,a,u,d))},m}function XBe(){return Vh.apply(DF(Gze,qze,Zm,OF,ak,PS,kF,AF,$y,ble).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function YBe(){return Vh.apply(DF(Vze,Wze,Xm,LF,sk,ok,IF,CF,$y,xle).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function lk(){var e=0,t=1,r,n,i,o,s=Wu,a=!1,u;function d(g){return g==null||isNaN(g=+g)?u:s(i===0?.5:(g=(o(g)-r)*i,a?Math.max(0,Math.min(1,g)):g))}d.domain=function(g){return arguments.length?([e,t]=g,r=o(e=+e),n=o(t=+t),i=r===n?0:1/(n-r),d):[e,t]},d.clamp=function(g){return arguments.length?(a=!!g,d):a},d.interpolator=function(g){return arguments.length?(s=g,d):s};function m(g){return function(_){var y,M;return arguments.length?([y,M]=_,s=g(y,M),d):[s(0),s(1)]}}return d.range=m(Yb),d.rangeRound=m(vF),d.unknown=function(g){return arguments.length?(u=g,d):u},function(g){return o=g,r=g(e),n=g(t),i=r===n?0:1/(n-r),d}}function F_(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function wle(){var e=R_(lk()(Wu));return e.copy=function(){return F_(e,wle())},ng.apply(e,arguments)}function Mle(){var e=MF(lk()).domain([1,10]);return e.copy=function(){return F_(e,Mle()).base(e.base())},ng.apply(e,arguments)}function Sle(){var e=SF(lk());return e.copy=function(){return F_(e,Sle()).constant(e.constant())},ng.apply(e,arguments)}function $F(){var e=TF(lk());return e.copy=function(){return F_(e,$F()).exponent(e.exponent())},ng.apply(e,arguments)}function QBe(){return $F.apply(null,arguments).exponent(.5)}function Tle(){var e=[],t=Wu;function r(n){if(n!=null&&!isNaN(n=+n))return t((MS(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let i of n)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(m_),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,i)=>t(i/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(i,o)=>RFe(e,o/n))},r.copy=function(){return Tle(t).domain(e)},ng.apply(r,arguments)}function ck(){var e=0,t=.5,r=1,n=1,i,o,s,a,u,d=Wu,m,g=!1,_;function y(x){return isNaN(x=+x)?_:(x=.5+((x=+m(x))-o)*(n*x<n*o?a:u),d(g?Math.max(0,Math.min(1,x)):x))}y.domain=function(x){return arguments.length?([e,t,r]=x,i=m(e=+e),o=m(t=+t),s=m(r=+r),a=i===o?0:.5/(o-i),u=o===s?0:.5/(s-o),n=o<i?-1:1,y):[e,t,r]},y.clamp=function(x){return arguments.length?(g=!!x,y):g},y.interpolator=function(x){return arguments.length?(d=x,y):d};function M(x){return function(E){var T,P,C;return arguments.length?([T,P,C]=E,d=uze(x,[T,P,C]),y):[d(0),d(.5),d(1)]}}return y.range=M(Yb),y.rangeRound=M(vF),y.unknown=function(x){return arguments.length?(_=x,y):_},function(x){return m=x,i=x(e),o=x(t),s=x(r),a=i===o?0:.5/(o-i),u=o===s?0:.5/(s-o),n=o<i?-1:1,y}}function Ple(){var e=R_(ck()(Wu));return e.copy=function(){return F_(e,Ple())},ng.apply(e,arguments)}function Ele(){var e=MF(ck()).domain([.1,1,10]);return e.copy=function(){return F_(e,Ele()).base(e.base())},ng.apply(e,arguments)}function Ale(){var e=SF(ck());return e.copy=function(){return F_(e,Ale()).constant(e.constant())},ng.apply(e,arguments)}function NF(){var e=TF(ck());return e.copy=function(){return F_(e,NF()).exponent(e.exponent())},ng.apply(e,arguments)}function JBe(){return NF.apply(null,arguments).exponent(.5)}const LG=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:_M,scaleDiverging:Ple,scaleDivergingLog:Ele,scaleDivergingPow:NF,scaleDivergingSqrt:JBe,scaleDivergingSymlog:Ale,scaleIdentity:ale,scaleImplicit:O$,scaleLinear:aC,scaleLog:lle,scaleOrdinal:gF,scalePoint:y2,scalePow:PF,scaleQuantile:dle,scaleQuantize:hle,scaleRadial:ule,scaleSequential:wle,scaleSequentialLog:Mle,scaleSequentialPow:$F,scaleSequentialQuantile:Tle,scaleSequentialSqrt:QBe,scaleSequentialSymlog:Sle,scaleSqrt:Lze,scaleSymlog:cle,scaleThreshold:fle,scaleTime:XBe,scaleUtc:YBe,tickFormat:ole},Symbol.toStringTag,{value:"Module"}));var e6e=Ub;function t6e(e,t,r){for(var n=-1,i=e.length;++n<i;){var o=e[n],s=t(o);if(s!=null&&(a===void 0?s===s&&!e6e(s):r(s,a)))var a=s,u=o}return u}var uk=t6e;function r6e(e,t){return e>t}var Cle=r6e,n6e=uk,i6e=Cle,o6e=Xb;function a6e(e){return e&&e.length?n6e(e,o6e,i6e):void 0}var s6e=a6e;const r_=sa(s6e);function l6e(e,t){return e<t}var kle=l6e,c6e=uk,u6e=kle,d6e=Xb;function h6e(e){return e&&e.length?c6e(e,d6e,u6e):void 0}var f6e=h6e;const dk=sa(f6e);var p6e=XR,m6e=Qp,g6e=Rse,_6e=gd;function y6e(e,t){var r=_6e(e)?p6e:g6e;return r(e,m6e(t))}var v6e=y6e,b6e=Nse,x6e=v6e;function w6e(e,t){return b6e(x6e(e,t),1)}var M6e=w6e;const S6e=sa(M6e);var T6e=dF;function P6e(e,t){return T6e(e,t)}var E6e=P6e;const _0=sa(E6e);var Qb=1e9,A6e={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},RF,Ds=!0,Fh="[DecimalError] ",Qy=Fh+"Invalid argument: ",jF=Fh+"Exponent out of range: ",Jb=Math.floor,xy=Math.pow,C6e=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Gd,$c=1e7,vs=7,Ile=9007199254740991,uC=Jb(Ile/vs),Un={};Un.absoluteValue=Un.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Un.comparedTo=Un.cmp=function(e){var t,r,n,i,o=this;if(e=new o.constructor(e),o.s!==e.s)return o.s||-e.s;if(o.e!==e.e)return o.e>e.e^o.s<0?1:-1;for(n=o.d.length,i=e.d.length,t=0,r=n<i?n:i;t<r;++t)if(o.d[t]!==e.d[t])return o.d[t]>e.d[t]^o.s<0?1:-1;return n===i?0:n>i^o.s<0?1:-1};Un.decimalPlaces=Un.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*vs;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Un.dividedBy=Un.div=function(e){return Fm(this,new this.constructor(e))};Un.dividedToIntegerBy=Un.idiv=function(e){var t=this,r=t.constructor;return Va(Fm(t,new r(e),0,1),r.precision)};Un.equals=Un.eq=function(e){return!this.cmp(e)};Un.exponent=function(){return Kl(this)};Un.greaterThan=Un.gt=function(e){return this.cmp(e)>0};Un.greaterThanOrEqualTo=Un.gte=function(e){return this.cmp(e)>=0};Un.isInteger=Un.isint=function(){return this.e>this.d.length-2};Un.isNegative=Un.isneg=function(){return this.s<0};Un.isPositive=Un.ispos=function(){return this.s>0};Un.isZero=function(){return this.s===0};Un.lessThan=Un.lt=function(e){return this.cmp(e)<0};Un.lessThanOrEqualTo=Un.lte=function(e){return this.cmp(e)<1};Un.logarithm=Un.log=function(e){var t,r=this,n=r.constructor,i=n.precision,o=i+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Gd))throw Error(Fh+"NaN");if(r.s<1)throw Error(Fh+(r.s?"NaN":"-Infinity"));return r.eq(Gd)?new n(0):(Ds=!1,t=Fm(wM(r,o),wM(e,o),o),Ds=!0,Va(t,i))};Un.minus=Un.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?Dle(t,e):Ole(t,(e.s=-e.s,e))};Un.modulo=Un.mod=function(e){var t,r=this,n=r.constructor,i=n.precision;if(e=new n(e),!e.s)throw Error(Fh+"NaN");return r.s?(Ds=!1,t=Fm(r,e,0,1).times(e),Ds=!0,r.minus(t)):Va(new n(r),i)};Un.naturalExponential=Un.exp=function(){return Lle(this)};Un.naturalLogarithm=Un.ln=function(){return wM(this)};Un.negated=Un.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Un.plus=Un.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?Ole(t,e):Dle(t,(e.s=-e.s,e))};Un.precision=Un.sd=function(e){var t,r,n,i=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Qy+e);if(t=Kl(i)+1,n=i.d.length-1,r=n*vs+1,n=i.d[n],n){for(;n%10==0;n/=10)r--;for(n=i.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};Un.squareRoot=Un.sqrt=function(){var e,t,r,n,i,o,s,a=this,u=a.constructor;if(a.s<1){if(!a.s)return new u(0);throw Error(Fh+"NaN")}for(e=Kl(a),Ds=!1,i=Math.sqrt(+a),i==0||i==1/0?(t=Op(a.d),(t.length+e)%2==0&&(t+="0"),i=Math.sqrt(t),e=Jb((e+1)/2)-(e<0||e%2),i==1/0?t="5e"+e:(t=i.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new u(t)):n=new u(i.toString()),r=u.precision,i=s=r+3;;)if(o=n,n=o.plus(Fm(a,o,s+2)).times(.5),Op(o.d).slice(0,s)===(t=Op(n.d)).slice(0,s)){if(t=t.slice(s-3,s+1),i==s&&t=="4999"){if(Va(o,r+1,0),o.times(o).eq(a)){n=o;break}}else if(t!="9999")break;s+=4}return Ds=!0,Va(n,r)};Un.times=Un.mul=function(e){var t,r,n,i,o,s,a,u,d,m=this,g=m.constructor,_=m.d,y=(e=new g(e)).d;if(!m.s||!e.s)return new g(0);for(e.s*=m.s,r=m.e+e.e,u=_.length,d=y.length,u<d&&(o=_,_=y,y=o,s=u,u=d,d=s),o=[],s=u+d,n=s;n--;)o.push(0);for(n=d;--n>=0;){for(t=0,i=u+n;i>n;)a=o[i]+y[n]*_[i-n-1]+t,o[i--]=a%$c|0,t=a/$c|0;o[i]=(o[i]+t)%$c|0}for(;!o[--s];)o.pop();return t?++r:o.shift(),e.d=o,e.e=r,Ds?Va(e,g.precision):e};Un.toDecimalPlaces=Un.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Kp(e,0,Qb),t===void 0?t=n.rounding:Kp(t,0,8),Va(r,e+Kl(r)+1,t))};Un.toExponential=function(e,t){var r,n=this,i=n.constructor;return e===void 0?r=y0(n,!0):(Kp(e,0,Qb),t===void 0?t=i.rounding:Kp(t,0,8),n=Va(new i(n),e+1,t),r=y0(n,!0,e+1)),r};Un.toFixed=function(e,t){var r,n,i=this,o=i.constructor;return e===void 0?y0(i):(Kp(e,0,Qb),t===void 0?t=o.rounding:Kp(t,0,8),n=Va(new o(i),e+Kl(i)+1,t),r=y0(n.abs(),!1,e+Kl(n)+1),i.isneg()&&!i.isZero()?"-"+r:r)};Un.toInteger=Un.toint=function(){var e=this,t=e.constructor;return Va(new t(e),Kl(e)+1,t.rounding)};Un.toNumber=function(){return+this};Un.toPower=Un.pow=function(e){var t,r,n,i,o,s,a=this,u=a.constructor,d=12,m=+(e=new u(e));if(!e.s)return new u(Gd);if(a=new u(a),!a.s){if(e.s<1)throw Error(Fh+"Infinity");return a}if(a.eq(Gd))return a;if(n=u.precision,e.eq(Gd))return Va(a,n);if(t=e.e,r=e.d.length-1,s=t>=r,o=a.s,s){if((r=m<0?-m:m)<=Ile){for(i=new u(Gd),t=Math.ceil(n/vs+4),Ds=!1;r%2&&(i=i.times(a),$G(i.d,t)),r=Jb(r/2),r!==0;)a=a.times(a),$G(a.d,t);return Ds=!0,e.s<0?new u(Gd).div(i):Va(i,n)}}else if(o<0)throw Error(Fh+"NaN");return o=o<0&&e.d[Math.max(t,r)]&1?-1:1,a.s=1,Ds=!1,i=e.times(wM(a,n+d)),Ds=!0,i=Lle(i),i.s=o,i};Un.toPrecision=function(e,t){var r,n,i=this,o=i.constructor;return e===void 0?(r=Kl(i),n=y0(i,r<=o.toExpNeg||r>=o.toExpPos)):(Kp(e,1,Qb),t===void 0?t=o.rounding:Kp(t,0,8),i=Va(new o(i),e,t),r=Kl(i),n=y0(i,e<=r||r<=o.toExpNeg,e)),n};Un.toSignificantDigits=Un.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Kp(e,1,Qb),t===void 0?t=n.rounding:Kp(t,0,8)),Va(new n(r),e,t)};Un.toString=Un.valueOf=Un.val=Un.toJSON=Un[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Kl(e),r=e.constructor;return y0(e,t<=r.toExpNeg||t>=r.toExpPos)};function Ole(e,t){var r,n,i,o,s,a,u,d,m=e.constructor,g=m.precision;if(!e.s||!t.s)return t.s||(t=new m(e)),Ds?Va(t,g):t;if(u=e.d,d=t.d,s=e.e,i=t.e,u=u.slice(),o=s-i,o){for(o<0?(n=u,o=-o,a=d.length):(n=d,i=s,a=u.length),s=Math.ceil(g/vs),a=s>a?s+1:a+1,o>a&&(o=a,n.length=1),n.reverse();o--;)n.push(0);n.reverse()}for(a=u.length,o=d.length,a-o<0&&(o=a,n=d,d=u,u=n),r=0;o;)r=(u[--o]=u[o]+d[o]+r)/$c|0,u[o]%=$c;for(r&&(u.unshift(r),++i),a=u.length;u[--a]==0;)u.pop();return t.d=u,t.e=i,Ds?Va(t,g):t}function Kp(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Qy+e)}function Op(e){var t,r,n,i=e.length-1,o="",s=e[0];if(i>0){for(o+=s,t=1;t<i;t++)n=e[t]+"",r=vs-n.length,r&&(o+=Ug(r)),o+=n;s=e[t],n=s+"",r=vs-n.length,r&&(o+=Ug(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return o+s}var Fm=function(){function e(n,i){var o,s=0,a=n.length;for(n=n.slice();a--;)o=n[a]*i+s,n[a]=o%$c|0,s=o/$c|0;return s&&n.unshift(s),n}function t(n,i,o,s){var a,u;if(o!=s)u=o>s?1:-1;else for(a=u=0;a<o;a++)if(n[a]!=i[a]){u=n[a]>i[a]?1:-1;break}return u}function r(n,i,o){for(var s=0;o--;)n[o]-=s,s=n[o]<i[o]?1:0,n[o]=s*$c+n[o]-i[o];for(;!n[0]&&n.length>1;)n.shift()}return function(n,i,o,s){var a,u,d,m,g,_,y,M,x,E,T,P,C,D,L,N,j,$,U=n.constructor,G=n.s==i.s?1:-1,H=n.d,X=i.d;if(!n.s)return new U(n);if(!i.s)throw Error(Fh+"Division by zero");for(u=n.e-i.e,j=X.length,L=H.length,y=new U(G),M=y.d=[],d=0;X[d]==(H[d]||0);)++d;if(X[d]>(H[d]||0)&&--u,o==null?P=o=U.precision:s?P=o+(Kl(n)-Kl(i))+1:P=o,P<0)return new U(0);if(P=P/vs+2|0,d=0,j==1)for(m=0,X=X[0],P++;(d<L||m)&&P--;d++)C=m*$c+(H[d]||0),M[d]=C/X|0,m=C%X|0;else{for(m=$c/(X[0]+1)|0,m>1&&(X=e(X,m),H=e(H,m),j=X.length,L=H.length),D=j,x=H.slice(0,j),E=x.length;E<j;)x[E++]=0;$=X.slice(),$.unshift(0),N=X[0],X[1]>=$c/2&&++N;do m=0,a=t(X,x,j,E),a<0?(T=x[0],j!=E&&(T=T*$c+(x[1]||0)),m=T/N|0,m>1?(m>=$c&&(m=$c-1),g=e(X,m),_=g.length,E=x.length,a=t(g,x,_,E),a==1&&(m--,r(g,j<_?$:X,_))):(m==0&&(a=m=1),g=X.slice()),_=g.length,_<E&&g.unshift(0),r(x,g,E),a==-1&&(E=x.length,a=t(X,x,j,E),a<1&&(m++,r(x,j<E?$:X,E))),E=x.length):a===0&&(m++,x=[0]),M[d++]=m,a&&x[0]?x[E++]=H[D]||0:(x=[H[D]],E=1);while((D++<L||x[0]!==void 0)&&P--)}return M[0]||M.shift(),y.e=u,Va(y,s?o+Kl(y)+1:o)}}();function Lle(e,t){var r,n,i,o,s,a,u=0,d=0,m=e.constructor,g=m.precision;if(Kl(e)>16)throw Error(jF+Kl(e));if(!e.s)return new m(Gd);for(t==null?(Ds=!1,a=g):a=t,s=new m(.03125);e.abs().gte(.1);)e=e.times(s),d+=5;for(n=Math.log(xy(2,d))/Math.LN10*2+5|0,a+=n,r=i=o=new m(Gd),m.precision=a;;){if(i=Va(i.times(e),a),r=r.times(++u),s=o.plus(Fm(i,r,a)),Op(s.d).slice(0,a)===Op(o.d).slice(0,a)){for(;d--;)o=Va(o.times(o),a);return m.precision=g,t==null?(Ds=!0,Va(o,g)):o}o=s}}function Kl(e){for(var t=e.e*vs,r=e.d[0];r>=10;r/=10)t++;return t}function vO(e,t,r){if(t>e.LN10.sd())throw Ds=!0,r&&(e.precision=r),Error(Fh+"LN10 precision limit exceeded");return Va(new e(e.LN10),t)}function Ug(e){for(var t="";e--;)t+="0";return t}function wM(e,t){var r,n,i,o,s,a,u,d,m,g=1,_=10,y=e,M=y.d,x=y.constructor,E=x.precision;if(y.s<1)throw Error(Fh+(y.s?"NaN":"-Infinity"));if(y.eq(Gd))return new x(0);if(t==null?(Ds=!1,d=E):d=t,y.eq(10))return t==null&&(Ds=!0),vO(x,d);if(d+=_,x.precision=d,r=Op(M),n=r.charAt(0),o=Kl(y),Math.abs(o)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)y=y.times(e),r=Op(y.d),n=r.charAt(0),g++;o=Kl(y),n>1?(y=new x("0."+r),o++):y=new x(n+"."+r.slice(1))}else return u=vO(x,d+2,E).times(o+""),y=wM(new x(n+"."+r.slice(1)),d-_).plus(u),x.precision=E,t==null?(Ds=!0,Va(y,E)):y;for(a=s=y=Fm(y.minus(Gd),y.plus(Gd),d),m=Va(y.times(y),d),i=3;;){if(s=Va(s.times(m),d),u=a.plus(Fm(s,new x(i),d)),Op(u.d).slice(0,d)===Op(a.d).slice(0,d))return a=a.times(2),o!==0&&(a=a.plus(vO(x,d+2,E).times(o+""))),a=Fm(a,new x(g),d),x.precision=E,t==null?(Ds=!0,Va(a,E)):a;a=u,i+=2}}function DG(e,t){var r,n,i;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(i=t.length;t.charCodeAt(i-1)===48;)--i;if(t=t.slice(n,i),t){if(i-=n,r=r-n-1,e.e=Jb(r/vs),e.d=[],n=(r+1)%vs,r<0&&(n+=vs),n<i){for(n&&e.d.push(+t.slice(0,n)),i-=vs;n<i;)e.d.push(+t.slice(n,n+=vs));t=t.slice(n),n=vs-t.length}else n-=i;for(;n--;)t+="0";if(e.d.push(+t),Ds&&(e.e>uC||e.e<-uC))throw Error(jF+r)}else e.s=0,e.e=0,e.d=[0];return e}function Va(e,t,r){var n,i,o,s,a,u,d,m,g=e.d;for(s=1,o=g[0];o>=10;o/=10)s++;if(n=t-s,n<0)n+=vs,i=t,d=g[m=0];else{if(m=Math.ceil((n+1)/vs),o=g.length,m>=o)return e;for(d=o=g[m],s=1;o>=10;o/=10)s++;n%=vs,i=n-vs+s}if(r!==void 0&&(o=xy(10,s-i-1),a=d/o%10|0,u=t<0||g[m+1]!==void 0||d%o,u=r<4?(a||u)&&(r==0||r==(e.s<0?3:2)):a>5||a==5&&(r==4||u||r==6&&(n>0?i>0?d/xy(10,s-i):0:g[m-1])%10&1||r==(e.s<0?8:7))),t<1||!g[0])return u?(o=Kl(e),g.length=1,t=t-o-1,g[0]=xy(10,(vs-t%vs)%vs),e.e=Jb(-t/vs)||0):(g.length=1,g[0]=e.e=e.s=0),e;if(n==0?(g.length=m,o=1,m--):(g.length=m+1,o=xy(10,vs-n),g[m]=i>0?(d/xy(10,s-i)%xy(10,i)|0)*o:0),u)for(;;)if(m==0){(g[0]+=o)==$c&&(g[0]=1,++e.e);break}else{if(g[m]+=o,g[m]!=$c)break;g[m--]=0,o=1}for(n=g.length;g[--n]===0;)g.pop();if(Ds&&(e.e>uC||e.e<-uC))throw Error(jF+Kl(e));return e}function Dle(e,t){var r,n,i,o,s,a,u,d,m,g,_=e.constructor,y=_.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new _(e),Ds?Va(t,y):t;if(u=e.d,g=t.d,n=t.e,d=e.e,u=u.slice(),s=d-n,s){for(m=s<0,m?(r=u,s=-s,a=g.length):(r=g,n=d,a=u.length),i=Math.max(Math.ceil(y/vs),a)+2,s>i&&(s=i,r.length=1),r.reverse(),i=s;i--;)r.push(0);r.reverse()}else{for(i=u.length,a=g.length,m=i<a,m&&(a=i),i=0;i<a;i++)if(u[i]!=g[i]){m=u[i]<g[i];break}s=0}for(m&&(r=u,u=g,g=r,t.s=-t.s),a=u.length,i=g.length-a;i>0;--i)u[a++]=0;for(i=g.length;i>s;){if(u[--i]<g[i]){for(o=i;o&&u[--o]===0;)u[o]=$c-1;--u[o],u[i]+=$c}u[i]-=g[i]}for(;u[--a]===0;)u.pop();for(;u[0]===0;u.shift())--n;return u[0]?(t.d=u,t.e=n,Ds?Va(t,y):t):new _(0)}function y0(e,t,r){var n,i=Kl(e),o=Op(e.d),s=o.length;return t?(r&&(n=r-s)>0?o=o.charAt(0)+"."+o.slice(1)+Ug(n):s>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(i<0?"e":"e+")+i):i<0?(o="0."+Ug(-i-1)+o,r&&(n=r-s)>0&&(o+=Ug(n))):i>=s?(o+=Ug(i+1-s),r&&(n=r-i-1)>0&&(o=o+"."+Ug(n))):((n=i+1)<s&&(o=o.slice(0,n)+"."+o.slice(n)),r&&(n=r-s)>0&&(i+1===s&&(o+="."),o+=Ug(n))),e.s<0?"-"+o:o}function $G(e,t){if(e.length>t)return e.length=t,!0}function $le(e){var t,r,n;function i(o){var s=this;if(!(s instanceof i))return new i(o);if(s.constructor=i,o instanceof i){s.s=o.s,s.e=o.e,s.d=(o=o.d)?o.slice():o;return}if(typeof o=="number"){if(o*0!==0)throw Error(Qy+o);if(o>0)s.s=1;else if(o<0)o=-o,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(o===~~o&&o<1e7){s.e=0,s.d=[o];return}return DG(s,o.toString())}else if(typeof o!="string")throw Error(Qy+o);if(o.charCodeAt(0)===45?(o=o.slice(1),s.s=-1):s.s=1,C6e.test(o))DG(s,o);else throw Error(Qy+o)}if(i.prototype=Un,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=$le,i.config=i.set=k6e,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return i.config(e),i}function k6e(e){if(!e||typeof e!="object")throw Error(Fh+"Object expected");var t,r,n,i=["precision",1,Qb,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<i.length;t+=3)if((n=e[r=i[t]])!==void 0)if(Jb(n)===n&&n>=i[t+1]&&n<=i[t+2])this[r]=n;else throw Error(Qy+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Qy+r+": "+n);return this}var RF=$le(A6e);Gd=new RF(1);const Ia=RF;function I6e(e){return $6e(e)||D6e(e)||L6e(e)||O6e()}function O6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function L6e(e,t){if(e){if(typeof e=="string")return N$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return N$(e,t)}}function D6e(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function $6e(e){if(Array.isArray(e))return N$(e)}function N$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var N6e=function(t){return t},Nle={"@@functional/placeholder":!0},jle=function(t){return t===Nle},NG=function(t){return function r(){return arguments.length===0||arguments.length===1&&jle(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},j6e=function e(t,r){return t===1?r:NG(function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];var s=i.filter(function(a){return a!==Nle}).length;return s>=t?r.apply(void 0,i):e(t-s,NG(function(){for(var a=arguments.length,u=new Array(a),d=0;d<a;d++)u[d]=arguments[d];var m=i.map(function(g){return jle(g)?u.shift():g});return r.apply(void 0,I6e(m).concat(u))}))})},hk=function(t){return j6e(t.length,t)},j$=function(t,r){for(var n=[],i=t;i<r;++i)n[i-t]=i;return n},R6e=hk(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),F6e=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return N6e;var i=r.reverse(),o=i[0],s=i.slice(1);return function(){return s.reduce(function(a,u){return u(a)},o.apply(void 0,arguments))}},R$=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},Rle=function(t){var r=null,n=null;return function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r&&o.every(function(a,u){return a===r[u]})||(r=o,n=t.apply(void 0,o)),n}};function z6e(e){var t;return e===0?t=1:t=Math.floor(new Ia(e).abs().log(10).toNumber())+1,t}function B6e(e,t,r){for(var n=new Ia(e),i=0,o=[];n.lt(t)&&i<1e5;)o.push(n.toNumber()),n=n.add(r),i++;return o}var U6e=hk(function(e,t,r){var n=+e,i=+t;return n+r*(i-n)}),V6e=hk(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),W6e=hk(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const fk={rangeStep:B6e,getDigitCount:z6e,interpolateNumber:U6e,uninterpolateNumber:V6e,uninterpolateTruncation:W6e};function F$(e){return H6e(e)||q6e(e)||Fle(e)||G6e()}function G6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function q6e(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function H6e(e){if(Array.isArray(e))return z$(e)}function MM(e,t){return X6e(e)||Z6e(e,t)||Fle(e,t)||K6e()}function K6e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fle(e,t){if(e){if(typeof e=="string")return z$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return z$(e,t)}}function z$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Z6e(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,i=!1,o=void 0;try{for(var s=e[Symbol.iterator](),a;!(n=(a=s.next()).done)&&(r.push(a.value),!(t&&r.length===t));n=!0);}catch(u){i=!0,o=u}finally{try{!n&&s.return!=null&&s.return()}finally{if(i)throw o}}return r}}function X6e(e){if(Array.isArray(e))return e}function zle(e){var t=MM(e,2),r=t[0],n=t[1],i=r,o=n;return r>n&&(i=n,o=r),[i,o]}function Ble(e,t,r){if(e.lte(0))return new Ia(0);var n=fk.getDigitCount(e.toNumber()),i=new Ia(10).pow(n),o=e.div(i),s=n!==1?.05:.1,a=new Ia(Math.ceil(o.div(s).toNumber())).add(r).mul(s),u=a.mul(i);return t?u:new Ia(Math.ceil(u))}function Y6e(e,t,r){var n=1,i=new Ia(e);if(!i.isint()&&r){var o=Math.abs(e);o<1?(n=new Ia(10).pow(fk.getDigitCount(e)-1),i=new Ia(Math.floor(i.div(n).toNumber())).mul(n)):o>1&&(i=new Ia(Math.floor(e)))}else e===0?i=new Ia(Math.floor((t-1)/2)):r||(i=new Ia(Math.floor(e)));var s=Math.floor((t-1)/2),a=F6e(R6e(function(u){return i.add(new Ia(u-s).mul(n)).toNumber()}),j$);return a(0,t)}function Ule(e,t,r,n){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new Ia(0),tickMin:new Ia(0),tickMax:new Ia(0)};var o=Ble(new Ia(t).sub(e).div(r-1),n,i),s;e<=0&&t>=0?s=new Ia(0):(s=new Ia(e).add(t).div(2),s=s.sub(new Ia(s).mod(o)));var a=Math.ceil(s.sub(e).div(o).toNumber()),u=Math.ceil(new Ia(t).sub(s).div(o).toNumber()),d=a+u+1;return d>r?Ule(e,t,r,n,i+1):(d<r&&(u=t>0?u+(r-d):u,a=t>0?a:a+(r-d)),{step:o,tickMin:s.sub(new Ia(a).mul(o)),tickMax:s.add(new Ia(u).mul(o))})}function Q6e(e){var t=MM(e,2),r=t[0],n=t[1],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=Math.max(i,2),a=zle([r,n]),u=MM(a,2),d=u[0],m=u[1];if(d===-1/0||m===1/0){var g=m===1/0?[d].concat(F$(j$(0,i-1).map(function(){return 1/0}))):[].concat(F$(j$(0,i-1).map(function(){return-1/0})),[m]);return r>n?R$(g):g}if(d===m)return Y6e(d,i,o);var _=Ule(d,m,s,o),y=_.step,M=_.tickMin,x=_.tickMax,E=fk.rangeStep(M,x.add(new Ia(.1).mul(y)),y);return r>n?R$(E):E}function J6e(e,t){var r=MM(e,2),n=r[0],i=r[1],o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=zle([n,i]),a=MM(s,2),u=a[0],d=a[1];if(u===-1/0||d===1/0)return[n,i];if(u===d)return[u];var m=Math.max(t,2),g=Ble(new Ia(d).sub(u).div(m-1),o,0),_=[].concat(F$(fk.rangeStep(new Ia(u),new Ia(d).sub(new Ia(.99).mul(g)),g)),[d]);return n>i?R$(_):_}var e8e=Rle(Q6e),t8e=Rle(J6e),r8e="Invariant failed";function v0(e,t){throw new Error(r8e)}var n8e=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function sb(e){"@babel/helpers - typeof";return sb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sb(e)}function dC(){return dC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dC.apply(this,arguments)}function i8e(e,t){return l8e(e)||s8e(e,t)||a8e(e,t)||o8e()}function o8e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function a8e(e,t){if(e){if(typeof e=="string")return jG(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jG(e,t)}}function jG(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s8e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],u=!0,d=!1;try{if(o=(r=r.call(e)).next,t!==0)for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);u=!0);}catch(m){d=!0,i=m}finally{try{if(!u&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw i}}return a}}function l8e(e){if(Array.isArray(e))return e}function c8e(e,t){if(e==null)return{};var r=u8e(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function u8e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function d8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h8e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Gle(n.key),n)}}function f8e(e,t,r){return t&&h8e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function p8e(e,t,r){return t=hC(t),m8e(e,Vle()?Reflect.construct(t,r||[],hC(e).constructor):t.apply(e,r))}function m8e(e,t){if(t&&(sb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return g8e(e)}function g8e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vle(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Vle=function(){return!!e})()}function hC(e){return hC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hC(e)}function _8e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&B$(e,t)}function B$(e,t){return B$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},B$(e,t)}function Wle(e,t,r){return t=Gle(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gle(e){var t=y8e(e,"string");return sb(t)=="symbol"?t:t+""}function y8e(e,t){if(sb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ES=function(e){function t(){return d8e(this,t),p8e(this,t,arguments)}return _8e(t,e),f8e(t,[{key:"render",value:function(){var n=this.props,i=n.offset,o=n.layout,s=n.width,a=n.dataKey,u=n.data,d=n.dataPointFormatter,m=n.xAxis,g=n.yAxis,_=c8e(n,n8e),y=ii(_,!1);this.props.direction==="x"&&m.type!=="number"&&v0();var M=u.map(function(x){var E=d(x,a),T=E.x,P=E.y,C=E.value,D=E.errorVal;if(!D)return null;var L=[],N,j;if(Array.isArray(D)){var $=i8e(D,2);N=$[0],j=$[1]}else N=j=D;if(o==="vertical"){var U=m.scale,G=P+i,H=G+s,X=G-s,ee=U(C-N),ae=U(C+j);L.push({x1:ae,y1:H,x2:ae,y2:X}),L.push({x1:ee,y1:G,x2:ae,y2:G}),L.push({x1:ee,y1:H,x2:ee,y2:X})}else if(o==="horizontal"){var de=g.scale,ye=T+i,_e=ye-s,ue=ye+s,fe=de(C-N),De=de(C+j);L.push({x1:_e,y1:De,x2:ue,y2:De}),L.push({x1:ye,y1:fe,x2:ye,y2:De}),L.push({x1:_e,y1:fe,x2:ue,y2:fe})}return ct.createElement($o,dC({className:"recharts-errorBar",key:"bar-".concat(L.map(function(pe){return"".concat(pe.x1,"-").concat(pe.x2,"-").concat(pe.y1,"-").concat(pe.y2)}))},y),L.map(function(pe){return ct.createElement("line",dC({},pe,{key:"line-".concat(pe.x1,"-").concat(pe.x2,"-").concat(pe.y1,"-").concat(pe.y2)}))}))});return ct.createElement($o,{className:"recharts-errorBars"},M)}}])}(ct.Component);Wle(ES,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});Wle(ES,"displayName","ErrorBar");function SM(e){"@babel/helpers - typeof";return SM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},SM(e)}function RG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function hy(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?RG(Object(r),!0).forEach(function(n){v8e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):RG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function v8e(e,t,r){return t=b8e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b8e(e){var t=x8e(e,"string");return SM(t)=="symbol"?t:t+""}function x8e(e,t){if(SM(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(SM(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qle=function(t){var r=t.children,n=t.formattedGraphicalItems,i=t.legendWidth,o=t.legendContent,s=Ud(r,w1);if(!s)return null;var a=w1.defaultProps,u=a!==void 0?hy(hy({},a),s.props):{},d;return s.props&&s.props.payload?d=s.props&&s.props.payload:o==="children"?d=(n||[]).reduce(function(m,g){var _=g.item,y=g.props,M=y.sectors||y.data||[];return m.concat(M.map(function(x){return{type:s.props.iconType||_.props.legendType,value:x.name,color:x.fill,payload:x}}))},[]):d=(n||[]).map(function(m){var g=m.item,_=g.type.defaultProps,y=_!==void 0?hy(hy({},_),g.props):{},M=y.dataKey,x=y.name,E=y.legendType,T=y.hide;return{inactive:T,dataKey:M,type:u.iconType||E||"square",color:FF(g),value:x||M,payload:y}}),hy(hy(hy({},u),w1.getWithHeight(s,i)),{},{payload:d,item:s})};function TM(e){"@babel/helpers - typeof";return TM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},TM(e)}function FG(e){return T8e(e)||S8e(e)||M8e(e)||w8e()}function w8e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function M8e(e,t){if(e){if(typeof e=="string")return U$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return U$(e,t)}}function S8e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function T8e(e){if(Array.isArray(e))return U$(e)}function U$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function cl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zG(Object(r),!0).forEach(function(n){T1(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function T1(e,t,r){return t=P8e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function P8e(e){var t=E8e(e,"string");return TM(t)=="symbol"?t:t+""}function E8e(e,t){if(TM(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(TM(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ol(e,t,r){return zi(e)||zi(t)?r:pc(t)?eh(e,t,r):Pi(t)?t(e):r}function v2(e,t,r,n){var i=S6e(e,function(a){return Ol(a,t)});if(r==="number"){var o=i.filter(function(a){return hn(a)||parseFloat(a)});return o.length?[dk(o),r_(o)]:[1/0,-1/0]}var s=n?i.filter(function(a){return!zi(a)}):i;return s.map(function(a){return pc(a)||a instanceof Date?a:""})}var A8e=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,s=-1,a=(r=n==null?void 0:n.length)!==null&&r!==void 0?r:0;if(a<=1)return 0;if(o&&o.axisType==="angleAxis"&&Math.abs(Math.abs(o.range[1]-o.range[0])-360)<=1e-6)for(var u=o.range,d=0;d<a;d++){var m=d>0?i[d-1].coordinate:i[a-1].coordinate,g=i[d].coordinate,_=d>=a-1?i[0].coordinate:i[d+1].coordinate,y=void 0;if(Uu(g-m)!==Uu(_-g)){var M=[];if(Uu(_-g)===Uu(u[1]-u[0])){y=_;var x=g+u[1]-u[0];M[0]=Math.min(x,(x+m)/2),M[1]=Math.max(x,(x+m)/2)}else{y=m;var E=_+u[1]-u[0];M[0]=Math.min(g,(E+g)/2),M[1]=Math.max(g,(E+g)/2)}var T=[Math.min(g,(y+g)/2),Math.max(g,(y+g)/2)];if(t>T[0]&&t<=T[1]||t>=M[0]&&t<=M[1]){s=i[d].index;break}}else{var P=Math.min(m,_),C=Math.max(m,_);if(t>(P+g)/2&&t<=(C+g)/2){s=i[d].index;break}}}else for(var D=0;D<a;D++)if(D===0&&t<=(n[D].coordinate+n[D+1].coordinate)/2||D>0&&D<a-1&&t>(n[D].coordinate+n[D-1].coordinate)/2&&t<=(n[D].coordinate+n[D+1].coordinate)/2||D===a-1&&t>(n[D].coordinate+n[D-1].coordinate)/2){s=n[D].index;break}return s},FF=function(t){var r,n=t,i=n.type.displayName,o=(r=t.type)!==null&&r!==void 0&&r.defaultProps?cl(cl({},t.type.defaultProps),t.props):t.props,s=o.stroke,a=o.fill,u;switch(i){case"Line":u=s;break;case"Area":case"Radar":u=s&&s!=="none"?s:a;break;default:u=a;break}return u},C8e=function(t){var r=t.barSize,n=t.totalSize,i=t.stackGroups,o=i===void 0?{}:i;if(!o)return{};for(var s={},a=Object.keys(o),u=0,d=a.length;u<d;u++)for(var m=o[a[u]].stackGroups,g=Object.keys(m),_=0,y=g.length;_<y;_++){var M=m[g[_]],x=M.items,E=M.cateAxisId,T=x.filter(function(j){return Rm(j.type).indexOf("Bar")>=0});if(T&&T.length){var P=T[0].type.defaultProps,C=P!==void 0?cl(cl({},P),T[0].props):T[0].props,D=C.barSize,L=C[E];s[L]||(s[L]=[]);var N=zi(D)?r:D;s[L].push({item:T[0],stackList:T.slice(1),barSize:zi(N)?void 0:Vu(N,n,0)})}}return s},k8e=function(t){var r=t.barGap,n=t.barCategoryGap,i=t.bandSize,o=t.sizeList,s=o===void 0?[]:o,a=t.maxBarSize,u=s.length;if(u<1)return null;var d=Vu(r,i,0,!0),m,g=[];if(s[0].barSize===+s[0].barSize){var _=!1,y=i/u,M=s.reduce(function(D,L){return D+L.barSize||0},0);M+=(u-1)*d,M>=i&&(M-=(u-1)*d,d=0),M>=i&&y>0&&(_=!0,y*=.9,M=u*y);var x=(i-M)/2>>0,E={offset:x-d,size:0};m=s.reduce(function(D,L){var N={item:L.item,position:{offset:E.offset+E.size+d,size:_?y:L.barSize}},j=[].concat(FG(D),[N]);return E=j[j.length-1].position,L.stackList&&L.stackList.length&&L.stackList.forEach(function($){j.push({item:$,position:E})}),j},g)}else{var T=Vu(n,i,0,!0);i-2*T-(u-1)*d<=0&&(d=0);var P=(i-2*T-(u-1)*d)/u;P>1&&(P>>=0);var C=a===+a?Math.min(P,a):P;m=s.reduce(function(D,L,N){var j=[].concat(FG(D),[{item:L.item,position:{offset:T+(P+d)*N+(P-C)/2,size:C}}]);return L.stackList&&L.stackList.length&&L.stackList.forEach(function($){j.push({item:$,position:j[j.length-1].position})}),j},g)}return m},I8e=function(t,r,n,i){var o=n.children,s=n.width,a=n.margin,u=s-(a.left||0)-(a.right||0),d=qle({children:o,legendWidth:u});if(d){var m=i||{},g=m.width,_=m.height,y=d.align,M=d.verticalAlign,x=d.layout;if((x==="vertical"||x==="horizontal"&&M==="middle")&&y!=="center"&&hn(t[y]))return cl(cl({},t),{},T1({},y,t[y]+(g||0)));if((x==="horizontal"||x==="vertical"&&y==="center")&&M!=="middle"&&hn(t[M]))return cl(cl({},t),{},T1({},M,t[M]+(_||0)))}return t},O8e=function(t,r,n){return zi(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},Hle=function(t,r,n,i,o){var s=r.props.children,a=th(s,ES).filter(function(d){return O8e(i,o,d.props.direction)});if(a&&a.length){var u=a.map(function(d){return d.props.dataKey});return t.reduce(function(d,m){var g=Ol(m,n);if(zi(g))return d;var _=Array.isArray(g)?[dk(g),r_(g)]:[g,g],y=u.reduce(function(M,x){var E=Ol(m,x,0),T=_[0]-Math.abs(Array.isArray(E)?E[0]:E),P=_[1]+Math.abs(Array.isArray(E)?E[1]:E);return[Math.min(T,M[0]),Math.max(P,M[1])]},[1/0,-1/0]);return[Math.min(y[0],d[0]),Math.max(y[1],d[1])]},[1/0,-1/0])}return null},L8e=function(t,r,n,i,o){var s=r.map(function(a){return Hle(t,a,n,o,i)}).filter(function(a){return!zi(a)});return s&&s.length?s.reduce(function(a,u){return[Math.min(a[0],u[0]),Math.max(a[1],u[1])]},[1/0,-1/0]):null},Kle=function(t,r,n,i,o){var s=r.map(function(u){var d=u.props.dataKey;return n==="number"&&d&&Hle(t,u,d,i)||v2(t,d,n,o)});if(n==="number")return s.reduce(function(u,d){return[Math.min(u[0],d[0]),Math.max(u[1],d[1])]},[1/0,-1/0]);var a={};return s.reduce(function(u,d){for(var m=0,g=d.length;m<g;m++)a[d[m]]||(a[d[m]]=!0,u.push(d[m]));return u},[])},Zle=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},Xle=function(t,r,n,i){if(i)return t.map(function(u){return u.coordinate});var o,s,a=t.map(function(u){return u.coordinate===r&&(o=!0),u.coordinate===n&&(s=!0),u.coordinate});return o||a.push(r),s||a.push(n),a},$m=function(t,r,n){if(!t)return null;var i=t.scale,o=t.duplicateDomain,s=t.type,a=t.range,u=t.realScaleType==="scaleBand"?i.bandwidth()/2:2,d=(r||n)&&s==="category"&&i.bandwidth?i.bandwidth()/u:0;if(d=t.axisType==="angleAxis"&&(a==null?void 0:a.length)>=2?Uu(a[0]-a[1])*2*d:d,r&&(t.ticks||t.niceTicks)){var m=(t.ticks||t.niceTicks).map(function(g){var _=o?o.indexOf(g):g;return{coordinate:i(_)+d,value:g,offset:d}});return m.filter(function(g){return!Hb(g.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(g,_){return{coordinate:i(g)+d,value:g,index:_,offset:d}}):i.ticks&&!n?i.ticks(t.tickCount).map(function(g){return{coordinate:i(g)+d,value:g,offset:d}}):i.domain().map(function(g,_){return{coordinate:i(g)+d,value:o?o[g]:g,index:_,offset:d}})},bO=new WeakMap,GP=function(t,r){if(typeof r!="function")return t;bO.has(t)||bO.set(t,new WeakMap);var n=bO.get(t);if(n.has(r))return n.get(r);var i=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,i),i},Yle=function(t,r,n){var i=t.scale,o=t.type,s=t.layout,a=t.axisType;if(i==="auto")return s==="radial"&&a==="radiusAxis"?{scale:_M(),realScaleType:"band"}:s==="radial"&&a==="angleAxis"?{scale:aC(),realScaleType:"linear"}:o==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:y2(),realScaleType:"point"}:o==="category"?{scale:_M(),realScaleType:"band"}:{scale:aC(),realScaleType:"linear"};if(p0(i)){var u="scale".concat(Y5(i));return{scale:(LG[u]||y2)(),realScaleType:LG[u]?u:"point"}}return Pi(i)?{scale:i}:{scale:y2(),realScaleType:"point"}},BG=1e-4,Qle=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,i=t.range(),o=Math.min(i[0],i[1])-BG,s=Math.max(i[0],i[1])+BG,a=t(r[0]),u=t(r[n-1]);(a<o||a>s||u<o||u>s)&&t.domain([r[0],r[n-1]])}},D8e=function(t,r){if(!t)return null;for(var n=0,i=t.length;n<i;n++)if(t[n].item===r)return t[n].position;return null},$8e=function(t,r){if(!r||r.length!==2||!hn(r[0])||!hn(r[1]))return t;var n=Math.min(r[0],r[1]),i=Math.max(r[0],r[1]),o=[t[0],t[1]];return(!hn(t[0])||t[0]<n)&&(o[0]=n),(!hn(t[1])||t[1]>i)&&(o[1]=i),o[0]>i&&(o[0]=i),o[1]<n&&(o[1]=n),o},N8e=function(t){var r=t.length;if(!(r<=0))for(var n=0,i=t[0].length;n<i;++n)for(var o=0,s=0,a=0;a<r;++a){var u=Hb(t[a][n][1])?t[a][n][0]:t[a][n][1];u>=0?(t[a][n][0]=o,t[a][n][1]=o+u,o=t[a][n][1]):(t[a][n][0]=s,t[a][n][1]=s+u,s=t[a][n][1])}},j8e=function(t){var r=t.length;if(!(r<=0))for(var n=0,i=t[0].length;n<i;++n)for(var o=0,s=0;s<r;++s){var a=Hb(t[s][n][1])?t[s][n][0]:t[s][n][1];a>=0?(t[s][n][0]=o,t[s][n][1]=o+a,o=t[s][n][1]):(t[s][n][0]=0,t[s][n][1]=0)}},R8e={sign:N8e,expand:n3e,none:J1,silhouette:i3e,wiggle:o3e,positive:j8e},F8e=function(t,r,n){var i=r.map(function(a){return a.props.dataKey}),o=R8e[n],s=r3e().keys(i).value(function(a,u){return+Ol(a,u,0)}).order(f$).offset(o);return s(t)},z8e=function(t,r,n,i,o,s){if(!t)return null;var a=s?r.reverse():r,u={},d=a.reduce(function(g,_){var y,M=(y=_.type)!==null&&y!==void 0&&y.defaultProps?cl(cl({},_.type.defaultProps),_.props):_.props,x=M.stackId,E=M.hide;if(E)return g;var T=M[n],P=g[T]||{hasStack:!1,stackGroups:{}};if(pc(x)){var C=P.stackGroups[x]||{numericAxisId:n,cateAxisId:i,items:[]};C.items.push(_),P.hasStack=!0,P.stackGroups[x]=C}else P.stackGroups[N0("_stackId_")]={numericAxisId:n,cateAxisId:i,items:[_]};return cl(cl({},g),{},T1({},T,P))},u),m={};return Object.keys(d).reduce(function(g,_){var y=d[_];if(y.hasStack){var M={};y.stackGroups=Object.keys(y.stackGroups).reduce(function(x,E){var T=y.stackGroups[E];return cl(cl({},x),{},T1({},E,{numericAxisId:n,cateAxisId:i,items:T.items,stackedData:F8e(t,T.items,o)}))},M)}return cl(cl({},g),{},T1({},_,y))},m)},Jle=function(t,r){var n=r.realScaleType,i=r.type,o=r.tickCount,s=r.originalDomain,a=r.allowDecimals,u=n||r.scale;if(u!=="auto"&&u!=="linear")return null;if(o&&i==="number"&&s&&(s[0]==="auto"||s[1]==="auto")){var d=t.domain();if(!d.length)return null;var m=e8e(d,o,a);return t.domain([dk(m),r_(m)]),{niceTicks:m}}if(o&&i==="number"){var g=t.domain(),_=t8e(g,o,a);return{niceTicks:_}}return null};function fC(e){var t=e.axis,r=e.ticks,n=e.bandSize,i=e.entry,o=e.index,s=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!zi(i[t.dataKey])){var a=FA(r,"value",i[t.dataKey]);if(a)return a.coordinate+n/2}return r[o]?r[o].coordinate+n/2:null}var u=Ol(i,zi(s)?t.dataKey:s);return zi(u)?null:t.scale(u)}var UG=function(t){var r=t.axis,n=t.ticks,i=t.offset,o=t.bandSize,s=t.entry,a=t.index;if(r.type==="category")return n[a]?n[a].coordinate+i:null;var u=Ol(s,r.dataKey,r.domain[a]);return zi(u)?null:r.scale(u)-o/2+i},B8e=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var i=Math.min(n[0],n[1]),o=Math.max(n[0],n[1]);return i<=0&&o>=0?0:o<0?o:i}return n[0]},U8e=function(t,r){var n,i=(n=t.type)!==null&&n!==void 0&&n.defaultProps?cl(cl({},t.type.defaultProps),t.props):t.props,o=i.stackId;if(pc(o)){var s=r[o];if(s){var a=s.items.indexOf(t);return a>=0?s.stackedData[a]:null}}return null},V8e=function(t){return t.reduce(function(r,n){return[dk(n.concat([r[0]]).filter(hn)),r_(n.concat([r[1]]).filter(hn))]},[1/0,-1/0])},ece=function(t,r,n){return Object.keys(t).reduce(function(i,o){var s=t[o],a=s.stackedData,u=a.reduce(function(d,m){var g=V8e(m.slice(r,n+1));return[Math.min(d[0],g[0]),Math.max(d[1],g[1])]},[1/0,-1/0]);return[Math.min(u[0],i[0]),Math.max(u[1],i[1])]},[1/0,-1/0]).map(function(i){return i===1/0||i===-1/0?0:i})},VG=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,WG=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,V$=function(t,r,n){if(Pi(t))return t(r,n);if(!Array.isArray(t))return r;var i=[];if(hn(t[0]))i[0]=n?t[0]:Math.min(t[0],r[0]);else if(VG.test(t[0])){var o=+VG.exec(t[0])[1];i[0]=r[0]-o}else Pi(t[0])?i[0]=t[0](r[0]):i[0]=r[0];if(hn(t[1]))i[1]=n?t[1]:Math.max(t[1],r[1]);else if(WG.test(t[1])){var s=+WG.exec(t[1])[1];i[1]=r[1]+s}else Pi(t[1])?i[1]=t[1](r[1]):i[1]=r[1];return i},pC=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var i=t.scale.bandwidth();if(!n||i>0)return i}if(t&&r&&r.length>=2){for(var o=fF(r,function(g){return g.coordinate}),s=1/0,a=1,u=o.length;a<u;a++){var d=o[a],m=o[a-1];s=Math.min((d.coordinate||0)-(m.coordinate||0),s)}return s===1/0?0:s}return n?void 0:0},GG=function(t,r,n){return!t||!t.length||_0(t,eh(n,"type.defaultProps.domain"))?r:t},tce=function(t,r){var n=t.type.defaultProps?cl(cl({},t.type.defaultProps),t.props):t.props,i=n.dataKey,o=n.name,s=n.unit,a=n.formatter,u=n.tooltipType,d=n.chartType,m=n.hide;return cl(cl({},ii(t,!1)),{},{dataKey:i,unit:s,formatter:a,name:o||i,color:FF(t),value:Ol(r,i),type:u,payload:r,chartType:d,hide:m})};function PM(e){"@babel/helpers - typeof";return PM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},PM(e)}function qG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Tm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qG(Object(r),!0).forEach(function(n){rce(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rce(e,t,r){return t=W8e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function W8e(e){var t=G8e(e,"string");return PM(t)=="symbol"?t:t+""}function G8e(e,t){if(PM(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(PM(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function q8e(e,t){return X8e(e)||Z8e(e,t)||K8e(e,t)||H8e()}function H8e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function K8e(e,t){if(e){if(typeof e=="string")return HG(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HG(e,t)}}function HG(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Z8e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],u=!0,d=!1;try{if(o=(r=r.call(e)).next,t!==0)for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);u=!0);}catch(m){d=!0,i=m}finally{try{if(!u&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw i}}return a}}function X8e(e){if(Array.isArray(e))return e}var mC=Math.PI/180,Y8e=function(t){return t*180/Math.PI},ns=function(t,r,n,i){return{x:t+Math.cos(-mC*i)*n,y:r+Math.sin(-mC*i)*n}},nce=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},Q8e=function(t,r,n,i,o){var s=t.width,a=t.height,u=t.startAngle,d=t.endAngle,m=Vu(t.cx,s,s/2),g=Vu(t.cy,a,a/2),_=nce(s,a,n),y=Vu(t.innerRadius,_,0),M=Vu(t.outerRadius,_,_*.8),x=Object.keys(r);return x.reduce(function(E,T){var P=r[T],C=P.domain,D=P.reversed,L;if(zi(P.range))i==="angleAxis"?L=[u,d]:i==="radiusAxis"&&(L=[y,M]),D&&(L=[L[1],L[0]]);else{L=P.range;var N=L,j=q8e(N,2);u=j[0],d=j[1]}var $=Yle(P,o),U=$.realScaleType,G=$.scale;G.domain(C).range(L),Qle(G);var H=Jle(G,Tm(Tm({},P),{},{realScaleType:U})),X=Tm(Tm(Tm({},P),H),{},{range:L,radius:M,realScaleType:U,scale:G,cx:m,cy:g,innerRadius:y,outerRadius:M,startAngle:u,endAngle:d});return Tm(Tm({},E),{},rce({},T,X))},{})},J8e=function(t,r){var n=t.x,i=t.y,o=r.x,s=r.y;return Math.sqrt(Math.pow(n-o,2)+Math.pow(i-s,2))},eUe=function(t,r){var n=t.x,i=t.y,o=r.cx,s=r.cy,a=J8e({x:n,y:i},{x:o,y:s});if(a<=0)return{radius:a};var u=(n-o)/a,d=Math.acos(u);return i>s&&(d=2*Math.PI-d),{radius:a,angle:Y8e(d),angleInRadian:d}},tUe=function(t){var r=t.startAngle,n=t.endAngle,i=Math.floor(r/360),o=Math.floor(n/360),s=Math.min(i,o);return{startAngle:r-s*360,endAngle:n-s*360}},rUe=function(t,r){var n=r.startAngle,i=r.endAngle,o=Math.floor(n/360),s=Math.floor(i/360),a=Math.min(o,s);return t+a*360},KG=function(t,r){var n=t.x,i=t.y,o=eUe({x:n,y:i},r),s=o.radius,a=o.angle,u=r.innerRadius,d=r.outerRadius;if(s<u||s>d)return!1;if(s===0)return!0;var m=tUe(r),g=m.startAngle,_=m.endAngle,y=a,M;if(g<=_){for(;y>_;)y-=360;for(;y<g;)y+=360;M=y>=g&&y<=_}else{for(;y>g;)y-=360;for(;y<_;)y+=360;M=y>=_&&y<=g}return M?Tm(Tm({},r),{},{radius:s,angle:rUe(y,r)}):null},ice=function(t){return!oe.isValidElement(t)&&!Pi(t)&&typeof t!="boolean"?t.className:""};function EM(e){"@babel/helpers - typeof";return EM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},EM(e)}var nUe=["offset"];function iUe(e){return lUe(e)||sUe(e)||aUe(e)||oUe()}function oUe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aUe(e,t){if(e){if(typeof e=="string")return W$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return W$(e,t)}}function sUe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function lUe(e){if(Array.isArray(e))return W$(e)}function W$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cUe(e,t){if(e==null)return{};var r=uUe(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function uUe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function ZG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function uc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZG(Object(r),!0).forEach(function(n){dUe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dUe(e,t,r){return t=hUe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hUe(e){var t=fUe(e,"string");return EM(t)=="symbol"?t:t+""}function fUe(e,t){if(EM(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(EM(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function AM(){return AM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},AM.apply(this,arguments)}var pUe=function(t){var r=t.value,n=t.formatter,i=zi(t.children)?r:t.children;return Pi(n)?n(i):i},mUe=function(t,r){var n=Uu(r-t),i=Math.min(Math.abs(r-t),360);return n*i},gUe=function(t,r,n){var i=t.position,o=t.viewBox,s=t.offset,a=t.className,u=o,d=u.cx,m=u.cy,g=u.innerRadius,_=u.outerRadius,y=u.startAngle,M=u.endAngle,x=u.clockWise,E=(g+_)/2,T=mUe(y,M),P=T>=0?1:-1,C,D;i==="insideStart"?(C=y+P*s,D=x):i==="insideEnd"?(C=M-P*s,D=!x):i==="end"&&(C=M+P*s,D=x),D=T<=0?D:!D;var L=ns(d,m,E,C),N=ns(d,m,E,C+(D?1:-1)*359),j="M".concat(L.x,",").concat(L.y,`
    A`).concat(E,",").concat(E,",0,1,").concat(D?0:1,`,
    `).concat(N.x,",").concat(N.y),$=zi(t.id)?N0("recharts-radial-line-"):t.id;return ct.createElement("text",AM({},n,{dominantBaseline:"central",className:Wi("recharts-radial-bar-label",a)}),ct.createElement("defs",null,ct.createElement("path",{id:$,d:j})),ct.createElement("textPath",{xlinkHref:"#".concat($)},r))},_Ue=function(t){var r=t.viewBox,n=t.offset,i=t.position,o=r,s=o.cx,a=o.cy,u=o.innerRadius,d=o.outerRadius,m=o.startAngle,g=o.endAngle,_=(m+g)/2;if(i==="outside"){var y=ns(s,a,d+n,_),M=y.x,x=y.y;return{x:M,y:x,textAnchor:M>=s?"start":"end",verticalAnchor:"middle"}}if(i==="center")return{x:s,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(i==="centerTop")return{x:s,y:a,textAnchor:"middle",verticalAnchor:"start"};if(i==="centerBottom")return{x:s,y:a,textAnchor:"middle",verticalAnchor:"end"};var E=(u+d)/2,T=ns(s,a,E,_),P=T.x,C=T.y;return{x:P,y:C,textAnchor:"middle",verticalAnchor:"middle"}},yUe=function(t){var r=t.viewBox,n=t.parentViewBox,i=t.offset,o=t.position,s=r,a=s.x,u=s.y,d=s.width,m=s.height,g=m>=0?1:-1,_=g*i,y=g>0?"end":"start",M=g>0?"start":"end",x=d>=0?1:-1,E=x*i,T=x>0?"end":"start",P=x>0?"start":"end";if(o==="top"){var C={x:a+d/2,y:u-g*i,textAnchor:"middle",verticalAnchor:y};return uc(uc({},C),n?{height:Math.max(u-n.y,0),width:d}:{})}if(o==="bottom"){var D={x:a+d/2,y:u+m+_,textAnchor:"middle",verticalAnchor:M};return uc(uc({},D),n?{height:Math.max(n.y+n.height-(u+m),0),width:d}:{})}if(o==="left"){var L={x:a-E,y:u+m/2,textAnchor:T,verticalAnchor:"middle"};return uc(uc({},L),n?{width:Math.max(L.x-n.x,0),height:m}:{})}if(o==="right"){var N={x:a+d+E,y:u+m/2,textAnchor:P,verticalAnchor:"middle"};return uc(uc({},N),n?{width:Math.max(n.x+n.width-N.x,0),height:m}:{})}var j=n?{width:d,height:m}:{};return o==="insideLeft"?uc({x:a+E,y:u+m/2,textAnchor:P,verticalAnchor:"middle"},j):o==="insideRight"?uc({x:a+d-E,y:u+m/2,textAnchor:T,verticalAnchor:"middle"},j):o==="insideTop"?uc({x:a+d/2,y:u+_,textAnchor:"middle",verticalAnchor:M},j):o==="insideBottom"?uc({x:a+d/2,y:u+m-_,textAnchor:"middle",verticalAnchor:y},j):o==="insideTopLeft"?uc({x:a+E,y:u+_,textAnchor:P,verticalAnchor:M},j):o==="insideTopRight"?uc({x:a+d-E,y:u+_,textAnchor:T,verticalAnchor:M},j):o==="insideBottomLeft"?uc({x:a+E,y:u+m-_,textAnchor:P,verticalAnchor:y},j):o==="insideBottomRight"?uc({x:a+d-E,y:u+m-_,textAnchor:T,verticalAnchor:y},j):Vb(o)&&(hn(o.x)||Ly(o.x))&&(hn(o.y)||Ly(o.y))?uc({x:a+Vu(o.x,d),y:u+Vu(o.y,m),textAnchor:"end",verticalAnchor:"end"},j):uc({x:a+d/2,y:u+m/2,textAnchor:"middle",verticalAnchor:"middle"},j)},vUe=function(t){return"cx"in t&&hn(t.cx)};function Rc(e){var t=e.offset,r=t===void 0?5:t,n=cUe(e,nUe),i=uc({offset:r},n),o=i.viewBox,s=i.position,a=i.value,u=i.children,d=i.content,m=i.className,g=m===void 0?"":m,_=i.textBreakAll;if(!o||zi(a)&&zi(u)&&!oe.isValidElement(d)&&!Pi(d))return null;if(oe.isValidElement(d))return oe.cloneElement(d,i);var y;if(Pi(d)){if(y=oe.createElement(d,i),oe.isValidElement(y))return y}else y=pUe(i);var M=vUe(o),x=ii(i,!0);if(M&&(s==="insideStart"||s==="insideEnd"||s==="end"))return gUe(i,y,x);var E=M?_Ue(i):yUe(i);return ct.createElement(g0,AM({className:Wi("recharts-label",g)},x,E,{breakAll:_}),y)}Rc.displayName="Label";var oce=function(t){var r=t.cx,n=t.cy,i=t.angle,o=t.startAngle,s=t.endAngle,a=t.r,u=t.radius,d=t.innerRadius,m=t.outerRadius,g=t.x,_=t.y,y=t.top,M=t.left,x=t.width,E=t.height,T=t.clockWise,P=t.labelViewBox;if(P)return P;if(hn(x)&&hn(E)){if(hn(g)&&hn(_))return{x:g,y:_,width:x,height:E};if(hn(y)&&hn(M))return{x:y,y:M,width:x,height:E}}return hn(g)&&hn(_)?{x:g,y:_,width:0,height:0}:hn(r)&&hn(n)?{cx:r,cy:n,startAngle:o||i||0,endAngle:s||i||0,innerRadius:d||0,outerRadius:m||u||a||0,clockWise:T}:t.viewBox?t.viewBox:{}},bUe=function(t,r){return t?t===!0?ct.createElement(Rc,{key:"label-implicit",viewBox:r}):pc(t)?ct.createElement(Rc,{key:"label-implicit",viewBox:r,value:t}):oe.isValidElement(t)?t.type===Rc?oe.cloneElement(t,{key:"label-implicit",viewBox:r}):ct.createElement(Rc,{key:"label-implicit",content:t,viewBox:r}):Pi(t)?ct.createElement(Rc,{key:"label-implicit",content:t,viewBox:r}):Vb(t)?ct.createElement(Rc,AM({viewBox:r},t,{key:"label-implicit"})):null:null},xUe=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var i=t.children,o=oce(t),s=th(i,Rc).map(function(u,d){return oe.cloneElement(u,{viewBox:r||o,key:"label-".concat(d)})});if(!n)return s;var a=bUe(t.label,r||o);return[a].concat(iUe(s))};Rc.parseViewBox=oce;Rc.renderCallByParent=xUe;function wUe(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var MUe=wUe;const SUe=sa(MUe);function CM(e){"@babel/helpers - typeof";return CM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},CM(e)}var TUe=["valueAccessor"],PUe=["data","dataKey","clockWise","id","textBreakAll"];function EUe(e){return IUe(e)||kUe(e)||CUe(e)||AUe()}function AUe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CUe(e,t){if(e){if(typeof e=="string")return G$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return G$(e,t)}}function kUe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function IUe(e){if(Array.isArray(e))return G$(e)}function G$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function gC(){return gC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gC.apply(this,arguments)}function XG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function YG(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?XG(Object(r),!0).forEach(function(n){OUe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):XG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function OUe(e,t,r){return t=LUe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LUe(e){var t=DUe(e,"string");return CM(t)=="symbol"?t:t+""}function DUe(e,t){if(CM(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(CM(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function QG(e,t){if(e==null)return{};var r=$Ue(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function $Ue(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var NUe=function(t){return Array.isArray(t.value)?SUe(t.value):t.value};function Up(e){var t=e.valueAccessor,r=t===void 0?NUe:t,n=QG(e,TUe),i=n.data,o=n.dataKey,s=n.clockWise,a=n.id,u=n.textBreakAll,d=QG(n,PUe);return!i||!i.length?null:ct.createElement($o,{className:"recharts-label-list"},i.map(function(m,g){var _=zi(o)?r(m,g):Ol(m&&m.payload,o),y=zi(a)?{}:{id:"".concat(a,"-").concat(g)};return ct.createElement(Rc,gC({},ii(m,!0),d,y,{parentViewBox:m.parentViewBox,value:_,textBreakAll:u,viewBox:Rc.parseViewBox(zi(s)?m:YG(YG({},m),{},{clockWise:s})),key:"label-".concat(g),index:g}))}))}Up.displayName="LabelList";function jUe(e,t){return e?e===!0?ct.createElement(Up,{key:"labelList-implicit",data:t}):ct.isValidElement(e)||Pi(e)?ct.createElement(Up,{key:"labelList-implicit",data:t,content:e}):Vb(e)?ct.createElement(Up,gC({data:t},e,{key:"labelList-implicit"})):null:null}function RUe(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,i=th(n,Up).map(function(s,a){return oe.cloneElement(s,{data:t,key:"labelList-".concat(a)})});if(!r)return i;var o=jUe(e.label,t);return[o].concat(EUe(i))}Up.renderCallByParent=RUe;function kM(e){"@babel/helpers - typeof";return kM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kM(e)}function q$(){return q$=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},q$.apply(this,arguments)}function JG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function eq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?JG(Object(r),!0).forEach(function(n){FUe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):JG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function FUe(e,t,r){return t=zUe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zUe(e){var t=BUe(e,"string");return kM(t)=="symbol"?t:t+""}function BUe(e,t){if(kM(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kM(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var UUe=function(t,r){var n=Uu(r-t),i=Math.min(Math.abs(r-t),359.999);return n*i},qP=function(t){var r=t.cx,n=t.cy,i=t.radius,o=t.angle,s=t.sign,a=t.isExternal,u=t.cornerRadius,d=t.cornerIsExternal,m=u*(a?1:-1)+i,g=Math.asin(u/m)/mC,_=d?o:o+s*g,y=ns(r,n,m,_),M=ns(r,n,i,_),x=d?o-s*g:o,E=ns(r,n,m*Math.cos(g*mC),x);return{center:y,circleTangency:M,lineTangency:E,theta:g}},ace=function(t){var r=t.cx,n=t.cy,i=t.innerRadius,o=t.outerRadius,s=t.startAngle,a=t.endAngle,u=UUe(s,a),d=s+u,m=ns(r,n,o,s),g=ns(r,n,o,d),_="M ".concat(m.x,",").concat(m.y,`
    A `).concat(o,",").concat(o,`,0,
    `).concat(+(Math.abs(u)>180),",").concat(+(s>d),`,
    `).concat(g.x,",").concat(g.y,`
  `);if(i>0){var y=ns(r,n,i,s),M=ns(r,n,i,d);_+="L ".concat(M.x,",").concat(M.y,`
            A `).concat(i,",").concat(i,`,0,
            `).concat(+(Math.abs(u)>180),",").concat(+(s<=d),`,
            `).concat(y.x,",").concat(y.y," Z")}else _+="L ".concat(r,",").concat(n," Z");return _},VUe=function(t){var r=t.cx,n=t.cy,i=t.innerRadius,o=t.outerRadius,s=t.cornerRadius,a=t.forceCornerRadius,u=t.cornerIsExternal,d=t.startAngle,m=t.endAngle,g=Uu(m-d),_=qP({cx:r,cy:n,radius:o,angle:d,sign:g,cornerRadius:s,cornerIsExternal:u}),y=_.circleTangency,M=_.lineTangency,x=_.theta,E=qP({cx:r,cy:n,radius:o,angle:m,sign:-g,cornerRadius:s,cornerIsExternal:u}),T=E.circleTangency,P=E.lineTangency,C=E.theta,D=u?Math.abs(d-m):Math.abs(d-m)-x-C;if(D<0)return a?"M ".concat(M.x,",").concat(M.y,`
        a`).concat(s,",").concat(s,",0,0,1,").concat(s*2,`,0
        a`).concat(s,",").concat(s,",0,0,1,").concat(-s*2,`,0
      `):ace({cx:r,cy:n,innerRadius:i,outerRadius:o,startAngle:d,endAngle:m});var L="M ".concat(M.x,",").concat(M.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(g<0),",").concat(y.x,",").concat(y.y,`
    A`).concat(o,",").concat(o,",0,").concat(+(D>180),",").concat(+(g<0),",").concat(T.x,",").concat(T.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(g<0),",").concat(P.x,",").concat(P.y,`
  `);if(i>0){var N=qP({cx:r,cy:n,radius:i,angle:d,sign:g,isExternal:!0,cornerRadius:s,cornerIsExternal:u}),j=N.circleTangency,$=N.lineTangency,U=N.theta,G=qP({cx:r,cy:n,radius:i,angle:m,sign:-g,isExternal:!0,cornerRadius:s,cornerIsExternal:u}),H=G.circleTangency,X=G.lineTangency,ee=G.theta,ae=u?Math.abs(d-m):Math.abs(d-m)-U-ee;if(ae<0&&s===0)return"".concat(L,"L").concat(r,",").concat(n,"Z");L+="L".concat(X.x,",").concat(X.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(g<0),",").concat(H.x,",").concat(H.y,`
      A`).concat(i,",").concat(i,",0,").concat(+(ae>180),",").concat(+(g>0),",").concat(j.x,",").concat(j.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(g<0),",").concat($.x,",").concat($.y,"Z")}else L+="L".concat(r,",").concat(n,"Z");return L},WUe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},sce=function(t){var r=eq(eq({},WUe),t),n=r.cx,i=r.cy,o=r.innerRadius,s=r.outerRadius,a=r.cornerRadius,u=r.forceCornerRadius,d=r.cornerIsExternal,m=r.startAngle,g=r.endAngle,_=r.className;if(s<o||m===g)return null;var y=Wi("recharts-sector",_),M=s-o,x=Vu(a,M,0,!0),E;return x>0&&Math.abs(m-g)<360?E=VUe({cx:n,cy:i,innerRadius:o,outerRadius:s,cornerRadius:Math.min(x,M/2),forceCornerRadius:u,cornerIsExternal:d,startAngle:m,endAngle:g}):E=ace({cx:n,cy:i,innerRadius:o,outerRadius:s,startAngle:m,endAngle:g}),ct.createElement("path",q$({},ii(r,!0),{className:y,d:E,role:"img"}))};function IM(e){"@babel/helpers - typeof";return IM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},IM(e)}function H$(){return H$=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},H$.apply(this,arguments)}function tq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function rq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tq(Object(r),!0).forEach(function(n){GUe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GUe(e,t,r){return t=qUe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qUe(e){var t=HUe(e,"string");return IM(t)=="symbol"?t:t+""}function HUe(e,t){if(IM(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(IM(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nq={curveBasisClosed:GIe,curveBasisOpen:qIe,curveBasis:WIe,curveBumpX:kIe,curveBumpY:IIe,curveLinearClosed:HIe,curveLinear:J5,curveMonotoneX:KIe,curveMonotoneY:ZIe,curveNatural:XIe,curveStep:YIe,curveStepAfter:JIe,curveStepBefore:QIe},HP=function(t){return t.x===+t.x&&t.y===+t.y},Lw=function(t){return t.x},Dw=function(t){return t.y},KUe=function(t,r){if(Pi(t))return t;var n="curve".concat(Y5(t));return(n==="curveMonotone"||n==="curveBump")&&r?nq["".concat(n).concat(r==="vertical"?"Y":"X")]:nq[n]||J5},ZUe=function(t){var r=t.type,n=r===void 0?"linear":r,i=t.points,o=i===void 0?[]:i,s=t.baseLine,a=t.layout,u=t.connectNulls,d=u===void 0?!1:u,m=KUe(n,a),g=d?o.filter(function(x){return HP(x)}):o,_;if(Array.isArray(s)){var y=d?s.filter(function(x){return HP(x)}):s,M=g.map(function(x,E){return rq(rq({},x),{},{base:y[E]})});return a==="vertical"?_=jP().y(Dw).x1(Lw).x0(function(x){return x.base.x}):_=jP().x(Lw).y1(Dw).y0(function(x){return x.base.y}),_.defined(HP).curve(m),_(M)}return a==="vertical"&&hn(s)?_=jP().y(Dw).x1(Lw).x0(s):hn(s)?_=jP().x(Lw).y1(Dw).y0(s):_=tse().x(Lw).y(Dw),_.defined(HP).curve(m),_(g)},Jy=function(t){var r=t.className,n=t.points,i=t.path,o=t.pathRef;if((!n||!n.length)&&!i)return null;var s=n&&n.length?ZUe(t):i;return oe.createElement("path",H$({},ii(t,!1),zA(t),{className:Wi("recharts-curve",r),d:s,ref:o}))},lce={exports:{}},XUe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",YUe=XUe,QUe=YUe;function cce(){}function uce(){}uce.resetWarningCache=cce;var JUe=function(){function e(n,i,o,s,a,u){if(u!==QUe){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:uce,resetWarningCache:cce};return r.PropTypes=r,r};lce.exports=JUe();var eVe=lce.exports;const va=sa(eVe);var tVe=Object.getOwnPropertyNames,rVe=Object.getOwnPropertySymbols,nVe=Object.prototype.hasOwnProperty;function iq(e,t){return function(n,i,o){return e(n,i,o)&&t(n,i,o)}}function KP(e){return function(r,n,i){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,i);var o=i.cache,s=o.get(r),a=o.get(n);if(s&&a)return s===n&&a===r;o.set(r,n),o.set(n,r);var u=e(r,n,i);return o.delete(r),o.delete(n),u}}function oq(e){return tVe(e).concat(rVe(e))}var iVe=Object.hasOwn||function(e,t){return nVe.call(e,t)};function F0(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var oVe="__v",aVe="__o",sVe="_owner",aq=Object.getOwnPropertyDescriptor,sq=Object.keys;function lVe(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function cVe(e,t){return F0(e.getTime(),t.getTime())}function uVe(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function dVe(e,t){return e===t}function lq(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var i=new Array(n),o=e.entries(),s,a,u=0;(s=o.next())&&!s.done;){for(var d=t.entries(),m=!1,g=0;(a=d.next())&&!a.done;){if(i[g]){g++;continue}var _=s.value,y=a.value;if(r.equals(_[0],y[0],u,g,e,t,r)&&r.equals(_[1],y[1],_[0],y[0],e,t,r)){m=i[g]=!0;break}g++}if(!m)return!1;u++}return!0}var hVe=F0;function fVe(e,t,r){var n=sq(e),i=n.length;if(sq(t).length!==i)return!1;for(;i-- >0;)if(!dce(e,t,r,n[i]))return!1;return!0}function $w(e,t,r){var n=oq(e),i=n.length;if(oq(t).length!==i)return!1;for(var o,s,a;i-- >0;)if(o=n[i],!dce(e,t,r,o)||(s=aq(e,o),a=aq(t,o),(s||a)&&(!s||!a||s.configurable!==a.configurable||s.enumerable!==a.enumerable||s.writable!==a.writable)))return!1;return!0}function pVe(e,t){return F0(e.valueOf(),t.valueOf())}function mVe(e,t){return e.source===t.source&&e.flags===t.flags}function cq(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var i=new Array(n),o=e.values(),s,a;(s=o.next())&&!s.done;){for(var u=t.values(),d=!1,m=0;(a=u.next())&&!a.done;){if(!i[m]&&r.equals(s.value,a.value,s.value,a.value,e,t,r)){d=i[m]=!0;break}m++}if(!d)return!1}return!0}function gVe(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function _Ve(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function dce(e,t,r,n){return(n===sVe||n===aVe||n===oVe)&&(e.$$typeof||t.$$typeof)?!0:iVe(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}var yVe="[object Arguments]",vVe="[object Boolean]",bVe="[object Date]",xVe="[object Error]",wVe="[object Map]",MVe="[object Number]",SVe="[object Object]",TVe="[object RegExp]",PVe="[object Set]",EVe="[object String]",AVe="[object URL]",CVe=Array.isArray,uq=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,dq=Object.assign,kVe=Object.prototype.toString.call.bind(Object.prototype.toString);function IVe(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areErrorsEqual,i=e.areFunctionsEqual,o=e.areMapsEqual,s=e.areNumbersEqual,a=e.areObjectsEqual,u=e.arePrimitiveWrappersEqual,d=e.areRegExpsEqual,m=e.areSetsEqual,g=e.areTypedArraysEqual,_=e.areUrlsEqual;return function(M,x,E){if(M===x)return!0;if(M==null||x==null)return!1;var T=typeof M;if(T!==typeof x)return!1;if(T!=="object")return T==="number"?s(M,x,E):T==="function"?i(M,x,E):!1;var P=M.constructor;if(P!==x.constructor)return!1;if(P===Object)return a(M,x,E);if(CVe(M))return t(M,x,E);if(uq!=null&&uq(M))return g(M,x,E);if(P===Date)return r(M,x,E);if(P===RegExp)return d(M,x,E);if(P===Map)return o(M,x,E);if(P===Set)return m(M,x,E);var C=kVe(M);return C===bVe?r(M,x,E):C===TVe?d(M,x,E):C===wVe?o(M,x,E):C===PVe?m(M,x,E):C===SVe?typeof M.then!="function"&&typeof x.then!="function"&&a(M,x,E):C===AVe?_(M,x,E):C===xVe?n(M,x,E):C===yVe?a(M,x,E):C===vVe||C===MVe||C===EVe?u(M,x,E):!1}}function OVe(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,i={areArraysEqual:n?$w:lVe,areDatesEqual:cVe,areErrorsEqual:uVe,areFunctionsEqual:dVe,areMapsEqual:n?iq(lq,$w):lq,areNumbersEqual:hVe,areObjectsEqual:n?$w:fVe,arePrimitiveWrappersEqual:pVe,areRegExpsEqual:mVe,areSetsEqual:n?iq(cq,$w):cq,areTypedArraysEqual:n?$w:gVe,areUrlsEqual:_Ve};if(r&&(i=dq({},i,r(i))),t){var o=KP(i.areArraysEqual),s=KP(i.areMapsEqual),a=KP(i.areObjectsEqual),u=KP(i.areSetsEqual);i=dq({},i,{areArraysEqual:o,areMapsEqual:s,areObjectsEqual:a,areSetsEqual:u})}return i}function LVe(e){return function(t,r,n,i,o,s,a){return e(t,r,a)}}function DVe(e){var t=e.circular,r=e.comparator,n=e.createState,i=e.equals,o=e.strict;if(n)return function(u,d){var m=n(),g=m.cache,_=g===void 0?t?new WeakMap:void 0:g,y=m.meta;return r(u,d,{cache:_,equals:i,meta:y,strict:o})};if(t)return function(u,d){return r(u,d,{cache:new WeakMap,equals:i,meta:void 0,strict:o})};var s={cache:void 0,equals:i,meta:void 0,strict:o};return function(u,d){return r(u,d,s)}}var $Ve=z_();z_({strict:!0});z_({circular:!0});z_({circular:!0,strict:!0});z_({createInternalComparator:function(){return F0}});z_({strict:!0,createInternalComparator:function(){return F0}});z_({circular:!0,createInternalComparator:function(){return F0}});z_({circular:!0,createInternalComparator:function(){return F0},strict:!0});function z_(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,i=e.createState,o=e.strict,s=o===void 0?!1:o,a=OVe(e),u=IVe(a),d=n?n(u):LVe(u);return DVe({circular:r,comparator:u,createState:i,equals:d,strict:s})}function NVe(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function hq(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function i(o){r<0&&(r=o),o-r>t?(e(o),r=-1):NVe(i)};requestAnimationFrame(n)}function K$(e){"@babel/helpers - typeof";return K$=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K$(e)}function jVe(e){return BVe(e)||zVe(e)||FVe(e)||RVe()}function RVe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FVe(e,t){if(e){if(typeof e=="string")return fq(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fq(e,t)}}function fq(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zVe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function BVe(e){if(Array.isArray(e))return e}function UVe(){var e={},t=function(){return null},r=!1,n=function i(o){if(!r){if(Array.isArray(o)){if(!o.length)return;var s=o,a=jVe(s),u=a[0],d=a.slice(1);if(typeof u=="number"){hq(i.bind(null,d),u);return}i(u),hq(i.bind(null,d));return}K$(o)==="object"&&(e=o,t(e)),typeof o=="function"&&o()}};return{stop:function(){r=!0},start:function(o){r=!1,n(o)},subscribe:function(o){return t=o,function(){t=function(){return null}}}}}function OM(e){"@babel/helpers - typeof";return OM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},OM(e)}function pq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function mq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pq(Object(r),!0).forEach(function(n){hce(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hce(e,t,r){return t=VVe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VVe(e){var t=WVe(e,"string");return OM(t)==="symbol"?t:String(t)}function WVe(e,t){if(OM(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(OM(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var GVe=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,i){return n.filter(function(o){return i.includes(o)})})},qVe=function(t){return t},HVe=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},b2=function(t,r){return Object.keys(r).reduce(function(n,i){return mq(mq({},n),{},hce({},i,t(i,r[i])))},{})},gq=function(t,r,n){return t.map(function(i){return"".concat(HVe(i)," ").concat(r,"ms ").concat(n)}).join(",")};function KVe(e,t){return YVe(e)||XVe(e,t)||fce(e,t)||ZVe()}function ZVe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XVe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],u=!0,d=!1;try{if(o=(r=r.call(e)).next,t!==0)for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);u=!0);}catch(m){d=!0,i=m}finally{try{if(!u&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw i}}return a}}function YVe(e){if(Array.isArray(e))return e}function QVe(e){return t7e(e)||e7e(e)||fce(e)||JVe()}function JVe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fce(e,t){if(e){if(typeof e=="string")return Z$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Z$(e,t)}}function e7e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function t7e(e){if(Array.isArray(e))return Z$(e)}function Z$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var _C=1e-4,pce=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},mce=function(t,r){return t.map(function(n,i){return n*Math.pow(r,i)}).reduce(function(n,i){return n+i})},_q=function(t,r){return function(n){var i=pce(t,r);return mce(i,n)}},r7e=function(t,r){return function(n){var i=pce(t,r),o=[].concat(QVe(i.map(function(s,a){return s*a}).slice(1)),[0]);return mce(o,n)}},yq=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r[0],o=r[1],s=r[2],a=r[3];if(r.length===1)switch(r[0]){case"linear":i=0,o=0,s=1,a=1;break;case"ease":i=.25,o=.1,s=.25,a=1;break;case"ease-in":i=.42,o=0,s=1,a=1;break;case"ease-out":i=.42,o=0,s=.58,a=1;break;case"ease-in-out":i=0,o=0,s=.58,a=1;break;default:{var u=r[0].split("(");if(u[0]==="cubic-bezier"&&u[1].split(")")[0].split(",").length===4){var d=u[1].split(")")[0].split(",").map(function(E){return parseFloat(E)}),m=KVe(d,4);i=m[0],o=m[1],s=m[2],a=m[3]}}}var g=_q(i,s),_=_q(o,a),y=r7e(i,s),M=function(T){return T>1?1:T<0?0:T},x=function(T){for(var P=T>1?1:T,C=P,D=0;D<8;++D){var L=g(C)-P,N=y(C);if(Math.abs(L-P)<_C||N<_C)return _(C);C=M(C-L/N)}return _(C)};return x.isStepper=!1,x},n7e=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,i=t.damping,o=i===void 0?8:i,s=t.dt,a=s===void 0?17:s,u=function(m,g,_){var y=-(m-g)*n,M=_*o,x=_+(y-M)*a/1e3,E=_*a/1e3+m;return Math.abs(E-g)<_C&&Math.abs(x)<_C?[g,0]:[E,x]};return u.isStepper=!0,u.dt=a,u},i7e=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r[0];if(typeof i=="string")switch(i){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return yq(i);case"spring":return n7e();default:if(i.split("(")[0]==="cubic-bezier")return yq(i)}return typeof i=="function"?i:null};function LM(e){"@babel/helpers - typeof";return LM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},LM(e)}function vq(e){return s7e(e)||a7e(e)||gce(e)||o7e()}function o7e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function a7e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function s7e(e){if(Array.isArray(e))return Y$(e)}function bq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function eu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bq(Object(r),!0).forEach(function(n){X$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function X$(e,t,r){return t=l7e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l7e(e){var t=c7e(e,"string");return LM(t)==="symbol"?t:String(t)}function c7e(e,t){if(LM(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(LM(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function u7e(e,t){return f7e(e)||h7e(e,t)||gce(e,t)||d7e()}function d7e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gce(e,t){if(e){if(typeof e=="string")return Y$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Y$(e,t)}}function Y$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function h7e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],u=!0,d=!1;try{if(o=(r=r.call(e)).next,t!==0)for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);u=!0);}catch(m){d=!0,i=m}finally{try{if(!u&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw i}}return a}}function f7e(e){if(Array.isArray(e))return e}var yC=function(t,r,n){return t+(r-t)*n},Q$=function(t){var r=t.from,n=t.to;return r!==n},p7e=function e(t,r,n){var i=b2(function(o,s){if(Q$(s)){var a=t(s.from,s.to,s.velocity),u=u7e(a,2),d=u[0],m=u[1];return eu(eu({},s),{},{from:d,velocity:m})}return s},r);return n<1?b2(function(o,s){return Q$(s)?eu(eu({},s),{},{velocity:yC(s.velocity,i[o].velocity,n),from:yC(s.from,i[o].from,n)}):s},r):e(t,i,n-1)};const m7e=function(e,t,r,n,i){var o=GVe(e,t),s=o.reduce(function(E,T){return eu(eu({},E),{},X$({},T,[e[T],t[T]]))},{}),a=o.reduce(function(E,T){return eu(eu({},E),{},X$({},T,{from:e[T],velocity:0,to:t[T]}))},{}),u=-1,d,m,g=function(){return null},_=function(){return b2(function(T,P){return P.from},a)},y=function(){return!Object.values(a).filter(Q$).length},M=function(T){d||(d=T);var P=T-d,C=P/r.dt;a=p7e(r,a,C),i(eu(eu(eu({},e),t),_())),d=T,y()||(u=requestAnimationFrame(g))},x=function(T){m||(m=T);var P=(T-m)/n,C=b2(function(L,N){return yC.apply(void 0,vq(N).concat([r(P)]))},s);if(i(eu(eu(eu({},e),t),C)),P<1)u=requestAnimationFrame(g);else{var D=b2(function(L,N){return yC.apply(void 0,vq(N).concat([r(1)]))},s);i(eu(eu(eu({},e),t),D))}};return g=r.isStepper?M:x,function(){return requestAnimationFrame(g),function(){cancelAnimationFrame(u)}}};function lb(e){"@babel/helpers - typeof";return lb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lb(e)}var g7e=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function _7e(e,t){if(e==null)return{};var r=y7e(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function y7e(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function xO(e){return w7e(e)||x7e(e)||b7e(e)||v7e()}function v7e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function b7e(e,t){if(e){if(typeof e=="string")return J$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return J$(e,t)}}function x7e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function w7e(e){if(Array.isArray(e))return J$(e)}function J$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function bf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xq(Object(r),!0).forEach(function(n){Yw(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Yw(e,t,r){return t=_ce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function M7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S7e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_ce(n.key),n)}}function T7e(e,t,r){return t&&S7e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _ce(e){var t=P7e(e,"string");return lb(t)==="symbol"?t:String(t)}function P7e(e,t){if(lb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function E7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eN(e,t)}function eN(e,t){return eN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},eN(e,t)}function A7e(e){var t=C7e();return function(){var n=vC(e),i;if(t){var o=vC(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return tN(this,i)}}function tN(e,t){if(t&&(lb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rN(e)}function rN(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C7e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vC(e){return vC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vC(e)}var Gf=function(e){E7e(r,e);var t=A7e(r);function r(n,i){var o;M7e(this,r),o=t.call(this,n,i);var s=o.props,a=s.isActive,u=s.attributeName,d=s.from,m=s.to,g=s.steps,_=s.children,y=s.duration;if(o.handleStyleChange=o.handleStyleChange.bind(rN(o)),o.changeStyle=o.changeStyle.bind(rN(o)),!a||y<=0)return o.state={style:{}},typeof _=="function"&&(o.state={style:m}),tN(o);if(g&&g.length)o.state={style:g[0].style};else if(d){if(typeof _=="function")return o.state={style:d},tN(o);o.state={style:u?Yw({},u,d):d}}else o.state={style:{}};return o}return T7e(r,[{key:"componentDidMount",value:function(){var i=this.props,o=i.isActive,s=i.canBegin;this.mounted=!0,!(!o||!s)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(i){var o=this.props,s=o.isActive,a=o.canBegin,u=o.attributeName,d=o.shouldReAnimate,m=o.to,g=o.from,_=this.state.style;if(a){if(!s){var y={style:u?Yw({},u,m):m};this.state&&_&&(u&&_[u]!==m||!u&&_!==m)&&this.setState(y);return}if(!($Ve(i.to,m)&&i.canBegin&&i.isActive)){var M=!i.canBegin||!i.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var x=M||d?g:i.to;if(this.state&&_){var E={style:u?Yw({},u,x):x};(u&&_[u]!==x||!u&&_!==x)&&this.setState(E)}this.runAnimation(bf(bf({},this.props),{},{from:x,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var i=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),i&&i()}},{key:"handleStyleChange",value:function(i){this.changeStyle(i)}},{key:"changeStyle",value:function(i){this.mounted&&this.setState({style:i})}},{key:"runJSAnimation",value:function(i){var o=this,s=i.from,a=i.to,u=i.duration,d=i.easing,m=i.begin,g=i.onAnimationEnd,_=i.onAnimationStart,y=m7e(s,a,i7e(d),u,this.changeStyle),M=function(){o.stopJSAnimation=y()};this.manager.start([_,m,M,u,g])}},{key:"runStepAnimation",value:function(i){var o=this,s=i.steps,a=i.begin,u=i.onAnimationStart,d=s[0],m=d.style,g=d.duration,_=g===void 0?0:g,y=function(x,E,T){if(T===0)return x;var P=E.duration,C=E.easing,D=C===void 0?"ease":C,L=E.style,N=E.properties,j=E.onAnimationEnd,$=T>0?s[T-1]:E,U=N||Object.keys(L);if(typeof D=="function"||D==="spring")return[].concat(xO(x),[o.runJSAnimation.bind(o,{from:$.style,to:L,duration:P,easing:D}),P]);var G=gq(U,P,D),H=bf(bf(bf({},$.style),L),{},{transition:G});return[].concat(xO(x),[H,P,j]).filter(qVe)};return this.manager.start([u].concat(xO(s.reduce(y,[m,Math.max(_,a)])),[i.onAnimationEnd]))}},{key:"runAnimation",value:function(i){this.manager||(this.manager=UVe());var o=i.begin,s=i.duration,a=i.attributeName,u=i.to,d=i.easing,m=i.onAnimationStart,g=i.onAnimationEnd,_=i.steps,y=i.children,M=this.manager;if(this.unSubscribe=M.subscribe(this.handleStyleChange),typeof d=="function"||typeof y=="function"||d==="spring"){this.runJSAnimation(i);return}if(_.length>1){this.runStepAnimation(i);return}var x=a?Yw({},a,u):u,E=gq(Object.keys(x),s,d);M.start([m,o,bf(bf({},x),{},{transition:E}),s,g])}},{key:"render",value:function(){var i=this.props,o=i.children;i.begin;var s=i.duration;i.attributeName,i.easing;var a=i.isActive;i.steps,i.from,i.to,i.canBegin,i.onAnimationEnd,i.shouldReAnimate,i.onAnimationReStart;var u=_7e(i,g7e),d=oe.Children.count(o),m=this.state.style;if(typeof o=="function")return o(m);if(!a||d===0||s<=0)return o;var g=function(y){var M=y.props,x=M.style,E=x===void 0?{}:x,T=M.className,P=oe.cloneElement(y,bf(bf({},u),{},{style:bf(bf({},E),m),className:T}));return P};return d===1?g(oe.Children.only(o)):ct.createElement("div",null,oe.Children.map(o,function(_){return g(_)}))}}]),r}(oe.PureComponent);Gf.displayName="Animate";Gf.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Gf.propTypes={from:va.oneOfType([va.object,va.string]),to:va.oneOfType([va.object,va.string]),attributeName:va.string,duration:va.number,begin:va.number,easing:va.oneOfType([va.string,va.func]),steps:va.arrayOf(va.shape({duration:va.number.isRequired,style:va.object.isRequired,easing:va.oneOfType([va.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),va.func]),properties:va.arrayOf("string"),onAnimationEnd:va.func})),children:va.oneOfType([va.node,va.func]),isActive:va.bool,canBegin:va.bool,onAnimationEnd:va.func,shouldReAnimate:va.bool,onAnimationStart:va.func,onAnimationReStart:va.func};function DM(e){"@babel/helpers - typeof";return DM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},DM(e)}function bC(){return bC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bC.apply(this,arguments)}function k7e(e,t){return D7e(e)||L7e(e,t)||O7e(e,t)||I7e()}function I7e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function O7e(e,t){if(e){if(typeof e=="string")return wq(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wq(e,t)}}function wq(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function L7e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],u=!0,d=!1;try{if(o=(r=r.call(e)).next,t!==0)for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);u=!0);}catch(m){d=!0,i=m}finally{try{if(!u&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw i}}return a}}function D7e(e){if(Array.isArray(e))return e}function Mq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Sq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Mq(Object(r),!0).forEach(function(n){$7e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Mq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $7e(e,t,r){return t=N7e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function N7e(e){var t=j7e(e,"string");return DM(t)=="symbol"?t:t+""}function j7e(e,t){if(DM(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(DM(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Tq=function(t,r,n,i,o){var s=Math.min(Math.abs(n)/2,Math.abs(i)/2),a=i>=0?1:-1,u=n>=0?1:-1,d=i>=0&&n>=0||i<0&&n<0?1:0,m;if(s>0&&o instanceof Array){for(var g=[0,0,0,0],_=0,y=4;_<y;_++)g[_]=o[_]>s?s:o[_];m="M".concat(t,",").concat(r+a*g[0]),g[0]>0&&(m+="A ".concat(g[0],",").concat(g[0],",0,0,").concat(d,",").concat(t+u*g[0],",").concat(r)),m+="L ".concat(t+n-u*g[1],",").concat(r),g[1]>0&&(m+="A ".concat(g[1],",").concat(g[1],",0,0,").concat(d,`,
        `).concat(t+n,",").concat(r+a*g[1])),m+="L ".concat(t+n,",").concat(r+i-a*g[2]),g[2]>0&&(m+="A ".concat(g[2],",").concat(g[2],",0,0,").concat(d,`,
        `).concat(t+n-u*g[2],",").concat(r+i)),m+="L ".concat(t+u*g[3],",").concat(r+i),g[3]>0&&(m+="A ".concat(g[3],",").concat(g[3],",0,0,").concat(d,`,
        `).concat(t,",").concat(r+i-a*g[3])),m+="Z"}else if(s>0&&o===+o&&o>0){var M=Math.min(s,o);m="M ".concat(t,",").concat(r+a*M,`
            A `).concat(M,",").concat(M,",0,0,").concat(d,",").concat(t+u*M,",").concat(r,`
            L `).concat(t+n-u*M,",").concat(r,`
            A `).concat(M,",").concat(M,",0,0,").concat(d,",").concat(t+n,",").concat(r+a*M,`
            L `).concat(t+n,",").concat(r+i-a*M,`
            A `).concat(M,",").concat(M,",0,0,").concat(d,",").concat(t+n-u*M,",").concat(r+i,`
            L `).concat(t+u*M,",").concat(r+i,`
            A `).concat(M,",").concat(M,",0,0,").concat(d,",").concat(t,",").concat(r+i-a*M," Z")}else m="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(i," h ").concat(-n," Z");return m},R7e=function(t,r){if(!t||!r)return!1;var n=t.x,i=t.y,o=r.x,s=r.y,a=r.width,u=r.height;if(Math.abs(a)>0&&Math.abs(u)>0){var d=Math.min(o,o+a),m=Math.max(o,o+a),g=Math.min(s,s+u),_=Math.max(s,s+u);return n>=d&&n<=m&&i>=g&&i<=_}return!1},F7e={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},zF=function(t){var r=Sq(Sq({},F7e),t),n=oe.useRef(),i=oe.useState(-1),o=k7e(i,2),s=o[0],a=o[1];oe.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var D=n.current.getTotalLength();D&&a(D)}catch{}},[]);var u=r.x,d=r.y,m=r.width,g=r.height,_=r.radius,y=r.className,M=r.animationEasing,x=r.animationDuration,E=r.animationBegin,T=r.isAnimationActive,P=r.isUpdateAnimationActive;if(u!==+u||d!==+d||m!==+m||g!==+g||m===0||g===0)return null;var C=Wi("recharts-rectangle",y);return P?ct.createElement(Gf,{canBegin:s>0,from:{width:m,height:g,x:u,y:d},to:{width:m,height:g,x:u,y:d},duration:x,animationEasing:M,isActive:P},function(D){var L=D.width,N=D.height,j=D.x,$=D.y;return ct.createElement(Gf,{canBegin:s>0,from:"0px ".concat(s===-1?1:s,"px"),to:"".concat(s,"px 0px"),attributeName:"strokeDasharray",begin:E,duration:x,isActive:T,easing:M},ct.createElement("path",bC({},ii(r,!0),{className:C,d:Tq(j,$,L,N,_),ref:n})))}):ct.createElement("path",bC({},ii(r,!0),{className:C,d:Tq(u,d,m,g,_)}))},z7e=["points","className","baseLinePoints","connectNulls"];function a1(){return a1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a1.apply(this,arguments)}function B7e(e,t){if(e==null)return{};var r=U7e(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function U7e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Pq(e){return q7e(e)||G7e(e)||W7e(e)||V7e()}function V7e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function W7e(e,t){if(e){if(typeof e=="string")return nN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nN(e,t)}}function G7e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function q7e(e){if(Array.isArray(e))return nN(e)}function nN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Eq=function(t){return t&&t.x===+t.x&&t.y===+t.y},H7e=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=[[]];return t.forEach(function(n){Eq(n)?r[r.length-1].push(n):r[r.length-1].length>0&&r.push([])}),Eq(t[0])&&r[r.length-1].push(t[0]),r[r.length-1].length<=0&&(r=r.slice(0,-1)),r},x2=function(t,r){var n=H7e(t);r&&(n=[n.reduce(function(o,s){return[].concat(Pq(o),Pq(s))},[])]);var i=n.map(function(o){return o.reduce(function(s,a,u){return"".concat(s).concat(u===0?"M":"L").concat(a.x,",").concat(a.y)},"")}).join("");return n.length===1?"".concat(i,"Z"):i},K7e=function(t,r,n){var i=x2(t,n);return"".concat(i.slice(-1)==="Z"?i.slice(0,-1):i,"L").concat(x2(r.reverse(),n).slice(1))},Z7e=function(t){var r=t.points,n=t.className,i=t.baseLinePoints,o=t.connectNulls,s=B7e(t,z7e);if(!r||!r.length)return null;var a=Wi("recharts-polygon",n);if(i&&i.length){var u=s.stroke&&s.stroke!=="none",d=K7e(r,i,o);return ct.createElement("g",{className:a},ct.createElement("path",a1({},ii(s,!0),{fill:d.slice(-1)==="Z"?s.fill:"none",stroke:"none",d})),u?ct.createElement("path",a1({},ii(s,!0),{fill:"none",d:x2(r,o)})):null,u?ct.createElement("path",a1({},ii(s,!0),{fill:"none",d:x2(i,o)})):null)}var m=x2(r,o);return ct.createElement("path",a1({},ii(s,!0),{fill:m.slice(-1)==="Z"?s.fill:"none",className:a,d:m}))};function iN(){return iN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},iN.apply(this,arguments)}var AS=function(t){var r=t.cx,n=t.cy,i=t.r,o=t.className,s=Wi("recharts-dot",o);return r===+r&&n===+n&&i===+i?oe.createElement("circle",iN({},ii(t,!1),zA(t),{className:s,cx:r,cy:n,r:i})):null};function $M(e){"@babel/helpers - typeof";return $M=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$M(e)}var X7e=["x","y","top","left","width","height","className"];function oN(){return oN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},oN.apply(this,arguments)}function Aq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Y7e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Aq(Object(r),!0).forEach(function(n){Q7e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Aq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Q7e(e,t,r){return t=J7e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function J7e(e){var t=eWe(e,"string");return $M(t)=="symbol"?t:t+""}function eWe(e,t){if($M(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($M(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tWe(e,t){if(e==null)return{};var r=rWe(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function rWe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var nWe=function(t,r,n,i,o,s){return"M".concat(t,",").concat(o,"v").concat(i,"M").concat(s,",").concat(r,"h").concat(n)},iWe=function(t){var r=t.x,n=r===void 0?0:r,i=t.y,o=i===void 0?0:i,s=t.top,a=s===void 0?0:s,u=t.left,d=u===void 0?0:u,m=t.width,g=m===void 0?0:m,_=t.height,y=_===void 0?0:_,M=t.className,x=tWe(t,X7e),E=Y7e({x:n,y:o,top:a,left:d,width:g,height:y},x);return!hn(n)||!hn(o)||!hn(g)||!hn(y)||!hn(a)||!hn(d)?null:ct.createElement("path",oN({},ii(E,!0),{className:Wi("recharts-cross",M),d:nWe(n,o,g,y,a,d)}))},oWe=uk,aWe=Cle,sWe=Qp;function lWe(e,t){return e&&e.length?oWe(e,sWe(t),aWe):void 0}var cWe=lWe;const uWe=sa(cWe);var dWe=uk,hWe=Qp,fWe=kle;function pWe(e,t){return e&&e.length?dWe(e,hWe(t),fWe):void 0}var mWe=pWe;const gWe=sa(mWe);var _We=["cx","cy","angle","ticks","axisLine"],yWe=["ticks","tick","angle","tickFormatter","stroke"];function cb(e){"@babel/helpers - typeof";return cb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cb(e)}function w2(){return w2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},w2.apply(this,arguments)}function Cq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function fy(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Cq(Object(r),!0).forEach(function(n){pk(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Cq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kq(e,t){if(e==null)return{};var r=vWe(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function vWe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function bWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Iq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vce(n.key),n)}}function xWe(e,t,r){return t&&Iq(e.prototype,t),r&&Iq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wWe(e,t,r){return t=xC(t),MWe(e,yce()?Reflect.construct(t,r||[],xC(e).constructor):t.apply(e,r))}function MWe(e,t){if(t&&(cb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return SWe(e)}function SWe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yce(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(yce=function(){return!!e})()}function xC(e){return xC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xC(e)}function TWe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aN(e,t)}function aN(e,t){return aN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},aN(e,t)}function pk(e,t,r){return t=vce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vce(e){var t=PWe(e,"string");return cb(t)=="symbol"?t:t+""}function PWe(e,t){if(cb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mk=function(e){function t(){return bWe(this,t),wWe(this,t,arguments)}return TWe(t,e),xWe(t,[{key:"getTickValueCoord",value:function(n){var i=n.coordinate,o=this.props,s=o.angle,a=o.cx,u=o.cy;return ns(a,u,i,s)}},{key:"getTickTextAnchor",value:function(){var n=this.props.orientation,i;switch(n){case"left":i="end";break;case"right":i="start";break;default:i="middle";break}return i}},{key:"getViewBox",value:function(){var n=this.props,i=n.cx,o=n.cy,s=n.angle,a=n.ticks,u=uWe(a,function(m){return m.coordinate||0}),d=gWe(a,function(m){return m.coordinate||0});return{cx:i,cy:o,startAngle:s,endAngle:s,innerRadius:d.coordinate||0,outerRadius:u.coordinate||0}}},{key:"renderAxisLine",value:function(){var n=this.props,i=n.cx,o=n.cy,s=n.angle,a=n.ticks,u=n.axisLine,d=kq(n,_We),m=a.reduce(function(M,x){return[Math.min(M[0],x.coordinate),Math.max(M[1],x.coordinate)]},[1/0,-1/0]),g=ns(i,o,m[0],s),_=ns(i,o,m[1],s),y=fy(fy(fy({},ii(d,!1)),{},{fill:"none"},ii(u,!1)),{},{x1:g.x,y1:g.y,x2:_.x,y2:_.y});return ct.createElement("line",w2({className:"recharts-polar-radius-axis-line"},y))}},{key:"renderTicks",value:function(){var n=this,i=this.props,o=i.ticks,s=i.tick,a=i.angle,u=i.tickFormatter,d=i.stroke,m=kq(i,yWe),g=this.getTickTextAnchor(),_=ii(m,!1),y=ii(s,!1),M=o.map(function(x,E){var T=n.getTickValueCoord(x),P=fy(fy(fy(fy({textAnchor:g,transform:"rotate(".concat(90-a,", ").concat(T.x,", ").concat(T.y,")")},_),{},{stroke:"none",fill:d},y),{},{index:E},T),{},{payload:x});return ct.createElement($o,w2({className:Wi("recharts-polar-radius-axis-tick",ice(s)),key:"tick-".concat(x.coordinate)},m0(n.props,x,E)),t.renderTickItem(s,P,u?u(x.value,E):x.value))});return ct.createElement($o,{className:"recharts-polar-radius-axis-ticks"},M)}},{key:"render",value:function(){var n=this.props,i=n.ticks,o=n.axisLine,s=n.tick;return!i||!i.length?null:ct.createElement($o,{className:Wi("recharts-polar-radius-axis",this.props.className)},o&&this.renderAxisLine(),s&&this.renderTicks(),Rc.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(n,i,o){var s;return ct.isValidElement(n)?s=ct.cloneElement(n,i):Pi(n)?s=n(i):s=ct.createElement(g0,w2({},i,{className:"recharts-polar-radius-axis-tick-value"}),o),s}}])}(oe.PureComponent);pk(mk,"displayName","PolarRadiusAxis");pk(mk,"axisType","radiusAxis");pk(mk,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function ub(e){"@babel/helpers - typeof";return ub=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ub(e)}function Ty(){return Ty=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ty.apply(this,arguments)}function Oq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function py(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Oq(Object(r),!0).forEach(function(n){gk(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Oq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function EWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Lq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xce(n.key),n)}}function AWe(e,t,r){return t&&Lq(e.prototype,t),r&&Lq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function CWe(e,t,r){return t=wC(t),kWe(e,bce()?Reflect.construct(t,r||[],wC(e).constructor):t.apply(e,r))}function kWe(e,t){if(t&&(ub(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IWe(e)}function IWe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bce(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bce=function(){return!!e})()}function wC(e){return wC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wC(e)}function OWe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sN(e,t)}function sN(e,t){return sN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},sN(e,t)}function gk(e,t,r){return t=xce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xce(e){var t=LWe(e,"string");return ub(t)=="symbol"?t:t+""}function LWe(e,t){if(ub(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ub(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DWe=Math.PI/180,Dq=1e-5,_k=function(e){function t(){return EWe(this,t),CWe(this,t,arguments)}return OWe(t,e),AWe(t,[{key:"getTickLineCoord",value:function(n){var i=this.props,o=i.cx,s=i.cy,a=i.radius,u=i.orientation,d=i.tickSize,m=d||8,g=ns(o,s,a,n.coordinate),_=ns(o,s,a+(u==="inner"?-1:1)*m,n.coordinate);return{x1:g.x,y1:g.y,x2:_.x,y2:_.y}}},{key:"getTickTextAnchor",value:function(n){var i=this.props.orientation,o=Math.cos(-n.coordinate*DWe),s;return o>Dq?s=i==="outer"?"start":"end":o<-Dq?s=i==="outer"?"end":"start":s="middle",s}},{key:"renderAxisLine",value:function(){var n=this.props,i=n.cx,o=n.cy,s=n.radius,a=n.axisLine,u=n.axisLineType,d=py(py({},ii(this.props,!1)),{},{fill:"none"},ii(a,!1));if(u==="circle")return ct.createElement(AS,Ty({className:"recharts-polar-angle-axis-line"},d,{cx:i,cy:o,r:s}));var m=this.props.ticks,g=m.map(function(_){return ns(i,o,s,_.coordinate)});return ct.createElement(Z7e,Ty({className:"recharts-polar-angle-axis-line"},d,{points:g}))}},{key:"renderTicks",value:function(){var n=this,i=this.props,o=i.ticks,s=i.tick,a=i.tickLine,u=i.tickFormatter,d=i.stroke,m=ii(this.props,!1),g=ii(s,!1),_=py(py({},m),{},{fill:"none"},ii(a,!1)),y=o.map(function(M,x){var E=n.getTickLineCoord(M),T=n.getTickTextAnchor(M),P=py(py(py({textAnchor:T},m),{},{stroke:"none",fill:d},g),{},{index:x,payload:M,x:E.x2,y:E.y2});return ct.createElement($o,Ty({className:Wi("recharts-polar-angle-axis-tick",ice(s)),key:"tick-".concat(M.coordinate)},m0(n.props,M,x)),a&&ct.createElement("line",Ty({className:"recharts-polar-angle-axis-tick-line"},_,E)),s&&t.renderTickItem(s,P,u?u(M.value,x):M.value))});return ct.createElement($o,{className:"recharts-polar-angle-axis-ticks"},y)}},{key:"render",value:function(){var n=this.props,i=n.ticks,o=n.radius,s=n.axisLine;return o<=0||!i||!i.length?null:ct.createElement($o,{className:Wi("recharts-polar-angle-axis",this.props.className)},s&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(n,i,o){var s;return ct.isValidElement(n)?s=ct.cloneElement(n,i):Pi(n)?s=n(i):s=ct.createElement(g0,Ty({},i,{className:"recharts-polar-angle-axis-tick-value"}),o),s}}])}(oe.PureComponent);gk(_k,"displayName","PolarAngleAxis");gk(_k,"axisType","angleAxis");gk(_k,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var $We=Tse,NWe=$We(Object.getPrototypeOf,Object),jWe=NWe,RWe=tg,FWe=jWe,zWe=rg,BWe="[object Object]",UWe=Function.prototype,VWe=Object.prototype,wce=UWe.toString,WWe=VWe.hasOwnProperty,GWe=wce.call(Object);function qWe(e){if(!zWe(e)||RWe(e)!=BWe)return!1;var t=FWe(e);if(t===null)return!0;var r=WWe.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&wce.call(r)==GWe}var HWe=qWe;const KWe=sa(HWe);var ZWe=tg,XWe=rg,YWe="[object Boolean]";function QWe(e){return e===!0||e===!1||XWe(e)&&ZWe(e)==YWe}var JWe=QWe;const e9e=sa(JWe);function NM(e){"@babel/helpers - typeof";return NM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},NM(e)}function MC(){return MC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},MC.apply(this,arguments)}function t9e(e,t){return o9e(e)||i9e(e,t)||n9e(e,t)||r9e()}function r9e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function n9e(e,t){if(e){if(typeof e=="string")return $q(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $q(e,t)}}function $q(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i9e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],u=!0,d=!1;try{if(o=(r=r.call(e)).next,t!==0)for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);u=!0);}catch(m){d=!0,i=m}finally{try{if(!u&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw i}}return a}}function o9e(e){if(Array.isArray(e))return e}function Nq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function jq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Nq(Object(r),!0).forEach(function(n){a9e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Nq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function a9e(e,t,r){return t=s9e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s9e(e){var t=l9e(e,"string");return NM(t)=="symbol"?t:t+""}function l9e(e,t){if(NM(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(NM(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Rq=function(t,r,n,i,o){var s=n-i,a;return a="M ".concat(t,",").concat(r),a+="L ".concat(t+n,",").concat(r),a+="L ".concat(t+n-s/2,",").concat(r+o),a+="L ".concat(t+n-s/2-i,",").concat(r+o),a+="L ".concat(t,",").concat(r," Z"),a},c9e={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},u9e=function(t){var r=jq(jq({},c9e),t),n=oe.useRef(),i=oe.useState(-1),o=t9e(i,2),s=o[0],a=o[1];oe.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var C=n.current.getTotalLength();C&&a(C)}catch{}},[]);var u=r.x,d=r.y,m=r.upperWidth,g=r.lowerWidth,_=r.height,y=r.className,M=r.animationEasing,x=r.animationDuration,E=r.animationBegin,T=r.isUpdateAnimationActive;if(u!==+u||d!==+d||m!==+m||g!==+g||_!==+_||m===0&&g===0||_===0)return null;var P=Wi("recharts-trapezoid",y);return T?ct.createElement(Gf,{canBegin:s>0,from:{upperWidth:0,lowerWidth:0,height:_,x:u,y:d},to:{upperWidth:m,lowerWidth:g,height:_,x:u,y:d},duration:x,animationEasing:M,isActive:T},function(C){var D=C.upperWidth,L=C.lowerWidth,N=C.height,j=C.x,$=C.y;return ct.createElement(Gf,{canBegin:s>0,from:"0px ".concat(s===-1?1:s,"px"),to:"".concat(s,"px 0px"),attributeName:"strokeDasharray",begin:E,duration:x,easing:M},ct.createElement("path",MC({},ii(r,!0),{className:P,d:Rq(j,$,D,L,N),ref:n})))}):ct.createElement("g",null,ct.createElement("path",MC({},ii(r,!0),{className:P,d:Rq(u,d,m,g,_)})))},d9e=["option","shapeType","propTransformer","activeClassName","isActive"];function jM(e){"@babel/helpers - typeof";return jM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jM(e)}function h9e(e,t){if(e==null)return{};var r=f9e(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function f9e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Fq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function SC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Fq(Object(r),!0).forEach(function(n){p9e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function p9e(e,t,r){return t=m9e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m9e(e){var t=g9e(e,"string");return jM(t)=="symbol"?t:t+""}function g9e(e,t){if(jM(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jM(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _9e(e,t){return SC(SC({},t),e)}function y9e(e,t){return e==="symbols"}function zq(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return ct.createElement(zF,r);case"trapezoid":return ct.createElement(u9e,r);case"sector":return ct.createElement(sce,r);case"symbols":if(y9e(t))return ct.createElement(oF,r);break;default:return null}}function v9e(e){return oe.isValidElement(e)?e.props:e}function Mce(e){var t=e.option,r=e.shapeType,n=e.propTransformer,i=n===void 0?_9e:n,o=e.activeClassName,s=o===void 0?"recharts-active-shape":o,a=e.isActive,u=h9e(e,d9e),d;if(oe.isValidElement(t))d=oe.cloneElement(t,SC(SC({},u),v9e(t)));else if(Pi(t))d=t(u);else if(KWe(t)&&!e9e(t)){var m=i(t,u);d=ct.createElement(zq,{shapeType:r,elementProps:m})}else{var g=u;d=ct.createElement(zq,{shapeType:r,elementProps:g})}return a?ct.createElement($o,{className:s},d):d}function yk(e,t){return t!=null&&"trapezoids"in e.props}function vk(e,t){return t!=null&&"sectors"in e.props}function RM(e,t){return t!=null&&"points"in e.props}function b9e(e,t){var r,n,i=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,o=e.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||e.y===t.y;return i&&o}function x9e(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function w9e(e,t){var r=e.x===t.x,n=e.y===t.y,i=e.z===t.z;return r&&n&&i}function M9e(e,t){var r;return yk(e,t)?r=b9e:vk(e,t)?r=x9e:RM(e,t)&&(r=w9e),r}function S9e(e,t){var r;return yk(e,t)?r="trapezoids":vk(e,t)?r="sectors":RM(e,t)&&(r="points"),r}function T9e(e,t){if(yk(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(vk(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return RM(e,t)?t.payload:{}}function P9e(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,i=S9e(r,t),o=T9e(r,t),s=n.filter(function(u,d){var m=_0(o,u),g=r.props[i].filter(function(M){var x=M9e(r,t);return x(M,t)}),_=r.props[i].indexOf(g[g.length-1]),y=d===_;return m&&y}),a=n.indexOf(s[s.length-1]);return a}var $E;function db(e){"@babel/helpers - typeof";return db=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},db(e)}function s1(){return s1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s1.apply(this,arguments)}function Bq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function es(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Bq(Object(r),!0).forEach(function(n){Ah(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Bq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function E9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Uq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Tce(n.key),n)}}function A9e(e,t,r){return t&&Uq(e.prototype,t),r&&Uq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function C9e(e,t,r){return t=TC(t),k9e(e,Sce()?Reflect.construct(t,r||[],TC(e).constructor):t.apply(e,r))}function k9e(e,t){if(t&&(db(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return I9e(e)}function I9e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Sce(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Sce=function(){return!!e})()}function TC(e){return TC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},TC(e)}function O9e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lN(e,t)}function lN(e,t){return lN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},lN(e,t)}function Ah(e,t,r){return t=Tce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Tce(e){var t=L9e(e,"string");return db(t)=="symbol"?t:t+""}function L9e(e,t){if(db(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(db(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Jp=function(e){function t(r){var n;return E9e(this,t),n=C9e(this,t,[r]),Ah(n,"pieRef",null),Ah(n,"sectorRefs",[]),Ah(n,"id",N0("recharts-pie-")),Ah(n,"handleAnimationEnd",function(){var i=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),Pi(i)&&i()}),Ah(n,"handleAnimationStart",function(){var i=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),Pi(i)&&i()}),n.state={isAnimationFinished:!r.isAnimationActive,prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,sectorToFocus:0},n}return O9e(t,e),A9e(t,[{key:"isActiveIndex",value:function(n){var i=this.props.activeIndex;return Array.isArray(i)?i.indexOf(n)!==-1:n===i}},{key:"hasActiveIndex",value:function(){var n=this.props.activeIndex;return Array.isArray(n)?n.length!==0:n||n===0}},{key:"renderLabels",value:function(n){var i=this.props.isAnimationActive;if(i&&!this.state.isAnimationFinished)return null;var o=this.props,s=o.label,a=o.labelLine,u=o.dataKey,d=o.valueKey,m=ii(this.props,!1),g=ii(s,!1),_=ii(a,!1),y=s&&s.offsetRadius||20,M=n.map(function(x,E){var T=(x.startAngle+x.endAngle)/2,P=ns(x.cx,x.cy,x.outerRadius+y,T),C=es(es(es(es({},m),x),{},{stroke:"none"},g),{},{index:E,textAnchor:t.getTextAnchor(P.x,x.cx)},P),D=es(es(es(es({},m),x),{},{fill:"none",stroke:x.fill},_),{},{index:E,points:[ns(x.cx,x.cy,x.outerRadius,T),P]}),L=u;return zi(u)&&zi(d)?L="value":zi(u)&&(L=d),ct.createElement($o,{key:"label-".concat(x.startAngle,"-").concat(x.endAngle,"-").concat(x.midAngle,"-").concat(E)},a&&t.renderLabelLineItem(a,D,"line"),t.renderLabelItem(s,C,Ol(x,L)))});return ct.createElement($o,{className:"recharts-pie-labels"},M)}},{key:"renderSectorsStatically",value:function(n){var i=this,o=this.props,s=o.activeShape,a=o.blendStroke,u=o.inactiveShape;return n.map(function(d,m){if((d==null?void 0:d.startAngle)===0&&(d==null?void 0:d.endAngle)===0&&n.length!==1)return null;var g=i.isActiveIndex(m),_=u&&i.hasActiveIndex()?u:null,y=g?s:_,M=es(es({},d),{},{stroke:a?d.fill:d.stroke,tabIndex:-1});return ct.createElement($o,s1({ref:function(E){E&&!i.sectorRefs.includes(E)&&i.sectorRefs.push(E)},tabIndex:-1,className:"recharts-pie-sector"},m0(i.props,d,m),{key:"sector-".concat(d==null?void 0:d.startAngle,"-").concat(d==null?void 0:d.endAngle,"-").concat(d.midAngle,"-").concat(m)}),ct.createElement(Mce,s1({option:y,isActive:g,shapeType:"sector"},M)))})}},{key:"renderSectorsWithAnimation",value:function(){var n=this,i=this.props,o=i.sectors,s=i.isAnimationActive,a=i.animationBegin,u=i.animationDuration,d=i.animationEasing,m=i.animationId,g=this.state,_=g.prevSectors,y=g.prevIsAnimationActive;return ct.createElement(Gf,{begin:a,duration:u,isActive:s,easing:d,from:{t:0},to:{t:1},key:"pie-".concat(m,"-").concat(y),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(M){var x=M.t,E=[],T=o&&o[0],P=T.startAngle;return o.forEach(function(C,D){var L=_&&_[D],N=D>0?eh(C,"paddingAngle",0):0;if(L){var j=hc(L.endAngle-L.startAngle,C.endAngle-C.startAngle),$=es(es({},C),{},{startAngle:P+N,endAngle:P+j(x)+N});E.push($),P=$.endAngle}else{var U=C.endAngle,G=C.startAngle,H=hc(0,U-G),X=H(x),ee=es(es({},C),{},{startAngle:P+N,endAngle:P+X+N});E.push(ee),P=ee.endAngle}}),ct.createElement($o,null,n.renderSectorsStatically(E))})}},{key:"attachKeyboardHandlers",value:function(n){var i=this;n.onkeydown=function(o){if(!o.altKey)switch(o.key){case"ArrowLeft":{var s=++i.state.sectorToFocus%i.sectorRefs.length;i.sectorRefs[s].focus(),i.setState({sectorToFocus:s});break}case"ArrowRight":{var a=--i.state.sectorToFocus<0?i.sectorRefs.length-1:i.state.sectorToFocus%i.sectorRefs.length;i.sectorRefs[a].focus(),i.setState({sectorToFocus:a});break}case"Escape":{i.sectorRefs[i.state.sectorToFocus].blur(),i.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var n=this.props,i=n.sectors,o=n.isAnimationActive,s=this.state.prevSectors;return o&&i&&i.length&&(!s||!_0(s,i))?this.renderSectorsWithAnimation():this.renderSectorsStatically(i)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var n=this,i=this.props,o=i.hide,s=i.sectors,a=i.className,u=i.label,d=i.cx,m=i.cy,g=i.innerRadius,_=i.outerRadius,y=i.isAnimationActive,M=this.state.isAnimationFinished;if(o||!s||!s.length||!hn(d)||!hn(m)||!hn(g)||!hn(_))return null;var x=Wi("recharts-pie",a);return ct.createElement($o,{tabIndex:this.props.rootTabIndex,className:x,ref:function(T){n.pieRef=T}},this.renderSectors(),u&&this.renderLabels(s),Rc.renderCallByParent(this.props,null,!1),(!y||M)&&Up.renderCallByParent(this.props,s,!1))}}],[{key:"getDerivedStateFromProps",value:function(n,i){return i.prevIsAnimationActive!==n.isAnimationActive?{prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:[],isAnimationFinished:!0}:n.isAnimationActive&&n.animationId!==i.prevAnimationId?{prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:i.curSectors,isAnimationFinished:!0}:n.sectors!==i.curSectors?{curSectors:n.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(n,i){return n>i?"start":n<i?"end":"middle"}},{key:"renderLabelLineItem",value:function(n,i,o){if(ct.isValidElement(n))return ct.cloneElement(n,i);if(Pi(n))return n(i);var s=Wi("recharts-pie-label-line",typeof n!="boolean"?n.className:"");return ct.createElement(Jy,s1({},i,{key:o,type:"linear",className:s}))}},{key:"renderLabelItem",value:function(n,i,o){if(ct.isValidElement(n))return ct.cloneElement(n,i);var s=o;if(Pi(n)&&(s=n(i),ct.isValidElement(s)))return s;var a=Wi("recharts-pie-label-text",typeof n!="boolean"&&!Pi(n)?n.className:"");return ct.createElement(g0,s1({},i,{alignmentBaseline:"middle",className:a}),s)}}])}(oe.PureComponent);$E=Jp;Ah(Jp,"displayName","Pie");Ah(Jp,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!zf.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});Ah(Jp,"parseDeltaAngle",function(e,t){var r=Uu(t-e),n=Math.min(Math.abs(t-e),360);return r*n});Ah(Jp,"getRealPieData",function(e){var t=e.data,r=e.children,n=ii(e,!1),i=th(r,wS);return t&&t.length?t.map(function(o,s){return es(es(es({payload:o},n),o),i&&i[s]&&i[s].props)}):i&&i.length?i.map(function(o){return es(es({},n),o.props)}):[]});Ah(Jp,"parseCoordinateOfPie",function(e,t){var r=t.top,n=t.left,i=t.width,o=t.height,s=nce(i,o),a=n+Vu(e.cx,i,i/2),u=r+Vu(e.cy,o,o/2),d=Vu(e.innerRadius,s,0),m=Vu(e.outerRadius,s,s*.8),g=e.maxRadius||Math.sqrt(i*i+o*o)/2;return{cx:a,cy:u,innerRadius:d,outerRadius:m,maxRadius:g}});Ah(Jp,"getComposedData",function(e){var t=e.item,r=e.offset,n=t.type.defaultProps!==void 0?es(es({},t.type.defaultProps),t.props):t.props,i=$E.getRealPieData(n);if(!i||!i.length)return null;var o=n.cornerRadius,s=n.startAngle,a=n.endAngle,u=n.paddingAngle,d=n.dataKey,m=n.nameKey,g=n.valueKey,_=n.tooltipType,y=Math.abs(n.minAngle),M=$E.parseCoordinateOfPie(n,r),x=$E.parseDeltaAngle(s,a),E=Math.abs(x),T=d;zi(d)&&zi(g)?(Ff(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),T="value"):zi(d)&&(Ff(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),T=g);var P=i.filter(function($){return Ol($,T,0)!==0}).length,C=(E>=360?P:P-1)*u,D=E-P*y-C,L=i.reduce(function($,U){var G=Ol(U,T,0);return $+(hn(G)?G:0)},0),N;if(L>0){var j;N=i.map(function($,U){var G=Ol($,T,0),H=Ol($,m,U),X=(hn(G)?G:0)/L,ee;U?ee=j.endAngle+Uu(x)*u*(G!==0?1:0):ee=s;var ae=ee+Uu(x)*((G!==0?y:0)+X*D),de=(ee+ae)/2,ye=(M.innerRadius+M.outerRadius)/2,_e=[{name:H,value:G,payload:$,dataKey:T,type:_}],ue=ns(M.cx,M.cy,ye,de);return j=es(es(es({percent:X,cornerRadius:o,name:H,tooltipPayload:_e,midAngle:de,middleRadius:ye,tooltipPosition:ue},$),M),{},{value:Ol($,T),startAngle:ee,endAngle:ae,payload:$,paddingAngle:Uu(x)*u}),j})}return es(es({},M),{},{sectors:N,data:i})});var D9e=Math.ceil,$9e=Math.max;function N9e(e,t,r,n){for(var i=-1,o=$9e(D9e((t-e)/(r||1)),0),s=Array(o);o--;)s[n?o:++i]=e,e+=r;return s}var j9e=N9e,R9e=Wse,Vq=1/0,F9e=17976931348623157e292;function z9e(e){if(!e)return e===0?e:0;if(e=R9e(e),e===Vq||e===-Vq){var t=e<0?-1:1;return t*F9e}return e===e?e:0}var Pce=z9e,B9e=j9e,U9e=nk,wO=Pce;function V9e(e){return function(t,r,n){return n&&typeof n!="number"&&U9e(t,r,n)&&(r=n=void 0),t=wO(t),r===void 0?(r=t,t=0):r=wO(r),n=n===void 0?t<r?1:-1:wO(n),B9e(t,r,n,e)}}var W9e=V9e,G9e=W9e,q9e=G9e(),H9e=q9e;const PC=sa(H9e);function FM(e){"@babel/helpers - typeof";return FM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},FM(e)}function Wq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Gq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Wq(Object(r),!0).forEach(function(n){Ece(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Wq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ece(e,t,r){return t=K9e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function K9e(e){var t=Z9e(e,"string");return FM(t)=="symbol"?t:t+""}function Z9e(e,t){if(FM(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(FM(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var X9e=["Webkit","Moz","O","ms"],Y9e=function(t,r){var n=t.replace(/(\w)/,function(o){return o.toUpperCase()}),i=X9e.reduce(function(o,s){return Gq(Gq({},o),{},Ece({},s+n,r))},{});return i[t]=r,i};function hb(e){"@babel/helpers - typeof";return hb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hb(e)}function EC(){return EC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},EC.apply(this,arguments)}function qq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function MO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qq(Object(r),!0).forEach(function(n){Fd(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Q9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Hq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cce(n.key),n)}}function J9e(e,t,r){return t&&Hq(e.prototype,t),r&&Hq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eGe(e,t,r){return t=AC(t),tGe(e,Ace()?Reflect.construct(t,r||[],AC(e).constructor):t.apply(e,r))}function tGe(e,t){if(t&&(hb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rGe(e)}function rGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ace(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ace=function(){return!!e})()}function AC(e){return AC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},AC(e)}function nGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cN(e,t)}function cN(e,t){return cN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},cN(e,t)}function Fd(e,t,r){return t=Cce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cce(e){var t=iGe(e,"string");return hb(t)=="symbol"?t:t+""}function iGe(e,t){if(hb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oGe=function(t){var r=t.data,n=t.startIndex,i=t.endIndex,o=t.x,s=t.width,a=t.travellerWidth;if(!r||!r.length)return{};var u=r.length,d=y2().domain(PC(0,u)).range([o,o+s-a]),m=d.domain().map(function(g){return d(g)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:d(n),endX:d(i),scale:d,scaleValues:m}},Kq=function(t){return t.changedTouches&&!!t.changedTouches.length},fb=function(e){function t(r){var n;return Q9e(this,t),n=eGe(this,t,[r]),Fd(n,"handleDrag",function(i){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(i):n.state.isSlideMoving&&n.handleSlideDrag(i)}),Fd(n,"handleTouchMove",function(i){i.changedTouches!=null&&i.changedTouches.length>0&&n.handleDrag(i.changedTouches[0])}),Fd(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var i=n.props,o=i.endIndex,s=i.onDragEnd,a=i.startIndex;s==null||s({endIndex:o,startIndex:a})}),n.detachDragEndListener()}),Fd(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),Fd(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),Fd(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),Fd(n,"handleSlideDragStart",function(i){var o=Kq(i)?i.changedTouches[0]:i;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:o.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return nGe(t,e),J9e(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var i=n.startX,o=n.endX,s=this.state.scaleValues,a=this.props,u=a.gap,d=a.data,m=d.length-1,g=Math.min(i,o),_=Math.max(i,o),y=t.getIndexInRange(s,g),M=t.getIndexInRange(s,_);return{startIndex:y-y%u,endIndex:M===m?m:M-M%u}}},{key:"getTextOfTick",value:function(n){var i=this.props,o=i.data,s=i.tickFormatter,a=i.dataKey,u=Ol(o[n],a,n);return Pi(s)?s(u,n):u}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var i=this.state,o=i.slideMoveStartX,s=i.startX,a=i.endX,u=this.props,d=u.x,m=u.width,g=u.travellerWidth,_=u.startIndex,y=u.endIndex,M=u.onChange,x=n.pageX-o;x>0?x=Math.min(x,d+m-g-a,d+m-g-s):x<0&&(x=Math.max(x,d-s,d-a));var E=this.getIndex({startX:s+x,endX:a+x});(E.startIndex!==_||E.endIndex!==y)&&M&&M(E),this.setState({startX:s+x,endX:a+x,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,i){var o=Kq(i)?i.changedTouches[0]:i;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:o.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var i=this.state,o=i.brushMoveStartX,s=i.movingTravellerId,a=i.endX,u=i.startX,d=this.state[s],m=this.props,g=m.x,_=m.width,y=m.travellerWidth,M=m.onChange,x=m.gap,E=m.data,T={startX:this.state.startX,endX:this.state.endX},P=n.pageX-o;P>0?P=Math.min(P,g+_-y-d):P<0&&(P=Math.max(P,g-d)),T[s]=d+P;var C=this.getIndex(T),D=C.startIndex,L=C.endIndex,N=function(){var $=E.length-1;return s==="startX"&&(a>u?D%x===0:L%x===0)||a<u&&L===$||s==="endX"&&(a>u?L%x===0:D%x===0)||a>u&&L===$};this.setState(Fd(Fd({},s,d+P),"brushMoveStartX",n.pageX),function(){M&&N()&&M(C)})}},{key:"handleTravellerMoveKeyboard",value:function(n,i){var o=this,s=this.state,a=s.scaleValues,u=s.startX,d=s.endX,m=this.state[i],g=a.indexOf(m);if(g!==-1){var _=g+n;if(!(_===-1||_>=a.length)){var y=a[_];i==="startX"&&y>=d||i==="endX"&&y<=u||this.setState(Fd({},i,y),function(){o.props.onChange(o.getIndex({startX:o.state.startX,endX:o.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,i=n.x,o=n.y,s=n.width,a=n.height,u=n.fill,d=n.stroke;return ct.createElement("rect",{stroke:d,fill:u,x:i,y:o,width:s,height:a})}},{key:"renderPanorama",value:function(){var n=this.props,i=n.x,o=n.y,s=n.width,a=n.height,u=n.data,d=n.children,m=n.padding,g=oe.Children.only(d);return g?ct.cloneElement(g,{x:i,y:o,width:s,height:a,margin:m,compact:!0,data:u}):null}},{key:"renderTravellerLayer",value:function(n,i){var o,s,a=this,u=this.props,d=u.y,m=u.travellerWidth,g=u.height,_=u.traveller,y=u.ariaLabel,M=u.data,x=u.startIndex,E=u.endIndex,T=Math.max(n,this.props.x),P=MO(MO({},ii(this.props,!1)),{},{x:T,y:d,width:m,height:g}),C=y||"Min value: ".concat((o=M[x])===null||o===void 0?void 0:o.name,", Max value: ").concat((s=M[E])===null||s===void 0?void 0:s.name);return ct.createElement($o,{tabIndex:0,role:"slider","aria-label":C,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[i],onTouchStart:this.travellerDragStartHandlers[i],onKeyDown:function(L){["ArrowLeft","ArrowRight"].includes(L.key)&&(L.preventDefault(),L.stopPropagation(),a.handleTravellerMoveKeyboard(L.key==="ArrowRight"?1:-1,i))},onFocus:function(){a.setState({isTravellerFocused:!0})},onBlur:function(){a.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(_,P))}},{key:"renderSlide",value:function(n,i){var o=this.props,s=o.y,a=o.height,u=o.stroke,d=o.travellerWidth,m=Math.min(n,i)+d,g=Math.max(Math.abs(i-n)-d,0);return ct.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:u,fillOpacity:.2,x:m,y:s,width:g,height:a})}},{key:"renderText",value:function(){var n=this.props,i=n.startIndex,o=n.endIndex,s=n.y,a=n.height,u=n.travellerWidth,d=n.stroke,m=this.state,g=m.startX,_=m.endX,y=5,M={pointerEvents:"none",fill:d};return ct.createElement($o,{className:"recharts-brush-texts"},ct.createElement(g0,EC({textAnchor:"end",verticalAnchor:"middle",x:Math.min(g,_)-y,y:s+a/2},M),this.getTextOfTick(i)),ct.createElement(g0,EC({textAnchor:"start",verticalAnchor:"middle",x:Math.max(g,_)+u+y,y:s+a/2},M),this.getTextOfTick(o)))}},{key:"render",value:function(){var n=this.props,i=n.data,o=n.className,s=n.children,a=n.x,u=n.y,d=n.width,m=n.height,g=n.alwaysShowText,_=this.state,y=_.startX,M=_.endX,x=_.isTextActive,E=_.isSlideMoving,T=_.isTravellerMoving,P=_.isTravellerFocused;if(!i||!i.length||!hn(a)||!hn(u)||!hn(d)||!hn(m)||d<=0||m<=0)return null;var C=Wi("recharts-brush",o),D=ct.Children.count(s)===1,L=Y9e("userSelect","none");return ct.createElement($o,{className:C,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:L},this.renderBackground(),D&&this.renderPanorama(),this.renderSlide(y,M),this.renderTravellerLayer(y,"startX"),this.renderTravellerLayer(M,"endX"),(x||E||T||P||g)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var i=n.x,o=n.y,s=n.width,a=n.height,u=n.stroke,d=Math.floor(o+a/2)-1;return ct.createElement(ct.Fragment,null,ct.createElement("rect",{x:i,y:o,width:s,height:a,fill:u,stroke:"none"}),ct.createElement("line",{x1:i+1,y1:d,x2:i+s-1,y2:d,fill:"none",stroke:"#fff"}),ct.createElement("line",{x1:i+1,y1:d+2,x2:i+s-1,y2:d+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,i){var o;return ct.isValidElement(n)?o=ct.cloneElement(n,i):Pi(n)?o=n(i):o=t.renderDefaultTraveller(i),o}},{key:"getDerivedStateFromProps",value:function(n,i){var o=n.data,s=n.width,a=n.x,u=n.travellerWidth,d=n.updateId,m=n.startIndex,g=n.endIndex;if(o!==i.prevData||d!==i.prevUpdateId)return MO({prevData:o,prevTravellerWidth:u,prevUpdateId:d,prevX:a,prevWidth:s},o&&o.length?oGe({data:o,width:s,x:a,travellerWidth:u,startIndex:m,endIndex:g}):{scale:null,scaleValues:null});if(i.scale&&(s!==i.prevWidth||a!==i.prevX||u!==i.prevTravellerWidth)){i.scale.range([a,a+s-u]);var _=i.scale.domain().map(function(y){return i.scale(y)});return{prevData:o,prevTravellerWidth:u,prevUpdateId:d,prevX:a,prevWidth:s,startX:i.scale(n.startIndex),endX:i.scale(n.endIndex),scaleValues:_}}return null}},{key:"getIndexInRange",value:function(n,i){for(var o=n.length,s=0,a=o-1;a-s>1;){var u=Math.floor((s+a)/2);n[u]>i?a=u:s=u}return i>=n[a]?a:s}}])}(oe.PureComponent);Fd(fb,"displayName","Brush");Fd(fb,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var aGe=hF;function sGe(e,t){var r;return aGe(e,function(n,i,o){return r=t(n,i,o),!r}),!!r}var lGe=sGe,cGe=_se,uGe=Qp,dGe=lGe,hGe=gd,fGe=nk;function pGe(e,t,r){var n=hGe(e)?cGe:dGe;return r&&fGe(e,t,r)&&(t=void 0),n(e,uGe(t))}var mGe=pGe;const gGe=sa(mGe);var Vp=function(t,r){var n=t.alwaysShow,i=t.ifOverflow;return n&&(i="extendDomain"),i===r},Zq=Fse;function _Ge(e,t,r){t=="__proto__"&&Zq?Zq(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var yGe=_Ge,vGe=yGe,bGe=jse,xGe=Qp;function wGe(e,t){var r={};return t=xGe(t),bGe(e,function(n,i,o){vGe(r,i,t(n,i,o))}),r}var MGe=wGe;const SGe=sa(MGe);function TGe(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}var PGe=TGe,EGe=hF;function AGe(e,t){var r=!0;return EGe(e,function(n,i,o){return r=!!t(n,i,o),r}),r}var CGe=AGe,kGe=PGe,IGe=CGe,OGe=Qp,LGe=gd,DGe=nk;function $Ge(e,t,r){var n=LGe(e)?kGe:IGe;return r&&DGe(e,t,r)&&(t=void 0),n(e,OGe(t))}var NGe=$Ge;const kce=sa(NGe);var jGe=["x","y"];function zM(e){"@babel/helpers - typeof";return zM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zM(e)}function uN(){return uN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},uN.apply(this,arguments)}function Xq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Nw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Xq(Object(r),!0).forEach(function(n){RGe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function RGe(e,t,r){return t=FGe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FGe(e){var t=zGe(e,"string");return zM(t)=="symbol"?t:t+""}function zGe(e,t){if(zM(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zM(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function BGe(e,t){if(e==null)return{};var r=UGe(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function UGe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function VGe(e,t){var r=e.x,n=e.y,i=BGe(e,jGe),o="".concat(r),s=parseInt(o,10),a="".concat(n),u=parseInt(a,10),d="".concat(t.height||i.height),m=parseInt(d,10),g="".concat(t.width||i.width),_=parseInt(g,10);return Nw(Nw(Nw(Nw(Nw({},t),i),s?{x:s}:{}),u?{y:u}:{}),{},{height:m,width:_,name:t.name,radius:t.radius})}function Yq(e){return ct.createElement(Mce,uN({shapeType:"rectangle",propTransformer:VGe,activeClassName:"recharts-active-bar"},e))}var WGe=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,i){if(typeof t=="number")return t;var o=hn(n)||gke(n);return o?t(n,i):(o||v0(),r)}},GGe=["value","background"],Ice;function pb(e){"@babel/helpers - typeof";return pb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pb(e)}function qGe(e,t){if(e==null)return{};var r=HGe(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function HGe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function CC(){return CC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},CC.apply(this,arguments)}function Qq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Gl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Qq(Object(r),!0).forEach(function(n){n_(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Lce(n.key),n)}}function ZGe(e,t,r){return t&&Jq(e.prototype,t),r&&Jq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function XGe(e,t,r){return t=kC(t),YGe(e,Oce()?Reflect.construct(t,r||[],kC(e).constructor):t.apply(e,r))}function YGe(e,t){if(t&&(pb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return QGe(e)}function QGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Oce(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Oce=function(){return!!e})()}function kC(e){return kC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},kC(e)}function JGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dN(e,t)}function dN(e,t){return dN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},dN(e,t)}function n_(e,t,r){return t=Lce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lce(e){var t=eqe(e,"string");return pb(t)=="symbol"?t:t+""}function eqe(e,t){if(pb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Nh=function(e){function t(){var r;KGe(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return r=XGe(this,t,[].concat(i)),n_(r,"state",{isAnimationFinished:!1}),n_(r,"id",N0("recharts-bar-")),n_(r,"handleAnimationEnd",function(){var s=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),s&&s()}),n_(r,"handleAnimationStart",function(){var s=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),s&&s()}),r}return JGe(t,e),ZGe(t,[{key:"renderRectanglesStatically",value:function(n){var i=this,o=this.props,s=o.shape,a=o.dataKey,u=o.activeIndex,d=o.activeBar,m=ii(this.props,!1);return n&&n.map(function(g,_){var y=_===u,M=y?d:s,x=Gl(Gl(Gl({},m),g),{},{isActive:y,option:M,index:_,dataKey:a,onAnimationStart:i.handleAnimationStart,onAnimationEnd:i.handleAnimationEnd});return ct.createElement($o,CC({className:"recharts-bar-rectangle"},m0(i.props,g,_),{key:"rectangle-".concat(g==null?void 0:g.x,"-").concat(g==null?void 0:g.y,"-").concat(g==null?void 0:g.value,"-").concat(_)}),ct.createElement(Yq,x))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,i=this.props,o=i.data,s=i.layout,a=i.isAnimationActive,u=i.animationBegin,d=i.animationDuration,m=i.animationEasing,g=i.animationId,_=this.state.prevData;return ct.createElement(Gf,{begin:u,duration:d,isActive:a,easing:m,from:{t:0},to:{t:1},key:"bar-".concat(g),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(y){var M=y.t,x=o.map(function(E,T){var P=_&&_[T];if(P){var C=hc(P.x,E.x),D=hc(P.y,E.y),L=hc(P.width,E.width),N=hc(P.height,E.height);return Gl(Gl({},E),{},{x:C(M),y:D(M),width:L(M),height:N(M)})}if(s==="horizontal"){var j=hc(0,E.height),$=j(M);return Gl(Gl({},E),{},{y:E.y+E.height-$,height:$})}var U=hc(0,E.width),G=U(M);return Gl(Gl({},E),{},{width:G})});return ct.createElement($o,null,n.renderRectanglesStatically(x))})}},{key:"renderRectangles",value:function(){var n=this.props,i=n.data,o=n.isAnimationActive,s=this.state.prevData;return o&&i&&i.length&&(!s||!_0(s,i))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(i)}},{key:"renderBackground",value:function(){var n=this,i=this.props,o=i.data,s=i.dataKey,a=i.activeIndex,u=ii(this.props.background,!1);return o.map(function(d,m){d.value;var g=d.background,_=qGe(d,GGe);if(!g)return null;var y=Gl(Gl(Gl(Gl(Gl({},_),{},{fill:"#eee"},g),u),m0(n.props,d,m)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:s,index:m,className:"recharts-bar-background-rectangle"});return ct.createElement(Yq,CC({key:"background-bar-".concat(m),option:n.props.background,isActive:m===a},y))})}},{key:"renderErrorBar",value:function(n,i){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var o=this.props,s=o.data,a=o.xAxis,u=o.yAxis,d=o.layout,m=o.children,g=th(m,ES);if(!g)return null;var _=d==="vertical"?s[0].height/2:s[0].width/2,y=function(E,T){var P=Array.isArray(E.value)?E.value[1]:E.value;return{x:E.x,y:E.y,value:P,errorVal:Ol(E,T)}},M={clipPath:n?"url(#clipPath-".concat(i,")"):null};return ct.createElement($o,M,g.map(function(x){return ct.cloneElement(x,{key:"error-bar-".concat(i,"-").concat(x.props.dataKey),data:s,xAxis:a,yAxis:u,layout:d,offset:_,dataPointFormatter:y})}))}},{key:"render",value:function(){var n=this.props,i=n.hide,o=n.data,s=n.className,a=n.xAxis,u=n.yAxis,d=n.left,m=n.top,g=n.width,_=n.height,y=n.isAnimationActive,M=n.background,x=n.id;if(i||!o||!o.length)return null;var E=this.state.isAnimationFinished,T=Wi("recharts-bar",s),P=a&&a.allowDataOverflow,C=u&&u.allowDataOverflow,D=P||C,L=zi(x)?this.id:x;return ct.createElement($o,{className:T},P||C?ct.createElement("defs",null,ct.createElement("clipPath",{id:"clipPath-".concat(L)},ct.createElement("rect",{x:P?d:d-g/2,y:C?m:m-_/2,width:P?g:g*2,height:C?_:_*2}))):null,ct.createElement($o,{className:"recharts-bar-rectangles",clipPath:D?"url(#clipPath-".concat(L,")"):null},M?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(D,L),(!y||E)&&Up.renderCallByParent(this.props,o))}}],[{key:"getDerivedStateFromProps",value:function(n,i){return n.animationId!==i.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:i.curData}:n.data!==i.curData?{curData:n.data}:null}}])}(oe.PureComponent);Ice=Nh;n_(Nh,"displayName","Bar");n_(Nh,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!zf.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});n_(Nh,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,i=e.bandSize,o=e.xAxis,s=e.yAxis,a=e.xAxisTicks,u=e.yAxisTicks,d=e.stackedData,m=e.dataStartIndex,g=e.displayedData,_=e.offset,y=D8e(n,r);if(!y)return null;var M=t.layout,x=r.type.defaultProps,E=x!==void 0?Gl(Gl({},x),r.props):r.props,T=E.dataKey,P=E.children,C=E.minPointSize,D=M==="horizontal"?s:o,L=d?D.scale.domain():null,N=B8e({numericAxis:D}),j=th(P,wS),$=g.map(function(U,G){var H,X,ee,ae,de,ye;d?H=$8e(d[m+G],L):(H=Ol(U,T),Array.isArray(H)||(H=[N,H]));var _e=WGe(C,Ice.defaultProps.minPointSize)(H[1],G);if(M==="horizontal"){var ue,fe=[s.scale(H[0]),s.scale(H[1])],De=fe[0],pe=fe[1];X=UG({axis:o,ticks:a,bandSize:i,offset:y.offset,entry:U,index:G}),ee=(ue=pe??De)!==null&&ue!==void 0?ue:void 0,ae=y.size;var K=De-pe;if(de=Number.isNaN(K)?0:K,ye={x:X,y:s.y,width:ae,height:s.height},Math.abs(_e)>0&&Math.abs(de)<Math.abs(_e)){var te=Uu(de||_e)*(Math.abs(_e)-Math.abs(de));ee-=te,de+=te}}else{var ve=[o.scale(H[0]),o.scale(H[1])],$e=ve[0],Ce=ve[1];if(X=$e,ee=UG({axis:s,ticks:u,bandSize:i,offset:y.offset,entry:U,index:G}),ae=Ce-$e,de=y.size,ye={x:o.x,y:ee,width:o.width,height:de},Math.abs(_e)>0&&Math.abs(ae)<Math.abs(_e)){var Ge=Uu(ae||_e)*(Math.abs(_e)-Math.abs(ae));ae+=Ge}}return Gl(Gl(Gl({},U),{},{x:X,y:ee,width:ae,height:de,value:d?H:H[1],payload:U,background:ye},j&&j[G]&&j[G].props),{},{tooltipPayload:[tce(r,U)],tooltipPosition:{x:X+ae/2,y:ee+de/2}})});return Gl({data:$,layout:M},_)});function BM(e){"@babel/helpers - typeof";return BM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},BM(e)}function tqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Dce(n.key),n)}}function rqe(e,t,r){return t&&eH(e.prototype,t),r&&eH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Cf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tH(Object(r),!0).forEach(function(n){bk(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bk(e,t,r){return t=Dce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Dce(e){var t=nqe(e,"string");return BM(t)=="symbol"?t:t+""}function nqe(e,t){if(BM(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(BM(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BF=function(t,r,n,i,o){var s=t.width,a=t.height,u=t.layout,d=t.children,m=Object.keys(r),g={left:n.left,leftMirror:n.left,right:s-n.right,rightMirror:s-n.right,top:n.top,topMirror:n.top,bottom:a-n.bottom,bottomMirror:a-n.bottom},_=!!Ud(d,Nh);return m.reduce(function(y,M){var x=r[M],E=x.orientation,T=x.domain,P=x.padding,C=P===void 0?{}:P,D=x.mirror,L=x.reversed,N="".concat(E).concat(D?"Mirror":""),j,$,U,G,H;if(x.type==="number"&&(x.padding==="gap"||x.padding==="no-gap")){var X=T[1]-T[0],ee=1/0,ae=x.categoricalDomain.sort(vke);if(ae.forEach(function(ve,$e){$e>0&&(ee=Math.min((ve||0)-(ae[$e-1]||0),ee))}),Number.isFinite(ee)){var de=ee/X,ye=x.layout==="vertical"?n.height:n.width;if(x.padding==="gap"&&(j=de*ye/2),x.padding==="no-gap"){var _e=Vu(t.barCategoryGap,de*ye),ue=de*ye/2;j=ue-_e-(ue-_e)/ye*_e}}}i==="xAxis"?$=[n.left+(C.left||0)+(j||0),n.left+n.width-(C.right||0)-(j||0)]:i==="yAxis"?$=u==="horizontal"?[n.top+n.height-(C.bottom||0),n.top+(C.top||0)]:[n.top+(C.top||0)+(j||0),n.top+n.height-(C.bottom||0)-(j||0)]:$=x.range,L&&($=[$[1],$[0]]);var fe=Yle(x,o,_),De=fe.scale,pe=fe.realScaleType;De.domain(T).range($),Qle(De);var K=Jle(De,Cf(Cf({},x),{},{realScaleType:pe}));i==="xAxis"?(H=E==="top"&&!D||E==="bottom"&&D,U=n.left,G=g[N]-H*x.height):i==="yAxis"&&(H=E==="left"&&!D||E==="right"&&D,U=g[N]-H*x.width,G=n.top);var te=Cf(Cf(Cf({},x),K),{},{realScaleType:pe,x:U,y:G,scale:De,width:i==="xAxis"?n.width:x.width,height:i==="yAxis"?n.height:x.height});return te.bandSize=pC(te,K),!x.hide&&i==="xAxis"?g[N]+=(H?-1:1)*te.height:x.hide||(g[N]+=(H?-1:1)*te.width),Cf(Cf({},y),{},bk({},M,te))},{})},$ce=function(t,r){var n=t.x,i=t.y,o=r.x,s=r.y;return{x:Math.min(n,o),y:Math.min(i,s),width:Math.abs(o-n),height:Math.abs(s-i)}},iqe=function(t){var r=t.x1,n=t.y1,i=t.x2,o=t.y2;return $ce({x:r,y:n},{x:i,y:o})},Nce=function(){function e(t){tqe(this,e),this.scale=t}return rqe(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.bandAware,o=n.position;if(r!==void 0){if(o)switch(o){case"start":return this.scale(r);case"middle":{var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+s}case"end":{var a=this.bandwidth?this.bandwidth():0;return this.scale(r)+a}default:return this.scale(r)}if(i){var u=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+u}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),i=n[0],o=n[n.length-1];return i<=o?r>=i&&r<=o:r>=o&&r<=i}}],[{key:"create",value:function(r){return new e(r)}}])}();bk(Nce,"EPS",1e-4);var UF=function(t){var r=Object.keys(t).reduce(function(n,i){return Cf(Cf({},n),{},bk({},i,Nce.create(t[i])))},{});return Cf(Cf({},r),{},{apply:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=o.bandAware,a=o.position;return SGe(i,function(u,d){return r[d].apply(u,{bandAware:s,position:a})})},isInRange:function(i){return kce(i,function(o,s){return r[s].isInRange(o)})}})};function oqe(e){return(e%180+180)%180}var aqe=function(t){var r=t.width,n=t.height,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=oqe(i),s=o*Math.PI/180,a=Math.atan(n/r),u=s>a&&s<Math.PI-a?n/Math.sin(s):r/Math.cos(s);return Math.abs(u)},sqe=Qp,lqe=xS,cqe=tk;function uqe(e){return function(t,r,n){var i=Object(t);if(!lqe(t)){var o=sqe(r);t=cqe(t),r=function(a){return o(i[a],a,i)}}var s=e(t,r,n);return s>-1?i[o?t[s]:s]:void 0}}var dqe=uqe,hqe=Pce;function fqe(e){var t=hqe(e),r=t%1;return t===t?r?t-r:t:0}var pqe=fqe,mqe=Ise,gqe=Qp,_qe=pqe,yqe=Math.max;function vqe(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var i=r==null?0:_qe(r);return i<0&&(i=yqe(n+i,0)),mqe(e,gqe(t),i)}var bqe=vqe,xqe=dqe,wqe=bqe,Mqe=xqe(wqe),Sqe=Mqe;const Tqe=sa(Sqe);var Pqe=b5e(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),VF=oe.createContext(void 0),WF=oe.createContext(void 0),jce=oe.createContext(void 0),Rce=oe.createContext({}),Fce=oe.createContext(void 0),zce=oe.createContext(0),Bce=oe.createContext(0),rH=function(t){var r=t.state,n=r.xAxisMap,i=r.yAxisMap,o=r.offset,s=t.clipPathId,a=t.children,u=t.width,d=t.height,m=Pqe(o);return ct.createElement(VF.Provider,{value:n},ct.createElement(WF.Provider,{value:i},ct.createElement(Rce.Provider,{value:o},ct.createElement(jce.Provider,{value:m},ct.createElement(Fce.Provider,{value:s},ct.createElement(zce.Provider,{value:d},ct.createElement(Bce.Provider,{value:u},a)))))))},Eqe=function(){return oe.useContext(Fce)},Uce=function(t){var r=oe.useContext(VF);r==null&&v0();var n=r[t];return n==null&&v0(),n},Aqe=function(){var t=oe.useContext(VF);return qg(t)},Cqe=function(){var t=oe.useContext(WF),r=Tqe(t,function(n){return kce(n.domain,Number.isFinite)});return r||qg(t)},Vce=function(t){var r=oe.useContext(WF);r==null&&v0();var n=r[t];return n==null&&v0(),n},kqe=function(){var t=oe.useContext(jce);return t},Iqe=function(){return oe.useContext(Rce)},GF=function(){return oe.useContext(Bce)},qF=function(){return oe.useContext(zce)};function mb(e){"@babel/helpers - typeof";return mb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mb(e)}function Oqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Lqe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Gce(n.key),n)}}function Dqe(e,t,r){return t&&Lqe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function $qe(e,t,r){return t=IC(t),Nqe(e,Wce()?Reflect.construct(t,r||[],IC(e).constructor):t.apply(e,r))}function Nqe(e,t){if(t&&(mb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jqe(e)}function jqe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wce(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Wce=function(){return!!e})()}function IC(e){return IC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},IC(e)}function Rqe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hN(e,t)}function hN(e,t){return hN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},hN(e,t)}function nH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function iH(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nH(Object(r),!0).forEach(function(n){HF(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function HF(e,t,r){return t=Gce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gce(e){var t=Fqe(e,"string");return mb(t)=="symbol"?t:t+""}function Fqe(e,t){if(mb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zqe(e,t){return Wqe(e)||Vqe(e,t)||Uqe(e,t)||Bqe()}function Bqe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Uqe(e,t){if(e){if(typeof e=="string")return oH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oH(e,t)}}function oH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Vqe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],u=!0,d=!1;try{if(o=(r=r.call(e)).next,t!==0)for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);u=!0);}catch(m){d=!0,i=m}finally{try{if(!u&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw i}}return a}}function Wqe(e){if(Array.isArray(e))return e}function fN(){return fN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fN.apply(this,arguments)}var Gqe=function(t,r){var n;return ct.isValidElement(t)?n=ct.cloneElement(t,r):Pi(t)?n=t(r):n=ct.createElement("line",fN({},r,{className:"recharts-reference-line-line"})),n},qqe=function(t,r,n,i,o,s,a,u,d){var m=o.x,g=o.y,_=o.width,y=o.height;if(n){var M=d.y,x=t.y.apply(M,{position:s});if(Vp(d,"discard")&&!t.y.isInRange(x))return null;var E=[{x:m+_,y:x},{x:m,y:x}];return u==="left"?E.reverse():E}if(r){var T=d.x,P=t.x.apply(T,{position:s});if(Vp(d,"discard")&&!t.x.isInRange(P))return null;var C=[{x:P,y:g+y},{x:P,y:g}];return a==="top"?C.reverse():C}if(i){var D=d.segment,L=D.map(function(N){return t.apply(N,{position:s})});return Vp(d,"discard")&&gGe(L,function(N){return!t.isInRange(N)})?null:L}return null};function Hqe(e){var t=e.x,r=e.y,n=e.segment,i=e.xAxisId,o=e.yAxisId,s=e.shape,a=e.className,u=e.alwaysShow,d=Eqe(),m=Uce(i),g=Vce(o),_=kqe();if(!d||!_)return null;Ff(u===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var y=UF({x:m.scale,y:g.scale}),M=pc(t),x=pc(r),E=n&&n.length===2,T=qqe(y,M,x,E,_,e.position,m.orientation,g.orientation,e);if(!T)return null;var P=zqe(T,2),C=P[0],D=C.x,L=C.y,N=P[1],j=N.x,$=N.y,U=Vp(e,"hidden")?"url(#".concat(d,")"):void 0,G=iH(iH({clipPath:U},ii(e,!0)),{},{x1:D,y1:L,x2:j,y2:$});return ct.createElement($o,{className:Wi("recharts-reference-line",a)},Gqe(s,G),Rc.renderCallByParent(e,iqe({x1:D,y1:L,x2:j,y2:$})))}var KF=function(e){function t(){return Oqe(this,t),$qe(this,t,arguments)}return Rqe(t,e),Dqe(t,[{key:"render",value:function(){return ct.createElement(Hqe,this.props)}}])}(ct.Component);HF(KF,"displayName","ReferenceLine");HF(KF,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function pN(){return pN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},pN.apply(this,arguments)}function gb(e){"@babel/helpers - typeof";return gb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gb(e)}function aH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function sH(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aH(Object(r),!0).forEach(function(n){xk(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Kqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zqe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hce(n.key),n)}}function Xqe(e,t,r){return t&&Zqe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yqe(e,t,r){return t=OC(t),Qqe(e,qce()?Reflect.construct(t,r||[],OC(e).constructor):t.apply(e,r))}function Qqe(e,t){if(t&&(gb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Jqe(e)}function Jqe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qce(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(qce=function(){return!!e})()}function OC(e){return OC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},OC(e)}function eHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mN(e,t)}function mN(e,t){return mN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},mN(e,t)}function xk(e,t,r){return t=Hce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hce(e){var t=tHe(e,"string");return gb(t)=="symbol"?t:t+""}function tHe(e,t){if(gb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rHe=function(t){var r=t.x,n=t.y,i=t.xAxis,o=t.yAxis,s=UF({x:i.scale,y:o.scale}),a=s.apply({x:r,y:n},{bandAware:!0});return Vp(t,"discard")&&!s.isInRange(a)?null:a},wk=function(e){function t(){return Kqe(this,t),Yqe(this,t,arguments)}return eHe(t,e),Xqe(t,[{key:"render",value:function(){var n=this.props,i=n.x,o=n.y,s=n.r,a=n.alwaysShow,u=n.clipPathId,d=pc(i),m=pc(o);if(Ff(a===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!d||!m)return null;var g=rHe(this.props);if(!g)return null;var _=g.x,y=g.y,M=this.props,x=M.shape,E=M.className,T=Vp(this.props,"hidden")?"url(#".concat(u,")"):void 0,P=sH(sH({clipPath:T},ii(this.props,!0)),{},{cx:_,cy:y});return ct.createElement($o,{className:Wi("recharts-reference-dot",E)},t.renderDot(x,P),Rc.renderCallByParent(this.props,{x:_-s,y:y-s,width:2*s,height:2*s}))}}])}(ct.Component);xk(wk,"displayName","ReferenceDot");xk(wk,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});xk(wk,"renderDot",function(e,t){var r;return ct.isValidElement(e)?r=ct.cloneElement(e,t):Pi(e)?r=e(t):r=ct.createElement(AS,pN({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function gN(){return gN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gN.apply(this,arguments)}function _b(e){"@babel/helpers - typeof";return _b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_b(e)}function lH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function cH(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lH(Object(r),!0).forEach(function(n){Mk(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iHe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zce(n.key),n)}}function oHe(e,t,r){return t&&iHe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function aHe(e,t,r){return t=LC(t),sHe(e,Kce()?Reflect.construct(t,r||[],LC(e).constructor):t.apply(e,r))}function sHe(e,t){if(t&&(_b(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lHe(e)}function lHe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kce(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Kce=function(){return!!e})()}function LC(e){return LC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},LC(e)}function cHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_N(e,t)}function _N(e,t){return _N=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},_N(e,t)}function Mk(e,t,r){return t=Zce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Zce(e){var t=uHe(e,"string");return _b(t)=="symbol"?t:t+""}function uHe(e,t){if(_b(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_b(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dHe=function(t,r,n,i,o){var s=o.x1,a=o.x2,u=o.y1,d=o.y2,m=o.xAxis,g=o.yAxis;if(!m||!g)return null;var _=UF({x:m.scale,y:g.scale}),y={x:t?_.x.apply(s,{position:"start"}):_.x.rangeMin,y:n?_.y.apply(u,{position:"start"}):_.y.rangeMin},M={x:r?_.x.apply(a,{position:"end"}):_.x.rangeMax,y:i?_.y.apply(d,{position:"end"}):_.y.rangeMax};return Vp(o,"discard")&&(!_.isInRange(y)||!_.isInRange(M))?null:$ce(y,M)},Sk=function(e){function t(){return nHe(this,t),aHe(this,t,arguments)}return cHe(t,e),oHe(t,[{key:"render",value:function(){var n=this.props,i=n.x1,o=n.x2,s=n.y1,a=n.y2,u=n.className,d=n.alwaysShow,m=n.clipPathId;Ff(d===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var g=pc(i),_=pc(o),y=pc(s),M=pc(a),x=this.props.shape;if(!g&&!_&&!y&&!M&&!x)return null;var E=dHe(g,_,y,M,this.props);if(!E&&!x)return null;var T=Vp(this.props,"hidden")?"url(#".concat(m,")"):void 0;return ct.createElement($o,{className:Wi("recharts-reference-area",u)},t.renderRect(x,cH(cH({clipPath:T},ii(this.props,!0)),E)),Rc.renderCallByParent(this.props,E))}}])}(ct.Component);Mk(Sk,"displayName","ReferenceArea");Mk(Sk,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});Mk(Sk,"renderRect",function(e,t){var r;return ct.isValidElement(e)?r=ct.cloneElement(e,t):Pi(e)?r=e(t):r=ct.createElement(zF,gN({},t,{className:"recharts-reference-area-rect"})),r});function Xce(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],i=0;i<e.length;i+=t)n.push(e[i]);return n}function hHe(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return aqe(n,r)}function fHe(e,t,r){var n=r==="width",i=e.x,o=e.y,s=e.width,a=e.height;return t===1?{start:n?i:o,end:n?i+s:o+a}:{start:n?i+s:o+a,end:n?i:o}}function DC(e,t,r,n,i){if(e*t<e*n||e*t>e*i)return!1;var o=r();return e*(t-e*o/2-n)>=0&&e*(t+e*o/2-i)<=0}function pHe(e,t){return Xce(e,t+1)}function mHe(e,t,r,n,i){for(var o=(n||[]).slice(),s=t.start,a=t.end,u=0,d=1,m=s,g=function(){var M=n==null?void 0:n[u];if(M===void 0)return{v:Xce(n,d)};var x=u,E,T=function(){return E===void 0&&(E=r(M,x)),E},P=M.coordinate,C=u===0||DC(e,P,T,m,a);C||(u=0,m=s,d+=1),C&&(m=P+e*(T()/2+i),u+=d)},_;d<=o.length;)if(_=g(),_)return _.v;return[]}function UM(e){"@babel/helpers - typeof";return UM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},UM(e)}function uH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Su(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uH(Object(r),!0).forEach(function(n){gHe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gHe(e,t,r){return t=_He(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _He(e){var t=yHe(e,"string");return UM(t)=="symbol"?t:t+""}function yHe(e,t){if(UM(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(UM(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vHe(e,t,r,n,i){for(var o=(n||[]).slice(),s=o.length,a=t.start,u=t.end,d=function(_){var y=o[_],M,x=function(){return M===void 0&&(M=r(y,_)),M};if(_===s-1){var E=e*(y.coordinate+e*x()/2-u);o[_]=y=Su(Su({},y),{},{tickCoord:E>0?y.coordinate-E*e:y.coordinate})}else o[_]=y=Su(Su({},y),{},{tickCoord:y.coordinate});var T=DC(e,y.tickCoord,x,a,u);T&&(u=y.tickCoord-e*(x()/2+i),o[_]=Su(Su({},y),{},{isShow:!0}))},m=s-1;m>=0;m--)d(m);return o}function bHe(e,t,r,n,i,o){var s=(n||[]).slice(),a=s.length,u=t.start,d=t.end;if(o){var m=n[a-1],g=r(m,a-1),_=e*(m.coordinate+e*g/2-d);s[a-1]=m=Su(Su({},m),{},{tickCoord:_>0?m.coordinate-_*e:m.coordinate});var y=DC(e,m.tickCoord,function(){return g},u,d);y&&(d=m.tickCoord-e*(g/2+i),s[a-1]=Su(Su({},m),{},{isShow:!0}))}for(var M=o?a-1:a,x=function(P){var C=s[P],D,L=function(){return D===void 0&&(D=r(C,P)),D};if(P===0){var N=e*(C.coordinate-e*L()/2-u);s[P]=C=Su(Su({},C),{},{tickCoord:N<0?C.coordinate-N*e:C.coordinate})}else s[P]=C=Su(Su({},C),{},{tickCoord:C.coordinate});var j=DC(e,C.tickCoord,L,u,d);j&&(u=C.tickCoord+e*(L()/2+i),s[P]=Su(Su({},C),{},{isShow:!0}))},E=0;E<M;E++)x(E);return s}function ZF(e,t,r){var n=e.tick,i=e.ticks,o=e.viewBox,s=e.minTickGap,a=e.orientation,u=e.interval,d=e.tickFormatter,m=e.unit,g=e.angle;if(!i||!i.length||!n)return[];if(hn(u)||zf.isSsr)return pHe(i,typeof u=="number"&&hn(u)?u:0);var _=[],y=a==="top"||a==="bottom"?"width":"height",M=m&&y==="width"?_2(m,{fontSize:t,letterSpacing:r}):{width:0,height:0},x=function(C,D){var L=Pi(d)?d(C.value,D):C.value;return y==="width"?hHe(_2(L,{fontSize:t,letterSpacing:r}),M,g):_2(L,{fontSize:t,letterSpacing:r})[y]},E=i.length>=2?Uu(i[1].coordinate-i[0].coordinate):1,T=fHe(o,E,y);return u==="equidistantPreserveStart"?mHe(E,T,x,i,s):(u==="preserveStart"||u==="preserveStartEnd"?_=bHe(E,T,x,i,s,u==="preserveStartEnd"):_=vHe(E,T,x,i,s),_.filter(function(P){return P.isShow}))}var xHe=["viewBox"],wHe=["viewBox"],MHe=["ticks"];function yb(e){"@babel/helpers - typeof";return yb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yb(e)}function l1(){return l1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},l1.apply(this,arguments)}function dH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function cc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dH(Object(r),!0).forEach(function(n){XF(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function SO(e,t){if(e==null)return{};var r=SHe(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function SHe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function THe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qce(n.key),n)}}function PHe(e,t,r){return t&&hH(e.prototype,t),r&&hH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EHe(e,t,r){return t=$C(t),AHe(e,Yce()?Reflect.construct(t,r||[],$C(e).constructor):t.apply(e,r))}function AHe(e,t){if(t&&(yb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CHe(e)}function CHe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yce(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Yce=function(){return!!e})()}function $C(e){return $C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$C(e)}function kHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yN(e,t)}function yN(e,t){return yN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},yN(e,t)}function XF(e,t,r){return t=Qce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qce(e){var t=IHe(e,"string");return yb(t)=="symbol"?t:t+""}function IHe(e,t){if(yb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ex=function(e){function t(r){var n;return THe(this,t),n=EHe(this,t,[r]),n.state={fontSize:"",letterSpacing:""},n}return kHe(t,e),PHe(t,[{key:"shouldComponentUpdate",value:function(n,i){var o=n.viewBox,s=SO(n,xHe),a=this.props,u=a.viewBox,d=SO(a,wHe);return!x1(o,u)||!x1(s,d)||!x1(i,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var i=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];i&&this.setState({fontSize:window.getComputedStyle(i).fontSize,letterSpacing:window.getComputedStyle(i).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var i=this.props,o=i.x,s=i.y,a=i.width,u=i.height,d=i.orientation,m=i.tickSize,g=i.mirror,_=i.tickMargin,y,M,x,E,T,P,C=g?-1:1,D=n.tickSize||m,L=hn(n.tickCoord)?n.tickCoord:n.coordinate;switch(d){case"top":y=M=n.coordinate,E=s+ +!g*u,x=E-C*D,P=x-C*_,T=L;break;case"left":x=E=n.coordinate,M=o+ +!g*a,y=M-C*D,T=y-C*_,P=L;break;case"right":x=E=n.coordinate,M=o+ +g*a,y=M+C*D,T=y+C*_,P=L;break;default:y=M=n.coordinate,E=s+ +g*u,x=E+C*D,P=x+C*_,T=L;break}return{line:{x1:y,y1:x,x2:M,y2:E},tick:{x:T,y:P}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,i=n.orientation,o=n.mirror,s;switch(i){case"left":s=o?"start":"end";break;case"right":s=o?"end":"start";break;default:s="middle";break}return s}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,i=n.orientation,o=n.mirror,s="end";switch(i){case"left":case"right":s="middle";break;case"top":s=o?"start":"end";break;default:s=o?"end":"start";break}return s}},{key:"renderAxisLine",value:function(){var n=this.props,i=n.x,o=n.y,s=n.width,a=n.height,u=n.orientation,d=n.mirror,m=n.axisLine,g=cc(cc(cc({},ii(this.props,!1)),ii(m,!1)),{},{fill:"none"});if(u==="top"||u==="bottom"){var _=+(u==="top"&&!d||u==="bottom"&&d);g=cc(cc({},g),{},{x1:i,y1:o+_*a,x2:i+s,y2:o+_*a})}else{var y=+(u==="left"&&!d||u==="right"&&d);g=cc(cc({},g),{},{x1:i+y*s,y1:o,x2:i+y*s,y2:o+a})}return ct.createElement("line",l1({},g,{className:Wi("recharts-cartesian-axis-line",eh(m,"className"))}))}},{key:"renderTicks",value:function(n,i,o){var s=this,a=this.props,u=a.tickLine,d=a.stroke,m=a.tick,g=a.tickFormatter,_=a.unit,y=ZF(cc(cc({},this.props),{},{ticks:n}),i,o),M=this.getTickTextAnchor(),x=this.getTickVerticalAnchor(),E=ii(this.props,!1),T=ii(m,!1),P=cc(cc({},E),{},{fill:"none"},ii(u,!1)),C=y.map(function(D,L){var N=s.getTickLineCoord(D),j=N.line,$=N.tick,U=cc(cc(cc(cc({textAnchor:M,verticalAnchor:x},E),{},{stroke:"none",fill:d},T),$),{},{index:L,payload:D,visibleTicksCount:y.length,tickFormatter:g});return ct.createElement($o,l1({className:"recharts-cartesian-axis-tick",key:"tick-".concat(D.value,"-").concat(D.coordinate,"-").concat(D.tickCoord)},m0(s.props,D,L)),u&&ct.createElement("line",l1({},P,j,{className:Wi("recharts-cartesian-axis-tick-line",eh(u,"className"))})),m&&t.renderTickItem(m,U,"".concat(Pi(g)?g(D.value,L):D.value).concat(_||"")))});return ct.createElement("g",{className:"recharts-cartesian-axis-ticks"},C)}},{key:"render",value:function(){var n=this,i=this.props,o=i.axisLine,s=i.width,a=i.height,u=i.ticksGenerator,d=i.className,m=i.hide;if(m)return null;var g=this.props,_=g.ticks,y=SO(g,MHe),M=_;return Pi(u)&&(M=_&&_.length>0?u(this.props):u(y)),s<=0||a<=0||!M||!M.length?null:ct.createElement($o,{className:Wi("recharts-cartesian-axis",d),ref:function(E){n.layerReference=E}},o&&this.renderAxisLine(),this.renderTicks(M,this.state.fontSize,this.state.letterSpacing),Rc.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,i,o){var s,a=Wi(i.className,"recharts-cartesian-axis-tick-value");return ct.isValidElement(n)?s=ct.cloneElement(n,cc(cc({},i),{},{className:a})):Pi(n)?s=n(cc(cc({},i),{},{className:a})):s=ct.createElement(g0,l1({},i,{className:"recharts-cartesian-axis-tick-value"}),o),s}}])}(oe.Component);XF(ex,"displayName","CartesianAxis");XF(ex,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var OHe=["x1","y1","x2","y2","key"],LHe=["offset"];function b0(e){"@babel/helpers - typeof";return b0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b0(e)}function fH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Pu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fH(Object(r),!0).forEach(function(n){DHe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function DHe(e,t,r){return t=$He(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $He(e){var t=NHe(e,"string");return b0(t)=="symbol"?t:t+""}function NHe(e,t){if(b0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(b0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ny(){return Ny=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ny.apply(this,arguments)}function pH(e,t){if(e==null)return{};var r=jHe(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function jHe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var RHe=function(t){var r=t.fill;if(!r||r==="none")return null;var n=t.fillOpacity,i=t.x,o=t.y,s=t.width,a=t.height,u=t.ry;return ct.createElement("rect",{x:i,y:o,ry:u,width:s,height:a,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function Jce(e,t){var r;if(ct.isValidElement(e))r=ct.cloneElement(e,t);else if(Pi(e))r=e(t);else{var n=t.x1,i=t.y1,o=t.x2,s=t.y2,a=t.key,u=pH(t,OHe),d=ii(u,!1);d.offset;var m=pH(d,LHe);r=ct.createElement("line",Ny({},m,{x1:n,y1:i,x2:o,y2:s,fill:"none",key:a}))}return r}function FHe(e){var t=e.x,r=e.width,n=e.horizontal,i=n===void 0?!0:n,o=e.horizontalPoints;if(!i||!o||!o.length)return null;var s=o.map(function(a,u){var d=Pu(Pu({},e),{},{x1:t,y1:a,x2:t+r,y2:a,key:"line-".concat(u),index:u});return Jce(i,d)});return ct.createElement("g",{className:"recharts-cartesian-grid-horizontal"},s)}function zHe(e){var t=e.y,r=e.height,n=e.vertical,i=n===void 0?!0:n,o=e.verticalPoints;if(!i||!o||!o.length)return null;var s=o.map(function(a,u){var d=Pu(Pu({},e),{},{x1:a,y1:t,x2:a,y2:t+r,key:"line-".concat(u),index:u});return Jce(i,d)});return ct.createElement("g",{className:"recharts-cartesian-grid-vertical"},s)}function BHe(e){var t=e.horizontalFill,r=e.fillOpacity,n=e.x,i=e.y,o=e.width,s=e.height,a=e.horizontalPoints,u=e.horizontal,d=u===void 0?!0:u;if(!d||!t||!t.length)return null;var m=a.map(function(_){return Math.round(_+i-i)}).sort(function(_,y){return _-y});i!==m[0]&&m.unshift(0);var g=m.map(function(_,y){var M=!m[y+1],x=M?i+s-_:m[y+1]-_;if(x<=0)return null;var E=y%t.length;return ct.createElement("rect",{key:"react-".concat(y),y:_,x:n,height:x,width:o,stroke:"none",fill:t[E],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return ct.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},g)}function UHe(e){var t=e.vertical,r=t===void 0?!0:t,n=e.verticalFill,i=e.fillOpacity,o=e.x,s=e.y,a=e.width,u=e.height,d=e.verticalPoints;if(!r||!n||!n.length)return null;var m=d.map(function(_){return Math.round(_+o-o)}).sort(function(_,y){return _-y});o!==m[0]&&m.unshift(0);var g=m.map(function(_,y){var M=!m[y+1],x=M?o+a-_:m[y+1]-_;if(x<=0)return null;var E=y%n.length;return ct.createElement("rect",{key:"react-".concat(y),x:_,y:s,width:x,height:u,stroke:"none",fill:n[E],fillOpacity:i,className:"recharts-cartesian-grid-bg"})});return ct.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},g)}var VHe=function(t,r){var n=t.xAxis,i=t.width,o=t.height,s=t.offset;return Xle(ZF(Pu(Pu(Pu({},ex.defaultProps),n),{},{ticks:$m(n,!0),viewBox:{x:0,y:0,width:i,height:o}})),s.left,s.left+s.width,r)},WHe=function(t,r){var n=t.yAxis,i=t.width,o=t.height,s=t.offset;return Xle(ZF(Pu(Pu(Pu({},ex.defaultProps),n),{},{ticks:$m(n,!0),viewBox:{x:0,y:0,width:i,height:o}})),s.top,s.top+s.height,r)},Cv={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function VM(e){var t,r,n,i,o,s,a=GF(),u=qF(),d=Iqe(),m=Pu(Pu({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:Cv.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:Cv.fill,horizontal:(n=e.horizontal)!==null&&n!==void 0?n:Cv.horizontal,horizontalFill:(i=e.horizontalFill)!==null&&i!==void 0?i:Cv.horizontalFill,vertical:(o=e.vertical)!==null&&o!==void 0?o:Cv.vertical,verticalFill:(s=e.verticalFill)!==null&&s!==void 0?s:Cv.verticalFill,x:hn(e.x)?e.x:d.left,y:hn(e.y)?e.y:d.top,width:hn(e.width)?e.width:d.width,height:hn(e.height)?e.height:d.height}),g=m.x,_=m.y,y=m.width,M=m.height,x=m.syncWithTicks,E=m.horizontalValues,T=m.verticalValues,P=Aqe(),C=Cqe();if(!hn(y)||y<=0||!hn(M)||M<=0||!hn(g)||g!==+g||!hn(_)||_!==+_)return null;var D=m.verticalCoordinatesGenerator||VHe,L=m.horizontalCoordinatesGenerator||WHe,N=m.horizontalPoints,j=m.verticalPoints;if((!N||!N.length)&&Pi(L)){var $=E&&E.length,U=L({yAxis:C?Pu(Pu({},C),{},{ticks:$?E:C.ticks}):void 0,width:a,height:u,offset:d},$?!0:x);Ff(Array.isArray(U),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(b0(U),"]")),Array.isArray(U)&&(N=U)}if((!j||!j.length)&&Pi(D)){var G=T&&T.length,H=D({xAxis:P?Pu(Pu({},P),{},{ticks:G?T:P.ticks}):void 0,width:a,height:u,offset:d},G?!0:x);Ff(Array.isArray(H),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(b0(H),"]")),Array.isArray(H)&&(j=H)}return ct.createElement("g",{className:"recharts-cartesian-grid"},ct.createElement(RHe,{fill:m.fill,fillOpacity:m.fillOpacity,x:m.x,y:m.y,width:m.width,height:m.height,ry:m.ry}),ct.createElement(FHe,Ny({},m,{offset:d,horizontalPoints:N,xAxis:P,yAxis:C})),ct.createElement(zHe,Ny({},m,{offset:d,verticalPoints:j,xAxis:P,yAxis:C})),ct.createElement(BHe,Ny({},m,{horizontalPoints:N})),ct.createElement(UHe,Ny({},m,{verticalPoints:j})))}VM.displayName="CartesianGrid";var GHe=["type","layout","connectNulls","ref"],qHe=["key"];function vb(e){"@babel/helpers - typeof";return vb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vb(e)}function mH(e,t){if(e==null)return{};var r=HHe(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function HHe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function M2(){return M2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},M2.apply(this,arguments)}function gH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Rd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gH(Object(r),!0).forEach(function(n){kf(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kv(e){return YHe(e)||XHe(e)||ZHe(e)||KHe()}function KHe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZHe(e,t){if(e){if(typeof e=="string")return vN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vN(e,t)}}function XHe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function YHe(e){if(Array.isArray(e))return vN(e)}function vN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function QHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _H(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tue(n.key),n)}}function JHe(e,t,r){return t&&_H(e.prototype,t),r&&_H(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eKe(e,t,r){return t=NC(t),tKe(e,eue()?Reflect.construct(t,r||[],NC(e).constructor):t.apply(e,r))}function tKe(e,t){if(t&&(vb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rKe(e)}function rKe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eue(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(eue=function(){return!!e})()}function NC(e){return NC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},NC(e)}function nKe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bN(e,t)}function bN(e,t){return bN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},bN(e,t)}function kf(e,t,r){return t=tue(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tue(e){var t=iKe(e,"string");return vb(t)=="symbol"?t:t+""}function iKe(e,t){if(vb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var x0=function(e){function t(){var r;QHe(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return r=eKe(this,t,[].concat(i)),kf(r,"state",{isAnimationFinished:!0,totalLength:0}),kf(r,"generateSimpleStrokeDasharray",function(s,a){return"".concat(a,"px ").concat(s-a,"px")}),kf(r,"getStrokeDasharray",function(s,a,u){var d=u.reduce(function(T,P){return T+P});if(!d)return r.generateSimpleStrokeDasharray(a,s);for(var m=Math.floor(s/d),g=s%d,_=a-s,y=[],M=0,x=0;M<u.length;x+=u[M],++M)if(x+u[M]>g){y=[].concat(kv(u.slice(0,M)),[g-x]);break}var E=y.length%2===0?[0,_]:[_];return[].concat(kv(t.repeat(u,m)),kv(y),E).map(function(T){return"".concat(T,"px")}).join(", ")}),kf(r,"id",N0("recharts-line-")),kf(r,"pathRef",function(s){r.mainCurve=s}),kf(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),kf(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return nKe(t,e),JHe(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,i){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var o=this.props,s=o.points,a=o.xAxis,u=o.yAxis,d=o.layout,m=o.children,g=th(m,ES);if(!g)return null;var _=function(x,E){return{x:x.x,y:x.y,value:x.value,errorVal:Ol(x.payload,E)}},y={clipPath:n?"url(#clipPath-".concat(i,")"):null};return ct.createElement($o,y,g.map(function(M){return ct.cloneElement(M,{key:"bar-".concat(M.props.dataKey),data:s,xAxis:a,yAxis:u,layout:d,dataPointFormatter:_})}))}},{key:"renderDots",value:function(n,i,o){var s=this.props.isAnimationActive;if(s&&!this.state.isAnimationFinished)return null;var a=this.props,u=a.dot,d=a.points,m=a.dataKey,g=ii(this.props,!1),_=ii(u,!0),y=d.map(function(x,E){var T=Rd(Rd(Rd({key:"dot-".concat(E),r:3},g),_),{},{index:E,cx:x.x,cy:x.y,value:x.value,dataKey:m,payload:x.payload,points:d});return t.renderDotItem(u,T)}),M={clipPath:n?"url(#clipPath-".concat(i?"":"dots-").concat(o,")"):null};return ct.createElement($o,M2({className:"recharts-line-dots",key:"dots"},M),y)}},{key:"renderCurveStatically",value:function(n,i,o,s){var a=this.props,u=a.type,d=a.layout,m=a.connectNulls;a.ref;var g=mH(a,GHe),_=Rd(Rd(Rd({},ii(g,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:i?"url(#clipPath-".concat(o,")"):null,points:n},s),{},{type:u,layout:d,connectNulls:m});return ct.createElement(Jy,M2({},_,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,i){var o=this,s=this.props,a=s.points,u=s.strokeDasharray,d=s.isAnimationActive,m=s.animationBegin,g=s.animationDuration,_=s.animationEasing,y=s.animationId,M=s.animateNewValues,x=s.width,E=s.height,T=this.state,P=T.prevPoints,C=T.totalLength;return ct.createElement(Gf,{begin:m,duration:g,isActive:d,easing:_,from:{t:0},to:{t:1},key:"line-".concat(y),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(D){var L=D.t;if(P){var N=P.length/a.length,j=a.map(function(X,ee){var ae=Math.floor(ee*N);if(P[ae]){var de=P[ae],ye=hc(de.x,X.x),_e=hc(de.y,X.y);return Rd(Rd({},X),{},{x:ye(L),y:_e(L)})}if(M){var ue=hc(x*2,X.x),fe=hc(E/2,X.y);return Rd(Rd({},X),{},{x:ue(L),y:fe(L)})}return Rd(Rd({},X),{},{x:X.x,y:X.y})});return o.renderCurveStatically(j,n,i)}var $=hc(0,C),U=$(L),G;if(u){var H="".concat(u).split(/[,\s]+/gim).map(function(X){return parseFloat(X)});G=o.getStrokeDasharray(U,C,H)}else G=o.generateSimpleStrokeDasharray(C,U);return o.renderCurveStatically(a,n,i,{strokeDasharray:G})})}},{key:"renderCurve",value:function(n,i){var o=this.props,s=o.points,a=o.isAnimationActive,u=this.state,d=u.prevPoints,m=u.totalLength;return a&&s&&s.length&&(!d&&m>0||!_0(d,s))?this.renderCurveWithAnimation(n,i):this.renderCurveStatically(s,n,i)}},{key:"render",value:function(){var n,i=this.props,o=i.hide,s=i.dot,a=i.points,u=i.className,d=i.xAxis,m=i.yAxis,g=i.top,_=i.left,y=i.width,M=i.height,x=i.isAnimationActive,E=i.id;if(o||!a||!a.length)return null;var T=this.state.isAnimationFinished,P=a.length===1,C=Wi("recharts-line",u),D=d&&d.allowDataOverflow,L=m&&m.allowDataOverflow,N=D||L,j=zi(E)?this.id:E,$=(n=ii(s,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},U=$.r,G=U===void 0?3:U,H=$.strokeWidth,X=H===void 0?2:H,ee=Uae(s)?s:{},ae=ee.clipDot,de=ae===void 0?!0:ae,ye=G*2+X;return ct.createElement($o,{className:C},D||L?ct.createElement("defs",null,ct.createElement("clipPath",{id:"clipPath-".concat(j)},ct.createElement("rect",{x:D?_:_-y/2,y:L?g:g-M/2,width:D?y:y*2,height:L?M:M*2})),!de&&ct.createElement("clipPath",{id:"clipPath-dots-".concat(j)},ct.createElement("rect",{x:_-ye/2,y:g-ye/2,width:y+ye,height:M+ye}))):null,!P&&this.renderCurve(N,j),this.renderErrorBar(N,j),(P||s)&&this.renderDots(N,de,j),(!x||T)&&Up.renderCallByParent(this.props,a))}}],[{key:"getDerivedStateFromProps",value:function(n,i){return n.animationId!==i.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:i.curPoints}:n.points!==i.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,i){for(var o=n.length%2!==0?[].concat(kv(n),[0]):n,s=[],a=0;a<i;++a)s=[].concat(kv(s),kv(o));return s}},{key:"renderDotItem",value:function(n,i){var o;if(ct.isValidElement(n))o=ct.cloneElement(n,i);else if(Pi(n))o=n(i);else{var s=i.key,a=mH(i,qHe),u=Wi("recharts-line-dot",typeof n!="boolean"?n.className:"");o=ct.createElement(AS,M2({key:s},a,{className:u}))}return o}}])}(oe.PureComponent);kf(x0,"displayName","Line");kf(x0,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!zf.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});kf(x0,"getComposedData",function(e){var t=e.props,r=e.xAxis,n=e.yAxis,i=e.xAxisTicks,o=e.yAxisTicks,s=e.dataKey,a=e.bandSize,u=e.displayedData,d=e.offset,m=t.layout,g=u.map(function(_,y){var M=Ol(_,s);return m==="horizontal"?{x:fC({axis:r,ticks:i,bandSize:a,entry:_,index:y}),y:zi(M)?null:n.scale(M),value:M,payload:_}:{x:zi(M)?null:r.scale(M),y:fC({axis:n,ticks:o,bandSize:a,entry:_,index:y}),value:M,payload:_}});return Rd({points:g,layout:m},d)});var oKe=["layout","type","stroke","connectNulls","isRange","ref"],aKe=["key"],rue;function bb(e){"@babel/helpers - typeof";return bb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bb(e)}function nue(e,t){if(e==null)return{};var r=sKe(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function sKe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function jy(){return jy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jy.apply(this,arguments)}function yH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Fg(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yH(Object(r),!0).forEach(function(n){Lp(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lKe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oue(n.key),n)}}function cKe(e,t,r){return t&&vH(e.prototype,t),r&&vH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uKe(e,t,r){return t=jC(t),dKe(e,iue()?Reflect.construct(t,r||[],jC(e).constructor):t.apply(e,r))}function dKe(e,t){if(t&&(bb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hKe(e)}function hKe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iue(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(iue=function(){return!!e})()}function jC(e){return jC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},jC(e)}function fKe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xN(e,t)}function xN(e,t){return xN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},xN(e,t)}function Lp(e,t,r){return t=oue(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oue(e){var t=pKe(e,"string");return bb(t)=="symbol"?t:t+""}function pKe(e,t){if(bb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ym=function(e){function t(){var r;lKe(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return r=uKe(this,t,[].concat(i)),Lp(r,"state",{isAnimationFinished:!0}),Lp(r,"id",N0("recharts-area-")),Lp(r,"handleAnimationEnd",function(){var s=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),Pi(s)&&s()}),Lp(r,"handleAnimationStart",function(){var s=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),Pi(s)&&s()}),r}return fKe(t,e),cKe(t,[{key:"renderDots",value:function(n,i,o){var s=this.props.isAnimationActive,a=this.state.isAnimationFinished;if(s&&!a)return null;var u=this.props,d=u.dot,m=u.points,g=u.dataKey,_=ii(this.props,!1),y=ii(d,!0),M=m.map(function(E,T){var P=Fg(Fg(Fg({key:"dot-".concat(T),r:3},_),y),{},{index:T,cx:E.x,cy:E.y,dataKey:g,value:E.value,payload:E.payload,points:m});return t.renderDotItem(d,P)}),x={clipPath:n?"url(#clipPath-".concat(i?"":"dots-").concat(o,")"):null};return ct.createElement($o,jy({className:"recharts-area-dots"},x),M)}},{key:"renderHorizontalRect",value:function(n){var i=this.props,o=i.baseLine,s=i.points,a=i.strokeWidth,u=s[0].x,d=s[s.length-1].x,m=n*Math.abs(u-d),g=r_(s.map(function(_){return _.y||0}));return hn(o)&&typeof o=="number"?g=Math.max(o,g):o&&Array.isArray(o)&&o.length&&(g=Math.max(r_(o.map(function(_){return _.y||0})),g)),hn(g)?ct.createElement("rect",{x:u<d?u:u-m,y:0,width:m,height:Math.floor(g+(a?parseInt("".concat(a),10):1))}):null}},{key:"renderVerticalRect",value:function(n){var i=this.props,o=i.baseLine,s=i.points,a=i.strokeWidth,u=s[0].y,d=s[s.length-1].y,m=n*Math.abs(u-d),g=r_(s.map(function(_){return _.x||0}));return hn(o)&&typeof o=="number"?g=Math.max(o,g):o&&Array.isArray(o)&&o.length&&(g=Math.max(r_(o.map(function(_){return _.x||0})),g)),hn(g)?ct.createElement("rect",{x:0,y:u<d?u:u-m,width:g+(a?parseInt("".concat(a),10):1),height:Math.floor(m)}):null}},{key:"renderClipRect",value:function(n){var i=this.props.layout;return i==="vertical"?this.renderVerticalRect(n):this.renderHorizontalRect(n)}},{key:"renderAreaStatically",value:function(n,i,o,s){var a=this.props,u=a.layout,d=a.type,m=a.stroke,g=a.connectNulls,_=a.isRange;a.ref;var y=nue(a,oKe);return ct.createElement($o,{clipPath:o?"url(#clipPath-".concat(s,")"):null},ct.createElement(Jy,jy({},ii(y,!0),{points:n,connectNulls:g,type:d,baseLine:i,layout:u,stroke:"none",className:"recharts-area-area"})),m!=="none"&&ct.createElement(Jy,jy({},ii(this.props,!1),{className:"recharts-area-curve",layout:u,type:d,connectNulls:g,fill:"none",points:n})),m!=="none"&&_&&ct.createElement(Jy,jy({},ii(this.props,!1),{className:"recharts-area-curve",layout:u,type:d,connectNulls:g,fill:"none",points:i})))}},{key:"renderAreaWithAnimation",value:function(n,i){var o=this,s=this.props,a=s.points,u=s.baseLine,d=s.isAnimationActive,m=s.animationBegin,g=s.animationDuration,_=s.animationEasing,y=s.animationId,M=this.state,x=M.prevPoints,E=M.prevBaseLine;return ct.createElement(Gf,{begin:m,duration:g,isActive:d,easing:_,from:{t:0},to:{t:1},key:"area-".concat(y),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(T){var P=T.t;if(x){var C=x.length/a.length,D=a.map(function($,U){var G=Math.floor(U*C);if(x[G]){var H=x[G],X=hc(H.x,$.x),ee=hc(H.y,$.y);return Fg(Fg({},$),{},{x:X(P),y:ee(P)})}return $}),L;if(hn(u)&&typeof u=="number"){var N=hc(E,u);L=N(P)}else if(zi(u)||Hb(u)){var j=hc(E,0);L=j(P)}else L=u.map(function($,U){var G=Math.floor(U*C);if(E[G]){var H=E[G],X=hc(H.x,$.x),ee=hc(H.y,$.y);return Fg(Fg({},$),{},{x:X(P),y:ee(P)})}return $});return o.renderAreaStatically(D,L,n,i)}return ct.createElement($o,null,ct.createElement("defs",null,ct.createElement("clipPath",{id:"animationClipPath-".concat(i)},o.renderClipRect(P))),ct.createElement($o,{clipPath:"url(#animationClipPath-".concat(i,")")},o.renderAreaStatically(a,u,n,i)))})}},{key:"renderArea",value:function(n,i){var o=this.props,s=o.points,a=o.baseLine,u=o.isAnimationActive,d=this.state,m=d.prevPoints,g=d.prevBaseLine,_=d.totalLength;return u&&s&&s.length&&(!m&&_>0||!_0(m,s)||!_0(g,a))?this.renderAreaWithAnimation(n,i):this.renderAreaStatically(s,a,n,i)}},{key:"render",value:function(){var n,i=this.props,o=i.hide,s=i.dot,a=i.points,u=i.className,d=i.top,m=i.left,g=i.xAxis,_=i.yAxis,y=i.width,M=i.height,x=i.isAnimationActive,E=i.id;if(o||!a||!a.length)return null;var T=this.state.isAnimationFinished,P=a.length===1,C=Wi("recharts-area",u),D=g&&g.allowDataOverflow,L=_&&_.allowDataOverflow,N=D||L,j=zi(E)?this.id:E,$=(n=ii(s,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},U=$.r,G=U===void 0?3:U,H=$.strokeWidth,X=H===void 0?2:H,ee=Uae(s)?s:{},ae=ee.clipDot,de=ae===void 0?!0:ae,ye=G*2+X;return ct.createElement($o,{className:C},D||L?ct.createElement("defs",null,ct.createElement("clipPath",{id:"clipPath-".concat(j)},ct.createElement("rect",{x:D?m:m-y/2,y:L?d:d-M/2,width:D?y:y*2,height:L?M:M*2})),!de&&ct.createElement("clipPath",{id:"clipPath-dots-".concat(j)},ct.createElement("rect",{x:m-ye/2,y:d-ye/2,width:y+ye,height:M+ye}))):null,P?null:this.renderArea(N,j),(s||P)&&this.renderDots(N,de,j),(!x||T)&&Up.renderCallByParent(this.props,a))}}],[{key:"getDerivedStateFromProps",value:function(n,i){return n.animationId!==i.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,curBaseLine:n.baseLine,prevPoints:i.curPoints,prevBaseLine:i.curBaseLine}:n.points!==i.curPoints||n.baseLine!==i.curBaseLine?{curPoints:n.points,curBaseLine:n.baseLine}:null}}])}(oe.PureComponent);rue=Ym;Lp(Ym,"displayName","Area");Lp(Ym,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!zf.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});Lp(Ym,"getBaseValue",function(e,t,r,n){var i=e.layout,o=e.baseValue,s=t.props.baseValue,a=s??o;if(hn(a)&&typeof a=="number")return a;var u=i==="horizontal"?n:r,d=u.scale.domain();if(u.type==="number"){var m=Math.max(d[0],d[1]),g=Math.min(d[0],d[1]);return a==="dataMin"?g:a==="dataMax"||m<0?m:Math.max(Math.min(d[0],d[1]),0)}return a==="dataMin"?d[0]:a==="dataMax"?d[1]:d[0]});Lp(Ym,"getComposedData",function(e){var t=e.props,r=e.item,n=e.xAxis,i=e.yAxis,o=e.xAxisTicks,s=e.yAxisTicks,a=e.bandSize,u=e.dataKey,d=e.stackedData,m=e.dataStartIndex,g=e.displayedData,_=e.offset,y=t.layout,M=d&&d.length,x=rue.getBaseValue(t,r,n,i),E=y==="horizontal",T=!1,P=g.map(function(D,L){var N;M?N=d[m+L]:(N=Ol(D,u),Array.isArray(N)?T=!0:N=[x,N]);var j=N[1]==null||M&&Ol(D,u)==null;return E?{x:fC({axis:n,ticks:o,bandSize:a,entry:D,index:L}),y:j?null:i.scale(N[1]),value:N,payload:D}:{x:j?null:n.scale(N[1]),y:fC({axis:i,ticks:s,bandSize:a,entry:D,index:L}),value:N,payload:D}}),C;return M||T?C=P.map(function(D){var L=Array.isArray(D.value)?D.value[0]:null;return E?{x:D.x,y:L!=null&&D.y!=null?i.scale(L):null}:{x:L!=null?n.scale(L):null,y:D.y}}):C=E?i.scale(x):n.scale(x),Fg({points:P,baseLine:C,layout:y,isRange:T},_)});Lp(Ym,"renderDotItem",function(e,t){var r;if(ct.isValidElement(e))r=ct.cloneElement(e,t);else if(Pi(e))r=e(t);else{var n=Wi("recharts-area-dot",typeof e!="boolean"?e.className:""),i=t.key,o=nue(t,aKe);r=ct.createElement(AS,jy({},o,{key:i,className:n}))}return r});function xb(e){"@babel/helpers - typeof";return xb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xb(e)}function mKe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gKe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lue(n.key),n)}}function _Ke(e,t,r){return t&&gKe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function yKe(e,t,r){return t=RC(t),vKe(e,aue()?Reflect.construct(t,r||[],RC(e).constructor):t.apply(e,r))}function vKe(e,t){if(t&&(xb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bKe(e)}function bKe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aue(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(aue=function(){return!!e})()}function RC(e){return RC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},RC(e)}function xKe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wN(e,t)}function wN(e,t){return wN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},wN(e,t)}function sue(e,t,r){return t=lue(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lue(e){var t=wKe(e,"string");return xb(t)=="symbol"?t:t+""}function wKe(e,t){if(xb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function MN(){return MN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},MN.apply(this,arguments)}function MKe(e){var t=e.xAxisId,r=GF(),n=qF(),i=Uce(t);return i==null?null:oe.createElement(ex,MN({},i,{className:Wi("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(s){return $m(s,!0)}}))}var Qm=function(e){function t(){return mKe(this,t),yKe(this,t,arguments)}return xKe(t,e),_Ke(t,[{key:"render",value:function(){return oe.createElement(MKe,this.props)}}])}(oe.Component);sue(Qm,"displayName","XAxis");sue(Qm,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function wb(e){"@babel/helpers - typeof";return wb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wb(e)}function SKe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TKe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,due(n.key),n)}}function PKe(e,t,r){return t&&TKe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function EKe(e,t,r){return t=FC(t),AKe(e,cue()?Reflect.construct(t,r||[],FC(e).constructor):t.apply(e,r))}function AKe(e,t){if(t&&(wb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CKe(e)}function CKe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cue(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(cue=function(){return!!e})()}function FC(e){return FC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},FC(e)}function kKe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&SN(e,t)}function SN(e,t){return SN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},SN(e,t)}function uue(e,t,r){return t=due(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function due(e){var t=IKe(e,"string");return wb(t)=="symbol"?t:t+""}function IKe(e,t){if(wb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function TN(){return TN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},TN.apply(this,arguments)}var OKe=function(t){var r=t.yAxisId,n=GF(),i=qF(),o=Vce(r);return o==null?null:oe.createElement(ex,TN({},o,{className:Wi("recharts-".concat(o.axisType," ").concat(o.axisType),o.className),viewBox:{x:0,y:0,width:n,height:i},ticksGenerator:function(a){return $m(a,!0)}}))},Wp=function(e){function t(){return SKe(this,t),EKe(this,t,arguments)}return kKe(t,e),PKe(t,[{key:"render",value:function(){return oe.createElement(OKe,this.props)}}])}(oe.Component);uue(Wp,"displayName","YAxis");uue(Wp,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function bH(e){return NKe(e)||$Ke(e)||DKe(e)||LKe()}function LKe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DKe(e,t){if(e){if(typeof e=="string")return PN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return PN(e,t)}}function $Ke(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function NKe(e){if(Array.isArray(e))return PN(e)}function PN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var EN=function(t,r,n,i,o){var s=th(t,KF),a=th(t,wk),u=[].concat(bH(s),bH(a)),d=th(t,Sk),m="".concat(i,"Id"),g=i[0],_=r;if(u.length&&(_=u.reduce(function(x,E){if(E.props[m]===n&&Vp(E.props,"extendDomain")&&hn(E.props[g])){var T=E.props[g];return[Math.min(x[0],T),Math.max(x[1],T)]}return x},_)),d.length){var y="".concat(g,"1"),M="".concat(g,"2");_=d.reduce(function(x,E){if(E.props[m]===n&&Vp(E.props,"extendDomain")&&hn(E.props[y])&&hn(E.props[M])){var T=E.props[y],P=E.props[M];return[Math.min(x[0],T,P),Math.max(x[1],T,P)]}return x},_)}return o&&o.length&&(_=o.reduce(function(x,E){return hn(E)?[Math.min(x[0],E),Math.max(x[1],E)]:x},_)),_},hue={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(u,d,m){this.fn=u,this.context=d,this.once=m||!1}function o(u,d,m,g,_){if(typeof m!="function")throw new TypeError("The listener must be a function");var y=new i(m,g||u,_),M=r?r+d:d;return u._events[M]?u._events[M].fn?u._events[M]=[u._events[M],y]:u._events[M].push(y):(u._events[M]=y,u._eventsCount++),u}function s(u,d){--u._eventsCount===0?u._events=new n:delete u._events[d]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var d=[],m,g;if(this._eventsCount===0)return d;for(g in m=this._events)t.call(m,g)&&d.push(r?g.slice(1):g);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(m)):d},a.prototype.listeners=function(d){var m=r?r+d:d,g=this._events[m];if(!g)return[];if(g.fn)return[g.fn];for(var _=0,y=g.length,M=new Array(y);_<y;_++)M[_]=g[_].fn;return M},a.prototype.listenerCount=function(d){var m=r?r+d:d,g=this._events[m];return g?g.fn?1:g.length:0},a.prototype.emit=function(d,m,g,_,y,M){var x=r?r+d:d;if(!this._events[x])return!1;var E=this._events[x],T=arguments.length,P,C;if(E.fn){switch(E.once&&this.removeListener(d,E.fn,void 0,!0),T){case 1:return E.fn.call(E.context),!0;case 2:return E.fn.call(E.context,m),!0;case 3:return E.fn.call(E.context,m,g),!0;case 4:return E.fn.call(E.context,m,g,_),!0;case 5:return E.fn.call(E.context,m,g,_,y),!0;case 6:return E.fn.call(E.context,m,g,_,y,M),!0}for(C=1,P=new Array(T-1);C<T;C++)P[C-1]=arguments[C];E.fn.apply(E.context,P)}else{var D=E.length,L;for(C=0;C<D;C++)switch(E[C].once&&this.removeListener(d,E[C].fn,void 0,!0),T){case 1:E[C].fn.call(E[C].context);break;case 2:E[C].fn.call(E[C].context,m);break;case 3:E[C].fn.call(E[C].context,m,g);break;case 4:E[C].fn.call(E[C].context,m,g,_);break;default:if(!P)for(L=1,P=new Array(T-1);L<T;L++)P[L-1]=arguments[L];E[C].fn.apply(E[C].context,P)}}return!0},a.prototype.on=function(d,m,g){return o(this,d,m,g,!1)},a.prototype.once=function(d,m,g){return o(this,d,m,g,!0)},a.prototype.removeListener=function(d,m,g,_){var y=r?r+d:d;if(!this._events[y])return this;if(!m)return s(this,y),this;var M=this._events[y];if(M.fn)M.fn===m&&(!_||M.once)&&(!g||M.context===g)&&s(this,y);else{for(var x=0,E=[],T=M.length;x<T;x++)(M[x].fn!==m||_&&!M[x].once||g&&M[x].context!==g)&&E.push(M[x]);E.length?this._events[y]=E.length===1?E[0]:E:s(this,y)}return this},a.prototype.removeAllListeners=function(d){var m;return d?(m=r?r+d:d,this._events[m]&&s(this,m)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,e.exports=a})(hue);var jKe=hue.exports;const RKe=sa(jKe);var TO=new RKe,PO="recharts.syncMouseEvents";function WM(e){"@babel/helpers - typeof";return WM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},WM(e)}function FKe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zKe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fue(n.key),n)}}function BKe(e,t,r){return t&&zKe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function EO(e,t,r){return t=fue(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fue(e){var t=UKe(e,"string");return WM(t)=="symbol"?t:t+""}function UKe(e,t){if(WM(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(WM(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var VKe=function(){function e(){FKe(this,e),EO(this,"activeIndex",0),EO(this,"coordinateList",[]),EO(this,"layout","horizontal")}return BKe(e,[{key:"setDetails",value:function(r){var n,i=r.coordinateList,o=i===void 0?null:i,s=r.container,a=s===void 0?null:s,u=r.layout,d=u===void 0?null:u,m=r.offset,g=m===void 0?null:m,_=r.mouseHandlerCallback,y=_===void 0?null:_;this.coordinateList=(n=o??this.coordinateList)!==null&&n!==void 0?n:[],this.container=a??this.container,this.layout=d??this.layout,this.offset=g??this.offset,this.mouseHandlerCallback=y??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var i=this.container.getBoundingClientRect(),o=i.x,s=i.y,a=i.height,u=this.coordinateList[this.activeIndex].coordinate,d=((r=window)===null||r===void 0?void 0:r.scrollX)||0,m=((n=window)===null||n===void 0?void 0:n.scrollY)||0,g=o+u+d,_=s+this.offset.top+a/2+m;this.mouseHandlerCallback({pageX:g,pageY:_})}}}])}();function WKe(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e==null?void 0:e[0],i=e==null?void 0:e[1];if(n&&i&&hn(n)&&hn(i))return!0}return!1}function GKe(e,t,r,n){var i=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-i:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-i,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function pue(e){var t=e.cx,r=e.cy,n=e.radius,i=e.startAngle,o=e.endAngle,s=ns(t,r,n,i),a=ns(t,r,n,o);return{points:[s,a],cx:t,cy:r,radius:n,startAngle:i,endAngle:o}}function qKe(e,t,r){var n,i,o,s;if(e==="horizontal")n=t.x,o=n,i=r.top,s=r.top+r.height;else if(e==="vertical")i=t.y,s=i,n=r.left,o=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var a=t.cx,u=t.cy,d=t.innerRadius,m=t.outerRadius,g=t.angle,_=ns(a,u,d,g),y=ns(a,u,m,g);n=_.x,i=_.y,o=y.x,s=y.y}else return pue(t);return[{x:n,y:i},{x:o,y:s}]}function GM(e){"@babel/helpers - typeof";return GM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},GM(e)}function xH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ZP(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xH(Object(r),!0).forEach(function(n){HKe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function HKe(e,t,r){return t=KKe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KKe(e){var t=ZKe(e,"string");return GM(t)=="symbol"?t:t+""}function ZKe(e,t){if(GM(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(GM(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function XKe(e){var t,r,n=e.element,i=e.tooltipEventType,o=e.isActive,s=e.activeCoordinate,a=e.activePayload,u=e.offset,d=e.activeTooltipIndex,m=e.tooltipAxisBandSize,g=e.layout,_=e.chartName,y=(t=n.props.cursor)!==null&&t!==void 0?t:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!y||!o||!s||_!=="ScatterChart"&&i!=="axis")return null;var M,x=Jy;if(_==="ScatterChart")M=s,x=iWe;else if(_==="BarChart")M=GKe(g,s,u,m),x=zF;else if(g==="radial"){var E=pue(s),T=E.cx,P=E.cy,C=E.radius,D=E.startAngle,L=E.endAngle;M={cx:T,cy:P,startAngle:D,endAngle:L,innerRadius:C,outerRadius:C},x=sce}else M={points:qKe(g,s,u)},x=Jy;var N=ZP(ZP(ZP(ZP({stroke:"#ccc",pointerEvents:"none"},u),M),ii(y,!1)),{},{payload:a,payloadIndex:d,className:Wi("recharts-tooltip-cursor",y.className)});return oe.isValidElement(y)?oe.cloneElement(y,N):oe.createElement(x,N)}var YKe=["item"],QKe=["children","className","width","height","style","compact","title","desc"];function Mb(e){"@babel/helpers - typeof";return Mb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mb(e)}function c1(){return c1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},c1.apply(this,arguments)}function wH(e,t){return tZe(e)||eZe(e,t)||gue(e,t)||JKe()}function JKe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eZe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],u=!0,d=!1;try{if(o=(r=r.call(e)).next,t!==0)for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);u=!0);}catch(m){d=!0,i=m}finally{try{if(!u&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw i}}return a}}function tZe(e){if(Array.isArray(e))return e}function MH(e,t){if(e==null)return{};var r=rZe(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function rZe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function nZe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iZe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_ue(n.key),n)}}function oZe(e,t,r){return t&&iZe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function aZe(e,t,r){return t=zC(t),sZe(e,mue()?Reflect.construct(t,r||[],zC(e).constructor):t.apply(e,r))}function sZe(e,t){if(t&&(Mb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lZe(e)}function lZe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mue(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(mue=function(){return!!e})()}function zC(e){return zC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zC(e)}function cZe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&AN(e,t)}function AN(e,t){return AN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},AN(e,t)}function Sb(e){return hZe(e)||dZe(e)||gue(e)||uZe()}function uZe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gue(e,t){if(e){if(typeof e=="string")return CN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CN(e,t)}}function dZe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function hZe(e){if(Array.isArray(e))return CN(e)}function CN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function SH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Nr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SH(Object(r),!0).forEach(function(n){Ti(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ti(e,t,r){return t=_ue(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ue(e){var t=fZe(e,"string");return Mb(t)=="symbol"?t:t+""}function fZe(e,t){if(Mb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pZe={xAxis:["bottom","top"],yAxis:["left","right"]},mZe={width:"100%",height:"100%"},yue={x:0,y:0};function XP(e){return e}var gZe=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},_Ze=function(t,r,n,i){var o=r.find(function(m){return m&&m.index===n});if(o){if(t==="horizontal")return{x:o.coordinate,y:i.y};if(t==="vertical")return{x:i.x,y:o.coordinate};if(t==="centric"){var s=o.coordinate,a=i.radius;return Nr(Nr(Nr({},i),ns(i.cx,i.cy,a,s)),{},{angle:s,radius:a})}var u=o.coordinate,d=i.angle;return Nr(Nr(Nr({},i),ns(i.cx,i.cy,u,d)),{},{angle:d,radius:u})}return yue},Tk=function(t,r){var n=r.graphicalItems,i=r.dataStartIndex,o=r.dataEndIndex,s=(n??[]).reduce(function(a,u){var d=u.props.data;return d&&d.length?[].concat(Sb(a),Sb(d)):a},[]);return s.length>0?s:t&&t.length&&hn(i)&&hn(o)?t.slice(i,o+1):[]};function vue(e){return e==="number"?[0,"auto"]:void 0}var kN=function(t,r,n,i){var o=t.graphicalItems,s=t.tooltipAxis,a=Tk(r,t);return n<0||!o||!o.length||n>=a.length?null:o.reduce(function(u,d){var m,g=(m=d.props.data)!==null&&m!==void 0?m:r;g&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=n&&(g=g.slice(t.dataStartIndex,t.dataEndIndex+1));var _;if(s.dataKey&&!s.allowDuplicatedCategory){var y=g===void 0?a:g;_=FA(y,s.dataKey,i)}else _=g&&g[n]||a[n];return _?[].concat(Sb(u),[tce(d,_)]):u},[])},TH=function(t,r,n,i){var o=i||{x:t.chartX,y:t.chartY},s=gZe(o,n),a=t.orderedTooltipTicks,u=t.tooltipAxis,d=t.tooltipTicks,m=A8e(s,a,d,u);if(m>=0&&d){var g=d[m]&&d[m].value,_=kN(t,r,m,g),y=_Ze(n,a,m,o);return{activeTooltipIndex:m,activeLabel:g,activePayload:_,activeCoordinate:y}}return null},yZe=function(t,r){var n=r.axes,i=r.graphicalItems,o=r.axisType,s=r.axisIdKey,a=r.stackGroups,u=r.dataStartIndex,d=r.dataEndIndex,m=t.layout,g=t.children,_=t.stackOffset,y=Zle(m,o);return n.reduce(function(M,x){var E,T=x.type.defaultProps!==void 0?Nr(Nr({},x.type.defaultProps),x.props):x.props,P=T.type,C=T.dataKey,D=T.allowDataOverflow,L=T.allowDuplicatedCategory,N=T.scale,j=T.ticks,$=T.includeHidden,U=T[s];if(M[U])return M;var G=Tk(t.data,{graphicalItems:i.filter(function(K){var te,ve=s in K.props?K.props[s]:(te=K.type.defaultProps)===null||te===void 0?void 0:te[s];return ve===U}),dataStartIndex:u,dataEndIndex:d}),H=G.length,X,ee,ae;WKe(T.domain,D,P)&&(X=V$(T.domain,null,D),y&&(P==="number"||N!=="auto")&&(ae=v2(G,C,"category")));var de=vue(P);if(!X||X.length===0){var ye,_e=(ye=T.domain)!==null&&ye!==void 0?ye:de;if(C){if(X=v2(G,C,P),P==="category"&&y){var ue=yke(X);L&&ue?(ee=X,X=PC(0,H)):L||(X=GG(_e,X,x).reduce(function(K,te){return K.indexOf(te)>=0?K:[].concat(Sb(K),[te])},[]))}else if(P==="category")L?X=X.filter(function(K){return K!==""&&!zi(K)}):X=GG(_e,X,x).reduce(function(K,te){return K.indexOf(te)>=0||te===""||zi(te)?K:[].concat(Sb(K),[te])},[]);else if(P==="number"){var fe=L8e(G,i.filter(function(K){var te,ve,$e=s in K.props?K.props[s]:(te=K.type.defaultProps)===null||te===void 0?void 0:te[s],Ce="hide"in K.props?K.props.hide:(ve=K.type.defaultProps)===null||ve===void 0?void 0:ve.hide;return $e===U&&($||!Ce)}),C,o,m);fe&&(X=fe)}y&&(P==="number"||N!=="auto")&&(ae=v2(G,C,"category"))}else y?X=PC(0,H):a&&a[U]&&a[U].hasStack&&P==="number"?X=_==="expand"?[0,1]:ece(a[U].stackGroups,u,d):X=Kle(G,i.filter(function(K){var te=s in K.props?K.props[s]:K.type.defaultProps[s],ve="hide"in K.props?K.props.hide:K.type.defaultProps.hide;return te===U&&($||!ve)}),P,m,!0);if(P==="number")X=EN(g,X,U,o,j),_e&&(X=V$(_e,X,D));else if(P==="category"&&_e){var De=_e,pe=X.every(function(K){return De.indexOf(K)>=0});pe&&(X=De)}}return Nr(Nr({},M),{},Ti({},U,Nr(Nr({},T),{},{axisType:o,domain:X,categoricalDomain:ae,duplicateDomain:ee,originalDomain:(E=T.domain)!==null&&E!==void 0?E:de,isCategorical:y,layout:m})))},{})},vZe=function(t,r){var n=r.graphicalItems,i=r.Axis,o=r.axisType,s=r.axisIdKey,a=r.stackGroups,u=r.dataStartIndex,d=r.dataEndIndex,m=t.layout,g=t.children,_=Tk(t.data,{graphicalItems:n,dataStartIndex:u,dataEndIndex:d}),y=_.length,M=Zle(m,o),x=-1;return n.reduce(function(E,T){var P=T.type.defaultProps!==void 0?Nr(Nr({},T.type.defaultProps),T.props):T.props,C=P[s],D=vue("number");if(!E[C]){x++;var L;return M?L=PC(0,y):a&&a[C]&&a[C].hasStack?(L=ece(a[C].stackGroups,u,d),L=EN(g,L,C,o)):(L=V$(D,Kle(_,n.filter(function(N){var j,$,U=s in N.props?N.props[s]:(j=N.type.defaultProps)===null||j===void 0?void 0:j[s],G="hide"in N.props?N.props.hide:($=N.type.defaultProps)===null||$===void 0?void 0:$.hide;return U===C&&!G}),"number",m),i.defaultProps.allowDataOverflow),L=EN(g,L,C,o)),Nr(Nr({},E),{},Ti({},C,Nr(Nr({axisType:o},i.defaultProps),{},{hide:!0,orientation:eh(pZe,"".concat(o,".").concat(x%2),null),domain:L,originalDomain:D,isCategorical:M,layout:m})))}return E},{})},bZe=function(t,r){var n=r.axisType,i=n===void 0?"xAxis":n,o=r.AxisComp,s=r.graphicalItems,a=r.stackGroups,u=r.dataStartIndex,d=r.dataEndIndex,m=t.children,g="".concat(i,"Id"),_=th(m,o),y={};return _&&_.length?y=yZe(t,{axes:_,graphicalItems:s,axisType:i,axisIdKey:g,stackGroups:a,dataStartIndex:u,dataEndIndex:d}):s&&s.length&&(y=vZe(t,{Axis:o,graphicalItems:s,axisType:i,axisIdKey:g,stackGroups:a,dataStartIndex:u,dataEndIndex:d})),y},xZe=function(t){var r=qg(t),n=$m(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:fF(n,function(i){return i.coordinate}),tooltipAxis:r,tooltipAxisBandSize:pC(r,n)}},PH=function(t){var r=t.children,n=t.defaultShowTooltip,i=Ud(r,fb),o=0,s=0;return t.data&&t.data.length!==0&&(s=t.data.length-1),i&&i.props&&(i.props.startIndex>=0&&(o=i.props.startIndex),i.props.endIndex>=0&&(s=i.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:o,dataEndIndex:s,activeTooltipIndex:-1,isTooltipActive:!!n}},wZe=function(t){return!t||!t.length?!1:t.some(function(r){var n=Rm(r&&r.type);return n&&n.indexOf("Bar")>=0})},EH=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},MZe=function(t,r){var n=t.props,i=t.graphicalItems,o=t.xAxisMap,s=o===void 0?{}:o,a=t.yAxisMap,u=a===void 0?{}:a,d=n.width,m=n.height,g=n.children,_=n.margin||{},y=Ud(g,fb),M=Ud(g,w1),x=Object.keys(u).reduce(function(L,N){var j=u[N],$=j.orientation;return!j.mirror&&!j.hide?Nr(Nr({},L),{},Ti({},$,L[$]+j.width)):L},{left:_.left||0,right:_.right||0}),E=Object.keys(s).reduce(function(L,N){var j=s[N],$=j.orientation;return!j.mirror&&!j.hide?Nr(Nr({},L),{},Ti({},$,eh(L,"".concat($))+j.height)):L},{top:_.top||0,bottom:_.bottom||0}),T=Nr(Nr({},E),x),P=T.bottom;y&&(T.bottom+=y.props.height||fb.defaultProps.height),M&&r&&(T=I8e(T,i,n,r));var C=d-T.left-T.right,D=m-T.top-T.bottom;return Nr(Nr({brushBottom:P},T),{},{width:Math.max(C,0),height:Math.max(D,0)})},SZe=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},Pk=function(t){var r=t.chartName,n=t.GraphicalChild,i=t.defaultTooltipEventType,o=i===void 0?"axis":i,s=t.validateTooltipEventTypes,a=s===void 0?["axis"]:s,u=t.axisComponents,d=t.legendContent,m=t.formatAxisMap,g=t.defaultProps,_=function(T,P){var C=P.graphicalItems,D=P.stackGroups,L=P.offset,N=P.updateId,j=P.dataStartIndex,$=P.dataEndIndex,U=T.barSize,G=T.layout,H=T.barGap,X=T.barCategoryGap,ee=T.maxBarSize,ae=EH(G),de=ae.numericAxisName,ye=ae.cateAxisName,_e=wZe(C),ue=[];return C.forEach(function(fe,De){var pe=Tk(T.data,{graphicalItems:[fe],dataStartIndex:j,dataEndIndex:$}),K=fe.type.defaultProps!==void 0?Nr(Nr({},fe.type.defaultProps),fe.props):fe.props,te=K.dataKey,ve=K.maxBarSize,$e=K["".concat(de,"Id")],Ce=K["".concat(ye,"Id")],Ge={},ot=u.reduce(function(Kt,dr){var Bt=P["".concat(dr.axisType,"Map")],wr=K["".concat(dr.axisType,"Id")];Bt&&Bt[wr]||dr.axisType==="zAxis"||v0();var mr=Bt[wr];return Nr(Nr({},Kt),{},Ti(Ti({},dr.axisType,mr),"".concat(dr.axisType,"Ticks"),$m(mr)))},Ge),Ye=ot[ye],et=ot["".concat(ye,"Ticks")],Te=D&&D[$e]&&D[$e].hasStack&&U8e(fe,D[$e].stackGroups),Le=Rm(fe.type).indexOf("Bar")>=0,ke=pC(Ye,et),Xe=[],Ne=_e&&C8e({barSize:U,stackGroups:D,totalSize:SZe(ot,ye)});if(Le){var Ot,Lt,kt=zi(ve)?ee:ve,mt=(Ot=(Lt=pC(Ye,et,!0))!==null&&Lt!==void 0?Lt:kt)!==null&&Ot!==void 0?Ot:0;Xe=k8e({barGap:H,barCategoryGap:X,bandSize:mt!==ke?mt:ke,sizeList:Ne[Ce],maxBarSize:kt}),mt!==ke&&(Xe=Xe.map(function(Kt){return Nr(Nr({},Kt),{},{position:Nr(Nr({},Kt.position),{},{offset:Kt.position.offset-mt/2})})}))}var Zt=fe&&fe.type&&fe.type.getComposedData;Zt&&ue.push({props:Nr(Nr({},Zt(Nr(Nr({},ot),{},{displayedData:pe,props:T,dataKey:te,item:fe,bandSize:ke,barPosition:Xe,offset:L,stackedData:Te,layout:G,dataStartIndex:j,dataEndIndex:$}))),{},Ti(Ti(Ti({key:fe.key||"item-".concat(De)},de,ot[de]),ye,ot[ye]),"animationId",N)),childIndex:kke(fe,T.children),item:fe})}),ue},y=function(T,P){var C=T.props,D=T.dataStartIndex,L=T.dataEndIndex,N=T.updateId;if(!FW({props:C}))return null;var j=C.children,$=C.layout,U=C.stackOffset,G=C.data,H=C.reverseStackOrder,X=EH($),ee=X.numericAxisName,ae=X.cateAxisName,de=th(j,n),ye=z8e(G,de,"".concat(ee,"Id"),"".concat(ae,"Id"),U,H),_e=u.reduce(function(K,te){var ve="".concat(te.axisType,"Map");return Nr(Nr({},K),{},Ti({},ve,bZe(C,Nr(Nr({},te),{},{graphicalItems:de,stackGroups:te.axisType===ee&&ye,dataStartIndex:D,dataEndIndex:L}))))},{}),ue=MZe(Nr(Nr({},_e),{},{props:C,graphicalItems:de}),P==null?void 0:P.legendBBox);Object.keys(_e).forEach(function(K){_e[K]=m(C,_e[K],ue,K.replace("Map",""),r)});var fe=_e["".concat(ae,"Map")],De=xZe(fe),pe=_(C,Nr(Nr({},_e),{},{dataStartIndex:D,dataEndIndex:L,updateId:N,graphicalItems:de,stackGroups:ye,offset:ue}));return Nr(Nr({formattedGraphicalItems:pe,graphicalItems:de,offset:ue,stackGroups:ye},De),_e)},M=function(E){function T(P){var C,D,L;return nZe(this,T),L=aZe(this,T,[P]),Ti(L,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Ti(L,"accessibilityManager",new VKe),Ti(L,"handleLegendBBoxUpdate",function(N){if(N){var j=L.state,$=j.dataStartIndex,U=j.dataEndIndex,G=j.updateId;L.setState(Nr({legendBBox:N},y({props:L.props,dataStartIndex:$,dataEndIndex:U,updateId:G},Nr(Nr({},L.state),{},{legendBBox:N}))))}}),Ti(L,"handleReceiveSyncEvent",function(N,j,$){if(L.props.syncId===N){if($===L.eventEmitterSymbol&&typeof L.props.syncMethod!="function")return;L.applySyncEvent(j)}}),Ti(L,"handleBrushChange",function(N){var j=N.startIndex,$=N.endIndex;if(j!==L.state.dataStartIndex||$!==L.state.dataEndIndex){var U=L.state.updateId;L.setState(function(){return Nr({dataStartIndex:j,dataEndIndex:$},y({props:L.props,dataStartIndex:j,dataEndIndex:$,updateId:U},L.state))}),L.triggerSyncEvent({dataStartIndex:j,dataEndIndex:$})}}),Ti(L,"handleMouseEnter",function(N){var j=L.getMouseInfo(N);if(j){var $=Nr(Nr({},j),{},{isTooltipActive:!0});L.setState($),L.triggerSyncEvent($);var U=L.props.onMouseEnter;Pi(U)&&U($,N)}}),Ti(L,"triggeredAfterMouseMove",function(N){var j=L.getMouseInfo(N),$=j?Nr(Nr({},j),{},{isTooltipActive:!0}):{isTooltipActive:!1};L.setState($),L.triggerSyncEvent($);var U=L.props.onMouseMove;Pi(U)&&U($,N)}),Ti(L,"handleItemMouseEnter",function(N){L.setState(function(){return{isTooltipActive:!0,activeItem:N,activePayload:N.tooltipPayload,activeCoordinate:N.tooltipPosition||{x:N.cx,y:N.cy}}})}),Ti(L,"handleItemMouseLeave",function(){L.setState(function(){return{isTooltipActive:!1}})}),Ti(L,"handleMouseMove",function(N){N.persist(),L.throttleTriggeredAfterMouseMove(N)}),Ti(L,"handleMouseLeave",function(N){L.throttleTriggeredAfterMouseMove.cancel();var j={isTooltipActive:!1};L.setState(j),L.triggerSyncEvent(j);var $=L.props.onMouseLeave;Pi($)&&$(j,N)}),Ti(L,"handleOuterEvent",function(N){var j=Cke(N),$=eh(L.props,"".concat(j));if(j&&Pi($)){var U,G;/.*touch.*/i.test(j)?G=L.getMouseInfo(N.changedTouches[0]):G=L.getMouseInfo(N),$((U=G)!==null&&U!==void 0?U:{},N)}}),Ti(L,"handleClick",function(N){var j=L.getMouseInfo(N);if(j){var $=Nr(Nr({},j),{},{isTooltipActive:!0});L.setState($),L.triggerSyncEvent($);var U=L.props.onClick;Pi(U)&&U($,N)}}),Ti(L,"handleMouseDown",function(N){var j=L.props.onMouseDown;if(Pi(j)){var $=L.getMouseInfo(N);j($,N)}}),Ti(L,"handleMouseUp",function(N){var j=L.props.onMouseUp;if(Pi(j)){var $=L.getMouseInfo(N);j($,N)}}),Ti(L,"handleTouchMove",function(N){N.changedTouches!=null&&N.changedTouches.length>0&&L.throttleTriggeredAfterMouseMove(N.changedTouches[0])}),Ti(L,"handleTouchStart",function(N){N.changedTouches!=null&&N.changedTouches.length>0&&L.handleMouseDown(N.changedTouches[0])}),Ti(L,"handleTouchEnd",function(N){N.changedTouches!=null&&N.changedTouches.length>0&&L.handleMouseUp(N.changedTouches[0])}),Ti(L,"handleDoubleClick",function(N){var j=L.props.onDoubleClick;if(Pi(j)){var $=L.getMouseInfo(N);j($,N)}}),Ti(L,"handleContextMenu",function(N){var j=L.props.onContextMenu;if(Pi(j)){var $=L.getMouseInfo(N);j($,N)}}),Ti(L,"triggerSyncEvent",function(N){L.props.syncId!==void 0&&TO.emit(PO,L.props.syncId,N,L.eventEmitterSymbol)}),Ti(L,"applySyncEvent",function(N){var j=L.props,$=j.layout,U=j.syncMethod,G=L.state.updateId,H=N.dataStartIndex,X=N.dataEndIndex;if(N.dataStartIndex!==void 0||N.dataEndIndex!==void 0)L.setState(Nr({dataStartIndex:H,dataEndIndex:X},y({props:L.props,dataStartIndex:H,dataEndIndex:X,updateId:G},L.state)));else if(N.activeTooltipIndex!==void 0){var ee=N.chartX,ae=N.chartY,de=N.activeTooltipIndex,ye=L.state,_e=ye.offset,ue=ye.tooltipTicks;if(!_e)return;if(typeof U=="function")de=U(ue,N);else if(U==="value"){de=-1;for(var fe=0;fe<ue.length;fe++)if(ue[fe].value===N.activeLabel){de=fe;break}}var De=Nr(Nr({},_e),{},{x:_e.left,y:_e.top}),pe=Math.min(ee,De.x+De.width),K=Math.min(ae,De.y+De.height),te=ue[de]&&ue[de].value,ve=kN(L.state,L.props.data,de),$e=ue[de]?{x:$==="horizontal"?ue[de].coordinate:pe,y:$==="horizontal"?K:ue[de].coordinate}:yue;L.setState(Nr(Nr({},N),{},{activeLabel:te,activeCoordinate:$e,activePayload:ve,activeTooltipIndex:de}))}else L.setState(N)}),Ti(L,"renderCursor",function(N){var j,$=L.state,U=$.isTooltipActive,G=$.activeCoordinate,H=$.activePayload,X=$.offset,ee=$.activeTooltipIndex,ae=$.tooltipAxisBandSize,de=L.getTooltipEventType(),ye=(j=N.props.active)!==null&&j!==void 0?j:U,_e=L.props.layout,ue=N.key||"_recharts-cursor";return ct.createElement(XKe,{key:ue,activeCoordinate:G,activePayload:H,activeTooltipIndex:ee,chartName:r,element:N,isActive:ye,layout:_e,offset:X,tooltipAxisBandSize:ae,tooltipEventType:de})}),Ti(L,"renderPolarAxis",function(N,j,$){var U=eh(N,"type.axisType"),G=eh(L.state,"".concat(U,"Map")),H=N.type.defaultProps,X=H!==void 0?Nr(Nr({},H),N.props):N.props,ee=G&&G[X["".concat(U,"Id")]];return oe.cloneElement(N,Nr(Nr({},ee),{},{className:Wi(U,ee.className),key:N.key||"".concat(j,"-").concat($),ticks:$m(ee,!0)}))}),Ti(L,"renderPolarGrid",function(N){var j=N.props,$=j.radialLines,U=j.polarAngles,G=j.polarRadius,H=L.state,X=H.radiusAxisMap,ee=H.angleAxisMap,ae=qg(X),de=qg(ee),ye=de.cx,_e=de.cy,ue=de.innerRadius,fe=de.outerRadius;return oe.cloneElement(N,{polarAngles:Array.isArray(U)?U:$m(de,!0).map(function(De){return De.coordinate}),polarRadius:Array.isArray(G)?G:$m(ae,!0).map(function(De){return De.coordinate}),cx:ye,cy:_e,innerRadius:ue,outerRadius:fe,key:N.key||"polar-grid",radialLines:$})}),Ti(L,"renderLegend",function(){var N=L.state.formattedGraphicalItems,j=L.props,$=j.children,U=j.width,G=j.height,H=L.props.margin||{},X=U-(H.left||0)-(H.right||0),ee=qle({children:$,formattedGraphicalItems:N,legendWidth:X,legendContent:d});if(!ee)return null;var ae=ee.item,de=MH(ee,YKe);return oe.cloneElement(ae,Nr(Nr({},de),{},{chartWidth:U,chartHeight:G,margin:H,onBBoxUpdate:L.handleLegendBBoxUpdate}))}),Ti(L,"renderTooltip",function(){var N,j=L.props,$=j.children,U=j.accessibilityLayer,G=Ud($,Fu);if(!G)return null;var H=L.state,X=H.isTooltipActive,ee=H.activeCoordinate,ae=H.activePayload,de=H.activeLabel,ye=H.offset,_e=(N=G.props.active)!==null&&N!==void 0?N:X;return oe.cloneElement(G,{viewBox:Nr(Nr({},ye),{},{x:ye.left,y:ye.top}),active:_e,label:de,payload:_e?ae:[],coordinate:ee,accessibilityLayer:U})}),Ti(L,"renderBrush",function(N){var j=L.props,$=j.margin,U=j.data,G=L.state,H=G.offset,X=G.dataStartIndex,ee=G.dataEndIndex,ae=G.updateId;return oe.cloneElement(N,{key:N.key||"_recharts-brush",onChange:GP(L.handleBrushChange,N.props.onChange),data:U,x:hn(N.props.x)?N.props.x:H.left,y:hn(N.props.y)?N.props.y:H.top+H.height+H.brushBottom-($.bottom||0),width:hn(N.props.width)?N.props.width:H.width,startIndex:X,endIndex:ee,updateId:"brush-".concat(ae)})}),Ti(L,"renderReferenceElement",function(N,j,$){if(!N)return null;var U=L,G=U.clipPathId,H=L.state,X=H.xAxisMap,ee=H.yAxisMap,ae=H.offset,de=N.type.defaultProps||{},ye=N.props,_e=ye.xAxisId,ue=_e===void 0?de.xAxisId:_e,fe=ye.yAxisId,De=fe===void 0?de.yAxisId:fe;return oe.cloneElement(N,{key:N.key||"".concat(j,"-").concat($),xAxis:X[ue],yAxis:ee[De],viewBox:{x:ae.left,y:ae.top,width:ae.width,height:ae.height},clipPathId:G})}),Ti(L,"renderActivePoints",function(N){var j=N.item,$=N.activePoint,U=N.basePoint,G=N.childIndex,H=N.isRange,X=[],ee=j.props.key,ae=j.item.type.defaultProps!==void 0?Nr(Nr({},j.item.type.defaultProps),j.item.props):j.item.props,de=ae.activeDot,ye=ae.dataKey,_e=Nr(Nr({index:G,dataKey:ye,cx:$.x,cy:$.y,r:4,fill:FF(j.item),strokeWidth:2,stroke:"#fff",payload:$.payload,value:$.value},ii(de,!1)),zA(de));return X.push(T.renderActiveDot(de,_e,"".concat(ee,"-activePoint-").concat(G))),U?X.push(T.renderActiveDot(de,Nr(Nr({},_e),{},{cx:U.x,cy:U.y}),"".concat(ee,"-basePoint-").concat(G))):H&&X.push(null),X}),Ti(L,"renderGraphicChild",function(N,j,$){var U=L.filterFormatItem(N,j,$);if(!U)return null;var G=L.getTooltipEventType(),H=L.state,X=H.isTooltipActive,ee=H.tooltipAxis,ae=H.activeTooltipIndex,de=H.activeLabel,ye=L.props.children,_e=Ud(ye,Fu),ue=U.props,fe=ue.points,De=ue.isRange,pe=ue.baseLine,K=U.item.type.defaultProps!==void 0?Nr(Nr({},U.item.type.defaultProps),U.item.props):U.item.props,te=K.activeDot,ve=K.hide,$e=K.activeBar,Ce=K.activeShape,Ge=!!(!ve&&X&&_e&&(te||$e||Ce)),ot={};G!=="axis"&&_e&&_e.props.trigger==="click"?ot={onClick:GP(L.handleItemMouseEnter,N.props.onClick)}:G!=="axis"&&(ot={onMouseLeave:GP(L.handleItemMouseLeave,N.props.onMouseLeave),onMouseEnter:GP(L.handleItemMouseEnter,N.props.onMouseEnter)});var Ye=oe.cloneElement(N,Nr(Nr({},U.props),ot));function et(dr){return typeof ee.dataKey=="function"?ee.dataKey(dr.payload):null}if(Ge)if(ae>=0){var Te,Le;if(ee.dataKey&&!ee.allowDuplicatedCategory){var ke=typeof ee.dataKey=="function"?et:"payload.".concat(ee.dataKey.toString());Te=FA(fe,ke,de),Le=De&&pe&&FA(pe,ke,de)}else Te=fe==null?void 0:fe[ae],Le=De&&pe&&pe[ae];if(Ce||$e){var Xe=N.props.activeIndex!==void 0?N.props.activeIndex:ae;return[oe.cloneElement(N,Nr(Nr(Nr({},U.props),ot),{},{activeIndex:Xe})),null,null]}if(!zi(Te))return[Ye].concat(Sb(L.renderActivePoints({item:U,activePoint:Te,basePoint:Le,childIndex:ae,isRange:De})))}else{var Ne,Ot=(Ne=L.getItemByXY(L.state.activeCoordinate))!==null&&Ne!==void 0?Ne:{graphicalItem:Ye},Lt=Ot.graphicalItem,kt=Lt.item,mt=kt===void 0?N:kt,Zt=Lt.childIndex,Kt=Nr(Nr(Nr({},U.props),ot),{},{activeIndex:Zt});return[oe.cloneElement(mt,Kt),null,null]}return De?[Ye,null,null]:[Ye,null]}),Ti(L,"renderCustomized",function(N,j,$){return oe.cloneElement(N,Nr(Nr({key:"recharts-customized-".concat($)},L.props),L.state))}),Ti(L,"renderMap",{CartesianGrid:{handler:XP,once:!0},ReferenceArea:{handler:L.renderReferenceElement},ReferenceLine:{handler:XP},ReferenceDot:{handler:L.renderReferenceElement},XAxis:{handler:XP},YAxis:{handler:XP},Brush:{handler:L.renderBrush,once:!0},Bar:{handler:L.renderGraphicChild},Line:{handler:L.renderGraphicChild},Area:{handler:L.renderGraphicChild},Radar:{handler:L.renderGraphicChild},RadialBar:{handler:L.renderGraphicChild},Scatter:{handler:L.renderGraphicChild},Pie:{handler:L.renderGraphicChild},Funnel:{handler:L.renderGraphicChild},Tooltip:{handler:L.renderCursor,once:!0},PolarGrid:{handler:L.renderPolarGrid,once:!0},PolarAngleAxis:{handler:L.renderPolarAxis},PolarRadiusAxis:{handler:L.renderPolarAxis},Customized:{handler:L.renderCustomized}}),L.clipPathId="".concat((C=P.id)!==null&&C!==void 0?C:N0("recharts"),"-clip"),L.throttleTriggeredAfterMouseMove=Gse(L.triggeredAfterMouseMove,(D=P.throttleDelay)!==null&&D!==void 0?D:1e3/60),L.state={},L}return cZe(T,E),oZe(T,[{key:"componentDidMount",value:function(){var C,D;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(C=this.props.margin.left)!==null&&C!==void 0?C:0,top:(D=this.props.margin.top)!==null&&D!==void 0?D:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var C=this.props,D=C.children,L=C.data,N=C.height,j=C.layout,$=Ud(D,Fu);if($){var U=$.props.defaultIndex;if(!(typeof U!="number"||U<0||U>this.state.tooltipTicks.length-1)){var G=this.state.tooltipTicks[U]&&this.state.tooltipTicks[U].value,H=kN(this.state,L,U,G),X=this.state.tooltipTicks[U].coordinate,ee=(this.state.offset.top+N)/2,ae=j==="horizontal",de=ae?{x:X,y:ee}:{y:X,x:ee},ye=this.state.formattedGraphicalItems.find(function(ue){var fe=ue.item;return fe.type.name==="Scatter"});ye&&(de=Nr(Nr({},de),ye.props.points[U].tooltipPosition),H=ye.props.points[U].tooltipPayload);var _e={activeTooltipIndex:U,isTooltipActive:!0,activeLabel:G,activePayload:H,activeCoordinate:de};this.setState(_e),this.renderCursor($),this.accessibilityManager.setIndex(U)}}}},{key:"getSnapshotBeforeUpdate",value:function(C,D){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==D.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==C.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==C.margin){var L,N;this.accessibilityManager.setDetails({offset:{left:(L=this.props.margin.left)!==null&&L!==void 0?L:0,top:(N=this.props.margin.top)!==null&&N!==void 0?N:0}})}return null}},{key:"componentDidUpdate",value:function(C){i$([Ud(C.children,Fu)],[Ud(this.props.children,Fu)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var C=Ud(this.props.children,Fu);if(C&&typeof C.props.shared=="boolean"){var D=C.props.shared?"axis":"item";return a.indexOf(D)>=0?D:o}return o}},{key:"getMouseInfo",value:function(C){if(!this.container)return null;var D=this.container,L=D.getBoundingClientRect(),N=rFe(L),j={chartX:Math.round(C.pageX-N.left),chartY:Math.round(C.pageY-N.top)},$=L.width/D.offsetWidth||1,U=this.inRange(j.chartX,j.chartY,$);if(!U)return null;var G=this.state,H=G.xAxisMap,X=G.yAxisMap,ee=this.getTooltipEventType(),ae=TH(this.state,this.props.data,this.props.layout,U);if(ee!=="axis"&&H&&X){var de=qg(H).scale,ye=qg(X).scale,_e=de&&de.invert?de.invert(j.chartX):null,ue=ye&&ye.invert?ye.invert(j.chartY):null;return Nr(Nr({},j),{},{xValue:_e,yValue:ue},ae)}return ae?Nr(Nr({},j),ae):null}},{key:"inRange",value:function(C,D){var L=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,N=this.props.layout,j=C/L,$=D/L;if(N==="horizontal"||N==="vertical"){var U=this.state.offset,G=j>=U.left&&j<=U.left+U.width&&$>=U.top&&$<=U.top+U.height;return G?{x:j,y:$}:null}var H=this.state,X=H.angleAxisMap,ee=H.radiusAxisMap;if(X&&ee){var ae=qg(X);return KG({x:j,y:$},ae)}return null}},{key:"parseEventsOfWrapper",value:function(){var C=this.props.children,D=this.getTooltipEventType(),L=Ud(C,Fu),N={};L&&D==="axis"&&(L.props.trigger==="click"?N={onClick:this.handleClick}:N={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var j=zA(this.props,this.handleOuterEvent);return Nr(Nr({},j),N)}},{key:"addListener",value:function(){TO.on(PO,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){TO.removeListener(PO,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(C,D,L){for(var N=this.state.formattedGraphicalItems,j=0,$=N.length;j<$;j++){var U=N[j];if(U.item===C||U.props.key===C.key||D===Rm(U.item.type)&&L===U.childIndex)return U}return null}},{key:"renderClipPath",value:function(){var C=this.clipPathId,D=this.state.offset,L=D.left,N=D.top,j=D.height,$=D.width;return ct.createElement("defs",null,ct.createElement("clipPath",{id:C},ct.createElement("rect",{x:L,y:N,height:j,width:$})))}},{key:"getXScales",value:function(){var C=this.state.xAxisMap;return C?Object.entries(C).reduce(function(D,L){var N=wH(L,2),j=N[0],$=N[1];return Nr(Nr({},D),{},Ti({},j,$.scale))},{}):null}},{key:"getYScales",value:function(){var C=this.state.yAxisMap;return C?Object.entries(C).reduce(function(D,L){var N=wH(L,2),j=N[0],$=N[1];return Nr(Nr({},D),{},Ti({},j,$.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(C){var D;return(D=this.state.xAxisMap)===null||D===void 0||(D=D[C])===null||D===void 0?void 0:D.scale}},{key:"getYScaleByAxisId",value:function(C){var D;return(D=this.state.yAxisMap)===null||D===void 0||(D=D[C])===null||D===void 0?void 0:D.scale}},{key:"getItemByXY",value:function(C){var D=this.state,L=D.formattedGraphicalItems,N=D.activeItem;if(L&&L.length)for(var j=0,$=L.length;j<$;j++){var U=L[j],G=U.props,H=U.item,X=H.type.defaultProps!==void 0?Nr(Nr({},H.type.defaultProps),H.props):H.props,ee=Rm(H.type);if(ee==="Bar"){var ae=(G.data||[]).find(function(ue){return R7e(C,ue)});if(ae)return{graphicalItem:U,payload:ae}}else if(ee==="RadialBar"){var de=(G.data||[]).find(function(ue){return KG(C,ue)});if(de)return{graphicalItem:U,payload:de}}else if(yk(U,N)||vk(U,N)||RM(U,N)){var ye=P9e({graphicalItem:U,activeTooltipItem:N,itemData:X.data}),_e=X.activeIndex===void 0?ye:X.activeIndex;return{graphicalItem:Nr(Nr({},U),{},{childIndex:_e}),payload:RM(U,N)?X.data[ye]:U.props.data[ye]}}}return null}},{key:"render",value:function(){var C=this;if(!FW(this))return null;var D=this.props,L=D.children,N=D.className,j=D.width,$=D.height,U=D.style,G=D.compact,H=D.title,X=D.desc,ee=MH(D,QKe),ae=ii(ee,!1);if(G)return ct.createElement(rH,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},ct.createElement(a$,c1({},ae,{width:j,height:$,title:H,desc:X}),this.renderClipPath(),BW(L,this.renderMap)));if(this.props.accessibilityLayer){var de,ye;ae.tabIndex=(de=this.props.tabIndex)!==null&&de!==void 0?de:0,ae.role=(ye=this.props.role)!==null&&ye!==void 0?ye:"application",ae.onKeyDown=function(ue){C.accessibilityManager.keyboardEvent(ue)},ae.onFocus=function(){C.accessibilityManager.focus()}}var _e=this.parseEventsOfWrapper();return ct.createElement(rH,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},ct.createElement("div",c1({className:Wi("recharts-wrapper",N),style:Nr({position:"relative",cursor:"default",width:j,height:$},U)},_e,{ref:function(fe){C.container=fe}}),ct.createElement(a$,c1({},ae,{width:j,height:$,title:H,desc:X,style:mZe}),this.renderClipPath(),BW(L,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(oe.Component);Ti(M,"displayName",r),Ti(M,"defaultProps",Nr({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},g)),Ti(M,"getDerivedStateFromProps",function(E,T){var P=E.dataKey,C=E.data,D=E.children,L=E.width,N=E.height,j=E.layout,$=E.stackOffset,U=E.margin,G=T.dataStartIndex,H=T.dataEndIndex;if(T.updateId===void 0){var X=PH(E);return Nr(Nr(Nr({},X),{},{updateId:0},y(Nr(Nr({props:E},X),{},{updateId:0}),T)),{},{prevDataKey:P,prevData:C,prevWidth:L,prevHeight:N,prevLayout:j,prevStackOffset:$,prevMargin:U,prevChildren:D})}if(P!==T.prevDataKey||C!==T.prevData||L!==T.prevWidth||N!==T.prevHeight||j!==T.prevLayout||$!==T.prevStackOffset||!x1(U,T.prevMargin)){var ee=PH(E),ae={chartX:T.chartX,chartY:T.chartY,isTooltipActive:T.isTooltipActive},de=Nr(Nr({},TH(T,C,j)),{},{updateId:T.updateId+1}),ye=Nr(Nr(Nr({},ee),ae),de);return Nr(Nr(Nr({},ye),y(Nr({props:E},ye),T)),{},{prevDataKey:P,prevData:C,prevWidth:L,prevHeight:N,prevLayout:j,prevStackOffset:$,prevMargin:U,prevChildren:D})}if(!i$(D,T.prevChildren)){var _e,ue,fe,De,pe=Ud(D,fb),K=pe&&(_e=(ue=pe.props)===null||ue===void 0?void 0:ue.startIndex)!==null&&_e!==void 0?_e:G,te=pe&&(fe=(De=pe.props)===null||De===void 0?void 0:De.endIndex)!==null&&fe!==void 0?fe:H,ve=K!==G||te!==H,$e=!zi(C),Ce=$e&&!ve?T.updateId:T.updateId+1;return Nr(Nr({updateId:Ce},y(Nr(Nr({props:E},T),{},{updateId:Ce,dataStartIndex:K,dataEndIndex:te}),T)),{},{prevChildren:D,dataStartIndex:K,dataEndIndex:te})}return null}),Ti(M,"renderActiveDot",function(E,T,P){var C;return oe.isValidElement(E)?C=oe.cloneElement(E,T):Pi(E)?C=E(T):C=ct.createElement(AS,T),ct.createElement($o,{className:"recharts-active-dot",key:P},C)});var x=oe.forwardRef(function(T,P){return ct.createElement(M,c1({},T,{ref:P}))});return x.displayName=M.displayName,x},TZe=Pk({chartName:"LineChart",GraphicalChild:x0,axisComponents:[{axisType:"xAxis",AxisComp:Qm},{axisType:"yAxis",AxisComp:Wp}],formatAxisMap:BF}),BC=Pk({chartName:"BarChart",GraphicalChild:Nh,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:Qm},{axisType:"yAxis",AxisComp:Wp}],formatAxisMap:BF}),bue=Pk({chartName:"PieChart",GraphicalChild:Jp,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:_k},{axisType:"radiusAxis",AxisComp:mk}],formatAxisMap:Q8e,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),PZe=Pk({chartName:"AreaChart",GraphicalChild:Ym,axisComponents:[{axisType:"xAxis",AxisComp:Qm},{axisType:"yAxis",AxisComp:Wp}],formatAxisMap:BF});const EZe=()=>{const{user:e}=Xp(),t={totalClaims:2456,approved:1567,pending:623,rejected:266,totalLandApproved:4892.5,totalBeneficiaries:1567,districts:28},r=[{district:"Bastar",approved:234,pending:45,rejected:23},{district:"Kanker",approved:187,pending:38,rejected:19},{district:"Kondagaon",approved:156,pending:29,rejected:15},{district:"Sukma",approved:143,pending:52,rejected:21},{district:"Narayanpur",approved:128,pending:34,rejected:18},{district:"Dantewada",approved:119,pending:41,rejected:16}],n=[{name:"Agricultural",value:2456,color:"#22c55e"},{name:"Forest",value:1834,color:"#3b82f6"},{name:"Water Bodies",value:602,color:"#f59e0b"}],i=[{month:"Jan",claims:145,approvals:98},{month:"Feb",claims:167,approvals:112},{month:"Mar",claims:189,approvals:134},{month:"Apr",claims:203,approvals:156},{month:"May",claims:178,approvals:142},{month:"Jun",claims:234,approvals:187}],o=[{title:"PM-KISAN Enrollment Drive",description:"1,234 FRA beneficiaries eligible for PM-KISAN scheme",priority:"high",action:"Launch enrollment campaign"},{title:"Water Scarcity Alert",description:"15 villages showing low water index, require Jal Jeevan Mission focus",priority:"high",action:"Coordinate with Water Resources Dept"},{title:"MGNREGA Integration",description:"567 households eligible for 100 days employment guarantee",priority:"medium",action:"Issue work cards and job allocation"}],s=a=>{switch(a){case"high":return"bg-destructive text-destructive-foreground";case"medium":return"bg-warning text-warning-foreground";case"low":return"bg-success text-success-foreground";default:return"bg-muted text-muted-foreground"}};return F.jsxs("div",{className:"space-y-6",children:[F.jsxs("div",{className:"bg-gradient-card rounded-lg p-6 border border-border",children:[F.jsxs("h1",{className:"text-2xl font-bold gov-heading mb-2",children:["State Admin Dashboard - ",e==null?void 0:e.name]}),F.jsxs("p",{className:"text-muted-foreground",children:["State-level FRA analytics and policy decision support for ",e==null?void 0:e.state]}),F.jsxs("div",{className:"flex items-center space-x-2 mt-3",children:[F.jsx(O_,{className:"w-4 h-4 text-primary"}),F.jsxs("span",{className:"text-sm font-medium",children:[e==null?void 0:e.state," State Administration"]})]})]}),F.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 lg:grid-cols-7 gap-4",children:[F.jsxs(ci,{children:[F.jsx(oo,{className:"pb-3",children:F.jsx(ao,{className:"text-sm font-medium text-muted-foreground",children:"Total Claims"})}),F.jsx(ui,{children:F.jsx("div",{className:"text-2xl font-bold",children:t.totalClaims.toLocaleString()})})]}),F.jsxs(ci,{children:[F.jsx(oo,{className:"pb-3",children:F.jsx(ao,{className:"text-sm font-medium text-muted-foreground",children:"Approved"})}),F.jsx(ui,{children:F.jsx("div",{className:"text-2xl font-bold text-success",children:t.approved.toLocaleString()})})]}),F.jsxs(ci,{children:[F.jsx(oo,{className:"pb-3",children:F.jsx(ao,{className:"text-sm font-medium text-muted-foreground",children:"Pending"})}),F.jsx(ui,{children:F.jsx("div",{className:"text-2xl font-bold text-warning",children:t.pending.toLocaleString()})})]}),F.jsxs(ci,{children:[F.jsx(oo,{className:"pb-3",children:F.jsx(ao,{className:"text-sm font-medium text-muted-foreground",children:"Beneficiaries"})}),F.jsx(ui,{children:F.jsx("div",{className:"text-xl font-bold text-primary",children:t.totalBeneficiaries.toLocaleString()})})]}),F.jsxs(ci,{children:[F.jsx(oo,{className:"pb-3",children:F.jsx(ao,{className:"text-sm font-medium text-muted-foreground",children:"Districts"})}),F.jsx(ui,{children:F.jsx("div",{className:"text-xl font-bold",children:t.districts})})]}),F.jsxs(ci,{children:[F.jsx(oo,{className:"pb-3",children:F.jsx(ao,{className:"text-sm font-medium text-muted-foreground",children:"Land Approved"})}),F.jsx(ui,{children:F.jsxs("div",{className:"text-lg font-bold text-success",children:[t.totalLandApproved.toLocaleString()," acres"]})})]}),F.jsxs(ci,{children:[F.jsx(oo,{className:"pb-3",children:F.jsx(ao,{className:"text-sm font-medium text-muted-foreground",children:"Success Rate"})}),F.jsx(ui,{children:F.jsxs("div",{className:"text-xl font-bold text-primary",children:[Math.round(t.approved/t.totalClaims*100),"%"]})})]})]}),F.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[F.jsxs(ci,{children:[F.jsxs(oo,{children:[F.jsxs(ao,{className:"flex items-center space-x-2",children:[F.jsx(BC,{className:"w-5 h-5"}),F.jsx("span",{children:"District-wise Claims Status"})]}),F.jsx(Fc,{children:"Approved vs Pending claims by district"})]}),F.jsx(ui,{children:F.jsx(M1,{width:"100%",height:300,children:F.jsxs(BC,{data:r,children:[F.jsx(VM,{strokeDasharray:"3 3"}),F.jsx(Qm,{dataKey:"district"}),F.jsx(Wp,{}),F.jsx(Fu,{}),F.jsx(Nh,{dataKey:"approved",fill:"#22c55e",name:"Approved"}),F.jsx(Nh,{dataKey:"pending",fill:"#f59e0b",name:"Pending"}),F.jsx(Nh,{dataKey:"rejected",fill:"#ef4444",name:"Rejected"})]})})})]}),F.jsxs(ci,{children:[F.jsxs(oo,{children:[F.jsx(ao,{children:"Land Type Distribution"}),F.jsx(Fc,{children:"Approved land by usage type"})]}),F.jsx(ui,{children:F.jsx(M1,{width:"100%",height:300,children:F.jsxs(bue,{children:[F.jsx(Jp,{data:n,cx:"50%",cy:"50%",outerRadius:100,dataKey:"value",label:({name:a,percent:u})=>`${a} ${(u*100).toFixed(0)}%`,children:n.map((a,u)=>F.jsx(wS,{fill:a.color},`cell-${u}`))}),F.jsx(Fu,{})]})})})]})]}),F.jsxs(ci,{children:[F.jsxs(oo,{children:[F.jsxs(ao,{className:"flex items-center space-x-2",children:[F.jsx(ME,{className:"w-5 h-5"}),F.jsx("span",{children:"Monthly Claims & Approval Trends"})]}),F.jsx(Fc,{children:"Track processing efficiency over time"})]}),F.jsx(ui,{children:F.jsx(M1,{width:"100%",height:300,children:F.jsxs(TZe,{data:i,children:[F.jsx(VM,{strokeDasharray:"3 3"}),F.jsx(Qm,{dataKey:"month"}),F.jsx(Wp,{}),F.jsx(Fu,{}),F.jsx(x0,{type:"monotone",dataKey:"claims",stroke:"#3b82f6",name:"New Claims",strokeWidth:2}),F.jsx(x0,{type:"monotone",dataKey:"approvals",stroke:"#22c55e",name:"Approvals",strokeWidth:2})]})})})]}),F.jsxs(ci,{children:[F.jsx(oo,{children:F.jsxs("div",{className:"flex items-center justify-between",children:[F.jsxs("div",{children:[F.jsxs(ao,{className:"flex items-center space-x-2",children:[F.jsx(q2,{className:"w-5 h-5"}),F.jsx("span",{children:"DSS Policy Recommendations"})]}),F.jsx(Fc,{children:"AI-driven insights for policy interventions"})]}),F.jsx(iu,{asChild:!0,variant:"outline",size:"sm",children:F.jsx(xA,{to:"/dss",children:"View Full DSS"})})]})}),F.jsx(ui,{className:"space-y-4",children:o.map((a,u)=>F.jsxs("div",{className:"border border-border rounded-lg p-4",children:[F.jsxs("div",{className:"flex items-start justify-between mb-2",children:[F.jsx("h3",{className:"font-semibold text-sm",children:a.title}),F.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${s(a.priority)}`,children:a.priority.toUpperCase()})]}),F.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:a.description}),F.jsxs("div",{className:"flex items-center space-x-2",children:[F.jsx(ej,{className:"w-4 h-4 text-warning"}),F.jsxs("span",{className:"text-sm font-medium",children:["Action: ",a.action]})]})]},u))})]}),F.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[F.jsx(ci,{className:"hover:shadow-glow transition-shadow cursor-pointer",children:F.jsx(ui,{className:"p-6",children:F.jsxs("div",{className:"flex items-center space-x-3",children:[F.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center",children:F.jsx(w_,{className:"w-6 h-6 text-primary"})}),F.jsxs("div",{children:[F.jsx("h3",{className:"font-semibold",children:"State Report"}),F.jsx("p",{className:"text-sm text-muted-foreground",children:"Generate annual report"})]})]})})}),F.jsx(ci,{className:"hover:shadow-glow transition-shadow cursor-pointer",children:F.jsx(ui,{className:"p-6",children:F.jsxs("div",{className:"flex items-center space-x-3",children:[F.jsx("div",{className:"w-12 h-12 bg-success/10 rounded-lg flex items-center justify-center",children:F.jsx(wE,{className:"w-6 h-6 text-success"})}),F.jsxs("div",{children:[F.jsx("h3",{className:"font-semibold",children:"Budget Analysis"}),F.jsx("p",{className:"text-sm text-muted-foreground",children:"Fund allocation review"})]})]})})}),F.jsx(ci,{className:"hover:shadow-glow transition-shadow cursor-pointer",children:F.jsx(ui,{className:"p-6",children:F.jsxs("div",{className:"flex items-center space-x-3",children:[F.jsx("div",{className:"w-12 h-12 bg-warning/10 rounded-lg flex items-center justify-center",children:F.jsx(l0,{className:"w-6 h-6 text-warning"})}),F.jsxs("div",{children:[F.jsx("h3",{className:"font-semibold",children:"Officer Training"}),F.jsx("p",{className:"text-sm text-muted-foreground",children:"Capacity building"})]})]})})}),F.jsx(ci,{className:"hover:shadow-glow transition-shadow cursor-pointer",children:F.jsx(ui,{className:"p-6",children:F.jsxs("div",{className:"flex items-center space-x-3",children:[F.jsx("div",{className:"w-12 h-12 bg-destructive/10 rounded-lg flex items-center justify-center",children:F.jsx(G2,{className:"w-6 h-6 text-destructive"})}),F.jsxs("div",{children:[F.jsx("h3",{className:"font-semibold",children:"Data Export"}),F.jsx("p",{className:"text-sm text-muted-foreground",children:"Download datasets"})]})]})})})]})]})},AZe=()=>{const{user:e}=Xp();if(!e)return null;const t=()=>{switch(e.role){case"user":return F.jsx(TW,{});case"officer":return F.jsx(jEe,{});case"admin":return F.jsx(EZe,{});default:return F.jsx(TW,{})}};return F.jsx(jf.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"container mx-auto px-4 py-8",children:t()})};var xue={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.7.0/LICENSE.txt
 */(function(e,t){(function(r,n){e.exports=n()})(Fv,function(){var r={},n={};function i(s,a,u){if(n[s]=u,s==="index"){var d="var sharedModule = {}; ("+n.shared+")(sharedModule); ("+n.worker+")(sharedModule);",m={};return n.shared(m),n.index(r,m),typeof window<"u"&&r.setWorkerUrl(window.URL.createObjectURL(new Blob([d],{type:"text/javascript"}))),r}}i("shared",["exports"],function(s){function a(f,c,h,v){return new(h||(h=Promise))(function(w,I){function O(J){try{V(v.next(J))}catch(ne){I(ne)}}function z(J){try{V(v.throw(J))}catch(ne){I(ne)}}function V(J){var ne;J.done?w(J.value):(ne=J.value,ne instanceof h?ne:new h(function(me){me(ne)})).then(O,z)}V((v=v.apply(f,c||[])).next())})}function u(f,c){this.x=f,this.y=c}function d(f){return f&&f.__esModule&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f}var m,g;typeof SuppressedError=="function"&&SuppressedError,u.prototype={clone(){return new u(this.x,this.y)},add(f){return this.clone()._add(f)},sub(f){return this.clone()._sub(f)},multByPoint(f){return this.clone()._multByPoint(f)},divByPoint(f){return this.clone()._divByPoint(f)},mult(f){return this.clone()._mult(f)},div(f){return this.clone()._div(f)},rotate(f){return this.clone()._rotate(f)},rotateAround(f,c){return this.clone()._rotateAround(f,c)},matMult(f){return this.clone()._matMult(f)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(f){return this.x===f.x&&this.y===f.y},dist(f){return Math.sqrt(this.distSqr(f))},distSqr(f){const c=f.x-this.x,h=f.y-this.y;return c*c+h*h},angle(){return Math.atan2(this.y,this.x)},angleTo(f){return Math.atan2(this.y-f.y,this.x-f.x)},angleWith(f){return this.angleWithSep(f.x,f.y)},angleWithSep(f,c){return Math.atan2(this.x*c-this.y*f,this.x*f+this.y*c)},_matMult(f){const c=f[2]*this.x+f[3]*this.y;return this.x=f[0]*this.x+f[1]*this.y,this.y=c,this},_add(f){return this.x+=f.x,this.y+=f.y,this},_sub(f){return this.x-=f.x,this.y-=f.y,this},_mult(f){return this.x*=f,this.y*=f,this},_div(f){return this.x/=f,this.y/=f,this},_multByPoint(f){return this.x*=f.x,this.y*=f.y,this},_divByPoint(f){return this.x/=f.x,this.y/=f.y,this},_unit(){return this._div(this.mag()),this},_perp(){const f=this.y;return this.y=this.x,this.x=-f,this},_rotate(f){const c=Math.cos(f),h=Math.sin(f),v=h*this.x+c*this.y;return this.x=c*this.x-h*this.y,this.y=v,this},_rotateAround(f,c){const h=Math.cos(f),v=Math.sin(f),w=c.y+v*(this.x-c.x)+h*(this.y-c.y);return this.x=c.x+h*(this.x-c.x)-v*(this.y-c.y),this.y=w,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:u},u.convert=function(f){if(f instanceof u)return f;if(Array.isArray(f))return new u(+f[0],+f[1]);if(f.x!==void 0&&f.y!==void 0)return new u(+f.x,+f.y);throw new Error("Expected [x, y] or {x, y} point format")};var _=function(){if(g)return m;function f(c,h,v,w){this.cx=3*c,this.bx=3*(v-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*h,this.by=3*(w-h)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=h,this.p2x=v,this.p2y=w}return g=1,m=f,f.prototype={sampleCurveX:function(c){return((this.ax*c+this.bx)*c+this.cx)*c},sampleCurveY:function(c){return((this.ay*c+this.by)*c+this.cy)*c},sampleCurveDerivativeX:function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},solveCurveX:function(c,h){if(h===void 0&&(h=1e-6),c<0)return 0;if(c>1)return 1;for(var v=c,w=0;w<8;w++){var I=this.sampleCurveX(v)-c;if(Math.abs(I)<h)return v;var O=this.sampleCurveDerivativeX(v);if(Math.abs(O)<1e-6)break;v-=I/O}var z=0,V=1;for(v=c,w=0;w<20&&(I=this.sampleCurveX(v),!(Math.abs(I-c)<h));w++)c>I?z=v:V=v,v=.5*(V-z)+z;return v},solve:function(c,h){return this.sampleCurveY(this.solveCurveX(c,h))}},m}(),y=d(_);let M,x;function E(){return M==null&&(M=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),M}function T(){if(x==null&&(x=!1,E())){const c=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(c){for(let v=0;v<5*5;v++){const w=4*v;c.fillStyle=`rgb(${w},${w+1},${w+2})`,c.fillRect(v%5,Math.floor(v/5),1,1)}const h=c.getImageData(0,0,5,5).data;for(let v=0;v<5*5*4;v++)if(v%4!=3&&h[v]!==v){x=!0;break}}}return x||!1}var P=1e-6,C=typeof Float32Array<"u"?Float32Array:Array;function D(){var f=new C(9);return C!=Float32Array&&(f[1]=0,f[2]=0,f[3]=0,f[5]=0,f[6]=0,f[7]=0),f[0]=1,f[4]=1,f[8]=1,f}function L(f){return f[0]=1,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=1,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=1,f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f}function N(){var f=new C(3);return C!=Float32Array&&(f[0]=0,f[1]=0,f[2]=0),f}function j(f){var c=f[0],h=f[1],v=f[2];return Math.sqrt(c*c+h*h+v*v)}function $(f,c,h){var v=new C(3);return v[0]=f,v[1]=c,v[2]=h,v}function U(f,c,h){return f[0]=c[0]+h[0],f[1]=c[1]+h[1],f[2]=c[2]+h[2],f}function G(f,c,h){return f[0]=c[0]*h,f[1]=c[1]*h,f[2]=c[2]*h,f}function H(f,c,h){var v=c[0],w=c[1],I=c[2],O=h[0],z=h[1],V=h[2];return f[0]=w*V-I*z,f[1]=I*O-v*V,f[2]=v*z-w*O,f}var X,ee=j;function ae(f,c,h){var v=c[0],w=c[1],I=c[2],O=c[3];return f[0]=h[0]*v+h[4]*w+h[8]*I+h[12]*O,f[1]=h[1]*v+h[5]*w+h[9]*I+h[13]*O,f[2]=h[2]*v+h[6]*w+h[10]*I+h[14]*O,f[3]=h[3]*v+h[7]*w+h[11]*I+h[15]*O,f}function de(){var f=new C(4);return C!=Float32Array&&(f[0]=0,f[1]=0,f[2]=0),f[3]=1,f}function ye(f,c,h,v){var w=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",I=Math.PI/360;c*=I,v*=I,h*=I;var O=Math.sin(c),z=Math.cos(c),V=Math.sin(h),J=Math.cos(h),ne=Math.sin(v),me=Math.cos(v);switch(w){case"xyz":f[0]=O*J*me+z*V*ne,f[1]=z*V*me-O*J*ne,f[2]=z*J*ne+O*V*me,f[3]=z*J*me-O*V*ne;break;case"xzy":f[0]=O*J*me-z*V*ne,f[1]=z*V*me-O*J*ne,f[2]=z*J*ne+O*V*me,f[3]=z*J*me+O*V*ne;break;case"yxz":f[0]=O*J*me+z*V*ne,f[1]=z*V*me-O*J*ne,f[2]=z*J*ne-O*V*me,f[3]=z*J*me+O*V*ne;break;case"yzx":f[0]=O*J*me+z*V*ne,f[1]=z*V*me+O*J*ne,f[2]=z*J*ne-O*V*me,f[3]=z*J*me-O*V*ne;break;case"zxy":f[0]=O*J*me-z*V*ne,f[1]=z*V*me+O*J*ne,f[2]=z*J*ne+O*V*me,f[3]=z*J*me-O*V*ne;break;case"zyx":f[0]=O*J*me-z*V*ne,f[1]=z*V*me+O*J*ne,f[2]=z*J*ne-O*V*me,f[3]=z*J*me+O*V*ne;break;default:throw new Error("Unknown angle order "+w)}return f}function _e(){var f=new C(2);return C!=Float32Array&&(f[0]=0,f[1]=0),f}function ue(f,c){var h=new C(2);return h[0]=f,h[1]=c,h}N(),X=new C(4),C!=Float32Array&&(X[0]=0,X[1]=0,X[2]=0,X[3]=0),N(),$(1,0,0),$(0,1,0),de(),de(),D(),_e();const fe=8192;function De(f,c,h){return c*(fe/(f.tileSize*Math.pow(2,h-f.tileID.overscaledZ)))}function pe(f,c){return(f%c+c)%c}function K(f,c,h){return f*(1-h)+c*h}function te(f){if(f<=0)return 0;if(f>=1)return 1;const c=f*f,h=c*f;return 4*(f<.5?h:3*(f-c)+h-.75)}function ve(f,c,h,v){const w=new y(f,c,h,v);return I=>w.solve(I)}const $e=ve(.25,.1,.25,1);function Ce(f,c,h){return Math.min(h,Math.max(c,f))}function Ge(f,c,h){const v=h-c,w=((f-c)%v+v)%v+c;return w===c?h:w}function ot(f,...c){for(const h of c)for(const v in h)f[v]=h[v];return f}let Ye=1;function et(f,c,h){const v={};for(const w in f)v[w]=c.call(this,f[w],w,f);return v}function Te(f,c,h){const v={};for(const w in f)c.call(this,f[w],w,f)&&(v[w]=f[w]);return v}function Le(f){return Array.isArray(f)?f.map(Le):typeof f=="object"&&f?et(f,Le):f}const ke={};function Xe(f){ke[f]||(typeof console<"u"&&console.warn(f),ke[f]=!0)}function Ne(f,c,h){return(h.y-f.y)*(c.x-f.x)>(c.y-f.y)*(h.x-f.x)}function Ot(f){return typeof WorkerGlobalScope<"u"&&f!==void 0&&f instanceof WorkerGlobalScope}let Lt=null;function kt(f){return typeof ImageBitmap<"u"&&f instanceof ImageBitmap}const mt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Zt(f,c,h,v,w){return a(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const I=new VideoFrame(f,{timestamp:0});try{const O=I==null?void 0:I.format;if(!O||!O.startsWith("BGR")&&!O.startsWith("RGB"))throw new Error(`Unrecognized format ${O}`);const z=O.startsWith("BGR"),V=new Uint8ClampedArray(v*w*4);if(yield I.copyTo(V,function(J,ne,me,Ee,je){const Fe=4*Math.max(-ne,0),He=(Math.max(0,me)-me)*Ee*4+Fe,st=4*Ee,yt=Math.max(0,ne),Xt=Math.max(0,me);return{rect:{x:yt,y:Xt,width:Math.min(J.width,ne+Ee)-yt,height:Math.min(J.height,me+je)-Xt},layout:[{offset:He,stride:st}]}}(f,c,h,v,w)),z)for(let J=0;J<V.length;J+=4){const ne=V[J];V[J]=V[J+2],V[J+2]=ne}return V}finally{I.close()}})}let Kt,dr;function Bt(f,c,h,v){return f.addEventListener(c,h,v),{unsubscribe:()=>{f.removeEventListener(c,h,v)}}}function wr(f){return f*Math.PI/180}function mr(f){return f/Math.PI*180}const hr={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},xr={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},or="AbortError";function tt(){return new Error(or)}const Se={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Pe(f){return Se.REGISTERED_PROTOCOLS[f.substring(0,f.indexOf("://"))]}const Ve="global-dispatcher";class Qe extends Error{constructor(c,h,v,w){super(`AJAXError: ${h} (${c}): ${v}`),this.status=c,this.statusText=h,this.url=v,this.body=w}}const dt=()=>Ot(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Pt=function(f,c){if(/:\/\//.test(f.url)&&!/^https?:|^file:/.test(f.url)){const v=Pe(f.url);if(v)return v(f,c);if(Ot(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:f,targetMapId:Ve},c)}if(!(/^file:/.test(h=f.url)||/^file:/.test(dt())&&!/^\w+:/.test(h))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(v,w){return a(this,void 0,void 0,function*(){const I=new Request(v.url,{method:v.method||"GET",body:v.body,credentials:v.credentials,headers:v.headers,cache:v.cache,referrer:dt(),signal:w.signal});let O,z;v.type!=="json"||I.headers.has("Accept")||I.headers.set("Accept","application/json");try{O=yield fetch(I)}catch(J){throw new Qe(0,J.message,v.url,new Blob)}if(!O.ok){const J=yield O.blob();throw new Qe(O.status,O.statusText,v.url,J)}z=v.type==="arrayBuffer"||v.type==="image"?O.arrayBuffer():v.type==="json"?O.json():O.text();const V=yield z;if(w.signal.aborted)throw tt();return{data:V,cacheControl:O.headers.get("Cache-Control"),expires:O.headers.get("Expires")}})}(f,c);if(Ot(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:f,mustQueue:!0,targetMapId:Ve},c)}var h;return function(v,w){return new Promise((I,O)=>{var z;const V=new XMLHttpRequest;V.open(v.method||"GET",v.url,!0),v.type!=="arrayBuffer"&&v.type!=="image"||(V.responseType="arraybuffer");for(const J in v.headers)V.setRequestHeader(J,v.headers[J]);v.type==="json"&&(V.responseType="text",!((z=v.headers)===null||z===void 0)&&z.Accept||V.setRequestHeader("Accept","application/json")),V.withCredentials=v.credentials==="include",V.onerror=()=>{O(new Error(V.statusText))},V.onload=()=>{if(!w.signal.aborted)if((V.status>=200&&V.status<300||V.status===0)&&V.response!==null){let J=V.response;if(v.type==="json")try{J=JSON.parse(V.response)}catch(ne){return void O(ne)}I({data:J,cacheControl:V.getResponseHeader("Cache-Control"),expires:V.getResponseHeader("Expires")})}else{const J=new Blob([V.response],{type:V.getResponseHeader("Content-Type")});O(new Qe(V.status,V.statusText,v.url,J))}},w.signal.addEventListener("abort",()=>{V.abort(),O(tt())}),V.send(v.body)})}(f,c)};function Vt(f){if(!f||f.indexOf("://")<=0||f.indexOf("data:image/")===0||f.indexOf("blob:")===0)return!0;const c=new URL(f),h=window.location;return c.protocol===h.protocol&&c.host===h.host}function At(f,c,h){h[f]&&h[f].indexOf(c)!==-1||(h[f]=h[f]||[],h[f].push(c))}function qt(f,c,h){if(h&&h[f]){const v=h[f].indexOf(c);v!==-1&&h[f].splice(v,1)}}class er{constructor(c,h={}){ot(this,h),this.type=c}}class fr extends er{constructor(c,h={}){super("error",ot({error:c},h))}}class Jr{on(c,h){return this._listeners=this._listeners||{},At(c,h,this._listeners),{unsubscribe:()=>{this.off(c,h)}}}off(c,h){return qt(c,h,this._listeners),qt(c,h,this._oneTimeListeners),this}once(c,h){return h?(this._oneTimeListeners=this._oneTimeListeners||{},At(c,h,this._oneTimeListeners),this):new Promise(v=>this.once(c,v))}fire(c,h){typeof c=="string"&&(c=new er(c,h||{}));const v=c.type;if(this.listens(v)){c.target=this;const w=this._listeners&&this._listeners[v]?this._listeners[v].slice():[];for(const z of w)z.call(this,c);const I=this._oneTimeListeners&&this._oneTimeListeners[v]?this._oneTimeListeners[v].slice():[];for(const z of I)qt(v,z,this._oneTimeListeners),z.call(this,c);const O=this._eventedParent;O&&(ot(c,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),O.fire(c))}else c instanceof fr&&console.error(c.error);return this}listens(c){return this._listeners&&this._listeners[c]&&this._listeners[c].length>0||this._oneTimeListeners&&this._oneTimeListeners[c]&&this._oneTimeListeners[c].length>0||this._eventedParent&&this._eventedParent.listens(c)}setEventedParent(c,h){return this._eventedParent=c,this._eventedParentData=h,this}}var $t={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const zr=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Sr(f,c){const h={};for(const v in f)v!=="ref"&&(h[v]=f[v]);return zr.forEach(v=>{v in c&&(h[v]=c[v])}),h}function Ir(f,c){if(Array.isArray(f)){if(!Array.isArray(c)||f.length!==c.length)return!1;for(let h=0;h<f.length;h++)if(!Ir(f[h],c[h]))return!1;return!0}if(typeof f=="object"&&f!==null&&c!==null){if(typeof c!="object"||Object.keys(f).length!==Object.keys(c).length)return!1;for(const h in f)if(!Ir(f[h],c[h]))return!1;return!0}return f===c}function Xr(f,c){f.push(c)}function qr(f,c,h){Xr(h,{command:"addSource",args:[f,c[f]]})}function An(f,c,h){Xr(c,{command:"removeSource",args:[f]}),h[f]=!0}function ge(f,c,h,v){An(f,h,v),qr(f,c,h)}function ut(f,c,h){let v;for(v in f[h])if(Object.prototype.hasOwnProperty.call(f[h],v)&&v!=="data"&&!Ir(f[h][v],c[h][v]))return!1;for(v in c[h])if(Object.prototype.hasOwnProperty.call(c[h],v)&&v!=="data"&&!Ir(f[h][v],c[h][v]))return!1;return!0}function We(f,c,h,v,w,I){f=f||{},c=c||{};for(const O in f)Object.prototype.hasOwnProperty.call(f,O)&&(Ir(f[O],c[O])||h.push({command:I,args:[v,O,c[O],w]}));for(const O in c)Object.prototype.hasOwnProperty.call(c,O)&&!Object.prototype.hasOwnProperty.call(f,O)&&(Ir(f[O],c[O])||h.push({command:I,args:[v,O,c[O],w]}))}function Je(f){return f.id}function xt(f,c){return f[c.id]=c,f}class wt{constructor(c,h,v,w){this.message=(c?`${c}: `:"")+v,w&&(this.identifier=w),h!=null&&h.__line__&&(this.line=h.__line__)}}function pr(f,...c){for(const h of c)for(const v in h)f[v]=h[v];return f}class Rr extends Error{constructor(c,h){super(h),this.message=h,this.key=c}}class On{constructor(c,h=[]){this.parent=c,this.bindings={};for(const[v,w]of h)this.bindings[v]=w}concat(c){return new On(this,c)}get(c){if(this.bindings[c])return this.bindings[c];if(this.parent)return this.parent.get(c);throw new Error(`${c} not found in scope.`)}has(c){return!!this.bindings[c]||!!this.parent&&this.parent.has(c)}}const Mn={kind:"null"},_r={kind:"number"},Or={kind:"string"},an={kind:"boolean"},Vn={kind:"color"},_o={kind:"projectionDefinition"},Uo={kind:"object"},yn={kind:"value"},Vo={kind:"collator"},Po={kind:"formatted"},pa={kind:"padding"},ta={kind:"colorArray"},ra={kind:"numberArray"},so={kind:"resolvedImage"},Xs={kind:"variableAnchorOffsetCollection"};function xo(f,c){return{kind:"array",itemType:f,N:c}}function Qn(f){if(f.kind==="array"){const c=Qn(f.itemType);return typeof f.N=="number"?`array<${c}, ${f.N}>`:f.itemType.kind==="value"?"array":`array<${c}>`}return f.kind}const is=[Mn,_r,Or,an,Vn,_o,Po,Uo,xo(yn),pa,ra,ta,so,Xs];function la(f,c){if(c.kind==="error")return null;if(f.kind==="array"){if(c.kind==="array"&&(c.N===0&&c.itemType.kind==="value"||!la(f.itemType,c.itemType))&&(typeof f.N!="number"||f.N===c.N))return null}else{if(f.kind===c.kind)return null;if(f.kind==="value"){for(const h of is)if(!la(h,c))return null}}return`Expected ${Qn(f)} but found ${Qn(c)} instead.`}function $s(f,c){return c.some(h=>h.kind===f.kind)}function wo(f,c){return c.some(h=>h==="null"?f===null:h==="array"?Array.isArray(f):h==="object"?f&&!Array.isArray(f)&&typeof f=="object":h===typeof f)}function Eo(f,c){return f.kind==="array"&&c.kind==="array"?f.itemType.kind===c.itemType.kind&&typeof f.N=="number":f.kind===c.kind}const Wa=.96422,ul=.82521,os=4/29,Pr=6/29,Hr=3*Pr*Pr,gn=Pr*Pr*Pr,Zi=Math.PI/180,dl=180/Math.PI;function ba(f){return(f%=360)<0&&(f+=360),f}function Ga([f,c,h,v]){let w,I;const O=Xl((.2225045*(f=yo(f))+.7168786*(c=yo(c))+.0606169*(h=yo(h)))/1);f===c&&c===h?w=I=O:(w=Xl((.4360747*f+.3850649*c+.1430804*h)/Wa),I=Xl((.0139322*f+.0971045*c+.7141733*h)/ul));const z=116*O-16;return[z<0?0:z,500*(w-O),200*(O-I),v]}function yo(f){return f<=.04045?f/12.92:Math.pow((f+.055)/1.055,2.4)}function Xl(f){return f>gn?Math.pow(f,1/3):f/Hr+os}function Dl([f,c,h,v]){let w=(f+16)/116,I=isNaN(c)?w:w+c/500,O=isNaN(h)?w:w-h/200;return w=1*Yt(w),I=Wa*Yt(I),O=ul*Yt(O),[Uc(3.1338561*I-1.6168667*w-.4906146*O),Uc(-.9787684*I+1.9161415*w+.033454*O),Uc(.0719453*I-.2289914*w+1.4052427*O),v]}function Uc(f){return(f=f<=.00304?12.92*f:1.055*Math.pow(f,1/2.4)-.055)<0?0:f>1?1:f}function Yt(f){return f>Pr?f*f*f:Hr*(f-os)}const Ie=Object.hasOwn||function(f,c){return Object.prototype.hasOwnProperty.call(f,c)};function rt(f,c){return Ie(f,c)?f[c]:void 0}function Tt(f){return parseInt(f.padEnd(2,f),16)/255}function Ft(f,c){return Dt(c?f/100:f,0,1)}function Dt(f,c,h){return Math.min(Math.max(c,f),h)}function yr(f){return!f.some(Number.isNaN)}const Vr={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function en(f,c,h){return f+h*(c-f)}function Qr(f,c,h){return f.map((v,w)=>en(v,c[w],h))}class Dr{constructor(c,h,v,w=1,I=!0){this.r=c,this.g=h,this.b=v,this.a=w,I||(this.r*=w,this.g*=w,this.b*=w,w||this.overwriteGetter("rgb",[c,h,v,w]))}static parse(c){if(c instanceof Dr)return c;if(typeof c!="string")return;const h=function(v){if((v=v.toLowerCase().trim())==="transparent")return[0,0,0,0];const w=rt(Vr,v);if(w){const[O,z,V]=w;return[O/255,z/255,V/255,1]}if(v.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(v)){const O=v.length<6?1:2;let z=1;return[Tt(v.slice(z,z+=O)),Tt(v.slice(z,z+=O)),Tt(v.slice(z,z+=O)),Tt(v.slice(z,z+O)||"ff")]}if(v.startsWith("rgb")){const O=v.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(O){const[z,V,J,ne,me,Ee,je,Fe,He,st,yt,Xt]=O,Ct=[ne||" ",je||" ",st].join("");if(Ct==="  "||Ct==="  /"||Ct===",,"||Ct===",,,"){const Rt=[J,Ee,He].join(""),lr=Rt==="%%%"?100:Rt===""?255:0;if(lr){const vr=[Dt(+V/lr,0,1),Dt(+me/lr,0,1),Dt(+Fe/lr,0,1),yt?Ft(+yt,Xt):1];if(yr(vr))return vr}}return}}const I=v.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(I){const[O,z,V,J,ne,me,Ee,je,Fe]=I,He=[V||" ",ne||" ",Ee].join("");if(He==="  "||He==="  /"||He===",,"||He===",,,"){const st=[+z,Dt(+J,0,100),Dt(+me,0,100),je?Ft(+je,Fe):1];if(yr(st))return function([yt,Xt,Ct,Rt]){function lr(vr){const Fr=(vr+yt/30)%12,pn=Xt*Math.min(Ct,1-Ct);return Ct-pn*Math.max(-1,Math.min(Fr-3,9-Fr,1))}return yt=ba(yt),Xt/=100,Ct/=100,[lr(0),lr(8),lr(4),Rt]}(st)}}}(c);return h?new Dr(...h,!1):void 0}get rgb(){const{r:c,g:h,b:v,a:w}=this,I=w||1/0;return this.overwriteGetter("rgb",[c/I,h/I,v/I,w])}get hcl(){return this.overwriteGetter("hcl",function(c){const[h,v,w,I]=Ga(c),O=Math.sqrt(v*v+w*w);return[Math.round(1e4*O)?ba(Math.atan2(w,v)*dl):NaN,O,h,I]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Ga(this.rgb))}overwriteGetter(c,h){return Object.defineProperty(this,c,{value:h}),h}toString(){const[c,h,v,w]=this.rgb;return`rgba(${[c,h,v].map(I=>Math.round(255*I)).join(",")},${w})`}static interpolate(c,h,v,w="rgb"){switch(w){case"rgb":{const[I,O,z,V]=Qr(c.rgb,h.rgb,v);return new Dr(I,O,z,V,!1)}case"hcl":{const[I,O,z,V]=c.hcl,[J,ne,me,Ee]=h.hcl;let je,Fe;if(isNaN(I)||isNaN(J))isNaN(I)?isNaN(J)?je=NaN:(je=J,z!==1&&z!==0||(Fe=ne)):(je=I,me!==1&&me!==0||(Fe=O));else{let Ct=J-I;J>I&&Ct>180?Ct-=360:J<I&&I-J>180&&(Ct+=360),je=I+v*Ct}const[He,st,yt,Xt]=function([Ct,Rt,lr,vr]){return Ct=isNaN(Ct)?0:Ct*Zi,Dl([lr,Math.cos(Ct)*Rt,Math.sin(Ct)*Rt,vr])}([je,Fe??en(O,ne,v),en(z,me,v),en(V,Ee,v)]);return new Dr(He,st,yt,Xt,!1)}case"lab":{const[I,O,z,V]=Dl(Qr(c.lab,h.lab,v));return new Dr(I,O,z,V,!1)}}}}Dr.black=new Dr(0,0,0,1),Dr.white=new Dr(1,1,1,1),Dr.transparent=new Dr(0,0,0,0),Dr.red=new Dr(1,0,0,1);class Ln{constructor(c,h,v){this.sensitivity=c?h?"variant":"case":h?"accent":"base",this.locale=v,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(c,h){return this.collator.compare(c,h)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Ii=["bottom","center","top"];class vi{constructor(c,h,v,w,I,O){this.text=c,this.image=h,this.scale=v,this.fontStack=w,this.textColor=I,this.verticalAlign=O}}class Ai{constructor(c){this.sections=c}static fromString(c){return new Ai([new vi(c,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(c=>c.text.length!==0||c.image&&c.image.name.length!==0)}static factory(c){return c instanceof Ai?c:Ai.fromString(c)}toString(){return this.sections.length===0?"":this.sections.map(c=>c.text).join("")}}class rn{constructor(c){this.values=c.slice()}static parse(c){if(c instanceof rn)return c;if(typeof c=="number")return new rn([c,c,c,c]);if(Array.isArray(c)&&!(c.length<1||c.length>4)){for(const h of c)if(typeof h!="number")return;switch(c.length){case 1:c=[c[0],c[0],c[0],c[0]];break;case 2:c=[c[0],c[1],c[0],c[1]];break;case 3:c=[c[0],c[1],c[2],c[1]]}return new rn(c)}}toString(){return JSON.stringify(this.values)}static interpolate(c,h,v){return new rn(Qr(c.values,h.values,v))}}class Xi{constructor(c){this.values=c.slice()}static parse(c){if(c instanceof Xi)return c;if(typeof c=="number")return new Xi([c]);if(Array.isArray(c)){for(const h of c)if(typeof h!="number")return;return new Xi(c)}}toString(){return JSON.stringify(this.values)}static interpolate(c,h,v){return new Xi(Qr(c.values,h.values,v))}}class Oi{constructor(c){this.values=c.slice()}static parse(c){if(c instanceof Oi)return c;if(typeof c=="string"){const v=Dr.parse(c);return v?new Oi([v]):void 0}if(!Array.isArray(c))return;const h=[];for(const v of c){if(typeof v!="string")return;const w=Dr.parse(v);if(!w)return;h.push(w)}return new Oi(h)}toString(){return JSON.stringify(this.values)}static interpolate(c,h,v,w="rgb"){const I=[];if(c.values.length!=h.values.length)throw new Error(`colorArray: Arrays have mismatched length (${c.values.length} vs. ${h.values.length}), cannot interpolate.`);for(let O=0;O<c.values.length;O++)I.push(Dr.interpolate(c.values[O],h.values[O],v,w));return new Oi(I)}}class ri extends Error{constructor(c){super(c),this.name="RuntimeError"}toJSON(){return this.message}}const ma=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Ri{constructor(c){this.values=c.slice()}static parse(c){if(c instanceof Ri)return c;if(Array.isArray(c)&&!(c.length<1)&&c.length%2==0){for(let h=0;h<c.length;h+=2){const v=c[h],w=c[h+1];if(typeof v!="string"||!ma.has(v)||!Array.isArray(w)||w.length!==2||typeof w[0]!="number"||typeof w[1]!="number")return}return new Ri(c)}}toString(){return JSON.stringify(this.values)}static interpolate(c,h,v){const w=c.values,I=h.values;if(w.length!==I.length)throw new ri(`Cannot interpolate values of different length. from: ${c.toString()}, to: ${h.toString()}`);const O=[];for(let z=0;z<w.length;z+=2){if(w[z]!==I[z])throw new ri(`Cannot interpolate values containing mismatched anchors. from[${z}]: ${w[z]}, to[${z}]: ${I[z]}`);O.push(w[z]);const[V,J]=w[z+1],[ne,me]=I[z+1];O.push([en(V,ne,v),en(J,me,v)])}return new Ri(O)}}class lo{constructor(c){this.name=c.name,this.available=c.available}toString(){return this.name}static fromString(c){return c?new lo({name:c,available:!1}):null}}class Mi{constructor(c,h,v){this.from=c,this.to=h,this.transition=v}static interpolate(c,h,v){return new Mi(c,h,v)}static parse(c){return c instanceof Mi?c:Array.isArray(c)&&c.length===3&&typeof c[0]=="string"&&typeof c[1]=="string"&&typeof c[2]=="number"?new Mi(c[0],c[1],c[2]):typeof c=="object"&&typeof c.from=="string"&&typeof c.to=="string"&&typeof c.transition=="number"?new Mi(c.from,c.to,c.transition):typeof c=="string"?new Mi(c,c,1):void 0}}function di(f,c,h,v){return typeof f=="number"&&f>=0&&f<=255&&typeof c=="number"&&c>=0&&c<=255&&typeof h=="number"&&h>=0&&h<=255?v===void 0||typeof v=="number"&&v>=0&&v<=1?null:`Invalid rgba value [${[f,c,h,v].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof v=="number"?[f,c,h,v]:[f,c,h]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ho(f){if(f===null||typeof f=="string"||typeof f=="boolean"||typeof f=="number"||f instanceof Mi||f instanceof Dr||f instanceof Ln||f instanceof Ai||f instanceof rn||f instanceof Xi||f instanceof Oi||f instanceof Ri||f instanceof lo)return!0;if(Array.isArray(f)){for(const c of f)if(!Ho(c))return!1;return!0}if(typeof f=="object"){for(const c in f)if(!Ho(f[c]))return!1;return!0}return!1}function bn(f){if(f===null)return Mn;if(typeof f=="string")return Or;if(typeof f=="boolean")return an;if(typeof f=="number")return _r;if(f instanceof Dr)return Vn;if(f instanceof Mi)return _o;if(f instanceof Ln)return Vo;if(f instanceof Ai)return Po;if(f instanceof rn)return pa;if(f instanceof Xi)return ra;if(f instanceof Oi)return ta;if(f instanceof Ri)return Xs;if(f instanceof lo)return so;if(Array.isArray(f)){const c=f.length;let h;for(const v of f){const w=bn(v);if(h){if(h===w)continue;h=yn;break}h=w}return xo(h||yn,c)}return Uo}function Nn(f){const c=typeof f;return f===null?"":c==="string"||c==="number"||c==="boolean"?String(f):f instanceof Dr||f instanceof Mi||f instanceof Ai||f instanceof rn||f instanceof Xi||f instanceof Oi||f instanceof Ri||f instanceof lo?f.toString():JSON.stringify(f)}class Mo{constructor(c,h){this.type=c,this.value=h}static parse(c,h){if(c.length!==2)return h.error(`'literal' expression requires exactly one argument, but found ${c.length-1} instead.`);if(!Ho(c[1]))return h.error("invalid value");const v=c[1];let w=bn(v);const I=h.expectedType;return w.kind!=="array"||w.N!==0||!I||I.kind!=="array"||typeof I.N=="number"&&I.N!==0||(w=I),new Mo(w,v)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const ni={string:Or,number:_r,boolean:an,object:Uo};class Yi{constructor(c,h){this.type=c,this.args=h}static parse(c,h){if(c.length<2)return h.error("Expected at least one argument.");let v,w=1;const I=c[0];if(I==="array"){let z,V;if(c.length>2){const J=c[1];if(typeof J!="string"||!(J in ni)||J==="object")return h.error('The item type argument of "array" must be one of string, number, boolean',1);z=ni[J],w++}else z=yn;if(c.length>3){if(c[2]!==null&&(typeof c[2]!="number"||c[2]<0||c[2]!==Math.floor(c[2])))return h.error('The length argument to "array" must be a positive integer literal',2);V=c[2],w++}v=xo(z,V)}else{if(!ni[I])throw new Error(`Types doesn't contain name = ${I}`);v=ni[I]}const O=[];for(;w<c.length;w++){const z=h.parse(c[w],w,yn);if(!z)return null;O.push(z)}return new Yi(v,O)}evaluate(c){for(let h=0;h<this.args.length;h++){const v=this.args[h].evaluate(c);if(!la(this.type,bn(v)))return v;if(h===this.args.length-1)throw new ri(`Expected value to be of type ${Qn(this.type)}, but found ${Qn(bn(v))} instead.`)}throw new Error}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every(c=>c.outputDefined())}}const Qi={"to-boolean":an,"to-color":Vn,"to-number":_r,"to-string":Or};class co{constructor(c,h){this.type=c,this.args=h}static parse(c,h){if(c.length<2)return h.error("Expected at least one argument.");const v=c[0];if(!Qi[v])throw new Error(`Can't parse ${v} as it is not part of the known types`);if((v==="to-boolean"||v==="to-string")&&c.length!==2)return h.error("Expected one argument.");const w=Qi[v],I=[];for(let O=1;O<c.length;O++){const z=h.parse(c[O],O,yn);if(!z)return null;I.push(z)}return new co(w,I)}evaluate(c){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(c);case"color":{let h,v;for(const w of this.args){if(h=w.evaluate(c),v=null,h instanceof Dr)return h;if(typeof h=="string"){const I=c.parseColor(h);if(I)return I}else if(Array.isArray(h)&&(v=h.length<3||h.length>4?`Invalid rgba value ${JSON.stringify(h)}: expected an array containing either three or four numeric values.`:di(h[0],h[1],h[2],h[3]),!v))return new Dr(h[0]/255,h[1]/255,h[2]/255,h[3])}throw new ri(v||`Could not parse color from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"padding":{let h;for(const v of this.args){h=v.evaluate(c);const w=rn.parse(h);if(w)return w}throw new ri(`Could not parse padding from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"numberArray":{let h;for(const v of this.args){h=v.evaluate(c);const w=Xi.parse(h);if(w)return w}throw new ri(`Could not parse numberArray from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"colorArray":{let h;for(const v of this.args){h=v.evaluate(c);const w=Oi.parse(h);if(w)return w}throw new ri(`Could not parse colorArray from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"variableAnchorOffsetCollection":{let h;for(const v of this.args){h=v.evaluate(c);const w=Ri.parse(h);if(w)return w}throw new ri(`Could not parse variableAnchorOffsetCollection from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"number":{let h=null;for(const v of this.args){if(h=v.evaluate(c),h===null)return 0;const w=Number(h);if(!isNaN(w))return w}throw new ri(`Could not convert ${JSON.stringify(h)} to number.`)}case"formatted":return Ai.fromString(Nn(this.args[0].evaluate(c)));case"resolvedImage":return lo.fromString(Nn(this.args[0].evaluate(c)));case"projectionDefinition":return this.args[0].evaluate(c);default:return Nn(this.args[0].evaluate(c))}}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every(c=>c.outputDefined())}}const po=["Unknown","Point","LineString","Polygon"];class ga{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?po[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(c){let h=this._parseColorCache.get(c);return h||(h=Dr.parse(c),this._parseColorCache.set(c,h)),h}}class ws{constructor(c,h,v=[],w,I=new On,O=[]){this.registry=c,this.path=v,this.key=v.map(z=>`[${z}]`).join(""),this.scope=I,this.errors=O,this.expectedType=w,this._isConstant=h}parse(c,h,v,w,I={}){return h?this.concat(h,v,w)._parse(c,I):this._parse(c,I)}_parse(c,h){function v(w,I,O){return O==="assert"?new Yi(I,[w]):O==="coerce"?new co(I,[w]):w}if(c!==null&&typeof c!="string"&&typeof c!="boolean"&&typeof c!="number"||(c=["literal",c]),Array.isArray(c)){if(c.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const w=c[0];if(typeof w!="string")return this.error(`Expression name must be a string, but found ${typeof w} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const I=this.registry[w];if(I){let O=I.parse(c,this);if(!O)return null;if(this.expectedType){const z=this.expectedType,V=O.type;if(z.kind!=="string"&&z.kind!=="number"&&z.kind!=="boolean"&&z.kind!=="object"&&z.kind!=="array"||V.kind!=="value"){if(z.kind==="projectionDefinition"&&["string","array"].includes(V.kind)||["color","formatted","resolvedImage"].includes(z.kind)&&["value","string"].includes(V.kind)||["padding","numberArray"].includes(z.kind)&&["value","number","array"].includes(V.kind)||z.kind==="colorArray"&&["value","string","array"].includes(V.kind)||z.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(V.kind))O=v(O,z,h.typeAnnotation||"coerce");else if(this.checkSubtype(z,V))return null}else O=v(O,z,h.typeAnnotation||"assert")}if(!(O instanceof Mo)&&O.type.kind!=="resolvedImage"&&this._isConstant(O)){const z=new ga;try{O=new Mo(O.type,O.evaluate(z))}catch(V){return this.error(V.message),null}}return O}return this.error(`Unknown expression "${w}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(c===void 0?"'undefined' value invalid. Use null instead.":typeof c=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof c} instead.`)}concat(c,h,v){const w=typeof c=="number"?this.path.concat(c):this.path,I=v?this.scope.concat(v):this.scope;return new ws(this.registry,this._isConstant,w,h||null,I,this.errors)}error(c,...h){const v=`${this.key}${h.map(w=>`[${w}]`).join("")}`;this.errors.push(new Rr(v,c))}checkSubtype(c,h){const v=la(c,h);return v&&this.error(v),v}}class hl{constructor(c,h){this.type=h.type,this.bindings=[].concat(c),this.result=h}evaluate(c){return this.result.evaluate(c)}eachChild(c){for(const h of this.bindings)c(h[1]);c(this.result)}static parse(c,h){if(c.length<4)return h.error(`Expected at least 3 arguments, but found ${c.length-1} instead.`);const v=[];for(let I=1;I<c.length-1;I+=2){const O=c[I];if(typeof O!="string")return h.error(`Expected string, but found ${typeof O} instead.`,I);if(/[^a-zA-Z0-9_]/.test(O))return h.error("Variable names must contain only alphanumeric characters or '_'.",I);const z=h.parse(c[I+1],I+1);if(!z)return null;v.push([O,z])}const w=h.parse(c[c.length-1],c.length-1,h.expectedType,v);return w?new hl(v,w):null}outputDefined(){return this.result.outputDefined()}}class fl{constructor(c,h){this.type=h.type,this.name=c,this.boundExpression=h}static parse(c,h){if(c.length!==2||typeof c[1]!="string")return h.error("'var' expression requires exactly one string literal argument.");const v=c[1];return h.scope.has(v)?new fl(v,h.scope.get(v)):h.error(`Unknown variable "${v}". Make sure "${v}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(c){return this.boundExpression.evaluate(c)}eachChild(){}outputDefined(){return!1}}class Yl{constructor(c,h,v){this.type=c,this.index=h,this.input=v}static parse(c,h){if(c.length!==3)return h.error(`Expected 2 arguments, but found ${c.length-1} instead.`);const v=h.parse(c[1],1,_r),w=h.parse(c[2],2,xo(h.expectedType||yn));return v&&w?new Yl(w.type.itemType,v,w):null}evaluate(c){const h=this.index.evaluate(c),v=this.input.evaluate(c);if(h<0)throw new ri(`Array index out of bounds: ${h} < 0.`);if(h>=v.length)throw new ri(`Array index out of bounds: ${h} > ${v.length-1}.`);if(h!==Math.floor(h))throw new ri(`Array index must be an integer, but found ${h} instead.`);return v[h]}eachChild(c){c(this.index),c(this.input)}outputDefined(){return!1}}class _c{constructor(c,h){this.type=an,this.needle=c,this.haystack=h}static parse(c,h){if(c.length!==3)return h.error(`Expected 2 arguments, but found ${c.length-1} instead.`);const v=h.parse(c[1],1,yn),w=h.parse(c[2],2,yn);return v&&w?$s(v.type,[an,Or,_r,Mn,yn])?new _c(v,w):h.error(`Expected first argument to be of type boolean, string, number or null, but found ${Qn(v.type)} instead`):null}evaluate(c){const h=this.needle.evaluate(c),v=this.haystack.evaluate(c);if(!v)return!1;if(!wo(h,["boolean","string","number","null"]))throw new ri(`Expected first argument to be of type boolean, string, number or null, but found ${Qn(bn(h))} instead.`);if(!wo(v,["string","array"]))throw new ri(`Expected second argument to be of type array or string, but found ${Qn(bn(v))} instead.`);return v.indexOf(h)>=0}eachChild(c){c(this.needle),c(this.haystack)}outputDefined(){return!0}}class Ms{constructor(c,h,v){this.type=_r,this.needle=c,this.haystack=h,this.fromIndex=v}static parse(c,h){if(c.length<=2||c.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${c.length-1} instead.`);const v=h.parse(c[1],1,yn),w=h.parse(c[2],2,yn);if(!v||!w)return null;if(!$s(v.type,[an,Or,_r,Mn,yn]))return h.error(`Expected first argument to be of type boolean, string, number or null, but found ${Qn(v.type)} instead`);if(c.length===4){const I=h.parse(c[3],3,_r);return I?new Ms(v,w,I):null}return new Ms(v,w)}evaluate(c){const h=this.needle.evaluate(c),v=this.haystack.evaluate(c);if(!wo(h,["boolean","string","number","null"]))throw new ri(`Expected first argument to be of type boolean, string, number or null, but found ${Qn(bn(h))} instead.`);let w;if(this.fromIndex&&(w=this.fromIndex.evaluate(c)),wo(v,["string"])){const I=v.indexOf(h,w);return I===-1?-1:[...v.slice(0,I)].length}if(wo(v,["array"]))return v.indexOf(h,w);throw new ri(`Expected second argument to be of type array or string, but found ${Qn(bn(v))} instead.`)}eachChild(c){c(this.needle),c(this.haystack),this.fromIndex&&c(this.fromIndex)}outputDefined(){return!1}}class vo{constructor(c,h,v,w,I,O){this.inputType=c,this.type=h,this.input=v,this.cases=w,this.outputs=I,this.otherwise=O}static parse(c,h){if(c.length<5)return h.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if(c.length%2!=1)return h.error("Expected an even number of arguments.");let v,w;h.expectedType&&h.expectedType.kind!=="value"&&(w=h.expectedType);const I={},O=[];for(let J=2;J<c.length-1;J+=2){let ne=c[J];const me=c[J+1];Array.isArray(ne)||(ne=[ne]);const Ee=h.concat(J);if(ne.length===0)return Ee.error("Expected at least one branch label.");for(const Fe of ne){if(typeof Fe!="number"&&typeof Fe!="string")return Ee.error("Branch labels must be numbers or strings.");if(typeof Fe=="number"&&Math.abs(Fe)>Number.MAX_SAFE_INTEGER)return Ee.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Fe=="number"&&Math.floor(Fe)!==Fe)return Ee.error("Numeric branch labels must be integer values.");if(v){if(Ee.checkSubtype(v,bn(Fe)))return null}else v=bn(Fe);if(I[String(Fe)]!==void 0)return Ee.error("Branch labels must be unique.");I[String(Fe)]=O.length}const je=h.parse(me,J,w);if(!je)return null;w=w||je.type,O.push(je)}const z=h.parse(c[1],1,yn);if(!z)return null;const V=h.parse(c[c.length-1],c.length-1,w);return V?z.type.kind!=="value"&&h.concat(1).checkSubtype(v,z.type)?null:new vo(v,w,z,I,O,V):null}evaluate(c){const h=this.input.evaluate(c);return(bn(h)===this.inputType&&this.outputs[this.cases[h]]||this.otherwise).evaluate(c)}eachChild(c){c(this.input),this.outputs.forEach(c),c(this.otherwise)}outputDefined(){return this.outputs.every(c=>c.outputDefined())&&this.otherwise.outputDefined()}}class Ss{constructor(c,h,v){this.type=c,this.branches=h,this.otherwise=v}static parse(c,h){if(c.length<4)return h.error(`Expected at least 3 arguments, but found only ${c.length-1}.`);if(c.length%2!=0)return h.error("Expected an odd number of arguments.");let v;h.expectedType&&h.expectedType.kind!=="value"&&(v=h.expectedType);const w=[];for(let O=1;O<c.length-1;O+=2){const z=h.parse(c[O],O,an);if(!z)return null;const V=h.parse(c[O+1],O+1,v);if(!V)return null;w.push([z,V]),v=v||V.type}const I=h.parse(c[c.length-1],c.length-1,v);if(!I)return null;if(!v)throw new Error("Can't infer output type");return new Ss(v,w,I)}evaluate(c){for(const[h,v]of this.branches)if(h.evaluate(c))return v.evaluate(c);return this.otherwise.evaluate(c)}eachChild(c){for(const[h,v]of this.branches)c(h),c(v);c(this.otherwise)}outputDefined(){return this.branches.every(([c,h])=>h.outputDefined())&&this.otherwise.outputDefined()}}class re{constructor(c,h,v,w){this.type=c,this.input=h,this.beginIndex=v,this.endIndex=w}static parse(c,h){if(c.length<=2||c.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${c.length-1} instead.`);const v=h.parse(c[1],1,yn),w=h.parse(c[2],2,_r);if(!v||!w)return null;if(!$s(v.type,[xo(yn),Or,yn]))return h.error(`Expected first argument to be of type array or string, but found ${Qn(v.type)} instead`);if(c.length===4){const I=h.parse(c[3],3,_r);return I?new re(v.type,v,w,I):null}return new re(v.type,v,w)}evaluate(c){const h=this.input.evaluate(c),v=this.beginIndex.evaluate(c);let w;if(this.endIndex&&(w=this.endIndex.evaluate(c)),wo(h,["string"]))return[...h].slice(v,w).join("");if(wo(h,["array"]))return h.slice(v,w);throw new ri(`Expected first argument to be of type array or string, but found ${Qn(bn(h))} instead.`)}eachChild(c){c(this.input),c(this.beginIndex),this.endIndex&&c(this.endIndex)}outputDefined(){return!1}}function ze(f,c){const h=f.length-1;let v,w,I=0,O=h,z=0;for(;I<=O;)if(z=Math.floor((I+O)/2),v=f[z],w=f[z+1],v<=c){if(z===h||c<w)return z;I=z+1}else{if(!(v>c))throw new ri("Input is not a number.");O=z-1}return 0}class pt{constructor(c,h,v){this.type=c,this.input=h,this.labels=[],this.outputs=[];for(const[w,I]of v)this.labels.push(w),this.outputs.push(I)}static parse(c,h){if(c.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if((c.length-1)%2!=0)return h.error("Expected an even number of arguments.");const v=h.parse(c[1],1,_r);if(!v)return null;const w=[];let I=null;h.expectedType&&h.expectedType.kind!=="value"&&(I=h.expectedType);for(let O=1;O<c.length;O+=2){const z=O===1?-1/0:c[O],V=c[O+1],J=O,ne=O+1;if(typeof z!="number")return h.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',J);if(w.length&&w[w.length-1][0]>=z)return h.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',J);const me=h.parse(V,ne,I);if(!me)return null;I=I||me.type,w.push([z,me])}return new pt(I,v,w)}evaluate(c){const h=this.labels,v=this.outputs;if(h.length===1)return v[0].evaluate(c);const w=this.input.evaluate(c);if(w<=h[0])return v[0].evaluate(c);const I=h.length;return w>=h[I-1]?v[I-1].evaluate(c):v[ze(h,w)].evaluate(c)}eachChild(c){c(this.input);for(const h of this.outputs)c(h)}outputDefined(){return this.outputs.every(c=>c.outputDefined())}}function Ut(f){return f&&f.__esModule&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f}var Qt,Er,jr=function(){if(Er)return Qt;function f(c,h,v,w){this.cx=3*c,this.bx=3*(v-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*h,this.by=3*(w-h)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=h,this.p2x=v,this.p2y=w}return Er=1,Qt=f,f.prototype={sampleCurveX:function(c){return((this.ax*c+this.bx)*c+this.cx)*c},sampleCurveY:function(c){return((this.ay*c+this.by)*c+this.cy)*c},sampleCurveDerivativeX:function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},solveCurveX:function(c,h){if(h===void 0&&(h=1e-6),c<0)return 0;if(c>1)return 1;for(var v=c,w=0;w<8;w++){var I=this.sampleCurveX(v)-c;if(Math.abs(I)<h)return v;var O=this.sampleCurveDerivativeX(v);if(Math.abs(O)<1e-6)break;v-=I/O}var z=0,V=1;for(v=c,w=0;w<20&&(I=this.sampleCurveX(v),!(Math.abs(I-c)<h));w++)c>I?z=v:V=v,v=.5*(V-z)+z;return v},solve:function(c,h){return this.sampleCurveY(this.solveCurveX(c,h))}},Qt}(),Sn=Ut(jr);class vn{constructor(c,h,v,w,I){this.type=c,this.operator=h,this.interpolation=v,this.input=w,this.labels=[],this.outputs=[];for(const[O,z]of I)this.labels.push(O),this.outputs.push(z)}static interpolationFactor(c,h,v,w){let I=0;if(c.name==="exponential")I=Zn(h,c.base,v,w);else if(c.name==="linear")I=Zn(h,1,v,w);else if(c.name==="cubic-bezier"){const O=c.controlPoints;I=new Sn(O[0],O[1],O[2],O[3]).solve(Zn(h,1,v,w))}return I}static parse(c,h){let[v,w,I,...O]=c;if(!Array.isArray(w)||w.length===0)return h.error("Expected an interpolation type expression.",1);if(w[0]==="linear")w={name:"linear"};else if(w[0]==="exponential"){const J=w[1];if(typeof J!="number")return h.error("Exponential interpolation requires a numeric base.",1,1);w={name:"exponential",base:J}}else{if(w[0]!=="cubic-bezier")return h.error(`Unknown interpolation type ${String(w[0])}`,1,0);{const J=w.slice(1);if(J.length!==4||J.some(ne=>typeof ne!="number"||ne<0||ne>1))return h.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);w={name:"cubic-bezier",controlPoints:J}}}if(c.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if((c.length-1)%2!=0)return h.error("Expected an even number of arguments.");if(I=h.parse(I,2,_r),!I)return null;const z=[];let V=null;v!=="interpolate-hcl"&&v!=="interpolate-lab"||h.expectedType==ta?h.expectedType&&h.expectedType.kind!=="value"&&(V=h.expectedType):V=Vn;for(let J=0;J<O.length;J+=2){const ne=O[J],me=O[J+1],Ee=J+3,je=J+4;if(typeof ne!="number")return h.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Ee);if(z.length&&z[z.length-1][0]>=ne)return h.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Ee);const Fe=h.parse(me,je,V);if(!Fe)return null;V=V||Fe.type,z.push([ne,Fe])}return Eo(V,_r)||Eo(V,_o)||Eo(V,Vn)||Eo(V,pa)||Eo(V,ra)||Eo(V,ta)||Eo(V,Xs)||Eo(V,xo(_r))?new vn(V,v,w,I,z):h.error(`Type ${Qn(V)} is not interpolatable.`)}evaluate(c){const h=this.labels,v=this.outputs;if(h.length===1)return v[0].evaluate(c);const w=this.input.evaluate(c);if(w<=h[0])return v[0].evaluate(c);const I=h.length;if(w>=h[I-1])return v[I-1].evaluate(c);const O=ze(h,w),z=vn.interpolationFactor(this.interpolation,w,h[O],h[O+1]),V=v[O].evaluate(c),J=v[O+1].evaluate(c);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return en(V,J,z);case"color":return Dr.interpolate(V,J,z);case"padding":return rn.interpolate(V,J,z);case"colorArray":return Oi.interpolate(V,J,z);case"numberArray":return Xi.interpolate(V,J,z);case"variableAnchorOffsetCollection":return Ri.interpolate(V,J,z);case"array":return Qr(V,J,z);case"projectionDefinition":return Mi.interpolate(V,J,z)}case"interpolate-hcl":switch(this.type.kind){case"color":return Dr.interpolate(V,J,z,"hcl");case"colorArray":return Oi.interpolate(V,J,z,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Dr.interpolate(V,J,z,"lab");case"colorArray":return Oi.interpolate(V,J,z,"lab")}}}eachChild(c){c(this.input);for(const h of this.outputs)c(h)}outputDefined(){return this.outputs.every(c=>c.outputDefined())}}function Zn(f,c,h,v){const w=v-h,I=f-h;return w===0?0:c===1?I/w:(Math.pow(c,I)-1)/(Math.pow(c,w)-1)}const Xn={color:Dr.interpolate,number:en,padding:rn.interpolate,numberArray:Xi.interpolate,colorArray:Oi.interpolate,variableAnchorOffsetCollection:Ri.interpolate,array:Qr};class Ui{constructor(c,h){this.type=c,this.args=h}static parse(c,h){if(c.length<2)return h.error("Expected at least one argument.");let v=null;const w=h.expectedType;w&&w.kind!=="value"&&(v=w);const I=[];for(const z of c.slice(1)){const V=h.parse(z,1+I.length,v,void 0,{typeAnnotation:"omit"});if(!V)return null;v=v||V.type,I.push(V)}if(!v)throw new Error("No output type");const O=w&&I.some(z=>la(w,z.type));return new Ui(O?yn:v,I)}evaluate(c){let h,v=null,w=0;for(const I of this.args)if(w++,v=I.evaluate(c),v&&v instanceof lo&&!v.available&&(h||(h=v.name),v=null,w===this.args.length&&(v=h)),v!==null)break;return v}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every(c=>c.outputDefined())}}function Ao(f,c){return f==="=="||f==="!="?c.kind==="boolean"||c.kind==="string"||c.kind==="number"||c.kind==="null"||c.kind==="value":c.kind==="string"||c.kind==="number"||c.kind==="value"}function Ko(f,c,h,v){return v.compare(c,h)===0}function pi(f,c,h){const v=f!=="=="&&f!=="!=";return class wue{constructor(I,O,z){this.type=an,this.lhs=I,this.rhs=O,this.collator=z,this.hasUntypedArgument=I.type.kind==="value"||O.type.kind==="value"}static parse(I,O){if(I.length!==3&&I.length!==4)return O.error("Expected two or three arguments.");const z=I[0];let V=O.parse(I[1],1,yn);if(!V)return null;if(!Ao(z,V.type))return O.concat(1).error(`"${z}" comparisons are not supported for type '${Qn(V.type)}'.`);let J=O.parse(I[2],2,yn);if(!J)return null;if(!Ao(z,J.type))return O.concat(2).error(`"${z}" comparisons are not supported for type '${Qn(J.type)}'.`);if(V.type.kind!==J.type.kind&&V.type.kind!=="value"&&J.type.kind!=="value")return O.error(`Cannot compare types '${Qn(V.type)}' and '${Qn(J.type)}'.`);v&&(V.type.kind==="value"&&J.type.kind!=="value"?V=new Yi(J.type,[V]):V.type.kind!=="value"&&J.type.kind==="value"&&(J=new Yi(V.type,[J])));let ne=null;if(I.length===4){if(V.type.kind!=="string"&&J.type.kind!=="string"&&V.type.kind!=="value"&&J.type.kind!=="value")return O.error("Cannot use collator to compare non-string types.");if(ne=O.parse(I[3],3,Vo),!ne)return null}return new wue(V,J,ne)}evaluate(I){const O=this.lhs.evaluate(I),z=this.rhs.evaluate(I);if(v&&this.hasUntypedArgument){const V=bn(O),J=bn(z);if(V.kind!==J.kind||V.kind!=="string"&&V.kind!=="number")throw new ri(`Expected arguments for "${f}" to be (string, string) or (number, number), but found (${V.kind}, ${J.kind}) instead.`)}if(this.collator&&!v&&this.hasUntypedArgument){const V=bn(O),J=bn(z);if(V.kind!=="string"||J.kind!=="string")return c(I,O,z)}return this.collator?h(I,O,z,this.collator.evaluate(I)):c(I,O,z)}eachChild(I){I(this.lhs),I(this.rhs),this.collator&&I(this.collator)}outputDefined(){return!0}}}const ca=pi("==",function(f,c,h){return c===h},Ko),jo=pi("!=",function(f,c,h){return c!==h},function(f,c,h,v){return!Ko(0,c,h,v)}),Oa=pi("<",function(f,c,h){return c<h},function(f,c,h,v){return v.compare(c,h)<0}),pl=pi(">",function(f,c,h){return c>h},function(f,c,h,v){return v.compare(c,h)>0}),yc=pi("<=",function(f,c,h){return c<=h},function(f,c,h,v){return v.compare(c,h)<=0}),Wh=pi(">=",function(f,c,h){return c>=h},function(f,c,h,v){return v.compare(c,h)>=0});class su{constructor(c,h,v){this.type=Vo,this.locale=v,this.caseSensitive=c,this.diacriticSensitive=h}static parse(c,h){if(c.length!==2)return h.error("Expected one argument.");const v=c[1];if(typeof v!="object"||Array.isArray(v))return h.error("Collator options argument must be an object.");const w=h.parse(v["case-sensitive"]!==void 0&&v["case-sensitive"],1,an);if(!w)return null;const I=h.parse(v["diacritic-sensitive"]!==void 0&&v["diacritic-sensitive"],1,an);if(!I)return null;let O=null;return v.locale&&(O=h.parse(v.locale,1,Or),!O)?null:new su(w,I,O)}evaluate(c){return new Ln(this.caseSensitive.evaluate(c),this.diacriticSensitive.evaluate(c),this.locale?this.locale.evaluate(c):null)}eachChild(c){c(this.caseSensitive),c(this.diacriticSensitive),this.locale&&c(this.locale)}outputDefined(){return!1}}class ml{constructor(c,h,v,w,I){this.type=Or,this.number=c,this.locale=h,this.currency=v,this.minFractionDigits=w,this.maxFractionDigits=I}static parse(c,h){if(c.length!==3)return h.error("Expected two arguments.");const v=h.parse(c[1],1,_r);if(!v)return null;const w=c[2];if(typeof w!="object"||Array.isArray(w))return h.error("NumberFormat options argument must be an object.");let I=null;if(w.locale&&(I=h.parse(w.locale,1,Or),!I))return null;let O=null;if(w.currency&&(O=h.parse(w.currency,1,Or),!O))return null;let z=null;if(w["min-fraction-digits"]&&(z=h.parse(w["min-fraction-digits"],1,_r),!z))return null;let V=null;return w["max-fraction-digits"]&&(V=h.parse(w["max-fraction-digits"],1,_r),!V)?null:new ml(v,I,O,z,V)}evaluate(c){return new Intl.NumberFormat(this.locale?this.locale.evaluate(c):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(c):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(c):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(c):void 0}).format(this.number.evaluate(c))}eachChild(c){c(this.number),this.locale&&c(this.locale),this.currency&&c(this.currency),this.minFractionDigits&&c(this.minFractionDigits),this.maxFractionDigits&&c(this.maxFractionDigits)}outputDefined(){return!1}}class Pa{constructor(c){this.type=Po,this.sections=c}static parse(c,h){if(c.length<2)return h.error("Expected at least one argument.");const v=c[1];if(!Array.isArray(v)&&typeof v=="object")return h.error("First argument must be an image or text section.");const w=[];let I=!1;for(let O=1;O<=c.length-1;++O){const z=c[O];if(I&&typeof z=="object"&&!Array.isArray(z)){I=!1;let V=null;if(z["font-scale"]&&(V=h.parse(z["font-scale"],1,_r),!V))return null;let J=null;if(z["text-font"]&&(J=h.parse(z["text-font"],1,xo(Or)),!J))return null;let ne=null;if(z["text-color"]&&(ne=h.parse(z["text-color"],1,Vn),!ne))return null;let me=null;if(z["vertical-align"]){if(typeof z["vertical-align"]=="string"&&!Ii.includes(z["vertical-align"]))return h.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${z["vertical-align"]}' instead.`);if(me=h.parse(z["vertical-align"],1,Or),!me)return null}const Ee=w[w.length-1];Ee.scale=V,Ee.font=J,Ee.textColor=ne,Ee.verticalAlign=me}else{const V=h.parse(c[O],1,yn);if(!V)return null;const J=V.type.kind;if(J!=="string"&&J!=="value"&&J!=="null"&&J!=="resolvedImage")return h.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");I=!0,w.push({content:V,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Pa(w)}evaluate(c){return new Ai(this.sections.map(h=>{const v=h.content.evaluate(c);return bn(v)===so?new vi("",v,null,null,null,h.verticalAlign?h.verticalAlign.evaluate(c):null):new vi(Nn(v),null,h.scale?h.scale.evaluate(c):null,h.font?h.font.evaluate(c).join(","):null,h.textColor?h.textColor.evaluate(c):null,h.verticalAlign?h.verticalAlign.evaluate(c):null)}))}eachChild(c){for(const h of this.sections)c(h.content),h.scale&&c(h.scale),h.font&&c(h.font),h.textColor&&c(h.textColor),h.verticalAlign&&c(h.verticalAlign)}outputDefined(){return!1}}class vc{constructor(c){this.type=so,this.input=c}static parse(c,h){if(c.length!==2)return h.error("Expected two arguments.");const v=h.parse(c[1],1,Or);return v?new vc(v):h.error("No image name provided.")}evaluate(c){const h=this.input.evaluate(c),v=lo.fromString(h);return v&&c.availableImages&&(v.available=c.availableImages.indexOf(h)>-1),v}eachChild(c){c(this.input)}outputDefined(){return!1}}class bc{constructor(c){this.type=_r,this.input=c}static parse(c,h){if(c.length!==2)return h.error(`Expected 1 argument, but found ${c.length-1} instead.`);const v=h.parse(c[1],1);return v?v.type.kind!=="array"&&v.type.kind!=="string"&&v.type.kind!=="value"?h.error(`Expected argument of type string or array, but found ${Qn(v.type)} instead.`):new bc(v):null}evaluate(c){const h=this.input.evaluate(c);if(typeof h=="string")return[...h].length;if(Array.isArray(h))return h.length;throw new ri(`Expected value to be of type string or array, but found ${Qn(bn(h))} instead.`)}eachChild(c){c(this.input)}outputDefined(){return!1}}const La=8192;function Da(f,c){const h=(180+f[0])/360,v=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+f[1]*Math.PI/360)))/360,w=Math.pow(2,c.z);return[Math.round(h*w*La),Math.round(v*w*La)]}function gl(f,c){const h=Math.pow(2,c.z);return[(w=(f[0]/La+c.x)/h,360*w-180),(v=(f[1]/La+c.y)/h,360/Math.PI*Math.atan(Math.exp((180-360*v)*Math.PI/180))-90)];var v,w}function Ys(f,c){f[0]=Math.min(f[0],c[0]),f[1]=Math.min(f[1],c[1]),f[2]=Math.max(f[2],c[0]),f[3]=Math.max(f[3],c[1])}function Ql(f,c){return!(f[0]<=c[0]||f[2]>=c[2]||f[1]<=c[1]||f[3]>=c[3])}function Yu(f,c,h){const v=f[0]-c[0],w=f[1]-c[1],I=f[0]-h[0],O=f[1]-h[1];return v*O-I*w==0&&v*I<=0&&w*O<=0}function $a(f,c,h,v){return(w=[v[0]-h[0],v[1]-h[1]])[0]*(I=[c[0]-f[0],c[1]-f[1]])[1]-w[1]*I[0]!=0&&!(!xc(f,c,h,v)||!xc(h,v,f,c));var w,I}function Vc(f,c,h){for(const v of h)for(let w=0;w<v.length-1;++w)if($a(f,c,v[w],v[w+1]))return!0;return!1}function as(f,c,h=!1){let v=!1;for(const z of c)for(let V=0;V<z.length-1;V++){if(Yu(f,z[V],z[V+1]))return h;(I=z[V])[1]>(w=f)[1]!=(O=z[V+1])[1]>w[1]&&w[0]<(O[0]-I[0])*(w[1]-I[1])/(O[1]-I[1])+I[0]&&(v=!v)}var w,I,O;return v}function Wc(f,c){for(const h of c)if(as(f,h))return!0;return!1}function ua(f,c){for(const h of f)if(!as(h,c))return!1;for(let h=0;h<f.length-1;++h)if(Vc(f[h],f[h+1],c))return!1;return!0}function _l(f,c){for(const h of c)if(ua(f,h))return!0;return!1}function xc(f,c,h,v){const w=v[0]-h[0],I=v[1]-h[1],O=(f[0]-h[0])*I-w*(f[1]-h[1]),z=(c[0]-h[0])*I-w*(c[1]-h[1]);return O>0&&z<0||O<0&&z>0}function Ns(f,c,h){const v=[];for(let w=0;w<f.length;w++){const I=[];for(let O=0;O<f[w].length;O++){const z=Da(f[w][O],h);Ys(c,z),I.push(z)}v.push(I)}return v}function Jl(f,c,h){const v=[];for(let w=0;w<f.length;w++){const I=Ns(f[w],c,h);v.push(I)}return v}function wc(f,c,h,v){if(f[0]<h[0]||f[0]>h[2]){const w=.5*v;let I=f[0]-h[0]>w?-v:h[0]-f[0]>w?v:0;I===0&&(I=f[0]-h[2]>w?-v:h[2]-f[0]>w?v:0),f[0]+=I}Ys(c,f)}function ss(f,c,h,v){const w=Math.pow(2,v.z)*La,I=[v.x*La,v.y*La],O=[];for(const z of f)for(const V of z){const J=[V.x+I[0],V.y+I[1]];wc(J,c,h,w),O.push(J)}return O}function Ts(f,c,h,v){const w=Math.pow(2,v.z)*La,I=[v.x*La,v.y*La],O=[];for(const V of f){const J=[];for(const ne of V){const me=[ne.x+I[0],ne.y+I[1]];Ys(c,me),J.push(me)}O.push(J)}if(c[2]-c[0]<=w/2){(z=c)[0]=z[1]=1/0,z[2]=z[3]=-1/0;for(const V of O)for(const J of V)wc(J,c,h,w)}var z;return O}class js{constructor(c,h){this.type=an,this.geojson=c,this.geometries=h}static parse(c,h){if(c.length!==2)return h.error(`'within' expression requires exactly one argument, but found ${c.length-1} instead.`);if(Ho(c[1])){const v=c[1];if(v.type==="FeatureCollection"){const w=[];for(const I of v.features){const{type:O,coordinates:z}=I.geometry;O==="Polygon"&&w.push(z),O==="MultiPolygon"&&w.push(...z)}if(w.length)return new js(v,{type:"MultiPolygon",coordinates:w})}else if(v.type==="Feature"){const w=v.geometry.type;if(w==="Polygon"||w==="MultiPolygon")return new js(v,v.geometry)}else if(v.type==="Polygon"||v.type==="MultiPolygon")return new js(v,v)}return h.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(c){if(c.geometry()!=null&&c.canonicalID()!=null){if(c.geometryType()==="Point")return function(h,v){const w=[1/0,1/0,-1/0,-1/0],I=[1/0,1/0,-1/0,-1/0],O=h.canonicalID();if(v.type==="Polygon"){const z=Ns(v.coordinates,I,O),V=ss(h.geometry(),w,I,O);if(!Ql(w,I))return!1;for(const J of V)if(!as(J,z))return!1}if(v.type==="MultiPolygon"){const z=Jl(v.coordinates,I,O),V=ss(h.geometry(),w,I,O);if(!Ql(w,I))return!1;for(const J of V)if(!Wc(J,z))return!1}return!0}(c,this.geometries);if(c.geometryType()==="LineString")return function(h,v){const w=[1/0,1/0,-1/0,-1/0],I=[1/0,1/0,-1/0,-1/0],O=h.canonicalID();if(v.type==="Polygon"){const z=Ns(v.coordinates,I,O),V=Ts(h.geometry(),w,I,O);if(!Ql(w,I))return!1;for(const J of V)if(!ua(J,z))return!1}if(v.type==="MultiPolygon"){const z=Jl(v.coordinates,I,O),V=Ts(h.geometry(),w,I,O);if(!Ql(w,I))return!1;for(const J of V)if(!_l(J,z))return!1}return!0}(c,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Rs=class{constructor(f=[],c=(h,v)=>h<v?-1:h>v?1:0){if(this.data=f,this.length=this.data.length,this.compare=c,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(f){this.data.push(f),this._up(this.length++)}pop(){if(this.length===0)return;const f=this.data[0],c=this.data.pop();return--this.length>0&&(this.data[0]=c,this._down(0)),f}peek(){return this.data[0]}_up(f){const{data:c,compare:h}=this,v=c[f];for(;f>0;){const w=f-1>>1,I=c[w];if(h(v,I)>=0)break;c[f]=I,f=w}c[f]=v}_down(f){const{data:c,compare:h}=this,v=this.length>>1,w=c[f];for(;f<v;){let I=1+(f<<1);const O=I+1;if(O<this.length&&h(c[O],c[I])<0&&(I=O),h(c[I],w)>=0)break;c[f]=c[I],f=I}c[f]=w}};function ec(f,c,h=0,v=f.length-1,w=Mc){for(;v>h;){if(v-h>600){const V=v-h+1,J=c-h+1,ne=Math.log(V),me=.5*Math.exp(2*ne/3),Ee=.5*Math.sqrt(ne*me*(V-me)/V)*(J-V/2<0?-1:1);ec(f,c,Math.max(h,Math.floor(c-J*me/V+Ee)),Math.min(v,Math.floor(c+(V-J)*me/V+Ee)),w)}const I=f[c];let O=h,z=v;for(tc(f,h,c),w(f[v],I)>0&&tc(f,h,v);O<z;){for(tc(f,O,z),O++,z--;w(f[O],I)<0;)O++;for(;w(f[z],I)>0;)z--}w(f[h],I)===0?tc(f,h,z):(z++,tc(f,z,v)),z<=c&&(h=z+1),c<=z&&(v=z-1)}}function tc(f,c,h){const v=f[c];f[c]=f[h],f[h]=v}function Mc(f,c){return f<c?-1:f>c?1:0}function Co(f,c){if(f.length<=1)return[f];const h=[];let v,w;for(const I of f){const O=yl(I);O!==0&&(I.area=Math.abs(O),w===void 0&&(w=O<0),w===O<0?(v&&h.push(v),v=[I]):v.push(I))}if(v&&h.push(v),c>1)for(let I=0;I<h.length;I++)h[I].length<=c||(ec(h[I],c,1,h[I].length-1,$n),h[I]=h[I].slice(0,c));return h}function $n(f,c){return c.area-f.area}function yl(f){let c=0;for(let h,v,w=0,I=f.length,O=I-1;w<I;O=w++)h=f[w],v=f[O],c+=(v.x-h.x)*(h.y+v.y);return c}const vl=1/298.257223563,Gc=vl*(2-vl),rc=Math.PI/180;class Na{constructor(c){const h=6378.137*rc*1e3,v=Math.cos(c*rc),w=1/(1-Gc*(1-v*v)),I=Math.sqrt(w);this.kx=h*I*v,this.ky=h*I*w*(1-Gc)}distance(c,h){const v=this.wrap(c[0]-h[0])*this.kx,w=(c[1]-h[1])*this.ky;return Math.sqrt(v*v+w*w)}pointOnLine(c,h){let v,w,I,O,z=1/0;for(let V=0;V<c.length-1;V++){let J=c[V][0],ne=c[V][1],me=this.wrap(c[V+1][0]-J)*this.kx,Ee=(c[V+1][1]-ne)*this.ky,je=0;me===0&&Ee===0||(je=(this.wrap(h[0]-J)*this.kx*me+(h[1]-ne)*this.ky*Ee)/(me*me+Ee*Ee),je>1?(J=c[V+1][0],ne=c[V+1][1]):je>0&&(J+=me/this.kx*je,ne+=Ee/this.ky*je)),me=this.wrap(h[0]-J)*this.kx,Ee=(h[1]-ne)*this.ky;const Fe=me*me+Ee*Ee;Fe<z&&(z=Fe,v=J,w=ne,I=V,O=je)}return{point:[v,w],index:I,t:Math.max(0,Math.min(1,O))}}wrap(c){for(;c<-180;)c+=360;for(;c>180;)c-=360;return c}}function nc(f,c){return c[0]-f[0]}function bl(f){return f[1]-f[0]+1}function qa(f,c){return f[1]>=f[0]&&f[1]<c}function bi(f,c){if(f[0]>f[1])return[null,null];const h=bl(f);if(c){if(h===2)return[f,null];const w=Math.floor(h/2);return[[f[0],f[0]+w],[f[0]+w,f[1]]]}if(h===1)return[f,null];const v=Math.floor(h/2)-1;return[[f[0],f[0]+v],[f[0]+v+1,f[1]]]}function qc(f,c){if(!qa(c,f.length))return[1/0,1/0,-1/0,-1/0];const h=[1/0,1/0,-1/0,-1/0];for(let v=c[0];v<=c[1];++v)Ys(h,f[v]);return h}function ja(f){const c=[1/0,1/0,-1/0,-1/0];for(const h of f)for(const v of h)Ys(c,v);return c}function xl(f){return f[0]!==-1/0&&f[1]!==-1/0&&f[2]!==1/0&&f[3]!==1/0}function So(f,c,h){if(!xl(f)||!xl(c))return NaN;let v=0,w=0;return f[2]<c[0]&&(v=c[0]-f[2]),f[0]>c[2]&&(v=f[0]-c[2]),f[1]>c[3]&&(w=f[1]-c[3]),f[3]<c[1]&&(w=c[1]-f[3]),h.distance([0,0],[v,w])}function Ji(f,c,h){const v=h.pointOnLine(c,f);return h.distance(f,v.point)}function Fo(f,c,h,v,w){const I=Math.min(Ji(f,[h,v],w),Ji(c,[h,v],w)),O=Math.min(Ji(h,[f,c],w),Ji(v,[f,c],w));return Math.min(I,O)}function na(f,c,h,v,w){if(!qa(c,f.length)||!qa(v,h.length))return 1/0;let I=1/0;for(let O=c[0];O<c[1];++O){const z=f[O],V=f[O+1];for(let J=v[0];J<v[1];++J){const ne=h[J],me=h[J+1];if($a(z,V,ne,me))return 0;I=Math.min(I,Fo(z,V,ne,me,w))}}return I}function wl(f,c,h,v,w){if(!qa(c,f.length)||!qa(v,h.length))return NaN;let I=1/0;for(let O=c[0];O<=c[1];++O)for(let z=v[0];z<=v[1];++z)if(I=Math.min(I,w.distance(f[O],h[z])),I===0)return I;return I}function lu(f,c,h){if(as(f,c,!0))return 0;let v=1/0;for(const w of c){const I=w[0],O=w[w.length-1];if(I!==O&&(v=Math.min(v,Ji(f,[O,I],h)),v===0))return v;const z=h.pointOnLine(w,f);if(v=Math.min(v,h.distance(f,z.point)),v===0)return v}return v}function $l(f,c,h,v){if(!qa(c,f.length))return NaN;for(let I=c[0];I<=c[1];++I)if(as(f[I],h,!0))return 0;let w=1/0;for(let I=c[0];I<c[1];++I){const O=f[I],z=f[I+1];for(const V of h)for(let J=0,ne=V.length,me=ne-1;J<ne;me=J++){const Ee=V[me],je=V[J];if($a(O,z,Ee,je))return 0;w=Math.min(w,Fo(O,z,Ee,je,v))}}return w}function Hc(f,c){for(const h of f)for(const v of h)if(as(v,c,!0))return!0;return!1}function oh(f,c,h,v=1/0){const w=ja(f),I=ja(c);if(v!==1/0&&So(w,I,h)>=v)return v;if(Ql(w,I)){if(Hc(f,c))return 0}else if(Hc(c,f))return 0;let O=1/0;for(const z of f)for(let V=0,J=z.length,ne=J-1;V<J;ne=V++){const me=z[ne],Ee=z[V];for(const je of c)for(let Fe=0,He=je.length,st=He-1;Fe<He;st=Fe++){const yt=je[st],Xt=je[Fe];if($a(me,Ee,yt,Xt))return 0;O=Math.min(O,Fo(me,Ee,yt,Xt,h))}}return O}function yd(f,c,h,v,w,I){if(!I)return;const O=So(qc(v,I),w,h);O<c&&f.push([O,I,[0,0]])}function cu(f,c,h,v,w,I,O){if(!I||!O)return;const z=So(qc(v,I),qc(w,O),h);z<c&&f.push([z,I,O])}function Y(f,c,h,v,w=1/0){let I=Math.min(v.distance(f[0],h[0][0]),w);if(I===0)return I;const O=new Rs([[0,[0,f.length-1],[0,0]]],nc),z=ja(h);for(;O.length>0;){const V=O.pop();if(V[0]>=I)continue;const J=V[1],ne=c?50:100;if(bl(J)<=ne){if(!qa(J,f.length))return NaN;if(c){const me=$l(f,J,h,v);if(isNaN(me)||me===0)return me;I=Math.min(I,me)}else for(let me=J[0];me<=J[1];++me){const Ee=lu(f[me],h,v);if(I=Math.min(I,Ee),I===0)return 0}}else{const me=bi(J,c);yd(O,I,v,f,z,me[0]),yd(O,I,v,f,z,me[1])}}return I}function he(f,c,h,v,w,I=1/0){let O=Math.min(I,w.distance(f[0],h[0]));if(O===0)return O;const z=new Rs([[0,[0,f.length-1],[0,h.length-1]]],nc);for(;z.length>0;){const V=z.pop();if(V[0]>=O)continue;const J=V[1],ne=V[2],me=c?50:100,Ee=v?50:100;if(bl(J)<=me&&bl(ne)<=Ee){if(!qa(J,f.length)&&qa(ne,h.length))return NaN;let je;if(c&&v)je=na(f,J,h,ne,w),O=Math.min(O,je);else if(c&&!v){const Fe=f.slice(J[0],J[1]+1);for(let He=ne[0];He<=ne[1];++He)if(je=Ji(h[He],Fe,w),O=Math.min(O,je),O===0)return O}else if(!c&&v){const Fe=h.slice(ne[0],ne[1]+1);for(let He=J[0];He<=J[1];++He)if(je=Ji(f[He],Fe,w),O=Math.min(O,je),O===0)return O}else je=wl(f,J,h,ne,w),O=Math.min(O,je)}else{const je=bi(J,c),Fe=bi(ne,v);cu(z,O,w,f,h,je[0],Fe[0]),cu(z,O,w,f,h,je[0],Fe[1]),cu(z,O,w,f,h,je[1],Fe[0]),cu(z,O,w,f,h,je[1],Fe[1])}}return O}function Oe(f){return f.type==="MultiPolygon"?f.coordinates.map(c=>({type:"Polygon",coordinates:c})):f.type==="MultiLineString"?f.coordinates.map(c=>({type:"LineString",coordinates:c})):f.type==="MultiPoint"?f.coordinates.map(c=>({type:"Point",coordinates:c})):[f]}class Ke{constructor(c,h){this.type=_r,this.geojson=c,this.geometries=h}static parse(c,h){if(c.length!==2)return h.error(`'distance' expression requires exactly one argument, but found ${c.length-1} instead.`);if(Ho(c[1])){const v=c[1];if(v.type==="FeatureCollection")return new Ke(v,v.features.map(w=>Oe(w.geometry)).flat());if(v.type==="Feature")return new Ke(v,Oe(v.geometry));if("type"in v&&"coordinates"in v)return new Ke(v,Oe(v))}return h.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(c){if(c.geometry()!=null&&c.canonicalID()!=null){if(c.geometryType()==="Point")return function(h,v){const w=h.geometry(),I=w.flat().map(V=>gl([V.x,V.y],h.canonical));if(w.length===0)return NaN;const O=new Na(I[0][1]);let z=1/0;for(const V of v){switch(V.type){case"Point":z=Math.min(z,he(I,!1,[V.coordinates],!1,O,z));break;case"LineString":z=Math.min(z,he(I,!1,V.coordinates,!0,O,z));break;case"Polygon":z=Math.min(z,Y(I,!1,V.coordinates,O,z))}if(z===0)return z}return z}(c,this.geometries);if(c.geometryType()==="LineString")return function(h,v){const w=h.geometry(),I=w.flat().map(V=>gl([V.x,V.y],h.canonical));if(w.length===0)return NaN;const O=new Na(I[0][1]);let z=1/0;for(const V of v){switch(V.type){case"Point":z=Math.min(z,he(I,!0,[V.coordinates],!1,O,z));break;case"LineString":z=Math.min(z,he(I,!0,V.coordinates,!0,O,z));break;case"Polygon":z=Math.min(z,Y(I,!0,V.coordinates,O,z))}if(z===0)return z}return z}(c,this.geometries);if(c.geometryType()==="Polygon")return function(h,v){const w=h.geometry();if(w.length===0||w[0].length===0)return NaN;const I=Co(w,0).map(V=>V.map(J=>J.map(ne=>gl([ne.x,ne.y],h.canonical)))),O=new Na(I[0][0][0][1]);let z=1/0;for(const V of v)for(const J of I){switch(V.type){case"Point":z=Math.min(z,Y([V.coordinates],!1,J,O,z));break;case"LineString":z=Math.min(z,Y(V.coordinates,!0,J,O,z));break;case"Polygon":z=Math.min(z,oh(J,V.coordinates,O,z))}if(z===0)return z}return z}(c,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class at{constructor(c){this.type=yn,this.key=c}static parse(c,h){if(c.length!==2)return h.error(`Expected 1 argument, but found ${c.length-1} instead.`);const v=c[1];return v==null?h.error("Global state property must be defined."):typeof v!="string"?h.error(`Global state property must be string, but found ${typeof c[1]} instead.`):new at(v)}evaluate(c){var h;const v=(h=c.globals)===null||h===void 0?void 0:h.globalState;return v&&Object.keys(v).length!==0?rt(v,this.key):null}eachChild(){}outputDefined(){return!1}}const Ht={"==":ca,"!=":jo,">":pl,"<":Oa,">=":Wh,"<=":yc,array:Yi,at:Yl,boolean:Yi,case:Ss,coalesce:Ui,collator:su,format:Pa,image:vc,in:_c,"index-of":Ms,interpolate:vn,"interpolate-hcl":vn,"interpolate-lab":vn,length:bc,let:hl,literal:Mo,match:vo,number:Yi,"number-format":ml,object:Yi,slice:re,step:pt,string:Yi,"to-boolean":co,"to-color":co,"to-number":co,"to-string":co,var:fl,within:js,distance:Ke,"global-state":at};class gr{constructor(c,h,v,w){this.name=c,this.type=h,this._evaluate=v,this.args=w}evaluate(c){return this._evaluate(c,this.args)}eachChild(c){this.args.forEach(c)}outputDefined(){return!1}static parse(c,h){const v=c[0],w=gr.definitions[v];if(!w)return h.error(`Unknown expression "${v}". If you wanted a literal array, use ["literal", [...]].`,0);const I=Array.isArray(w)?w[0]:w.type,O=Array.isArray(w)?[[w[1],w[2]]]:w.overloads,z=O.filter(([J])=>!Array.isArray(J)||J.length===c.length-1);let V=null;for(const[J,ne]of z){V=new ws(h.registry,Ci,h.path,null,h.scope);const me=[];let Ee=!1;for(let je=1;je<c.length;je++){const Fe=c[je],He=Array.isArray(J)?J[je-1]:J.type,st=V.parse(Fe,1+me.length,He);if(!st){Ee=!0;break}me.push(st)}if(!Ee)if(Array.isArray(J)&&J.length!==me.length)V.error(`Expected ${J.length} arguments, but found ${me.length} instead.`);else{for(let je=0;je<me.length;je++){const Fe=Array.isArray(J)?J[je]:J.type,He=me[je];V.concat(je+1).checkSubtype(Fe,He.type)}if(V.errors.length===0)return new gr(v,I,ne,me)}}if(z.length===1)h.errors.push(...V.errors);else{const J=(z.length?z:O).map(([me])=>{return Ee=me,Array.isArray(Ee)?`(${Ee.map(Qn).join(", ")})`:`(${Qn(Ee.type)}...)`;var Ee}).join(" | "),ne=[];for(let me=1;me<c.length;me++){const Ee=h.parse(c[me],1+ne.length);if(!Ee)return null;ne.push(Qn(Ee.type))}h.error(`Expected arguments of type ${J}, but found (${ne.join(", ")}) instead.`)}return null}static register(c,h){gr.definitions=h;for(const v in h)c[v]=gr}}function Wr(f,[c,h,v,w]){c=c.evaluate(f),h=h.evaluate(f),v=v.evaluate(f);const I=w?w.evaluate(f):1,O=di(c,h,v,I);if(O)throw new ri(O);return new Dr(c/255,h/255,v/255,I,!1)}function cn(f,c){return f in c}function wn(f,c){const h=c[f];return h===void 0?null:h}function Yn(f){return{type:f}}function Ci(f){if(f instanceof fl)return Ci(f.boundExpression);if(f instanceof gr&&f.name==="error"||f instanceof su||f instanceof js||f instanceof Ke||f instanceof at)return!1;const c=f instanceof co||f instanceof Yi;let h=!0;return f.eachChild(v=>{h=c?h&&Ci(v):h&&v instanceof Mo}),!!h&&ro(f)&&Nl(f,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function ro(f){if(f instanceof gr&&(f.name==="get"&&f.args.length===1||f.name==="feature-state"||f.name==="has"&&f.args.length===1||f.name==="properties"||f.name==="geometry-type"||f.name==="id"||/^filter-/.test(f.name))||f instanceof js||f instanceof Ke)return!1;let c=!0;return f.eachChild(h=>{c&&!ro(h)&&(c=!1)}),c}function da(f){if(f instanceof gr&&f.name==="feature-state")return!1;let c=!0;return f.eachChild(h=>{c&&!da(h)&&(c=!1)}),c}function Nl(f,c){if(f instanceof gr&&c.indexOf(f.name)>=0)return!1;let h=!0;return f.eachChild(v=>{h&&!Nl(v,c)&&(h=!1)}),h}function ah(f){return{result:"success",value:f}}function Qu(f){return{result:"error",value:f}}function Kc(f){return f["property-type"]==="data-driven"||f["property-type"]==="cross-faded-data-driven"}function Gh(f){return!!f.expression&&f.expression.parameters.indexOf("zoom")>-1}function vd(f){return!!f.expression&&f.expression.interpolated}function Jn(f){return f instanceof Number?"number":f instanceof String?"string":f instanceof Boolean?"boolean":Array.isArray(f)?"array":f===null?"null":typeof f}function Fs(f){return typeof f=="object"&&f!==null&&!Array.isArray(f)&&bn(f)===Uo}function qh(f){return f}function bd(f,c){const h=f.stops&&typeof f.stops[0][0]=="object",v=h||!(h||f.property!==void 0),w=f.type||(vd(c)?"exponential":"interval"),I=function(ne){switch(ne.type){case"color":return Dr.parse;case"padding":return rn.parse;case"numberArray":return Xi.parse;case"colorArray":return Oi.parse;default:return null}}(c);if(I&&((f=pr({},f)).stops&&(f.stops=f.stops.map(ne=>[ne[0],I(ne[1])])),f.default=I(f.default?f.default:c.default)),f.colorSpace&&(O=f.colorSpace)!=="rgb"&&O!=="hcl"&&O!=="lab")throw new Error(`Unknown color space: "${f.colorSpace}"`);var O;const z=function(ne){switch(ne){case"exponential":return Hh;case"interval":return lh;case"categorical":return sh;case"identity":return tm;default:throw new Error(`Unknown function type "${ne}"`)}}(w);let V,J;if(w==="categorical"){V=Object.create(null);for(const ne of f.stops)V[ne[0]]=ne[1];J=typeof f.stops[0][0]}if(h){const ne={},me=[];for(let Fe=0;Fe<f.stops.length;Fe++){const He=f.stops[Fe],st=He[0].zoom;ne[st]===void 0&&(ne[st]={zoom:st,type:f.type,property:f.property,default:f.default,stops:[]},me.push(st)),ne[st].stops.push([He[0].value,He[1]])}const Ee=[];for(const Fe of me)Ee.push([ne[Fe].zoom,bd(ne[Fe],c)]);const je={name:"linear"};return{kind:"composite",interpolationType:je,interpolationFactor:vn.interpolationFactor.bind(void 0,je),zoomStops:Ee.map(Fe=>Fe[0]),evaluate:({zoom:Fe},He)=>Hh({stops:Ee,base:f.base},c,Fe).evaluate(Fe,He)}}if(v){const ne=w==="exponential"?{name:"exponential",base:f.base!==void 0?f.base:1}:null;return{kind:"camera",interpolationType:ne,interpolationFactor:vn.interpolationFactor.bind(void 0,ne),zoomStops:f.stops.map(me=>me[0]),evaluate:({zoom:me})=>z(f,c,me,V,J)}}return{kind:"source",evaluate(ne,me){const Ee=me&&me.properties?me.properties[f.property]:void 0;return Ee===void 0?uu(f.default,c.default):z(f,c,Ee,V,J)}}}function uu(f,c,h){return f!==void 0?f:c!==void 0?c:h!==void 0?h:void 0}function sh(f,c,h,v,w){return uu(typeof h===w?v[h]:void 0,f.default,c.default)}function lh(f,c,h){if(Jn(h)!=="number")return uu(f.default,c.default);const v=f.stops.length;if(v===1||h<=f.stops[0][0])return f.stops[0][1];if(h>=f.stops[v-1][0])return f.stops[v-1][1];const w=ze(f.stops.map(I=>I[0]),h);return f.stops[w][1]}function Hh(f,c,h){const v=f.base!==void 0?f.base:1;if(Jn(h)!=="number")return uu(f.default,c.default);const w=f.stops.length;if(w===1||h<=f.stops[0][0])return f.stops[0][1];if(h>=f.stops[w-1][0])return f.stops[w-1][1];const I=ze(f.stops.map(ne=>ne[0]),h),O=function(ne,me,Ee,je){const Fe=je-Ee,He=ne-Ee;return Fe===0?0:me===1?He/Fe:(Math.pow(me,He)-1)/(Math.pow(me,Fe)-1)}(h,v,f.stops[I][0],f.stops[I+1][0]),z=f.stops[I][1],V=f.stops[I+1][1],J=Xn[c.type]||qh;return typeof z.evaluate=="function"?{evaluate(...ne){const me=z.evaluate.apply(void 0,ne),Ee=V.evaluate.apply(void 0,ne);if(me!==void 0&&Ee!==void 0)return J(me,Ee,O,f.colorSpace)}}:J(z,V,O,f.colorSpace)}function tm(f,c,h){switch(c.type){case"color":h=Dr.parse(h);break;case"formatted":h=Ai.fromString(h.toString());break;case"resolvedImage":h=lo.fromString(h.toString());break;case"padding":h=rn.parse(h);break;case"colorArray":h=Oi.parse(h);break;case"numberArray":h=Xi.parse(h);break;default:Jn(h)===c.type||c.type==="enum"&&c.values[h]||(h=void 0)}return uu(h,f.default,c.default)}gr.register(Ht,{error:[{kind:"error"},[Or],(f,[c])=>{throw new ri(c.evaluate(f))}],typeof:[Or,[yn],(f,[c])=>Qn(bn(c.evaluate(f)))],"to-rgba":[xo(_r,4),[Vn],(f,[c])=>{const[h,v,w,I]=c.evaluate(f).rgb;return[255*h,255*v,255*w,I]}],rgb:[Vn,[_r,_r,_r],Wr],rgba:[Vn,[_r,_r,_r,_r],Wr],has:{type:an,overloads:[[[Or],(f,[c])=>cn(c.evaluate(f),f.properties())],[[Or,Uo],(f,[c,h])=>cn(c.evaluate(f),h.evaluate(f))]]},get:{type:yn,overloads:[[[Or],(f,[c])=>wn(c.evaluate(f),f.properties())],[[Or,Uo],(f,[c,h])=>wn(c.evaluate(f),h.evaluate(f))]]},"feature-state":[yn,[Or],(f,[c])=>wn(c.evaluate(f),f.featureState||{})],properties:[Uo,[],f=>f.properties()],"geometry-type":[Or,[],f=>f.geometryType()],id:[yn,[],f=>f.id()],zoom:[_r,[],f=>f.globals.zoom],"heatmap-density":[_r,[],f=>f.globals.heatmapDensity||0],elevation:[_r,[],f=>f.globals.elevation||0],"line-progress":[_r,[],f=>f.globals.lineProgress||0],accumulated:[yn,[],f=>f.globals.accumulated===void 0?null:f.globals.accumulated],"+":[_r,Yn(_r),(f,c)=>{let h=0;for(const v of c)h+=v.evaluate(f);return h}],"*":[_r,Yn(_r),(f,c)=>{let h=1;for(const v of c)h*=v.evaluate(f);return h}],"-":{type:_r,overloads:[[[_r,_r],(f,[c,h])=>c.evaluate(f)-h.evaluate(f)],[[_r],(f,[c])=>-c.evaluate(f)]]},"/":[_r,[_r,_r],(f,[c,h])=>c.evaluate(f)/h.evaluate(f)],"%":[_r,[_r,_r],(f,[c,h])=>c.evaluate(f)%h.evaluate(f)],ln2:[_r,[],()=>Math.LN2],pi:[_r,[],()=>Math.PI],e:[_r,[],()=>Math.E],"^":[_r,[_r,_r],(f,[c,h])=>Math.pow(c.evaluate(f),h.evaluate(f))],sqrt:[_r,[_r],(f,[c])=>Math.sqrt(c.evaluate(f))],log10:[_r,[_r],(f,[c])=>Math.log(c.evaluate(f))/Math.LN10],ln:[_r,[_r],(f,[c])=>Math.log(c.evaluate(f))],log2:[_r,[_r],(f,[c])=>Math.log(c.evaluate(f))/Math.LN2],sin:[_r,[_r],(f,[c])=>Math.sin(c.evaluate(f))],cos:[_r,[_r],(f,[c])=>Math.cos(c.evaluate(f))],tan:[_r,[_r],(f,[c])=>Math.tan(c.evaluate(f))],asin:[_r,[_r],(f,[c])=>Math.asin(c.evaluate(f))],acos:[_r,[_r],(f,[c])=>Math.acos(c.evaluate(f))],atan:[_r,[_r],(f,[c])=>Math.atan(c.evaluate(f))],min:[_r,Yn(_r),(f,c)=>Math.min(...c.map(h=>h.evaluate(f)))],max:[_r,Yn(_r),(f,c)=>Math.max(...c.map(h=>h.evaluate(f)))],abs:[_r,[_r],(f,[c])=>Math.abs(c.evaluate(f))],round:[_r,[_r],(f,[c])=>{const h=c.evaluate(f);return h<0?-Math.round(-h):Math.round(h)}],floor:[_r,[_r],(f,[c])=>Math.floor(c.evaluate(f))],ceil:[_r,[_r],(f,[c])=>Math.ceil(c.evaluate(f))],"filter-==":[an,[Or,yn],(f,[c,h])=>f.properties()[c.value]===h.value],"filter-id-==":[an,[yn],(f,[c])=>f.id()===c.value],"filter-type-==":[an,[Or],(f,[c])=>f.geometryType()===c.value],"filter-<":[an,[Or,yn],(f,[c,h])=>{const v=f.properties()[c.value],w=h.value;return typeof v==typeof w&&v<w}],"filter-id-<":[an,[yn],(f,[c])=>{const h=f.id(),v=c.value;return typeof h==typeof v&&h<v}],"filter->":[an,[Or,yn],(f,[c,h])=>{const v=f.properties()[c.value],w=h.value;return typeof v==typeof w&&v>w}],"filter-id->":[an,[yn],(f,[c])=>{const h=f.id(),v=c.value;return typeof h==typeof v&&h>v}],"filter-<=":[an,[Or,yn],(f,[c,h])=>{const v=f.properties()[c.value],w=h.value;return typeof v==typeof w&&v<=w}],"filter-id-<=":[an,[yn],(f,[c])=>{const h=f.id(),v=c.value;return typeof h==typeof v&&h<=v}],"filter->=":[an,[Or,yn],(f,[c,h])=>{const v=f.properties()[c.value],w=h.value;return typeof v==typeof w&&v>=w}],"filter-id->=":[an,[yn],(f,[c])=>{const h=f.id(),v=c.value;return typeof h==typeof v&&h>=v}],"filter-has":[an,[yn],(f,[c])=>c.value in f.properties()],"filter-has-id":[an,[],f=>f.id()!==null&&f.id()!==void 0],"filter-type-in":[an,[xo(Or)],(f,[c])=>c.value.indexOf(f.geometryType())>=0],"filter-id-in":[an,[xo(yn)],(f,[c])=>c.value.indexOf(f.id())>=0],"filter-in-small":[an,[Or,xo(yn)],(f,[c,h])=>h.value.indexOf(f.properties()[c.value])>=0],"filter-in-large":[an,[Or,xo(yn)],(f,[c,h])=>function(v,w,I,O){for(;I<=O;){const z=I+O>>1;if(w[z]===v)return!0;w[z]>v?O=z-1:I=z+1}return!1}(f.properties()[c.value],h.value,0,h.value.length-1)],all:{type:an,overloads:[[[an,an],(f,[c,h])=>c.evaluate(f)&&h.evaluate(f)],[Yn(an),(f,c)=>{for(const h of c)if(!h.evaluate(f))return!1;return!0}]]},any:{type:an,overloads:[[[an,an],(f,[c,h])=>c.evaluate(f)||h.evaluate(f)],[Yn(an),(f,c)=>{for(const h of c)if(h.evaluate(f))return!0;return!1}]]},"!":[an,[an],(f,[c])=>!c.evaluate(f)],"is-supported-script":[an,[Or],(f,[c])=>{const h=f.globals&&f.globals.isSupportedScript;return!h||h(c.evaluate(f))}],upcase:[Or,[Or],(f,[c])=>c.evaluate(f).toUpperCase()],downcase:[Or,[Or],(f,[c])=>c.evaluate(f).toLowerCase()],concat:[Or,Yn(yn),(f,c)=>c.map(h=>Nn(h.evaluate(f))).join("")],"resolved-locale":[Or,[Vo],(f,[c])=>c.evaluate(f).resolvedLocale()]});class xd{constructor(c,h){this.expression=c,this._warningHistory={},this._evaluator=new ga,this._defaultValue=h?function(v){if(v.type==="color"&&Fs(v.default))return new Dr(0,0,0,0);switch(v.type){case"color":return Dr.parse(v.default)||null;case"padding":return rn.parse(v.default)||null;case"numberArray":return Xi.parse(v.default)||null;case"colorArray":return Oi.parse(v.default)||null;case"variableAnchorOffsetCollection":return Ri.parse(v.default)||null;case"projectionDefinition":return Mi.parse(v.default)||null;default:return v.default===void 0?null:v.default}}(h):null,this._enumValues=h&&h.type==="enum"?h.values:null}evaluateWithoutErrorHandling(c,h,v,w,I,O){return this._evaluator.globals=c,this._evaluator.feature=h,this._evaluator.featureState=v,this._evaluator.canonical=w,this._evaluator.availableImages=I||null,this._evaluator.formattedSection=O,this.expression.evaluate(this._evaluator)}evaluate(c,h,v,w,I,O){this._evaluator.globals=c,this._evaluator.feature=h||null,this._evaluator.featureState=v||null,this._evaluator.canonical=w,this._evaluator.availableImages=I||null,this._evaluator.formattedSection=O||null;try{const z=this.expression.evaluate(this._evaluator);if(z==null||typeof z=="number"&&z!=z)return this._defaultValue;if(this._enumValues&&!(z in this._enumValues))throw new ri(`Expected value to be one of ${Object.keys(this._enumValues).map(V=>JSON.stringify(V)).join(", ")}, but found ${JSON.stringify(z)} instead.`);return z}catch(z){return this._warningHistory[z.message]||(this._warningHistory[z.message]=!0,typeof console<"u"&&console.warn(z.message)),this._defaultValue}}}function wd(f){return Array.isArray(f)&&f.length>0&&typeof f[0]=="string"&&f[0]in Ht}function Cu(f,c){const h=new ws(Ht,Ci,[],c?function(w){const I={color:Vn,string:Or,number:_r,enum:Or,boolean:an,formatted:Po,padding:pa,numberArray:ra,colorArray:ta,projectionDefinition:_o,resolvedImage:so,variableAnchorOffsetCollection:Xs};return w.type==="array"?xo(I[w.value]||yn,w.length):I[w.type]}(c):void 0),v=h.parse(f,void 0,void 0,void 0,c&&c.type==="string"?{typeAnnotation:"coerce"}:void 0);return v?ah(new xd(v,c)):Qu(h.errors)}class ku{constructor(c,h){this.kind=c,this._styleExpression=h,this.isStateDependent=c!=="constant"&&!da(h.expression),this.globalStateRefs=uh(h.expression)}evaluateWithoutErrorHandling(c,h,v,w,I,O){return this._styleExpression.evaluateWithoutErrorHandling(c,h,v,w,I,O)}evaluate(c,h,v,w,I,O){return this._styleExpression.evaluate(c,h,v,w,I,O)}}class Jf{constructor(c,h,v,w){this.kind=c,this.zoomStops=v,this._styleExpression=h,this.isStateDependent=c!=="camera"&&!da(h.expression),this.globalStateRefs=uh(h.expression),this.interpolationType=w}evaluateWithoutErrorHandling(c,h,v,w,I,O){return this._styleExpression.evaluateWithoutErrorHandling(c,h,v,w,I,O)}evaluate(c,h,v,w,I,O){return this._styleExpression.evaluate(c,h,v,w,I,O)}interpolationFactor(c,h,v){return this.interpolationType?vn.interpolationFactor(this.interpolationType,c,h,v):0}}function rm(f,c){const h=Cu(f,c);if(h.result==="error")return h;const v=h.value.expression,w=ro(v);if(!w&&!Kc(c))return Qu([new Rr("","data expressions not supported")]);const I=Nl(v,["zoom"]);if(!I&&!Gh(c))return Qu([new Rr("","zoom expressions not supported")]);const O=ch(v);return O||I?O instanceof Rr?Qu([O]):O instanceof vn&&!vd(c)?Qu([new Rr("",'"interpolate" expressions cannot be used with this property')]):ah(O?new Jf(w?"camera":"composite",h.value,O.labels,O instanceof vn?O.interpolation:void 0):new ku(w?"constant":"source",h.value)):Qu([new Rr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ju{constructor(c,h){this._parameters=c,this._specification=h,pr(this,bd(this._parameters,this._specification))}static deserialize(c){return new Ju(c._parameters,c._specification)}static serialize(c){return{_parameters:c._parameters,_specification:c._specification}}}function ch(f){let c=null;if(f instanceof hl)c=ch(f.result);else if(f instanceof Ui){for(const h of f.args)if(c=ch(h),c)break}else(f instanceof pt||f instanceof vn)&&f.input instanceof gr&&f.input.name==="zoom"&&(c=f);return c instanceof Rr||f.eachChild(h=>{const v=ch(h);v instanceof Rr?c=v:!c&&v?c=new Rr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):c&&v&&c!==v&&(c=new Rr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),c}function uh(f,c=new Set){return f instanceof at&&c.add(f.key),f.eachChild(h=>{uh(h,c)}),c}function dh(f){if(f===!0||f===!1)return!0;if(!Array.isArray(f)||f.length===0)return!1;switch(f[0]){case"has":return f.length>=2&&f[1]!=="$id"&&f[1]!=="$type";case"in":return f.length>=3&&(typeof f[1]!="string"||Array.isArray(f[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return f.length!==3||Array.isArray(f[1])||Array.isArray(f[2]);case"any":case"all":for(const c of f.slice(1))if(!dh(c)&&typeof c!="boolean")return!1;return!0;default:return!0}}const ep={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ed(f){if(f==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};dh(f)||(f=Sc(f));const c=Cu(f,ep);if(c.result==="error")throw new Error(c.value.map(h=>`${h.key}: ${h.message}`).join(", "));return{filter:(h,v,w)=>c.value.evaluate(h,v,{},w),needGeometry:Sd(f),getGlobalStateRefs:()=>uh(c.value.expression)}}function Md(f,c){return f<c?-1:f>c?1:0}function Sd(f){if(!Array.isArray(f))return!1;if(f[0]==="within"||f[0]==="distance")return!0;for(let c=1;c<f.length;c++)if(Sd(f[c]))return!0;return!1}function Sc(f){if(!f)return!0;const c=f[0];return f.length<=1?c!=="any":c==="=="?Kh(f[1],f[2],"=="):c==="!="?hh(Kh(f[1],f[2],"==")):c==="<"||c===">"||c==="<="||c===">="?Kh(f[1],f[2],c):c==="any"?(h=f.slice(1),["any"].concat(h.map(Sc))):c==="all"?["all"].concat(f.slice(1).map(Sc)):c==="none"?["all"].concat(f.slice(1).map(Sc).map(hh)):c==="in"?nm(f[1],f.slice(2)):c==="!in"?hh(nm(f[1],f.slice(2))):c==="has"?tp(f[1]):c!=="!has"||hh(tp(f[1]));var h}function Kh(f,c,h){switch(f){case"$type":return[`filter-type-${h}`,c];case"$id":return[`filter-id-${h}`,c];default:return[`filter-${h}`,f,c]}}function nm(f,c){if(c.length===0)return!1;switch(f){case"$type":return["filter-type-in",["literal",c]];case"$id":return["filter-id-in",["literal",c]];default:return c.length>200&&!c.some(h=>typeof h!=typeof c[0])?["filter-in-large",f,["literal",c.sort(Md)]]:["filter-in-small",f,["literal",c]]}}function tp(f){switch(f){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",f]}}function hh(f){return["!",f]}function rp(f){const c=typeof f;if(c==="number"||c==="boolean"||c==="string"||f==null)return JSON.stringify(f);if(Array.isArray(f)){let w="[";for(const I of f)w+=`${rp(I)},`;return`${w}]`}const h=Object.keys(f).sort();let v="{";for(let w=0;w<h.length;w++)v+=`${JSON.stringify(h[w])}:${rp(f[h[w]])},`;return`${v}}`}function ig(f){let c="";for(const h of zr)c+=`/${rp(f[h])}`;return c}function Zh(f){const c=f.value;return c?[new wt(f.key,c,"constants have been deprecated as of v8")]:[]}function ko(f){return f instanceof Number||f instanceof String||f instanceof Boolean?f.valueOf():f}function Ra(f){if(Array.isArray(f))return f.map(Ra);if(f instanceof Object&&!(f instanceof Number||f instanceof String||f instanceof Boolean)){const c={};for(const h in f)c[h]=Ra(f[h]);return c}return ko(f)}function Ea(f){const c=f.key,h=f.value,v=f.valueSpec||{},w=f.objectElementValidators||{},I=f.style,O=f.styleSpec,z=f.validateSpec;let V=[];const J=Jn(h);if(J!=="object")return[new wt(c,h,`object expected, ${J} found`)];for(const ne in h){const me=ne.split(".")[0],Ee=rt(v,me)||v["*"];let je;if(rt(w,me))je=w[me];else if(rt(v,me))je=z;else if(w["*"])je=w["*"];else{if(!v["*"]){V.push(new wt(c,h[ne],`unknown property "${ne}"`));continue}je=z}V=V.concat(je({key:(c&&`${c}.`)+ne,value:h[ne],valueSpec:Ee,style:I,styleSpec:O,object:h,objectKey:ne,validateSpec:z},h))}for(const ne in v)w[ne]||v[ne].required&&v[ne].default===void 0&&h[ne]===void 0&&V.push(new wt(c,h,`missing required property "${ne}"`));return V}function Xh(f){const c=f.value,h=f.valueSpec,v=f.style,w=f.styleSpec,I=f.key,O=f.arrayElementValidator||f.validateSpec;if(Jn(c)!=="array")return[new wt(I,c,`array expected, ${Jn(c)} found`)];if(h.length&&c.length!==h.length)return[new wt(I,c,`array length ${h.length} expected, length ${c.length} found`)];if(h["min-length"]&&c.length<h["min-length"])return[new wt(I,c,`array length at least ${h["min-length"]} expected, length ${c.length} found`)];let z={type:h.value,values:h.values};w.$version<7&&(z.function=h.function),Jn(h.value)==="object"&&(z=h.value);let V=[];for(let J=0;J<c.length;J++)V=V.concat(O({array:c,arrayIndex:J,value:c[J],valueSpec:z,validateSpec:f.validateSpec,style:v,styleSpec:w,key:`${I}[${J}]`}));return V}function Td(f){const c=f.key,h=f.value,v=f.valueSpec;let w=Jn(h);return w==="number"&&h!=h&&(w="NaN"),w!=="number"?[new wt(c,h,`number expected, ${w} found`)]:"minimum"in v&&h<v.minimum?[new wt(c,h,`${h} is less than the minimum value ${v.minimum}`)]:"maximum"in v&&h>v.maximum?[new wt(c,h,`${h} is greater than the maximum value ${v.maximum}`)]:[]}function Zc(f){const c=f.valueSpec,h=ko(f.value.type);let v,w,I,O={};const z=h!=="categorical"&&f.value.property===void 0,V=!z,J=Jn(f.value.stops)==="array"&&Jn(f.value.stops[0])==="array"&&Jn(f.value.stops[0][0])==="object",ne=Ea({key:f.key,value:f.value,valueSpec:f.styleSpec.function,validateSpec:f.validateSpec,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{stops:function(je){if(h==="identity")return[new wt(je.key,je.value,'identity function may not have a "stops" property')];let Fe=[];const He=je.value;return Fe=Fe.concat(Xh({key:je.key,value:He,valueSpec:je.valueSpec,validateSpec:je.validateSpec,style:je.style,styleSpec:je.styleSpec,arrayElementValidator:me})),Jn(He)==="array"&&He.length===0&&Fe.push(new wt(je.key,He,"array must have at least one stop")),Fe},default:function(je){return je.validateSpec({key:je.key,value:je.value,valueSpec:c,validateSpec:je.validateSpec,style:je.style,styleSpec:je.styleSpec})}}});return h==="identity"&&z&&ne.push(new wt(f.key,f.value,'missing required property "property"')),h==="identity"||f.value.stops||ne.push(new wt(f.key,f.value,'missing required property "stops"')),h==="exponential"&&f.valueSpec.expression&&!vd(f.valueSpec)&&ne.push(new wt(f.key,f.value,"exponential functions not supported")),f.styleSpec.$version>=8&&(V&&!Kc(f.valueSpec)?ne.push(new wt(f.key,f.value,"property functions not supported")):z&&!Gh(f.valueSpec)&&ne.push(new wt(f.key,f.value,"zoom functions not supported"))),h!=="categorical"&&!J||f.value.property!==void 0||ne.push(new wt(f.key,f.value,'"property" property is required')),ne;function me(je){let Fe=[];const He=je.value,st=je.key;if(Jn(He)!=="array")return[new wt(st,He,`array expected, ${Jn(He)} found`)];if(He.length!==2)return[new wt(st,He,`array length 2 expected, length ${He.length} found`)];if(J){if(Jn(He[0])!=="object")return[new wt(st,He,`object expected, ${Jn(He[0])} found`)];if(He[0].zoom===void 0)return[new wt(st,He,"object stop key must have zoom")];if(He[0].value===void 0)return[new wt(st,He,"object stop key must have value")];if(I&&I>ko(He[0].zoom))return[new wt(st,He[0].zoom,"stop zoom values must appear in ascending order")];ko(He[0].zoom)!==I&&(I=ko(He[0].zoom),w=void 0,O={}),Fe=Fe.concat(Ea({key:`${st}[0]`,value:He[0],valueSpec:{zoom:{}},validateSpec:je.validateSpec,style:je.style,styleSpec:je.styleSpec,objectElementValidators:{zoom:Td,value:Ee}}))}else Fe=Fe.concat(Ee({key:`${st}[0]`,value:He[0],validateSpec:je.validateSpec,style:je.style,styleSpec:je.styleSpec},He));return wd(Ra(He[1]))?Fe.concat([new wt(`${st}[1]`,He[1],"expressions are not allowed in function stops.")]):Fe.concat(je.validateSpec({key:`${st}[1]`,value:He[1],valueSpec:c,validateSpec:je.validateSpec,style:je.style,styleSpec:je.styleSpec}))}function Ee(je,Fe){const He=Jn(je.value),st=ko(je.value),yt=je.value!==null?je.value:Fe;if(v){if(He!==v)return[new wt(je.key,yt,`${He} stop domain type must match previous stop domain type ${v}`)]}else v=He;if(He!=="number"&&He!=="string"&&He!=="boolean")return[new wt(je.key,yt,"stop domain value must be a number, string, or boolean")];if(He!=="number"&&h!=="categorical"){let Xt=`number expected, ${He} found`;return Kc(c)&&h===void 0&&(Xt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new wt(je.key,yt,Xt)]}return h!=="categorical"||He!=="number"||isFinite(st)&&Math.floor(st)===st?h!=="categorical"&&He==="number"&&w!==void 0&&st<w?[new wt(je.key,yt,"stop domain values must appear in ascending order")]:(w=st,h==="categorical"&&st in O?[new wt(je.key,yt,"stop domain values must be unique")]:(O[st]=!0,[])):[new wt(je.key,yt,`integer expected, found ${st}`)]}}function ls(f){const c=(f.expressionContext==="property"?rm:Cu)(Ra(f.value),f.valueSpec);if(c.result==="error")return c.value.map(v=>new wt(`${f.key}${v.key}`,f.value,v.message));const h=c.value.expression||c.value._styleExpression.expression;if(f.expressionContext==="property"&&f.propertyKey==="text-font"&&!h.outputDefined())return[new wt(f.key,f.value,`Invalid data expression for "${f.propertyKey}". Output values must be contained as literals within the expression.`)];if(f.expressionContext==="property"&&f.propertyType==="layout"&&!da(h))return[new wt(f.key,f.value,'"feature-state" data expressions are not supported with layout properties.')];if(f.expressionContext==="filter"&&!da(h))return[new wt(f.key,f.value,'"feature-state" data expressions are not supported with filters.')];if(f.expressionContext&&f.expressionContext.indexOf("cluster")===0){if(!Nl(h,["zoom","feature-state"]))return[new wt(f.key,f.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(f.expressionContext==="cluster-initial"&&!ro(h))return[new wt(f.key,f.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Yh(f){const c=f.key,h=f.value,v=Jn(h);return v!=="string"?[new wt(c,h,`color expected, ${v} found`)]:Dr.parse(String(h))?[]:[new wt(c,h,`color expected, "${h}" found`)]}function du(f){const c=f.key,h=f.value,v=f.valueSpec,w=[];return Array.isArray(v.values)?v.values.indexOf(ko(h))===-1&&w.push(new wt(c,h,`expected one of [${v.values.join(", ")}], ${JSON.stringify(h)} found`)):Object.keys(v.values).indexOf(ko(h))===-1&&w.push(new wt(c,h,`expected one of [${Object.keys(v.values).join(", ")}], ${JSON.stringify(h)} found`)),w}function Qh(f){return dh(Ra(f.value))?ls(pr({},f,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Jh(f)}function Jh(f){const c=f.value,h=f.key;if(Jn(c)!=="array")return[new wt(h,c,`array expected, ${Jn(c)} found`)];const v=f.styleSpec;let w,I=[];if(c.length<1)return[new wt(h,c,"filter array must have at least 1 element")];switch(I=I.concat(du({key:`${h}[0]`,value:c[0],valueSpec:v.filter_operator,style:f.style,styleSpec:f.styleSpec})),ko(c[0])){case"<":case"<=":case">":case">=":c.length>=2&&ko(c[1])==="$type"&&I.push(new wt(h,c,`"$type" cannot be use with operator "${c[0]}"`));case"==":case"!=":c.length!==3&&I.push(new wt(h,c,`filter array for operator "${c[0]}" must have 3 elements`));case"in":case"!in":c.length>=2&&(w=Jn(c[1]),w!=="string"&&I.push(new wt(`${h}[1]`,c[1],`string expected, ${w} found`)));for(let O=2;O<c.length;O++)w=Jn(c[O]),ko(c[1])==="$type"?I=I.concat(du({key:`${h}[${O}]`,value:c[O],valueSpec:v.geometry_type,style:f.style,styleSpec:f.styleSpec})):w!=="string"&&w!=="number"&&w!=="boolean"&&I.push(new wt(`${h}[${O}]`,c[O],`string, number, or boolean expected, ${w} found`));break;case"any":case"all":case"none":for(let O=1;O<c.length;O++)I=I.concat(Jh({key:`${h}[${O}]`,value:c[O],style:f.style,styleSpec:f.styleSpec}));break;case"has":case"!has":w=Jn(c[1]),c.length!==2?I.push(new wt(h,c,`filter array for "${c[0]}" operator must have 2 elements`)):w!=="string"&&I.push(new wt(`${h}[1]`,c[1],`string expected, ${w} found`))}return I}function np(f,c){const h=f.key,v=f.validateSpec,w=f.style,I=f.styleSpec,O=f.value,z=f.objectKey,V=I[`${c}_${f.layerType}`];if(!V)return[];const J=z.match(/^(.*)-transition$/);if(c==="paint"&&J&&V[J[1]]&&V[J[1]].transition)return v({key:h,value:O,valueSpec:I.transition,style:w,styleSpec:I});const ne=f.valueSpec||V[z];if(!ne)return[new wt(h,O,`unknown property "${z}"`)];let me;if(Jn(O)==="string"&&Kc(ne)&&!ne.tokens&&(me=/^{([^}]+)}$/.exec(O)))return[new wt(h,O,`"${z}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(me[1])} }\`.`)];const Ee=[];return f.layerType==="symbol"&&(z==="text-field"&&w&&!w.glyphs&&Ee.push(new wt(h,O,'use of "text-field" requires a style "glyphs" property')),z==="text-font"&&Fs(Ra(O))&&ko(O.type)==="identity"&&Ee.push(new wt(h,O,'"text-font" does not support identity functions'))),Ee.concat(v({key:f.key,value:O,valueSpec:ne,style:w,styleSpec:I,expressionContext:"property",propertyType:c,propertyKey:z}))}function ip(f){return np(f,"paint")}function op(f){return np(f,"layout")}function fh(f){let c=[];const h=f.value,v=f.key,w=f.style,I=f.styleSpec;if(Jn(h)!=="object")return[new wt(v,h,`object expected, ${Jn(h)} found`)];h.type||h.ref||c.push(new wt(v,h,'either "type" or "ref" is required'));let O=ko(h.type);const z=ko(h.ref);if(h.id){const V=ko(h.id);for(let J=0;J<f.arrayIndex;J++){const ne=w.layers[J];ko(ne.id)===V&&c.push(new wt(v,h.id,`duplicate layer id "${h.id}", previously used at line ${ne.id.__line__}`))}}if("ref"in h){let V;["type","source","source-layer","filter","layout"].forEach(J=>{J in h&&c.push(new wt(v,h[J],`"${J}" is prohibited for ref layers`))}),w.layers.forEach(J=>{ko(J.id)===z&&(V=J)}),V?V.ref?c.push(new wt(v,h.ref,"ref cannot reference another ref layer")):O=ko(V.type):c.push(new wt(v,h.ref,`ref layer "${z}" not found`))}else if(O!=="background")if(h.source){const V=w.sources&&w.sources[h.source],J=V&&ko(V.type);V?J==="vector"&&O==="raster"?c.push(new wt(v,h.source,`layer "${h.id}" requires a raster source`)):J!=="raster-dem"&&O==="hillshade"||J!=="raster-dem"&&O==="color-relief"?c.push(new wt(v,h.source,`layer "${h.id}" requires a raster-dem source`)):J==="raster"&&O!=="raster"?c.push(new wt(v,h.source,`layer "${h.id}" requires a vector source`)):J!=="vector"||h["source-layer"]?J==="raster-dem"&&O!=="hillshade"&&O!=="color-relief"?c.push(new wt(v,h.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):O!=="line"||!h.paint||!h.paint["line-gradient"]||J==="geojson"&&V.lineMetrics||c.push(new wt(v,h,`layer "${h.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):c.push(new wt(v,h,`layer "${h.id}" must specify a "source-layer"`)):c.push(new wt(v,h.source,`source "${h.source}" not found`))}else c.push(new wt(v,h,'missing required property "source"'));return c=c.concat(Ea({key:v,value:h,valueSpec:I.layer,style:f.style,styleSpec:f.styleSpec,validateSpec:f.validateSpec,objectElementValidators:{"*":()=>[],type:()=>f.validateSpec({key:`${v}.type`,value:h.type,valueSpec:I.layer.type,style:f.style,styleSpec:f.styleSpec,validateSpec:f.validateSpec,object:h,objectKey:"type"}),filter:Qh,layout:V=>Ea({layer:h,key:V.key,value:V.value,style:V.style,styleSpec:V.styleSpec,validateSpec:V.validateSpec,objectElementValidators:{"*":J=>op(pr({layerType:O},J))}}),paint:V=>Ea({layer:h,key:V.key,value:V.value,style:V.style,styleSpec:V.styleSpec,validateSpec:V.validateSpec,objectElementValidators:{"*":J=>ip(pr({layerType:O},J))}})}})),c}function Ml(f){const c=f.value,h=f.key,v=Jn(c);return v!=="string"?[new wt(h,c,`string expected, ${v} found`)]:[]}const Tc={promoteId:function({key:f,value:c}){if(Jn(c)==="string")return Ml({key:f,value:c});{const h=[];for(const v in c)h.push(...Ml({key:`${f}.${v}`,value:c[v]}));return h}}};function zs(f){const c=f.value,h=f.key,v=f.styleSpec,w=f.style,I=f.validateSpec;if(!c.type)return[new wt(h,c,'"type" is required')];const O=ko(c.type);let z;switch(O){case"vector":case"raster":return z=Ea({key:h,value:c,valueSpec:v[`source_${O.replace("-","_")}`],style:f.style,styleSpec:v,objectElementValidators:Tc,validateSpec:I}),z;case"raster-dem":return z=function(V){var J;const ne=(J=V.sourceName)!==null&&J!==void 0?J:"",me=V.value,Ee=V.styleSpec,je=Ee.source_raster_dem,Fe=V.style;let He=[];const st=Jn(me);if(me===void 0)return He;if(st!=="object")return He.push(new wt("source_raster_dem",me,`object expected, ${st} found`)),He;const yt=ko(me.encoding)==="custom",Xt=["redFactor","greenFactor","blueFactor","baseShift"],Ct=V.value.encoding?`"${V.value.encoding}"`:"Default";for(const Rt in me)!yt&&Xt.includes(Rt)?He.push(new wt(Rt,me[Rt],`In "${ne}": "${Rt}" is only valid when "encoding" is set to "custom". ${Ct} encoding found`)):je[Rt]?He=He.concat(V.validateSpec({key:Rt,value:me[Rt],valueSpec:je[Rt],validateSpec:V.validateSpec,style:Fe,styleSpec:Ee})):He.push(new wt(Rt,me[Rt],`unknown property "${Rt}"`));return He}({sourceName:h,value:c,style:f.style,styleSpec:v,validateSpec:I}),z;case"geojson":if(z=Ea({key:h,value:c,valueSpec:v.source_geojson,style:w,styleSpec:v,validateSpec:I,objectElementValidators:Tc}),c.cluster)for(const V in c.clusterProperties){const[J,ne]=c.clusterProperties[V],me=typeof J=="string"?[J,["accumulated"],["get",V]]:J;z.push(...ls({key:`${h}.${V}.map`,value:ne,expressionContext:"cluster-map"})),z.push(...ls({key:`${h}.${V}.reduce`,value:me,expressionContext:"cluster-reduce"}))}return z;case"video":return Ea({key:h,value:c,valueSpec:v.source_video,style:w,validateSpec:I,styleSpec:v});case"image":return Ea({key:h,value:c,valueSpec:v.source_image,style:w,validateSpec:I,styleSpec:v});case"canvas":return[new wt(h,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return du({key:`${h}.type`,value:c.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function td(f){const c=f.value,h=f.styleSpec,v=h.light,w=f.style;let I=[];const O=Jn(c);if(c===void 0)return I;if(O!=="object")return I=I.concat([new wt("light",c,`object expected, ${O} found`)]),I;for(const z in c){const V=z.match(/^(.*)-transition$/);I=I.concat(V&&v[V[1]]&&v[V[1]].transition?f.validateSpec({key:z,value:c[z],valueSpec:h.transition,validateSpec:f.validateSpec,style:w,styleSpec:h}):v[z]?f.validateSpec({key:z,value:c[z],valueSpec:v[z],validateSpec:f.validateSpec,style:w,styleSpec:h}):[new wt(z,c[z],`unknown property "${z}"`)])}return I}function ef(f){const c=f.value,h=f.styleSpec,v=h.sky,w=f.style,I=Jn(c);if(c===void 0)return[];if(I!=="object")return[new wt("sky",c,`object expected, ${I} found`)];let O=[];for(const z in c)O=O.concat(v[z]?f.validateSpec({key:z,value:c[z],valueSpec:v[z],style:w,styleSpec:h}):[new wt(z,c[z],`unknown property "${z}"`)]);return O}function ap(f){const c=f.value,h=f.styleSpec,v=h.terrain,w=f.style;let I=[];const O=Jn(c);if(c===void 0)return I;if(O!=="object")return I=I.concat([new wt("terrain",c,`object expected, ${O} found`)]),I;for(const z in c)I=I.concat(v[z]?f.validateSpec({key:z,value:c[z],valueSpec:v[z],validateSpec:f.validateSpec,style:w,styleSpec:h}):[new wt(z,c[z],`unknown property "${z}"`)]);return I}function im(f){let c=[];const h=f.value,v=f.key;if(Array.isArray(h)){const w=[],I=[];for(const O in h)h[O].id&&w.includes(h[O].id)&&c.push(new wt(v,h,`all the sprites' ids must be unique, but ${h[O].id} is duplicated`)),w.push(h[O].id),h[O].url&&I.includes(h[O].url)&&c.push(new wt(v,h,`all the sprites' URLs must be unique, but ${h[O].url} is duplicated`)),I.push(h[O].url),c=c.concat(Ea({key:`${v}[${O}]`,value:h[O],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:f.validateSpec}));return c}return Ml({key:v,value:h})}function rd(f){return c=f.value,c&&c.constructor===Object?[]:[new wt(f.key,f.value,`object expected, ${Jn(f.value)} found`)];var c}const sp={"*":()=>[],array:Xh,boolean:function(f){const c=f.value,h=f.key,v=Jn(c);return v!=="boolean"?[new wt(h,c,`boolean expected, ${v} found`)]:[]},number:Td,color:Yh,constants:Zh,enum:du,filter:Qh,function:Zc,layer:fh,object:Ea,source:zs,light:td,sky:ef,terrain:ap,projection:function(f){const c=f.value,h=f.styleSpec,v=h.projection,w=f.style,I=Jn(c);if(c===void 0)return[];if(I!=="object")return[new wt("projection",c,`object expected, ${I} found`)];let O=[];for(const z in c)O=O.concat(v[z]?f.validateSpec({key:z,value:c[z],valueSpec:v[z],style:w,styleSpec:h}):[new wt(z,c[z],`unknown property "${z}"`)]);return O},projectionDefinition:function(f){const c=f.key;let h=f.value;h=h instanceof String?h.valueOf():h;const v=Jn(h);return v!=="array"||function(w){return Array.isArray(w)&&w.length===3&&typeof w[0]=="string"&&typeof w[1]=="string"&&typeof w[2]=="number"}(h)||function(w){return!!["interpolate","step","literal"].includes(w[0])}(h)?["array","string"].includes(v)?[]:[new wt(c,h,`projection expected, invalid type "${v}" found`)]:[new wt(c,h,`projection expected, invalid array ${JSON.stringify(h)} found`)]},string:Ml,formatted:function(f){return Ml(f).length===0?[]:ls(f)},resolvedImage:function(f){return Ml(f).length===0?[]:ls(f)},padding:function(f){const c=f.key,h=f.value;if(Jn(h)==="array"){if(h.length<1||h.length>4)return[new wt(c,h,`padding requires 1 to 4 values; ${h.length} values found`)];const v={type:"number"};let w=[];for(let I=0;I<h.length;I++)w=w.concat(f.validateSpec({key:`${c}[${I}]`,value:h[I],validateSpec:f.validateSpec,valueSpec:v}));return w}return Td({key:c,value:h,valueSpec:{}})},numberArray:function(f){const c=f.key,h=f.value;if(Jn(h)==="array"){const v={type:"number"};if(h.length<1)return[new wt(c,h,"array length at least 1 expected, length 0 found")];let w=[];for(let I=0;I<h.length;I++)w=w.concat(f.validateSpec({key:`${c}[${I}]`,value:h[I],validateSpec:f.validateSpec,valueSpec:v}));return w}return Td({key:c,value:h,valueSpec:{}})},colorArray:function(f){const c=f.key,h=f.value;if(Jn(h)==="array"){if(h.length<1)return[new wt(c,h,"array length at least 1 expected, length 0 found")];let v=[];for(let w=0;w<h.length;w++)v=v.concat(Yh({key:`${c}[${w}]`,value:h[w]}));return v}return Yh({key:c,value:h})},variableAnchorOffsetCollection:function(f){const c=f.key,h=f.value,v=Jn(h),w=f.styleSpec;if(v!=="array"||h.length<1||h.length%2!=0)return[new wt(c,h,"variableAnchorOffsetCollection requires a non-empty array of even length")];let I=[];for(let O=0;O<h.length;O+=2)I=I.concat(du({key:`${c}[${O}]`,value:h[O],valueSpec:w.layout_symbol["text-anchor"]})),I=I.concat(Xh({key:`${c}[${O+1}]`,value:h[O+1],valueSpec:{length:2,value:"number"},validateSpec:f.validateSpec,style:f.style,styleSpec:w}));return I},sprite:im,state:rd};function Pd(f){const c=f.value,h=f.valueSpec,v=f.styleSpec;return f.validateSpec=Pd,h.expression&&Fs(ko(c))?Zc(f):h.expression&&wd(Ra(c))?ls(f):h.type&&sp[h.type]?sp[h.type](f):Ea(pr({},f,{valueSpec:h.type?v[h.type]:h}))}function lp(f){const c=f.value,h=f.key,v=Ml(f);return v.length||(c.indexOf("{fontstack}")===-1&&v.push(new wt(h,c,'"glyphs" url must include a "{fontstack}" token')),c.indexOf("{range}")===-1&&v.push(new wt(h,c,'"glyphs" url must include a "{range}" token'))),v}function Sl(f,c=$t){let h=[];return h=h.concat(Pd({key:"",value:f,valueSpec:c.$root,styleSpec:c,style:f,validateSpec:Pd,objectElementValidators:{glyphs:lp,"*":()=>[]}})),f.constants&&(h=h.concat(Zh({key:"constants",value:f.constants}))),Xc(h)}function ic(f){return function(c){return f({...c,validateSpec:Pd})}}function Xc(f){return[].concat(f).sort((c,h)=>c.line-h.line)}function Pc(f){return function(...c){return Xc(f.apply(this,c))}}Sl.source=Pc(ic(zs)),Sl.sprite=Pc(ic(im)),Sl.glyphs=Pc(ic(lp)),Sl.light=Pc(ic(td)),Sl.sky=Pc(ic(ef)),Sl.terrain=Pc(ic(ap)),Sl.state=Pc(ic(rd)),Sl.layer=Pc(ic(fh)),Sl.filter=Pc(ic(Qh)),Sl.paintProperty=Pc(ic(ip)),Sl.layoutProperty=Pc(ic(op));const Ed=Sl,om=Ed.light,B=Ed.sky,q=Ed.paintProperty,le=Ed.layoutProperty;function we(f,c){let h=!1;if(c&&c.length)for(const v of c)f.fire(new fr(new Error(v.message))),h=!0;return h}class Be{constructor(c,h,v){const w=this.cells=[];if(c instanceof ArrayBuffer){this.arrayBuffer=c;const O=new Int32Array(this.arrayBuffer);c=O[0],this.d=(h=O[1])+2*(v=O[2]);for(let V=0;V<this.d*this.d;V++){const J=O[3+V],ne=O[3+V+1];w.push(J===ne?null:O.subarray(J,ne))}const z=O[3+w.length+1];this.keys=O.subarray(O[3+w.length],z),this.bboxes=O.subarray(z),this.insert=this._insertReadonly}else{this.d=h+2*v;for(let O=0;O<this.d*this.d;O++)w.push([]);this.keys=[],this.bboxes=[]}this.n=h,this.extent=c,this.padding=v,this.scale=h/c,this.uid=0;const I=v/h*c;this.min=-I,this.max=c+I}insert(c,h,v,w,I){this._forEachCell(h,v,w,I,this._insertCell,this.uid++,void 0,void 0),this.keys.push(c),this.bboxes.push(h),this.bboxes.push(v),this.bboxes.push(w),this.bboxes.push(I)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(c,h,v,w,I,O){this.cells[I].push(O)}query(c,h,v,w,I){const O=this.min,z=this.max;if(c<=O&&h<=O&&z<=v&&z<=w&&!I)return Array.prototype.slice.call(this.keys);{const V=[];return this._forEachCell(c,h,v,w,this._queryCell,V,{},I),V}}_queryCell(c,h,v,w,I,O,z,V){const J=this.cells[I];if(J!==null){const ne=this.keys,me=this.bboxes;for(let Ee=0;Ee<J.length;Ee++){const je=J[Ee];if(z[je]===void 0){const Fe=4*je;(V?V(me[Fe+0],me[Fe+1],me[Fe+2],me[Fe+3]):c<=me[Fe+2]&&h<=me[Fe+3]&&v>=me[Fe+0]&&w>=me[Fe+1])?(z[je]=!0,O.push(ne[je])):z[je]=!1}}}}_forEachCell(c,h,v,w,I,O,z,V){const J=this._convertToCellCoord(c),ne=this._convertToCellCoord(h),me=this._convertToCellCoord(v),Ee=this._convertToCellCoord(w);for(let je=J;je<=me;je++)for(let Fe=ne;Fe<=Ee;Fe++){const He=this.d*Fe+je;if((!V||V(this._convertFromCellCoord(je),this._convertFromCellCoord(Fe),this._convertFromCellCoord(je+1),this._convertFromCellCoord(Fe+1)))&&I.call(this,c,h,v,w,He,O,z,V))return}}_convertFromCellCoord(c){return(c-this.padding)/this.scale}_convertToCellCoord(c){return Math.max(0,Math.min(this.d-1,Math.floor(c*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const c=this.cells,h=3+this.cells.length+1+1;let v=0;for(let O=0;O<this.cells.length;O++)v+=this.cells[O].length;const w=new Int32Array(h+v+this.keys.length+this.bboxes.length);w[0]=this.extent,w[1]=this.n,w[2]=this.padding;let I=h;for(let O=0;O<c.length;O++){const z=c[O];w[3+O]=I,w.set(z,I),I+=z.length}return w[3+c.length]=I,w.set(this.keys,I),I+=this.keys.length,w[3+c.length+1]=I,w.set(this.bboxes,I),I+=this.bboxes.length,w.buffer}static serialize(c,h){const v=c.toArrayBuffer();return h&&h.push(v),{buffer:v}}static deserialize(c){return new Be(c.buffer)}}const Ze={};function Re(f,c,h={}){if(Ze[f])throw new Error(`${f} is already registered.`);Object.defineProperty(c,"_classRegistryKey",{value:f,writeable:!1}),Ze[f]={klass:c,omit:h.omit||[],shallow:h.shallow||[]}}Re("Object",Object),Re("Set",Set),Re("TransferableGridIndex",Be),Re("Color",Dr),Re("Error",Error),Re("AJAXError",Qe),Re("ResolvedImage",lo),Re("StylePropertyFunction",Ju),Re("StyleExpression",xd,{omit:["_evaluator"]}),Re("ZoomDependentExpression",Jf),Re("ZoomConstantExpression",ku),Re("CompoundExpression",gr,{omit:["_evaluate"]});for(const f in Ht)Ht[f]._classRegistryKey||Re(`Expression_${f}`,Ht[f]);function nt(f){return f&&typeof ArrayBuffer<"u"&&(f instanceof ArrayBuffer||f.constructor&&f.constructor.name==="ArrayBuffer")}function ht(f){return f.$name||f.constructor._classRegistryKey}function bt(f){return!function(c){if(c===null||typeof c!="object")return!1;const h=ht(c);return!(!h||h==="Object")}(f)&&(f==null||typeof f=="boolean"||typeof f=="number"||typeof f=="string"||f instanceof Boolean||f instanceof Number||f instanceof String||f instanceof Date||f instanceof RegExp||f instanceof Blob||f instanceof Error||nt(f)||kt(f)||ArrayBuffer.isView(f)||f instanceof ImageData)}function Gt(f,c){if(bt(f))return(nt(f)||kt(f))&&c&&c.push(f),ArrayBuffer.isView(f)&&c&&c.push(f.buffer),f instanceof ImageData&&c&&c.push(f.data.buffer),f;if(Array.isArray(f)){const I=[];for(const O of f)I.push(Gt(O,c));return I}if(typeof f!="object")throw new Error("can't serialize object of type "+typeof f);const h=ht(f);if(!h)throw new Error(`can't serialize object of unregistered class ${f.constructor.name}`);if(!Ze[h])throw new Error(`${h} is not registered.`);const{klass:v}=Ze[h],w=v.serialize?v.serialize(f,c):{};if(v.serialize){if(c&&w===c[c.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const I in f){if(!f.hasOwnProperty(I)||Ze[h].omit.indexOf(I)>=0)continue;const O=f[I];w[I]=Ze[h].shallow.indexOf(I)>=0?O:Gt(O,c)}f instanceof Error&&(w.message=f.message)}if(w.$name)throw new Error("$name property is reserved for worker serialization logic.");return h!=="Object"&&(w.$name=h),w}function ar(f){if(bt(f))return f;if(Array.isArray(f))return f.map(ar);if(typeof f!="object")throw new Error("can't deserialize object of type "+typeof f);const c=ht(f)||"Object";if(!Ze[c])throw new Error(`can't deserialize unregistered class ${c}`);const{klass:h}=Ze[c];if(!h)throw new Error(`can't deserialize unregistered class ${c}`);if(h.deserialize)return h.deserialize(f);const v=Object.create(h.prototype);for(const w of Object.keys(f)){if(w==="$name")continue;const I=f[w];v[w]=Ze[c].shallow.indexOf(w)>=0?I:ar(I)}return v}class vt{constructor(){this.first=!0}update(c,h){const v=Math.floor(c);return this.first?(this.first=!1,this.lastIntegerZoom=v,this.lastIntegerZoomTime=0,this.lastZoom=c,this.lastFloorZoom=v,!0):(this.lastFloorZoom>v?(this.lastIntegerZoom=v+1,this.lastIntegerZoomTime=h):this.lastFloorZoom<v&&(this.lastIntegerZoom=v,this.lastIntegerZoomTime=h),c!==this.lastZoom&&(this.lastZoom=c,this.lastFloorZoom=v,!0))}}const Nt={"Latin-1 Supplement":f=>f>=128&&f<=255,"Hangul Jamo":f=>f>=4352&&f<=4607,Khmer:f=>f>=6016&&f<=6143,"General Punctuation":f=>f>=8192&&f<=8303,"Letterlike Symbols":f=>f>=8448&&f<=8527,"Number Forms":f=>f>=8528&&f<=8591,"Miscellaneous Technical":f=>f>=8960&&f<=9215,"Control Pictures":f=>f>=9216&&f<=9279,"Optical Character Recognition":f=>f>=9280&&f<=9311,"Enclosed Alphanumerics":f=>f>=9312&&f<=9471,"Geometric Shapes":f=>f>=9632&&f<=9727,"Miscellaneous Symbols":f=>f>=9728&&f<=9983,"Miscellaneous Symbols and Arrows":f=>f>=11008&&f<=11263,"Ideographic Description Characters":f=>f>=12272&&f<=12287,"CJK Symbols and Punctuation":f=>f>=12288&&f<=12351,Hiragana:f=>f>=12352&&f<=12447,Katakana:f=>f>=12448&&f<=12543,Kanbun:f=>f>=12688&&f<=12703,"CJK Strokes":f=>f>=12736&&f<=12783,"Enclosed CJK Letters and Months":f=>f>=12800&&f<=13055,"CJK Compatibility":f=>f>=13056&&f<=13311,"Yijing Hexagram Symbols":f=>f>=19904&&f<=19967,"CJK Unified Ideographs":f=>f>=19968&&f<=40959,"Hangul Syllables":f=>f>=44032&&f<=55215,"Private Use Area":f=>f>=57344&&f<=63743,"Vertical Forms":f=>f>=65040&&f<=65055,"CJK Compatibility Forms":f=>f>=65072&&f<=65103,"Small Form Variants":f=>f>=65104&&f<=65135,"Halfwidth and Fullwidth Forms":f=>f>=65280&&f<=65519};function tr(f){for(const c of f)if(Ur(c.charCodeAt(0)))return!0;return!1}function Tr(f){for(const c of f)if(!Lr(c.charCodeAt(0)))return!1;return!0}function sr(f){const c=f.map(h=>{try{return new RegExp(`\\p{sc=${h}}`,"u").source}catch{return null}}).filter(h=>h);return new RegExp(c.join("|"),"u")}const Ar=sr(["Arab","Dupl","Mong","Ougr","Syrc"]);function Lr(f){return!Ar.test(String.fromCodePoint(f))}const Zr=sr(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Ur(f){return!(f!==746&&f!==747&&(f<4352||!(Nt["CJK Compatibility Forms"](f)&&!(f>=65097&&f<=65103)||Nt["CJK Compatibility"](f)||Nt["CJK Strokes"](f)||!(!Nt["CJK Symbols and Punctuation"](f)||f>=12296&&f<=12305||f>=12308&&f<=12319||f===12336)||Nt["Enclosed CJK Letters and Months"](f)||Nt["Ideographic Description Characters"](f)||Nt.Kanbun(f)||Nt.Katakana(f)&&f!==12540||!(!Nt["Halfwidth and Fullwidth Forms"](f)||f===65288||f===65289||f===65293||f>=65306&&f<=65310||f===65339||f===65341||f===65343||f>=65371&&f<=65503||f===65507||f>=65512&&f<=65519)||!(!Nt["Small Form Variants"](f)||f>=65112&&f<=65118||f>=65123&&f<=65126)||Nt["Vertical Forms"](f)||Nt["Yijing Hexagram Symbols"](f)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(f))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(f))||Zr.test(String.fromCodePoint(f)))))}function zn(f){return!(Ur(f)||function(c){return!!(Nt["Latin-1 Supplement"](c)&&(c===167||c===169||c===174||c===177||c===188||c===189||c===190||c===215||c===247)||Nt["General Punctuation"](c)&&(c===8214||c===8224||c===8225||c===8240||c===8241||c===8251||c===8252||c===8258||c===8263||c===8264||c===8265||c===8273)||Nt["Letterlike Symbols"](c)||Nt["Number Forms"](c)||Nt["Miscellaneous Technical"](c)&&(c>=8960&&c<=8967||c>=8972&&c<=8991||c>=8996&&c<=9e3||c===9003||c>=9085&&c<=9114||c>=9150&&c<=9165||c===9167||c>=9169&&c<=9179||c>=9186&&c<=9215)||Nt["Control Pictures"](c)&&c!==9251||Nt["Optical Character Recognition"](c)||Nt["Enclosed Alphanumerics"](c)||Nt["Geometric Shapes"](c)||Nt["Miscellaneous Symbols"](c)&&!(c>=9754&&c<=9759)||Nt["Miscellaneous Symbols and Arrows"](c)&&(c>=11026&&c<=11055||c>=11088&&c<=11097||c>=11192&&c<=11243)||Nt["CJK Symbols and Punctuation"](c)||Nt.Katakana(c)||Nt["Private Use Area"](c)||Nt["CJK Compatibility Forms"](c)||Nt["Small Form Variants"](c)||Nt["Halfwidth and Fullwidth Forms"](c)||c===8734||c===8756||c===8757||c>=9984&&c<=10087||c>=10102&&c<=10131||c===65532||c===65533)}(f))}const Cn=sr(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Si(f){return Cn.test(String.fromCodePoint(f))}function jn(f,c){return!(!c&&Si(f)||f>=2304&&f<=3583||f>=3840&&f<=4255||Nt.Khmer(f))}function Gi(f){for(const c of f)if(Si(c.charCodeAt(0)))return!0;return!1}const Ro=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(f){this.pluginStatus=f.pluginStatus,this.pluginURL=f.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(f){if(Ro.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=f.applyArabicShaping,this.processBidirectionalText=f.processBidirectionalText,this.processStyledBidirectionalText=f.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(f,c){return a(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(f.pluginStatus!=="loading")return this.setState(f),f;const h=f.pluginURL,v=new Promise(I=>{this.loadScriptResolve=I});c(h);const w=new Promise(I=>setTimeout(()=>I(),this.TIMEOUT));if(yield Promise.race([v,w]),this.isParsed()){const I={pluginStatus:"loaded",pluginURL:h};return this.setState(I),I}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${h}`)})}};class En{constructor(c,h){this.zoom=c,h?(this.now=h.now||0,this.fadeDuration=h.fadeDuration||0,this.zoomHistory=h.zoomHistory||new vt,this.transition=h.transition||{},this.globalState=h.globalState||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new vt,this.transition={},this.globalState={})}isSupportedScript(c){return function(h,v){for(const w of h)if(!jn(w.charCodeAt(0),v))return!1;return!0}(c,Ro.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const c=this.zoom,h=c-Math.floor(c),v=this.crossFadingFactor();return c>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:h+(1-h)*v}:{fromScale:.5,toScale:1,t:1-(1-v)*h}}}class kn{constructor(c,h){this.property=c,this.value=h,this.expression=function(v,w){if(Fs(v))return new Ju(v,w);if(wd(v)){const I=rm(v,w);if(I.result==="error")throw new Error(I.value.map(O=>`${O.key}: ${O.message}`).join(", "));return I.value}{let I=v;return w.type==="color"&&typeof v=="string"?I=Dr.parse(v):w.type!=="padding"||typeof v!="number"&&!Array.isArray(v)?w.type!=="numberArray"||typeof v!="number"&&!Array.isArray(v)?w.type!=="colorArray"||typeof v!="string"&&!Array.isArray(v)?w.type==="variableAnchorOffsetCollection"&&Array.isArray(v)?I=Ri.parse(v):w.type==="projectionDefinition"&&typeof v=="string"&&(I=Mi.parse(v)):I=Oi.parse(v):I=Xi.parse(v):I=rn.parse(v),{globalStateRefs:new Set,kind:"constant",evaluate:()=>I}}}(h===void 0?c.specification.default:h,c.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(c,h,v){return this.property.possiblyEvaluate(this,c,h,v)}}class mn{constructor(c){this.property=c,this.value=new kn(c,void 0)}transitioned(c,h){return new hi(this.property,this.value,h,ot({},c.transition,this.transition),c.now)}untransitioned(){return new hi(this.property,this.value,null,{},0)}}class xa{constructor(c){this._properties=c,this._values=Object.create(c.defaultTransitionablePropertyValues)}getValue(c){return Le(this._values[c].value.value)}setValue(c,h){Object.prototype.hasOwnProperty.call(this._values,c)||(this._values[c]=new mn(this._values[c].property)),this._values[c].value=new kn(this._values[c].property,h===null?void 0:Le(h))}getTransition(c){return Le(this._values[c].transition)}setTransition(c,h){Object.prototype.hasOwnProperty.call(this._values,c)||(this._values[c]=new mn(this._values[c].property)),this._values[c].transition=Le(h)||void 0}serialize(){const c={};for(const h of Object.keys(this._values)){const v=this.getValue(h);v!==void 0&&(c[h]=v);const w=this.getTransition(h);w!==void 0&&(c[`${h}-transition`]=w)}return c}transitioned(c,h){const v=new eo(this._properties);for(const w of Object.keys(this._values))v._values[w]=this._values[w].transitioned(c,h._values[w]);return v}untransitioned(){const c=new eo(this._properties);for(const h of Object.keys(this._values))c._values[h]=this._values[h].untransitioned();return c}}class hi{constructor(c,h,v,w,I){this.property=c,this.value=h,this.begin=I+w.delay||0,this.end=this.begin+w.duration||0,c.specification.transition&&(w.delay||w.duration)&&(this.prior=v)}possiblyEvaluate(c,h,v){const w=c.now||0,I=this.value.possiblyEvaluate(c,h,v),O=this.prior;if(O){if(w>this.end)return this.prior=null,I;if(this.value.isDataDriven())return this.prior=null,I;if(w<this.begin)return O.possiblyEvaluate(c,h,v);{const z=(w-this.begin)/(this.end-this.begin);return this.property.interpolate(O.possiblyEvaluate(c,h,v),I,te(z))}}return I}}class eo{constructor(c){this._properties=c,this._values=Object.create(c.defaultTransitioningPropertyValues)}possiblyEvaluate(c,h,v){const w=new Ha(this._properties);for(const I of Object.keys(this._values))w._values[I]=this._values[I].possiblyEvaluate(c,h,v);return w}hasTransition(){for(const c of Object.keys(this._values))if(this._values[c].prior)return!0;return!1}}class Zo{constructor(c){this._properties=c,this._values=Object.create(c.defaultPropertyValues)}hasValue(c){return this._values[c].value!==void 0}getValue(c){return Le(this._values[c].value)}setValue(c,h){this._values[c]=new kn(this._values[c].property,h===null?void 0:Le(h))}serialize(){const c={};for(const h of Object.keys(this._values)){const v=this.getValue(h);v!==void 0&&(c[h]=v)}return c}possiblyEvaluate(c,h,v){const w=new Ha(this._properties);for(const I of Object.keys(this._values))w._values[I]=this._values[I].possiblyEvaluate(c,h,v);return w}}class Wo{constructor(c,h,v){this.property=c,this.value=h,this.parameters=v}isConstant(){return this.value.kind==="constant"}constantOr(c){return this.value.kind==="constant"?this.value.value:c}evaluate(c,h,v,w){return this.property.evaluate(this.value,this.parameters,c,h,v,w)}}class Ha{constructor(c){this._properties=c,this._values=Object.create(c.defaultPossiblyEvaluatedValues)}get(c){return this._values[c]}}class on{constructor(c){this.specification=c}possiblyEvaluate(c,h){if(c.isDataDriven())throw new Error("Value should not be data driven");return c.expression.evaluate(h)}interpolate(c,h,v){const w=Xn[this.specification.type];return w?w(c,h,v):c}}class xn{constructor(c,h){this.specification=c,this.overrides=h}possiblyEvaluate(c,h,v,w){return new Wo(this,c.expression.kind==="constant"||c.expression.kind==="camera"?{kind:"constant",value:c.expression.evaluate(h,null,{},v,w)}:c.expression,h)}interpolate(c,h,v){if(c.value.kind!=="constant"||h.value.kind!=="constant")return c;if(c.value.value===void 0||h.value.value===void 0)return new Wo(this,{kind:"constant",value:void 0},c.parameters);const w=Xn[this.specification.type];if(w){const I=w(c.value.value,h.value.value,v);return new Wo(this,{kind:"constant",value:I},c.parameters)}return c}evaluate(c,h,v,w,I,O){return c.kind==="constant"?c.value:c.evaluate(h,v,w,I,O)}}class cs extends xn{possiblyEvaluate(c,h,v,w){if(c.value===void 0)return new Wo(this,{kind:"constant",value:void 0},h);if(c.expression.kind==="constant"){const I=c.expression.evaluate(h,null,{},v,w),O=c.property.specification.type==="resolvedImage"&&typeof I!="string"?I.name:I,z=this._calculate(O,O,O,h);return new Wo(this,{kind:"constant",value:z},h)}if(c.expression.kind==="camera"){const I=this._calculate(c.expression.evaluate({zoom:h.zoom-1}),c.expression.evaluate({zoom:h.zoom}),c.expression.evaluate({zoom:h.zoom+1}),h);return new Wo(this,{kind:"constant",value:I},h)}return new Wo(this,c.expression,h)}evaluate(c,h,v,w,I,O){if(c.kind==="source"){const z=c.evaluate(h,v,w,I,O);return this._calculate(z,z,z,h)}return c.kind==="composite"?this._calculate(c.evaluate({zoom:Math.floor(h.zoom)-1},v,w),c.evaluate({zoom:Math.floor(h.zoom)},v,w),c.evaluate({zoom:Math.floor(h.zoom)+1},v,w),h):c.value}_calculate(c,h,v,w){return w.zoom>w.zoomHistory.lastIntegerZoom?{from:c,to:h}:{from:v,to:h}}interpolate(c){return c}}class Xo{constructor(c){this.specification=c}possiblyEvaluate(c,h,v,w){if(c.value!==void 0){if(c.expression.kind==="constant"){const I=c.expression.evaluate(h,null,{},v,w);return this._calculate(I,I,I,h)}return this._calculate(c.expression.evaluate(new En(Math.floor(h.zoom-1),h)),c.expression.evaluate(new En(Math.floor(h.zoom),h)),c.expression.evaluate(new En(Math.floor(h.zoom+1),h)),h)}}_calculate(c,h,v,w){return w.zoom>w.zoomHistory.lastIntegerZoom?{from:c,to:h}:{from:v,to:h}}interpolate(c){return c}}class Fi{constructor(c){this.specification=c}possiblyEvaluate(c,h,v,w){return!!c.expression.evaluate(h,null,{},v,w)}interpolate(){return!1}}class wi{constructor(c){this.properties=c,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const h in c){const v=c[h];v.specification.overridable&&this.overridableProperties.push(h);const w=this.defaultPropertyValues[h]=new kn(v,void 0),I=this.defaultTransitionablePropertyValues[h]=new mn(v);this.defaultTransitioningPropertyValues[h]=I.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=w.possiblyEvaluate({})}}}Re("DataDrivenProperty",xn),Re("DataConstantProperty",on),Re("CrossFadedDataDrivenProperty",cs),Re("CrossFadedProperty",Xo),Re("ColorRampProperty",Fi);const _a="-transition";class Li extends Jr{constructor(c,h){if(super(),this.id=c.id,this.type=c.type,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},c.type!=="custom"&&(this.metadata=c.metadata,this.minzoom=c.minzoom,this.maxzoom=c.maxzoom,c.type!=="background"&&(this.source=c.source,this.sourceLayer=c["source-layer"],this.filter=c.filter,this._featureFilter=ed(c.filter)),h.layout&&(this._unevaluatedLayout=new Zo(h.layout)),h.paint)){this._transitionablePaint=new xa(h.paint);for(const v in c.paint)this.setPaintProperty(v,c.paint[v],{validate:!1});for(const v in c.layout)this.setLayoutProperty(v,c.layout[v],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ha(h.paint)}}setFilter(c){this.filter=c,this._featureFilter=ed(c)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(c){return c==="visibility"?this.visibility:this._unevaluatedLayout.getValue(c)}getLayoutAffectingGlobalStateRefs(){const c=new Set;if(this._unevaluatedLayout)for(const h in this._unevaluatedLayout._values){const v=this._unevaluatedLayout._values[h];for(const w of v.getGlobalStateRefs())c.add(w)}for(const h of this._featureFilter.getGlobalStateRefs())c.add(h);return c}getPaintAffectingGlobalStateRefs(){var c;const h=new globalThis.Map;if(this._transitionablePaint)for(const v in this._transitionablePaint._values){const w=this._transitionablePaint._values[v].value;for(const I of w.getGlobalStateRefs()){const O=(c=h.get(I))!==null&&c!==void 0?c:[];O.push({name:v,value:w.value}),h.set(I,O)}}return h}setLayoutProperty(c,h,v={}){h!=null&&this._validate(le,`layers.${this.id}.layout.${c}`,c,h,v)||(c!=="visibility"?this._unevaluatedLayout.setValue(c,h):this.visibility=h)}getPaintProperty(c){return c.endsWith(_a)?this._transitionablePaint.getTransition(c.slice(0,-11)):this._transitionablePaint.getValue(c)}setPaintProperty(c,h,v={}){if(h!=null&&this._validate(q,`layers.${this.id}.paint.${c}`,c,h,v))return!1;if(c.endsWith(_a))return this._transitionablePaint.setTransition(c.slice(0,-11),h||void 0),!1;{const w=this._transitionablePaint._values[c],I=w.property.specification["property-type"]==="cross-faded-data-driven",O=w.value.isDataDriven(),z=w.value;this._transitionablePaint.setValue(c,h),this._handleSpecialPaintPropertyUpdate(c);const V=this._transitionablePaint._values[c].value;return V.isDataDriven()||O||I||this._handleOverridablePaintPropertyUpdate(c,z,V)}}_handleSpecialPaintPropertyUpdate(c){}_handleOverridablePaintPropertyUpdate(c,h,v){return!1}isHidden(c){return!!(this.minzoom&&c<this.minzoom)||!!(this.maxzoom&&c>=this.maxzoom)||this.visibility==="none"}updateTransitions(c){this._transitioningPaint=this._transitionablePaint.transitioned(c,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(c,h){c.getCrossfadeParameters&&(this._crossfadeParameters=c.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(c,void 0,h)),this.paint=this._transitioningPaint.possiblyEvaluate(c,void 0,h)}serialize(){const c={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(c.layout=c.layout||{},c.layout.visibility=this.visibility),Te(c,(h,v)=>!(h===void 0||v==="layout"&&!Object.keys(h).length||v==="paint"&&!Object.keys(h).length))}_validate(c,h,v,w,I={}){return(!I||I.validate!==!1)&&we(this,c.call(Ed,{key:h,layerType:this.type,objectKey:v,value:w,styleSpec:$t,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const c in this.paint._values){const h=this.paint.get(c);if(h instanceof Wo&&Kc(h.property.specification)&&(h.value.kind==="source"||h.value.kind==="composite")&&h.value.isStateDependent)return!0}return!1}}const Ps={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Bs{constructor(c,h){this._structArray=c,this._pos1=h*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class si{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(c,h){return c._trim(),h&&(c.isTransferred=!0,h.push(c.arrayBuffer)),{length:c.length,arrayBuffer:c.arrayBuffer}}static deserialize(c){const h=Object.create(this.prototype);return h.arrayBuffer=c.arrayBuffer,h.length=c.length,h.capacity=c.arrayBuffer.byteLength/h.bytesPerElement,h._refreshViews(),h}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(c){this.reserve(c),this.length=c}reserve(c){if(c>this.capacity){this.capacity=Math.max(c,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const h=this.uint8;this._refreshViews(),h&&this.uint8.set(h)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function no(f,c=1){let h=0,v=0;return{members:f.map(w=>{const I=Ps[w.type].BYTES_PER_ELEMENT,O=h=Io(h,Math.max(c,I)),z=w.components||1;return v=Math.max(v,I),h+=I*z,{name:w.name,type:w.type,components:z,offset:O}}),size:Io(h,Math.max(v,c)),alignment:c}}function Io(f,c){return Math.ceil(f/c)*c}class ia extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h){const v=this.length;return this.resize(v+1),this.emplace(v,c,h)}emplace(c,h,v){const w=2*c;return this.int16[w+0]=h,this.int16[w+1]=v,c}}ia.prototype.bytesPerElement=4,Re("StructArrayLayout2i4",ia);class us extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h,v){const w=this.length;return this.resize(w+1),this.emplace(w,c,h,v)}emplace(c,h,v,w){const I=3*c;return this.int16[I+0]=h,this.int16[I+1]=v,this.int16[I+2]=w,c}}us.prototype.bytesPerElement=6,Re("StructArrayLayout3i6",us);class Es extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h,v,w){const I=this.length;return this.resize(I+1),this.emplace(I,c,h,v,w)}emplace(c,h,v,w,I){const O=4*c;return this.int16[O+0]=h,this.int16[O+1]=v,this.int16[O+2]=w,this.int16[O+3]=I,c}}Es.prototype.bytesPerElement=8,Re("StructArrayLayout4i8",Es);class Ka extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h,v,w,I,O){const z=this.length;return this.resize(z+1),this.emplace(z,c,h,v,w,I,O)}emplace(c,h,v,w,I,O,z){const V=6*c;return this.int16[V+0]=h,this.int16[V+1]=v,this.int16[V+2]=w,this.int16[V+3]=I,this.int16[V+4]=O,this.int16[V+5]=z,c}}Ka.prototype.bytesPerElement=12,Re("StructArrayLayout2i4i12",Ka);class Za extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h,v,w,I,O){const z=this.length;return this.resize(z+1),this.emplace(z,c,h,v,w,I,O)}emplace(c,h,v,w,I,O,z){const V=4*c,J=8*c;return this.int16[V+0]=h,this.int16[V+1]=v,this.uint8[J+4]=w,this.uint8[J+5]=I,this.uint8[J+6]=O,this.uint8[J+7]=z,c}}Za.prototype.bytesPerElement=8,Re("StructArrayLayout2i4ub8",Za);class ds extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,h){const v=this.length;return this.resize(v+1),this.emplace(v,c,h)}emplace(c,h,v){const w=2*c;return this.float32[w+0]=h,this.float32[w+1]=v,c}}ds.prototype.bytesPerElement=8,Re("StructArrayLayout2f8",ds);class Us extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,h,v,w,I,O,z,V,J,ne){const me=this.length;return this.resize(me+1),this.emplace(me,c,h,v,w,I,O,z,V,J,ne)}emplace(c,h,v,w,I,O,z,V,J,ne,me){const Ee=10*c;return this.uint16[Ee+0]=h,this.uint16[Ee+1]=v,this.uint16[Ee+2]=w,this.uint16[Ee+3]=I,this.uint16[Ee+4]=O,this.uint16[Ee+5]=z,this.uint16[Ee+6]=V,this.uint16[Ee+7]=J,this.uint16[Ee+8]=ne,this.uint16[Ee+9]=me,c}}Us.prototype.bytesPerElement=20,Re("StructArrayLayout10ui20",Us);class mo extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,h,v,w,I,O,z,V,J,ne,me,Ee){const je=this.length;return this.resize(je+1),this.emplace(je,c,h,v,w,I,O,z,V,J,ne,me,Ee)}emplace(c,h,v,w,I,O,z,V,J,ne,me,Ee,je){const Fe=12*c;return this.int16[Fe+0]=h,this.int16[Fe+1]=v,this.int16[Fe+2]=w,this.int16[Fe+3]=I,this.uint16[Fe+4]=O,this.uint16[Fe+5]=z,this.uint16[Fe+6]=V,this.uint16[Fe+7]=J,this.int16[Fe+8]=ne,this.int16[Fe+9]=me,this.int16[Fe+10]=Ee,this.int16[Fe+11]=je,c}}mo.prototype.bytesPerElement=24,Re("StructArrayLayout4i4ui4i24",mo);class Qs extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,h,v){const w=this.length;return this.resize(w+1),this.emplace(w,c,h,v)}emplace(c,h,v,w){const I=3*c;return this.float32[I+0]=h,this.float32[I+1]=v,this.float32[I+2]=w,c}}Qs.prototype.bytesPerElement=12,Re("StructArrayLayout3f12",Qs);class jl extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(c){const h=this.length;return this.resize(h+1),this.emplace(h,c)}emplace(c,h){return this.uint32[1*c+0]=h,c}}jl.prototype.bytesPerElement=4,Re("StructArrayLayout1ul4",jl);class Ec extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,h,v,w,I,O,z,V,J){const ne=this.length;return this.resize(ne+1),this.emplace(ne,c,h,v,w,I,O,z,V,J)}emplace(c,h,v,w,I,O,z,V,J,ne){const me=10*c,Ee=5*c;return this.int16[me+0]=h,this.int16[me+1]=v,this.int16[me+2]=w,this.int16[me+3]=I,this.int16[me+4]=O,this.int16[me+5]=z,this.uint32[Ee+3]=V,this.uint16[me+8]=J,this.uint16[me+9]=ne,c}}Ec.prototype.bytesPerElement=20,Re("StructArrayLayout6i1ul2ui20",Ec);class Ac extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h,v,w,I,O){const z=this.length;return this.resize(z+1),this.emplace(z,c,h,v,w,I,O)}emplace(c,h,v,w,I,O,z){const V=6*c;return this.int16[V+0]=h,this.int16[V+1]=v,this.int16[V+2]=w,this.int16[V+3]=I,this.int16[V+4]=O,this.int16[V+5]=z,c}}Ac.prototype.bytesPerElement=12,Re("StructArrayLayout2i2i2i12",Ac);class A extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h,v,w,I){const O=this.length;return this.resize(O+1),this.emplace(O,c,h,v,w,I)}emplace(c,h,v,w,I,O){const z=4*c,V=8*c;return this.float32[z+0]=h,this.float32[z+1]=v,this.float32[z+2]=w,this.int16[V+6]=I,this.int16[V+7]=O,c}}A.prototype.bytesPerElement=16,Re("StructArrayLayout2f1f2i16",A);class l extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h,v,w,I,O){const z=this.length;return this.resize(z+1),this.emplace(z,c,h,v,w,I,O)}emplace(c,h,v,w,I,O,z){const V=16*c,J=4*c,ne=8*c;return this.uint8[V+0]=h,this.uint8[V+1]=v,this.float32[J+1]=w,this.float32[J+2]=I,this.int16[ne+6]=O,this.int16[ne+7]=z,c}}l.prototype.bytesPerElement=16,Re("StructArrayLayout2ub2f2i16",l);class p extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,h,v){const w=this.length;return this.resize(w+1),this.emplace(w,c,h,v)}emplace(c,h,v,w){const I=3*c;return this.uint16[I+0]=h,this.uint16[I+1]=v,this.uint16[I+2]=w,c}}p.prototype.bytesPerElement=6,Re("StructArrayLayout3ui6",p);class b extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,h,v,w,I,O,z,V,J,ne,me,Ee,je,Fe,He,st,yt){const Xt=this.length;return this.resize(Xt+1),this.emplace(Xt,c,h,v,w,I,O,z,V,J,ne,me,Ee,je,Fe,He,st,yt)}emplace(c,h,v,w,I,O,z,V,J,ne,me,Ee,je,Fe,He,st,yt,Xt){const Ct=24*c,Rt=12*c,lr=48*c;return this.int16[Ct+0]=h,this.int16[Ct+1]=v,this.uint16[Ct+2]=w,this.uint16[Ct+3]=I,this.uint32[Rt+2]=O,this.uint32[Rt+3]=z,this.uint32[Rt+4]=V,this.uint16[Ct+10]=J,this.uint16[Ct+11]=ne,this.uint16[Ct+12]=me,this.float32[Rt+7]=Ee,this.float32[Rt+8]=je,this.uint8[lr+36]=Fe,this.uint8[lr+37]=He,this.uint8[lr+38]=st,this.uint32[Rt+10]=yt,this.int16[Ct+22]=Xt,c}}b.prototype.bytesPerElement=48,Re("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",b);class S extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,h,v,w,I,O,z,V,J,ne,me,Ee,je,Fe,He,st,yt,Xt,Ct,Rt,lr,vr,Fr,pn,tn,un,Rn,ln){const dn=this.length;return this.resize(dn+1),this.emplace(dn,c,h,v,w,I,O,z,V,J,ne,me,Ee,je,Fe,He,st,yt,Xt,Ct,Rt,lr,vr,Fr,pn,tn,un,Rn,ln)}emplace(c,h,v,w,I,O,z,V,J,ne,me,Ee,je,Fe,He,st,yt,Xt,Ct,Rt,lr,vr,Fr,pn,tn,un,Rn,ln,dn){const Cr=32*c,oi=16*c;return this.int16[Cr+0]=h,this.int16[Cr+1]=v,this.int16[Cr+2]=w,this.int16[Cr+3]=I,this.int16[Cr+4]=O,this.int16[Cr+5]=z,this.int16[Cr+6]=V,this.int16[Cr+7]=J,this.uint16[Cr+8]=ne,this.uint16[Cr+9]=me,this.uint16[Cr+10]=Ee,this.uint16[Cr+11]=je,this.uint16[Cr+12]=Fe,this.uint16[Cr+13]=He,this.uint16[Cr+14]=st,this.uint16[Cr+15]=yt,this.uint16[Cr+16]=Xt,this.uint16[Cr+17]=Ct,this.uint16[Cr+18]=Rt,this.uint16[Cr+19]=lr,this.uint16[Cr+20]=vr,this.uint16[Cr+21]=Fr,this.uint16[Cr+22]=pn,this.uint32[oi+12]=tn,this.float32[oi+13]=un,this.float32[oi+14]=Rn,this.uint16[Cr+30]=ln,this.uint16[Cr+31]=dn,c}}S.prototype.bytesPerElement=64,Re("StructArrayLayout8i15ui1ul2f2ui64",S);class k extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c){const h=this.length;return this.resize(h+1),this.emplace(h,c)}emplace(c,h){return this.float32[1*c+0]=h,c}}k.prototype.bytesPerElement=4,Re("StructArrayLayout1f4",k);class R extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,h,v){const w=this.length;return this.resize(w+1),this.emplace(w,c,h,v)}emplace(c,h,v,w){const I=3*c;return this.uint16[6*c+0]=h,this.float32[I+1]=v,this.float32[I+2]=w,c}}R.prototype.bytesPerElement=12,Re("StructArrayLayout1ui2f12",R);class W extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,h,v){const w=this.length;return this.resize(w+1),this.emplace(w,c,h,v)}emplace(c,h,v,w){const I=4*c;return this.uint32[2*c+0]=h,this.uint16[I+2]=v,this.uint16[I+3]=w,c}}W.prototype.bytesPerElement=8,Re("StructArrayLayout1ul2ui8",W);class Z extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,h){const v=this.length;return this.resize(v+1),this.emplace(v,c,h)}emplace(c,h,v){const w=2*c;return this.uint16[w+0]=h,this.uint16[w+1]=v,c}}Z.prototype.bytesPerElement=4,Re("StructArrayLayout2ui4",Z);class ie extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c){const h=this.length;return this.resize(h+1),this.emplace(h,c)}emplace(c,h){return this.uint16[1*c+0]=h,c}}ie.prototype.bytesPerElement=2,Re("StructArrayLayout1ui2",ie);class ce extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,h,v,w){const I=this.length;return this.resize(I+1),this.emplace(I,c,h,v,w)}emplace(c,h,v,w,I){const O=4*c;return this.float32[O+0]=h,this.float32[O+1]=v,this.float32[O+2]=w,this.float32[O+3]=I,c}}ce.prototype.bytesPerElement=16,Re("StructArrayLayout4f16",ce);class xe extends Bs{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new u(this.anchorPointX,this.anchorPointY)}}xe.prototype.size=20;class be extends Ec{get(c){return new xe(this,c)}}Re("CollisionBoxArray",be);class Ae extends Bs{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(c){this._structArray.uint8[this._pos1+37]=c}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(c){this._structArray.uint8[this._pos1+38]=c}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(c){this._structArray.uint32[this._pos4+10]=c}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Ae.prototype.size=48;class Ue extends b{get(c){return new Ae(this,c)}}Re("PlacedSymbolArray",Ue);class lt extends Bs{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(c){this._structArray.uint32[this._pos4+12]=c}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}lt.prototype.size=64;class it extends S{get(c){return new lt(this,c)}}Re("SymbolInstanceArray",it);class ft extends k{getoffsetX(c){return this.float32[1*c+0]}}Re("GlyphOffsetArray",ft);class gt extends us{getx(c){return this.int16[3*c+0]}gety(c){return this.int16[3*c+1]}gettileUnitDistanceFromAnchor(c){return this.int16[3*c+2]}}Re("SymbolLineVertexArray",gt);class Et extends Bs{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Et.prototype.size=12;class Mt extends R{get(c){return new Et(this,c)}}Re("TextAnchorOffsetArray",Mt);class It extends Bs{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}It.prototype.size=8;class jt extends W{get(c){return new It(this,c)}}Re("FeatureIndexArray",jt);class St extends ia{}class Wt extends ia{}class ur extends ia{}class Jt extends Ka{}class nr extends Za{}class cr extends ds{}class Gr extends Us{}class Yr extends mo{}class $r extends Qs{}class Tn extends jl{}class mi extends Ac{}class uo extends l{}class go extends p{}class bo extends Z{}const zo=no([{name:"a_pos",components:2,type:"Int16"}],4),{members:To}=zo;class ei{constructor(c=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=c}prepareSegment(c,h,v,w){const I=this.segments[this.segments.length-1];return c>ei.MAX_VERTEX_ARRAY_LENGTH&&Xe(`Max vertices per segment is ${ei.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${c}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${ei.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!I||I.vertexLength+c>ei.MAX_VERTEX_ARRAY_LENGTH||I.sortKey!==w?this.createNewSegment(h,v,w):I}createNewSegment(c,h,v){const w={vertexOffset:c.length,primitiveOffset:h.length,vertexLength:0,primitiveLength:0,vaos:{}};return v!==void 0&&(w.sortKey=v),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(w),w}getOrCreateLatestSegment(c,h,v){return this.prepareSegment(0,c,h,v)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const c of this.segments)for(const h in c.vaos)c.vaos[h].destroy()}static simpleSegment(c,h,v,w){return new ei([{vertexOffset:c,primitiveOffset:h,vertexLength:v,primitiveLength:w,vaos:{},sortKey:0}])}}function qi(f,c){return 256*(f=Ce(Math.floor(f),0,255))+Ce(Math.floor(c),0,255)}ei.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Re("SegmentVector",ei);const ya=no([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Aa,Fa,Js,Rl={exports:{}},Yc={exports:{}},Ad={exports:{}},tf=function(){if(Js)return Rl.exports;Js=1;var f=(Aa||(Aa=1,Yc.exports=function(h,v){var w,I,O,z,V,J,ne,me;for(I=h.length-(w=3&h.length),O=v,V=3432918353,J=461845907,me=0;me<I;)ne=255&h.charCodeAt(me)|(255&h.charCodeAt(++me))<<8|(255&h.charCodeAt(++me))<<16|(255&h.charCodeAt(++me))<<24,++me,O=27492+(65535&(z=5*(65535&(O=(O^=ne=(65535&(ne=(ne=(65535&ne)*V+(((ne>>>16)*V&65535)<<16)&4294967295)<<15|ne>>>17))*J+(((ne>>>16)*J&65535)<<16)&4294967295)<<13|O>>>19))+((5*(O>>>16)&65535)<<16)&4294967295))+((58964+(z>>>16)&65535)<<16);switch(ne=0,w){case 3:ne^=(255&h.charCodeAt(me+2))<<16;case 2:ne^=(255&h.charCodeAt(me+1))<<8;case 1:O^=ne=(65535&(ne=(ne=(65535&(ne^=255&h.charCodeAt(me)))*V+(((ne>>>16)*V&65535)<<16)&4294967295)<<15|ne>>>17))*J+(((ne>>>16)*J&65535)<<16)&4294967295}return O^=h.length,O=2246822507*(65535&(O^=O>>>16))+((2246822507*(O>>>16)&65535)<<16)&4294967295,O=3266489909*(65535&(O^=O>>>13))+((3266489909*(O>>>16)&65535)<<16)&4294967295,(O^=O>>>16)>>>0}),Yc.exports),c=(Fa||(Fa=1,Ad.exports=function(h,v){for(var w,I=h.length,O=v^I,z=0;I>=4;)w=1540483477*(65535&(w=255&h.charCodeAt(z)|(255&h.charCodeAt(++z))<<8|(255&h.charCodeAt(++z))<<16|(255&h.charCodeAt(++z))<<24))+((1540483477*(w>>>16)&65535)<<16),O=1540483477*(65535&O)+((1540483477*(O>>>16)&65535)<<16)^(w=1540483477*(65535&(w^=w>>>24))+((1540483477*(w>>>16)&65535)<<16)),I-=4,++z;switch(I){case 3:O^=(255&h.charCodeAt(z+2))<<16;case 2:O^=(255&h.charCodeAt(z+1))<<8;case 1:O=1540483477*(65535&(O^=255&h.charCodeAt(z)))+((1540483477*(O>>>16)&65535)<<16)}return O=1540483477*(65535&(O^=O>>>13))+((1540483477*(O>>>16)&65535)<<16),(O^=O>>>15)>>>0}),Ad.exports);return Rl.exports=f,Rl.exports.murmur3=f,Rl.exports.murmur2=c,Rl.exports}(),rf=d(tf);class ph{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(c,h,v,w){this.ids.push(mh(c)),this.positions.push(h,v,w)}getPositions(c){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const h=mh(c);let v=0,w=this.ids.length-1;for(;v<w;){const O=v+w>>1;this.ids[O]>=h?w=O:v=O+1}const I=[];for(;this.ids[v]===h;)I.push({index:this.positions[3*v],start:this.positions[3*v+1],end:this.positions[3*v+2]}),v++;return I}static serialize(c,h){const v=new Float64Array(c.ids),w=new Uint32Array(c.positions);return Fl(v,w,0,v.length-1),h&&h.push(v.buffer,w.buffer),{ids:v,positions:w}}static deserialize(c){const h=new ph;return h.ids=c.ids,h.positions=c.positions,h.indexed=!0,h}}function mh(f){const c=+f;return!isNaN(c)&&c<=Number.MAX_SAFE_INTEGER?c:rf(String(f))}function Fl(f,c,h,v){for(;h<v;){const w=f[h+v>>1];let I=h-1,O=v+1;for(;;){do I++;while(f[I]<w);do O--;while(f[O]>w);if(I>=O)break;hu(f,I,O),hu(c,3*I,3*O),hu(c,3*I+1,3*O+1),hu(c,3*I+2,3*O+2)}O-h<v-O?(Fl(f,c,h,O),h=O+1):(Fl(f,c,O+1,v),v=O)}}function hu(f,c,h){const v=f[c];f[c]=f[h],f[h]=v}Re("FeaturePositionMap",ph);class zl{constructor(c,h){this.gl=c.gl,this.location=h}}class Cd extends zl{constructor(c,h){super(c,h),this.current=0}set(c){this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))}}class hs extends zl{constructor(c,h){super(c,h),this.current=[0,0,0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3]))}}class As extends zl{constructor(c,h){super(c,h),this.current=Dr.transparent}set(c){c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a))}}const Qc=new Float32Array(16);function Xa(f){return[qi(255*f.r,255*f.g),qi(255*f.b,255*f.a)]}class cp{constructor(c,h,v){this.value=c,this.uniformNames=h.map(w=>`u_${w}`),this.type=v}setUniform(c,h,v){c.set(v.constantOr(this.value))}getBinding(c,h,v){return this.type==="color"?new As(c,h):new Cd(c,h)}}class nf{constructor(c,h){this.uniformNames=h.map(v=>`u_${v}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(c,h){this.pixelRatioFrom=h.pixelRatio,this.pixelRatioTo=c.pixelRatio,this.patternFrom=h.tlbr,this.patternTo=c.tlbr}setUniform(c,h,v,w){const I=w==="u_pattern_to"?this.patternTo:w==="u_pattern_from"?this.patternFrom:w==="u_pixel_ratio_to"?this.pixelRatioTo:w==="u_pixel_ratio_from"?this.pixelRatioFrom:null;I&&c.set(I)}getBinding(c,h,v){return v.substr(0,9)==="u_pattern"?new hs(c,h):new Cd(c,h)}}class Iu{constructor(c,h,v,w){this.expression=c,this.type=v,this.maxValue=0,this.paintVertexAttributes=h.map(I=>({name:`a_${I}`,type:"Float32",components:v==="color"?2:1,offset:0})),this.paintVertexArray=new w}populatePaintArray(c,h,v){const w=this.paintVertexArray.length,I=this.expression.evaluate(new En(0,v),h,{},v.canonical,[],v.formattedSection);this.paintVertexArray.resize(c),this._setPaintValue(w,c,I)}updatePaintArray(c,h,v,w,I){const O=this.expression.evaluate(new En(0,I),v,w);this._setPaintValue(c,h,O)}_setPaintValue(c,h,v){if(this.type==="color"){const w=Xa(v);for(let I=c;I<h;I++)this.paintVertexArray.emplace(I,w[0],w[1])}else{for(let w=c;w<h;w++)this.paintVertexArray.emplace(w,v);this.maxValue=Math.max(this.maxValue,Math.abs(v))}}upload(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class fu{constructor(c,h,v,w,I,O){this.expression=c,this.uniformNames=h.map(z=>`u_${z}_t`),this.type=v,this.useIntegerZoom=w,this.zoom=I,this.maxValue=0,this.paintVertexAttributes=h.map(z=>({name:`a_${z}`,type:"Float32",components:v==="color"?4:2,offset:0})),this.paintVertexArray=new O}populatePaintArray(c,h,v){const w=this.expression.evaluate(new En(this.zoom,v),h,{},v.canonical,[],v.formattedSection),I=this.expression.evaluate(new En(this.zoom+1,v),h,{},v.canonical,[],v.formattedSection),O=this.paintVertexArray.length;this.paintVertexArray.resize(c),this._setPaintValue(O,c,w,I)}updatePaintArray(c,h,v,w,I){const O=this.expression.evaluate(new En(this.zoom,I),v,w),z=this.expression.evaluate(new En(this.zoom+1,I),v,w);this._setPaintValue(c,h,O,z)}_setPaintValue(c,h,v,w){if(this.type==="color"){const I=Xa(v),O=Xa(w);for(let z=c;z<h;z++)this.paintVertexArray.emplace(z,I[0],I[1],O[0],O[1])}else{for(let I=c;I<h;I++)this.paintVertexArray.emplace(I,v,w);this.maxValue=Math.max(this.maxValue,Math.abs(v),Math.abs(w))}}upload(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(c,h){const v=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,w=Ce(this.expression.interpolationFactor(v,this.zoom,this.zoom+1),0,1);c.set(w)}getBinding(c,h,v){return new Cd(c,h)}}class kd{constructor(c,h,v,w,I,O){this.expression=c,this.type=h,this.useIntegerZoom=v,this.zoom=w,this.layerId=O,this.zoomInPaintVertexArray=new I,this.zoomOutPaintVertexArray=new I}populatePaintArray(c,h,v){const w=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(c),this.zoomOutPaintVertexArray.resize(c),this._setPaintValues(w,c,h.patterns&&h.patterns[this.layerId],v.imagePositions)}updatePaintArray(c,h,v,w,I){this._setPaintValues(c,h,v.patterns&&v.patterns[this.layerId],I.imagePositions)}_setPaintValues(c,h,v,w){if(!w||!v)return;const{min:I,mid:O,max:z}=v,V=w[I],J=w[O],ne=w[z];if(V&&J&&ne)for(let me=c;me<h;me++)this.zoomInPaintVertexArray.emplace(me,J.tl[0],J.tl[1],J.br[0],J.br[1],V.tl[0],V.tl[1],V.br[0],V.br[1],J.pixelRatio,V.pixelRatio),this.zoomOutPaintVertexArray.emplace(me,J.tl[0],J.tl[1],J.br[0],J.br[1],ne.tl[0],ne.tl[1],ne.br[0],ne.br[1],J.pixelRatio,ne.pixelRatio)}upload(c){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=c.createVertexBuffer(this.zoomInPaintVertexArray,ya.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=c.createVertexBuffer(this.zoomOutPaintVertexArray,ya.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Id{constructor(c,h,v){this.binders={},this._buffers=[];const w=[];for(const I in c.paint._values){if(!v(I))continue;const O=c.paint.get(I);if(!(O instanceof Wo&&Kc(O.property.specification)))continue;const z=V_(I,c.type),V=O.value,J=O.property.specification.type,ne=O.property.useIntegerZoom,me=O.property.specification["property-type"],Ee=me==="cross-faded"||me==="cross-faded-data-driven";if(V.kind==="constant")this.binders[I]=Ee?new nf(V.value,z):new cp(V.value,z,J),w.push(`/u_${I}`);else if(V.kind==="source"||Ee){const je=og(I,J,"source");this.binders[I]=Ee?new kd(V,J,ne,h,je,c.id):new Iu(V,z,J,je),w.push(`/a_${I}`)}else{const je=og(I,J,"composite");this.binders[I]=new fu(V,z,J,ne,h,je),w.push(`/z_${I}`)}}this.cacheKey=w.sort().join("")}getMaxValue(c){const h=this.binders[c];return h instanceof Iu||h instanceof fu?h.maxValue:0}populatePaintArrays(c,h,v){for(const w in this.binders){const I=this.binders[w];(I instanceof Iu||I instanceof fu||I instanceof kd)&&I.populatePaintArray(c,h,v)}}setConstantPatternPositions(c,h){for(const v in this.binders){const w=this.binders[v];w instanceof nf&&w.setConstantPatternPositions(c,h)}}updatePaintArrays(c,h,v,w,I){let O=!1;for(const z in c){const V=h.getPositions(z);for(const J of V){const ne=v.feature(J.index);for(const me in this.binders){const Ee=this.binders[me];if((Ee instanceof Iu||Ee instanceof fu||Ee instanceof kd)&&Ee.expression.isStateDependent===!0){const je=w.paint.get(me);Ee.expression=je.value,Ee.updatePaintArray(J.start,J.end,ne,c[z],I),O=!0}}}}return O}defines(){const c=[];for(const h in this.binders){const v=this.binders[h];(v instanceof cp||v instanceof nf)&&c.push(...v.uniformNames.map(w=>`#define HAS_UNIFORM_${w}`))}return c}getBinderAttributes(){const c=[];for(const h in this.binders){const v=this.binders[h];if(v instanceof Iu||v instanceof fu)for(let w=0;w<v.paintVertexAttributes.length;w++)c.push(v.paintVertexAttributes[w].name);else if(v instanceof kd)for(let w=0;w<ya.members.length;w++)c.push(ya.members[w].name)}return c}getBinderUniforms(){const c=[];for(const h in this.binders){const v=this.binders[h];if(v instanceof cp||v instanceof nf||v instanceof fu)for(const w of v.uniformNames)c.push(w)}return c}getPaintVertexBuffers(){return this._buffers}getUniforms(c,h){const v=[];for(const w in this.binders){const I=this.binders[w];if(I instanceof cp||I instanceof nf||I instanceof fu){for(const O of I.uniformNames)if(h[O]){const z=I.getBinding(c,h[O],O);v.push({name:O,property:w,binding:z})}}}return v}setUniforms(c,h,v,w){for(const{name:I,property:O,binding:z}of h)this.binders[O].setUniform(z,w,v.get(O),I)}updatePaintBuffers(c){this._buffers=[];for(const h in this.binders){const v=this.binders[h];if(c&&v instanceof kd){const w=c.fromScale===2?v.zoomInPaintVertexBuffer:v.zoomOutPaintVertexBuffer;w&&this._buffers.push(w)}else(v instanceof Iu||v instanceof fu)&&v.paintVertexBuffer&&this._buffers.push(v.paintVertexBuffer)}}upload(c){for(const h in this.binders){const v=this.binders[h];(v instanceof Iu||v instanceof fu||v instanceof kd)&&v.upload(c)}this.updatePaintBuffers()}destroy(){for(const c in this.binders){const h=this.binders[c];(h instanceof Iu||h instanceof fu||h instanceof kd)&&h.destroy()}}}class Cc{constructor(c,h,v=()=>!0){this.programConfigurations={};for(const w of c)this.programConfigurations[w.id]=new Id(w,h,v);this.needsUpload=!1,this._featureMap=new ph,this._bufferOffset=0}populatePaintArrays(c,h,v,w){for(const I in this.programConfigurations)this.programConfigurations[I].populatePaintArrays(c,h,w);h.id!==void 0&&this._featureMap.add(h.id,v,this._bufferOffset,c),this._bufferOffset=c,this.needsUpload=!0}updatePaintArrays(c,h,v,w){for(const I of v)this.needsUpload=this.programConfigurations[I.id].updatePaintArrays(c,this._featureMap,h,I,w)||this.needsUpload}get(c){return this.programConfigurations[c]}upload(c){if(this.needsUpload){for(const h in this.programConfigurations)this.programConfigurations[h].upload(c);this.needsUpload=!1}}destroy(){for(const c in this.programConfigurations)this.programConfigurations[c].destroy()}}function V_(f,c){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[f]||[f.replace(`${c}-`,"").replace(/-/g,"_")]}function og(f,c,h){const v={color:{source:ds,composite:ce},number:{source:k,composite:ds}},w=function(I){return{"line-pattern":{source:Gr,composite:Gr},"fill-pattern":{source:Gr,composite:Gr},"fill-extrusion-pattern":{source:Gr,composite:Gr}}[I]}(f);return w&&w[h]||v[c][h]}Re("ConstantBinder",cp),Re("CrossFadedConstantBinder",nf),Re("SourceExpressionBinder",Iu),Re("CrossFadedCompositeBinder",kd),Re("CompositeExpressionBinder",fu),Re("ProgramConfiguration",Id,{omit:["_buffers"]}),Re("ProgramConfigurationSet",Cc);const am=Math.pow(2,14)-1,up=-am-1;function Od(f){const c=fe/f.extent,h=f.loadGeometry();for(let v=0;v<h.length;v++){const w=h[v];for(let I=0;I<w.length;I++){const O=w[I],z=Math.round(O.x*c),V=Math.round(O.y*c);O.x=Ce(z,up,am),O.y=Ce(V,up,am),(z<O.x||z>O.x+1||V<O.y||V>O.y+1)&&Xe("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return h}function nd(f,c){return{type:f.type,id:f.id,properties:f.properties,geometry:c?Od(f):[]}}const ox=-32768;function LS(f,c,h,v,w){f.emplaceBack(ox+8*c+v,ox+8*h+w)}class ag{constructor(c){this.zoom=c.zoom,this.globalState=c.globalState,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(h=>h.id),this.index=c.index,this.hasPattern=!1,this.layoutVertexArray=new Wt,this.indexArray=new go,this.segments=new ei,this.programConfigurations=new Cc(c.layers,c.zoom),this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(c,h,v){const w=this.layers[0],I=[];let O=null,z=!1,V=w.type==="heatmap";if(w.type==="circle"){const ne=w;O=ne.layout.get("circle-sort-key"),z=!O.isConstant(),V=V||ne.paint.get("circle-pitch-alignment")==="map"}const J=V?h.subdivisionGranularity.circle:1;for(const{feature:ne,id:me,index:Ee,sourceLayerIndex:je}of c){const Fe=this.layers[0]._featureFilter.needGeometry,He=nd(ne,Fe);if(!this.layers[0]._featureFilter.filter(new En(this.zoom,{globalState:this.globalState}),He,v))continue;const st=z?O.evaluate(He,{},v):void 0,yt={id:me,properties:ne.properties,type:ne.type,sourceLayerIndex:je,index:Ee,geometry:Fe?He.geometry:Od(ne),patterns:{},sortKey:st};I.push(yt)}z&&I.sort((ne,me)=>ne.sortKey-me.sortKey);for(const ne of I){const{geometry:me,index:Ee,sourceLayerIndex:je}=ne,Fe=c[Ee].feature;this.addFeature(ne,me,Ee,v,J),h.featureIndex.insert(Fe,me,Ee,je,this.index)}}update(c,h,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,h,this.stateDependentLayers,{imagePositions:v,globalState:this.globalState})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,To),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(c,h,v,w,I=1){let O;switch(I){case 1:O=[0,7];break;case 3:O=[0,2,5,7];break;case 5:O=[0,1,3,4,6,7];break;case 7:O=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${I}; valid values are 1, 3, 5, 7.`)}const z=O.length;for(const V of h)for(const J of V){const ne=J.x,me=J.y;if(ne<0||ne>=fe||me<0||me>=fe)continue;const Ee=this.segments.prepareSegment(z*z,this.layoutVertexArray,this.indexArray,c.sortKey),je=Ee.vertexLength;for(let Fe=0;Fe<z;Fe++)for(let He=0;He<z;He++)LS(this.layoutVertexArray,ne,me,O[He],O[Fe]);for(let Fe=0;Fe<z-1;Fe++)for(let He=0;He<z-1;He++){const st=je+Fe*z+He,yt=je+(Fe+1)*z+He;this.indexArray.emplaceBack(st,yt+1,st+1),this.indexArray.emplaceBack(st,yt,yt+1)}Ee.vertexLength+=z*z,Ee.primitiveLength+=(z-1)*(z-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,v,{imagePositions:{},canonical:w,globalState:this.globalState})}}function ax(f,c){for(let h=0;h<f.length;h++)if(sm(c,f[h]))return!0;for(let h=0;h<c.length;h++)if(sm(f,c[h]))return!0;return!!U0(f,c)}function DS(f,c,h){return!!sm(f,c)||!!V0(c,f,h)}function sx(f,c){if(f.length===1)return G_(c,f[0]);for(let h=0;h<c.length;h++){const v=c[h];for(let w=0;w<v.length;w++)if(sm(f,v[w]))return!0}for(let h=0;h<f.length;h++)if(G_(c,f[h]))return!0;for(let h=0;h<c.length;h++)if(U0(f,c[h]))return!0;return!1}function W_(f,c,h){if(f.length>1){if(U0(f,c))return!0;for(let v=0;v<c.length;v++)if(V0(c[v],f,h))return!0}for(let v=0;v<f.length;v++)if(V0(f[v],c,h))return!0;return!1}function U0(f,c){if(f.length===0||c.length===0)return!1;for(let h=0;h<f.length-1;h++){const v=f[h],w=f[h+1];for(let I=0;I<c.length-1;I++)if($S(v,w,c[I],c[I+1]))return!0}return!1}function $S(f,c,h,v){return Ne(f,h,v)!==Ne(c,h,v)&&Ne(f,c,h)!==Ne(f,c,v)}function V0(f,c,h){const v=h*h;if(c.length===1)return f.distSqr(c[0])<v;for(let w=1;w<c.length;w++)if(lx(f,c[w-1],c[w])<v)return!0;return!1}function lx(f,c,h){const v=c.distSqr(h);if(v===0)return f.distSqr(c);const w=((f.x-c.x)*(h.x-c.x)+(f.y-c.y)*(h.y-c.y))/v;return f.distSqr(w<0?c:w>1?h:h.sub(c)._mult(w)._add(c))}function G_(f,c){let h,v,w,I=!1;for(let O=0;O<f.length;O++){h=f[O];for(let z=0,V=h.length-1;z<h.length;V=z++)v=h[z],w=h[V],v.y>c.y!=w.y>c.y&&c.x<(w.x-v.x)*(c.y-v.y)/(w.y-v.y)+v.x&&(I=!I)}return I}function sm(f,c){let h=!1;for(let v=0,w=f.length-1;v<f.length;w=v++){const I=f[v],O=f[w];I.y>c.y!=O.y>c.y&&c.x<(O.x-I.x)*(c.y-I.y)/(O.y-I.y)+I.x&&(h=!h)}return h}function NS(f,c,h){const v=h[0],w=h[2];if(f.x<v.x&&c.x<v.x||f.x>w.x&&c.x>w.x||f.y<v.y&&c.y<v.y||f.y>w.y&&c.y>w.y)return!1;const I=Ne(f,c,h[0]);return I!==Ne(f,c,h[1])||I!==Ne(f,c,h[2])||I!==Ne(f,c,h[3])}function sg(f,c,h){const v=c.paint.get(f).value;return v.kind==="constant"?v.value:h.programConfigurations.get(c.id).getMaxValue(f)}function W0(f){return Math.sqrt(f[0]*f[0]+f[1]*f[1])}function q_(f,c,h,v,w){if(!c[0]&&!c[1])return f;const I=u.convert(c)._mult(w);h==="viewport"&&I._rotate(-v);const O=[];for(let z=0;z<f.length;z++)O.push(f[z].sub(I));return O}let cx,ux;Re("CircleBucket",ag,{omit:["layers"]});var lg={get paint(){return ux=ux||new wi({"circle-radius":new xn($t.paint_circle["circle-radius"]),"circle-color":new xn($t.paint_circle["circle-color"]),"circle-blur":new xn($t.paint_circle["circle-blur"]),"circle-opacity":new xn($t.paint_circle["circle-opacity"]),"circle-translate":new on($t.paint_circle["circle-translate"]),"circle-translate-anchor":new on($t.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new on($t.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new on($t.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new xn($t.paint_circle["circle-stroke-width"]),"circle-stroke-color":new xn($t.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new xn($t.paint_circle["circle-stroke-opacity"])})},get layout(){return cx=cx||new wi({"circle-sort-key":new xn($t.layout_circle["circle-sort-key"])})}};class jS extends Li{constructor(c){super(c,lg)}createBucket(c){return new ag(c)}queryRadius(c){const h=c;return sg("circle-radius",this,h)+sg("circle-stroke-width",this,h)+W0(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:c,feature:h,featureState:v,geometry:w,transform:I,pixelsToTileUnits:O,unwrappedTileID:z,getElevation:V}){const J=q_(c,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-I.bearingInRadians,O),ne=this.paint.get("circle-radius").evaluate(h,v)+this.paint.get("circle-stroke-width").evaluate(h,v),me=this.paint.get("circle-pitch-alignment")==="map",Ee=me?J:function(Fe,He,st,yt){return Fe.map(Xt=>dx(Xt,He,st,yt))}(J,I,z,V),je=me?ne*O:ne;for(const Fe of w)for(const He of Fe){const st=me?He:dx(He,I,z,V);let yt=je;const Xt=I.projectTileCoordinates(He.x,He.y,z,V).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?yt*=Xt/I.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(yt*=I.cameraToCenterDistance/Xt),DS(Ee,st,yt))return!0}return!1}}function dx(f,c,h,v){const w=c.projectTileCoordinates(f.x,f.y,h,v).point;return new u((.5*w.x+.5)*c.width,(.5*-w.y+.5)*c.height)}class hx extends ag{}let fx;Re("HeatmapBucket",hx,{omit:["layers"]});var RS={get paint(){return fx=fx||new wi({"heatmap-radius":new xn($t.paint_heatmap["heatmap-radius"]),"heatmap-weight":new xn($t.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new on($t.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Fi($t.paint_heatmap["heatmap-color"]),"heatmap-opacity":new on($t.paint_heatmap["heatmap-opacity"])})}};function G0(f,{width:c,height:h},v,w){if(w){if(w instanceof Uint8ClampedArray)w=new Uint8Array(w.buffer);else if(w.length!==c*h*v)throw new RangeError(`mismatched image size. expected: ${w.length} but got: ${c*h*v}`)}else w=new Uint8Array(c*h*v);return f.width=c,f.height=h,f.data=w,f}function px(f,{width:c,height:h},v){if(c===f.width&&h===f.height)return;const w=G0({},{width:c,height:h},v);cg(f,w,{x:0,y:0},{x:0,y:0},{width:Math.min(f.width,c),height:Math.min(f.height,h)},v),f.width=c,f.height=h,f.data=w.data}function cg(f,c,h,v,w,I){if(w.width===0||w.height===0)return c;if(w.width>f.width||w.height>f.height||h.x>f.width-w.width||h.y>f.height-w.height)throw new RangeError("out of range source coordinates for image copy");if(w.width>c.width||w.height>c.height||v.x>c.width-w.width||v.y>c.height-w.height)throw new RangeError("out of range destination coordinates for image copy");const O=f.data,z=c.data;if(O===z)throw new Error("srcData equals dstData, so image is already copied");for(let V=0;V<w.height;V++){const J=((h.y+V)*f.width+h.x)*I,ne=((v.y+V)*c.width+v.x)*I;for(let me=0;me<w.width*I;me++)z[ne+me]=O[J+me]}return c}class H_{constructor(c,h){G0(this,c,1,h)}resize(c){px(this,c,1)}clone(){return new H_({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(c,h,v,w,I){cg(c,h,v,w,I,1)}}class kc{constructor(c,h){G0(this,c,4,h)}resize(c){px(this,c,4)}replace(c,h){h?this.data.set(c):this.data=c instanceof Uint8ClampedArray?new Uint8Array(c.buffer):c}clone(){return new kc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(c,h,v,w,I){cg(c,h,v,w,I,4)}setPixel(c,h,v){const w=4*(c*this.width+h);this.data[w+0]=Math.round(255*v.r/v.a),this.data[w+1]=Math.round(255*v.g/v.a),this.data[w+2]=Math.round(255*v.b/v.a),this.data[w+3]=Math.round(255*v.a)}}function mx(f){const c={},h=f.resolution||256,v=f.clips?f.clips.length:1,w=f.image||new kc({width:h,height:v});if(Math.log(h)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${h}`);const I=(O,z,V)=>{c[f.evaluationKey]=V;const J=f.expression.evaluate(c);w.setPixel(O/4/h,z/4,J)};if(f.clips)for(let O=0,z=0;O<v;++O,z+=4*h)for(let V=0,J=0;V<h;V++,J+=4){const ne=V/(h-1),{start:me,end:Ee}=f.clips[O];I(z,J,me*(1-ne)+Ee*ne)}else for(let O=0,z=0;O<h;O++,z+=4)I(0,z,O/(h-1));return w}Re("AlphaImage",H_),Re("RGBAImage",kc);const q0="big-fb";class FS extends Li{createBucket(c){return new hx(c)}constructor(c){super(c,RS),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=mx({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(q0)&&this.heatmapFbos.delete(q0)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let gx;var _x={get paint(){return gx=gx||new wi({"hillshade-illumination-direction":new on($t.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new on($t.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new on($t.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new on($t.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new on($t.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new on($t.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new on($t.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new on($t.paint_hillshade["hillshade-method"])})}};class zS extends Li{constructor(c){super(c,_x),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let c=this.paint.get("hillshade-illumination-direction").values,h=this.paint.get("hillshade-illumination-altitude").values,v=this.paint.get("hillshade-highlight-color").values,w=this.paint.get("hillshade-shadow-color").values;const I=Math.max(c.length,h.length,v.length,w.length);c=c.concat(Array(I-c.length).fill(c.at(-1))),h=h.concat(Array(I-h.length).fill(h.at(-1))),v=v.concat(Array(I-v.length).fill(v.at(-1))),w=w.concat(Array(I-w.length).fill(w.at(-1)));const O=h.map(wr);return{directionRadians:c.map(wr),altitudeRadians:O,shadowColor:w,highlightColor:v}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let yx;var vx={get paint(){return yx=yx||new wi({"color-relief-opacity":new on($t["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new Fi($t["paint_color-relief"]["color-relief-color"])})}};class H0{constructor(c,h,v,w){this.context=c,this.format=v,this.texture=c.gl.createTexture(),this.update(h,w)}update(c,h,v){const{width:w,height:I}=c,O=!(this.size&&this.size[0]===w&&this.size[1]===I||v),{context:z}=this,{gl:V}=z;if(this.useMipmap=!!(h&&h.useMipmap),V.bindTexture(V.TEXTURE_2D,this.texture),z.pixelStoreUnpackFlipY.set(!1),z.pixelStoreUnpack.set(1),z.pixelStoreUnpackPremultiplyAlpha.set(this.format===V.RGBA&&(!h||h.premultiply!==!1)),O)this.size=[w,I],c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement||c instanceof ImageData||kt(c)?V.texImage2D(V.TEXTURE_2D,0,this.format,this.format,V.UNSIGNED_BYTE,c):V.texImage2D(V.TEXTURE_2D,0,this.format,w,I,0,this.format,V.UNSIGNED_BYTE,c.data);else{const{x:J,y:ne}=v||{x:0,y:0};c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement||c instanceof ImageData||kt(c)?V.texSubImage2D(V.TEXTURE_2D,0,J,ne,V.RGBA,V.UNSIGNED_BYTE,c):V.texSubImage2D(V.TEXTURE_2D,0,J,ne,w,I,V.RGBA,V.UNSIGNED_BYTE,c.data)}this.useMipmap&&this.isSizePowerOfTwo()&&V.generateMipmap(V.TEXTURE_2D),z.pixelStoreUnpackFlipY.setDefault(),z.pixelStoreUnpack.setDefault(),z.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(c,h,v){const{context:w}=this,{gl:I}=w;I.bindTexture(I.TEXTURE_2D,this.texture),v!==I.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(v=I.LINEAR),c!==this.filter&&(I.texParameteri(I.TEXTURE_2D,I.TEXTURE_MAG_FILTER,c),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_MIN_FILTER,v||c),this.filter=c),h!==this.wrap&&(I.texParameteri(I.TEXTURE_2D,I.TEXTURE_WRAP_S,h),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_WRAP_T,h),this.wrap=h)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:c}=this.context;c.deleteTexture(this.texture),this.texture=null}}class bx{constructor(c,h,v,w=1,I=1,O=1,z=0){if(this.uid=c,h.height!==h.width)throw new RangeError("DEM tiles must be square");if(v&&!["mapbox","terrarium","custom"].includes(v))return void Xe(`"${v}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=h.height;const V=this.dim=h.height-2;switch(this.data=new Uint32Array(h.data.buffer),v){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=w,this.greenFactor=I,this.blueFactor=O,this.baseShift=z;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let J=0;J<V;J++)this.data[this._idx(-1,J)]=this.data[this._idx(0,J)],this.data[this._idx(V,J)]=this.data[this._idx(V-1,J)],this.data[this._idx(J,-1)]=this.data[this._idx(J,0)],this.data[this._idx(J,V)]=this.data[this._idx(J,V-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(V,-1)]=this.data[this._idx(V-1,0)],this.data[this._idx(-1,V)]=this.data[this._idx(0,V-1)],this.data[this._idx(V,V)]=this.data[this._idx(V-1,V-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let J=0;J<V;J++)for(let ne=0;ne<V;ne++){const me=this.get(J,ne);me>this.max&&(this.max=me),me<this.min&&(this.min=me)}}get(c,h){const v=new Uint8Array(this.data.buffer),w=4*this._idx(c,h);return this.unpack(v[w],v[w+1],v[w+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(c,h){if(c<-1||c>=this.dim+1||h<-1||h>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(h+1)*this.stride+(c+1)}unpack(c,h,v){return c*this.redFactor+h*this.greenFactor+v*this.blueFactor-this.baseShift}pack(c){return K0(c,this.getUnpackVector())}getPixels(){return new kc({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(c,h,v){if(this.dim!==c.dim)throw new Error("dem dimension mismatch");let w=h*this.dim,I=h*this.dim+this.dim,O=v*this.dim,z=v*this.dim+this.dim;switch(h){case-1:w=I-1;break;case 1:I=w+1}switch(v){case-1:O=z-1;break;case 1:z=O+1}const V=-h*this.dim,J=-v*this.dim;for(let ne=O;ne<z;ne++)for(let me=w;me<I;me++)this.data[this._idx(me,ne)]=c.data[this._idx(me+V,ne+J)]}}function K0(f,c){const h=c[0],v=c[1],w=c[2],I=c[3],O=Math.min(h,v,w),z=Math.round((f+I)/O);return{r:Math.floor(z*O/h)%256,g:Math.floor(z*O/v)%256,b:Math.floor(z*O/w)%256}}Re("DEMData",bx);class BS extends Li{constructor(c){super(c,vx)}_createColorRamp(c){const h={elevationStops:[],colorStops:[]},v=this._transitionablePaint._values["color-relief-color"].value.expression;if(v instanceof ku&&v._styleExpression.expression instanceof vn){this.colorRampExpression=v;const O=v._styleExpression.expression;h.elevationStops=O.labels,h.colorStops=[];for(const z of h.elevationStops)h.colorStops.push(O.evaluate({globals:{elevation:z}}))}if(h.elevationStops.length<1&&(h.elevationStops=[0],h.colorStops=[Dr.transparent]),h.elevationStops.length<2&&(h.elevationStops.push(h.elevationStops[0]+1),h.colorStops.push(h.colorStops[0])),h.elevationStops.length<=c)return h;const w={elevationStops:[],colorStops:[]},I=(h.elevationStops.length-1)/(c-1);for(let O=0;O<h.elevationStops.length-.5;O+=I)w.elevationStops.push(h.elevationStops[Math.round(O)]),w.colorStops.push(h.colorStops[Math.round(O)]);return Xe(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),w}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(c,h,v){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const w=this._createColorRamp(h),I=new kc({width:w.colorStops.length,height:1}),O=new kc({width:w.colorStops.length,height:1});for(let z=0;z<w.elevationStops.length;z++){const V=K0(w.elevationStops[z],v);O.setPixel(0,z,new Dr(V.r/255,V.g/255,V.b/255,1)),I.setPixel(0,z,w.colorStops[z])}return this.colorRampTextures={elevationTexture:new H0(c,O,c.gl.RGBA),colorTexture:new H0(c,I,c.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const US=no([{name:"a_pos",components:2,type:"Int16"}],4),{members:xx}=US;function Z0(f,c,h){const v=h.patternDependencies;let w=!1;for(const I of c){const O=I.paint.get(`${f}-pattern`);O.isConstant()||(w=!0);const z=O.constantOr(null);z&&(w=!0,v[z.to]=!0,v[z.from]=!0)}return w}function X0(f,c,h,v,w){const I=w.patternDependencies;for(const O of c){const z=O.paint.get(`${f}-pattern`).value;if(z.kind!=="constant"){let V=z.evaluate({zoom:v-1},h,{},w.availableImages),J=z.evaluate({zoom:v},h,{},w.availableImages),ne=z.evaluate({zoom:v+1},h,{},w.availableImages);V=V&&V.name?V.name:V,J=J&&J.name?J.name:J,ne=ne&&ne.name?ne.name:ne,I[V]=!0,I[J]=!0,I[ne]=!0,h.patterns[O.id]={min:V,mid:J,max:ne}}}return h}function K_(f,c,h,v,w){let I;if(w===function(O,z,V,J){let ne=0;for(let me=z,Ee=V-J;me<V;me+=J)ne+=(O[Ee]-O[me])*(O[me+1]+O[Ee+1]),Ee=me;return ne}(f,c,h,v)>0)for(let O=c;O<h;O+=v)I=Tx(O/v|0,f[O],f[O+1],I);else for(let O=h-v;O>=c;O-=v)I=Tx(O/v|0,f[O],f[O+1],I);return I&&hp(I,I.next)&&(hg(I),I=I.next),I}function dp(f,c){if(!f)return f;c||(c=f);let h,v=f;do if(h=!1,v.steiner||!hp(v,v.next)&&Ya(v.prev,v,v.next)!==0)v=v.next;else{if(hg(v),v=c=v.prev,v===v.next)break;h=!0}while(h||v!==c);return c}function ug(f,c,h,v,w,I,O){if(!f)return;!O&&I&&function(V,J,ne,me){let Ee=V;do Ee.z===0&&(Ee.z=Z_(Ee.x,Ee.y,J,ne,me)),Ee.prevZ=Ee.prev,Ee.nextZ=Ee.next,Ee=Ee.next;while(Ee!==V);Ee.prevZ.nextZ=null,Ee.prevZ=null,function(je){let Fe,He=1;do{let st,yt=je;je=null;let Xt=null;for(Fe=0;yt;){Fe++;let Ct=yt,Rt=0;for(let vr=0;vr<He&&(Rt++,Ct=Ct.nextZ,Ct);vr++);let lr=He;for(;Rt>0||lr>0&&Ct;)Rt!==0&&(lr===0||!Ct||yt.z<=Ct.z)?(st=yt,yt=yt.nextZ,Rt--):(st=Ct,Ct=Ct.nextZ,lr--),Xt?Xt.nextZ=st:je=st,st.prevZ=Xt,Xt=st;yt=Ct}Xt.nextZ=null,He*=2}while(Fe>1)}(Ee)}(f,v,w,I);let z=f;for(;f.prev!==f.next;){const V=f.prev,J=f.next;if(I?WS(f,v,w,I):VS(f))c.push(V.i,f.i,J.i),hg(f),f=J.next,z=J.next;else if((f=J)===z){O?O===1?ug(f=wx(dp(f),c),c,h,v,w,I,2):O===2&&Y0(f,c,h,v,w,I):ug(dp(f),c,h,v,w,I,1);break}}}function VS(f){const c=f.prev,h=f,v=f.next;if(Ya(c,h,v)>=0)return!1;const w=c.x,I=h.x,O=v.x,z=c.y,V=h.y,J=v.y,ne=Math.min(w,I,O),me=Math.min(z,V,J),Ee=Math.max(w,I,O),je=Math.max(z,V,J);let Fe=v.next;for(;Fe!==c;){if(Fe.x>=ne&&Fe.x<=Ee&&Fe.y>=me&&Fe.y<=je&&lm(w,z,I,V,O,J,Fe.x,Fe.y)&&Ya(Fe.prev,Fe,Fe.next)>=0)return!1;Fe=Fe.next}return!0}function WS(f,c,h,v){const w=f.prev,I=f,O=f.next;if(Ya(w,I,O)>=0)return!1;const z=w.x,V=I.x,J=O.x,ne=w.y,me=I.y,Ee=O.y,je=Math.min(z,V,J),Fe=Math.min(ne,me,Ee),He=Math.max(z,V,J),st=Math.max(ne,me,Ee),yt=Z_(je,Fe,c,h,v),Xt=Z_(He,st,c,h,v);let Ct=f.prevZ,Rt=f.nextZ;for(;Ct&&Ct.z>=yt&&Rt&&Rt.z<=Xt;){if(Ct.x>=je&&Ct.x<=He&&Ct.y>=Fe&&Ct.y<=st&&Ct!==w&&Ct!==O&&lm(z,ne,V,me,J,Ee,Ct.x,Ct.y)&&Ya(Ct.prev,Ct,Ct.next)>=0||(Ct=Ct.prevZ,Rt.x>=je&&Rt.x<=He&&Rt.y>=Fe&&Rt.y<=st&&Rt!==w&&Rt!==O&&lm(z,ne,V,me,J,Ee,Rt.x,Rt.y)&&Ya(Rt.prev,Rt,Rt.next)>=0))return!1;Rt=Rt.nextZ}for(;Ct&&Ct.z>=yt;){if(Ct.x>=je&&Ct.x<=He&&Ct.y>=Fe&&Ct.y<=st&&Ct!==w&&Ct!==O&&lm(z,ne,V,me,J,Ee,Ct.x,Ct.y)&&Ya(Ct.prev,Ct,Ct.next)>=0)return!1;Ct=Ct.prevZ}for(;Rt&&Rt.z<=Xt;){if(Rt.x>=je&&Rt.x<=He&&Rt.y>=Fe&&Rt.y<=st&&Rt!==w&&Rt!==O&&lm(z,ne,V,me,J,Ee,Rt.x,Rt.y)&&Ya(Rt.prev,Rt,Rt.next)>=0)return!1;Rt=Rt.nextZ}return!0}function wx(f,c){let h=f;do{const v=h.prev,w=h.next.next;!hp(v,w)&&ZS(v,h,h.next,w)&&fp(v,w)&&fp(w,v)&&(c.push(v.i,h.i,w.i),hg(h),hg(h.next),h=f=w),h=h.next}while(h!==f);return dp(h)}function Y0(f,c,h,v,w,I){let O=f;do{let z=O.next.next;for(;z!==O.prev;){if(O.i!==z.i&&KS(O,z)){let V=Sx(O,z);return O=dp(O,O.next),V=dp(V,V.next),ug(O,c,h,v,w,I,0),void ug(V,c,h,v,w,I,0)}z=z.next}O=O.next}while(O!==f)}function $k(f,c){let h=f.x-c.x;return h===0&&(h=f.y-c.y,h===0)&&(h=(f.next.y-f.y)/(f.next.x-f.x)-(c.next.y-c.y)/(c.next.x-c.x)),h}function GS(f,c){const h=function(w,I){let O=I;const z=w.x,V=w.y;let J,ne=-1/0;if(hp(w,O))return O;do{if(hp(w,O.next))return O.next;if(V<=O.y&&V>=O.next.y&&O.next.y!==O.y){const He=O.x+(V-O.y)*(O.next.x-O.x)/(O.next.y-O.y);if(He<=z&&He>ne&&(ne=He,J=O.x<O.next.x?O:O.next,He===z))return J}O=O.next}while(O!==I);if(!J)return null;const me=J,Ee=J.x,je=J.y;let Fe=1/0;O=J;do{if(z>=O.x&&O.x>=Ee&&z!==O.x&&Mx(V<je?z:ne,V,Ee,je,V<je?ne:z,V,O.x,O.y)){const He=Math.abs(V-O.y)/(z-O.x);fp(O,w)&&(He<Fe||He===Fe&&(O.x>J.x||O.x===J.x&&qS(J,O)))&&(J=O,Fe=He)}O=O.next}while(O!==me);return J}(f,c);if(!h)return c;const v=Sx(h,f);return dp(v,v.next),dp(h,h.next)}function qS(f,c){return Ya(f.prev,f,c.prev)<0&&Ya(c.next,f,f.next)<0}function Z_(f,c,h,v,w){return(f=1431655765&((f=858993459&((f=252645135&((f=16711935&((f=(f-h)*w|0)|f<<8))|f<<4))|f<<2))|f<<1))|(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-v)*w|0)|c<<8))|c<<4))|c<<2))|c<<1))<<1}function HS(f){let c=f,h=f;do(c.x<h.x||c.x===h.x&&c.y<h.y)&&(h=c),c=c.next;while(c!==f);return h}function Mx(f,c,h,v,w,I,O,z){return(w-O)*(c-z)>=(f-O)*(I-z)&&(f-O)*(v-z)>=(h-O)*(c-z)&&(h-O)*(I-z)>=(w-O)*(v-z)}function lm(f,c,h,v,w,I,O,z){return!(f===O&&c===z)&&Mx(f,c,h,v,w,I,O,z)}function KS(f,c){return f.next.i!==c.i&&f.prev.i!==c.i&&!function(h,v){let w=h;do{if(w.i!==h.i&&w.next.i!==h.i&&w.i!==v.i&&w.next.i!==v.i&&ZS(w,w.next,h,v))return!0;w=w.next}while(w!==h);return!1}(f,c)&&(fp(f,c)&&fp(c,f)&&function(h,v){let w=h,I=!1;const O=(h.x+v.x)/2,z=(h.y+v.y)/2;do w.y>z!=w.next.y>z&&w.next.y!==w.y&&O<(w.next.x-w.x)*(z-w.y)/(w.next.y-w.y)+w.x&&(I=!I),w=w.next;while(w!==h);return I}(f,c)&&(Ya(f.prev,f,c.prev)||Ya(f,c.prev,c))||hp(f,c)&&Ya(f.prev,f,f.next)>0&&Ya(c.prev,c,c.next)>0)}function Ya(f,c,h){return(c.y-f.y)*(h.x-c.x)-(c.x-f.x)*(h.y-c.y)}function hp(f,c){return f.x===c.x&&f.y===c.y}function ZS(f,c,h,v){const w=dg(Ya(f,c,h)),I=dg(Ya(f,c,v)),O=dg(Ya(h,v,f)),z=dg(Ya(h,v,c));return w!==I&&O!==z||!(w!==0||!Q0(f,h,c))||!(I!==0||!Q0(f,v,c))||!(O!==0||!Q0(h,f,v))||!(z!==0||!Q0(h,c,v))}function Q0(f,c,h){return c.x<=Math.max(f.x,h.x)&&c.x>=Math.min(f.x,h.x)&&c.y<=Math.max(f.y,h.y)&&c.y>=Math.min(f.y,h.y)}function dg(f){return f>0?1:f<0?-1:0}function fp(f,c){return Ya(f.prev,f,f.next)<0?Ya(f,c,f.next)>=0&&Ya(f,f.prev,c)>=0:Ya(f,c,f.prev)<0||Ya(f,f.next,c)<0}function Sx(f,c){const h=fg(f.i,f.x,f.y),v=fg(c.i,c.x,c.y),w=f.next,I=c.prev;return f.next=c,c.prev=f,h.next=w,w.prev=h,v.next=h,h.prev=v,I.next=v,v.prev=I,v}function Tx(f,c,h,v){const w=fg(f,c,h);return v?(w.next=v.next,w.prev=v,v.next.prev=w,v.next=w):(w.prev=w,w.next=w),w}function hg(f){f.next.prev=f.prev,f.prev.next=f.next,f.prevZ&&(f.prevZ.nextZ=f.nextZ),f.nextZ&&(f.nextZ.prevZ=f.prevZ)}function fg(f,c,h){return{i:f,x:c,y:h,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class cm{constructor(c,h){if(h>c)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=c,this._minGranularity=h}getGranularityForZoomLevel(c){return Math.max(Math.floor(this._baseZoomGranularity/(1<<c)),this._minGranularity,1)}}class X_{constructor(c){this.fill=c.fill,this.line=c.line,this.tile=c.tile,this.stencil=c.stencil,this.circle=c.circle}}X_.noSubdivision=new X_({fill:new cm(0,0),line:new cm(0,0),tile:new cm(0,0),stencil:new cm(0,0),circle:1}),Re("SubdivisionGranularityExpression",cm),Re("SubdivisionGranularitySetting",X_);const um=-32768,pp=32767;class XS{constructor(c,h){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=c,this._granularityCellSize=fe/c,this._canonical=h}_getKey(c,h){return(c+=32768)<<16|h+32768}_vertexToIndex(c,h){if(c<-32768||h<-32768||c>32767||h>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const v=0|Math.round(c),w=0|Math.round(h),I=this._getKey(v,w);if(this._vertexDictionary.has(I))return this._vertexDictionary.get(I);const O=this._vertexBuffer.length/2;return this._vertexDictionary.set(I,O),this._vertexBuffer.push(v,w),O}_subdivideTrianglesScanline(c){if(this._granularity<2)return function(w,I){const O=[];for(let z=0;z<I.length;z+=3){const V=I[z],J=I[z+1],ne=I[z+2],me=w[2*V],Ee=w[2*V+1];(w[2*J]-me)*(w[2*ne+1]-Ee)-(w[2*J+1]-Ee)*(w[2*ne]-me)>0?(O.push(V),O.push(ne),O.push(J)):(O.push(V),O.push(J),O.push(ne))}return O}(this._vertexBuffer,c);const h=[],v=c.length;for(let w=0;w<v;w+=3){const I=[c[w+0],c[w+1],c[w+2]],O=[this._vertexBuffer[2*c[w+0]+0],this._vertexBuffer[2*c[w+0]+1],this._vertexBuffer[2*c[w+1]+0],this._vertexBuffer[2*c[w+1]+1],this._vertexBuffer[2*c[w+2]+0],this._vertexBuffer[2*c[w+2]+1]];let z=1/0,V=1/0,J=-1/0,ne=-1/0;for(let He=0;He<3;He++){const st=O[2*He],yt=O[2*He+1];z=Math.min(z,st),J=Math.max(J,st),V=Math.min(V,yt),ne=Math.max(ne,yt)}if(z===J||V===ne)continue;const me=Math.floor(z/this._granularityCellSize),Ee=Math.ceil(J/this._granularityCellSize),je=Math.floor(V/this._granularityCellSize),Fe=Math.ceil(ne/this._granularityCellSize);if(me!==Ee||je!==Fe)for(let He=je;He<Fe;He++){const st=this._scanlineGenerateVertexRingForCellRow(He,O,I);J0(this._vertexBuffer,st,h)}else h.push(...I)}return h}_scanlineGenerateVertexRingForCellRow(c,h,v){const w=c*this._granularityCellSize,I=w+this._granularityCellSize,O=[];for(let z=0;z<3;z++){const V=h[2*z],J=h[2*z+1],ne=h[2*(z+1)%6],me=h[(2*(z+1)+1)%6],Ee=h[2*(z+2)%6],je=h[(2*(z+2)+1)%6],Fe=ne-V,He=me-J,st=Fe===0,yt=He===0,Xt=(w-J)/He,Ct=(I-J)/He,Rt=Math.min(Xt,Ct),lr=Math.max(Xt,Ct);if(!yt&&(Rt>=1||lr<=0)||yt&&(J<w||J>I)){me>=w&&me<=I&&O.push(v[(z+1)%3]);continue}!yt&&Rt>0&&O.push(this._vertexToIndex(V+Fe*Rt,J+He*Rt));const vr=V+Fe*Math.max(Rt,0),Fr=V+Fe*Math.min(lr,1);st||this._generateIntraEdgeVertices(O,V,J,ne,me,vr,Fr),!yt&&lr<1&&O.push(this._vertexToIndex(V+Fe*lr,J+He*lr)),(yt||me>=w&&me<=I)&&O.push(v[(z+1)%3]),!yt&&(me<=w||me>=I)&&this._generateInterEdgeVertices(O,V,J,ne,me,Ee,je,Fr,w,I)}return O}_generateIntraEdgeVertices(c,h,v,w,I,O,z){const V=w-h,J=I-v,ne=J===0,me=ne?Math.min(h,w):Math.min(O,z),Ee=ne?Math.max(h,w):Math.max(O,z),je=Math.floor(me/this._granularityCellSize)+1,Fe=Math.ceil(Ee/this._granularityCellSize)-1;if(ne?h<w:O<z)for(let He=je;He<=Fe;He++){const st=He*this._granularityCellSize;c.push(this._vertexToIndex(st,v+J*(st-h)/V))}else for(let He=Fe;He>=je;He--){const st=He*this._granularityCellSize;c.push(this._vertexToIndex(st,v+J*(st-h)/V))}}_generateInterEdgeVertices(c,h,v,w,I,O,z,V,J,ne){const me=I-v,Ee=O-w,je=z-I,Fe=(J-I)/je,He=(ne-I)/je,st=Math.min(Fe,He),yt=Math.max(Fe,He),Xt=w+Ee*st;let Ct=Math.floor(Math.min(Xt,V)/this._granularityCellSize)+1,Rt=Math.ceil(Math.max(Xt,V)/this._granularityCellSize)-1,lr=V<Xt;const vr=je===0;if(vr&&(z===J||z===ne))return;if(vr||st>=1||yt<=0){const pn=v-z,tn=O+(h-O)*Math.min((J-z)/pn,(ne-z)/pn);Ct=Math.floor(Math.min(tn,V)/this._granularityCellSize)+1,Rt=Math.ceil(Math.max(tn,V)/this._granularityCellSize)-1,lr=V<tn}const Fr=me>0?ne:J;if(lr)for(let pn=Ct;pn<=Rt;pn++)c.push(this._vertexToIndex(pn*this._granularityCellSize,Fr));else for(let pn=Rt;pn>=Ct;pn--)c.push(this._vertexToIndex(pn*this._granularityCellSize,Fr))}_generateOutline(c){const h=[];for(const v of c){const w=mp(v,this._granularity,!0),I=this._pointArrayToIndices(w),O=[];for(let z=1;z<I.length;z++)O.push(I[z-1]),O.push(I[z]);h.push(O)}return h}_handlePoles(c){let h=!1,v=!1;this._canonical&&(this._canonical.y===0&&(h=!0),this._canonical.y===(1<<this._canonical.z)-1&&(v=!0)),(h||v)&&this._fillPoles(c,h,v)}_ensureNoPoleVertices(){const c=this._vertexBuffer;for(let h=0;h<c.length;h+=2){const v=c[h+1];v===um&&(c[h+1]=-32767),v===pp&&(c[h+1]=32766)}}_generatePoleQuad(c,h,v,w,I,O){w>I!=(O===um)?(c.push(h),c.push(v),c.push(this._vertexToIndex(w,O)),c.push(v),c.push(this._vertexToIndex(I,O)),c.push(this._vertexToIndex(w,O))):(c.push(v),c.push(h),c.push(this._vertexToIndex(w,O)),c.push(this._vertexToIndex(I,O)),c.push(v),c.push(this._vertexToIndex(w,O)))}_fillPoles(c,h,v){const w=this._vertexBuffer,I=fe,O=c.length;for(let z=2;z<O;z+=3){const V=c[z-2],J=c[z-1],ne=c[z],me=w[2*V],Ee=w[2*V+1],je=w[2*J],Fe=w[2*J+1],He=w[2*ne],st=w[2*ne+1];h&&(Ee===0&&Fe===0&&this._generatePoleQuad(c,V,J,me,je,um),Fe===0&&st===0&&this._generatePoleQuad(c,J,ne,je,He,um),st===0&&Ee===0&&this._generatePoleQuad(c,ne,V,He,me,um)),v&&(Ee===I&&Fe===I&&this._generatePoleQuad(c,V,J,me,je,pp),Fe===I&&st===I&&this._generatePoleQuad(c,J,ne,je,He,pp),st===I&&Ee===I&&this._generatePoleQuad(c,ne,V,He,me,pp))}}_initializeVertices(c){for(let h=0;h<c.length;h+=2)this._vertexToIndex(c[h],c[h+1])}subdividePolygonInternal(c,h){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:v,holeIndices:w}=function(z){const V=[],J=[];for(const ne of z)if(ne.length!==0){ne!==z[0]&&V.push(J.length/2);for(let me=0;me<ne.length;me++)J.push(ne[me].x),J.push(ne[me].y)}return{flattened:J,holeIndices:V}}(c);let I;this._initializeVertices(v);try{const z=function(J,ne,me=2){const Ee=ne&&ne.length,je=Ee?ne[0]*me:J.length;let Fe=K_(J,0,je,me,!0);const He=[];if(!Fe||Fe.next===Fe.prev)return He;let st,yt,Xt;if(Ee&&(Fe=function(Ct,Rt,lr,vr){const Fr=[];for(let pn=0,tn=Rt.length;pn<tn;pn++){const un=K_(Ct,Rt[pn]*vr,pn<tn-1?Rt[pn+1]*vr:Ct.length,vr,!1);un===un.next&&(un.steiner=!0),Fr.push(HS(un))}Fr.sort($k);for(let pn=0;pn<Fr.length;pn++)lr=GS(Fr[pn],lr);return lr}(J,ne,Fe,me)),J.length>80*me){st=J[0],yt=J[1];let Ct=st,Rt=yt;for(let lr=me;lr<je;lr+=me){const vr=J[lr],Fr=J[lr+1];vr<st&&(st=vr),Fr<yt&&(yt=Fr),vr>Ct&&(Ct=vr),Fr>Rt&&(Rt=Fr)}Xt=Math.max(Ct-st,Rt-yt),Xt=Xt!==0?32767/Xt:0}return ug(Fe,He,me,st,yt,Xt,0),He}(v,w),V=this._convertIndices(v,z);I=this._subdivideTrianglesScanline(V)}catch(z){console.error(z)}let O=[];return h&&(O=this._generateOutline(c)),this._ensureNoPoleVertices(),this._handlePoles(I),{verticesFlattened:this._vertexBuffer,indicesTriangles:I,indicesLineList:O}}_convertIndices(c,h){const v=[];for(let w=0;w<h.length;w++)v.push(this._vertexToIndex(c[2*h[w]],c[2*h[w]+1]));return v}_pointArrayToIndices(c){const h=[];for(let v=0;v<c.length;v++){const w=c[v];h.push(this._vertexToIndex(w.x,w.y))}return h}}function Px(f,c,h,v=!0){return new XS(h,c).subdividePolygonInternal(f,v)}function mp(f,c,h=!1){if(!f||f.length<1)return[];if(f.length<2)return[];const v=f[0],w=f[f.length-1],I=h&&(v.x!==w.x||v.y!==w.y);if(c<2)return I?[...f,f[0]]:[...f];const O=Math.floor(fe/c),z=[];z.push(new u(f[0].x,f[0].y));const V=f.length,J=I?V:V-1;for(let ne=0;ne<J;ne++){const me=f[ne],Ee=ne<V-1?f[ne+1]:f[0],je=me.x,Fe=me.y,He=Ee.x,st=Ee.y,yt=je!==He,Xt=Fe!==st;if(!yt&&!Xt)continue;const Ct=He-je,Rt=st-Fe,lr=Math.abs(Ct),vr=Math.abs(Rt);let Fr=je,pn=Fe;for(;;){const un=Ct>0?(Math.floor(Fr/O)+1)*O:(Math.ceil(Fr/O)-1)*O,Rn=Rt>0?(Math.floor(pn/O)+1)*O:(Math.ceil(pn/O)-1)*O,ln=Math.abs(Fr-un),dn=Math.abs(pn-Rn),Cr=Math.abs(Fr-He),oi=Math.abs(pn-st),gi=yt?ln/lr:Number.POSITIVE_INFINITY,Hn=Xt?dn/vr:Number.POSITIVE_INFINITY;if((Cr<=ln||!yt)&&(oi<=dn||!Xt))break;if(gi<Hn&&yt||!Xt){Fr=un,pn+=Rt*gi;const Dn=new u(Fr,Math.round(pn));z[z.length-1].x===Dn.x&&z[z.length-1].y===Dn.y||z.push(Dn)}else{Fr+=Ct*Hn,pn=Rn;const Dn=new u(Math.round(Fr),pn);z[z.length-1].x===Dn.x&&z[z.length-1].y===Dn.y||z.push(Dn)}}const tn=new u(He,st);z[z.length-1].x===tn.x&&z[z.length-1].y===tn.y||z.push(tn)}return z}function J0(f,c,h){if(c.length===0)throw new Error("Subdivision vertex ring is empty.");let v=0,w=f[2*c[0]];for(let V=1;V<c.length;V++){const J=f[2*c[V]];J<w&&(w=J,v=V)}const I=c.length;let O=v,z=(O+1)%I;for(;;){const V=O-1>=0?O-1:I-1,J=(z+1)%I,ne=f[2*c[V]],me=f[2*c[J]],Ee=f[2*c[O]],je=f[2*c[O]+1],Fe=f[2*c[z]+1];let He=!1;if(ne<me)He=!0;else if(ne>me)He=!1;else{const st=Fe-je,yt=-(f[2*c[z]]-Ee),Xt=je<Fe?1:-1;((ne-Ee)*st+(f[2*c[V]+1]-je)*yt)*Xt>((me-Ee)*st+(f[2*c[J]+1]-je)*yt)*Xt&&(He=!0)}if(He){const st=c[V],yt=c[O],Xt=c[z];st!==yt&&st!==Xt&&yt!==Xt&&h.push(Xt,yt,st),O--,O<0&&(O=I-1)}else{const st=c[J],yt=c[O],Xt=c[z];st!==yt&&st!==Xt&&yt!==Xt&&h.push(Xt,yt,st),z++,z>=I&&(z=0)}if(V===J)break}}function Ex(f,c,h,v,w,I,O,z,V){const J=w.length/2,ne=O&&z&&V;if(J<ei.MAX_VERTEX_ARRAY_LENGTH){const me=c.prepareSegment(J,h,v),Ee=me.vertexLength;for(let He=0;He<I.length;He+=3)v.emplaceBack(Ee+I[He],Ee+I[He+1],Ee+I[He+2]);let je,Fe;me.vertexLength+=J,me.primitiveLength+=I.length/3,ne&&(Fe=O.prepareSegment(J,h,z),je=Fe.vertexLength,Fe.vertexLength+=J);for(let He=0;He<w.length;He+=2)f(w[He],w[He+1]);if(ne)for(let He=0;He<V.length;He++){const st=V[He];for(let yt=1;yt<st.length;yt+=2)z.emplaceBack(je+st[yt-1],je+st[yt]);Fe.primitiveLength+=st.length/2}}else(function(me,Ee,je,Fe,He,st){const yt=[];for(let vr=0;vr<Fe.length/2;vr++)yt.push(-1);const Xt={count:0};let Ct=0,Rt=me.getOrCreateLatestSegment(Ee,je),lr=Rt.vertexLength;for(let vr=2;vr<He.length;vr+=3){const Fr=He[vr-2],pn=He[vr-1],tn=He[vr];let un=yt[Fr]<Ct,Rn=yt[pn]<Ct,ln=yt[tn]<Ct;Rt.vertexLength+((un?1:0)+(Rn?1:0)+(ln?1:0))>ei.MAX_VERTEX_ARRAY_LENGTH&&(Rt=me.createNewSegment(Ee,je),Ct=Xt.count,un=!0,Rn=!0,ln=!0,lr=0);const dn=pg(yt,Fe,st,Xt,Fr,un,Rt),Cr=pg(yt,Fe,st,Xt,pn,Rn,Rt),oi=pg(yt,Fe,st,Xt,tn,ln,Rt);je.emplaceBack(lr+dn-Ct,lr+Cr-Ct,lr+oi-Ct),Rt.primitiveLength++}})(c,h,v,w,I,f),ne&&function(me,Ee,je,Fe,He,st){const yt=[];for(let vr=0;vr<Fe.length/2;vr++)yt.push(-1);const Xt={count:0};let Ct=0,Rt=me.getOrCreateLatestSegment(Ee,je),lr=Rt.vertexLength;for(let vr=0;vr<He.length;vr++){const Fr=He[vr];for(let pn=1;pn<He[vr].length;pn+=2){const tn=Fr[pn-1],un=Fr[pn];let Rn=yt[tn]<Ct,ln=yt[un]<Ct;Rt.vertexLength+((Rn?1:0)+(ln?1:0))>ei.MAX_VERTEX_ARRAY_LENGTH&&(Rt=me.createNewSegment(Ee,je),Ct=Xt.count,Rn=!0,ln=!0,lr=0);const dn=pg(yt,Fe,st,Xt,tn,Rn,Rt),Cr=pg(yt,Fe,st,Xt,un,ln,Rt);je.emplaceBack(lr+dn-Ct,lr+Cr-Ct),Rt.primitiveLength++}}}(O,h,z,w,V,f),c.forceNewSegmentOnNextPrepare(),O==null||O.forceNewSegmentOnNextPrepare()}function pg(f,c,h,v,w,I,O){if(I){const z=v.count;return h(c[2*w],c[2*w+1]),f[w]=v.count,v.count++,O.vertexLength++,z}return f[w]}class ev{constructor(c){this.zoom=c.zoom,this.globalState=c.globalState,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(h=>h.id),this.index=c.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ur,this.indexArray=new go,this.indexArray2=new bo,this.programConfigurations=new Cc(c.layers,c.zoom),this.segments=new ei,this.segments2=new ei,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(c,h,v){this.hasPattern=Z0("fill",this.layers,h);const w=this.layers[0].layout.get("fill-sort-key"),I=!w.isConstant(),O=[];for(const{feature:z,id:V,index:J,sourceLayerIndex:ne}of c){const me=this.layers[0]._featureFilter.needGeometry,Ee=nd(z,me);if(!this.layers[0]._featureFilter.filter(new En(this.zoom,{globalState:this.globalState}),Ee,v))continue;const je=I?w.evaluate(Ee,{},v,h.availableImages):void 0,Fe={id:V,properties:z.properties,type:z.type,sourceLayerIndex:ne,index:J,geometry:me?Ee.geometry:Od(z),patterns:{},sortKey:je};O.push(Fe)}I&&O.sort((z,V)=>z.sortKey-V.sortKey);for(const z of O){const{geometry:V,index:J,sourceLayerIndex:ne}=z;if(this.hasPattern){const me=X0("fill",this.layers,z,this.zoom,h);this.patternFeatures.push(me)}else this.addFeature(z,V,J,v,{},h.subdivisionGranularity);h.featureIndex.insert(c[J].feature,V,J,ne,this.index)}}update(c,h,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,h,this.stateDependentLayers,{imagePositions:v,globalState:this.globalState})}addFeatures(c,h,v){for(const w of this.patternFeatures)this.addFeature(w,w.geometry,w.index,h,v,c.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,xx),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.indexBuffer2=c.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(c,h,v,w,I,O){for(const z of Co(h,500)){const V=Px(z,w,O.fill.getGranularityForZoomLevel(w.z)),J=this.layoutVertexArray;Ex((ne,me)=>{J.emplaceBack(ne,me)},this.segments,this.layoutVertexArray,this.indexArray,V.verticesFlattened,V.indicesTriangles,this.segments2,this.indexArray2,V.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,v,{imagePositions:I,canonical:w,globalState:this.globalState})}}let Ax,Cx;Re("FillBucket",ev,{omit:["layers","patternFeatures"]});var YS={get paint(){return Cx=Cx||new wi({"fill-antialias":new on($t.paint_fill["fill-antialias"]),"fill-opacity":new xn($t.paint_fill["fill-opacity"]),"fill-color":new xn($t.paint_fill["fill-color"]),"fill-outline-color":new xn($t.paint_fill["fill-outline-color"]),"fill-translate":new on($t.paint_fill["fill-translate"]),"fill-translate-anchor":new on($t.paint_fill["fill-translate-anchor"]),"fill-pattern":new cs($t.paint_fill["fill-pattern"])})},get layout(){return Ax=Ax||new wi({"fill-sort-key":new xn($t.layout_fill["fill-sort-key"])})}};class QS extends Li{constructor(c){super(c,YS)}recalculate(c,h){super.recalculate(c,h);const v=this.paint._values["fill-outline-color"];v.value.kind==="constant"&&v.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new ev(c)}queryRadius(){return W0(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:c,geometry:h,transform:v,pixelsToTileUnits:w}){return sx(q_(c,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-v.bearingInRadians,w),h)}isTileClipped(){return!0}}const JS=no([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),eT=no([{name:"a_centroid",components:2,type:"Int16"}],4),{members:tT}=JS;class gp{constructor(c,h,v,w,I){this.properties={},this.extent=v,this.type=0,this.id=void 0,this._pbf=c,this._geometry=-1,this._keys=w,this._values=I,c.readFields(rT,this,h)}loadGeometry(){const c=this._pbf;c.pos=this._geometry;const h=c.readVarint()+c.pos,v=[];let w,I=1,O=0,z=0,V=0;for(;c.pos<h;){if(O<=0){const J=c.readVarint();I=7&J,O=J>>3}if(O--,I===1||I===2)z+=c.readSVarint(),V+=c.readSVarint(),I===1&&(w&&v.push(w),w=[]),w&&w.push(new u(z,V));else{if(I!==7)throw new Error(`unknown command ${I}`);w&&w.push(w[0].clone())}}return w&&v.push(w),v}bbox(){const c=this._pbf;c.pos=this._geometry;const h=c.readVarint()+c.pos;let v=1,w=0,I=0,O=0,z=1/0,V=-1/0,J=1/0,ne=-1/0;for(;c.pos<h;){if(w<=0){const me=c.readVarint();v=7&me,w=me>>3}if(w--,v===1||v===2)I+=c.readSVarint(),O+=c.readSVarint(),I<z&&(z=I),I>V&&(V=I),O<J&&(J=O),O>ne&&(ne=O);else if(v!==7)throw new Error(`unknown command ${v}`)}return[z,J,V,ne]}toGeoJSON(c,h,v){const w=this.extent*Math.pow(2,v),I=this.extent*c,O=this.extent*h,z=this.loadGeometry();function V(Ee){return[360*(Ee.x+I)/w-180,360/Math.PI*Math.atan(Math.exp((1-2*(Ee.y+O)/w)*Math.PI))-90]}function J(Ee){return Ee.map(V)}let ne;if(this.type===1){const Ee=[];for(const Fe of z)Ee.push(Fe[0]);const je=J(Ee);ne=Ee.length===1?{type:"Point",coordinates:je[0]}:{type:"MultiPoint",coordinates:je}}else if(this.type===2){const Ee=z.map(J);ne=Ee.length===1?{type:"LineString",coordinates:Ee[0]}:{type:"MultiLineString",coordinates:Ee}}else{if(this.type!==3)throw new Error("unknown feature type");{const Ee=function(Fe){const He=Fe.length;if(He<=1)return[Fe];const st=[];let yt,Xt;for(let Ct=0;Ct<He;Ct++){const Rt=nT(Fe[Ct]);Rt!==0&&(Xt===void 0&&(Xt=Rt<0),Xt===Rt<0?(yt&&st.push(yt),yt=[Fe[Ct]]):yt&&yt.push(Fe[Ct]))}return yt&&st.push(yt),st}(z),je=[];for(const Fe of Ee)je.push(Fe.map(J));ne=je.length===1?{type:"Polygon",coordinates:je[0]}:{type:"MultiPolygon",coordinates:je}}}const me={type:"Feature",geometry:ne,properties:this.properties};return this.id!=null&&(me.id=this.id),me}}function rT(f,c,h){f===1?c.id=h.readVarint():f===2?function(v,w){const I=v.readVarint()+v.pos;for(;v.pos<I;){const O=w._keys[v.readVarint()],z=w._values[v.readVarint()];w.properties[O]=z}}(h,c):f===3?c.type=h.readVarint():f===4&&(c._geometry=h.pos)}function nT(f){let c=0;for(let h,v,w=0,I=f.length,O=I-1;w<I;O=w++)h=f[w],v=f[O],c+=(v.x-h.x)*(h.y+v.y);return c}gp.types=["Unknown","Point","LineString","Polygon"];class tv{constructor(c,h){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields(iT,this,h),this.length=this._features.length}feature(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];const h=this._pbf.readVarint()+this._pbf.pos;return new gp(this._pbf,h,this.extent,this._keys,this._values)}}function iT(f,c,h){f===15?c.version=h.readVarint():f===1?c.name=h.readString():f===5?c.extent=h.readVarint():f===2?c._features.push(h.pos):f===3?c._keys.push(h.readString()):f===4&&c._values.push(function(v){let w=null;const I=v.readVarint()+v.pos;for(;v.pos<I;){const O=v.readVarint()>>3;w=O===1?v.readString():O===2?v.readFloat():O===3?v.readDouble():O===4?v.readVarint64():O===5?v.readVarint():O===6?v.readSVarint():O===7?v.readBoolean():null}if(w==null)throw new Error("unknown feature value");return w}(h))}class kx{constructor(c,h){this.layers=c.readFields(oT,{},h)}}function oT(f,c,h){if(f===3){const v=new tv(h,h.readVarint()+h.pos);v.length&&(c[v.name]=v)}}const Y_=Math.pow(2,13);function mg(f,c,h,v,w,I,O,z){f.emplaceBack(c,h,2*Math.floor(v*Y_)+O,w*Y_*2,I*Y_*2,Math.round(z))}class gg{constructor(c){this.zoom=c.zoom,this.globalState=c.globalState,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(h=>h.id),this.index=c.index,this.hasPattern=!1,this.layoutVertexArray=new Jt,this.centroidVertexArray=new St,this.indexArray=new go,this.programConfigurations=new Cc(c.layers,c.zoom),this.segments=new ei,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(c,h,v){this.features=[],this.hasPattern=Z0("fill-extrusion",this.layers,h);for(const{feature:w,id:I,index:O,sourceLayerIndex:z}of c){const V=this.layers[0]._featureFilter.needGeometry,J=nd(w,V);if(!this.layers[0]._featureFilter.filter(new En(this.zoom,{globalState:this.globalState}),J,v))continue;const ne={id:I,sourceLayerIndex:z,index:O,geometry:V?J.geometry:Od(w),properties:w.properties,type:w.type,patterns:{}};this.hasPattern?this.features.push(X0("fill-extrusion",this.layers,ne,this.zoom,h)):this.addFeature(ne,ne.geometry,O,v,{},h.subdivisionGranularity),h.featureIndex.insert(w,ne.geometry,O,z,this.index,!0)}}addFeatures(c,h,v){for(const w of this.features){const{geometry:I}=w;this.addFeature(w,I,w.index,h,v,c.subdivisionGranularity)}}update(c,h,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,h,this.stateDependentLayers,{imagePositions:v,globalState:this.globalState})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,tT),this.centroidVertexBuffer=c.createVertexBuffer(this.centroidVertexArray,eT.members,!0),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(c,h,v,w,I,O){for(const z of Co(h,500)){const V={x:0,y:0,sampleCount:0},J=this.layoutVertexArray.length;this.processPolygon(V,w,c,z,O);const ne=this.layoutVertexArray.length-J,me=Math.floor(V.x/V.sampleCount),Ee=Math.floor(V.y/V.sampleCount);for(let je=0;je<ne;je++)this.centroidVertexArray.emplaceBack(me,Ee)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,v,{imagePositions:I,canonical:w,globalState:this.globalState})}processPolygon(c,h,v,w,I){if(w.length<1||Ix(w[0]))return;for(const me of w)me.length!==0&&aT(c,me);const O={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},z=I.fill.getGranularityForZoomLevel(h.z),V=gp.types[v.type]==="Polygon";for(const me of w){if(me.length===0||Ix(me))continue;const Ee=mp(me,z,V);this._generateSideFaces(Ee,O)}if(!V)return;const J=Px(w,h,z,!1),ne=this.layoutVertexArray;Ex((me,Ee)=>{mg(ne,me,Ee,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,J.verticesFlattened,J.indicesTriangles)}_generateSideFaces(c,h){let v=0;for(let w=1;w<c.length;w++){const I=c[w],O=c[w-1];if(sT(I,O))continue;h.segment.vertexLength+4>ei.MAX_VERTEX_ARRAY_LENGTH&&(h.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const z=I.sub(O)._perp()._unit(),V=O.dist(I);v+V>32768&&(v=0),mg(this.layoutVertexArray,I.x,I.y,z.x,z.y,0,0,v),mg(this.layoutVertexArray,I.x,I.y,z.x,z.y,0,1,v),v+=V,mg(this.layoutVertexArray,O.x,O.y,z.x,z.y,0,0,v),mg(this.layoutVertexArray,O.x,O.y,z.x,z.y,0,1,v);const J=h.segment.vertexLength;this.indexArray.emplaceBack(J,J+2,J+1),this.indexArray.emplaceBack(J+1,J+2,J+3),h.segment.vertexLength+=4,h.segment.primitiveLength+=2}}}function aT(f,c){for(let h=0;h<c.length;h++){const v=c[h];h===c.length-1&&c[0].x===v.x&&c[0].y===v.y||(f.x+=v.x,f.y+=v.y,f.sampleCount++)}}function sT(f,c){return f.x===c.x&&(f.x<0||f.x>fe)||f.y===c.y&&(f.y<0||f.y>fe)}function Ix(f){return f.every(c=>c.x<0)||f.every(c=>c.x>fe)||f.every(c=>c.y<0)||f.every(c=>c.y>fe)}let Ox;Re("FillExtrusionBucket",gg,{omit:["layers","features"]});var lT={get paint(){return Ox=Ox||new wi({"fill-extrusion-opacity":new on($t["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new xn($t["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new on($t["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new on($t["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new cs($t["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new xn($t["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new xn($t["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new on($t["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class rv extends Li{constructor(c){super(c,lT)}createBucket(c){return new gg(c)}queryRadius(){return W0(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:c,feature:h,featureState:v,geometry:w,transform:I,pixelsToTileUnits:O,pixelPosMatrix:z}){const V=q_(c,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-I.bearingInRadians,O),J=this.paint.get("fill-extrusion-height").evaluate(h,v),ne=this.paint.get("fill-extrusion-base").evaluate(h,v),me=function(je,Fe){const He=[];for(const st of je){const yt=[st.x,st.y,0,1];ae(yt,yt,Fe),He.push(new u(yt[0]/yt[3],yt[1]/yt[3]))}return He}(V,z),Ee=function(je,Fe,He,st){const yt=[],Xt=[],Ct=st[8]*Fe,Rt=st[9]*Fe,lr=st[10]*Fe,vr=st[11]*Fe,Fr=st[8]*He,pn=st[9]*He,tn=st[10]*He,un=st[11]*He;for(const Rn of je){const ln=[],dn=[];for(const Cr of Rn){const oi=Cr.x,gi=Cr.y,Hn=st[0]*oi+st[4]*gi+st[12],Dn=st[1]*oi+st[5]*gi+st[13],ho=st[2]*oi+st[6]*gi+st[14],ms=st[3]*oi+st[7]*gi+st[15],Tl=ho+lr,Oc=ms+vr,Ld=Hn+Fr,Du=Dn+pn,ac=ho+tn,Ja=ms+un,Bl=new u((Hn+Ct)/Oc,(Dn+Rt)/Oc);Bl.z=Tl/Oc,ln.push(Bl);const sc=new u(Ld/Ja,Du/Ja);sc.z=ac/Ja,dn.push(sc)}yt.push(ln),Xt.push(dn)}return[yt,Xt]}(w,ne,J,z);return function(je,Fe,He){let st=1/0;sx(He,Fe)&&(st=Lx(He,Fe[0]));for(let yt=0;yt<Fe.length;yt++){const Xt=Fe[yt],Ct=je[yt];for(let Rt=0;Rt<Xt.length-1;Rt++){const lr=Xt[Rt],vr=[lr,Xt[Rt+1],Ct[Rt+1],Ct[Rt],lr];ax(He,vr)&&(st=Math.min(st,Lx(He,vr)))}}return st!==1/0&&st}(Ee[0],Ee[1],me)}}function _g(f,c){return f.x*c.x+f.y*c.y}function Lx(f,c){if(f.length===1){let h=0;const v=c[h++];let w;for(;!w||v.equals(w);)if(w=c[h++],!w)return 1/0;for(;h<c.length;h++){const I=c[h],O=f[0],z=w.sub(v),V=I.sub(v),J=O.sub(v),ne=_g(z,z),me=_g(z,V),Ee=_g(V,V),je=_g(J,z),Fe=_g(J,V),He=ne*Ee-me*me,st=(Ee*je-me*Fe)/He,yt=(ne*Fe-me*je)/He,Xt=v.z*(1-st-yt)+w.z*st+I.z*yt;if(isFinite(Xt))return Xt}return 1/0}{let h=1/0;for(const v of c)h=Math.min(h,v.z);return h}}const cT=no([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:uT}=cT,dT=no([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:nv}=dT,hT=Math.cos(Math.PI/180*37.5),Dx=Math.pow(2,14)/.5;class iv{constructor(c){this.zoom=c.zoom,this.globalState=c.globalState,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(h=>h.id),this.index=c.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(h=>{this.gradients[h.id]={}}),this.layoutVertexArray=new nr,this.layoutVertexArray2=new cr,this.indexArray=new go,this.programConfigurations=new Cc(c.layers,c.zoom),this.segments=new ei,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(c,h,v){this.hasPattern=Z0("line",this.layers,h);const w=this.layers[0].layout.get("line-sort-key"),I=!w.isConstant(),O=[];for(const{feature:z,id:V,index:J,sourceLayerIndex:ne}of c){const me=this.layers[0]._featureFilter.needGeometry,Ee=nd(z,me);if(!this.layers[0]._featureFilter.filter(new En(this.zoom,{globalState:this.globalState}),Ee,v))continue;const je=I?w.evaluate(Ee,{},v):void 0,Fe={id:V,properties:z.properties,type:z.type,sourceLayerIndex:ne,index:J,geometry:me?Ee.geometry:Od(z),patterns:{},sortKey:je};O.push(Fe)}I&&O.sort((z,V)=>z.sortKey-V.sortKey);for(const z of O){const{geometry:V,index:J,sourceLayerIndex:ne}=z;if(this.hasPattern){const me=X0("line",this.layers,z,this.zoom,h);this.patternFeatures.push(me)}else this.addFeature(z,V,J,v,{},h.subdivisionGranularity);h.featureIndex.insert(c[J].feature,V,J,ne,this.index)}}update(c,h,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,h,this.stateDependentLayers,{imagePositions:v,globalState:this.globalState})}addFeatures(c,h,v){for(const w of this.patternFeatures)this.addFeature(w,w.geometry,w.index,h,v,c.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=c.createVertexBuffer(this.layoutVertexArray2,nv)),this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,uT),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(c){if(c.properties&&Object.prototype.hasOwnProperty.call(c.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(c.properties,"mapbox_clip_end"))return{start:+c.properties.mapbox_clip_start,end:+c.properties.mapbox_clip_end}}addFeature(c,h,v,w,I,O){const z=this.layers[0].layout,V=z.get("line-join").evaluate(c,{}),J=z.get("line-cap"),ne=z.get("line-miter-limit"),me=z.get("line-round-limit");this.lineClips=this.lineFeatureClips(c);for(const Ee of h)this.addLine(Ee,c,V,J,ne,me,w,O);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,v,{imagePositions:I,canonical:w,globalState:this.globalState})}addLine(c,h,v,w,I,O,z,V){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,c=mp(c,z?V.line.getGranularityForZoomLevel(z.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Ct=0;Ct<c.length-1;Ct++)this.totalDistance+=c[Ct].dist(c[Ct+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const J=gp.types[h.type]==="Polygon";let ne=c.length;for(;ne>=2&&c[ne-1].equals(c[ne-2]);)ne--;let me=0;for(;me<ne-1&&c[me].equals(c[me+1]);)me++;if(ne<(J?3:2))return;v==="bevel"&&(I=1.05);const Ee=this.overscaling<=16?122880/(512*this.overscaling):0,je=this.segments.prepareSegment(10*ne,this.layoutVertexArray,this.indexArray);let Fe,He,st,yt,Xt;this.e1=this.e2=-1,J&&(Fe=c[ne-2],Xt=c[me].sub(Fe)._unit()._perp());for(let Ct=me;Ct<ne;Ct++){if(st=Ct===ne-1?J?c[me+1]:void 0:c[Ct+1],st&&c[Ct].equals(st))continue;Xt&&(yt=Xt),Fe&&(He=Fe),Fe=c[Ct],Xt=st?st.sub(Fe)._unit()._perp():yt,yt=yt||Xt;let Rt=yt.add(Xt);Rt.x===0&&Rt.y===0||Rt._unit();const lr=yt.x*Xt.x+yt.y*Xt.y,vr=Rt.x*Xt.x+Rt.y*Xt.y,Fr=vr!==0?1/vr:1/0,pn=2*Math.sqrt(2-2*vr),tn=vr<hT&&He&&st,un=yt.x*Xt.y-yt.y*Xt.x>0;if(tn&&Ct>me){const dn=Fe.dist(He);if(dn>2*Ee){const Cr=Fe.sub(Fe.sub(He)._mult(Ee/dn)._round());this.updateDistance(He,Cr),this.addCurrentVertex(Cr,yt,0,0,je),He=Cr}}const Rn=He&&st;let ln=Rn?v:J?"butt":w;if(Rn&&ln==="round"&&(Fr<O?ln="miter":Fr<=2&&(ln="fakeround")),ln==="miter"&&Fr>I&&(ln="bevel"),ln==="bevel"&&(Fr>2&&(ln="flipbevel"),Fr<I&&(ln="miter")),He&&this.updateDistance(He,Fe),ln==="miter")Rt._mult(Fr),this.addCurrentVertex(Fe,Rt,0,0,je);else if(ln==="flipbevel"){if(Fr>100)Rt=Xt.mult(-1);else{const dn=Fr*yt.add(Xt).mag()/yt.sub(Xt).mag();Rt._perp()._mult(dn*(un?-1:1))}this.addCurrentVertex(Fe,Rt,0,0,je),this.addCurrentVertex(Fe,Rt.mult(-1),0,0,je)}else if(ln==="bevel"||ln==="fakeround"){const dn=-Math.sqrt(Fr*Fr-1),Cr=un?dn:0,oi=un?0:dn;if(He&&this.addCurrentVertex(Fe,yt,Cr,oi,je),ln==="fakeround"){const gi=Math.round(180*pn/Math.PI/20);for(let Hn=1;Hn<gi;Hn++){let Dn=Hn/gi;if(Dn!==.5){const ms=Dn-.5;Dn+=Dn*ms*(Dn-1)*((1.0904+lr*(lr*(3.55645-1.43519*lr)-3.2452))*ms*ms+(.848013+lr*(.215638*lr-1.06021)))}const ho=Xt.sub(yt)._mult(Dn)._add(yt)._unit()._mult(un?-1:1);this.addHalfVertex(Fe,ho.x,ho.y,!1,un,0,je)}}st&&this.addCurrentVertex(Fe,Xt,-Cr,-oi,je)}else if(ln==="butt")this.addCurrentVertex(Fe,Rt,0,0,je);else if(ln==="square"){const dn=He?1:-1;this.addCurrentVertex(Fe,Rt,dn,dn,je)}else ln==="round"&&(He&&(this.addCurrentVertex(Fe,yt,0,0,je),this.addCurrentVertex(Fe,yt,1,1,je,!0)),st&&(this.addCurrentVertex(Fe,Xt,-1,-1,je,!0),this.addCurrentVertex(Fe,Xt,0,0,je)));if(tn&&Ct<ne-1){const dn=Fe.dist(st);if(dn>2*Ee){const Cr=Fe.add(st.sub(Fe)._mult(Ee/dn)._round());this.updateDistance(Fe,Cr),this.addCurrentVertex(Cr,Xt,0,0,je),Fe=Cr}}}}addCurrentVertex(c,h,v,w,I,O=!1){const z=h.y*w-h.x,V=-h.y-h.x*w;this.addHalfVertex(c,h.x+h.y*v,h.y-h.x*v,O,!1,v,I),this.addHalfVertex(c,z,V,O,!0,-w,I),this.distance>Dx/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(c,h,v,w,I,O))}addHalfVertex({x:c,y:h},v,w,I,O,z,V){const J=.5*(this.lineClips?this.scaledDistance*(Dx-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((c<<1)+(I?1:0),(h<<1)+(O?1:0),Math.round(63*v)+128,Math.round(63*w)+128,1+(z===0?0:z<0?-1:1)|(63&J)<<2,J>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const ne=V.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,ne,this.e2),V.primitiveLength++),O?this.e2=ne:this.e1=ne}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(c,h){this.distance+=c.dist(h),this.updateScaledDistance()}}let Oo,fT;Re("LineBucket",iv,{omit:["layers","patternFeatures"]});var pT={get paint(){return fT=fT||new wi({"line-opacity":new xn($t.paint_line["line-opacity"]),"line-color":new xn($t.paint_line["line-color"]),"line-translate":new on($t.paint_line["line-translate"]),"line-translate-anchor":new on($t.paint_line["line-translate-anchor"]),"line-width":new xn($t.paint_line["line-width"]),"line-gap-width":new xn($t.paint_line["line-gap-width"]),"line-offset":new xn($t.paint_line["line-offset"]),"line-blur":new xn($t.paint_line["line-blur"]),"line-dasharray":new Xo($t.paint_line["line-dasharray"]),"line-pattern":new cs($t.paint_line["line-pattern"]),"line-gradient":new Fi($t.paint_line["line-gradient"])})},get layout(){return Oo=Oo||new wi({"line-cap":new on($t.layout_line["line-cap"]),"line-join":new xn($t.layout_line["line-join"]),"line-miter-limit":new on($t.layout_line["line-miter-limit"]),"line-round-limit":new on($t.layout_line["line-round-limit"]),"line-sort-key":new xn($t.layout_line["line-sort-key"])})}};class Nk extends xn{possiblyEvaluate(c,h){return h=new En(Math.floor(h.zoom),{now:h.now,fadeDuration:h.fadeDuration,zoomHistory:h.zoomHistory,transition:h.transition}),super.possiblyEvaluate(c,h)}evaluate(c,h,v,w){return h=ot({},h,{zoom:Math.floor(h.zoom)}),super.evaluate(c,h,v,w)}}let ov;class $x extends Li{constructor(c){super(c,pT),this.gradientVersion=0,ov||(ov=new Nk(pT.paint.properties["line-width"].specification),ov.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(c){if(c==="line-gradient"){const h=this.gradientExpression();this.stepInterpolant=!!function(v){return v._styleExpression!==void 0}(h)&&h._styleExpression.expression instanceof pt,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(c,h){super.recalculate(c,h),this.paint._values["line-floorwidth"]=ov.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new iv(c)}queryRadius(c){const h=c,v=Nx(sg("line-width",this,h),sg("line-gap-width",this,h)),w=sg("line-offset",this,h);return v/2+Math.abs(w)+W0(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:c,feature:h,featureState:v,geometry:w,transform:I,pixelsToTileUnits:O}){const z=q_(c,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-I.bearingInRadians,O),V=O/2*Nx(this.paint.get("line-width").evaluate(h,v),this.paint.get("line-gap-width").evaluate(h,v)),J=this.paint.get("line-offset").evaluate(h,v);return J&&(w=function(ne,me){const Ee=[];for(let je=0;je<ne.length;je++){const Fe=ne[je],He=[];for(let st=0;st<Fe.length;st++){const yt=Fe[st-1],Xt=Fe[st],Ct=Fe[st+1],Rt=st===0?new u(0,0):Xt.sub(yt)._unit()._perp(),lr=st===Fe.length-1?new u(0,0):Ct.sub(Xt)._unit()._perp(),vr=Rt._add(lr)._unit(),Fr=vr.x*lr.x+vr.y*lr.y;Fr!==0&&vr._mult(1/Fr),He.push(vr._mult(me)._add(Xt))}Ee.push(He)}return Ee}(w,J*O)),function(ne,me,Ee){for(let je=0;je<me.length;je++){const Fe=me[je];if(ne.length>=3){for(let He=0;He<Fe.length;He++)if(sm(ne,Fe[He]))return!0}if(W_(ne,Fe,Ee))return!0}return!1}(z,w,V)}isTileClipped(){return!0}}function Nx(f,c){return c>0?c+2*f:f}const mT=no([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),gT=no([{name:"a_projected_pos",components:3,type:"Float32"}],4);no([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const _T=no([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);no([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const av=no([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),jx=no([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function jk(f,c,h){return f.sections.forEach(v=>{v.text=function(w,I,O){const z=I.layout.get("text-transform").evaluate(O,{});return z==="uppercase"?w=w.toLocaleUpperCase():z==="lowercase"&&(w=w.toLocaleLowerCase()),Ro.applyArabicShaping&&(w=Ro.applyArabicShaping(w)),w}(v.text,c,h)}),f}no([{name:"triangle",components:3,type:"Uint16"}]),no([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),no([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),no([{type:"Float32",name:"offsetX"}]),no([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),no([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const yg={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var Vs=24;const Q_=4294967296,Rx=1/Q_,Fx=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class zx{constructor(c=new Uint8Array(16)){this.buf=ArrayBuffer.isView(c)?c:new Uint8Array(c),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(c,h,v=this.length){for(;this.pos<v;){const w=this.readVarint(),I=w>>3,O=this.pos;this.type=7&w,c(I,h,this),this.pos===O&&this.skip(w)}return h}readMessage(c,h){return this.readFields(c,h,this.readVarint()+this.pos)}readFixed32(){const c=this.dataView.getUint32(this.pos,!0);return this.pos+=4,c}readSFixed32(){const c=this.dataView.getInt32(this.pos,!0);return this.pos+=4,c}readFixed64(){const c=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*Q_;return this.pos+=8,c}readSFixed64(){const c=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*Q_;return this.pos+=8,c}readFloat(){const c=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,c}readDouble(){const c=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,c}readVarint(c){const h=this.buf;let v,w;return w=h[this.pos++],v=127&w,w<128?v:(w=h[this.pos++],v|=(127&w)<<7,w<128?v:(w=h[this.pos++],v|=(127&w)<<14,w<128?v:(w=h[this.pos++],v|=(127&w)<<21,w<128?v:(w=h[this.pos],v|=(15&w)<<28,function(I,O,z){const V=z.buf;let J,ne;if(ne=V[z.pos++],J=(112&ne)>>4,ne<128||(ne=V[z.pos++],J|=(127&ne)<<3,ne<128)||(ne=V[z.pos++],J|=(127&ne)<<10,ne<128)||(ne=V[z.pos++],J|=(127&ne)<<17,ne<128)||(ne=V[z.pos++],J|=(127&ne)<<24,ne<128)||(ne=V[z.pos++],J|=(1&ne)<<31,ne<128))return dm(I,J,O);throw new Error("Expected varint not more than 10 bytes")}(v,c,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const c=this.readVarint();return c%2==1?(c+1)/-2:c/2}readBoolean(){return!!this.readVarint()}readString(){const c=this.readVarint()+this.pos,h=this.pos;return this.pos=c,c-h>=12&&Fx?Fx.decode(this.buf.subarray(h,c)):function(v,w,I){let O="",z=w;for(;z<I;){const V=v[z];let J,ne,me,Ee=null,je=V>239?4:V>223?3:V>191?2:1;if(z+je>I)break;je===1?V<128&&(Ee=V):je===2?(J=v[z+1],(192&J)==128&&(Ee=(31&V)<<6|63&J,Ee<=127&&(Ee=null))):je===3?(J=v[z+1],ne=v[z+2],(192&J)==128&&(192&ne)==128&&(Ee=(15&V)<<12|(63&J)<<6|63&ne,(Ee<=2047||Ee>=55296&&Ee<=57343)&&(Ee=null))):je===4&&(J=v[z+1],ne=v[z+2],me=v[z+3],(192&J)==128&&(192&ne)==128&&(192&me)==128&&(Ee=(15&V)<<18|(63&J)<<12|(63&ne)<<6|63&me,(Ee<=65535||Ee>=1114112)&&(Ee=null))),Ee===null?(Ee=65533,je=1):Ee>65535&&(Ee-=65536,O+=String.fromCharCode(Ee>>>10&1023|55296),Ee=56320|1023&Ee),O+=String.fromCharCode(Ee),z+=je}return O}(this.buf,h,c)}readBytes(){const c=this.readVarint()+this.pos,h=this.buf.subarray(this.pos,c);return this.pos=c,h}readPackedVarint(c=[],h){const v=this.readPackedEnd();for(;this.pos<v;)c.push(this.readVarint(h));return c}readPackedSVarint(c=[]){const h=this.readPackedEnd();for(;this.pos<h;)c.push(this.readSVarint());return c}readPackedBoolean(c=[]){const h=this.readPackedEnd();for(;this.pos<h;)c.push(this.readBoolean());return c}readPackedFloat(c=[]){const h=this.readPackedEnd();for(;this.pos<h;)c.push(this.readFloat());return c}readPackedDouble(c=[]){const h=this.readPackedEnd();for(;this.pos<h;)c.push(this.readDouble());return c}readPackedFixed32(c=[]){const h=this.readPackedEnd();for(;this.pos<h;)c.push(this.readFixed32());return c}readPackedSFixed32(c=[]){const h=this.readPackedEnd();for(;this.pos<h;)c.push(this.readSFixed32());return c}readPackedFixed64(c=[]){const h=this.readPackedEnd();for(;this.pos<h;)c.push(this.readFixed64());return c}readPackedSFixed64(c=[]){const h=this.readPackedEnd();for(;this.pos<h;)c.push(this.readSFixed64());return c}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(c){const h=7&c;if(h===0)for(;this.buf[this.pos++]>127;);else if(h===2)this.pos=this.readVarint()+this.pos;else if(h===5)this.pos+=4;else{if(h!==1)throw new Error(`Unimplemented type: ${h}`);this.pos+=8}}writeTag(c,h){this.writeVarint(c<<3|h)}realloc(c){let h=this.length||16;for(;h<this.pos+c;)h*=2;if(h!==this.length){const v=new Uint8Array(h);v.set(this.buf),this.buf=v,this.dataView=new DataView(v.buffer),this.length=h}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(c){this.realloc(4),this.dataView.setInt32(this.pos,c,!0),this.pos+=4}writeSFixed32(c){this.realloc(4),this.dataView.setInt32(this.pos,c,!0),this.pos+=4}writeFixed64(c){this.realloc(8),this.dataView.setInt32(this.pos,-1&c,!0),this.dataView.setInt32(this.pos+4,Math.floor(c*Rx),!0),this.pos+=8}writeSFixed64(c){this.realloc(8),this.dataView.setInt32(this.pos,-1&c,!0),this.dataView.setInt32(this.pos+4,Math.floor(c*Rx),!0),this.pos+=8}writeVarint(c){(c=+c||0)>268435455||c<0?function(h,v){let w,I;if(h>=0?(w=h%4294967296|0,I=h/4294967296|0):(w=~(-h%4294967296),I=~(-h/4294967296),4294967295^w?w=w+1|0:(w=0,I=I+1|0)),h>=18446744073709552e3||h<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");v.realloc(10),function(O,z,V){V.buf[V.pos++]=127&O|128,O>>>=7,V.buf[V.pos++]=127&O|128,O>>>=7,V.buf[V.pos++]=127&O|128,O>>>=7,V.buf[V.pos++]=127&O|128,V.buf[V.pos]=127&(O>>>=7)}(w,0,v),function(O,z){const V=(7&O)<<4;z.buf[z.pos++]|=V|((O>>>=3)?128:0),O&&(z.buf[z.pos++]=127&O|((O>>>=7)?128:0),O&&(z.buf[z.pos++]=127&O|((O>>>=7)?128:0),O&&(z.buf[z.pos++]=127&O|((O>>>=7)?128:0),O&&(z.buf[z.pos++]=127&O|((O>>>=7)?128:0),O&&(z.buf[z.pos++]=127&O)))))}(I,v)}(c,this):(this.realloc(4),this.buf[this.pos++]=127&c|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=c>>>7&127))))}writeSVarint(c){this.writeVarint(c<0?2*-c-1:2*c)}writeBoolean(c){this.writeVarint(+c)}writeString(c){c=String(c),this.realloc(4*c.length),this.pos++;const h=this.pos;this.pos=function(w,I,O){for(let z,V,J=0;J<I.length;J++){if(z=I.charCodeAt(J),z>55295&&z<57344){if(!V){z>56319||J+1===I.length?(w[O++]=239,w[O++]=191,w[O++]=189):V=z;continue}if(z<56320){w[O++]=239,w[O++]=191,w[O++]=189,V=z;continue}z=V-55296<<10|z-56320|65536,V=null}else V&&(w[O++]=239,w[O++]=191,w[O++]=189,V=null);z<128?w[O++]=z:(z<2048?w[O++]=z>>6|192:(z<65536?w[O++]=z>>12|224:(w[O++]=z>>18|240,w[O++]=z>>12&63|128),w[O++]=z>>6&63|128),w[O++]=63&z|128)}return O}(this.buf,c,this.pos);const v=this.pos-h;v>=128&&Bx(h,v,this),this.pos=h-1,this.writeVarint(v),this.pos+=v}writeFloat(c){this.realloc(4),this.dataView.setFloat32(this.pos,c,!0),this.pos+=4}writeDouble(c){this.realloc(8),this.dataView.setFloat64(this.pos,c,!0),this.pos+=8}writeBytes(c){const h=c.length;this.writeVarint(h),this.realloc(h);for(let v=0;v<h;v++)this.buf[this.pos++]=c[v]}writeRawMessage(c,h){this.pos++;const v=this.pos;c(h,this);const w=this.pos-v;w>=128&&Bx(v,w,this),this.pos=v-1,this.writeVarint(w),this.pos+=w}writeMessage(c,h,v){this.writeTag(c,2),this.writeRawMessage(h,v)}writePackedVarint(c,h){h.length&&this.writeMessage(c,yT,h)}writePackedSVarint(c,h){h.length&&this.writeMessage(c,vg,h)}writePackedBoolean(c,h){h.length&&this.writeMessage(c,xT,h)}writePackedFloat(c,h){h.length&&this.writeMessage(c,vT,h)}writePackedDouble(c,h){h.length&&this.writeMessage(c,bT,h)}writePackedFixed32(c,h){h.length&&this.writeMessage(c,wT,h)}writePackedSFixed32(c,h){h.length&&this.writeMessage(c,MT,h)}writePackedFixed64(c,h){h.length&&this.writeMessage(c,ST,h)}writePackedSFixed64(c,h){h.length&&this.writeMessage(c,TT,h)}writeBytesField(c,h){this.writeTag(c,2),this.writeBytes(h)}writeFixed32Field(c,h){this.writeTag(c,5),this.writeFixed32(h)}writeSFixed32Field(c,h){this.writeTag(c,5),this.writeSFixed32(h)}writeFixed64Field(c,h){this.writeTag(c,1),this.writeFixed64(h)}writeSFixed64Field(c,h){this.writeTag(c,1),this.writeSFixed64(h)}writeVarintField(c,h){this.writeTag(c,0),this.writeVarint(h)}writeSVarintField(c,h){this.writeTag(c,0),this.writeSVarint(h)}writeStringField(c,h){this.writeTag(c,2),this.writeString(h)}writeFloatField(c,h){this.writeTag(c,5),this.writeFloat(h)}writeDoubleField(c,h){this.writeTag(c,1),this.writeDouble(h)}writeBooleanField(c,h){this.writeVarintField(c,+h)}}function dm(f,c,h){return h?4294967296*c+(f>>>0):4294967296*(c>>>0)+(f>>>0)}function Bx(f,c,h){const v=c<=16383?1:c<=2097151?2:c<=268435455?3:Math.floor(Math.log(c)/(7*Math.LN2));h.realloc(v);for(let w=h.pos-1;w>=f;w--)h.buf[w+v]=h.buf[w]}function yT(f,c){for(let h=0;h<f.length;h++)c.writeVarint(f[h])}function vg(f,c){for(let h=0;h<f.length;h++)c.writeSVarint(f[h])}function vT(f,c){for(let h=0;h<f.length;h++)c.writeFloat(f[h])}function bT(f,c){for(let h=0;h<f.length;h++)c.writeDouble(f[h])}function xT(f,c){for(let h=0;h<f.length;h++)c.writeBoolean(f[h])}function wT(f,c){for(let h=0;h<f.length;h++)c.writeFixed32(f[h])}function MT(f,c){for(let h=0;h<f.length;h++)c.writeSFixed32(f[h])}function ST(f,c){for(let h=0;h<f.length;h++)c.writeFixed64(f[h])}function TT(f,c){for(let h=0;h<f.length;h++)c.writeSFixed64(f[h])}function PT(f,c,h){f===1&&h.readMessage(Rk,c)}function Rk(f,c,h){if(f===3){const{id:v,bitmap:w,width:I,height:O,left:z,top:V,advance:J}=h.readMessage(ET,{});c.push({id:v,bitmap:new H_({width:I+6,height:O+6},w),metrics:{width:I,height:O,left:z,top:V,advance:J}})}}function ET(f,c,h){f===1?c.id=h.readVarint():f===2?c.bitmap=h.readBytes():f===3?c.width=h.readVarint():f===4?c.height=h.readVarint():f===5?c.left=h.readSVarint():f===6?c.top=h.readSVarint():f===7&&(c.advance=h.readVarint())}function Ux(f){let c=0,h=0;for(const O of f)c+=O.w*O.h,h=Math.max(h,O.w);f.sort((O,z)=>z.h-O.h);const v=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(c/.95)),h),h:1/0}];let w=0,I=0;for(const O of f)for(let z=v.length-1;z>=0;z--){const V=v[z];if(!(O.w>V.w||O.h>V.h)){if(O.x=V.x,O.y=V.y,I=Math.max(I,O.y+O.h),w=Math.max(w,O.x+O.w),O.w===V.w&&O.h===V.h){const J=v.pop();J&&z<v.length&&(v[z]=J)}else O.h===V.h?(V.x+=O.w,V.w-=O.w):O.w===V.w?(V.y+=O.h,V.h-=O.h):(v.push({x:V.x+O.w,y:V.y,w:V.w-O.w,h:O.h}),V.y+=O.h,V.h-=O.h);break}}return{w,h:I,fill:c/(w*I)||0}}class sv{constructor(c,{pixelRatio:h,version:v,stretchX:w,stretchY:I,content:O,textFitWidth:z,textFitHeight:V}){this.paddedRect=c,this.pixelRatio=h,this.stretchX=w,this.stretchY=I,this.content=O,this.version=v,this.textFitWidth=z,this.textFitHeight=V}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Vx{constructor(c,h){const v={},w={};this.haveRenderCallbacks=[];const I=[];this.addImages(c,v,I),this.addImages(h,w,I);const{w:O,h:z}=Ux(I),V=new kc({width:O||1,height:z||1});for(const J in c){const ne=c[J],me=v[J].paddedRect;kc.copy(ne.data,V,{x:0,y:0},{x:me.x+1,y:me.y+1},ne.data)}for(const J in h){const ne=h[J],me=w[J].paddedRect,Ee=me.x+1,je=me.y+1,Fe=ne.data.width,He=ne.data.height;kc.copy(ne.data,V,{x:0,y:0},{x:Ee,y:je},ne.data),kc.copy(ne.data,V,{x:0,y:He-1},{x:Ee,y:je-1},{width:Fe,height:1}),kc.copy(ne.data,V,{x:0,y:0},{x:Ee,y:je+He},{width:Fe,height:1}),kc.copy(ne.data,V,{x:Fe-1,y:0},{x:Ee-1,y:je},{width:1,height:He}),kc.copy(ne.data,V,{x:0,y:0},{x:Ee+Fe,y:je},{width:1,height:He})}this.image=V,this.iconPositions=v,this.patternPositions=w}addImages(c,h,v){for(const w in c){const I=c[w],O={x:0,y:0,w:I.data.width+2,h:I.data.height+2};v.push(O),h[w]=new sv(O,I),I.hasRenderCallback&&this.haveRenderCallbacks.push(w)}}patchUpdatedImages(c,h){c.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const v in c.updatedImages)this.patchUpdatedImage(this.iconPositions[v],c.getImage(v),h),this.patchUpdatedImage(this.patternPositions[v],c.getImage(v),h)}patchUpdatedImage(c,h,v){if(!c||!h||c.version===h.version)return;c.version=h.version;const[w,I]=c.tl;v.update(h.data,void 0,{x:w,y:I})}}var of;Re("ImagePosition",sv),Re("ImageAtlas",Vx),s.ao=void 0,(of=s.ao||(s.ao={}))[of.none=0]="none",of[of.horizontal=1]="horizontal",of[of.vertical=2]="vertical",of[of.horizontalOnly=3]="horizontalOnly";class bg{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(c,h,v){const w=new bg;return w.scale=c||1,w.fontStack=h,w.verticalAlign=v||"bottom",w}static forImage(c,h){const v=new bg;return v.imageName=c,v.verticalAlign=h||"bottom",v}}class xg{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(c,h){const v=new xg;for(let w=0;w<c.sections.length;w++){const I=c.sections[w];I.image?v.addImageSection(I):v.addTextSection(I,h)}return v}length(){return this.text.length}getSection(c){return this.sections[this.sectionIndex[c]]}getSectionIndex(c){return this.sectionIndex[c]}getCharCode(c){return this.text.charCodeAt(c)}verticalizePunctuation(){this.text=function(c){let h="";for(let v=0;v<c.length;v++){const w=c.charCodeAt(v+1)||null,I=c.charCodeAt(v-1)||null;h+=w&&zn(w)&&!yg[c[v+1]]||I&&zn(I)&&!yg[c[v-1]]||!yg[c[v]]?c[v]:yg[c[v]]}return h}(this.text)}trim(){let c=0;for(let v=0;v<this.text.length&&wg[this.text.charCodeAt(v)];v++)c++;let h=this.text.length;for(let v=this.text.length-1;v>=0&&v>=c&&wg[this.text.charCodeAt(v)];v--)h--;this.text=this.text.substring(c,h),this.sectionIndex=this.sectionIndex.slice(c,h)}substring(c,h){const v=new xg;return v.text=this.text.substring(c,h),v.sectionIndex=this.sectionIndex.slice(c,h),v.sections=this.sections,v}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((c,h)=>Math.max(c,this.sections[h].scale),0)}getMaxImageSize(c){let h=0,v=0;for(let w=0;w<this.length();w++){const I=this.getSection(w);if(I.imageName){const O=c[I.imageName];if(!O)continue;const z=O.displaySize;h=Math.max(h,z[0]),v=Math.max(v,z[1])}}return{maxImageWidth:h,maxImageHeight:v}}addTextSection(c,h){this.text+=c.text,this.sections.push(bg.forText(c.scale,c.fontStack||h,c.verticalAlign));const v=this.sections.length-1;for(let w=0;w<c.text.length;++w)this.sectionIndex.push(v)}addImageSection(c){const h=c.image?c.image.name:"";if(h.length===0)return void Xe("Can't add FormattedSection with an empty image.");const v=this.getNextImageSectionCharCode();v?(this.text+=String.fromCharCode(v),this.sections.push(bg.forImage(h,c.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):Xe("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function J_(f,c,h,v,w,I,O,z,V,J,ne,me,Ee,je,Fe){const He=xg.fromFeature(f,w);let st;me===s.ao.vertical&&He.verticalizePunctuation();const{processBidirectionalText:yt,processStyledBidirectionalText:Xt}=Ro;if(yt&&He.sections.length===1){st=[];const lr=yt(He.toString(),lv(He,J,I,c,v,je));for(const vr of lr){const Fr=new xg;Fr.text=vr,Fr.sections=He.sections;for(let pn=0;pn<vr.length;pn++)Fr.sectionIndex.push(0);st.push(Fr)}}else if(Xt){st=[];const lr=Xt(He.text,He.sectionIndex,lv(He,J,I,c,v,je));for(const vr of lr){const Fr=new xg;Fr.text=vr[0],Fr.sectionIndex=vr[1],Fr.sections=He.sections,st.push(Fr)}}else st=function(lr,vr){const Fr=[],pn=lr.text;let tn=0;for(const un of vr)Fr.push(lr.substring(tn,un)),tn=un;return tn<pn.length&&Fr.push(lr.substring(tn,pn.length)),Fr}(He,lv(He,J,I,c,v,je));const Ct=[],Rt={positionedLines:Ct,text:He.toString(),top:ne[1],bottom:ne[1],left:ne[0],right:ne[0],writingMode:me,iconsInText:!1,verticalizable:!1};return function(lr,vr,Fr,pn,tn,un,Rn,ln,dn,Cr,oi,gi){let Hn=0,Dn=0,ho=0,ms=0;const Tl=ln==="right"?1:ln==="left"?0:.5,Oc=Vs/gi;let Ld=0;for(const Ja of tn){Ja.trim();const Bl=Ja.getMaxScale(),sc={positionedGlyphs:[],lineOffset:0};lr.positionedLines[Ld]=sc;const lc=sc.positionedGlyphs;let pu=0;if(!Ja.length()){Dn+=un,++Ld;continue}const Dd=IT(pn,Ja,Oc);for(let $u=0;$u<Ja.length();$u++){const Pl=Ja.getSection($u),Vl=Ja.getSectionIndex($u),Wl=Ja.getCharCode($u),il=OT(dn,oi,Wl);let Ca;if(Pl.imageName){if(lr.iconsInText=!0,Pl.scale=Pl.scale*Oc,Ca=DT(Pl,il,Bl,Dd,pn),!Ca)continue;pu=Math.max(pu,Ca.imageOffset)}else if(Ca=LT(Pl,Wl,il,Dd,vr,Fr),!Ca)continue;const{rect:cf,metrics:_v,baselineOffset:uf}=Ca;lc.push({glyph:Wl,imageName:Pl.imageName,x:Hn,y:Dn+uf+-17,vertical:il,scale:Pl.scale,fontStack:Pl.fontStack,sectionIndex:Vl,metrics:_v,rect:cf}),il?(lr.verticalizable=!0,Hn+=(Pl.imageName?_v.advance:Vs)*Pl.scale+Cr):Hn+=_v.advance*Pl.scale+Cr}lc.length!==0&&(ho=Math.max(Hn-Cr,ho),$T(lc,0,lc.length-1,Tl)),Hn=0,sc.lineOffset=Math.max(pu,(Bl-1)*Vs);const Ul=un*Bl+pu;Dn+=Ul,ms=Math.max(Ul,ms),++Ld}const{horizontalAlign:Du,verticalAlign:ac}=cv(Rn);(function(Ja,Bl,sc,lc,pu,Dd,Ul,$u,Pl){const Vl=(Bl-sc)*pu;let Wl=0;Wl=Dd!==Ul?-$u*lc- -17:-lc*Pl*Ul+.5*Ul;for(const il of Ja)for(const Ca of il.positionedGlyphs)Ca.x+=Vl,Ca.y+=Wl})(lr.positionedLines,Tl,Du,ac,ho,ms,un,Dn,tn.length),lr.top+=-ac*Dn,lr.bottom=lr.top+Dn,lr.left+=-Du*ho,lr.right=lr.left+ho}(Rt,c,h,v,st,O,z,V,me,J,Ee,Fe),!function(lr){for(const vr of lr)if(vr.positionedGlyphs.length!==0)return!1;return!0}(Ct)&&Rt}const wg={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},AT={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},CT={40:!0};function Wx(f,c,h,v,w,I){if(c.imageName){const O=v[c.imageName];return O?O.displaySize[0]*c.scale*Vs/I+w:0}{const O=h[c.fontStack],z=O&&O[f];return z?z.metrics.advance*c.scale+w:0}}function Gx(f,c,h,v){const w=Math.pow(f-c,2);return v?f<c?w/2:2*w:w+Math.abs(h)*h}function kT(f,c,h){let v=0;return f===10&&(v-=1e4),h&&(v+=150),f!==40&&f!==65288||(v+=50),c!==41&&c!==65289||(v+=50),v}function qx(f,c,h,v,w,I){let O=null,z=Gx(c,h,w,I);for(const V of v){const J=Gx(c-V.x,h,w,I)+V.badness;J<=z&&(O=V,z=J)}return{index:f,x:c,priorBreak:O,badness:z}}function Hx(f){return f?Hx(f.priorBreak).concat(f.index):[]}function lv(f,c,h,v,w,I){if(!f)return[];const O=[],z=function(me,Ee,je,Fe,He,st){let yt=0;for(let Xt=0;Xt<me.length();Xt++){const Ct=me.getSection(Xt);yt+=Wx(me.getCharCode(Xt),Ct,Fe,He,Ee,st)}return yt/Math.max(1,Math.ceil(yt/je))}(f,c,h,v,w,I),V=f.text.indexOf("​")>=0;let J=0;for(let me=0;me<f.length();me++){const Ee=f.getSection(me),je=f.getCharCode(me);if(wg[je]||(J+=Wx(je,Ee,v,w,c,I)),me<f.length()-1){const Fe=!((ne=je)<11904)&&(!!Nt["CJK Compatibility Forms"](ne)||!!Nt["CJK Compatibility"](ne)||!!Nt["CJK Strokes"](ne)||!!Nt["CJK Symbols and Punctuation"](ne)||!!Nt["Enclosed CJK Letters and Months"](ne)||!!Nt["Halfwidth and Fullwidth Forms"](ne)||!!Nt["Ideographic Description Characters"](ne)||!!Nt["Vertical Forms"](ne)||Zr.test(String.fromCodePoint(ne)));(AT[je]||Fe||Ee.imageName||me!==f.length()-2&&CT[f.getCharCode(me+1)])&&O.push(qx(me+1,J,z,O,kT(je,f.getCharCode(me+1),Fe&&V),!1))}}var ne;return Hx(qx(f.length(),J,z,O,0,!0))}function cv(f){let c=.5,h=.5;switch(f){case"right":case"top-right":case"bottom-right":c=1;break;case"left":case"top-left":case"bottom-left":c=0}switch(f){case"bottom":case"bottom-right":case"bottom-left":h=1;break;case"top":case"top-right":case"top-left":h=0}return{horizontalAlign:c,verticalAlign:h}}function IT(f,c,h){const v=c.getMaxScale()*Vs,{maxImageWidth:w,maxImageHeight:I}=c.getMaxImageSize(f),O=Math.max(v,I*h);return{verticalLineContentWidth:Math.max(v,w*h),horizontalLineContentHeight:O}}function Kx(f){switch(f){case"top":return 0;case"center":return .5;default:return 1}}function OT(f,c,h){return!(f===s.ao.horizontal||!c&&!Ur(h)||c&&(wg[h]||(v=h,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(v)))));var v}function LT(f,c,h,v,w,I){const O=I[f.fontStack],z=function(J,ne,me,Ee){if(J&&J.rect)return J;const je=ne[me.fontStack],Fe=je&&je[Ee];return Fe?{rect:null,metrics:Fe.metrics}:null}(O&&O[c],w,f,c);if(z===null)return null;let V;if(h)V=v.verticalLineContentWidth-f.scale*Vs;else{const J=Kx(f.verticalAlign);V=(v.horizontalLineContentHeight-f.scale*Vs)*J}return{rect:z.rect,metrics:z.metrics,baselineOffset:V}}function DT(f,c,h,v,w){const I=w[f.imageName];if(!I)return null;const O=I.paddedRect,z=I.displaySize,V={width:z[0],height:z[1],left:1,top:-3,advance:c?z[1]:z[0]};let J;if(c)J=v.verticalLineContentWidth-z[1]*f.scale;else{const ne=Kx(f.verticalAlign);J=(v.horizontalLineContentHeight-z[1]*f.scale)*ne}return{rect:O,metrics:V,baselineOffset:J,imageOffset:(c?z[0]:z[1])*f.scale-Vs*h}}function $T(f,c,h,v){if(v===0)return;const w=f[h],I=(f[h].x+w.metrics.advance*w.scale)*v;for(let O=c;O<=h;O++)f[O].x-=I}function NT(f,c,h){const{horizontalAlign:v,verticalAlign:w}=cv(h),I=c[0]-f.displaySize[0]*v,O=c[1]-f.displaySize[1]*w;return{image:f,top:O,bottom:O+f.displaySize[1],left:I,right:I+f.displaySize[0]}}function Zx(f){var c,h;let v=f.left,w=f.top,I=f.right-v,O=f.bottom-w;const z=(c=f.image.textFitWidth)!==null&&c!==void 0?c:"stretchOrShrink",V=(h=f.image.textFitHeight)!==null&&h!==void 0?h:"stretchOrShrink",J=(f.image.content[2]-f.image.content[0])/(f.image.content[3]-f.image.content[1]);if(V==="proportional"){if(z==="stretchOnly"&&I/O<J||z==="proportional"){const ne=Math.ceil(O*J);v*=ne/I,I=ne}}else if(z==="proportional"&&V==="stretchOnly"&&J!==0&&I/O>J){const ne=Math.ceil(I/J);w*=ne/O,O=ne}return{x1:v,y1:w,x2:v+I,y2:w+O}}function Xx(f,c,h,v,w,I){const O=f.image;let z;if(O.content){const st=O.content,yt=O.pixelRatio||1;z=[st[0]/yt,st[1]/yt,O.displaySize[0]-st[2]/yt,O.displaySize[1]-st[3]/yt]}const V=c.left*I,J=c.right*I;let ne,me,Ee,je;h==="width"||h==="both"?(je=w[0]+V-v[3],me=w[0]+J+v[1]):(je=w[0]+(V+J-O.displaySize[0])/2,me=je+O.displaySize[0]);const Fe=c.top*I,He=c.bottom*I;return h==="height"||h==="both"?(ne=w[1]+Fe-v[0],Ee=w[1]+He+v[2]):(ne=w[1]+(Fe+He-O.displaySize[1])/2,Ee=ne+O.displaySize[1]),{image:O,top:ne,right:me,bottom:Ee,left:je,collisionPadding:z}}const gh=128,af=32640;function Yx(f,c){const{expression:h}=c;if(h.kind==="constant")return{kind:"constant",layoutSize:h.evaluate(new En(f+1))};if(h.kind==="source")return{kind:"source"};{const{zoomStops:v,interpolationType:w}=h;let I=0;for(;I<v.length&&v[I]<=f;)I++;I=Math.max(0,I-1);let O=I;for(;O<v.length&&v[O]<f+1;)O++;O=Math.min(v.length-1,O);const z=v[I],V=v[O];return h.kind==="composite"?{kind:"composite",minZoom:z,maxZoom:V,interpolationType:w}:{kind:"camera",minZoom:z,maxZoom:V,minSize:h.evaluate(new En(z)),maxSize:h.evaluate(new En(V)),interpolationType:w}}}function uv(f,c,h){let v="never";const w=f.get(c);return w?v=w:f.get(h)&&(v="always"),v}const jT=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function ey(f,c,h,v,w,I,O,z,V,J,ne,me,Ee){const je=z?Math.min(af,Math.round(z[0])):0,Fe=z?Math.min(af,Math.round(z[1])):0;f.emplaceBack(c,h,Math.round(32*v),Math.round(32*w),I,O,(je<<1)+(V?1:0),Fe,16*J,16*ne,256*me,256*Ee)}function dv(f,c,h){f.emplaceBack(c.x,c.y,h),f.emplaceBack(c.x,c.y,h),f.emplaceBack(c.x,c.y,h),f.emplaceBack(c.x,c.y,h)}function RT(f){for(const c of f.sections)if(Gi(c.text))return!0;return!1}class hv{constructor(c){this.layoutVertexArray=new Yr,this.indexArray=new go,this.programConfigurations=c,this.segments=new ei,this.dynamicLayoutVertexArray=new $r,this.opacityVertexArray=new Tn,this.hasVisibleVertices=!1,this.placedSymbolArray=new Ue}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(c,h,v,w){this.isEmpty()||(v&&(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,mT.members),this.indexBuffer=c.createIndexBuffer(this.indexArray,h),this.dynamicLayoutVertexBuffer=c.createVertexBuffer(this.dynamicLayoutVertexArray,gT.members,!0),this.opacityVertexBuffer=c.createVertexBuffer(this.opacityVertexArray,jT,!0),this.opacityVertexBuffer.itemSize=1),(v||w)&&this.programConfigurations.upload(c))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Re("SymbolBuffers",hv);class fv{constructor(c,h,v){this.layoutVertexArray=new c,this.layoutAttributes=h,this.indexArray=new v,this.segments=new ei,this.collisionVertexArray=new uo}upload(c){this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=c.createVertexBuffer(this.collisionVertexArray,_T.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Re("CollisionBuffers",fv);class hm{constructor(c){this.collisionBoxArray=c.collisionBoxArray,this.zoom=c.zoom,this.globalState=c.globalState,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(O=>O.id),this.index=c.index,this.pixelRatio=c.pixelRatio,this.sourceLayerIndex=c.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const h=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Yx(this.zoom,h["text-size"]),this.iconSizeData=Yx(this.zoom,h["icon-size"]);const v=this.layers[0].layout,w=v.get("symbol-sort-key"),I=v.get("symbol-z-order");this.canOverlap=uv(v,"text-overlap","text-allow-overlap")!=="never"||uv(v,"icon-overlap","icon-allow-overlap")!=="never"||v.get("text-ignore-placement")||v.get("icon-ignore-placement"),this.sortFeaturesByKey=I!=="viewport-y"&&!w.isConstant(),this.sortFeaturesByY=(I==="viewport-y"||I==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,v.get("symbol-placement")==="point"&&(this.writingModes=v.get("text-writing-mode").map(O=>s.ao[O])),this.stateDependentLayerIds=this.layers.filter(O=>O.isStateDependent()).map(O=>O.id),this.sourceID=c.sourceID}createArrays(){this.text=new hv(new Cc(this.layers,this.zoom,c=>/^text/.test(c))),this.icon=new hv(new Cc(this.layers,this.zoom,c=>/^icon/.test(c))),this.glyphOffsetArray=new ft,this.lineVertexArray=new gt,this.symbolInstances=new it,this.textAnchorOffsets=new Mt}calculateGlyphDependencies(c,h,v,w,I){for(let O=0;O<c.length;O++)if(h[c.charCodeAt(O)]=!0,(v||w)&&I){const z=yg[c.charAt(O)];z&&(h[z.charCodeAt(0)]=!0)}}populate(c,h,v){const w=this.layers[0],I=w.layout,O=I.get("text-font"),z=I.get("text-field"),V=I.get("icon-image"),J=(z.value.kind!=="constant"||z.value.value instanceof Ai&&!z.value.value.isEmpty()||z.value.value.toString().length>0)&&(O.value.kind!=="constant"||O.value.value.length>0),ne=V.value.kind!=="constant"||!!V.value.value||Object.keys(V.parameters).length>0,me=I.get("symbol-sort-key");if(this.features=[],!J&&!ne)return;const Ee=h.iconDependencies,je=h.glyphDependencies,Fe=h.availableImages,He=new En(this.zoom,{globalState:this.globalState});for(const{feature:st,id:yt,index:Xt,sourceLayerIndex:Ct}of c){const Rt=w._featureFilter.needGeometry,lr=nd(st,Rt);if(!w._featureFilter.filter(He,lr,v))continue;let vr,Fr;if(Rt||(lr.geometry=Od(st)),J){const tn=w.getValueAndResolveTokens("text-field",lr,v,Fe),un=Ai.factory(tn),Rn=this.hasRTLText=this.hasRTLText||RT(un);(!Rn||Ro.getRTLTextPluginStatus()==="unavailable"||Rn&&Ro.isParsed())&&(vr=jk(un,w,lr))}if(ne){const tn=w.getValueAndResolveTokens("icon-image",lr,v,Fe);Fr=tn instanceof lo?tn:lo.fromString(tn)}if(!vr&&!Fr)continue;const pn=this.sortFeaturesByKey?me.evaluate(lr,{},v):void 0;if(this.features.push({id:yt,text:vr,icon:Fr,index:Xt,sourceLayerIndex:Ct,geometry:lr.geometry,properties:st.properties,type:gp.types[st.type],sortKey:pn}),Fr&&(Ee[Fr.name]=!0),vr){const tn=O.evaluate(lr,{},v).join(","),un=I.get("text-rotation-alignment")!=="viewport"&&I.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(s.ao.vertical)>=0;for(const Rn of vr.sections)if(Rn.image)Ee[Rn.image.name]=!0;else{const ln=tr(vr.toString()),dn=Rn.fontStack||tn,Cr=je[dn]=je[dn]||{};this.calculateGlyphDependencies(Rn.text,Cr,un,this.allowVerticalPlacement,ln)}}}I.get("symbol-placement")==="line"&&(this.features=function(st){const yt={},Xt={},Ct=[];let Rt=0;function lr(tn){Ct.push(st[tn]),Rt++}function vr(tn,un,Rn){const ln=Xt[tn];return delete Xt[tn],Xt[un]=ln,Ct[ln].geometry[0].pop(),Ct[ln].geometry[0]=Ct[ln].geometry[0].concat(Rn[0]),ln}function Fr(tn,un,Rn){const ln=yt[un];return delete yt[un],yt[tn]=ln,Ct[ln].geometry[0].shift(),Ct[ln].geometry[0]=Rn[0].concat(Ct[ln].geometry[0]),ln}function pn(tn,un,Rn){const ln=Rn?un[0][un[0].length-1]:un[0][0];return`${tn}:${ln.x}:${ln.y}`}for(let tn=0;tn<st.length;tn++){const un=st[tn],Rn=un.geometry,ln=un.text?un.text.toString():null;if(!ln){lr(tn);continue}const dn=pn(ln,Rn),Cr=pn(ln,Rn,!0);if(dn in Xt&&Cr in yt&&Xt[dn]!==yt[Cr]){const oi=Fr(dn,Cr,Rn),gi=vr(dn,Cr,Ct[oi].geometry);delete yt[dn],delete Xt[Cr],Xt[pn(ln,Ct[gi].geometry,!0)]=gi,Ct[oi].geometry=null}else dn in Xt?vr(dn,Cr,Rn):Cr in yt?Fr(dn,Cr,Rn):(lr(tn),yt[dn]=Rt-1,Xt[Cr]=Rt-1)}return Ct.filter(tn=>tn.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((st,yt)=>st.sortKey-yt.sortKey)}update(c,h,v){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(c,h,this.layers,{imagePositions:v,globalState:this.globalState}),this.icon.programConfigurations.updatePaintArrays(c,h,this.layers,{imagePositions:v,globalState:this.globalState}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(c){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(c),this.iconCollisionBox.upload(c)),this.text.upload(c,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(c,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(c,h){const v=this.lineVertexArray.length;if(c.segment!==void 0){let w=c.dist(h[c.segment+1]),I=c.dist(h[c.segment]);const O={};for(let z=c.segment+1;z<h.length;z++)O[z]={x:h[z].x,y:h[z].y,tileUnitDistanceFromAnchor:w},z<h.length-1&&(w+=h[z+1].dist(h[z]));for(let z=c.segment||0;z>=0;z--)O[z]={x:h[z].x,y:h[z].y,tileUnitDistanceFromAnchor:I},z>0&&(I+=h[z-1].dist(h[z]));for(let z=0;z<h.length;z++){const V=O[z];this.lineVertexArray.emplaceBack(V.x,V.y,V.tileUnitDistanceFromAnchor)}}return{lineStartIndex:v,lineLength:this.lineVertexArray.length-v}}addSymbols(c,h,v,w,I,O,z,V,J,ne,me,Ee){const je=c.indexArray,Fe=c.layoutVertexArray,He=c.segments.prepareSegment(4*h.length,Fe,je,this.canOverlap?O.sortKey:void 0),st=this.glyphOffsetArray.length,yt=He.vertexLength,Xt=this.allowVerticalPlacement&&z===s.ao.vertical?Math.PI/2:0,Ct=O.text&&O.text.sections;for(let Rt=0;Rt<h.length;Rt++){const{tl:lr,tr:vr,bl:Fr,br:pn,tex:tn,pixelOffsetTL:un,pixelOffsetBR:Rn,minFontScaleX:ln,minFontScaleY:dn,glyphOffset:Cr,isSDF:oi,sectionIndex:gi}=h[Rt],Hn=He.vertexLength,Dn=Cr[1];ey(Fe,V.x,V.y,lr.x,Dn+lr.y,tn.x,tn.y,v,oi,un.x,un.y,ln,dn),ey(Fe,V.x,V.y,vr.x,Dn+vr.y,tn.x+tn.w,tn.y,v,oi,Rn.x,un.y,ln,dn),ey(Fe,V.x,V.y,Fr.x,Dn+Fr.y,tn.x,tn.y+tn.h,v,oi,un.x,Rn.y,ln,dn),ey(Fe,V.x,V.y,pn.x,Dn+pn.y,tn.x+tn.w,tn.y+tn.h,v,oi,Rn.x,Rn.y,ln,dn),dv(c.dynamicLayoutVertexArray,V,Xt),je.emplaceBack(Hn,Hn+2,Hn+1),je.emplaceBack(Hn+1,Hn+2,Hn+3),He.vertexLength+=4,He.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Cr[0]),Rt!==h.length-1&&gi===h[Rt+1].sectionIndex||c.programConfigurations.populatePaintArrays(Fe.length,O,O.index,{imagePositions:{},canonical:Ee,formattedSection:Ct&&Ct[gi],globalState:this.globalState})}c.placedSymbolArray.emplaceBack(V.x,V.y,st,this.glyphOffsetArray.length-st,yt,J,ne,V.segment,v?v[0]:0,v?v[1]:0,w[0],w[1],z,0,!1,0,me)}_addCollisionDebugVertex(c,h,v,w,I,O){return h.emplaceBack(0,0),c.emplaceBack(v.x,v.y,w,I,Math.round(O.x),Math.round(O.y))}addCollisionDebugVertices(c,h,v,w,I,O,z){const V=I.segments.prepareSegment(4,I.layoutVertexArray,I.indexArray),J=V.vertexLength,ne=I.layoutVertexArray,me=I.collisionVertexArray,Ee=z.anchorX,je=z.anchorY;this._addCollisionDebugVertex(ne,me,O,Ee,je,new u(c,h)),this._addCollisionDebugVertex(ne,me,O,Ee,je,new u(v,h)),this._addCollisionDebugVertex(ne,me,O,Ee,je,new u(v,w)),this._addCollisionDebugVertex(ne,me,O,Ee,je,new u(c,w)),V.vertexLength+=4;const Fe=I.indexArray;Fe.emplaceBack(J,J+1),Fe.emplaceBack(J+1,J+2),Fe.emplaceBack(J+2,J+3),Fe.emplaceBack(J+3,J),V.primitiveLength+=4}addDebugCollisionBoxes(c,h,v,w){for(let I=c;I<h;I++){const O=this.collisionBoxArray.get(I);this.addCollisionDebugVertices(O.x1,O.y1,O.x2,O.y2,w?this.textCollisionBox:this.iconCollisionBox,O.anchorPoint,v)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new fv(mi,av.members,bo),this.iconCollisionBox=new fv(mi,av.members,bo);for(let c=0;c<this.symbolInstances.length;c++){const h=this.symbolInstances.get(c);this.addDebugCollisionBoxes(h.textBoxStartIndex,h.textBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.iconBoxStartIndex,h.iconBoxEndIndex,h,!1),this.addDebugCollisionBoxes(h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex,h,!1)}}_deserializeCollisionBoxesForSymbol(c,h,v,w,I,O,z,V,J){const ne={};for(let me=h;me<v;me++){const Ee=c.get(me);ne.textBox={x1:Ee.x1,y1:Ee.y1,x2:Ee.x2,y2:Ee.y2,anchorPointX:Ee.anchorPointX,anchorPointY:Ee.anchorPointY},ne.textFeatureIndex=Ee.featureIndex;break}for(let me=w;me<I;me++){const Ee=c.get(me);ne.verticalTextBox={x1:Ee.x1,y1:Ee.y1,x2:Ee.x2,y2:Ee.y2,anchorPointX:Ee.anchorPointX,anchorPointY:Ee.anchorPointY},ne.verticalTextFeatureIndex=Ee.featureIndex;break}for(let me=O;me<z;me++){const Ee=c.get(me);ne.iconBox={x1:Ee.x1,y1:Ee.y1,x2:Ee.x2,y2:Ee.y2,anchorPointX:Ee.anchorPointX,anchorPointY:Ee.anchorPointY},ne.iconFeatureIndex=Ee.featureIndex;break}for(let me=V;me<J;me++){const Ee=c.get(me);ne.verticalIconBox={x1:Ee.x1,y1:Ee.y1,x2:Ee.x2,y2:Ee.y2,anchorPointX:Ee.anchorPointX,anchorPointY:Ee.anchorPointY},ne.verticalIconFeatureIndex=Ee.featureIndex;break}return ne}deserializeCollisionBoxes(c){this.collisionArrays=[];for(let h=0;h<this.symbolInstances.length;h++){const v=this.symbolInstances.get(h);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(c,v.textBoxStartIndex,v.textBoxEndIndex,v.verticalTextBoxStartIndex,v.verticalTextBoxEndIndex,v.iconBoxStartIndex,v.iconBoxEndIndex,v.verticalIconBoxStartIndex,v.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(c,h){const v=c.placedSymbolArray.get(h),w=v.vertexStartIndex+4*v.numGlyphs;for(let I=v.vertexStartIndex;I<w;I+=4)c.indexArray.emplaceBack(I,I+2,I+1),c.indexArray.emplaceBack(I+1,I+2,I+3)}getSortedSymbolIndexes(c){if(this.sortedAngle===c&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const h=Math.sin(c),v=Math.cos(c),w=[],I=[],O=[];for(let z=0;z<this.symbolInstances.length;++z){O.push(z);const V=this.symbolInstances.get(z);w.push(0|Math.round(h*V.anchorX+v*V.anchorY)),I.push(V.featureIndex)}return O.sort((z,V)=>w[z]-w[V]||I[V]-I[z]),O}addToSortKeyRanges(c,h){const v=this.sortKeyRanges[this.sortKeyRanges.length-1];v&&v.sortKey===h?v.symbolInstanceEnd=c+1:this.sortKeyRanges.push({sortKey:h,symbolInstanceStart:c,symbolInstanceEnd:c+1})}sortFeatures(c){if(this.sortFeaturesByY&&this.sortedAngle!==c&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(c),this.sortedAngle=c,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const h of this.symbolInstanceIndexes){const v=this.symbolInstances.get(h);this.featureSortOrder.push(v.featureIndex),[v.rightJustifiedTextSymbolIndex,v.centerJustifiedTextSymbolIndex,v.leftJustifiedTextSymbolIndex].forEach((w,I,O)=>{w>=0&&O.indexOf(w)===I&&this.addIndicesForPlacedSymbol(this.text,w)}),v.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,v.verticalPlacedTextSymbolIndex),v.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,v.placedIconSymbolIndex),v.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,v.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Qx,FT;Re("SymbolBucket",hm,{omit:["layers","collisionBoxArray","features","compareText"]}),hm.MAX_GLYPHS=65535,hm.addDynamicAttributes=dv;var xi={get paint(){return FT=FT||new wi({"icon-opacity":new xn($t.paint_symbol["icon-opacity"]),"icon-color":new xn($t.paint_symbol["icon-color"]),"icon-halo-color":new xn($t.paint_symbol["icon-halo-color"]),"icon-halo-width":new xn($t.paint_symbol["icon-halo-width"]),"icon-halo-blur":new xn($t.paint_symbol["icon-halo-blur"]),"icon-translate":new on($t.paint_symbol["icon-translate"]),"icon-translate-anchor":new on($t.paint_symbol["icon-translate-anchor"]),"text-opacity":new xn($t.paint_symbol["text-opacity"]),"text-color":new xn($t.paint_symbol["text-color"],{runtimeType:Vn,getOverride:f=>f.textColor,hasOverride:f=>!!f.textColor}),"text-halo-color":new xn($t.paint_symbol["text-halo-color"]),"text-halo-width":new xn($t.paint_symbol["text-halo-width"]),"text-halo-blur":new xn($t.paint_symbol["text-halo-blur"]),"text-translate":new on($t.paint_symbol["text-translate"]),"text-translate-anchor":new on($t.paint_symbol["text-translate-anchor"])})},get layout(){return Qx=Qx||new wi({"symbol-placement":new on($t.layout_symbol["symbol-placement"]),"symbol-spacing":new on($t.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new on($t.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new xn($t.layout_symbol["symbol-sort-key"]),"symbol-z-order":new on($t.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new on($t.layout_symbol["icon-allow-overlap"]),"icon-overlap":new on($t.layout_symbol["icon-overlap"]),"icon-ignore-placement":new on($t.layout_symbol["icon-ignore-placement"]),"icon-optional":new on($t.layout_symbol["icon-optional"]),"icon-rotation-alignment":new on($t.layout_symbol["icon-rotation-alignment"]),"icon-size":new xn($t.layout_symbol["icon-size"]),"icon-text-fit":new on($t.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new on($t.layout_symbol["icon-text-fit-padding"]),"icon-image":new xn($t.layout_symbol["icon-image"]),"icon-rotate":new xn($t.layout_symbol["icon-rotate"]),"icon-padding":new xn($t.layout_symbol["icon-padding"]),"icon-keep-upright":new on($t.layout_symbol["icon-keep-upright"]),"icon-offset":new xn($t.layout_symbol["icon-offset"]),"icon-anchor":new xn($t.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new on($t.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new on($t.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new on($t.layout_symbol["text-rotation-alignment"]),"text-field":new xn($t.layout_symbol["text-field"]),"text-font":new xn($t.layout_symbol["text-font"]),"text-size":new xn($t.layout_symbol["text-size"]),"text-max-width":new xn($t.layout_symbol["text-max-width"]),"text-line-height":new on($t.layout_symbol["text-line-height"]),"text-letter-spacing":new xn($t.layout_symbol["text-letter-spacing"]),"text-justify":new xn($t.layout_symbol["text-justify"]),"text-radial-offset":new xn($t.layout_symbol["text-radial-offset"]),"text-variable-anchor":new on($t.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new xn($t.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new xn($t.layout_symbol["text-anchor"]),"text-max-angle":new on($t.layout_symbol["text-max-angle"]),"text-writing-mode":new on($t.layout_symbol["text-writing-mode"]),"text-rotate":new xn($t.layout_symbol["text-rotate"]),"text-padding":new on($t.layout_symbol["text-padding"]),"text-keep-upright":new on($t.layout_symbol["text-keep-upright"]),"text-transform":new xn($t.layout_symbol["text-transform"]),"text-offset":new xn($t.layout_symbol["text-offset"]),"text-allow-overlap":new on($t.layout_symbol["text-allow-overlap"]),"text-overlap":new on($t.layout_symbol["text-overlap"]),"text-ignore-placement":new on($t.layout_symbol["text-ignore-placement"]),"text-optional":new on($t.layout_symbol["text-optional"])})}};class Jx{constructor(c){if(c.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=c.property.overrides?c.property.overrides.runtimeType:Mn,this.defaultValue=c}evaluate(c){if(c.formattedSection){const h=this.defaultValue.property.overrides;if(h&&h.hasOverride(c.formattedSection))return h.getOverride(c.formattedSection)}return c.feature&&c.featureState?this.defaultValue.evaluate(c.feature,c.featureState):this.defaultValue.property.specification.default}eachChild(c){this.defaultValue.isConstant()||c(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Re("FormatSectionOverride",Jx,{omit:["defaultValue"]});class fs extends Li{constructor(c){super(c,xi)}recalculate(c,h){if(super.recalculate(c,h),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const v=this.layout.get("text-writing-mode");if(v){const w=[];for(const I of v)w.indexOf(I)<0&&w.push(I);this.layout._values["text-writing-mode"]=w}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(c,h,v,w){const I=this.layout.get(c).evaluate(h,{},v,w),O=this._unevaluatedLayout._values[c];return O.isDataDriven()||wd(O.value)||!I?I:function(z,V){return V.replace(/{([^{}]+)}/g,(J,ne)=>z&&ne in z?String(z[ne]):"")}(h.properties,I)}createBucket(c){return new hm(c)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const c of xi.paint.overridableProperties){if(!fs.hasPaintOverride(this.layout,c))continue;const h=this.paint.get(c),v=new Jx(h),w=new xd(v,h.property.specification);let I=null;I=h.value.kind==="constant"||h.value.kind==="source"?new ku("source",w):new Jf("composite",w,h.value.zoomStops),this.paint._values[c]=new Wo(h.property,I,h.parameters)}}_handleOverridablePaintPropertyUpdate(c,h,v){return!(!this.layout||h.isDataDriven()||v.isDataDriven())&&fs.hasPaintOverride(this.layout,c)}static hasPaintOverride(c,h){const v=c.get("text-field"),w=xi.paint.properties[h];let I=!1;const O=z=>{for(const V of z)if(w.overrides&&w.overrides.hasOverride(V))return void(I=!0)};if(v.value.kind==="constant"&&v.value.value instanceof Ai)O(v.value.value.sections);else if(v.value.kind==="source"){const z=J=>{I||(J instanceof Mo&&bn(J.value)===Po?O(J.value.sections):J instanceof Pa?O(J.sections):J.eachChild(z))},V=v.value;V._styleExpression&&z(V._styleExpression.expression)}return I}}let el;var oc={get paint(){return el=el||new wi({"background-color":new on($t.paint_background["background-color"]),"background-pattern":new Xo($t.paint_background["background-pattern"]),"background-opacity":new on($t.paint_background["background-opacity"])})}};class fm extends Li{constructor(c){super(c,oc)}}let zT;var BT={get paint(){return zT=zT||new wi({"raster-opacity":new on($t.paint_raster["raster-opacity"]),"raster-hue-rotate":new on($t.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new on($t.paint_raster["raster-brightness-min"]),"raster-brightness-max":new on($t.paint_raster["raster-brightness-max"]),"raster-saturation":new on($t.paint_raster["raster-saturation"]),"raster-contrast":new on($t.paint_raster["raster-contrast"]),"raster-resampling":new on($t.paint_raster["raster-resampling"]),"raster-fade-duration":new on($t.paint_raster["raster-fade-duration"])})}};class UT extends Li{constructor(c){super(c,BT)}}class se extends Li{constructor(c){super(c,{}),this.onAdd=h=>{this.implementation.onAdd&&this.implementation.onAdd(h,h.painter.context.gl)},this.onRemove=h=>{this.implementation.onRemove&&this.implementation.onRemove(h,h.painter.context.gl)},this.implementation=c}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Me{constructor(c){this._methodToThrottle=c,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const qe={once:!0},zt=63710088e-1;class ir{constructor(c,h){if(isNaN(c)||isNaN(h))throw new Error(`Invalid LngLat object: (${c}, ${h})`);if(this.lng=+c,this.lat=+h,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ir(Ge(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(c){const h=Math.PI/180,v=this.lat*h,w=c.lat*h,I=Math.sin(v)*Math.sin(w)+Math.cos(v)*Math.cos(w)*Math.cos((c.lng-this.lng)*h);return zt*Math.acos(Math.min(I,1))}static convert(c){if(c instanceof ir)return c;if(Array.isArray(c)&&(c.length===2||c.length===3))return new ir(Number(c[0]),Number(c[1]));if(!Array.isArray(c)&&typeof c=="object"&&c!==null)return new ir(Number("lng"in c?c.lng:c.lon),Number(c.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const rr=2*Math.PI*zt;function Mr(f){return rr*Math.cos(f*Math.PI/180)}function Kr(f){return(180+f)/360}function sn(f){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+f*Math.PI/360)))/360}function _n(f,c){return f/Mr(c)}function qn(f){return 360/Math.PI*Math.atan(Math.exp((180-360*f)*Math.PI/180))-90}function fi(f,c){return f*Mr(qn(c))}class li{constructor(c,h,v=0){this.x=+c,this.y=+h,this.z=+v}static fromLngLat(c,h=0){const v=ir.convert(c);return new li(Kr(v.lng),sn(v.lat),_n(h,v.lat))}toLngLat(){return new ir(360*this.x-180,qn(this.y))}toAltitude(){return fi(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/rr*(c=qn(this.y),1/Math.cos(c*Math.PI/180));var c}}function io(f,c,h){var v=2*Math.PI*6378137/256/Math.pow(2,h);return[f*v-2*Math.PI*6378137/2,c*v-2*Math.PI*6378137/2]}class ti{constructor(c,h,v){if(!function(w,I,O){return!(w<0||w>25||O<0||O>=Math.pow(2,w)||I<0||I>=Math.pow(2,w))}(c,h,v))throw new Error(`x=${h}, y=${v}, z=${c} outside of bounds. 0<=x<${Math.pow(2,c)}, 0<=y<${Math.pow(2,c)} 0<=z<=25 `);this.z=c,this.x=h,this.y=v,this.key=$i(0,c,c,h,v)}equals(c){return this.z===c.z&&this.x===c.x&&this.y===c.y}url(c,h,v){const w=(O=this.y,z=this.z,V=io(256*(I=this.x),256*(O=Math.pow(2,z)-O-1),z),J=io(256*(I+1),256*(O+1),z),V[0]+","+V[1]+","+J[0]+","+J[1]);var I,O,z,V,J;const ne=function(me,Ee,je){let Fe,He="";for(let st=me;st>0;st--)Fe=1<<st-1,He+=(Ee&Fe?1:0)+(je&Fe?2:0);return He}(this.z,this.x,this.y);return c[(this.x+this.y)%c.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(v==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,h>1?"@2x":"").replace(/{quadkey}/g,ne).replace(/{bbox-epsg-3857}/g,w)}isChildOf(c){const h=this.z-c.z;return h>0&&c.x===this.x>>h&&c.y===this.y>>h}getTilePoint(c){const h=Math.pow(2,this.z);return new u((c.x*h-this.x)*fe,(c.y*h-this.y)*fe)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Di{constructor(c,h){this.wrap=c,this.canonical=h,this.key=$i(c,h.z,h.z,h.x,h.y)}}class Pn{constructor(c,h,v,w,I){if(this.terrainRttPosMatrix32f=null,c<v)throw new Error(`overscaledZ should be >= z; overscaledZ = ${c}; z = ${v}`);this.overscaledZ=c,this.wrap=h,this.canonical=new ti(v,+w,+I),this.key=$i(h,c,v,w,I)}clone(){return new Pn(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(c){return this.overscaledZ===c.overscaledZ&&this.wrap===c.wrap&&this.canonical.equals(c.canonical)}scaledTo(c){if(c>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${c}; overscaledZ = ${this.overscaledZ}`);const h=this.canonical.z-c;return c>this.canonical.z?new Pn(c,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Pn(c,this.wrap,c,this.canonical.x>>h,this.canonical.y>>h)}calculateScaledKey(c,h){if(c>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${c}; overscaledZ = ${this.overscaledZ}`);const v=this.canonical.z-c;return c>this.canonical.z?$i(this.wrap*+h,c,this.canonical.z,this.canonical.x,this.canonical.y):$i(this.wrap*+h,c,c,this.canonical.x>>v,this.canonical.y>>v)}isChildOf(c){if(c.wrap!==this.wrap)return!1;const h=this.canonical.z-c.canonical.z;return c.overscaledZ===0||c.overscaledZ<this.overscaledZ&&c.canonical.x===this.canonical.x>>h&&c.canonical.y===this.canonical.y>>h}children(c){if(this.overscaledZ>=c)return[new Pn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const h=this.canonical.z+1,v=2*this.canonical.x,w=2*this.canonical.y;return[new Pn(h,this.wrap,h,v,w),new Pn(h,this.wrap,h,v+1,w),new Pn(h,this.wrap,h,v,w+1),new Pn(h,this.wrap,h,v+1,w+1)]}isLessThan(c){return this.wrap<c.wrap||!(this.wrap>c.wrap)&&(this.overscaledZ<c.overscaledZ||!(this.overscaledZ>c.overscaledZ)&&(this.canonical.x<c.canonical.x||!(this.canonical.x>c.canonical.x)&&this.canonical.y<c.canonical.y))}wrapped(){return new Pn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(c){return new Pn(this.overscaledZ,c,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Di(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(c){return this.canonical.getTilePoint(new li(c.x-this.wrap,c.y))}}function $i(f,c,h,v,w){(f*=2)<0&&(f=-1*f-1);const I=1<<h;return(I*I*f+I*w+v).toString(36)+h.toString(36)+c.toString(36)}function Lo(f,c){return c?f.properties[c]:f.id}Re("CanonicalTileID",ti),Re("OverscaledTileID",Pn,{omit:["terrainRttPosMatrix32f"]});class Go{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(c){return this.minX=Math.min(this.minX,c.x),this.minY=Math.min(this.minY,c.y),this.maxX=Math.max(this.maxX,c.x),this.maxY=Math.max(this.maxY,c.y),this}expandBy(c){return this.minX-=c,this.minY-=c,this.maxX+=c,this.maxY+=c,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(c){return this.expandBy(-c)}map(c){const h=new Go;return h.extend(c(new u(this.minX,this.minY))),h.extend(c(new u(this.maxX,this.minY))),h.extend(c(new u(this.minX,this.maxY))),h.extend(c(new u(this.maxX,this.maxY))),h}static fromPoints(c){const h=new Go;for(const v of c)h.extend(v);return h}contains(c){return c.x>=this.minX&&c.x<=this.maxX&&c.y>=this.minY&&c.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(c){return!this.empty()&&!c.empty()&&c.minX>=this.minX&&c.maxX<=this.maxX&&c.minY>=this.minY&&c.maxY<=this.maxY}intersects(c){return!this.empty()&&!c.empty()&&c.minX<=this.maxX&&c.maxX>=this.minX&&c.minY<=this.maxY&&c.maxY>=this.minY}}class Qa{constructor(c){this._stringToNumber={},this._numberToString=[];for(let h=0;h<c.length;h++){const v=c[h];this._stringToNumber[v]=h,this._numberToString[h]=v}}encode(c){return this._stringToNumber[c]}decode(c){if(c>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${c} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[c]}}class za{constructor(c,h,v,w,I){this.type="Feature",this._vectorTileFeature=c,c._z=h,c._x=v,c._y=w,this.properties=c.properties,this.id=I}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(c){this._geometry=c}toJSON(){const c={geometry:this.geometry};for(const h in this)h!=="_geometry"&&h!=="_vectorTileFeature"&&(c[h]=this[h]);return c}}class Cs{constructor(c,h){this.tileID=c,this.x=c.canonical.x,this.y=c.canonical.y,this.z=c.canonical.z,this.grid=new Be(fe,16,0),this.grid3D=new Be(fe,16,0),this.featureIndexArray=new jt,this.promoteId=h}insert(c,h,v,w,I,O){const z=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(v,w,I);const V=O?this.grid3D:this.grid;for(let J=0;J<h.length;J++){const ne=h[J],me=[1/0,1/0,-1/0,-1/0];for(let Ee=0;Ee<ne.length;Ee++){const je=ne[Ee];me[0]=Math.min(me[0],je.x),me[1]=Math.min(me[1],je.y),me[2]=Math.max(me[2],je.x),me[3]=Math.max(me[3],je.y)}me[0]<fe&&me[1]<fe&&me[2]>=0&&me[3]>=0&&V.insert(z,me[0],me[1],me[2],me[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new kx(new zx(this.rawTileData)).layers,this.sourceLayerCoder=new Qa(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(c,h,v,w){this.loadVTLayers();const I=c.params,O=fe/c.tileSize/c.scale,z=ed(I.filter),V=c.queryGeometry,J=c.queryPadding*O,ne=Go.fromPoints(V),me=this.grid.query(ne.minX-J,ne.minY-J,ne.maxX+J,ne.maxY+J),Ee=Go.fromPoints(c.cameraQueryGeometry).expandBy(J),je=this.grid3D.query(Ee.minX,Ee.minY,Ee.maxX,Ee.maxY,(st,yt,Xt,Ct)=>function(Rt,lr,vr,Fr,pn){for(const un of Rt)if(lr<=un.x&&vr<=un.y&&Fr>=un.x&&pn>=un.y)return!0;const tn=[new u(lr,vr),new u(lr,pn),new u(Fr,pn),new u(Fr,vr)];if(Rt.length>2){for(const un of tn)if(sm(Rt,un))return!0}for(let un=0;un<Rt.length-1;un++)if(NS(Rt[un],Rt[un+1],tn))return!0;return!1}(c.cameraQueryGeometry,st-J,yt-J,Xt+J,Ct+J));for(const st of je)me.push(st);me.sort(Vi);const Fe={};let He;for(let st=0;st<me.length;st++){const yt=me[st];if(yt===He)continue;He=yt;const Xt=this.featureIndexArray.get(yt);let Ct=null;this.loadMatchingFeature(Fe,Xt.bucketIndex,Xt.sourceLayerIndex,Xt.featureIndex,z,I.layers,I.availableImages,h,v,w,(Rt,lr,vr)=>(Ct||(Ct=Od(Rt)),lr.queryIntersectsFeature({queryGeometry:V,feature:Rt,featureState:vr,geometry:Ct,zoom:this.z,transform:c.transform,pixelsToTileUnits:O,pixelPosMatrix:c.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:c.getElevation})))}return Fe}loadMatchingFeature(c,h,v,w,I,O,z,V,J,ne,me){const Ee=this.bucketLayerIDs[h];if(O&&!Ee.some(st=>O.has(st)))return;const je=this.sourceLayerCoder.decode(v),Fe=this.vtLayers[je].feature(w);if(I.needGeometry){const st=nd(Fe,!0);if(!I.filter(new En(this.tileID.overscaledZ),st,this.tileID.canonical))return}else if(!I.filter(new En(this.tileID.overscaledZ),Fe))return;const He=this.getId(Fe,je);for(let st=0;st<Ee.length;st++){const yt=Ee[st];if(O&&!O.has(yt))continue;const Xt=V[yt];if(!Xt)continue;let Ct={};He&&ne&&(Ct=ne.getState(Xt.sourceLayer||"_geojsonTileLayer",He));const Rt=ot({},J[yt]);Rt.paint=tl(Rt.paint,Xt.paint,Fe,Ct,z),Rt.layout=tl(Rt.layout,Xt.layout,Fe,Ct,z);const lr=!me||me(Fe,Xt,Ct);if(!lr)continue;const vr=new za(Fe,this.z,this.x,this.y,He);vr.layer=Rt;let Fr=c[yt];Fr===void 0&&(Fr=c[yt]=[]),Fr.push({featureIndex:w,feature:vr,intersectionZ:lr})}}lookupSymbolFeatures(c,h,v,w,I,O,z,V){const J={};this.loadVTLayers();const ne=ed(I);for(const me of c)this.loadMatchingFeature(J,v,w,me,ne,O,z,V,h);return J}hasLayer(c){for(const h of this.bucketLayerIDs)for(const v of h)if(c===v)return!0;return!1}getId(c,h){var v;let w=c.id;return this.promoteId&&(w=c.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[h]],typeof w=="boolean"&&(w=Number(w)),w===void 0&&(!((v=c.properties)===null||v===void 0)&&v.cluster)&&this.promoteId&&(w=Number(c.properties.cluster_id))),w}}function tl(f,c,h,v,w){return et(f,(I,O)=>{const z=c instanceof Ha?c.get(O):null;return z&&z.evaluate?z.evaluate(h,v,w):z})}function Vi(f,c){return c-f}function Ws(f,c,h,v,w){const I=[];for(let O=0;O<f.length;O++){const z=f[O];let V;for(let J=0;J<z.length-1;J++){let ne=z[J],me=z[J+1];ne.x<c&&me.x<c||(ne.x<c?ne=new u(c,ne.y+(c-ne.x)/(me.x-ne.x)*(me.y-ne.y))._round():me.x<c&&(me=new u(c,ne.y+(c-ne.x)/(me.x-ne.x)*(me.y-ne.y))._round()),ne.y<h&&me.y<h||(ne.y<h?ne=new u(ne.x+(h-ne.y)/(me.y-ne.y)*(me.x-ne.x),h)._round():me.y<h&&(me=new u(ne.x+(h-ne.y)/(me.y-ne.y)*(me.x-ne.x),h)._round()),ne.x>=v&&me.x>=v||(ne.x>=v?ne=new u(v,ne.y+(v-ne.x)/(me.x-ne.x)*(me.y-ne.y))._round():me.x>=v&&(me=new u(v,ne.y+(v-ne.x)/(me.x-ne.x)*(me.y-ne.y))._round()),ne.y>=w&&me.y>=w||(ne.y>=w?ne=new u(ne.x+(w-ne.y)/(me.y-ne.y)*(me.x-ne.x),w)._round():me.y>=w&&(me=new u(ne.x+(w-ne.y)/(me.y-ne.y)*(me.x-ne.x),w)._round()),V&&ne.equals(V[V.length-1])||(V=[ne],I.push(V)),V.push(me)))))}}return I}Re("FeatureIndex",Cs,{omit:["rawTileData","sourceLayerCoder"]});class rl extends u{constructor(c,h,v,w){super(c,h),this.angle=v,w!==void 0&&(this.segment=w)}clone(){return new rl(this.x,this.y,this.angle,this.segment)}}function _p(f,c,h,v,w){if(c.segment===void 0||h===0)return!0;let I=c,O=c.segment+1,z=0;for(;z>-h/2;){if(O--,O<0)return!1;z-=f[O].dist(I),I=f[O]}z+=f[O].dist(f[O+1]),O++;const V=[];let J=0;for(;z<h/2;){const ne=f[O],me=f[O+1];if(!me)return!1;let Ee=f[O-1].angleTo(ne)-ne.angleTo(me);for(Ee=Math.abs((Ee+3*Math.PI)%(2*Math.PI)-Math.PI),V.push({distance:z,angleDelta:Ee}),J+=Ee;z-V[0].distance>v;)J-=V.shift().angleDelta;if(J>w)return!1;O++,z+=ne.dist(me)}return!0}function Ic(f){let c=0;for(let h=0;h<f.length-1;h++)c+=f[h].dist(f[h+1]);return c}function Ou(f,c,h){return f?.6*c*h:0}function ty(f,c){return Math.max(f?f.right-f.left:0,c?c.right-c.left:0)}function pm(f,c,h,v,w,I){const O=Ou(h,w,I),z=ty(h,v)*I;let V=0;const J=Ic(f)/2;for(let ne=0;ne<f.length-1;ne++){const me=f[ne],Ee=f[ne+1],je=me.dist(Ee);if(V+je>J){const Fe=(J-V)/je,He=Xn.number(me.x,Ee.x,Fe),st=Xn.number(me.y,Ee.y,Fe),yt=new rl(He,st,Ee.angleTo(me),ne);return yt._round(),!O||_p(f,yt,z,O,c)?yt:void 0}V+=je}}function pv(f,c,h,v,w,I,O,z,V){const J=Ou(v,I,O),ne=ty(v,w),me=ne*O,Ee=f[0].x===0||f[0].x===V||f[0].y===0||f[0].y===V;return c-me<c/4&&(c=me+c/4),ry(f,Ee?c/2*z%c:(ne/2+2*I)*O*z%c,c,J,h,me,Ee,!1,V)}function ry(f,c,h,v,w,I,O,z,V){const J=I/2,ne=Ic(f);let me=0,Ee=c-h,je=[];for(let Fe=0;Fe<f.length-1;Fe++){const He=f[Fe],st=f[Fe+1],yt=He.dist(st),Xt=st.angleTo(He);for(;Ee+h<me+yt;){Ee+=h;const Ct=(Ee-me)/yt,Rt=Xn.number(He.x,st.x,Ct),lr=Xn.number(He.y,st.y,Ct);if(Rt>=0&&Rt<V&&lr>=0&&lr<V&&Ee-J>=0&&Ee+J<=ne){const vr=new rl(Rt,lr,Xt,Fe);vr._round(),v&&!_p(f,vr,I,v,w)||je.push(vr)}}me+=yt}return z||je.length||O||(je=ry(f,me/2,h,v,w,I,O,!0,V)),je}function wa(f,c,h,v){const w=[],I=f.image,O=I.pixelRatio,z=I.paddedRect.w-2,V=I.paddedRect.h-2;let J={x1:f.left,y1:f.top,x2:f.right,y2:f.bottom};const ne=I.stretchX||[[0,z]],me=I.stretchY||[[0,V]],Ee=(Cr,oi)=>Cr+oi[1]-oi[0],je=ne.reduce(Ee,0),Fe=me.reduce(Ee,0),He=z-je,st=V-Fe;let yt=0,Xt=je,Ct=0,Rt=Fe,lr=0,vr=He,Fr=0,pn=st;if(I.content&&v){const Cr=I.content,oi=Cr[2]-Cr[0],gi=Cr[3]-Cr[1];(I.textFitWidth||I.textFitHeight)&&(J=Zx(f)),yt=ps(ne,0,Cr[0]),Ct=ps(me,0,Cr[1]),Xt=ps(ne,Cr[0],Cr[2]),Rt=ps(me,Cr[1],Cr[3]),lr=Cr[0]-yt,Fr=Cr[1]-Ct,vr=oi-Xt,pn=gi-Rt}const tn=J.x1,un=J.y1,Rn=J.x2-tn,ln=J.y2-un,dn=(Cr,oi,gi,Hn)=>{const Dn=_h(Cr.stretch-yt,Xt,Rn,tn),ho=lf(Cr.fixed-lr,vr,Cr.stretch,je),ms=_h(oi.stretch-Ct,Rt,ln,un),Tl=lf(oi.fixed-Fr,pn,oi.stretch,Fe),Oc=_h(gi.stretch-yt,Xt,Rn,tn),Ld=lf(gi.fixed-lr,vr,gi.stretch,je),Du=_h(Hn.stretch-Ct,Rt,ln,un),ac=lf(Hn.fixed-Fr,pn,Hn.stretch,Fe),Ja=new u(Dn,ms),Bl=new u(Oc,ms),sc=new u(Oc,Du),lc=new u(Dn,Du),pu=new u(ho/O,Tl/O),Dd=new u(Ld/O,ac/O),Ul=c*Math.PI/180;if(Ul){const Vl=Math.sin(Ul),Wl=Math.cos(Ul),il=[Wl,-Vl,Vl,Wl];Ja._matMult(il),Bl._matMult(il),lc._matMult(il),sc._matMult(il)}const $u=Cr.stretch+Cr.fixed,Pl=oi.stretch+oi.fixed;return{tl:Ja,tr:Bl,bl:lc,br:sc,tex:{x:I.paddedRect.x+1+$u,y:I.paddedRect.y+1+Pl,w:gi.stretch+gi.fixed-$u,h:Hn.stretch+Hn.fixed-Pl},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:pu,pixelOffsetBR:Dd,minFontScaleX:vr/O/Rn,minFontScaleY:pn/O/ln,isSDF:h}};if(v&&(I.stretchX||I.stretchY)){const Cr=sf(ne,He,je),oi=sf(me,st,Fe);for(let gi=0;gi<Cr.length-1;gi++){const Hn=Cr[gi],Dn=Cr[gi+1];for(let ho=0;ho<oi.length-1;ho++)w.push(dn(Hn,oi[ho],Dn,oi[ho+1]))}}else w.push(dn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:z+1},{fixed:0,stretch:V+1}));return w}function ps(f,c,h){let v=0;for(const w of f)v+=Math.max(c,Math.min(h,w[1]))-Math.max(c,Math.min(h,w[0]));return v}function sf(f,c,h){const v=[{fixed:-1,stretch:0}];for(const[w,I]of f){const O=v[v.length-1];v.push({fixed:w-O.stretch,stretch:O.stretch}),v.push({fixed:w-O.stretch,stretch:O.stretch+(I-w)})}return v.push({fixed:c+1,stretch:h}),v}function _h(f,c,h,v){return f/c*h+v}function lf(f,c,h,v){return f-c*h/v}Re("Anchor",rl);class mm{constructor(c,h,v,w,I,O,z,V,J,ne){var me;if(this.boxStartIndex=c.length,J){let Ee=O.top,je=O.bottom;const Fe=O.collisionPadding;Fe&&(Ee-=Fe[1],je+=Fe[3]);let He=je-Ee;He>0&&(He=Math.max(10,He),this.circleDiameter=He)}else{const Ee=!((me=O.image)===null||me===void 0)&&me.content&&(O.image.textFitWidth||O.image.textFitHeight)?Zx(O):{x1:O.left,y1:O.top,x2:O.right,y2:O.bottom};Ee.y1=Ee.y1*z-V[0],Ee.y2=Ee.y2*z+V[2],Ee.x1=Ee.x1*z-V[3],Ee.x2=Ee.x2*z+V[1];const je=O.collisionPadding;if(je&&(Ee.x1-=je[0]*z,Ee.y1-=je[1]*z,Ee.x2+=je[2]*z,Ee.y2+=je[3]*z),ne){const Fe=new u(Ee.x1,Ee.y1),He=new u(Ee.x2,Ee.y1),st=new u(Ee.x1,Ee.y2),yt=new u(Ee.x2,Ee.y2),Xt=ne*Math.PI/180;Fe._rotate(Xt),He._rotate(Xt),st._rotate(Xt),yt._rotate(Xt),Ee.x1=Math.min(Fe.x,He.x,st.x,yt.x),Ee.x2=Math.max(Fe.x,He.x,st.x,yt.x),Ee.y1=Math.min(Fe.y,He.y,st.y,yt.y),Ee.y2=Math.max(Fe.y,He.y,st.y,yt.y)}c.emplaceBack(h.x,h.y,Ee.x1,Ee.y1,Ee.x2,Ee.y2,v,w,I)}this.boxEndIndex=c.length}}class ew{constructor(c=[],h=(v,w)=>v<w?-1:v>w?1:0){if(this.data=c,this.length=this.data.length,this.compare=h,this.length>0)for(let v=(this.length>>1)-1;v>=0;v--)this._down(v)}push(c){this.data.push(c),this._up(this.length++)}pop(){if(this.length===0)return;const c=this.data[0],h=this.data.pop();return--this.length>0&&(this.data[0]=h,this._down(0)),c}peek(){return this.data[0]}_up(c){const{data:h,compare:v}=this,w=h[c];for(;c>0;){const I=c-1>>1,O=h[I];if(v(w,O)>=0)break;h[c]=O,c=I}h[c]=w}_down(c){const{data:h,compare:v}=this,w=this.length>>1,I=h[c];for(;c<w;){let O=1+(c<<1);const z=O+1;if(z<this.length&&v(h[z],h[O])<0&&(O=z),v(h[O],I)>=0)break;h[c]=h[O],c=O}h[c]=I}}function tw(f,c=1,h=!1){const v=Go.fromPoints(f[0]),w=Math.min(v.width(),v.height());let I=w/2;const O=new ew([],rw),{minX:z,minY:V,maxX:J,maxY:ne}=v;if(w===0)return new u(z,V);for(let je=z;je<J;je+=w)for(let Fe=V;Fe<ne;Fe+=w)O.push(new Mg(je+I,Fe+I,I,f));let me=function(je){let Fe=0,He=0,st=0;const yt=je[0];for(let Xt=0,Ct=yt.length,Rt=Ct-1;Xt<Ct;Rt=Xt++){const lr=yt[Xt],vr=yt[Rt],Fr=lr.x*vr.y-vr.x*lr.y;He+=(lr.x+vr.x)*Fr,st+=(lr.y+vr.y)*Fr,Fe+=3*Fr}return new Mg(He/Fe,st/Fe,0,je)}(f),Ee=O.length;for(;O.length;){const je=O.pop();(je.d>me.d||!me.d)&&(me=je,h&&console.log("found best %d after %d probes",Math.round(1e4*je.d)/1e4,Ee)),je.max-me.d<=c||(I=je.h/2,O.push(new Mg(je.p.x-I,je.p.y-I,I,f)),O.push(new Mg(je.p.x+I,je.p.y-I,I,f)),O.push(new Mg(je.p.x-I,je.p.y+I,I,f)),O.push(new Mg(je.p.x+I,je.p.y+I,I,f)),Ee+=4)}return h&&(console.log(`num probes: ${Ee}`),console.log(`best distance: ${me.d}`)),me.p}function rw(f,c){return c.max-f.max}function Mg(f,c,h,v){this.p=new u(f,c),this.h=h,this.d=function(w,I){let O=!1,z=1/0;for(let V=0;V<I.length;V++){const J=I[V];for(let ne=0,me=J.length,Ee=me-1;ne<me;Ee=ne++){const je=J[ne],Fe=J[Ee];je.y>w.y!=Fe.y>w.y&&w.x<(Fe.x-je.x)*(w.y-je.y)/(Fe.y-je.y)+je.x&&(O=!O),z=Math.min(z,lx(w,je,Fe))}}return(O?1:-1)*Math.sqrt(z)}(this.p,v),this.max=this.d+this.h*Math.SQRT2}var nl;s.aE=void 0,(nl=s.aE||(s.aE={}))[nl.center=1]="center",nl[nl.left=2]="left",nl[nl.right=3]="right",nl[nl.top=4]="top",nl[nl.bottom=5]="bottom",nl[nl["top-left"]=6]="top-left",nl[nl["top-right"]=7]="top-right",nl[nl["bottom-left"]=8]="bottom-left",nl[nl["bottom-right"]=9]="bottom-right";const Sg=Number.POSITIVE_INFINITY;function mv(f,c){return c[1]!==Sg?function(h,v,w){let I=0,O=0;switch(v=Math.abs(v),w=Math.abs(w),h){case"top-right":case"top-left":case"top":O=w-7;break;case"bottom-right":case"bottom-left":case"bottom":O=7-w}switch(h){case"top-right":case"bottom-right":case"right":I=-v;break;case"top-left":case"bottom-left":case"left":I=v}return[I,O]}(f,c[0],c[1]):function(h,v){let w=0,I=0;v<0&&(v=0);const O=v/Math.SQRT2;switch(h){case"top-right":case"top-left":I=O-7;break;case"bottom-right":case"bottom-left":I=7-O;break;case"bottom":I=7-v;break;case"top":I=v-7}switch(h){case"top-right":case"bottom-right":w=-O;break;case"top-left":case"bottom-left":w=O;break;case"left":w=v;break;case"right":w=-v}return[w,I]}(f,c[0])}function nw(f,c,h){var v;const w=f.layout,I=(v=w.get("text-variable-anchor-offset"))===null||v===void 0?void 0:v.evaluate(c,{},h);if(I){const z=I.values,V=[];for(let J=0;J<z.length;J+=2){const ne=V[J]=z[J],me=z[J+1].map(Ee=>Ee*Vs);ne.startsWith("top")?me[1]-=7:ne.startsWith("bottom")&&(me[1]+=7),V[J+1]=me}return new Ri(V)}const O=w.get("text-variable-anchor");if(O){let z;z=f._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[w.get("text-radial-offset").evaluate(c,{},h)*Vs,Sg]:w.get("text-offset").evaluate(c,{},h).map(J=>J*Vs);const V=[];for(const J of O)V.push(J,mv(J,z));return new Ri(V)}return null}function ny(f){switch(f){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function gv(f,c,h,v,w,I,O,z,V,J,ne,me){let Ee=I.textMaxSize.evaluate(c,{});Ee===void 0&&(Ee=O);const je=f.layers[0].layout,Fe=je.get("icon-offset").evaluate(c,{},ne),He=WT(h.horizontal),st=O/24,yt=f.tilePixelRatio*st,Xt=f.tilePixelRatio*Ee/24,Ct=f.tilePixelRatio*z,Rt=f.tilePixelRatio*je.get("symbol-spacing"),lr=je.get("text-padding")*f.tilePixelRatio,vr=function(gi,Hn,Dn,ho=1){const ms=gi.get("icon-padding").evaluate(Hn,{},Dn),Tl=ms&&ms.values;return[Tl[0]*ho,Tl[1]*ho,Tl[2]*ho,Tl[3]*ho]}(je,c,ne,f.tilePixelRatio),Fr=je.get("text-max-angle")/180*Math.PI,pn=je.get("text-rotation-alignment")!=="viewport"&&je.get("symbol-placement")!=="point",tn=je.get("icon-rotation-alignment")==="map"&&je.get("symbol-placement")!=="point",un=je.get("symbol-placement"),Rn=Rt/2,ln=je.get("icon-text-fit");let dn;v&&ln!=="none"&&(f.allowVerticalPlacement&&h.vertical&&(dn=Xx(v,h.vertical,ln,je.get("icon-text-fit-padding"),Fe,st)),He&&(v=Xx(v,He,ln,je.get("icon-text-fit-padding"),Fe,st)));const Cr=ne?me.line.getGranularityForZoomLevel(ne.z):1,oi=(gi,Hn)=>{Hn.x<0||Hn.x>=fe||Hn.y<0||Hn.y>=fe||function(Dn,ho,ms,Tl,Oc,Ld,Du,ac,Ja,Bl,sc,lc,pu,Dd,Ul,$u,Pl,Vl,Wl,il,Ca,cf,_v,uf,The){const yv=Dn.addToLineVertexArray(ho,ms);let iy,vv,bv,xv,pz=0,mz=0,gz=0,_z=0,qk=-1,Hk=-1;const gm={};let yz=rf("");if(Dn.allowVerticalPlacement&&Tl.vertical){const Jc=ac.layout.get("text-rotate").evaluate(Ca,{},uf)+90;bv=new mm(Ja,ho,Bl,sc,lc,Tl.vertical,pu,Dd,Ul,Jc),Du&&(xv=new mm(Ja,ho,Bl,sc,lc,Du,Pl,Vl,Ul,Jc))}if(Oc){const Jc=ac.layout.get("icon-rotate").evaluate(Ca,{}),$d=ac.layout.get("icon-text-fit")!=="none",oy=wa(Oc,Jc,_v,$d),hf=Du?wa(Du,Jc,_v,$d):void 0;vv=new mm(Ja,ho,Bl,sc,lc,Oc,Pl,Vl,!1,Jc),pz=4*oy.length;const ay=Dn.iconSizeData;let vp=null;ay.kind==="source"?(vp=[gh*ac.layout.get("icon-size").evaluate(Ca,{})],vp[0]>af&&Xe(`${Dn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):ay.kind==="composite"&&(vp=[gh*cf.compositeIconSizes[0].evaluate(Ca,{},uf),gh*cf.compositeIconSizes[1].evaluate(Ca,{},uf)],(vp[0]>af||vp[1]>af)&&Xe(`${Dn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Dn.addSymbols(Dn.icon,oy,vp,il,Wl,Ca,s.ao.none,ho,yv.lineStartIndex,yv.lineLength,-1,uf),qk=Dn.icon.placedSymbolArray.length-1,hf&&(mz=4*hf.length,Dn.addSymbols(Dn.icon,hf,vp,il,Wl,Ca,s.ao.vertical,ho,yv.lineStartIndex,yv.lineLength,-1,uf),Hk=Dn.icon.placedSymbolArray.length-1)}const vz=Object.keys(Tl.horizontal);for(const Jc of vz){const $d=Tl.horizontal[Jc];if(!iy){yz=rf($d.text);const hf=ac.layout.get("text-rotate").evaluate(Ca,{},uf);iy=new mm(Ja,ho,Bl,sc,lc,$d,pu,Dd,Ul,hf)}const oy=$d.positionedLines.length===1;if(gz+=VT(Dn,ho,$d,Ld,ac,Ul,Ca,$u,yv,Tl.vertical?s.ao.horizontal:s.ao.horizontalOnly,oy?vz:[Jc],gm,qk,cf,uf),oy)break}Tl.vertical&&(_z+=VT(Dn,ho,Tl.vertical,Ld,ac,Ul,Ca,$u,yv,s.ao.vertical,["vertical"],gm,Hk,cf,uf));const Phe=iy?iy.boxStartIndex:Dn.collisionBoxArray.length,Ehe=iy?iy.boxEndIndex:Dn.collisionBoxArray.length,Ahe=bv?bv.boxStartIndex:Dn.collisionBoxArray.length,Che=bv?bv.boxEndIndex:Dn.collisionBoxArray.length,khe=vv?vv.boxStartIndex:Dn.collisionBoxArray.length,Ihe=vv?vv.boxEndIndex:Dn.collisionBoxArray.length,Ohe=xv?xv.boxStartIndex:Dn.collisionBoxArray.length,Lhe=xv?xv.boxEndIndex:Dn.collisionBoxArray.length;let df=-1;const qT=(Jc,$d)=>Jc&&Jc.circleDiameter?Math.max(Jc.circleDiameter,$d):$d;df=qT(iy,df),df=qT(bv,df),df=qT(vv,df),df=qT(xv,df);const bz=df>-1?1:0;bz&&(df*=The/Vs),Dn.glyphOffsetArray.length>=hm.MAX_GLYPHS&&Xe("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ca.sortKey!==void 0&&Dn.addToSortKeyRanges(Dn.symbolInstances.length,Ca.sortKey);const Dhe=nw(ac,Ca,uf),[$he,Nhe]=function(Jc,$d){const oy=Jc.length,hf=$d==null?void 0:$d.values;if((hf==null?void 0:hf.length)>0)for(let ay=0;ay<hf.length;ay+=2){const vp=hf[ay+1];Jc.emplaceBack(s.aE[hf[ay]],vp[0],vp[1])}return[oy,Jc.length]}(Dn.textAnchorOffsets,Dhe);Dn.symbolInstances.emplaceBack(ho.x,ho.y,gm.right>=0?gm.right:-1,gm.center>=0?gm.center:-1,gm.left>=0?gm.left:-1,gm.vertical||-1,qk,Hk,yz,Phe,Ehe,Ahe,Che,khe,Ihe,Ohe,Lhe,Bl,gz,_z,pz,mz,bz,0,pu,df,$he,Nhe)}(f,Hn,gi,h,v,w,dn,f.layers[0],f.collisionBoxArray,c.index,c.sourceLayerIndex,f.index,yt,[lr,lr,lr,lr],pn,V,Ct,vr,tn,Fe,c,I,J,ne,O)};if(un==="line")for(const gi of Ws(c.geometry,0,0,fe,fe)){const Hn=mp(gi,Cr),Dn=pv(Hn,Rt,Fr,h.vertical||He,v,24,Xt,f.overscaling,fe);for(const ho of Dn)He&&Fk(f,He.text,Rn,ho)||oi(Hn,ho)}else if(un==="line-center"){for(const gi of c.geometry)if(gi.length>1){const Hn=mp(gi,Cr),Dn=pm(Hn,Fr,h.vertical||He,v,24,Xt);Dn&&oi(Hn,Dn)}}else if(c.type==="Polygon")for(const gi of Co(c.geometry,0)){const Hn=tw(gi,16);oi(mp(gi[0],Cr,!0),new rl(Hn.x,Hn.y,0))}else if(c.type==="LineString")for(const gi of c.geometry){const Hn=mp(gi,Cr);oi(Hn,new rl(Hn[0].x,Hn[0].y,0))}else if(c.type==="Point")for(const gi of c.geometry)for(const Hn of gi)oi([Hn],new rl(Hn.x,Hn.y,0))}function VT(f,c,h,v,w,I,O,z,V,J,ne,me,Ee,je,Fe){const He=function(Xt,Ct,Rt,lr,vr,Fr,pn,tn){const un=lr.layout.get("text-rotate").evaluate(Fr,{})*Math.PI/180,Rn=[];for(const ln of Ct.positionedLines)for(const dn of ln.positionedGlyphs){if(!dn.rect)continue;const Cr=dn.rect||{};let oi=4,gi=!0,Hn=1,Dn=0;const ho=(vr||tn)&&dn.vertical,ms=dn.metrics.advance*dn.scale/2;if(tn&&Ct.verticalizable&&(Dn=ln.lineOffset/2-(dn.imageName?-(Vs-dn.metrics.width*dn.scale)/2:(dn.scale-1)*Vs)),dn.imageName){const Vl=pn[dn.imageName];gi=Vl.sdf,Hn=Vl.pixelRatio,oi=1/Hn}const Tl=vr?[dn.x+ms,dn.y]:[0,0];let Oc=vr?[0,0]:[dn.x+ms+Rt[0],dn.y+Rt[1]-Dn],Ld=[0,0];ho&&(Ld=Oc,Oc=[0,0]);const Du=dn.metrics.isDoubleResolution?2:1,ac=(dn.metrics.left-oi)*dn.scale-ms+Oc[0],Ja=(-dn.metrics.top-oi)*dn.scale+Oc[1],Bl=ac+Cr.w/Du*dn.scale/Hn,sc=Ja+Cr.h/Du*dn.scale/Hn,lc=new u(ac,Ja),pu=new u(Bl,Ja),Dd=new u(ac,sc),Ul=new u(Bl,sc);if(ho){const Vl=new u(-ms,ms- -17),Wl=-Math.PI/2,il=12-ms,Ca=new u(22-il,-(dn.imageName?il:0)),cf=new u(...Ld);lc._rotateAround(Wl,Vl)._add(Ca)._add(cf),pu._rotateAround(Wl,Vl)._add(Ca)._add(cf),Dd._rotateAround(Wl,Vl)._add(Ca)._add(cf),Ul._rotateAround(Wl,Vl)._add(Ca)._add(cf)}if(un){const Vl=Math.sin(un),Wl=Math.cos(un),il=[Wl,-Vl,Vl,Wl];lc._matMult(il),pu._matMult(il),Dd._matMult(il),Ul._matMult(il)}const $u=new u(0,0),Pl=new u(0,0);Rn.push({tl:lc,tr:pu,bl:Dd,br:Ul,tex:Cr,writingMode:Ct.writingMode,glyphOffset:Tl,sectionIndex:dn.sectionIndex,isSDF:gi,pixelOffsetTL:$u,pixelOffsetBR:Pl,minFontScaleX:0,minFontScaleY:0})}return Rn}(0,h,z,w,I,O,v,f.allowVerticalPlacement),st=f.textSizeData;let yt=null;st.kind==="source"?(yt=[gh*w.layout.get("text-size").evaluate(O,{})],yt[0]>af&&Xe(`${f.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):st.kind==="composite"&&(yt=[gh*je.compositeTextSizes[0].evaluate(O,{},Fe),gh*je.compositeTextSizes[1].evaluate(O,{},Fe)],(yt[0]>af||yt[1]>af)&&Xe(`${f.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),f.addSymbols(f.text,He,yt,z,I,O,J,c,V.lineStartIndex,V.lineLength,Ee,Fe);for(const Xt of ne)me[Xt]=f.text.placedSymbolArray.length-1;return 4*He.length}function WT(f){for(const c in f)return f[c];return null}function Fk(f,c,h,v){const w=f.compareText;if(c in w){const I=w[c];for(let O=I.length-1;O>=0;O--)if(v.dist(I[O])<h)return!0}else w[c]=[];return w[c].push(v),!1}const yp=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Lu{static from(c){if(!(c instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[h,v]=new Uint8Array(c,0,2);if(h!==219)throw new Error("Data does not appear to be in a KDBush format.");const w=v>>4;if(w!==1)throw new Error(`Got v${w} data when expected v1.`);const I=yp[15&v];if(!I)throw new Error("Unrecognized array type.");const[O]=new Uint16Array(c,2,1),[z]=new Uint32Array(c,4,1);return new Lu(z,O,I,c)}constructor(c,h=64,v=Float64Array,w){if(isNaN(c)||c<0)throw new Error(`Unpexpected numItems value: ${c}.`);this.numItems=+c,this.nodeSize=Math.min(Math.max(+h,2),65535),this.ArrayType=v,this.IndexArrayType=c<65536?Uint16Array:Uint32Array;const I=yp.indexOf(this.ArrayType),O=2*c*this.ArrayType.BYTES_PER_ELEMENT,z=c*this.IndexArrayType.BYTES_PER_ELEMENT,V=(8-z%8)%8;if(I<0)throw new Error(`Unexpected typed array class: ${v}.`);w&&w instanceof ArrayBuffer?(this.data=w,this.ids=new this.IndexArrayType(this.data,8,c),this.coords=new this.ArrayType(this.data,8+z+V,2*c),this._pos=2*c,this._finished=!0):(this.data=new ArrayBuffer(8+O+z+V),this.ids=new this.IndexArrayType(this.data,8,c),this.coords=new this.ArrayType(this.data,8+z+V,2*c),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+I]),new Uint16Array(this.data,2,1)[0]=h,new Uint32Array(this.data,4,1)[0]=c)}add(c,h){const v=this._pos>>1;return this.ids[v]=v,this.coords[this._pos++]=c,this.coords[this._pos++]=h,v}finish(){const c=this._pos>>1;if(c!==this.numItems)throw new Error(`Added ${c} items when expected ${this.numItems}.`);return zk(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(c,h,v,w){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:I,coords:O,nodeSize:z}=this,V=[0,I.length-1,0],J=[];for(;V.length;){const ne=V.pop()||0,me=V.pop()||0,Ee=V.pop()||0;if(me-Ee<=z){for(let st=Ee;st<=me;st++){const yt=O[2*st],Xt=O[2*st+1];yt>=c&&yt<=v&&Xt>=h&&Xt<=w&&J.push(I[st])}continue}const je=Ee+me>>1,Fe=O[2*je],He=O[2*je+1];Fe>=c&&Fe<=v&&He>=h&&He<=w&&J.push(I[je]),(ne===0?c<=Fe:h<=He)&&(V.push(Ee),V.push(je-1),V.push(1-ne)),(ne===0?v>=Fe:w>=He)&&(V.push(je+1),V.push(me),V.push(1-ne))}return J}within(c,h,v){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:w,coords:I,nodeSize:O}=this,z=[0,w.length-1,0],V=[],J=v*v;for(;z.length;){const ne=z.pop()||0,me=z.pop()||0,Ee=z.pop()||0;if(me-Ee<=O){for(let st=Ee;st<=me;st++)fz(I[2*st],I[2*st+1],c,h)<=J&&V.push(w[st]);continue}const je=Ee+me>>1,Fe=I[2*je],He=I[2*je+1];fz(Fe,He,c,h)<=J&&V.push(w[je]),(ne===0?c-v<=Fe:h-v<=He)&&(z.push(Ee),z.push(je-1),z.push(1-ne)),(ne===0?c+v>=Fe:h+v>=He)&&(z.push(je+1),z.push(me),z.push(1-ne))}return V}}function zk(f,c,h,v,w,I){if(w-v<=h)return;const O=v+w>>1;hz(f,c,O,v,w,I),zk(f,c,h,v,O-1,1-I),zk(f,c,h,O+1,w,1-I)}function hz(f,c,h,v,w,I){for(;w>v;){if(w-v>600){const J=w-v+1,ne=h-v+1,me=Math.log(J),Ee=.5*Math.exp(2*me/3),je=.5*Math.sqrt(me*Ee*(J-Ee)/J)*(ne-J/2<0?-1:1);hz(f,c,h,Math.max(v,Math.floor(h-ne*Ee/J+je)),Math.min(w,Math.floor(h+(J-ne)*Ee/J+je)),I)}const O=c[2*h+I];let z=v,V=w;for(iw(f,c,v,h),c[2*w+I]>O&&iw(f,c,v,w);z<V;){for(iw(f,c,z,V),z++,V--;c[2*z+I]<O;)z++;for(;c[2*V+I]>O;)V--}c[2*v+I]===O?iw(f,c,v,V):(V++,iw(f,c,V,w)),V<=h&&(v=V+1),h<=V&&(w=V-1)}}function iw(f,c,h,v){Bk(f,h,v),Bk(c,2*h,2*v),Bk(c,2*h+1,2*v+1)}function Bk(f,c,h){const v=f[c];f[c]=f[h],f[h]=v}function fz(f,c,h,v){const w=f-h,I=c-v;return w*w+I*I}var Uk;s.cx=void 0,(Uk=s.cx||(s.cx={})).create="create",Uk.load="load",Uk.fullLoad="fullLoad";let GT=null,ow=[];const Vk=1e3/60,Wk="loadTime",Gk="fullLoadTime",She={mark(f){performance.mark(f)},frame(f){const c=f;GT!=null&&ow.push(c-GT),GT=c},clearMetrics(){GT=null,ow=[],performance.clearMeasures(Wk),performance.clearMeasures(Gk);for(const f in s.cx)performance.clearMarks(s.cx[f])},getPerformanceMetrics(){performance.measure(Wk,s.cx.create,s.cx.load),performance.measure(Gk,s.cx.create,s.cx.fullLoad);const f=performance.getEntriesByName(Wk)[0].duration,c=performance.getEntriesByName(Gk)[0].duration,h=ow.length,v=1/(ow.reduce((I,O)=>I+O,0)/h/1e3),w=ow.filter(I=>I>Vk).reduce((I,O)=>I+(O-Vk)/Vk,0);return{loadTime:f,fullLoadTime:c,fps:v,percentDroppedFrames:w/(h+w)*100,totalFrames:h}}};s.$=fe,s.A=C,s.B=function([f,c,h]){return c+=90,c*=Math.PI/180,h*=Math.PI/180,{x:f*Math.cos(c)*Math.sin(h),y:f*Math.sin(c)*Math.sin(h),z:f*Math.cos(h)}},s.C=Xn,s.D=on,s.E=Jr,s.F=En,s.G=B,s.H=function(f){if(Lt==null){const c=f.navigator?f.navigator.userAgent:null;Lt=!!f.safari||!(!c||!(/\b(iPad|iPhone|iPod)\b/.test(c)||c.match("Safari")&&!c.match("Chrome")))}return Lt},s.I=sv,s.J=class{constructor(f,c){this.target=f,this.mapId=c,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Me(()=>this.process()),this.subscription=Bt(this.target,"message",h=>this.receive(h),!1),this.globalScope=Ot(self)?f:window}registerMessageHandler(f,c){this.messageHandlers[f]=c}sendAsync(f,c){return new Promise((h,v)=>{const w=Math.round(1e18*Math.random()).toString(36).substring(0,10),I=c?Bt(c.signal,"abort",()=>{I==null||I.unsubscribe(),delete this.resolveRejects[w];const V={id:w,type:"<cancel>",origin:location.origin,targetMapId:f.targetMapId,sourceMapId:this.mapId};this.target.postMessage(V)},qe):null;this.resolveRejects[w]={resolve:V=>{I==null||I.unsubscribe(),h(V)},reject:V=>{I==null||I.unsubscribe(),v(V)}};const O=[],z=Object.assign(Object.assign({},f),{id:w,sourceMapId:this.mapId,origin:location.origin,data:Gt(f.data,O)});this.target.postMessage(z,{transfer:O})})}receive(f){const c=f.data,h=c.id;if(!(c.origin!=="file://"&&location.origin!=="file://"&&c.origin!=="resource://android"&&location.origin!=="resource://android"&&c.origin!==location.origin||c.targetMapId&&this.mapId!==c.targetMapId)){if(c.type==="<cancel>"){delete this.tasks[h];const v=this.abortControllers[h];return delete this.abortControllers[h],void(v&&v.abort())}if(Ot(self)||c.mustQueue)return this.tasks[h]=c,this.taskQueue.push(h),void this.invoker.trigger();this.processTask(h,c)}}process(){if(this.taskQueue.length===0)return;const f=this.taskQueue.shift(),c=this.tasks[f];delete this.tasks[f],this.taskQueue.length>0&&this.invoker.trigger(),c&&this.processTask(f,c)}processTask(f,c){return a(this,void 0,void 0,function*(){if(c.type==="<response>"){const w=this.resolveRejects[f];return delete this.resolveRejects[f],w?void(c.error?w.reject(ar(c.error)):w.resolve(ar(c.data))):void 0}if(!this.messageHandlers[c.type])return void this.completeTask(f,new Error(`Could not find a registered handler for ${c.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const h=ar(c.data),v=new AbortController;this.abortControllers[f]=v;try{const w=yield this.messageHandlers[c.type](c.sourceMapId,h,v);this.completeTask(f,null,w)}catch(w){this.completeTask(f,w)}})}completeTask(f,c,h){const v=[];delete this.abortControllers[f];const w={id:f,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:c?Gt(c):null,data:Gt(h,v)};this.target.postMessage(w,{transfer:v})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},s.K=Ve,s.L=function(){var f=new C(16);return C!=Float32Array&&(f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[11]=0,f[12]=0,f[13]=0,f[14]=0),f[0]=1,f[5]=1,f[10]=1,f[15]=1,f},s.M=function(f,c,h){var v,w,I,O,z,V,J,ne,me,Ee,je,Fe,He=h[0],st=h[1],yt=h[2];return c===f?(f[12]=c[0]*He+c[4]*st+c[8]*yt+c[12],f[13]=c[1]*He+c[5]*st+c[9]*yt+c[13],f[14]=c[2]*He+c[6]*st+c[10]*yt+c[14],f[15]=c[3]*He+c[7]*st+c[11]*yt+c[15]):(w=c[1],I=c[2],O=c[3],z=c[4],V=c[5],J=c[6],ne=c[7],me=c[8],Ee=c[9],je=c[10],Fe=c[11],f[0]=v=c[0],f[1]=w,f[2]=I,f[3]=O,f[4]=z,f[5]=V,f[6]=J,f[7]=ne,f[8]=me,f[9]=Ee,f[10]=je,f[11]=Fe,f[12]=v*He+z*st+me*yt+c[12],f[13]=w*He+V*st+Ee*yt+c[13],f[14]=I*He+J*st+je*yt+c[14],f[15]=O*He+ne*st+Fe*yt+c[15]),f},s.N=function(f,c,h){var v=h[0],w=h[1],I=h[2];return f[0]=c[0]*v,f[1]=c[1]*v,f[2]=c[2]*v,f[3]=c[3]*v,f[4]=c[4]*w,f[5]=c[5]*w,f[6]=c[6]*w,f[7]=c[7]*w,f[8]=c[8]*I,f[9]=c[9]*I,f[10]=c[10]*I,f[11]=c[11]*I,f[12]=c[12],f[13]=c[13],f[14]=c[14],f[15]=c[15],f},s.O=function(f,c,h){var v=c[0],w=c[1],I=c[2],O=c[3],z=c[4],V=c[5],J=c[6],ne=c[7],me=c[8],Ee=c[9],je=c[10],Fe=c[11],He=c[12],st=c[13],yt=c[14],Xt=c[15],Ct=h[0],Rt=h[1],lr=h[2],vr=h[3];return f[0]=Ct*v+Rt*z+lr*me+vr*He,f[1]=Ct*w+Rt*V+lr*Ee+vr*st,f[2]=Ct*I+Rt*J+lr*je+vr*yt,f[3]=Ct*O+Rt*ne+lr*Fe+vr*Xt,f[4]=(Ct=h[4])*v+(Rt=h[5])*z+(lr=h[6])*me+(vr=h[7])*He,f[5]=Ct*w+Rt*V+lr*Ee+vr*st,f[6]=Ct*I+Rt*J+lr*je+vr*yt,f[7]=Ct*O+Rt*ne+lr*Fe+vr*Xt,f[8]=(Ct=h[8])*v+(Rt=h[9])*z+(lr=h[10])*me+(vr=h[11])*He,f[9]=Ct*w+Rt*V+lr*Ee+vr*st,f[10]=Ct*I+Rt*J+lr*je+vr*yt,f[11]=Ct*O+Rt*ne+lr*Fe+vr*Xt,f[12]=(Ct=h[12])*v+(Rt=h[13])*z+(lr=h[14])*me+(vr=h[15])*He,f[13]=Ct*w+Rt*V+lr*Ee+vr*st,f[14]=Ct*I+Rt*J+lr*je+vr*yt,f[15]=Ct*O+Rt*ne+lr*Fe+vr*Xt,f},s.P=u,s.Q=function(f,c){const h={};for(let v=0;v<c.length;v++){const w=c[v];w in f&&(h[w]=f[w])}return h},s.R=kc,s.S=ir,s.T=H0,s.U=sn,s.V=Kr,s.W=E,s.X=T,s.Y=Zt,s.Z=Pn,s._=a,s.a=Se,s.a$=ee,s.a0=function(f,c){var h,v,w,I;if(!f)return c??{};if(!c)return f;const O=Object.assign({},f);if(c.removeAll&&(O.removeAll=!0),c.remove){const z=new Set(O.remove?O.remove.concat(c.remove):c.remove);O.remove=Array.from(z.values())}if(c.add){const z=O.add?O.add.concat(c.add):c.add,V=new Map(z.map(J=>[J.id,J]));O.add=Array.from(V.values())}if(c.update){const z=new Map((h=O.update)===null||h===void 0?void 0:h.map(V=>[V.id,V]));for(const V of c.update){const J=(v=z.get(V.id))!==null&&v!==void 0?v:{id:V.id};V.newGeometry&&(J.newGeometry=V.newGeometry),V.addOrUpdateProperties&&(J.addOrUpdateProperties=((w=J.addOrUpdateProperties)!==null&&w!==void 0?w:[]).concat(V.addOrUpdateProperties)),V.removeProperties&&(J.removeProperties=((I=J.removeProperties)!==null&&I!==void 0?I:[]).concat(V.removeProperties)),V.removeAllProperties&&(J.removeAllProperties=!0),z.set(V.id,J)}O.update=Array.from(z.values())}return O},s.a1=li,s.a2=Go,s.a3=25,s.a4=ti,s.a5=f=>{const c=window.document.createElement("video");return c.muted=!0,new Promise(h=>{c.onloadstart=()=>{h(c)};for(const v of f){const w=window.document.createElement("source");Vt(v)||(c.crossOrigin="Anonymous"),w.src=v,c.appendChild(w)}})},s.a6=wt,s.a7=function(){return Ye++},s.a8=be,s.a9=hm,s.aA=function(f){let c=1/0,h=1/0,v=-1/0,w=-1/0;for(const I of f)c=Math.min(c,I.x),h=Math.min(h,I.y),v=Math.max(v,I.x),w=Math.max(w,I.y);return[c,h,v,w]},s.aB=Vs,s.aC=De,s.aD=function(f,c,h,v,w=!1){if(!h[0]&&!h[1])return[0,0];const I=w?v==="map"?-f.bearingInRadians:0:v==="viewport"?f.bearingInRadians:0;if(I){const O=Math.sin(I),z=Math.cos(I);h=[h[0]*z-h[1]*O,h[0]*O+h[1]*z]}return[w?h[0]:De(c,h[0],f.zoom),w?h[1]:De(c,h[1],f.zoom)]},s.aF=uv,s.aG=ny,s.aH=cv,s.aI=Lu,s.aJ=no,s.aK=X_,s.aL=St,s.aM=ei,s.aN=go,s.aO=Ge,s.aP=mr,s.aQ=fi,s.aR=G,s.aS=U,s.aT=function(f){var c=new C(3);return c[0]=f[0],c[1]=f[1],c[2]=f[2],c},s.aU=function(f,c,h){return f[0]=c[0]-h[0],f[1]=c[1]-h[1],f[2]=c[2]-h[2],f},s.aV=function(f,c){var h=c[0],v=c[1],w=c[2],I=h*h+v*v+w*w;return I>0&&(I=1/Math.sqrt(I)),f[0]=c[0]*I,f[1]=c[1]*I,f[2]=c[2]*I,f},s.aW=H,s.aX=function(f,c){return f[0]*c[0]+f[1]*c[1]+f[2]*c[2]},s.aY=function(f,c,h){return f[0]=c[0]*h[0],f[1]=c[1]*h[1],f[2]=c[2]*h[2],f[3]=c[3]*h[3],f},s.aZ=j,s.a_=function(f,c,h){const v=c[0]*h[0]+c[1]*h[1]+c[2]*h[2];return v===0?null:(-(f[0]*h[0]+f[1]*h[1]+f[2]*h[2])-h[3])/v},s.aa=ed,s.ab=nd,s.ac=za,s.ad=function(f){const c={};if(f.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(h,v,w,I)=>{const O=w||I;return c[v]=!O||O.toLowerCase(),""}),c["max-age"]){const h=parseInt(c["max-age"],10);isNaN(h)?delete c["max-age"]:c["max-age"]=h}return c},s.ae=wr,s.af=function(f){return Math.pow(2,f)},s.ag=L,s.ah=Ce,s.ai=85.051129,s.aj=_n,s.ak=function(f){return Math.log(f)/Math.LN2},s.al=function(f){var c=f[0],h=f[1];return c*c+h*h},s.am=function(f,c){const h=[];for(const v in f)v in c||h.push(v);return h},s.an=function(f,c){let h=0,v=0;if(f.kind==="constant")v=f.layoutSize;else if(f.kind!=="source"){const{interpolationType:w,minZoom:I,maxZoom:O}=f,z=w?Ce(vn.interpolationFactor(w,c,I,O),0,1):0;f.kind==="camera"?v=Xn.number(f.minSize,f.maxSize,z):h=z}return{uSizeT:h,uSize:v}},s.ap=function(f,{uSize:c,uSizeT:h},{lowerSize:v,upperSize:w}){return f.kind==="source"?v/gh:f.kind==="composite"?Xn.number(v/gh,w/gh,h):c},s.aq=function(f,c){var h=c[0],v=c[1],w=c[2],I=c[3],O=c[4],z=c[5],V=c[6],J=c[7],ne=c[8],me=c[9],Ee=c[10],je=c[11],Fe=c[12],He=c[13],st=c[14],yt=c[15],Xt=h*z-v*O,Ct=h*V-w*O,Rt=h*J-I*O,lr=v*V-w*z,vr=v*J-I*z,Fr=w*J-I*V,pn=ne*He-me*Fe,tn=ne*st-Ee*Fe,un=ne*yt-je*Fe,Rn=me*st-Ee*He,ln=me*yt-je*He,dn=Ee*yt-je*st,Cr=Xt*dn-Ct*ln+Rt*Rn+lr*un-vr*tn+Fr*pn;return Cr?(f[0]=(z*dn-V*ln+J*Rn)*(Cr=1/Cr),f[1]=(w*ln-v*dn-I*Rn)*Cr,f[2]=(He*Fr-st*vr+yt*lr)*Cr,f[3]=(Ee*vr-me*Fr-je*lr)*Cr,f[4]=(V*un-O*dn-J*tn)*Cr,f[5]=(h*dn-w*un+I*tn)*Cr,f[6]=(st*Rt-Fe*Fr-yt*Ct)*Cr,f[7]=(ne*Fr-Ee*Rt+je*Ct)*Cr,f[8]=(O*ln-z*un+J*pn)*Cr,f[9]=(v*un-h*ln-I*pn)*Cr,f[10]=(Fe*vr-He*Rt+yt*Xt)*Cr,f[11]=(me*Rt-ne*vr-je*Xt)*Cr,f[12]=(z*tn-O*Rn-V*pn)*Cr,f[13]=(h*Rn-v*tn+w*pn)*Cr,f[14]=(He*Ct-Fe*lr-st*Xt)*Cr,f[15]=(ne*lr-me*Ct+Ee*Xt)*Cr,f):null},s.ar=_e,s.as=function(f){var c=f[0],h=f[1];return Math.sqrt(c*c+h*h)},s.at=function(f){return f[0]=0,f[1]=0,f},s.au=function(f,c,h){return f[0]=c[0]*h,f[1]=c[1]*h,f},s.av=dv,s.aw=ae,s.ax=function(f,c,h,v){const w=c.y-f.y,I=c.x-f.x,O=v.y-h.y,z=v.x-h.x,V=O*I-z*w;if(V===0)return null;const J=(z*(f.y-h.y)-O*(f.x-h.x))/V;return new u(f.x+J*I,f.y+J*w)},s.ay=Ws,s.az=ax,s.b=kt,s.b$=class extends A{},s.b0=function(f,c,h){return f[0]=c[0]*h,f[1]=c[1]*h,f[2]=c[2]*h,f[3]=c[3]*h,f},s.b1=function(f,c){return f[0]*c[0]+f[1]*c[1]+f[2]*c[2]+f[3]},s.b2=Di,s.b3=$i,s.b4=function(f,c,h,v,w){var I=1/Math.tan(c/2);if(f[0]=I/h,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=I,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[11]=-1,f[12]=0,f[13]=0,f[15]=0,w!=null&&w!==1/0){var O=1/(v-w);f[10]=(w+v)*O,f[14]=2*w*v*O}else f[10]=-1,f[14]=-2*v;return f},s.b5=function(f){var c=new C(16);return c[0]=f[0],c[1]=f[1],c[2]=f[2],c[3]=f[3],c[4]=f[4],c[5]=f[5],c[6]=f[6],c[7]=f[7],c[8]=f[8],c[9]=f[9],c[10]=f[10],c[11]=f[11],c[12]=f[12],c[13]=f[13],c[14]=f[14],c[15]=f[15],c},s.b6=function(f,c,h){var v=Math.sin(h),w=Math.cos(h),I=c[0],O=c[1],z=c[2],V=c[3],J=c[4],ne=c[5],me=c[6],Ee=c[7];return c!==f&&(f[8]=c[8],f[9]=c[9],f[10]=c[10],f[11]=c[11],f[12]=c[12],f[13]=c[13],f[14]=c[14],f[15]=c[15]),f[0]=I*w+J*v,f[1]=O*w+ne*v,f[2]=z*w+me*v,f[3]=V*w+Ee*v,f[4]=J*w-I*v,f[5]=ne*w-O*v,f[6]=me*w-z*v,f[7]=Ee*w-V*v,f},s.b7=function(f,c,h){var v=Math.sin(h),w=Math.cos(h),I=c[4],O=c[5],z=c[6],V=c[7],J=c[8],ne=c[9],me=c[10],Ee=c[11];return c!==f&&(f[0]=c[0],f[1]=c[1],f[2]=c[2],f[3]=c[3],f[12]=c[12],f[13]=c[13],f[14]=c[14],f[15]=c[15]),f[4]=I*w+J*v,f[5]=O*w+ne*v,f[6]=z*w+me*v,f[7]=V*w+Ee*v,f[8]=J*w-I*v,f[9]=ne*w-O*v,f[10]=me*w-z*v,f[11]=Ee*w-V*v,f},s.b8=function(){const f=new Float32Array(16);return L(f),f},s.b9=function(){const f=new Float64Array(16);return L(f),f},s.bA=function(f,c){const h=pe(f,360),v=pe(c,360),w=v-h,I=v>h?w-360:w+360;return Math.abs(w)<Math.abs(I)?w:I},s.bB=function(f){return f[0]=0,f[1]=0,f[2]=0,f},s.bC=function(f,c,h,v){const w=Math.sqrt(f*f+c*c),I=Math.sqrt(h*h+v*v);f/=w,c/=w,h/=I,v/=I;const O=Math.acos(f*h+c*v);return-c*h+f*v>0?O:-O},s.bD=function(f,c){const h=pe(f,2*Math.PI),v=pe(c,2*Math.PI);return Math.min(Math.abs(h-v),Math.abs(h-v+2*Math.PI),Math.abs(h-v-2*Math.PI))},s.bE=function(){const f={},c=$t.$version;for(const h in $t.$root){const v=$t.$root[h];if(v.required){let w=null;w=h==="version"?c:v.type==="array"?[]:{},w!=null&&(f[h]=w)}}return f},s.bF=vt,s.bG=dt,s.bH=function f(c,h){if(Array.isArray(c)){if(!Array.isArray(h)||c.length!==h.length)return!1;for(let v=0;v<c.length;v++)if(!f(c[v],h[v]))return!1;return!0}if(typeof c=="object"&&c!==null&&h!==null){if(typeof h!="object"||Object.keys(c).length!==Object.keys(h).length)return!1;for(const v in c)if(!f(c[v],h[v]))return!1;return!0}return c===h},s.bI=function(f){f=f.slice();const c=Object.create(null);for(let h=0;h<f.length;h++)c[f[h].id]=f[h];for(let h=0;h<f.length;h++)"ref"in f[h]&&(f[h]=Sr(f[h],c[f[h].ref]));return f},s.bJ=function(f){if(f.type==="custom")return new se(f);switch(f.type){case"background":return new fm(f);case"circle":return new jS(f);case"color-relief":return new BS(f);case"fill":return new QS(f);case"fill-extrusion":return new rv(f);case"heatmap":return new FS(f);case"hillshade":return new zS(f);case"line":return new $x(f);case"raster":return new UT(f);case"symbol":return new fs(f)}},s.bK=Le,s.bL=function(f,c){if(!f)return[{command:"setStyle",args:[c]}];let h=[];try{if(!Ir(f.version,c.version))return[{command:"setStyle",args:[c]}];Ir(f.center,c.center)||h.push({command:"setCenter",args:[c.center]}),Ir(f.state,c.state)||h.push({command:"setGlobalState",args:[c.state]}),Ir(f.centerAltitude,c.centerAltitude)||h.push({command:"setCenterAltitude",args:[c.centerAltitude]}),Ir(f.zoom,c.zoom)||h.push({command:"setZoom",args:[c.zoom]}),Ir(f.bearing,c.bearing)||h.push({command:"setBearing",args:[c.bearing]}),Ir(f.pitch,c.pitch)||h.push({command:"setPitch",args:[c.pitch]}),Ir(f.roll,c.roll)||h.push({command:"setRoll",args:[c.roll]}),Ir(f.sprite,c.sprite)||h.push({command:"setSprite",args:[c.sprite]}),Ir(f.glyphs,c.glyphs)||h.push({command:"setGlyphs",args:[c.glyphs]}),Ir(f.transition,c.transition)||h.push({command:"setTransition",args:[c.transition]}),Ir(f.light,c.light)||h.push({command:"setLight",args:[c.light]}),Ir(f.terrain,c.terrain)||h.push({command:"setTerrain",args:[c.terrain]}),Ir(f.sky,c.sky)||h.push({command:"setSky",args:[c.sky]}),Ir(f.projection,c.projection)||h.push({command:"setProjection",args:[c.projection]});const v={},w=[];(function(O,z,V,J){let ne;for(ne in z=z||{},O=O||{})Object.prototype.hasOwnProperty.call(O,ne)&&(Object.prototype.hasOwnProperty.call(z,ne)||An(ne,V,J));for(ne in z)Object.prototype.hasOwnProperty.call(z,ne)&&(Object.prototype.hasOwnProperty.call(O,ne)?Ir(O[ne],z[ne])||(O[ne].type==="geojson"&&z[ne].type==="geojson"&&ut(O,z,ne)?Xr(V,{command:"setGeoJSONSourceData",args:[ne,z[ne].data]}):ge(ne,z,V,J)):qr(ne,z,V))})(f.sources,c.sources,w,v);const I=[];f.layers&&f.layers.forEach(O=>{"source"in O&&v[O.source]?h.push({command:"removeLayer",args:[O.id]}):I.push(O)}),h=h.concat(w),function(O,z,V){z=z||[];const J=(O=O||[]).map(Je),ne=z.map(Je),me=O.reduce(xt,{}),Ee=z.reduce(xt,{}),je=J.slice(),Fe=Object.create(null);let He,st,yt,Xt,Ct;for(let Rt=0,lr=0;Rt<J.length;Rt++)He=J[Rt],Object.prototype.hasOwnProperty.call(Ee,He)?lr++:(Xr(V,{command:"removeLayer",args:[He]}),je.splice(je.indexOf(He,lr),1));for(let Rt=0,lr=0;Rt<ne.length;Rt++)He=ne[ne.length-1-Rt],je[je.length-1-Rt]!==He&&(Object.prototype.hasOwnProperty.call(me,He)?(Xr(V,{command:"removeLayer",args:[He]}),je.splice(je.lastIndexOf(He,je.length-lr),1)):lr++,Xt=je[je.length-Rt],Xr(V,{command:"addLayer",args:[Ee[He],Xt]}),je.splice(je.length-Rt,0,He),Fe[He]=!0);for(let Rt=0;Rt<ne.length;Rt++)if(He=ne[Rt],st=me[He],yt=Ee[He],!Fe[He]&&!Ir(st,yt))if(Ir(st.source,yt.source)&&Ir(st["source-layer"],yt["source-layer"])&&Ir(st.type,yt.type)){for(Ct in We(st.layout,yt.layout,V,He,null,"setLayoutProperty"),We(st.paint,yt.paint,V,He,null,"setPaintProperty"),Ir(st.filter,yt.filter)||Xr(V,{command:"setFilter",args:[He,yt.filter]}),Ir(st.minzoom,yt.minzoom)&&Ir(st.maxzoom,yt.maxzoom)||Xr(V,{command:"setLayerZoomRange",args:[He,yt.minzoom,yt.maxzoom]}),st)Object.prototype.hasOwnProperty.call(st,Ct)&&Ct!=="layout"&&Ct!=="paint"&&Ct!=="filter"&&Ct!=="metadata"&&Ct!=="minzoom"&&Ct!=="maxzoom"&&(Ct.indexOf("paint.")===0?We(st[Ct],yt[Ct],V,He,Ct.slice(6),"setPaintProperty"):Ir(st[Ct],yt[Ct])||Xr(V,{command:"setLayerProperty",args:[He,Ct,yt[Ct]]}));for(Ct in yt)Object.prototype.hasOwnProperty.call(yt,Ct)&&!Object.prototype.hasOwnProperty.call(st,Ct)&&Ct!=="layout"&&Ct!=="paint"&&Ct!=="filter"&&Ct!=="metadata"&&Ct!=="minzoom"&&Ct!=="maxzoom"&&(Ct.indexOf("paint.")===0?We(st[Ct],yt[Ct],V,He,Ct.slice(6),"setPaintProperty"):Ir(st[Ct],yt[Ct])||Xr(V,{command:"setLayerProperty",args:[He,Ct,yt[Ct]]}))}else Xr(V,{command:"removeLayer",args:[He]}),Xt=je[je.lastIndexOf(He)+1],Xr(V,{command:"addLayer",args:[yt,Xt]})}(I,c.layers,h)}catch(v){console.warn("Unable to compute style diff:",v),h=[{command:"setStyle",args:[c]}]}return h},s.bM=function(f){const c=[],h=f.id;return h===void 0&&c.push({message:`layers.${h}: missing required property "id"`}),f.render===void 0&&c.push({message:`layers.${h}: missing required method "render"`}),f.renderingMode&&f.renderingMode!=="2d"&&f.renderingMode!=="3d"&&c.push({message:`layers.${h}: property "renderingMode" must be either "2d" or "3d"`}),c},s.bN=et,s.bO=Te,s.bP=class extends zl{constructor(f,c){super(f,c),this.current=0}set(f){this.current!==f&&(this.current=f,this.gl.uniform1i(this.location,f))}},s.bQ=As,s.bR=class extends zl{constructor(f,c){super(f,c),this.current=Qc}set(f){if(f[12]!==this.current[12]||f[0]!==this.current[0])return this.current=f,void this.gl.uniformMatrix4fv(this.location,!1,f);for(let c=1;c<16;c++)if(f[c]!==this.current[c]){this.current=f,this.gl.uniformMatrix4fv(this.location,!1,f);break}}},s.bS=hs,s.bT=class extends zl{constructor(f,c){super(f,c),this.current=[0,0,0]}set(f){f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]||(this.current=f,this.gl.uniform3f(this.location,f[0],f[1],f[2]))}},s.bU=class extends zl{constructor(f,c){super(f,c),this.current=[0,0]}set(f){f[0]===this.current[0]&&f[1]===this.current[1]||(this.current=f,this.gl.uniform2f(this.location,f[0],f[1]))}},s.bV=D,s.bW=function(f,c){var h=Math.sin(c),v=Math.cos(c);return f[0]=v,f[1]=h,f[2]=0,f[3]=-h,f[4]=v,f[5]=0,f[6]=0,f[7]=0,f[8]=1,f},s.bX=function(f,c,h){var v=c[0],w=c[1],I=c[2];return f[0]=v*h[0]+w*h[3]+I*h[6],f[1]=v*h[1]+w*h[4]+I*h[7],f[2]=v*h[2]+w*h[5]+I*h[8],f},s.bY=function(f,c,h,v,w,I,O){var z=1/(c-h),V=1/(v-w),J=1/(I-O);return f[0]=-2*z,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=-2*V,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=2*J,f[11]=0,f[12]=(c+h)*z,f[13]=(w+v)*V,f[14]=(O+I)*J,f[15]=1,f},s.bZ=class extends zl{constructor(f,c){super(f,c),this.current=new Array}set(f){if(f!=this.current){this.current=f;const c=new Float32Array(4*f.length);for(let h=0;h<f.length;h++)c[4*h]=f[h].r,c[4*h+1]=f[h].g,c[4*h+2]=f[h].b,c[4*h+3]=f[h].a;this.gl.uniform4fv(this.location,c)}}},s.b_=class extends zl{constructor(f,c){super(f,c),this.current=new Array}set(f){if(f!=this.current){this.current=f;const c=new Float32Array(f);this.gl.uniform1fv(this.location,c)}}},s.ba=function(){return new Float64Array(16)},s.bb=function(f,c,h){const v=new Float64Array(4);return ye(v,f,c-90,h),v},s.bc=function(f,c,h,v){var w,I,O,z,V,J=c[0],ne=c[1],me=c[2],Ee=c[3],je=h[0],Fe=h[1],He=h[2],st=h[3];return(I=J*je+ne*Fe+me*He+Ee*st)<0&&(I=-I,je=-je,Fe=-Fe,He=-He,st=-st),1-I>P?(w=Math.acos(I),O=Math.sin(w),z=Math.sin((1-v)*w)/O,V=Math.sin(v*w)/O):(z=1-v,V=v),f[0]=z*J+V*je,f[1]=z*ne+V*Fe,f[2]=z*me+V*He,f[3]=z*Ee+V*st,f},s.bd=function(f){const c=new Float64Array(9);var h,v,w,I,O,z,V,J,ne,me,Ee,je,Fe,He,st,yt,Xt,Ct;me=(w=(v=f)[0])*(V=w+w),Ee=(I=v[1])*V,Fe=(O=v[2])*V,He=O*(J=I+I),yt=(z=v[3])*V,Xt=z*J,Ct=z*(ne=O+O),(h=c)[0]=1-(je=I*J)-(st=O*ne),h[3]=Ee-Ct,h[6]=Fe+Xt,h[1]=Ee+Ct,h[4]=1-me-st,h[7]=He-yt,h[2]=Fe-Xt,h[5]=He+yt,h[8]=1-me-je;const Rt=mr(-Math.asin(Ce(c[2],-1,1)));let lr,vr;return Math.hypot(c[5],c[8])<.001?(lr=0,vr=-mr(Math.atan2(c[3],c[4]))):(lr=mr(c[5]===0&&c[8]===0?0:Math.atan2(c[5],c[8])),vr=mr(c[1]===0&&c[0]===0?0:Math.atan2(c[1],c[0]))),{roll:lr,pitch:Rt+90,bearing:vr}},s.be=function(f,c){return f.roll==c.roll&&f.pitch==c.pitch&&f.bearing==c.bearing},s.bf=Dr,s.bg=Cd,s.bh=um,s.bi=pp,s.bj=cm,s.bk=K,s.bl=te,s.bm=Mi,s.bn=function(f,c,h,v,w){return K(v,w,Ce((f-c)/(h-c),0,1))},s.bo=pe,s.bp=function(){return new Float64Array(3)},s.bq=function(f,c,h,v){return f[0]=c[0]+h[0]*v,f[1]=c[1]+h[1]*v,f[2]=c[2]+h[2]*v,f},s.br=ye,s.bs=function(f,c,h){var v=h[0],w=h[1],I=h[2],O=h[3],z=c[0],V=c[1],J=c[2],ne=w*J-I*V,me=I*z-v*J,Ee=v*V-w*z;return f[0]=z+O*(ne+=ne)+w*(Ee+=Ee)-I*(me+=me),f[1]=V+O*me+I*ne-v*Ee,f[2]=J+O*Ee+v*me-w*ne,f},s.bt=function(f,c,h){const v=(w=[f[0],f[1],f[2],c[0],c[1],c[2],h[0],h[1],h[2]])[0]*((ne=w[8])*(O=w[4])-(z=w[5])*(J=w[7]))+w[1]*(-ne*(I=w[3])+z*(V=w[6]))+w[2]*(J*I-O*V);var w,I,O,z,V,J,ne;if(v===0)return null;const me=H([],[c[0],c[1],c[2]],[h[0],h[1],h[2]]),Ee=H([],[h[0],h[1],h[2]],[f[0],f[1],f[2]]),je=H([],[f[0],f[1],f[2]],[c[0],c[1],c[2]]),Fe=G([],me,-f[3]);return U(Fe,Fe,G([],Ee,-c[3])),U(Fe,Fe,G([],je,-h[3])),G(Fe,Fe,1/v),Fe},s.bu=zt,s.bv=function(){return new Float64Array(4)},s.bw=function(f,c,h,v){var w=[],I=[];return w[0]=c[0]-h[0],w[1]=c[1]-h[1],w[2]=c[2]-h[2],I[0]=w[0]*Math.cos(v)-w[1]*Math.sin(v),I[1]=w[0]*Math.sin(v)+w[1]*Math.cos(v),I[2]=w[2],f[0]=I[0]+h[0],f[1]=I[1]+h[1],f[2]=I[2]+h[2],f},s.bx=function(f,c,h,v){var w=[],I=[];return w[0]=c[0]-h[0],w[1]=c[1]-h[1],w[2]=c[2]-h[2],I[0]=w[0],I[1]=w[1]*Math.cos(v)-w[2]*Math.sin(v),I[2]=w[1]*Math.sin(v)+w[2]*Math.cos(v),f[0]=I[0]+h[0],f[1]=I[1]+h[1],f[2]=I[2]+h[2],f},s.by=function(f,c,h,v){var w=[],I=[];return w[0]=c[0]-h[0],w[1]=c[1]-h[1],w[2]=c[2]-h[2],I[0]=w[2]*Math.sin(v)+w[0]*Math.cos(v),I[1]=w[1],I[2]=w[2]*Math.cos(v)-w[0]*Math.sin(v),f[0]=I[0]+h[0],f[1]=I[1]+h[1],f[2]=I[2]+h[2],f},s.bz=function(f,c,h){var v=Math.sin(h),w=Math.cos(h),I=c[0],O=c[1],z=c[2],V=c[3],J=c[8],ne=c[9],me=c[10],Ee=c[11];return c!==f&&(f[4]=c[4],f[5]=c[5],f[6]=c[6],f[7]=c[7],f[12]=c[12],f[13]=c[13],f[14]=c[14],f[15]=c[15]),f[0]=I*w-J*v,f[1]=O*w-ne*v,f[2]=z*w-me*v,f[3]=V*w-Ee*v,f[8]=I*v+J*w,f[9]=O*v+ne*w,f[10]=z*v+me*w,f[11]=V*v+Ee*w,f},s.c=tt,s.c0=jx,s.c1=class extends p{},s.c2=q0,s.c3=function(f){return f<=1?1:Math.pow(2,Math.ceil(Math.log(f)/Math.LN2))},s.c4=mx,s.c5=function(f,c,h){var v=c[0],w=c[1],I=c[2],O=h[3]*v+h[7]*w+h[11]*I+h[15];return f[0]=(h[0]*v+h[4]*w+h[8]*I+h[12])/(O=O||1),f[1]=(h[1]*v+h[5]*w+h[9]*I+h[13])/O,f[2]=(h[2]*v+h[6]*w+h[10]*I+h[14])/O,f},s.c6=class extends Es{},s.c7=class extends ie{},s.c8=function(f,c){return f[0]===c[0]&&f[1]===c[1]&&f[2]===c[2]&&f[3]===c[3]&&f[4]===c[4]&&f[5]===c[5]&&f[6]===c[6]&&f[7]===c[7]&&f[8]===c[8]&&f[9]===c[9]&&f[10]===c[10]&&f[11]===c[11]&&f[12]===c[12]&&f[13]===c[13]&&f[14]===c[14]&&f[15]===c[15]},s.c9=function(f,c){var h=f[0],v=f[1],w=f[2],I=f[3],O=f[4],z=f[5],V=f[6],J=f[7],ne=f[8],me=f[9],Ee=f[10],je=f[11],Fe=f[12],He=f[13],st=f[14],yt=f[15],Xt=c[0],Ct=c[1],Rt=c[2],lr=c[3],vr=c[4],Fr=c[5],pn=c[6],tn=c[7],un=c[8],Rn=c[9],ln=c[10],dn=c[11],Cr=c[12],oi=c[13],gi=c[14],Hn=c[15];return Math.abs(h-Xt)<=P*Math.max(1,Math.abs(h),Math.abs(Xt))&&Math.abs(v-Ct)<=P*Math.max(1,Math.abs(v),Math.abs(Ct))&&Math.abs(w-Rt)<=P*Math.max(1,Math.abs(w),Math.abs(Rt))&&Math.abs(I-lr)<=P*Math.max(1,Math.abs(I),Math.abs(lr))&&Math.abs(O-vr)<=P*Math.max(1,Math.abs(O),Math.abs(vr))&&Math.abs(z-Fr)<=P*Math.max(1,Math.abs(z),Math.abs(Fr))&&Math.abs(V-pn)<=P*Math.max(1,Math.abs(V),Math.abs(pn))&&Math.abs(J-tn)<=P*Math.max(1,Math.abs(J),Math.abs(tn))&&Math.abs(ne-un)<=P*Math.max(1,Math.abs(ne),Math.abs(un))&&Math.abs(me-Rn)<=P*Math.max(1,Math.abs(me),Math.abs(Rn))&&Math.abs(Ee-ln)<=P*Math.max(1,Math.abs(Ee),Math.abs(ln))&&Math.abs(je-dn)<=P*Math.max(1,Math.abs(je),Math.abs(dn))&&Math.abs(Fe-Cr)<=P*Math.max(1,Math.abs(Fe),Math.abs(Cr))&&Math.abs(He-oi)<=P*Math.max(1,Math.abs(He),Math.abs(oi))&&Math.abs(st-gi)<=P*Math.max(1,Math.abs(st),Math.abs(gi))&&Math.abs(yt-Hn)<=P*Math.max(1,Math.abs(yt),Math.abs(Hn))},s.cA=function(f,c){Se.REGISTERED_PROTOCOLS[f]=c},s.cB=function(f){delete Se.REGISTERED_PROTOCOLS[f]},s.cC=function(f,c){const h={};for(let w=0;w<f.length;w++){const I=c&&c[f[w].id]||ig(f[w]);c&&(c[f[w].id]=I);let O=h[I];O||(O=h[I]=[]),O.push(f[w])}const v=[];for(const w in h)v.push(h[w]);return v},s.cD=Re,s.cE=Qa,s.cF=Cs,s.cG=Vx,s.cH=function(f){f.bucket.createArrays(),f.bucket.tilePixelRatio=fe/(512*f.bucket.overscaling),f.bucket.compareText={},f.bucket.iconsNeedLinear=!1;const c=f.bucket.layers[0],h=c.layout,v=c._unevaluatedLayout._values,w={layoutIconSize:v["icon-size"].possiblyEvaluate(new En(f.bucket.zoom+1),f.canonical),layoutTextSize:v["text-size"].possiblyEvaluate(new En(f.bucket.zoom+1),f.canonical),textMaxSize:v["text-size"].possiblyEvaluate(new En(18))};if(f.bucket.textSizeData.kind==="composite"){const{minZoom:J,maxZoom:ne}=f.bucket.textSizeData;w.compositeTextSizes=[v["text-size"].possiblyEvaluate(new En(J),f.canonical),v["text-size"].possiblyEvaluate(new En(ne),f.canonical)]}if(f.bucket.iconSizeData.kind==="composite"){const{minZoom:J,maxZoom:ne}=f.bucket.iconSizeData;w.compositeIconSizes=[v["icon-size"].possiblyEvaluate(new En(J),f.canonical),v["icon-size"].possiblyEvaluate(new En(ne),f.canonical)]}const I=h.get("text-line-height")*Vs,O=h.get("text-rotation-alignment")!=="viewport"&&h.get("symbol-placement")!=="point",z=h.get("text-keep-upright"),V=h.get("text-size");for(const J of f.bucket.features){const ne=h.get("text-font").evaluate(J,{},f.canonical).join(","),me=V.evaluate(J,{},f.canonical),Ee=w.layoutTextSize.evaluate(J,{},f.canonical),je=w.layoutIconSize.evaluate(J,{},f.canonical),Fe={horizontal:{},vertical:void 0},He=J.text;let st,yt=[0,0];if(He){const Rt=He.toString(),lr=h.get("text-letter-spacing").evaluate(J,{},f.canonical)*Vs,vr=Tr(Rt)?lr:0,Fr=h.get("text-anchor").evaluate(J,{},f.canonical),pn=nw(c,J,f.canonical);if(!pn){const ln=h.get("text-radial-offset").evaluate(J,{},f.canonical);yt=ln?mv(Fr,[ln*Vs,Sg]):h.get("text-offset").evaluate(J,{},f.canonical).map(dn=>dn*Vs)}let tn=O?"center":h.get("text-justify").evaluate(J,{},f.canonical);const un=h.get("symbol-placement")==="point"?h.get("text-max-width").evaluate(J,{},f.canonical)*Vs:1/0,Rn=()=>{f.bucket.allowVerticalPlacement&&tr(Rt)&&(Fe.vertical=J_(He,f.glyphMap,f.glyphPositions,f.imagePositions,ne,un,I,Fr,"left",vr,yt,s.ao.vertical,!0,Ee,me))};if(!O&&pn){const ln=new Set;if(tn==="auto")for(let Cr=0;Cr<pn.values.length;Cr+=2)ln.add(ny(pn.values[Cr]));else ln.add(tn);let dn=!1;for(const Cr of ln)if(!Fe.horizontal[Cr])if(dn)Fe.horizontal[Cr]=Fe.horizontal[0];else{const oi=J_(He,f.glyphMap,f.glyphPositions,f.imagePositions,ne,un,I,"center",Cr,vr,yt,s.ao.horizontal,!1,Ee,me);oi&&(Fe.horizontal[Cr]=oi,dn=oi.positionedLines.length===1)}Rn()}else{tn==="auto"&&(tn=ny(Fr));const ln=J_(He,f.glyphMap,f.glyphPositions,f.imagePositions,ne,un,I,Fr,tn,vr,yt,s.ao.horizontal,!1,Ee,me);ln&&(Fe.horizontal[tn]=ln),Rn(),tr(Rt)&&O&&z&&(Fe.vertical=J_(He,f.glyphMap,f.glyphPositions,f.imagePositions,ne,un,I,Fr,tn,vr,yt,s.ao.vertical,!1,Ee,me))}}let Xt=!1;if(J.icon&&J.icon.name){const Rt=f.imageMap[J.icon.name];Rt&&(st=NT(f.imagePositions[J.icon.name],h.get("icon-offset").evaluate(J,{},f.canonical),h.get("icon-anchor").evaluate(J,{},f.canonical)),Xt=!!Rt.sdf,f.bucket.sdfIcons===void 0?f.bucket.sdfIcons=Xt:f.bucket.sdfIcons!==Xt&&Xe("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Rt.pixelRatio!==f.bucket.pixelRatio||h.get("icon-rotate").constantOr(1)!==0)&&(f.bucket.iconsNeedLinear=!0))}const Ct=WT(Fe.horizontal)||Fe.vertical;f.bucket.iconsInText=!!Ct&&Ct.iconsInText,(Ct||st)&&gv(f.bucket,J,Fe,st,f.imageMap,w,Ee,je,yt,Xt,f.canonical,f.subdivisionGranularity)}f.showCollisionBoxes&&f.bucket.generateCollisionDebugBuffers()},s.cI=iv,s.cJ=ev,s.cK=gg,s.cL=kx,s.cM=zx,s.cN=class{constructor(f){this._marks={start:[f.url,"start"].join("#"),end:[f.url,"end"].join("#"),measure:f.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let f=performance.getEntriesByName(this._marks.measure);return f.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),f=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),f}},s.cO=function(f,c,h,v,w){return a(this,void 0,void 0,function*(){if(T())try{return yield Zt(f,c,h,v,w)}catch{}return function(I,O,z,V,J){const ne=I.width,me=I.height;Kt&&dr||(Kt=new OffscreenCanvas(ne,me),dr=Kt.getContext("2d",{willReadFrequently:!0})),Kt.width=ne,Kt.height=me,dr.drawImage(I,0,0,ne,me);const Ee=dr.getImageData(O,z,V,J);return dr.clearRect(0,0,ne,me),Ee.data}(f,c,h,v,w)})},s.cP=bx,s.cQ=d,s.cR=tv,s.cS=gp,s.cT=Cu,s.cU=function(f,c){const h=new Map;if(f!=null)if(f.type==="Feature")h.set(Lo(f,c),f);else for(const v of f.features)h.set(Lo(v,c),v);return h},s.cV=function(f,c){if(f==null)return!0;if(f.type==="Feature")return Lo(f,c)!=null;if(f.type==="FeatureCollection"){const h=new Set;for(const v of f.features){const w=Lo(v,c);if(w==null||h.has(w))return!1;h.add(w)}return!0}return!1},s.cW=function(f,c,h){var v,w,I,O;if(c.removeAll&&f.clear(),c.remove)for(const z of c.remove)f.delete(z);if(c.add)for(const z of c.add){const V=Lo(z,h);V!=null&&f.set(V,z)}if(c.update)for(const z of c.update){let V=f.get(z.id);if(V==null)continue;const J=!z.removeAllProperties&&(((v=z.removeProperties)===null||v===void 0?void 0:v.length)>0||((w=z.addOrUpdateProperties)===null||w===void 0?void 0:w.length)>0);if((z.newGeometry||z.removeAllProperties||J)&&(V=Object.assign({},V),f.set(z.id,V),J&&(V.properties=Object.assign({},V.properties))),z.newGeometry&&(V.geometry=z.newGeometry),z.removeAllProperties)V.properties={};else if(((I=z.removeProperties)===null||I===void 0?void 0:I.length)>0)for(const ne of z.removeProperties)Object.prototype.hasOwnProperty.call(V.properties,ne)&&delete V.properties[ne];if(((O=z.addOrUpdateProperties)===null||O===void 0?void 0:O.length)>0)for(const{key:ne,value:me}of z.addOrUpdateProperties)V.properties[ne]=me}},s.cX=Ro,s.ca=function(f,c){return f[0]=c[0],f[1]=c[1],f[2]=c[2],f[3]=c[3],f[4]=c[4],f[5]=c[5],f[6]=c[6],f[7]=c[7],f[8]=c[8],f[9]=c[9],f[10]=c[10],f[11]=c[11],f[12]=c[12],f[13]=c[13],f[14]=c[14],f[15]=c[15],f},s.cb=f=>f.type==="symbol",s.cc=f=>f.type==="circle",s.cd=f=>f.type==="heatmap",s.ce=f=>f.type==="line",s.cf=f=>f.type==="fill",s.cg=f=>f.type==="fill-extrusion",s.ch=f=>f.type==="hillshade",s.ci=f=>f.type==="color-relief",s.cj=f=>f.type==="raster",s.ck=f=>f.type==="background",s.cl=f=>f.type==="custom",s.cm=ve,s.cn=function(f,c,h){const v=ue(c.x-h.x,c.y-h.y),w=ue(f.x-h.x,f.y-h.y);var I,O;return mr(Math.atan2(v[0]*w[1]-v[1]*w[0],(I=v)[0]*(O=w)[0]+I[1]*O[1]))},s.co=$e,s.cp=function(f,c){return xr[c]&&(f instanceof MouseEvent||f instanceof WheelEvent)},s.cq=function(f,c){return hr[c]&&"touches"in f},s.cr=function(f){return hr[f]||xr[f]},s.cs=function(f,c,h){var v=c[0],w=c[1];return f[0]=h[0]*v+h[4]*w+h[12],f[1]=h[1]*v+h[5]*w+h[13],f},s.ct=function(f,c){const{x:h,y:v}=li.fromLngLat(c);return!(f<0||f>25||v<0||v>=1||h<0||h>=1)},s.cu=function(f,c){return f[0]=c[0],f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=c[1],f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=c[2],f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f},s.cv=class extends us{},s.cw=She,s.cy=function(f){return f.message===or},s.cz=Qe,s.d=Vt,s.e=ot,s.f=f=>a(void 0,void 0,void 0,function*(){if(f.byteLength===0)return createImageBitmap(new ImageData(1,1));const c=new Blob([new Uint8Array(f)],{type:"image/png"});try{return createImageBitmap(c)}catch(h){throw new Error(`Could not load image because of ${h.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),s.g=Pe,s.h=f=>new Promise((c,h)=>{const v=new Image;v.onload=()=>{c(v),URL.revokeObjectURL(v.src),v.onload=null,window.requestAnimationFrame(()=>{v.src=mt})},v.onerror=()=>h(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const w=new Blob([new Uint8Array(f)],{type:"image/png"});v.src=f.byteLength?URL.createObjectURL(w):mt}),s.i=Ot,s.j=(f,c)=>Pt(ot(f,{type:"json"}),c),s.k=fr,s.l=er,s.m=Pt,s.n=(f,c)=>Pt(ot(f,{type:"arrayBuffer"}),c),s.o=function(f){return new zx(f).readFields(PT,[])},s.p=Ux,s.q=H_,s.r=wi,s.s=Bt,s.t=xa,s.u=Nt,s.v=$t,s.w=Xe,s.x=om,s.y=we,s.z=Ed}),i("worker",["./shared"],function(s){class a{constructor(Se){this.keyCache={},Se&&this.replace(Se)}replace(Se){this._layerConfigs={},this._layers={},this.update(Se,[])}update(Se,Pe){for(const Qe of Se){this._layerConfigs[Qe.id]=Qe;const dt=this._layers[Qe.id]=s.bJ(Qe);dt._featureFilter=s.aa(dt.filter),this.keyCache[Qe.id]&&delete this.keyCache[Qe.id]}for(const Qe of Pe)delete this.keyCache[Qe],delete this._layerConfigs[Qe],delete this._layers[Qe];this.familiesBySource={};const Ve=s.cC(Object.values(this._layerConfigs),this.keyCache);for(const Qe of Ve){const dt=Qe.map(fr=>this._layers[fr.id]),Pt=dt[0];if(Pt.visibility==="none")continue;const Vt=Pt.source||"";let At=this.familiesBySource[Vt];At||(At=this.familiesBySource[Vt]={});const qt=Pt.sourceLayer||"_geojsonTileLayer";let er=At[qt];er||(er=At[qt]=[]),er.push(dt)}}}class u{constructor(Se){const Pe={},Ve=[];for(const Vt in Se){const At=Se[Vt],qt=Pe[Vt]={};for(const er in At){const fr=At[+er];if(!fr||fr.bitmap.width===0||fr.bitmap.height===0)continue;const Jr={x:0,y:0,w:fr.bitmap.width+2,h:fr.bitmap.height+2};Ve.push(Jr),qt[er]={rect:Jr,metrics:fr.metrics}}}const{w:Qe,h:dt}=s.p(Ve),Pt=new s.q({width:Qe||1,height:dt||1});for(const Vt in Se){const At=Se[Vt];for(const qt in At){const er=At[+qt];if(!er||er.bitmap.width===0||er.bitmap.height===0)continue;const fr=Pe[Vt][qt].rect;s.q.copy(er.bitmap,Pt,{x:0,y:0},{x:fr.x+1,y:fr.y+1},er.bitmap)}}this.image=Pt,this.positions=Pe}}s.cD("GlyphAtlas",u);class d{constructor(Se){this.tileID=new s.Z(Se.tileID.overscaledZ,Se.tileID.wrap,Se.tileID.canonical.z,Se.tileID.canonical.x,Se.tileID.canonical.y),this.uid=Se.uid,this.zoom=Se.zoom,this.pixelRatio=Se.pixelRatio,this.tileSize=Se.tileSize,this.source=Se.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Se.showCollisionBoxes,this.collectResourceTiming=!!Se.collectResourceTiming,this.returnDependencies=!!Se.returnDependencies,this.promoteId=Se.promoteId,this.inFlightDependencies=[],this.globalState=Se.globalState}parse(Se,Pe,Ve,Qe,dt){return s._(this,void 0,void 0,function*(){this.status="parsing",this.data=Se,this.collisionBoxArray=new s.a8;const Pt=new s.cE(Object.keys(Se.layers).sort()),Vt=new s.cF(this.tileID,this.promoteId);Vt.bucketLayerIDs=[];const At={},qt={featureIndex:Vt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:Ve,subdivisionGranularity:dt},er=Pe.familiesBySource[this.source];for(const We in er){const Je=Se.layers[We];if(!Je)continue;Je.version===1&&s.w(`Vector tile source "${this.source}" layer "${We}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const xt=Pt.encode(We),wt=[];for(let pr=0;pr<Je.length;pr++){const Rr=Je.feature(pr),On=Vt.getId(Rr,We);wt.push({feature:Rr,id:On,index:pr,sourceLayerIndex:xt})}for(const pr of er[We]){const Rr=pr[0];Rr.source!==this.source&&s.w(`layer.source = ${Rr.source} does not equal this.source = ${this.source}`),Rr.minzoom&&this.zoom<Math.floor(Rr.minzoom)||Rr.maxzoom&&this.zoom>=Rr.maxzoom||Rr.visibility!=="none"&&(m(pr,this.zoom,Ve,this.globalState),(At[Rr.id]=Rr.createBucket({index:Vt.bucketLayerIDs.length,layers:pr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:xt,sourceID:this.source,globalState:this.globalState})).populate(wt,qt,this.tileID.canonical),Vt.bucketLayerIDs.push(pr.map(On=>On.id)))}}const fr=s.bN(qt.glyphDependencies,We=>Object.keys(We).map(Number));this.inFlightDependencies.forEach(We=>We==null?void 0:We.abort()),this.inFlightDependencies=[];let Jr=Promise.resolve({});if(Object.keys(fr).length){const We=new AbortController;this.inFlightDependencies.push(We),Jr=Qe.sendAsync({type:"GG",data:{stacks:fr,source:this.source,tileID:this.tileID,type:"glyphs"}},We)}const $t=Object.keys(qt.iconDependencies);let zr=Promise.resolve({});if($t.length){const We=new AbortController;this.inFlightDependencies.push(We),zr=Qe.sendAsync({type:"GI",data:{icons:$t,source:this.source,tileID:this.tileID,type:"icons"}},We)}const Sr=Object.keys(qt.patternDependencies);let Ir=Promise.resolve({});if(Sr.length){const We=new AbortController;this.inFlightDependencies.push(We),Ir=Qe.sendAsync({type:"GI",data:{icons:Sr,source:this.source,tileID:this.tileID,type:"patterns"}},We)}const[Xr,qr,An]=yield Promise.all([Jr,zr,Ir]),ge=new u(Xr),ut=new s.cG(qr,An);for(const We in At){const Je=At[We];Je instanceof s.a9?(m(Je.layers,this.zoom,Ve,this.globalState),s.cH({bucket:Je,glyphMap:Xr,glyphPositions:ge.positions,imageMap:qr,imagePositions:ut.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:qt.subdivisionGranularity})):Je.hasPattern&&(Je instanceof s.cI||Je instanceof s.cJ||Je instanceof s.cK)&&(m(Je.layers,this.zoom,Ve,this.globalState),Je.addFeatures(qt,this.tileID.canonical,ut.patternPositions))}return this.status="done",{buckets:Object.values(At).filter(We=>!We.isEmpty()),featureIndex:Vt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ge.image,imageAtlas:ut,glyphMap:this.returnDependencies?Xr:null,iconMap:this.returnDependencies?qr:null,glyphPositions:this.returnDependencies?ge.positions:null}})}}function m(tt,Se,Pe,Ve){const Qe=new s.F(Se,{globalState:Ve});for(const dt of tt)dt.recalculate(Qe,Pe)}class g{constructor(Se,Pe,Ve){this.actor=Se,this.layerIndex=Pe,this.availableImages=Ve,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(Se,Pe){return s._(this,void 0,void 0,function*(){const Ve=yield s.n(Se.request,Pe);try{return{vectorTile:new s.cL(new s.cM(Ve.data)),rawData:Ve.data,cacheControl:Ve.cacheControl,expires:Ve.expires}}catch(Qe){const dt=new Uint8Array(Ve.data);let Pt=`Unable to parse the tile at ${Se.request.url}, `;throw Pt+=dt[0]===31&&dt[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${Qe.message}`,new Error(Pt)}})}loadTile(Se){return s._(this,void 0,void 0,function*(){const Pe=Se.uid,Ve=!!(Se&&Se.request&&Se.request.collectResourceTiming)&&new s.cN(Se.request),Qe=new d(Se);this.loading[Pe]=Qe;const dt=new AbortController;Qe.abort=dt;try{const Pt=yield this.loadVectorTile(Se,dt);if(delete this.loading[Pe],!Pt)return null;const Vt=Pt.rawData,At={};Pt.expires&&(At.expires=Pt.expires),Pt.cacheControl&&(At.cacheControl=Pt.cacheControl);const qt={};if(Ve){const fr=Ve.finish();fr&&(qt.resourceTiming=JSON.parse(JSON.stringify(fr)))}Qe.vectorTile=Pt.vectorTile;const er=Qe.parse(Pt.vectorTile,this.layerIndex,this.availableImages,this.actor,Se.subdivisionGranularity);this.loaded[Pe]=Qe,this.fetching[Pe]={rawTileData:Vt,cacheControl:At,resourceTiming:qt};try{const fr=yield er;return s.e({rawTileData:Vt.slice(0)},fr,At,qt)}finally{delete this.fetching[Pe]}}catch(Pt){throw delete this.loading[Pe],Qe.status="done",this.loaded[Pe]=Qe,Pt}})}reloadTile(Se){return s._(this,void 0,void 0,function*(){const Pe=Se.uid;if(!this.loaded||!this.loaded[Pe])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const Ve=this.loaded[Pe];if(Ve.showCollisionBoxes=Se.showCollisionBoxes,Ve.globalState=Se.globalState,Ve.status==="parsing"){const Qe=yield Ve.parse(Ve.vectorTile,this.layerIndex,this.availableImages,this.actor,Se.subdivisionGranularity);let dt;if(this.fetching[Pe]){const{rawTileData:Pt,cacheControl:Vt,resourceTiming:At}=this.fetching[Pe];delete this.fetching[Pe],dt=s.e({rawTileData:Pt.slice(0)},Qe,Vt,At)}else dt=Qe;return dt}if(Ve.status==="done"&&Ve.vectorTile)return Ve.parse(Ve.vectorTile,this.layerIndex,this.availableImages,this.actor,Se.subdivisionGranularity)})}abortTile(Se){return s._(this,void 0,void 0,function*(){const Pe=this.loading,Ve=Se.uid;Pe&&Pe[Ve]&&Pe[Ve].abort&&(Pe[Ve].abort.abort(),delete Pe[Ve])})}removeTile(Se){return s._(this,void 0,void 0,function*(){this.loaded&&this.loaded[Se.uid]&&delete this.loaded[Se.uid]})}}class _{constructor(){this.loaded={}}loadTile(Se){return s._(this,void 0,void 0,function*(){const{uid:Pe,encoding:Ve,rawImageData:Qe,redFactor:dt,greenFactor:Pt,blueFactor:Vt,baseShift:At}=Se,qt=Qe.width+2,er=Qe.height+2,fr=s.b(Qe)?new s.R({width:qt,height:er},yield s.cO(Qe,-1,-1,qt,er)):Qe,Jr=new s.cP(Pe,fr,Ve,dt,Pt,Vt,At);return this.loaded=this.loaded||{},this.loaded[Pe]=Jr,Jr})}removeTile(Se){const Pe=this.loaded,Ve=Se.uid;Pe&&Pe[Ve]&&delete Pe[Ve]}}var y,M,x=function(){if(M)return y;function tt(Pe,Ve){if(Pe.length!==0){Se(Pe[0],Ve);for(var Qe=1;Qe<Pe.length;Qe++)Se(Pe[Qe],!Ve)}}function Se(Pe,Ve){for(var Qe=0,dt=0,Pt=0,Vt=Pe.length,At=Vt-1;Pt<Vt;At=Pt++){var qt=(Pe[Pt][0]-Pe[At][0])*(Pe[At][1]+Pe[Pt][1]),er=Qe+qt;dt+=Math.abs(Qe)>=Math.abs(qt)?Qe-er+qt:qt-er+Qe,Qe=er}Qe+dt>=0!=!!Ve&&Pe.reverse()}return M=1,y=function Pe(Ve,Qe){var dt,Pt=Ve&&Ve.type;if(Pt==="FeatureCollection")for(dt=0;dt<Ve.features.length;dt++)Pe(Ve.features[dt],Qe);else if(Pt==="GeometryCollection")for(dt=0;dt<Ve.geometries.length;dt++)Pe(Ve.geometries[dt],Qe);else if(Pt==="Feature")Pe(Ve.geometry,Qe);else if(Pt==="Polygon")tt(Ve.coordinates,Qe);else if(Pt==="MultiPolygon")for(dt=0;dt<Ve.coordinates.length;dt++)tt(Ve.coordinates[dt],Qe);return Ve}}(),E=s.cQ(x);class T extends s.cS{constructor(Se,Pe){super(new s.cM,0,Pe,[],[]),this.feature=Se,this.type=Se.type,this.properties=Se.tags?Se.tags:{},"id"in Se&&(typeof Se.id=="string"?this.id=parseInt(Se.id,10):typeof Se.id!="number"||isNaN(Se.id)||(this.id=Se.id))}loadGeometry(){const Se=[],Pe=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const Ve of Pe){const Qe=[];for(const dt of Ve)Qe.push(new s.P(dt[0],dt[1]));Se.push(Qe)}return Se}}class P extends s.cR{constructor(Se,Pe){super(new s.cM),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.version=Pe?Pe.version:1,this.extent=Pe?Pe.extent:4096,this.length=Se.length,this.features=Se}feature(Se){return new T(this.features[Se],this.extent)}}function C(tt,Se){Se.writeVarintField(15,tt.version||1),Se.writeStringField(1,tt.name||""),Se.writeVarintField(5,tt.extent||4096);const Pe={keys:[],values:[],keycache:{},valuecache:{}};for(let dt=0;dt<tt.length;dt++)Pe.feature=tt.feature(dt),Se.writeMessage(2,D,Pe);const Ve=Pe.keys;for(const dt of Ve)Se.writeStringField(3,dt);const Qe=Pe.values;for(const dt of Qe)Se.writeMessage(4,U,dt)}function D(tt,Se){if(!tt.feature)return;const Pe=tt.feature;Pe.id!==void 0&&Se.writeVarintField(1,Pe.id),Se.writeMessage(2,L,tt),Se.writeVarintField(3,Pe.type),Se.writeMessage(4,$,Pe)}function L(tt,Se){var Pe;for(const Ve in(Pe=tt.feature)==null?void 0:Pe.properties){let Qe=tt.feature.properties[Ve],dt=tt.keycache[Ve];if(Qe===null)continue;dt===void 0&&(tt.keys.push(Ve),dt=tt.keys.length-1,tt.keycache[Ve]=dt),Se.writeVarint(dt),typeof Qe!="string"&&typeof Qe!="boolean"&&typeof Qe!="number"&&(Qe=JSON.stringify(Qe));const Pt=typeof Qe+":"+Qe;let Vt=tt.valuecache[Pt];Vt===void 0&&(tt.values.push(Qe),Vt=tt.values.length-1,tt.valuecache[Pt]=Vt),Se.writeVarint(Vt)}}function N(tt,Se){return(Se<<3)+(7&tt)}function j(tt){return tt<<1^tt>>31}function $(tt,Se){const Pe=tt.loadGeometry(),Ve=tt.type;let Qe=0,dt=0;for(const Pt of Pe){let Vt=1;Ve===1&&(Vt=Pt.length),Se.writeVarint(N(1,Vt));const At=Ve===3?Pt.length-1:Pt.length;for(let qt=0;qt<At;qt++){qt===1&&Ve!==1&&Se.writeVarint(N(2,At-1));const er=Pt[qt].x-Qe,fr=Pt[qt].y-dt;Se.writeVarint(j(er)),Se.writeVarint(j(fr)),Qe+=er,dt+=fr}tt.type===3&&Se.writeVarint(N(7,1))}}function U(tt,Se){const Pe=typeof tt;Pe==="string"?Se.writeStringField(1,tt):Pe==="boolean"?Se.writeBooleanField(7,tt):Pe==="number"&&(tt%1!=0?Se.writeDoubleField(3,tt):tt<0?Se.writeSVarintField(6,tt):Se.writeVarintField(5,tt))}const G={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:tt=>tt},H=Math.fround||(X=new Float32Array(1),tt=>(X[0]=+tt,X[0]));var X;class ee{constructor(Se){this.options=Object.assign(Object.create(G),Se),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Se){const{log:Pe,minZoom:Ve,maxZoom:Qe}=this.options;Pe&&console.time("total time");const dt=`prepare ${Se.length} points`;Pe&&console.time(dt),this.points=Se;const Pt=[];for(let At=0;At<Se.length;At++){const qt=Se[At];if(!qt.geometry)continue;const[er,fr]=qt.geometry.coordinates,Jr=H(ye(er)),$t=H(_e(fr));Pt.push(Jr,$t,1/0,At,-1,1),this.options.reduce&&Pt.push(0)}let Vt=this.trees[Qe+1]=this._createTree(Pt);Pe&&console.timeEnd(dt);for(let At=Qe;At>=Ve;At--){const qt=+Date.now();Vt=this.trees[At]=this._createTree(this._cluster(Vt,At)),Pe&&console.log("z%d: %d clusters in %dms",At,Vt.numItems,+Date.now()-qt)}return Pe&&console.timeEnd("total time"),this}getClusters(Se,Pe){let Ve=((Se[0]+180)%360+360)%360-180;const Qe=Math.max(-90,Math.min(90,Se[1]));let dt=Se[2]===180?180:((Se[2]+180)%360+360)%360-180;const Pt=Math.max(-90,Math.min(90,Se[3]));if(Se[2]-Se[0]>=360)Ve=-180,dt=180;else if(Ve>dt){const fr=this.getClusters([Ve,Qe,180,Pt],Pe),Jr=this.getClusters([-180,Qe,dt,Pt],Pe);return fr.concat(Jr)}const Vt=this.trees[this._limitZoom(Pe)],At=Vt.range(ye(Ve),_e(Pt),ye(dt),_e(Qe)),qt=Vt.data,er=[];for(const fr of At){const Jr=this.stride*fr;er.push(qt[Jr+5]>1?ae(qt,Jr,this.clusterProps):this.points[qt[Jr+3]])}return er}getChildren(Se){const Pe=this._getOriginId(Se),Ve=this._getOriginZoom(Se),Qe="No cluster with the specified id.",dt=this.trees[Ve];if(!dt)throw new Error(Qe);const Pt=dt.data;if(Pe*this.stride>=Pt.length)throw new Error(Qe);const Vt=this.options.radius/(this.options.extent*Math.pow(2,Ve-1)),At=dt.within(Pt[Pe*this.stride],Pt[Pe*this.stride+1],Vt),qt=[];for(const er of At){const fr=er*this.stride;Pt[fr+4]===Se&&qt.push(Pt[fr+5]>1?ae(Pt,fr,this.clusterProps):this.points[Pt[fr+3]])}if(qt.length===0)throw new Error(Qe);return qt}getLeaves(Se,Pe,Ve){const Qe=[];return this._appendLeaves(Qe,Se,Pe=Pe||10,Ve=Ve||0,0),Qe}getTile(Se,Pe,Ve){const Qe=this.trees[this._limitZoom(Se)],dt=Math.pow(2,Se),{extent:Pt,radius:Vt}=this.options,At=Vt/Pt,qt=(Ve-At)/dt,er=(Ve+1+At)/dt,fr={features:[]};return this._addTileFeatures(Qe.range((Pe-At)/dt,qt,(Pe+1+At)/dt,er),Qe.data,Pe,Ve,dt,fr),Pe===0&&this._addTileFeatures(Qe.range(1-At/dt,qt,1,er),Qe.data,dt,Ve,dt,fr),Pe===dt-1&&this._addTileFeatures(Qe.range(0,qt,At/dt,er),Qe.data,-1,Ve,dt,fr),fr.features.length?fr:null}getClusterExpansionZoom(Se){let Pe=this._getOriginZoom(Se)-1;for(;Pe<=this.options.maxZoom;){const Ve=this.getChildren(Se);if(Pe++,Ve.length!==1)break;Se=Ve[0].properties.cluster_id}return Pe}_appendLeaves(Se,Pe,Ve,Qe,dt){const Pt=this.getChildren(Pe);for(const Vt of Pt){const At=Vt.properties;if(At&&At.cluster?dt+At.point_count<=Qe?dt+=At.point_count:dt=this._appendLeaves(Se,At.cluster_id,Ve,Qe,dt):dt<Qe?dt++:Se.push(Vt),Se.length===Ve)break}return dt}_createTree(Se){const Pe=new s.aI(Se.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Ve=0;Ve<Se.length;Ve+=this.stride)Pe.add(Se[Ve],Se[Ve+1]);return Pe.finish(),Pe.data=Se,Pe}_addTileFeatures(Se,Pe,Ve,Qe,dt,Pt){for(const Vt of Se){const At=Vt*this.stride,qt=Pe[At+5]>1;let er,fr,Jr;if(qt)er=de(Pe,At,this.clusterProps),fr=Pe[At],Jr=Pe[At+1];else{const Sr=this.points[Pe[At+3]];er=Sr.properties;const[Ir,Xr]=Sr.geometry.coordinates;fr=ye(Ir),Jr=_e(Xr)}const $t={type:1,geometry:[[Math.round(this.options.extent*(fr*dt-Ve)),Math.round(this.options.extent*(Jr*dt-Qe))]],tags:er};let zr;zr=qt||this.options.generateId?Pe[At+3]:this.points[Pe[At+3]].id,zr!==void 0&&($t.id=zr),Pt.features.push($t)}}_limitZoom(Se){return Math.max(this.options.minZoom,Math.min(Math.floor(+Se),this.options.maxZoom+1))}_cluster(Se,Pe){const{radius:Ve,extent:Qe,reduce:dt,minPoints:Pt}=this.options,Vt=Ve/(Qe*Math.pow(2,Pe)),At=Se.data,qt=[],er=this.stride;for(let fr=0;fr<At.length;fr+=er){if(At[fr+2]<=Pe)continue;At[fr+2]=Pe;const Jr=At[fr],$t=At[fr+1],zr=Se.within(At[fr],At[fr+1],Vt),Sr=At[fr+5];let Ir=Sr;for(const Xr of zr){const qr=Xr*er;At[qr+2]>Pe&&(Ir+=At[qr+5])}if(Ir>Sr&&Ir>=Pt){let Xr,qr=Jr*Sr,An=$t*Sr,ge=-1;const ut=(fr/er<<5)+(Pe+1)+this.points.length;for(const We of zr){const Je=We*er;if(At[Je+2]<=Pe)continue;At[Je+2]=Pe;const xt=At[Je+5];qr+=At[Je]*xt,An+=At[Je+1]*xt,At[Je+4]=ut,dt&&(Xr||(Xr=this._map(At,fr,!0),ge=this.clusterProps.length,this.clusterProps.push(Xr)),dt(Xr,this._map(At,Je)))}At[fr+4]=ut,qt.push(qr/Ir,An/Ir,1/0,ut,-1,Ir),dt&&qt.push(ge)}else{for(let Xr=0;Xr<er;Xr++)qt.push(At[fr+Xr]);if(Ir>1)for(const Xr of zr){const qr=Xr*er;if(!(At[qr+2]<=Pe)){At[qr+2]=Pe;for(let An=0;An<er;An++)qt.push(At[qr+An])}}}}return qt}_getOriginId(Se){return Se-this.points.length>>5}_getOriginZoom(Se){return(Se-this.points.length)%32}_map(Se,Pe,Ve){if(Se[Pe+5]>1){const Pt=this.clusterProps[Se[Pe+6]];return Ve?Object.assign({},Pt):Pt}const Qe=this.points[Se[Pe+3]].properties,dt=this.options.map(Qe);return Ve&&dt===Qe?Object.assign({},dt):dt}}function ae(tt,Se,Pe){return{type:"Feature",id:tt[Se+3],properties:de(tt,Se,Pe),geometry:{type:"Point",coordinates:[(Ve=tt[Se],360*(Ve-.5)),ue(tt[Se+1])]}};var Ve}function de(tt,Se,Pe){const Ve=tt[Se+5],Qe=Ve>=1e4?`${Math.round(Ve/1e3)}k`:Ve>=1e3?Math.round(Ve/100)/10+"k":Ve,dt=tt[Se+6],Pt=dt===-1?{}:Object.assign({},Pe[dt]);return Object.assign(Pt,{cluster:!0,cluster_id:tt[Se+3],point_count:Ve,point_count_abbreviated:Qe})}function ye(tt){return tt/360+.5}function _e(tt){const Se=Math.sin(tt*Math.PI/180),Pe=.5-.25*Math.log((1+Se)/(1-Se))/Math.PI;return Pe<0?0:Pe>1?1:Pe}function ue(tt){const Se=(180-360*tt)*Math.PI/180;return 360*Math.atan(Math.exp(Se))/Math.PI-90}function fe(tt,Se,Pe,Ve){let Qe=Ve;const dt=Se+(Pe-Se>>1);let Pt,Vt=Pe-Se;const At=tt[Se],qt=tt[Se+1],er=tt[Pe],fr=tt[Pe+1];for(let Jr=Se+3;Jr<Pe;Jr+=3){const $t=De(tt[Jr],tt[Jr+1],At,qt,er,fr);if($t>Qe)Pt=Jr,Qe=$t;else if($t===Qe){const zr=Math.abs(Jr-dt);zr<Vt&&(Pt=Jr,Vt=zr)}}Qe>Ve&&(Pt-Se>3&&fe(tt,Se,Pt,Ve),tt[Pt+2]=Qe,Pe-Pt>3&&fe(tt,Pt,Pe,Ve))}function De(tt,Se,Pe,Ve,Qe,dt){let Pt=Qe-Pe,Vt=dt-Ve;if(Pt!==0||Vt!==0){const At=((tt-Pe)*Pt+(Se-Ve)*Vt)/(Pt*Pt+Vt*Vt);At>1?(Pe=Qe,Ve=dt):At>0&&(Pe+=Pt*At,Ve+=Vt*At)}return Pt=tt-Pe,Vt=Se-Ve,Pt*Pt+Vt*Vt}function pe(tt,Se,Pe,Ve){const Qe={id:tt??null,type:Se,geometry:Pe,tags:Ve,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(Se==="Point"||Se==="MultiPoint"||Se==="LineString")K(Qe,Pe);else if(Se==="Polygon")K(Qe,Pe[0]);else if(Se==="MultiLineString")for(const dt of Pe)K(Qe,dt);else if(Se==="MultiPolygon")for(const dt of Pe)K(Qe,dt[0]);return Qe}function K(tt,Se){for(let Pe=0;Pe<Se.length;Pe+=3)tt.minX=Math.min(tt.minX,Se[Pe]),tt.minY=Math.min(tt.minY,Se[Pe+1]),tt.maxX=Math.max(tt.maxX,Se[Pe]),tt.maxY=Math.max(tt.maxY,Se[Pe+1])}function te(tt,Se,Pe,Ve){if(!Se.geometry)return;const Qe=Se.geometry.coordinates;if(Qe&&Qe.length===0)return;const dt=Se.geometry.type,Pt=Math.pow(Pe.tolerance/((1<<Pe.maxZoom)*Pe.extent),2);let Vt=[],At=Se.id;if(Pe.promoteId?At=Se.properties[Pe.promoteId]:Pe.generateId&&(At=Ve||0),dt==="Point")ve(Qe,Vt);else if(dt==="MultiPoint")for(const qt of Qe)ve(qt,Vt);else if(dt==="LineString")$e(Qe,Vt,Pt,!1);else if(dt==="MultiLineString"){if(Pe.lineMetrics){for(const qt of Qe)Vt=[],$e(qt,Vt,Pt,!1),tt.push(pe(At,"LineString",Vt,Se.properties));return}Ce(Qe,Vt,Pt,!1)}else if(dt==="Polygon")Ce(Qe,Vt,Pt,!0);else{if(dt!=="MultiPolygon"){if(dt==="GeometryCollection"){for(const qt of Se.geometry.geometries)te(tt,{id:At,geometry:qt,properties:Se.properties},Pe,Ve);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const qt of Qe){const er=[];Ce(qt,er,Pt,!0),Vt.push(er)}}tt.push(pe(At,dt,Vt,Se.properties))}function ve(tt,Se){Se.push(Ge(tt[0]),ot(tt[1]),0)}function $e(tt,Se,Pe,Ve){let Qe,dt,Pt=0;for(let At=0;At<tt.length;At++){const qt=Ge(tt[At][0]),er=ot(tt[At][1]);Se.push(qt,er,0),At>0&&(Pt+=Ve?(Qe*er-qt*dt)/2:Math.sqrt(Math.pow(qt-Qe,2)+Math.pow(er-dt,2))),Qe=qt,dt=er}const Vt=Se.length-3;Se[2]=1,fe(Se,0,Vt,Pe),Se[Vt+2]=1,Se.size=Math.abs(Pt),Se.start=0,Se.end=Se.size}function Ce(tt,Se,Pe,Ve){for(let Qe=0;Qe<tt.length;Qe++){const dt=[];$e(tt[Qe],dt,Pe,Ve),Se.push(dt)}}function Ge(tt){return tt/360+.5}function ot(tt){const Se=Math.sin(tt*Math.PI/180),Pe=.5-.25*Math.log((1+Se)/(1-Se))/Math.PI;return Pe<0?0:Pe>1?1:Pe}function Ye(tt,Se,Pe,Ve,Qe,dt,Pt,Vt){if(Ve/=Se,dt>=(Pe/=Se)&&Pt<Ve)return tt;if(Pt<Pe||dt>=Ve)return null;const At=[];for(const qt of tt){const er=qt.geometry;let fr=qt.type;const Jr=Qe===0?qt.minX:qt.minY,$t=Qe===0?qt.maxX:qt.maxY;if(Jr>=Pe&&$t<Ve){At.push(qt);continue}if($t<Pe||Jr>=Ve)continue;let zr=[];if(fr==="Point"||fr==="MultiPoint")et(er,zr,Pe,Ve,Qe);else if(fr==="LineString")Te(er,zr,Pe,Ve,Qe,!1,Vt.lineMetrics);else if(fr==="MultiLineString")ke(er,zr,Pe,Ve,Qe,!1);else if(fr==="Polygon")ke(er,zr,Pe,Ve,Qe,!0);else if(fr==="MultiPolygon")for(const Sr of er){const Ir=[];ke(Sr,Ir,Pe,Ve,Qe,!0),Ir.length&&zr.push(Ir)}if(zr.length){if(Vt.lineMetrics&&fr==="LineString"){for(const Sr of zr)At.push(pe(qt.id,fr,Sr,qt.tags));continue}fr!=="LineString"&&fr!=="MultiLineString"||(zr.length===1?(fr="LineString",zr=zr[0]):fr="MultiLineString"),fr!=="Point"&&fr!=="MultiPoint"||(fr=zr.length===3?"Point":"MultiPoint"),At.push(pe(qt.id,fr,zr,qt.tags))}}return At.length?At:null}function et(tt,Se,Pe,Ve,Qe){for(let dt=0;dt<tt.length;dt+=3){const Pt=tt[dt+Qe];Pt>=Pe&&Pt<=Ve&&Xe(Se,tt[dt],tt[dt+1],tt[dt+2])}}function Te(tt,Se,Pe,Ve,Qe,dt,Pt){let Vt=Le(tt);const At=Qe===0?Ne:Ot;let qt,er,fr=tt.start;for(let Ir=0;Ir<tt.length-3;Ir+=3){const Xr=tt[Ir],qr=tt[Ir+1],An=tt[Ir+2],ge=tt[Ir+3],ut=tt[Ir+4],We=Qe===0?Xr:qr,Je=Qe===0?ge:ut;let xt=!1;Pt&&(qt=Math.sqrt(Math.pow(Xr-ge,2)+Math.pow(qr-ut,2))),We<Pe?Je>Pe&&(er=At(Vt,Xr,qr,ge,ut,Pe),Pt&&(Vt.start=fr+qt*er)):We>Ve?Je<Ve&&(er=At(Vt,Xr,qr,ge,ut,Ve),Pt&&(Vt.start=fr+qt*er)):Xe(Vt,Xr,qr,An),Je<Pe&&We>=Pe&&(er=At(Vt,Xr,qr,ge,ut,Pe),xt=!0),Je>Ve&&We<=Ve&&(er=At(Vt,Xr,qr,ge,ut,Ve),xt=!0),!dt&&xt&&(Pt&&(Vt.end=fr+qt*er),Se.push(Vt),Vt=Le(tt)),Pt&&(fr+=qt)}let Jr=tt.length-3;const $t=tt[Jr],zr=tt[Jr+1],Sr=Qe===0?$t:zr;Sr>=Pe&&Sr<=Ve&&Xe(Vt,$t,zr,tt[Jr+2]),Jr=Vt.length-3,dt&&Jr>=3&&(Vt[Jr]!==Vt[0]||Vt[Jr+1]!==Vt[1])&&Xe(Vt,Vt[0],Vt[1],Vt[2]),Vt.length&&Se.push(Vt)}function Le(tt){const Se=[];return Se.size=tt.size,Se.start=tt.start,Se.end=tt.end,Se}function ke(tt,Se,Pe,Ve,Qe,dt){for(const Pt of tt)Te(Pt,Se,Pe,Ve,Qe,dt,!1)}function Xe(tt,Se,Pe,Ve){tt.push(Se,Pe,Ve)}function Ne(tt,Se,Pe,Ve,Qe,dt){const Pt=(dt-Se)/(Ve-Se);return Xe(tt,dt,Pe+(Qe-Pe)*Pt,1),Pt}function Ot(tt,Se,Pe,Ve,Qe,dt){const Pt=(dt-Pe)/(Qe-Pe);return Xe(tt,Se+(Ve-Se)*Pt,dt,1),Pt}function Lt(tt,Se){const Pe=[];for(let Ve=0;Ve<tt.length;Ve++){const Qe=tt[Ve],dt=Qe.type;let Pt;if(dt==="Point"||dt==="MultiPoint"||dt==="LineString")Pt=kt(Qe.geometry,Se);else if(dt==="MultiLineString"||dt==="Polygon"){Pt=[];for(const Vt of Qe.geometry)Pt.push(kt(Vt,Se))}else if(dt==="MultiPolygon"){Pt=[];for(const Vt of Qe.geometry){const At=[];for(const qt of Vt)At.push(kt(qt,Se));Pt.push(At)}}Pe.push(pe(Qe.id,dt,Pt,Qe.tags))}return Pe}function kt(tt,Se){const Pe=[];Pe.size=tt.size,tt.start!==void 0&&(Pe.start=tt.start,Pe.end=tt.end);for(let Ve=0;Ve<tt.length;Ve+=3)Pe.push(tt[Ve]+Se,tt[Ve+1],tt[Ve+2]);return Pe}function mt(tt,Se){if(tt.transformed)return tt;const Pe=1<<tt.z,Ve=tt.x,Qe=tt.y;for(const dt of tt.features){const Pt=dt.geometry,Vt=dt.type;if(dt.geometry=[],Vt===1)for(let At=0;At<Pt.length;At+=2)dt.geometry.push(Zt(Pt[At],Pt[At+1],Se,Pe,Ve,Qe));else for(let At=0;At<Pt.length;At++){const qt=[];for(let er=0;er<Pt[At].length;er+=2)qt.push(Zt(Pt[At][er],Pt[At][er+1],Se,Pe,Ve,Qe));dt.geometry.push(qt)}}return tt.transformed=!0,tt}function Zt(tt,Se,Pe,Ve,Qe,dt){return[Math.round(Pe*(tt*Ve-Qe)),Math.round(Pe*(Se*Ve-dt))]}function Kt(tt,Se,Pe,Ve,Qe){const dt=Se===Qe.maxZoom?0:Qe.tolerance/((1<<Se)*Qe.extent),Pt={features:[],numPoints:0,numSimplified:0,numFeatures:tt.length,source:null,x:Pe,y:Ve,z:Se,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Vt of tt)dr(Pt,Vt,dt,Qe);return Pt}function dr(tt,Se,Pe,Ve){const Qe=Se.geometry,dt=Se.type,Pt=[];if(tt.minX=Math.min(tt.minX,Se.minX),tt.minY=Math.min(tt.minY,Se.minY),tt.maxX=Math.max(tt.maxX,Se.maxX),tt.maxY=Math.max(tt.maxY,Se.maxY),dt==="Point"||dt==="MultiPoint")for(let Vt=0;Vt<Qe.length;Vt+=3)Pt.push(Qe[Vt],Qe[Vt+1]),tt.numPoints++,tt.numSimplified++;else if(dt==="LineString")Bt(Pt,Qe,tt,Pe,!1,!1);else if(dt==="MultiLineString"||dt==="Polygon")for(let Vt=0;Vt<Qe.length;Vt++)Bt(Pt,Qe[Vt],tt,Pe,dt==="Polygon",Vt===0);else if(dt==="MultiPolygon")for(let Vt=0;Vt<Qe.length;Vt++){const At=Qe[Vt];for(let qt=0;qt<At.length;qt++)Bt(Pt,At[qt],tt,Pe,!0,qt===0)}if(Pt.length){let Vt=Se.tags||null;if(dt==="LineString"&&Ve.lineMetrics){Vt={};for(const qt in Se.tags)Vt[qt]=Se.tags[qt];Vt.mapbox_clip_start=Qe.start/Qe.size,Vt.mapbox_clip_end=Qe.end/Qe.size}const At={geometry:Pt,type:dt==="Polygon"||dt==="MultiPolygon"?3:dt==="LineString"||dt==="MultiLineString"?2:1,tags:Vt};Se.id!==null&&(At.id=Se.id),tt.features.push(At)}}function Bt(tt,Se,Pe,Ve,Qe,dt){const Pt=Ve*Ve;if(Ve>0&&Se.size<(Qe?Pt:Ve))return void(Pe.numPoints+=Se.length/3);const Vt=[];for(let At=0;At<Se.length;At+=3)(Ve===0||Se[At+2]>Pt)&&(Pe.numSimplified++,Vt.push(Se[At],Se[At+1])),Pe.numPoints++;Qe&&function(At,qt){let er=0;for(let fr=0,Jr=At.length,$t=Jr-2;fr<Jr;$t=fr,fr+=2)er+=(At[fr]-At[$t])*(At[fr+1]+At[$t+1]);if(er>0===qt)for(let fr=0,Jr=At.length;fr<Jr/2;fr+=2){const $t=At[fr],zr=At[fr+1];At[fr]=At[Jr-2-fr],At[fr+1]=At[Jr-1-fr],At[Jr-2-fr]=$t,At[Jr-1-fr]=zr}}(Vt,dt),tt.push(Vt)}const wr={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class mr{constructor(Se,Pe){const Ve=(Pe=this.options=function(dt,Pt){for(const Vt in Pt)dt[Vt]=Pt[Vt];return dt}(Object.create(wr),Pe)).debug;if(Ve&&console.time("preprocess data"),Pe.maxZoom<0||Pe.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Pe.promoteId&&Pe.generateId)throw new Error("promoteId and generateId cannot be used together.");let Qe=function(dt,Pt){const Vt=[];if(dt.type==="FeatureCollection")for(let At=0;At<dt.features.length;At++)te(Vt,dt.features[At],Pt,At);else te(Vt,dt.type==="Feature"?dt:{geometry:dt},Pt);return Vt}(Se,Pe);this.tiles={},this.tileCoords=[],Ve&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Pe.indexMaxZoom,Pe.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Qe=function(dt,Pt){const Vt=Pt.buffer/Pt.extent;let At=dt;const qt=Ye(dt,1,-1-Vt,Vt,0,-1,2,Pt),er=Ye(dt,1,1-Vt,2+Vt,0,-1,2,Pt);return(qt||er)&&(At=Ye(dt,1,-Vt,1+Vt,0,-1,2,Pt)||[],qt&&(At=Lt(qt,1).concat(At)),er&&(At=At.concat(Lt(er,-1)))),At}(Qe,Pe),Qe.length&&this.splitTile(Qe,0,0,0),Ve&&(Qe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(Se,Pe,Ve,Qe,dt,Pt,Vt){const At=[Se,Pe,Ve,Qe],qt=this.options,er=qt.debug;for(;At.length;){Qe=At.pop(),Ve=At.pop(),Pe=At.pop(),Se=At.pop();const fr=1<<Pe,Jr=hr(Pe,Ve,Qe);let $t=this.tiles[Jr];if(!$t&&(er>1&&console.time("creation"),$t=this.tiles[Jr]=Kt(Se,Pe,Ve,Qe,qt),this.tileCoords.push({z:Pe,x:Ve,y:Qe}),er)){er>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Pe,Ve,Qe,$t.numFeatures,$t.numPoints,$t.numSimplified),console.timeEnd("creation"));const xt=`z${Pe}`;this.stats[xt]=(this.stats[xt]||0)+1,this.total++}if($t.source=Se,dt==null){if(Pe===qt.indexMaxZoom||$t.numPoints<=qt.indexMaxPoints)continue}else{if(Pe===qt.maxZoom||Pe===dt)continue;if(dt!=null){const xt=dt-Pe;if(Ve!==Pt>>xt||Qe!==Vt>>xt)continue}}if($t.source=null,Se.length===0)continue;er>1&&console.time("clipping");const zr=.5*qt.buffer/qt.extent,Sr=.5-zr,Ir=.5+zr,Xr=1+zr;let qr=null,An=null,ge=null,ut=null,We=Ye(Se,fr,Ve-zr,Ve+Ir,0,$t.minX,$t.maxX,qt),Je=Ye(Se,fr,Ve+Sr,Ve+Xr,0,$t.minX,$t.maxX,qt);Se=null,We&&(qr=Ye(We,fr,Qe-zr,Qe+Ir,1,$t.minY,$t.maxY,qt),An=Ye(We,fr,Qe+Sr,Qe+Xr,1,$t.minY,$t.maxY,qt),We=null),Je&&(ge=Ye(Je,fr,Qe-zr,Qe+Ir,1,$t.minY,$t.maxY,qt),ut=Ye(Je,fr,Qe+Sr,Qe+Xr,1,$t.minY,$t.maxY,qt),Je=null),er>1&&console.timeEnd("clipping"),At.push(qr||[],Pe+1,2*Ve,2*Qe),At.push(An||[],Pe+1,2*Ve,2*Qe+1),At.push(ge||[],Pe+1,2*Ve+1,2*Qe),At.push(ut||[],Pe+1,2*Ve+1,2*Qe+1)}}getTile(Se,Pe,Ve){Se=+Se,Pe=+Pe,Ve=+Ve;const Qe=this.options,{extent:dt,debug:Pt}=Qe;if(Se<0||Se>24)return null;const Vt=1<<Se,At=hr(Se,Pe=Pe+Vt&Vt-1,Ve);if(this.tiles[At])return mt(this.tiles[At],dt);Pt>1&&console.log("drilling down to z%d-%d-%d",Se,Pe,Ve);let qt,er=Se,fr=Pe,Jr=Ve;for(;!qt&&er>0;)er--,fr>>=1,Jr>>=1,qt=this.tiles[hr(er,fr,Jr)];return qt&&qt.source?(Pt>1&&(console.log("found parent tile z%d-%d-%d",er,fr,Jr),console.time("drilling down")),this.splitTile(qt.source,er,fr,Jr,Se,Pe,Ve),Pt>1&&console.timeEnd("drilling down"),this.tiles[At]?mt(this.tiles[At],dt):null):null}}function hr(tt,Se,Pe){return 32*((1<<tt)*Pe+Se)+tt}class xr extends g{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(Se,Pe){return s._(this,void 0,void 0,function*(){const Ve=Se.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const Qe=this._geoJSONIndex.getTile(Ve.z,Ve.x,Ve.y);if(!Qe)return null;const dt=new P(Qe.features,{version:2,extent:s.$});let Pt=function(Vt){const At=new s.cM;return function(qt,er){for(const fr in qt.layers)er.writeMessage(3,C,qt.layers[fr])}(Vt,At),At.finish()}(dt);return Pt.byteOffset===0&&Pt.byteLength===Pt.buffer.byteLength||(Pt=new Uint8Array(Pt)),{vectorTile:dt,rawData:Pt.buffer}})}loadData(Se){return s._(this,void 0,void 0,function*(){var Pe;(Pe=this._pendingRequest)===null||Pe===void 0||Pe.abort();const Ve=!!(Se&&Se.request&&Se.request.collectResourceTiming)&&new s.cN(Se.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(Se,this._pendingRequest);const Qe=yield this._pendingData;this._geoJSONIndex=Se.cluster?new ee(function({superclusterOptions:Pt,clusterProperties:Vt}){if(!Vt||!Pt)return Pt;const At={},qt={},er={accumulated:null,zoom:0},fr={properties:null},Jr=Object.keys(Vt);for(const $t of Jr){const[zr,Sr]=Vt[$t],Ir=s.cT(Sr),Xr=s.cT(typeof zr=="string"?[zr,["accumulated"],["get",$t]]:zr);At[$t]=Ir.value,qt[$t]=Xr.value}return Pt.map=$t=>{fr.properties=$t;const zr={};for(const Sr of Jr)zr[Sr]=At[Sr].evaluate(er,fr);return zr},Pt.reduce=($t,zr)=>{fr.properties=zr;for(const Sr of Jr)er.accumulated=$t[Sr],$t[Sr]=qt[Sr].evaluate(er,fr)},Pt}(Se)).load(Qe.features):function(Pt,Vt){return new mr(Pt,Vt)}(Qe,Se.geojsonVtOptions),this.loaded={};const dt={data:Qe};if(Ve){const Pt=Ve.finish();Pt&&(dt.resourceTiming={},dt.resourceTiming[Se.source]=JSON.parse(JSON.stringify(Pt)))}return dt}catch(Qe){if(delete this._pendingRequest,s.cy(Qe))return{abandoned:!0};throw Qe}})}getData(){return s._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(Se){const Pe=this.loaded;return Pe&&Pe[Se.uid]?super.reloadTile(Se):this.loadTile(Se)}loadAndProcessGeoJSON(Se,Pe){return s._(this,void 0,void 0,function*(){let Ve=yield this.loadGeoJSON(Se,Pe);if(delete this._pendingRequest,typeof Ve!="object")throw new Error(`Input data given to '${Se.source}' is not a valid GeoJSON object.`);if(E(Ve,!0),Se.filter){const Qe=s.cT(Se.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Qe.result==="error")throw new Error(Qe.value.map(Pt=>`${Pt.key}: ${Pt.message}`).join(", "));Ve={type:"FeatureCollection",features:Ve.features.filter(Pt=>Qe.value.evaluate({zoom:0},Pt))}}return Ve})}loadGeoJSON(Se,Pe){return s._(this,void 0,void 0,function*(){const{promoteId:Ve}=Se;if(Se.request){const Qe=yield s.j(Se.request,Pe);return this._dataUpdateable=s.cV(Qe.data,Ve)?s.cU(Qe.data,Ve):void 0,Qe.data}if(typeof Se.data=="string")try{const Qe=JSON.parse(Se.data);return this._dataUpdateable=s.cV(Qe,Ve)?s.cU(Qe,Ve):void 0,Qe}catch{throw new Error(`Input data given to '${Se.source}' is not a valid GeoJSON object.`)}if(!Se.dataDiff)throw new Error(`Input data given to '${Se.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${Se.source}`);return s.cW(this._dataUpdateable,Se.dataDiff,Ve),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(Se){return s._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(Se){return this._geoJSONIndex.getClusterExpansionZoom(Se.clusterId)}getClusterChildren(Se){return this._geoJSONIndex.getChildren(Se.clusterId)}getClusterLeaves(Se){return this._geoJSONIndex.getLeaves(Se.clusterId,Se.limit,Se.offset)}}class or{constructor(Se){this.self=Se,this.actor=new s.J(Se),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(Pe,Ve)=>{if(this.externalWorkerSourceTypes[Pe])throw new Error(`Worker source with name "${Pe}" already registered.`);this.externalWorkerSourceTypes[Pe]=Ve},this.self.addProtocol=s.cA,this.self.removeProtocol=s.cB,this.self.registerRTLTextPlugin=Pe=>{s.cX.setMethods(Pe)},this.actor.registerMessageHandler("LDT",(Pe,Ve)=>this._getDEMWorkerSource(Pe,Ve.source).loadTile(Ve)),this.actor.registerMessageHandler("RDT",(Pe,Ve)=>s._(this,void 0,void 0,function*(){this._getDEMWorkerSource(Pe,Ve.source).removeTile(Ve)})),this.actor.registerMessageHandler("GCEZ",(Pe,Ve)=>s._(this,void 0,void 0,function*(){return this._getWorkerSource(Pe,Ve.type,Ve.source).getClusterExpansionZoom(Ve)})),this.actor.registerMessageHandler("GCC",(Pe,Ve)=>s._(this,void 0,void 0,function*(){return this._getWorkerSource(Pe,Ve.type,Ve.source).getClusterChildren(Ve)})),this.actor.registerMessageHandler("GCL",(Pe,Ve)=>s._(this,void 0,void 0,function*(){return this._getWorkerSource(Pe,Ve.type,Ve.source).getClusterLeaves(Ve)})),this.actor.registerMessageHandler("LD",(Pe,Ve)=>this._getWorkerSource(Pe,Ve.type,Ve.source).loadData(Ve)),this.actor.registerMessageHandler("GD",(Pe,Ve)=>this._getWorkerSource(Pe,Ve.type,Ve.source).getData()),this.actor.registerMessageHandler("LT",(Pe,Ve)=>this._getWorkerSource(Pe,Ve.type,Ve.source).loadTile(Ve)),this.actor.registerMessageHandler("RT",(Pe,Ve)=>this._getWorkerSource(Pe,Ve.type,Ve.source).reloadTile(Ve)),this.actor.registerMessageHandler("AT",(Pe,Ve)=>this._getWorkerSource(Pe,Ve.type,Ve.source).abortTile(Ve)),this.actor.registerMessageHandler("RMT",(Pe,Ve)=>this._getWorkerSource(Pe,Ve.type,Ve.source).removeTile(Ve)),this.actor.registerMessageHandler("RS",(Pe,Ve)=>s._(this,void 0,void 0,function*(){if(!this.workerSources[Pe]||!this.workerSources[Pe][Ve.type]||!this.workerSources[Pe][Ve.type][Ve.source])return;const Qe=this.workerSources[Pe][Ve.type][Ve.source];delete this.workerSources[Pe][Ve.type][Ve.source],Qe.removeSource!==void 0&&Qe.removeSource(Ve)})),this.actor.registerMessageHandler("RM",Pe=>s._(this,void 0,void 0,function*(){delete this.layerIndexes[Pe],delete this.availableImages[Pe],delete this.workerSources[Pe],delete this.demWorkerSources[Pe]})),this.actor.registerMessageHandler("SR",(Pe,Ve)=>s._(this,void 0,void 0,function*(){this.referrer=Ve})),this.actor.registerMessageHandler("SRPS",(Pe,Ve)=>this._syncRTLPluginState(Pe,Ve)),this.actor.registerMessageHandler("IS",(Pe,Ve)=>s._(this,void 0,void 0,function*(){this.self.importScripts(Ve)})),this.actor.registerMessageHandler("SI",(Pe,Ve)=>this._setImages(Pe,Ve)),this.actor.registerMessageHandler("UL",(Pe,Ve)=>s._(this,void 0,void 0,function*(){this._getLayerIndex(Pe).update(Ve.layers,Ve.removedIds)})),this.actor.registerMessageHandler("SL",(Pe,Ve)=>s._(this,void 0,void 0,function*(){this._getLayerIndex(Pe).replace(Ve)}))}_setImages(Se,Pe){return s._(this,void 0,void 0,function*(){this.availableImages[Se]=Pe;for(const Ve in this.workerSources[Se]){const Qe=this.workerSources[Se][Ve];for(const dt in Qe)Qe[dt].availableImages=Pe}})}_syncRTLPluginState(Se,Pe){return s._(this,void 0,void 0,function*(){return yield s.cX.syncState(Pe,this.self.importScripts)})}_getAvailableImages(Se){let Pe=this.availableImages[Se];return Pe||(Pe=[]),Pe}_getLayerIndex(Se){let Pe=this.layerIndexes[Se];return Pe||(Pe=this.layerIndexes[Se]=new a),Pe}_getWorkerSource(Se,Pe,Ve){if(this.workerSources[Se]||(this.workerSources[Se]={}),this.workerSources[Se][Pe]||(this.workerSources[Se][Pe]={}),!this.workerSources[Se][Pe][Ve]){const Qe={sendAsync:(dt,Pt)=>(dt.targetMapId=Se,this.actor.sendAsync(dt,Pt))};switch(Pe){case"vector":this.workerSources[Se][Pe][Ve]=new g(Qe,this._getLayerIndex(Se),this._getAvailableImages(Se));break;case"geojson":this.workerSources[Se][Pe][Ve]=new xr(Qe,this._getLayerIndex(Se),this._getAvailableImages(Se));break;default:this.workerSources[Se][Pe][Ve]=new this.externalWorkerSourceTypes[Pe](Qe,this._getLayerIndex(Se),this._getAvailableImages(Se))}}return this.workerSources[Se][Pe][Ve]}_getDEMWorkerSource(Se,Pe){return this.demWorkerSources[Se]||(this.demWorkerSources[Se]={}),this.demWorkerSources[Se][Pe]||(this.demWorkerSources[Se][Pe]=new _),this.demWorkerSources[Se][Pe]}}return s.i(self)&&(self.worker=new or(self)),or}),i("index",["exports","./shared"],function(s,a){var u="5.7.0";function d(){var A=new a.A(4);return a.A!=Float32Array&&(A[1]=0,A[2]=0),A[0]=1,A[3]=1,A}let m,g;const _={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(A,l,p){const b=requestAnimationFrame(k=>{S(),l(k)}),{unsubscribe:S}=a.s(A.signal,"abort",()=>{S(),cancelAnimationFrame(b),p(a.c())},!1)},frameAsync(A){return new Promise((l,p)=>{this.frame(A,l,p)})},getImageData(A,l=0){return this.getImageCanvasContext(A).getImageData(-l,-l,A.width+2*l,A.height+2*l)},getImageCanvasContext(A){const l=window.document.createElement("canvas"),p=l.getContext("2d",{willReadFrequently:!0});if(!p)throw new Error("failed to create canvas 2d context");return l.width=A.width,l.height=A.height,p.drawImage(A,0,0,A.width,A.height),p},resolveURL:A=>(m||(m=document.createElement("a")),m.href=A,m.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(g==null&&(g=matchMedia("(prefers-reduced-motion: reduce)")),g.matches)}};class y{static testProp(l){if(!y.docStyle)return l[0];for(let p=0;p<l.length;p++)if(l[p]in y.docStyle)return l[p];return l[0]}static create(l,p,b){const S=window.document.createElement(l);return p!==void 0&&(S.className=p),b&&b.appendChild(S),S}static createNS(l,p){return window.document.createElementNS(l,p)}static disableDrag(){y.docStyle&&y.selectProp&&(y.userSelect=y.docStyle[y.selectProp],y.docStyle[y.selectProp]="none")}static enableDrag(){y.docStyle&&y.selectProp&&(y.docStyle[y.selectProp]=y.userSelect)}static setTransform(l,p){l.style[y.transformProp]=p}static addEventListener(l,p,b,S={}){l.addEventListener(p,b,"passive"in S?S:S.capture)}static removeEventListener(l,p,b,S={}){l.removeEventListener(p,b,"passive"in S?S:S.capture)}static suppressClickInternal(l){l.preventDefault(),l.stopPropagation(),window.removeEventListener("click",y.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",y.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",y.suppressClickInternal,!0)},0)}static getScale(l){const p=l.getBoundingClientRect();return{x:p.width/l.offsetWidth||1,y:p.height/l.offsetHeight||1,boundingClientRect:p}}static getPoint(l,p,b){const S=p.boundingClientRect;return new a.P((b.clientX-S.left)/p.x-l.clientLeft,(b.clientY-S.top)/p.y-l.clientTop)}static mousePos(l,p){const b=y.getScale(l);return y.getPoint(l,b,p)}static touchPos(l,p){const b=[],S=y.getScale(l);for(let k=0;k<p.length;k++)b.push(y.getPoint(l,S,p[k]));return b}static mouseButton(l){return l.button}static remove(l){l.parentNode&&l.parentNode.removeChild(l)}static sanitize(l){const p=new DOMParser().parseFromString(l,"text/html").body||document.createElement("body"),b=p.querySelectorAll("script");for(const S of b)S.remove();return y.clean(p),p.innerHTML}static isPossiblyDangerous(l,p){const b=p.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(l)||!b.includes("javascript:")&&!b.includes("data:"))||!!l.startsWith("on")||void 0}static clean(l){const p=l.children;for(const b of p)y.removeAttributes(b),y.clean(b)}static removeAttributes(l){for(const{name:p,value:b}of l.attributes)y.isPossiblyDangerous(p,b)&&l.removeAttribute(p)}}y.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,y.selectProp=y.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),y.transformProp=y.testProp(["transform","WebkitTransform"]);const M={supported:!1,testSupport:function(A){!T&&E&&(P?C(A):x=A)}};let x,E,T=!1,P=!1;function C(A){const l=A.createTexture();A.bindTexture(A.TEXTURE_2D,l);try{if(A.texImage2D(A.TEXTURE_2D,0,A.RGBA,A.RGBA,A.UNSIGNED_BYTE,E),A.isContextLost())return;M.supported=!0}catch{}A.deleteTexture(l),T=!0}var D;typeof document<"u"&&(E=document.createElement("img"),E.onload=()=>{x&&C(x),x=null,P=!0},E.onerror=()=>{T=!0,x=null},E.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(A){let l,p,b,S;A.resetRequestQueue=()=>{l=[],p=0,b=0,S={}},A.addThrottleControl=Z=>{const ie=b++;return S[ie]=Z,ie},A.removeThrottleControl=Z=>{delete S[Z],R()},A.getImage=(Z,ie,ce=!0)=>new Promise((xe,be)=>{M.supported&&(Z.headers||(Z.headers={}),Z.headers.accept="image/webp,*/*"),a.e(Z,{type:"image"}),l.push({abortController:ie,requestParameters:Z,supportImageRefresh:ce,state:"queued",onError:Ae=>{be(Ae)},onSuccess:Ae=>{xe(Ae)}}),R()});const k=Z=>a._(this,void 0,void 0,function*(){Z.state="running";const{requestParameters:ie,supportImageRefresh:ce,onError:xe,onSuccess:be,abortController:Ae}=Z,Ue=ce===!1&&!a.i(self)&&!a.g(ie.url)&&(!ie.headers||Object.keys(ie.headers).reduce((ft,gt)=>ft&&gt==="accept",!0));p++;const lt=Ue?W(ie,Ae):a.m(ie,Ae);try{const ft=yield lt;delete Z.abortController,Z.state="completed",ft.data instanceof HTMLImageElement||a.b(ft.data)?be(ft):ft.data&&be({data:yield(it=ft.data,typeof createImageBitmap=="function"?a.f(it):a.h(it)),cacheControl:ft.cacheControl,expires:ft.expires})}catch(ft){delete Z.abortController,xe(ft)}finally{p--,R()}var it}),R=()=>{const Z=(()=>{for(const ie of Object.keys(S))if(S[ie]())return!0;return!1})()?a.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:a.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let ie=p;ie<Z&&l.length>0;ie++){const ce=l.shift();ce.abortController.signal.aborted?ie--:k(ce)}},W=(Z,ie)=>new Promise((ce,xe)=>{const be=new Image,Ae=Z.url,Ue=Z.credentials;Ue&&Ue==="include"?be.crossOrigin="use-credentials":(Ue&&Ue==="same-origin"||!a.d(Ae))&&(be.crossOrigin="anonymous"),ie.signal.addEventListener("abort",()=>{be.src="",xe(a.c())}),be.fetchPriority="high",be.onload=()=>{be.onerror=be.onload=null,ce({data:be})},be.onerror=()=>{be.onerror=be.onload=null,ie.signal.aborted||xe(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},be.src=Ae})}(D||(D={})),D.resetRequestQueue();class L{constructor(l){this._transformRequestFn=l??null}transformRequest(l,p){return this._transformRequestFn&&this._transformRequestFn(l,p)||{url:l}}setTransformRequest(l){this._transformRequestFn=l}}function N(A){const l=[];if(typeof A=="string")l.push({id:"default",url:A});else if(A&&A.length>0){const p=[];for(const{id:b,url:S}of A){const k=`${b}${S}`;p.indexOf(k)===-1&&(p.push(k),l.push({id:b,url:S}))}}return l}function j(A,l,p){try{const b=new URL(A);return b.pathname+=`${l}${p}`,b.toString()}catch{throw new Error(`Invalid sprite URL "${A}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function $(A){const{userImage:l}=A;return!!(l&&l.render&&l.render())&&(A.data.replace(new Uint8Array(l.data.buffer)),!0)}class U extends a.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(l){if(this.loaded!==l&&(this.loaded=l,l)){for(const{ids:p,promiseResolve:b}of this.requestors)b(this._getImagesForIds(p));this.requestors=[]}}getImage(l){const p=this.images[l];if(p&&!p.data&&p.spriteData){const b=p.spriteData;p.data=new a.R({width:b.width,height:b.height},b.context.getImageData(b.x,b.y,b.width,b.height).data),p.spriteData=null}return p}addImage(l,p){if(this.images[l])throw new Error(`Image id ${l} already exist, use updateImage instead`);this._validate(l,p)&&(this.images[l]=p)}_validate(l,p){let b=!0;const S=p.data||p.spriteData;return this._validateStretch(p.stretchX,S&&S.width)||(this.fire(new a.k(new Error(`Image "${l}" has invalid "stretchX" value`))),b=!1),this._validateStretch(p.stretchY,S&&S.height)||(this.fire(new a.k(new Error(`Image "${l}" has invalid "stretchY" value`))),b=!1),this._validateContent(p.content,p)||(this.fire(new a.k(new Error(`Image "${l}" has invalid "content" value`))),b=!1),b}_validateStretch(l,p){if(!l)return!0;let b=0;for(const S of l){if(S[0]<b||S[1]<S[0]||p<S[1])return!1;b=S[1]}return!0}_validateContent(l,p){if(!l)return!0;if(l.length!==4)return!1;const b=p.spriteData,S=b&&b.width||p.data.width,k=b&&b.height||p.data.height;return!(l[0]<0||S<l[0]||l[1]<0||k<l[1]||l[2]<0||S<l[2]||l[3]<0||k<l[3]||l[2]<l[0]||l[3]<l[1])}updateImage(l,p,b=!0){const S=this.getImage(l);if(b&&(S.data.width!==p.data.width||S.data.height!==p.data.height))throw new Error(`size mismatch between old image (${S.data.width}x${S.data.height}) and new image (${p.data.width}x${p.data.height}).`);p.version=S.version+1,this.images[l]=p,this.updatedImages[l]=!0}removeImage(l){const p=this.images[l];delete this.images[l],delete this.patterns[l],p.userImage&&p.userImage.onRemove&&p.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(l){return new Promise((p,b)=>{let S=!0;if(!this.isLoaded())for(const k of l)this.images[k]||(S=!1);this.isLoaded()||S?p(this._getImagesForIds(l)):this.requestors.push({ids:l,promiseResolve:p})})}_getImagesForIds(l){const p={};for(const b of l){let S=this.getImage(b);S||(this.fire(new a.l("styleimagemissing",{id:b})),S=this.getImage(b)),S?p[b]={data:S.data.clone(),pixelRatio:S.pixelRatio,sdf:S.sdf,version:S.version,stretchX:S.stretchX,stretchY:S.stretchY,content:S.content,textFitWidth:S.textFitWidth,textFitHeight:S.textFitHeight,hasRenderCallback:!!(S.userImage&&S.userImage.render)}:a.w(`Image "${b}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return p}getPixelSize(){const{width:l,height:p}=this.atlasImage;return{width:l,height:p}}getPattern(l){const p=this.patterns[l],b=this.getImage(l);if(!b)return null;if(p&&p.position.version===b.version)return p.position;if(p)p.position.version=b.version;else{const S={w:b.data.width+2,h:b.data.height+2,x:0,y:0},k=new a.I(S,b);this.patterns[l]={bin:S,position:k}}return this._updatePatternAtlas(),this.patterns[l].position}bind(l){const p=l.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.T(l,this.atlasImage,p.RGBA),this.atlasTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE)}_updatePatternAtlas(){const l=[];for(const k in this.patterns)l.push(this.patterns[k].bin);const{w:p,h:b}=a.p(l),S=this.atlasImage;S.resize({width:p||1,height:b||1});for(const k in this.patterns){const{bin:R}=this.patterns[k],W=R.x+1,Z=R.y+1,ie=this.getImage(k).data,ce=ie.width,xe=ie.height;a.R.copy(ie,S,{x:0,y:0},{x:W,y:Z},{width:ce,height:xe}),a.R.copy(ie,S,{x:0,y:xe-1},{x:W,y:Z-1},{width:ce,height:1}),a.R.copy(ie,S,{x:0,y:0},{x:W,y:Z+xe},{width:ce,height:1}),a.R.copy(ie,S,{x:ce-1,y:0},{x:W-1,y:Z},{width:1,height:xe}),a.R.copy(ie,S,{x:0,y:0},{x:W+ce,y:Z},{width:1,height:xe})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(l){for(const p of l){if(this.callbackDispatchedThisFrame[p])continue;this.callbackDispatchedThisFrame[p]=!0;const b=this.getImage(p);b||a.w(`Image with ID: "${p}" was not found`),$(b)&&this.updateImage(p,b)}}}const G=1e20;function H(A,l,p,b,S,k,R,W,Z){for(let ie=l;ie<l+b;ie++)X(A,p*k+ie,k,S,R,W,Z);for(let ie=p;ie<p+S;ie++)X(A,ie*k+l,1,b,R,W,Z)}function X(A,l,p,b,S,k,R){k[0]=0,R[0]=-G,R[1]=G,S[0]=A[l];for(let W=1,Z=0,ie=0;W<b;W++){S[W]=A[l+W*p];const ce=W*W;do{const xe=k[Z];ie=(S[W]-S[xe]+ce-xe*xe)/(W-xe)/2}while(ie<=R[Z]&&--Z>-1);Z++,k[Z]=W,R[Z]=ie,R[Z+1]=G}for(let W=0,Z=0;W<b;W++){for(;R[Z+1]<W;)Z++;const ie=k[Z],ce=W-ie;A[l+W*p]=S[ie]+ce*ce}}class ee{constructor(l,p,b){this.requestManager=l,this.localIdeographFontFamily=p,this.entries={},this.lang=b}setURL(l){this.url=l}getGlyphs(l){return a._(this,void 0,void 0,function*(){const p=[];for(const k in l)for(const R of l[k])p.push(this._getAndCacheGlyphsPromise(k,R));const b=yield Promise.all(p),S={};for(const{stack:k,id:R,glyph:W}of b)S[k]||(S[k]={}),S[k][R]=W&&{id:W.id,bitmap:W.bitmap.clone(),metrics:W.metrics};return S})}_getAndCacheGlyphsPromise(l,p){return a._(this,void 0,void 0,function*(){let b=this.entries[l];b||(b=this.entries[l]={glyphs:{},requests:{},ranges:{}});let S=b.glyphs[p];if(S!==void 0)return{stack:l,id:p,glyph:S};if(S=this._tinySDF(b,l,p),S)return b.glyphs[p]=S,{stack:l,id:p,glyph:S};const k=Math.floor(p/256);if(256*k>65535)throw new Error("glyphs > 65535 not supported");if(b.ranges[k])return{stack:l,id:p,glyph:S};if(!this.url)throw new Error("glyphsUrl is not set");if(!b.requests[k]){const W=ee.loadGlyphRange(l,k,this.url,this.requestManager);b.requests[k]=W}const R=yield b.requests[k];for(const W in R)this._doesCharSupportLocalGlyph(+W)||(b.glyphs[+W]=R[+W]);return b.ranges[k]=!0,{stack:l,id:p,glyph:R[p]||null}})}_doesCharSupportLocalGlyph(l){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(l))||a.u["CJK Unified Ideographs"](l)||a.u["Hangul Syllables"](l)||a.u.Hiragana(l)||a.u.Katakana(l)||a.u["CJK Symbols and Punctuation"](l)||a.u["Halfwidth and Fullwidth Forms"](l))}_tinySDF(l,p,b){const S=this.localIdeographFontFamily;if(!S||!this._doesCharSupportLocalGlyph(b))return;let k=l.tinySDF;if(!k){let W="400";/bold/i.test(p)?W="900":/medium/i.test(p)?W="500":/light/i.test(p)&&(W="200"),k=l.tinySDF=new ee.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,lang:this.lang,fontFamily:S,fontWeight:W})}const R=k.draw(String.fromCharCode(b));return{id:b,bitmap:new a.q({width:R.width||60,height:R.height||60},R.data),metrics:{width:R.glyphWidth/2||24,height:R.glyphHeight/2||24,left:R.glyphLeft/2+.5||0,top:R.glyphTop/2-27.5||-8,advance:R.glyphAdvance/2||24,isDoubleResolution:!0}}}}ee.loadGlyphRange=function(A,l,p,b){return a._(this,void 0,void 0,function*(){const S=256*l,k=S+255,R=b.transformRequest(p.replace("{fontstack}",A).replace("{range}",`${S}-${k}`),"Glyphs"),W=yield a.n(R,new AbortController);if(!W||!W.data)throw new Error(`Could not load glyph range. range: ${l}, ${S}-${k}`);const Z={};for(const ie of a.o(W.data))Z[ie.id]=ie;return Z})},ee.TinySDF=class{constructor({fontSize:A=24,buffer:l=3,radius:p=8,cutoff:b=.25,fontFamily:S="sans-serif",fontWeight:k="normal",fontStyle:R="normal",lang:W=null}={}){this.buffer=l,this.cutoff=b,this.radius=p,this.lang=W;const Z=this.size=A+4*l,ie=this._createCanvas(Z),ce=this.ctx=ie.getContext("2d",{willReadFrequently:!0});ce.font=`${R} ${k} ${A}px ${S}`,ce.textBaseline="alphabetic",ce.textAlign="left",ce.fillStyle="black",this.gridOuter=new Float64Array(Z*Z),this.gridInner=new Float64Array(Z*Z),this.f=new Float64Array(Z),this.z=new Float64Array(Z+1),this.v=new Uint16Array(Z)}_createCanvas(A){const l=document.createElement("canvas");return l.width=l.height=A,l}draw(A){const{width:l,actualBoundingBoxAscent:p,actualBoundingBoxDescent:b,actualBoundingBoxLeft:S,actualBoundingBoxRight:k}=this.ctx.measureText(A),R=Math.ceil(p),W=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(k-S))),Z=Math.min(this.size-this.buffer,R+Math.ceil(b)),ie=W+2*this.buffer,ce=Z+2*this.buffer,xe=Math.max(ie*ce,0),be=new Uint8ClampedArray(xe),Ae={data:be,width:ie,height:ce,glyphWidth:W,glyphHeight:Z,glyphTop:R,glyphLeft:0,glyphAdvance:l};if(W===0||Z===0)return Ae;const{ctx:Ue,buffer:lt,gridInner:it,gridOuter:ft}=this;this.lang&&(Ue.lang=this.lang),Ue.clearRect(lt,lt,W,Z),Ue.fillText(A,lt,lt+R);const gt=Ue.getImageData(lt,lt,W,Z);ft.fill(G,0,xe),it.fill(0,0,xe);for(let Et=0;Et<Z;Et++)for(let Mt=0;Mt<W;Mt++){const It=gt.data[4*(Et*W+Mt)+3]/255;if(It===0)continue;const jt=(Et+lt)*ie+Mt+lt;if(It===1)ft[jt]=0,it[jt]=G;else{const St=.5-It;ft[jt]=St>0?St*St:0,it[jt]=St<0?St*St:0}}H(ft,0,0,ie,ce,ie,this.f,this.v,this.z),H(it,lt,lt,W,Z,ie,this.f,this.v,this.z);for(let Et=0;Et<xe;Et++){const Mt=Math.sqrt(ft[Et])-Math.sqrt(it[Et]);be[Et]=Math.round(255-255*(Mt/this.radius+this.cutoff))}return Ae}};class ae{constructor(){this.specification=a.v.light.position}possiblyEvaluate(l,p){return a.B(l.expression.evaluate(p))}interpolate(l,p,b){return{x:a.C.number(l.x,p.x,b),y:a.C.number(l.y,p.y,b),z:a.C.number(l.z,p.z,b)}}}let de;class ye extends a.E{constructor(l){super(),de=de||new a.r({anchor:new a.D(a.v.light.anchor),position:new ae,color:new a.D(a.v.light.color),intensity:new a.D(a.v.light.intensity)}),this._transitionable=new a.t(de),this.setLight(l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(l,p={}){if(!this._validate(a.x,l,p))for(const b in l){const S=l[b];b.endsWith("-transition")?this._transitionable.setTransition(b.slice(0,-11),S):this._transitionable.setValue(b,S)}}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,p,b){return(!b||b.validate!==!1)&&a.y(this,l.call(a.z,{value:p,style:{glyphs:!0,sprite:!0},styleSpec:a.v}))}}const _e=new a.r({"sky-color":new a.D(a.v.sky["sky-color"]),"horizon-color":new a.D(a.v.sky["horizon-color"]),"fog-color":new a.D(a.v.sky["fog-color"]),"fog-ground-blend":new a.D(a.v.sky["fog-ground-blend"]),"horizon-fog-blend":new a.D(a.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new a.D(a.v.sky["sky-horizon-blend"]),"atmosphere-blend":new a.D(a.v.sky["atmosphere-blend"])});class ue extends a.E{constructor(l){super(),this._transitionable=new a.t(_e),this.setSky(l),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new a.F(0))}setSky(l,p={}){if(!this._validate(a.G,l,p)){l||(l={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const b in l){const S=l[b];b.endsWith("-transition")?this._transitionable.setTransition(b.slice(0,-11),S):this._transitionable.setValue(b,S)}}}getSky(){return this._transitionable.serialize()}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,p,b={}){return(b==null?void 0:b.validate)!==!1&&a.y(this,l.call(a.z,a.e({value:p,style:{glyphs:!0,sprite:!0},styleSpec:a.v})))}calculateFogBlendOpacity(l){return l<60?0:l<70?(l-60)/10:1}}class fe{constructor(l,p){this.width=l,this.height=p,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(l,p){const b=l.join(",")+String(p);return this.dashEntry[b]||(this.dashEntry[b]=this.addDash(l,p)),this.dashEntry[b]}getDashRanges(l,p,b){const S=[];let k=l.length%2==1?-l[l.length-1]*b:0,R=l[0]*b,W=!0;S.push({left:k,right:R,isDash:W,zeroLength:l[0]===0});let Z=l[0];for(let ie=1;ie<l.length;ie++){W=!W;const ce=l[ie];k=Z*b,Z+=ce,R=Z*b,S.push({left:k,right:R,isDash:W,zeroLength:ce===0})}return S}addRoundDash(l,p,b){const S=p/2;for(let k=-b;k<=b;k++){const R=this.width*(this.nextRow+b+k);let W=0,Z=l[W];for(let ie=0;ie<this.width;ie++){ie/Z.right>1&&(Z=l[++W]);const ce=Math.abs(ie-Z.left),xe=Math.abs(ie-Z.right),be=Math.min(ce,xe);let Ae;const Ue=k/b*(S+1);if(Z.isDash){const lt=S-Math.abs(Ue);Ae=Math.sqrt(be*be+lt*lt)}else Ae=S-Math.sqrt(be*be+Ue*Ue);this.data[R+ie]=Math.max(0,Math.min(255,Ae+128))}}}addRegularDash(l){for(let W=l.length-1;W>=0;--W){const Z=l[W],ie=l[W+1];Z.zeroLength?l.splice(W,1):ie&&ie.isDash===Z.isDash&&(ie.left=Z.left,l.splice(W,1))}const p=l[0],b=l[l.length-1];p.isDash===b.isDash&&(p.left=b.left-this.width,b.right=p.right+this.width);const S=this.width*this.nextRow;let k=0,R=l[k];for(let W=0;W<this.width;W++){W/R.right>1&&(R=l[++k]);const Z=Math.abs(W-R.left),ie=Math.abs(W-R.right),ce=Math.min(Z,ie);this.data[S+W]=Math.max(0,Math.min(255,(R.isDash?ce:-ce)+128))}}addDash(l,p){const b=p?7:0,S=2*b+1;if(this.nextRow+S>this.height)return a.w("LineAtlas out of space"),null;let k=0;for(let W=0;W<l.length;W++)k+=l[W];if(k!==0){const W=this.width/k,Z=this.getDashRanges(l,this.width,W);p?this.addRoundDash(Z,W,b):this.addRegularDash(Z)}const R={y:(this.nextRow+b+.5)/this.height,height:2*b/this.height,width:k};return this.nextRow+=S,this.dirty=!0,R}bind(l){const p=l.gl;this.texture?(p.bindTexture(p.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,p.texSubImage2D(p.TEXTURE_2D,0,0,0,this.width,this.height,p.ALPHA,p.UNSIGNED_BYTE,this.data))):(this.texture=p.createTexture(),p.bindTexture(p.TEXTURE_2D,this.texture),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.REPEAT),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.REPEAT),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.LINEAR),p.texImage2D(p.TEXTURE_2D,0,p.ALPHA,this.width,this.height,0,p.ALPHA,p.UNSIGNED_BYTE,this.data))}}const De="maplibre_preloaded_worker_pool";class pe{constructor(){this.active={}}acquire(l){if(!this.workers)for(this.workers=[];this.workers.length<pe.workerCount;)this.workers.push(new Worker(a.a.WORKER_URL));return this.active[l]=!0,this.workers.slice()}release(l){delete this.active[l],this.numActive()===0&&(this.workers.forEach(p=>{p.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[De]}numActive(){return Object.keys(this.active).length}}const K=Math.floor(_.hardwareConcurrency/2);let te,ve;function $e(){return te||(te=new pe),te}pe.workerCount=a.H(globalThis)?Math.max(Math.min(K,3),1):1;class Ce{constructor(l,p){this.workerPool=l,this.actors=[],this.currentActor=0,this.id=p;const b=this.workerPool.acquire(p);for(let S=0;S<b.length;S++){const k=new a.J(b[S],p);k.name=`Worker ${S}`,this.actors.push(k)}if(!this.actors.length)throw new Error("No actors found")}broadcast(l,p){const b=[];for(const S of this.actors)b.push(S.sendAsync({type:l,data:p}));return Promise.all(b)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(l=!0){this.actors.forEach(p=>{p.remove()}),this.actors=[],l&&this.workerPool.release(this.id)}registerMessageHandler(l,p){for(const b of this.actors)b.registerMessageHandler(l,p)}}function Ge(){return ve||(ve=new Ce($e(),a.K),ve.registerMessageHandler("GR",(A,l,p)=>a.m(l,p))),ve}function ot(A,l){const p=a.L();return a.M(p,p,[1,1,0]),a.N(p,p,[.5*A.width,.5*A.height,1]),A.calculatePosMatrix?a.O(p,p,A.calculatePosMatrix(l.toUnwrapped())):p}function Ye(A,l,p,b,S,k,R){var W;const Z=function(be,Ae,Ue){if(be)for(const lt of be){const it=Ae[lt];if(it&&it.source===Ue&&it.type==="fill-extrusion")return!0}else for(const lt in Ae){const it=Ae[lt];if(it.source===Ue&&it.type==="fill-extrusion")return!0}return!1}((W=S==null?void 0:S.layers)!==null&&W!==void 0?W:null,l,A.id),ie=k.maxPitchScaleFactor(),ce=A.tilesIn(b,ie,Z);ce.sort(et);const xe=[];for(const be of ce)xe.push({wrappedTileID:be.tileID.wrapped().key,queryResults:be.tile.queryRenderedFeatures(l,p,A._state,be.queryGeometry,be.cameraQueryGeometry,be.scale,S,k,ie,ot(A.transform,be.tileID),R?(Ae,Ue)=>R(be.tileID,Ae,Ue):void 0)});return function(be,Ae){for(const Ue in be)for(const lt of be[Ue])Te(lt,Ae);return be}(function(be){const Ae={},Ue={};for(const lt of be){const it=lt.queryResults,ft=lt.wrappedTileID,gt=Ue[ft]=Ue[ft]||{};for(const Et in it){const Mt=it[Et],It=gt[Et]=gt[Et]||{},jt=Ae[Et]=Ae[Et]||[];for(const St of Mt)It[St.featureIndex]||(It[St.featureIndex]=!0,jt.push(St))}}return Ae}(xe),A)}function et(A,l){const p=A.tileID,b=l.tileID;return p.overscaledZ-b.overscaledZ||p.canonical.y-b.canonical.y||p.wrap-b.wrap||p.canonical.x-b.canonical.x}function Te(A,l){const p=A.feature,b=l.getFeatureState(p.layer["source-layer"],p.id);p.source=p.layer.source,p.layer["source-layer"]&&(p.sourceLayer=p.layer["source-layer"]),p.state=b}function Le(A,l,p){return a._(this,void 0,void 0,function*(){let b=A;if(A.url?b=(yield a.j(l.transformRequest(A.url,"Source"),p)).data:yield _.frameAsync(p),!b)return null;const S=a.Q(a.e(b,A),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in b&&b.vector_layers&&(S.vectorLayerIds=b.vector_layers.map(k=>k.id)),S})}class ke{constructor(l,p){l&&(p?this.setSouthWest(l).setNorthEast(p):Array.isArray(l)&&(l.length===4?this.setSouthWest([l[0],l[1]]).setNorthEast([l[2],l[3]]):this.setSouthWest(l[0]).setNorthEast(l[1])))}setNorthEast(l){return this._ne=l instanceof a.S?new a.S(l.lng,l.lat):a.S.convert(l),this}setSouthWest(l){return this._sw=l instanceof a.S?new a.S(l.lng,l.lat):a.S.convert(l),this}extend(l){const p=this._sw,b=this._ne;let S,k;if(l instanceof a.S)S=l,k=l;else{if(!(l instanceof ke))return Array.isArray(l)?l.length===4||l.every(Array.isArray)?this.extend(ke.convert(l)):this.extend(a.S.convert(l)):l&&("lng"in l||"lon"in l)&&"lat"in l?this.extend(a.S.convert(l)):this;if(S=l._sw,k=l._ne,!S||!k)return this}return p||b?(p.lng=Math.min(S.lng,p.lng),p.lat=Math.min(S.lat,p.lat),b.lng=Math.max(k.lng,b.lng),b.lat=Math.max(k.lat,b.lat)):(this._sw=new a.S(S.lng,S.lat),this._ne=new a.S(k.lng,k.lat)),this}getCenter(){return new a.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new a.S(this.getWest(),this.getNorth())}getSouthEast(){return new a.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(l){const{lng:p,lat:b}=a.S.convert(l);let S=this._sw.lng<=p&&p<=this._ne.lng;return this._sw.lng>this._ne.lng&&(S=this._sw.lng>=p&&p>=this._ne.lng),this._sw.lat<=b&&b<=this._ne.lat&&S}static convert(l){return l instanceof ke?l:l&&new ke(l)}static fromLngLat(l,p=0){const b=360*p/40075017,S=b/Math.cos(Math.PI/180*l.lat);return new ke(new a.S(l.lng-S,l.lat-b),new a.S(l.lng+S,l.lat+b))}adjustAntiMeridian(){const l=new a.S(this._sw.lng,this._sw.lat),p=new a.S(this._ne.lng,this._ne.lat);return new ke(l,l.lng>p.lng?new a.S(p.lng+360,p.lat):p)}}class Xe{constructor(l,p,b){this.bounds=ke.convert(this.validateBounds(l)),this.minzoom=p||0,this.maxzoom=b||24}validateBounds(l){return Array.isArray(l)&&l.length===4?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]}contains(l){const p=Math.pow(2,l.z),b=Math.floor(a.V(this.bounds.getWest())*p),S=Math.floor(a.U(this.bounds.getNorth())*p),k=Math.ceil(a.V(this.bounds.getEast())*p),R=Math.ceil(a.U(this.bounds.getSouth())*p);return l.x>=b&&l.x<k&&l.y>=S&&l.y<R}}class Ne extends a.E{constructor(l,p,b,S){if(super(),this.id=l,this.dispatcher=b,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.e(this,a.Q(p,["url","scheme","tileSize","promoteId"])),this._options=a.e({type:"vector"},p),this._collectResourceTiming=p.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(S)}load(){return a._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new a.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const l=yield Le(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),l&&(a.e(this,l),l.bounds&&(this.tileBounds=new Xe(l.bounds,this.minzoom,this.maxzoom)),this.fire(new a.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.l("data",{dataType:"source",sourceDataType:"content"})))}catch(l){this._tileJSONRequest=null,this.fire(new a.k(l))}})}loaded(){return this._loaded}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}onAdd(l){this.map=l,this.load()}setSourceProperty(l){this._tileJSONRequest&&this._tileJSONRequest.abort(),l(),this.load()}setTiles(l){return this.setSourceProperty(()=>{this._options.tiles=l}),this}setUrl(l){return this.setSourceProperty(()=>{this.url=l,this._options.url=l}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return a.e({},this._options)}loadTile(l){return a._(this,void 0,void 0,function*(){const p=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),b={request:this.map._requestManager.transformRequest(p,"Tile"),uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,tileSize:this.tileSize*l.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};b.request.collectResourceTiming=this._collectResourceTiming;let S="RT";if(l.actor&&l.state!=="expired"){if(l.state==="loading")return new Promise((k,R)=>{l.reloadPromise={resolve:k,reject:R}})}else l.actor=this.dispatcher.getActor(),S="LT";l.abortController=new AbortController;try{const k=yield l.actor.sendAsync({type:S,data:b},l.abortController);if(delete l.abortController,l.aborted)return;this._afterTileLoadWorkerResponse(l,k)}catch(k){if(delete l.abortController,l.aborted)return;if(k&&k.status!==404)throw k;this._afterTileLoadWorkerResponse(l,null)}})}_afterTileLoadWorkerResponse(l,p){if(p&&p.resourceTiming&&(l.resourceTiming=p.resourceTiming),p&&this.map._refreshExpiredTiles&&l.setExpiryData(p),l.loadVectorData(p,this.map.painter),l.reloadPromise){const b=l.reloadPromise;l.reloadPromise=null,this.loadTile(l).then(b.resolve).catch(b.reject)}}abortTile(l){return a._(this,void 0,void 0,function*(){l.abortController&&(l.abortController.abort(),delete l.abortController),l.actor&&(yield l.actor.sendAsync({type:"AT",data:{uid:l.uid,type:this.type,source:this.id}}))})}unloadTile(l){return a._(this,void 0,void 0,function*(){l.unloadVectorData(),l.actor&&(yield l.actor.sendAsync({type:"RMT",data:{uid:l.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Ot extends a.E{constructor(l,p,b,S){super(),this.id=l,this.dispatcher=b,this.setEventedParent(S),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.e({type:"raster"},p),a.e(this,a.Q(p,["url","scheme","tileSize"]))}load(){return a._(this,arguments,void 0,function*(l=!1){this._loaded=!1,this.fire(new a.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const p=yield Le(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,p&&(a.e(this,p),p.bounds&&(this.tileBounds=new Xe(p.bounds,this.minzoom,this.maxzoom)),this.fire(new a.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:l})))}catch(p){this._tileJSONRequest=null,this.fire(new a.k(p))}})}loaded(){return this._loaded}onAdd(l){this.map=l,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(l){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),l(),this.load(!0)}setTiles(l){return this.setSourceProperty(()=>{this._options.tiles=l}),this}setUrl(l){return this.setSourceProperty(()=>{this.url=l,this._options.url=l}),this}serialize(){return a.e({},this._options)}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}loadTile(l){return a._(this,void 0,void 0,function*(){const p=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);l.abortController=new AbortController;try{const b=yield D.getImage(this.map._requestManager.transformRequest(p,"Tile"),l.abortController,this.map._refreshExpiredTiles);if(delete l.abortController,l.aborted)return void(l.state="unloaded");if(b&&b.data){this.map._refreshExpiredTiles&&(b.cacheControl||b.expires)&&l.setExpiryData({cacheControl:b.cacheControl,expires:b.expires});const S=this.map.painter.context,k=S.gl,R=b.data;l.texture=this.map.painter.getTileTexture(R.width),l.texture?l.texture.update(R,{useMipmap:!0}):(l.texture=new a.T(S,R,k.RGBA,{useMipmap:!0}),l.texture.bind(k.LINEAR,k.CLAMP_TO_EDGE,k.LINEAR_MIPMAP_NEAREST)),l.state="loaded"}}catch(b){if(delete l.abortController,l.aborted)l.state="unloaded";else if(b)throw l.state="errored",b}})}abortTile(l){return a._(this,void 0,void 0,function*(){l.abortController&&(l.abortController.abort(),delete l.abortController)})}unloadTile(l){return a._(this,void 0,void 0,function*(){l.texture&&this.map.painter.saveTileTexture(l.texture)})}hasTransition(){return!1}}class Lt extends Ot{constructor(l,p,b,S){super(l,p,b,S),this.type="raster-dem",this.maxzoom=22,this._options=a.e({type:"raster-dem"},p),this.encoding=p.encoding||"mapbox",this.redFactor=p.redFactor,this.greenFactor=p.greenFactor,this.blueFactor=p.blueFactor,this.baseShift=p.baseShift}loadTile(l){return a._(this,void 0,void 0,function*(){const p=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),b=this.map._requestManager.transformRequest(p,"Tile");l.neighboringTiles=this._getNeighboringTiles(l.tileID),l.abortController=new AbortController;try{const S=yield D.getImage(b,l.abortController,this.map._refreshExpiredTiles);if(delete l.abortController,l.aborted)return void(l.state="unloaded");if(S&&S.data){const k=S.data;this.map._refreshExpiredTiles&&(S.cacheControl||S.expires)&&l.setExpiryData({cacheControl:S.cacheControl,expires:S.expires});const R=a.b(k)&&a.W()?k:yield this.readImageNow(k),W={type:this.type,uid:l.uid,source:this.id,rawImageData:R,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!l.actor||l.state==="expired"){l.actor=this.dispatcher.getActor();const Z=yield l.actor.sendAsync({type:"LDT",data:W});l.dem=Z,l.needsHillshadePrepare=!0,l.needsTerrainPrepare=!0,l.state="loaded"}}}catch(S){if(delete l.abortController,l.aborted)l.state="unloaded";else if(S)throw l.state="errored",S}})}readImageNow(l){return a._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&a.X()){const p=l.width+2,b=l.height+2;try{return new a.R({width:p,height:b},yield a.Y(l,-1,-1,p,b))}catch{}}return _.getImageData(l,1)})}_getNeighboringTiles(l){const p=l.canonical,b=Math.pow(2,p.z),S=(p.x-1+b)%b,k=p.x===0?l.wrap-1:l.wrap,R=(p.x+1+b)%b,W=p.x+1===b?l.wrap+1:l.wrap,Z={};return Z[new a.Z(l.overscaledZ,k,p.z,S,p.y).key]={backfilled:!1},Z[new a.Z(l.overscaledZ,W,p.z,R,p.y).key]={backfilled:!1},p.y>0&&(Z[new a.Z(l.overscaledZ,k,p.z,S,p.y-1).key]={backfilled:!1},Z[new a.Z(l.overscaledZ,l.wrap,p.z,p.x,p.y-1).key]={backfilled:!1},Z[new a.Z(l.overscaledZ,W,p.z,R,p.y-1).key]={backfilled:!1}),p.y+1<b&&(Z[new a.Z(l.overscaledZ,k,p.z,S,p.y+1).key]={backfilled:!1},Z[new a.Z(l.overscaledZ,l.wrap,p.z,p.x,p.y+1).key]={backfilled:!1},Z[new a.Z(l.overscaledZ,W,p.z,R,p.y+1).key]={backfilled:!1}),Z}unloadTile(l){return a._(this,void 0,void 0,function*(){l.demTexture&&this.map.painter.saveTileTexture(l.demTexture),l.fbo&&(l.fbo.destroy(),delete l.fbo),l.dem&&delete l.dem,delete l.neighboringTiles,l.state="unloaded",l.actor&&(yield l.actor.sendAsync({type:"RDT",data:{type:this.type,uid:l.uid,source:this.id}}))})}}class kt extends a.E{constructor(l,p,b,S){super(),this.id=l,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:p.data},this.actor=b.getActor(),this.setEventedParent(S),this._data=p.data,this._options=a.e({},p),this._collectResourceTiming=p.collectResourceTiming,p.maxzoom!==void 0&&(this.maxzoom=p.maxzoom),p.type&&(this.type=p.type),p.attribution&&(this.attribution=p.attribution),this.promoteId=p.promoteId,p.clusterMaxZoom!==void 0&&this.maxzoom<=p.clusterMaxZoom&&a.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${p.clusterMaxZoom}".`),this.workerOptions=a.e({source:this.id,cluster:p.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(p.buffer!==void 0?p.buffer:128),tolerance:this._pixelsToTileUnits(p.tolerance!==void 0?p.tolerance:.375),extent:a.$,maxZoom:this.maxzoom,lineMetrics:p.lineMetrics||!1,generateId:p.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(p.clusterMaxZoom),minPoints:Math.max(2,p.clusterMinPoints||2),extent:a.$,radius:this._pixelsToTileUnits(p.clusterRadius||50),log:!1,generateId:p.generateId||!1},clusterProperties:p.clusterProperties,filter:p.filter},p.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(l){return l*(a.$/this.tileSize)}_getClusterMaxZoom(l){const p=l?Math.round(l):this.maxzoom-1;return Number.isInteger(l)||l===void 0||a.w(`Integer expected for option 'clusterMaxZoom': provided value "${l}" rounded to "${p}"`),p}load(){return a._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(l){this.map=l,this.load()}setData(l){return this._data=l,this._pendingWorkerUpdate={data:l},this._updateWorkerData(),this}updateData(l){return this._pendingWorkerUpdate.diff=a.a0(this._pendingWorkerUpdate.diff,l),this._updateWorkerData(),this}getData(){return a._(this,void 0,void 0,function*(){const l=a.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:l})})}getCoordinatesFromGeometry(l){return l.type==="GeometryCollection"?l.geometries.map(p=>p.coordinates).flat(1/0):l.coordinates.flat(1/0)}getBounds(){return a._(this,void 0,void 0,function*(){const l=new ke,p=yield this.getData();let b;switch(p.type){case"FeatureCollection":b=p.features.map(S=>this.getCoordinatesFromGeometry(S.geometry)).flat(1/0);break;case"Feature":b=this.getCoordinatesFromGeometry(p.geometry);break;default:b=this.getCoordinatesFromGeometry(p)}if(b.length==0)return l;for(let S=0;S<b.length-1;S+=2)l.extend([b[S],b[S+1]]);return l})}setClusterOptions(l){return this.workerOptions.cluster=l.cluster,l&&(l.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(l.clusterRadius)),l.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(l.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(l){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:l,source:this.id}})}getClusterChildren(l){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:l,source:this.id}})}getClusterLeaves(l,p,b){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:l,limit:p,offset:b}})}_updateWorkerData(){return a._(this,void 0,void 0,function*(){if(this._isUpdatingWorker)return;const{data:l,diff:p}=this._pendingWorkerUpdate;if(!l&&!p)return void a.w(`No data or diff provided to GeoJSONSource ${this.id}.`);const b=a.e({type:this.type},this.workerOptions);l?(typeof l=="string"?(b.request=this.map._requestManager.transformRequest(_.resolveURL(l),"Source"),b.request.collectResourceTiming=this._collectResourceTiming):b.data=JSON.stringify(l),this._pendingWorkerUpdate.data=void 0):p&&(b.dataDiff=p,this._pendingWorkerUpdate.diff=void 0),this._isUpdatingWorker=!0,this.fire(new a.l("dataloading",{dataType:"source"}));try{const S=yield this.actor.sendAsync({type:"LD",data:b});if(this._isUpdatingWorker=!1,this._removed||S.abandoned)return void this.fire(new a.l("dataabort",{dataType:"source"}));this._data=S.data;let k=null;S.resourceTiming&&S.resourceTiming[this.id]&&(k=S.resourceTiming[this.id].slice(0));const R={dataType:"source"};this._collectResourceTiming&&k&&k.length>0&&a.e(R,{resourceTiming:k}),this.fire(new a.l("data",Object.assign(Object.assign({},R),{sourceDataType:"metadata"}))),this.fire(new a.l("data",Object.assign(Object.assign({},R),{sourceDataType:"content"})))}catch(S){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new a.l("dataabort",{dataType:"source"}));this.fire(new a.k(S))}finally{(this._pendingWorkerUpdate.data||this._pendingWorkerUpdate.diff)&&this._updateWorkerData()}})}loaded(){return!this._isUpdatingWorker&&this._pendingWorkerUpdate.data===void 0&&this._pendingWorkerUpdate.diff===void 0}loadTile(l){return a._(this,void 0,void 0,function*(){const p=l.actor?"RT":"LT";l.actor=this.actor;const b={type:this.type,uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};l.abortController=new AbortController;const S=yield this.actor.sendAsync({type:p,data:b},l.abortController);delete l.abortController,l.unloadVectorData(),l.aborted||l.loadVectorData(S,this.map.painter,p==="RT")})}abortTile(l){return a._(this,void 0,void 0,function*(){l.abortController&&(l.abortController.abort(),delete l.abortController),l.aborted=!0})}unloadTile(l){return a._(this,void 0,void 0,function*(){l.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:l.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return a.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class mt extends a.E{constructor(l,p,b,S){super(),this.flippedWindingOrder=!1,this.id=l,this.dispatcher=b,this.coordinates=p.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(S),this.options=p}load(l){return a._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new a.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const p=yield D.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,p&&p.data&&(this.image=p.data,l&&(this.coordinates=l),this._finishLoading())}catch(p){this._request=null,this._loaded=!0,this.fire(new a.k(p))}})}loaded(){return this._loaded}updateImage(l){return l.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=l.url,this.load(l.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(l){this.map=l,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(l){this.coordinates=l;const p=l.map(a.a1.fromLngLat);var b;return this.tileID=function(S){const k=a.a2.fromPoints(S),R=k.width(),W=k.height(),Z=Math.max(R,W),ie=Math.max(0,Math.floor(-Math.log(Z)/Math.LN2)),ce=Math.pow(2,ie);return new a.a4(ie,Math.floor((k.minX+k.maxX)/2*ce),Math.floor((k.minY+k.maxY)/2*ce))}(p),this.terrainTileRanges=this._getOverlappingTileRanges(p),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=p.map(S=>this.tileID.getTilePoint(S)._round()),this.flippedWindingOrder=((b=this.tileCoords)[1].x-b[0].x)*(b[2].y-b[0].y)-(b[1].y-b[0].y)*(b[2].x-b[0].x)<0,this.fire(new a.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const l=this.map.painter.context,p=l.gl;this.texture||(this.texture=new a.T(l,this.image,p.RGBA),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE));let b=!1;for(const S in this.tiles){const k=this.tiles[S];k.state!=="loaded"&&(k.state="loaded",k.texture=this.texture,b=!0)}b&&this.fire(new a.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(l){return a._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(l.tileID.canonical)?(this.tiles[String(l.tileID.wrap)]=l,l.buckets={}):l.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(l){const{minX:p,minY:b,maxX:S,maxY:k}=a.a2.fromPoints(l),R={};for(let W=0;W<=a.a3;W++){const Z=Math.pow(2,W),ie=Math.floor(p*Z),ce=Math.floor(b*Z),xe=Math.floor(S*Z),be=Math.floor(k*Z);R[W]={minTileX:ie,minTileY:ce,maxTileX:xe,maxTileY:be}}return R}}class Zt extends mt{constructor(l,p,b,S){super(l,p,b,S),this.roundZoom=!0,this.type="video",this.options=p}load(){return a._(this,void 0,void 0,function*(){this._loaded=!1;const l=this.options;this.urls=[];for(const p of l.urls)this.urls.push(this.map._requestManager.transformRequest(p,"Source").url);try{const p=yield a.a5(this.urls);if(this._loaded=!0,!p)return;this.video=p,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(p){this.fire(new a.k(p))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(l){if(this.video){const p=this.video.seekable;l<p.start(0)||l>p.end(0)?this.fire(new a.k(new a.a6(`sources.${this.id}`,null,`Playback for this video can be set only between the ${p.start(0)} and ${p.end(0)}-second mark.`))):this.video.currentTime=l}}getVideo(){return this.video}onAdd(l){this.map||(this.map=l,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const l=this.map.painter.context,p=l.gl;this.texture?this.video.paused||(this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE),p.texSubImage2D(p.TEXTURE_2D,0,0,0,p.RGBA,p.UNSIGNED_BYTE,this.video)):(this.texture=new a.T(l,this.video,p.RGBA),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE));let b=!1;for(const S in this.tiles){const k=this.tiles[S];k.state!=="loaded"&&(k.state="loaded",k.texture=this.texture,b=!0)}b&&this.fire(new a.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Kt extends mt{constructor(l,p,b,S){super(l,p,b,S),p.coordinates?Array.isArray(p.coordinates)&&p.coordinates.length===4&&!p.coordinates.some(k=>!Array.isArray(k)||k.length!==2||k.some(R=>typeof R!="number"))||this.fire(new a.k(new a.a6(`sources.${l}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.k(new a.a6(`sources.${l}`,null,'missing required property "coordinates"'))),p.animate&&typeof p.animate!="boolean"&&this.fire(new a.k(new a.a6(`sources.${l}`,null,'optional "animate" property must be a boolean value'))),p.canvas?typeof p.canvas=="string"||p.canvas instanceof HTMLCanvasElement||this.fire(new a.k(new a.a6(`sources.${l}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.k(new a.a6(`sources.${l}`,null,'missing required property "canvas"'))),this.options=p,this.animate=p.animate===void 0||p.animate}load(){return a._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(l){this.map=l,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let l=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,l=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,l=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const p=this.map.painter.context,b=p.gl;this.texture?(l||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.T(p,this.canvas,b.RGBA,{premultiply:!0});let S=!1;for(const k in this.tiles){const R=this.tiles[k];R.state!=="loaded"&&(R.state="loaded",R.texture=this.texture,S=!0)}S&&this.fire(new a.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const l of[this.canvas.width,this.canvas.height])if(isNaN(l)||l<=0)return!0;return!1}}const dr={},Bt=A=>{switch(A){case"geojson":return kt;case"image":return mt;case"raster":return Ot;case"raster-dem":return Lt;case"vector":return Ne;case"video":return Zt;case"canvas":return Kt}return dr[A]},wr="RTLPluginLoaded";class mr extends a.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Ge()}_syncState(l){return this.status=l,this.dispatcher.broadcast("SRPS",{pluginStatus:l,pluginURL:this.url}).catch(p=>{throw this.status="error",p})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(l){return a._(this,arguments,void 0,function*(p,b=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=_.resolveURL(p),!this.url)throw new Error(`requested url ${p} is invalid`);if(this.status==="unavailable"){if(!b)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return a._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new a.l(wr))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let hr=null;function xr(){return hr||(hr=new mr),hr}class or{constructor(l,p){this.timeAdded=0,this.fadeEndTime=0,this.tileID=l,this.uid=a.a7(),this.uses=0,this.tileSize=p,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(l){const p=l+this.timeAdded;p<this.fadeEndTime||(this.fadeEndTime=p)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(l){this.demTexture&&l.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(l,p,b){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",l){l.featureIndex&&(this.latestFeatureIndex=l.featureIndex,l.rawTileData?(this.latestRawTileData=l.rawTileData,this.latestFeatureIndex.rawTileData=l.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=l.collisionBoxArray,this.buckets=function(S,k){const R={};if(!k)return R;for(const W of S){const Z=W.layerIds.map(ie=>k.getLayer(ie)).filter(Boolean);if(Z.length!==0){W.layers=Z,W.stateDependentLayerIds&&(W.stateDependentLayers=W.stateDependentLayerIds.map(ie=>Z.filter(ce=>ce.id===ie)[0]));for(const ie of Z)R[ie.id]=W}}return R}(l.buckets,p==null?void 0:p.style),this.hasSymbolBuckets=!1;for(const S in this.buckets){const k=this.buckets[S];if(k instanceof a.a9){if(this.hasSymbolBuckets=!0,!b)break;k.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const S in this.buckets){const k=this.buckets[S];if(k instanceof a.a9&&k.hasRTLText){this.hasRTLText=!0,xr().lazyLoad();break}}this.queryPadding=0;for(const S in this.buckets){const k=this.buckets[S];this.queryPadding=Math.max(this.queryPadding,p.style.getLayer(S).queryRadius(k))}l.imageAtlas&&(this.imageAtlas=l.imageAtlas),l.glyphAtlasImage&&(this.glyphAtlasImage=l.glyphAtlasImage)}else this.collisionBoxArray=new a.a8}unloadVectorData(){for(const l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(l){return this.buckets[l.id]}upload(l){for(const b in this.buckets){const S=this.buckets[b];S.uploadPending()&&S.upload(l)}const p=l.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new a.T(l,this.imageAtlas.image,p.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new a.T(l,this.glyphAtlasImage,p.ALPHA),this.glyphAtlasImage=null)}prepare(l){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(l,this.imageAtlasTexture)}queryRenderedFeatures(l,p,b,S,k,R,W,Z,ie,ce,xe){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:S,cameraQueryGeometry:k,scale:R,tileSize:this.tileSize,pixelPosMatrix:ce,transform:Z,params:W,queryPadding:this.queryPadding*ie,getElevation:xe},l,p,b):{}}querySourceFeatures(l,p){const b=this.latestFeatureIndex;if(!b||!b.rawTileData)return;const S=b.loadVTLayers(),k=p&&p.sourceLayer?p.sourceLayer:"",R=S._geojsonTileLayer||S[k];if(!R)return;const W=a.aa(p&&p.filter),{z:Z,x:ie,y:ce}=this.tileID.canonical,xe={z:Z,x:ie,y:ce};for(let be=0;be<R.length;be++){const Ae=R.feature(be);if(W.needGeometry){const it=a.ab(Ae,!0);if(!W.filter(new a.F(this.tileID.overscaledZ),it,this.tileID.canonical))continue}else if(!W.filter(new a.F(this.tileID.overscaledZ),Ae))continue;const Ue=b.getId(Ae,k),lt=new a.ac(Ae,Z,ie,ce,Ue);lt.tile=xe,l.push(lt)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(l){const p=this.expirationTime;if(l.cacheControl){const b=a.ad(l.cacheControl);b["max-age"]&&(this.expirationTime=Date.now()+1e3*b["max-age"])}else l.expires&&(this.expirationTime=new Date(l.expires).getTime());if(this.expirationTime){const b=Date.now();let S=!1;if(this.expirationTime>b)S=!1;else if(p)if(this.expirationTime<p)S=!0;else{const k=this.expirationTime-p;k?this.expirationTime=b+Math.max(k,3e4):S=!0}else S=!0;S?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(l,p){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(l).length===0)return;const b=this.latestFeatureIndex.loadVTLayers();for(const S in this.buckets){if(!p.style.hasLayer(S))continue;const k=this.buckets[S],R=k.layers[0].sourceLayer||"_geojsonTileLayer",W=b[R],Z=l[R];if(!W||!Z||Object.keys(Z).length===0)continue;k.update(Z,W,this.imageAtlas&&this.imageAtlas.patternPositions||{});const ie=p&&p.style&&p.style.getLayer(S);ie&&(this.queryPadding=Math.max(this.queryPadding,ie.queryRadius(k)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<_.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(l){this.symbolFadeHoldUntil=_.now()+l}setDependencies(l,p){const b={};for(const S of p)b[S]=!0;this.dependencies[l]=b}hasDependency(l,p){for(const b of l){const S=this.dependencies[b];if(S){for(const k of p)if(S[k])return!0}}return!1}}class tt{constructor(l,p){this.max=l,this.onRemove=p,this.reset()}reset(){for(const l in this.data)for(const p of this.data[l])p.timeout&&clearTimeout(p.timeout),this.onRemove(p.value);return this.data={},this.order=[],this}add(l,p,b){const S=l.wrapped().key;this.data[S]===void 0&&(this.data[S]=[]);const k={value:p,timeout:void 0};if(b!==void 0&&(k.timeout=setTimeout(()=>{this.remove(l,k)},b)),this.data[S].push(k),this.order.push(S),this.order.length>this.max){const R=this._getAndRemoveByKey(this.order[0]);R&&this.onRemove(R)}return this}has(l){return l.wrapped().key in this.data}getAndRemove(l){return this.has(l)?this._getAndRemoveByKey(l.wrapped().key):null}_getAndRemoveByKey(l){const p=this.data[l].shift();return p.timeout&&clearTimeout(p.timeout),this.data[l].length===0&&delete this.data[l],this.order.splice(this.order.indexOf(l),1),p.value}getByKey(l){const p=this.data[l];return p?p[0].value:null}get(l){return this.has(l)?this.data[l.wrapped().key][0].value:null}remove(l,p){if(!this.has(l))return this;const b=l.wrapped().key,S=p===void 0?0:this.data[b].indexOf(p),k=this.data[b][S];return this.data[b].splice(S,1),k.timeout&&clearTimeout(k.timeout),this.data[b].length===0&&delete this.data[b],this.onRemove(k.value),this.order.splice(this.order.indexOf(b),1),this}setMaxSize(l){for(this.max=l;this.order.length>this.max;){const p=this._getAndRemoveByKey(this.order[0]);p&&this.onRemove(p)}return this}filter(l){const p=[];for(const b in this.data)for(const S of this.data[b])l(S.value)||p.push(S);for(const b of p)this.remove(b.value.tileID,b)}}class Se{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(l,p,b){const S=String(p);if(this.stateChanges[l]=this.stateChanges[l]||{},this.stateChanges[l][S]=this.stateChanges[l][S]||{},a.e(this.stateChanges[l][S],b),this.deletedStates[l]===null){this.deletedStates[l]={};for(const k in this.state[l])k!==S&&(this.deletedStates[l][k]=null)}else if(this.deletedStates[l]&&this.deletedStates[l][S]===null){this.deletedStates[l][S]={};for(const k in this.state[l][S])b[k]||(this.deletedStates[l][S][k]=null)}else for(const k in b)this.deletedStates[l]&&this.deletedStates[l][S]&&this.deletedStates[l][S][k]===null&&delete this.deletedStates[l][S][k]}removeFeatureState(l,p,b){if(this.deletedStates[l]===null)return;const S=String(p);if(this.deletedStates[l]=this.deletedStates[l]||{},b&&p!==void 0)this.deletedStates[l][S]!==null&&(this.deletedStates[l][S]=this.deletedStates[l][S]||{},this.deletedStates[l][S][b]=null);else if(p!==void 0)if(this.stateChanges[l]&&this.stateChanges[l][S])for(b in this.deletedStates[l][S]={},this.stateChanges[l][S])this.deletedStates[l][S][b]=null;else this.deletedStates[l][S]=null;else this.deletedStates[l]=null}getState(l,p){const b=String(p),S=a.e({},(this.state[l]||{})[b],(this.stateChanges[l]||{})[b]);if(this.deletedStates[l]===null)return{};if(this.deletedStates[l]){const k=this.deletedStates[l][p];if(k===null)return{};for(const R in k)delete S[R]}return S}initializeTileState(l,p){l.setFeatureState(this.state,p)}coalesceChanges(l,p){const b={};for(const S in this.stateChanges){this.state[S]=this.state[S]||{};const k={};for(const R in this.stateChanges[S])this.state[S][R]||(this.state[S][R]={}),a.e(this.state[S][R],this.stateChanges[S][R]),k[R]=this.state[S][R];b[S]=k}for(const S in this.deletedStates){this.state[S]=this.state[S]||{};const k={};if(this.deletedStates[S]===null)for(const R in this.state[S])k[R]={},this.state[S][R]={};else for(const R in this.deletedStates[S]){if(this.deletedStates[S][R]===null)this.state[S][R]={};else for(const W of Object.keys(this.deletedStates[S][R]))delete this.state[S][R][W];k[R]=this.state[S][R]}b[S]=b[S]||{},a.e(b[S],k)}if(this.stateChanges={},this.deletedStates={},Object.keys(b).length!==0)for(const S in l)l[S].setFeatureState(b,p)}}const Pe=89.25;function Ve(A,l){const p=a.ah(l.lat,-a.ai,a.ai);return new a.P(a.V(l.lng)*A,a.U(p)*A)}function Qe(A,l){return new a.a1(l.x/A,l.y/A).toLngLat()}function dt(A){return A.cameraToCenterDistance*Math.min(.85*Math.tan(a.ae(90-A.pitch)),Math.tan(a.ae(Pe-A.pitch)))}function Pt(A,l){const p=A.canonical,b=l/a.af(p.z),S=p.x+Math.pow(2,p.z)*A.wrap,k=a.ag(new Float64Array(16));return a.M(k,k,[S*b,p.y*b,0]),a.N(k,k,[b/a.$,b/a.$,1]),k}function Vt(A,l,p,b,S){const k=a.a1.fromLngLat(A,l),R=S*a.aj(1,A.lat),W=R*Math.cos(a.ae(p)),Z=Math.sqrt(R*R-W*W),ie=Z*Math.sin(a.ae(-b)),ce=Z*Math.cos(a.ae(-b));return new a.a1(k.x+ie,k.y+ce,k.z+W)}function At(A,l,p){const b=l.intersectsFrustum(A);if(!p||b===0)return b;const S=l.intersectsPlane(p);return S===0?0:b===2&&S===2?2:1}function qt(A,l,p){let b=0;const S=(p-l)/10;for(let k=0;k<10;k++)b+=S*Math.pow(Math.cos(l+(k+.5)/10*(p-l)),A);return b}function er(A,l){return function(p,b,S,k,R){const W=2*((A-1)/a.ak(Math.cos(a.ae(Pe-R))/Math.cos(a.ae(Pe)))-1),Z=Math.acos(S/k),ie=2*qt(W-1,0,a.ae(R/2)),ce=Math.min(a.ae(Pe),Z+a.ae(R/2)),xe=qt(W-1,Math.min(ce,Z-a.ae(R/2)),ce),be=Math.atan(b/S),Ae=Math.hypot(b,S);let Ue=p;return Ue+=a.ak(k/Ae/Math.max(.5,Math.cos(a.ae(R/2)))),Ue+=W*a.ak(Math.cos(be))/2,Ue-=a.ak(Math.max(1,xe/ie/l))/2,Ue}}const fr=er(9.314,3);function Jr(A,l){const p=(l.roundZoom?Math.round:Math.floor)(A.zoom+a.ak(A.tileSize/l.tileSize));return Math.max(0,p)}function $t(A,l){const p=A.getCameraFrustum(),b=A.getClippingPlane(),S=A.screenPointToMercatorCoordinate(A.getCameraPoint()),k=a.a1.fromLngLat(A.center,A.elevation);S.z=k.z+Math.cos(A.pitchInRadians)*A.cameraToCenterDistance/A.worldSize;const R=A.getCoveringTilesDetailsProvider(),W=R.allowVariableZoom(A,l),Z=Jr(A,l),ie=l.minzoom||0,ce=l.maxzoom!==void 0?l.maxzoom:A.maxZoom,xe=Math.min(Math.max(0,Z),ce),be=Math.pow(2,xe),Ae=[be*S.x,be*S.y,0],Ue=[be*k.x,be*k.y,0],lt=Math.hypot(k.x-S.x,k.y-S.y),it=Math.abs(k.z-S.z),ft=Math.hypot(lt,it),gt=It=>({zoom:0,x:0,y:0,wrap:It,fullyVisible:!1}),Et=[],Mt=[];if(A.renderWorldCopies&&R.allowWorldCopies())for(let It=1;It<=3;It++)Et.push(gt(-It)),Et.push(gt(It));for(Et.push(gt(0));Et.length>0;){const It=Et.pop(),jt=It.x,St=It.y;let Wt=It.fullyVisible;const ur={x:jt,y:St,z:It.zoom},Jt=R.getTileBoundingVolume(ur,It.wrap,A.elevation,l);if(!Wt){const Yr=At(p,Jt,b);if(Yr===0)continue;Wt=Yr===2}const nr=R.distanceToTile2d(S.x,S.y,ur,Jt);let cr=Z;W&&(cr=(l.calculateTileZoom||fr)(A.zoom+a.ak(A.tileSize/l.tileSize),nr,it,ft,A.fov)),cr=(l.roundZoom?Math.round:Math.floor)(cr),cr=Math.max(0,cr);const Gr=Math.min(cr,ce);if(It.wrap=R.getWrap(k,ur,It.wrap),It.zoom>=Gr){if(It.zoom<ie)continue;const Yr=xe-It.zoom,$r=Ae[0]-.5-(jt<<Yr),Tn=Ae[1]-.5-(St<<Yr),mi=l.reparseOverscaled?Math.max(It.zoom,cr):It.zoom;Mt.push({tileID:new a.Z(It.zoom===ce?mi:It.zoom,It.wrap,It.zoom,jt,St),distanceSq:a.al([Ue[0]-.5-jt,Ue[1]-.5-St]),tileDistanceToCamera:Math.sqrt($r*$r+Tn*Tn)})}else for(let Yr=0;Yr<4;Yr++)Et.push({zoom:It.zoom+1,x:(jt<<1)+Yr%2,y:(St<<1)+(Yr>>1),wrap:It.wrap,fullyVisible:Wt})}return Mt.sort((It,jt)=>It.distanceSq-jt.distanceSq).map(It=>It.tileID)}const zr=a.a2.fromPoints([new a.P(0,0),new a.P(a.$,a.$)]);class Sr extends a.E{constructor(l,p,b){super(),this.id=l,this.dispatcher=b,this.on("data",S=>this._dataHandler(S)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((S,k,R,W)=>{const Z=new(Bt(k.type))(S,k,R,W);if(Z.id!==S)throw new Error(`Expected Source id to be ${S} instead of ${Z.id}`);return Z})(l,p,b,this),this._tiles={},this._cache=new tt(0,S=>this._unloadTile(S)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Se,this._didEmitContent=!1,this._updated=!1}onAdd(l){this.map=l,this._maxTileCacheSize=l?l._maxTileCacheSize:null,this._maxTileCacheZoomLevels=l?l._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(l)}onRemove(l){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(l)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const l in this._tiles){const p=this._tiles[l];if(p.state!=="loaded"&&p.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const l=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,l&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(l,p,b){return a._(this,void 0,void 0,function*(){try{yield this._source.loadTile(l),this._tileLoaded(l,p,b)}catch(S){l.state="errored",S.status!==404?this._source.fire(new a.k(S,{tile:l})):this.update(this.transform,this.terrain)}})}_unloadTile(l){this._source.unloadTile&&this._source.unloadTile(l)}_abortTile(l){this._source.abortTile&&this._source.abortTile(l),this._source.fire(new a.l("dataabort",{tile:l,coord:l.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(l){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const p in this._tiles){const b=this._tiles[p];b.upload(l),b.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(l=>l.tileID).sort(Ir).map(l=>l.key)}getRenderableIds(l){const p=[];for(const b in this._tiles)this._isIdRenderable(b,l)&&p.push(this._tiles[b]);return l?p.sort((b,S)=>{const k=b.tileID,R=S.tileID,W=new a.P(k.canonical.x,k.canonical.y)._rotate(-this.transform.bearingInRadians),Z=new a.P(R.canonical.x,R.canonical.y)._rotate(-this.transform.bearingInRadians);return k.overscaledZ-R.overscaledZ||Z.y-W.y||Z.x-W.x}).map(b=>b.tileID.key):p.map(b=>b.tileID).sort(Ir).map(b=>b.key)}hasRenderableParent(l){const p=this.findLoadedParent(l,0);return!!p&&this._isIdRenderable(p.tileID.key)}_isIdRenderable(l,p){return this._tiles[l]&&this._tiles[l].hasData()&&!this._coveredTiles[l]&&(p||!this._tiles[l].holdingForFade())}reload(l){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const p in this._tiles)l?this._reloadTile(p,"expired"):this._tiles[p].state!=="errored"&&this._reloadTile(p,"reloading")}}_reloadTile(l,p){return a._(this,void 0,void 0,function*(){const b=this._tiles[l];b&&(b.state!=="loading"&&(b.state=p),yield this._loadTile(b,l,p))})}_tileLoaded(l,p,b){l.timeAdded=_.now(),b==="expired"&&(l.refreshedUponExpiration=!0),this._setTileReloadTimer(p,l),this.getSource().type==="raster-dem"&&l.dem&&this._backfillDEM(l),this._state.initializeTileState(l,this.map?this.map.painter:null),l.aborted||this._source.fire(new a.l("data",{dataType:"source",tile:l,coord:l.tileID}))}_backfillDEM(l){const p=this.getRenderableIds();for(let S=0;S<p.length;S++){const k=p[S];if(l.neighboringTiles&&l.neighboringTiles[k]){const R=this.getTileByID(k);b(l,R),b(R,l)}}function b(S,k){S.needsHillshadePrepare=!0,S.needsTerrainPrepare=!0;let R=k.tileID.canonical.x-S.tileID.canonical.x;const W=k.tileID.canonical.y-S.tileID.canonical.y,Z=Math.pow(2,S.tileID.canonical.z),ie=k.tileID.key;R===0&&W===0||Math.abs(W)>1||(Math.abs(R)>1&&(Math.abs(R+Z)===1?R+=Z:Math.abs(R-Z)===1&&(R-=Z)),k.dem&&S.dem&&(S.dem.backfillBorder(k.dem,R,W),S.neighboringTiles&&S.neighboringTiles[ie]&&(S.neighboringTiles[ie].backfilled=!0)))}}getTile(l){return this.getTileByID(l.key)}getTileByID(l){return this._tiles[l]}_retainLoadedChildren(l,p,b,S){for(const k in this._tiles){let R=this._tiles[k];if(S[k]||!R.hasData()||R.tileID.overscaledZ<=p||R.tileID.overscaledZ>b)continue;let W=R.tileID;for(;R&&R.tileID.overscaledZ>p+1;){const ie=R.tileID.scaledTo(R.tileID.overscaledZ-1);R=this._tiles[ie.key],R&&R.hasData()&&(W=ie)}let Z=W;for(;Z.overscaledZ>p;)if(Z=Z.scaledTo(Z.overscaledZ-1),l[Z.key]||l[Z.canonical.key]){S[W.key]=W;break}}}findLoadedParent(l,p){if(l.key in this._loadedParentTiles){const b=this._loadedParentTiles[l.key];return b&&b.tileID.overscaledZ>=p?b:null}for(let b=l.overscaledZ-1;b>=p;b--){const S=l.scaledTo(b),k=this._getLoadedTile(S);if(k)return k}}findLoadedSibling(l){return this._getLoadedTile(l)}_getLoadedTile(l){const p=this._tiles[l.key];return p&&p.hasData()?p:this._cache.getByKey(l.wrapped().key)}updateCacheSize(l){const p=Math.ceil(l.width/this._source.tileSize)+1,b=Math.ceil(l.height/this._source.tileSize)+1,S=Math.floor(p*b*(this._maxTileCacheZoomLevels===null?a.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),k=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,S):S;this._cache.setMaxSize(k)}handleWrapJump(l){const p=Math.round((l-(this._prevLng===void 0?l:this._prevLng))/360);if(this._prevLng=l,p){const b={};for(const S in this._tiles){const k=this._tiles[S];k.tileID=k.tileID.unwrapTo(k.tileID.wrap+p),b[k.tileID.key]=k}this._tiles=b;for(const S in this._timers)clearTimeout(this._timers[S]),delete this._timers[S];for(const S in this._tiles)this._setTileReloadTimer(S,this._tiles[S])}}_updateCoveredAndRetainedTiles(l,p,b,S,k,R){const W={},Z={},ie=Object.keys(l),ce=_.now();for(const xe of ie){const be=l[xe],Ae=this._tiles[xe];if(!Ae||Ae.fadeEndTime!==0&&Ae.fadeEndTime<=ce)continue;const Ue=this.findLoadedParent(be,p),lt=this.findLoadedSibling(be),it=Ue||lt||null;it&&(this._addTile(it.tileID),W[it.tileID.key]=it.tileID),Z[xe]=be}this._retainLoadedChildren(Z,S,b,l);for(const xe in W)l[xe]||(this._coveredTiles[xe]=!0,l[xe]=W[xe]);if(R){const xe={},be={};for(const Ae of k)this._tiles[Ae.key].hasData()?xe[Ae.key]=Ae:be[Ae.key]=Ae;for(const Ae in be){const Ue=be[Ae].children(this._source.maxzoom);this._tiles[Ue[0].key]&&this._tiles[Ue[1].key]&&this._tiles[Ue[2].key]&&this._tiles[Ue[3].key]&&(xe[Ue[0].key]=l[Ue[0].key]=Ue[0],xe[Ue[1].key]=l[Ue[1].key]=Ue[1],xe[Ue[2].key]=l[Ue[2].key]=Ue[2],xe[Ue[3].key]=l[Ue[3].key]=Ue[3],delete be[Ae])}for(const Ae in be){const Ue=be[Ae],lt=this.findLoadedParent(Ue,this._source.minzoom),it=this.findLoadedSibling(Ue),ft=lt||it||null;if(ft){xe[ft.tileID.key]=l[ft.tileID.key]=ft.tileID;for(const gt in xe)xe[gt].isChildOf(ft.tileID)&&delete xe[gt]}}for(const Ae in this._tiles)xe[Ae]||(this._coveredTiles[Ae]=!0)}}update(l,p){if(!this._sourceLoaded||this._paused)return;let b;this.transform=l,this.terrain=p,this.updateCacheSize(l),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?b=l.getVisibleUnwrappedCoordinates(this._source.tileID).map(ce=>new a.Z(ce.canonical.z,ce.wrap,ce.canonical.z,ce.canonical.x,ce.canonical.y)):(b=$t(l,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:p,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(b=b.filter(ce=>this._source.hasTile(ce)))):b=[];const S=Jr(l,this._source),k=Math.max(S-Sr.maxOverzooming,this._source.minzoom),R=Math.max(S+Sr.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const ce={};for(const xe of b)if(xe.canonical.z>this._source.minzoom){const be=xe.scaledTo(xe.canonical.z-1);ce[be.key]=be;const Ae=xe.scaledTo(Math.max(this._source.minzoom,Math.min(xe.canonical.z,5)));ce[Ae.key]=Ae}b=b.concat(Object.values(ce))}const W=b.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,W&&this.fire(new a.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const Z=this._updateRetainedTiles(b,S);Xr(this._source.type)&&this._updateCoveredAndRetainedTiles(Z,k,R,S,b,p);for(const ce in Z)this._tiles[ce].clearFadeHold();const ie=a.am(this._tiles,Z);for(const ce of ie){const xe=this._tiles[ce];xe.hasSymbolBuckets&&!xe.holdingForFade()?xe.setHoldDuration(this.map._fadeDuration):xe.hasSymbolBuckets&&!xe.symbolFadeFinished()||this._removeTile(ce)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const l in this._tiles)this._tiles[l].holdingForFade()&&this._removeTile(l)}_updateRetainedTiles(l,p){var b;const S={},k={},R=Math.max(p-Sr.maxOverzooming,this._source.minzoom),W=Math.max(p+Sr.maxUnderzooming,this._source.minzoom),Z={};for(const ie of l){const ce=this._addTile(ie);S[ie.key]=ie,ce.hasData()||p<this._source.maxzoom&&(Z[ie.key]=ie)}this._retainLoadedChildren(Z,p,W,S);for(const ie of l){let ce=this._tiles[ie.key];if(ce.hasData())continue;if(p+1>this._source.maxzoom){const be=ie.children(this._source.maxzoom)[0],Ae=this.getTile(be);if(Ae&&Ae.hasData()){S[be.key]=be;continue}}else{const be=ie.children(this._source.maxzoom);if(S[be[0].key]&&S[be[1].key]&&S[be[2].key]&&S[be[3].key])continue}let xe=ce.wasRequested();for(let be=ie.overscaledZ-1;be>=R;--be){const Ae=ie.scaledTo(be);if(k[Ae.key])break;if(k[Ae.key]=!0,ce=this.getTile(Ae),!ce&&xe&&(ce=this._addTile(Ae)),ce){const Ue=ce.hasData();if((Ue||!(!((b=this.map)===null||b===void 0)&&b.cancelPendingTileRequestsWhileZooming)||xe)&&(S[Ae.key]=Ae),xe=ce.wasRequested(),Ue)break}}}return S}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const l in this._tiles){const p=[];let b,S=this._tiles[l].tileID;for(;S.overscaledZ>0;){if(S.key in this._loadedParentTiles){b=this._loadedParentTiles[S.key];break}p.push(S.key);const k=S.scaledTo(S.overscaledZ-1);if(b=this._getLoadedTile(k),b)break;S=k}for(const k of p)this._loadedParentTiles[k]=b}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const l in this._tiles){const p=this._tiles[l].tileID,b=this._getLoadedTile(p);this._loadedSiblingTiles[p.key]=b}}_addTile(l){let p=this._tiles[l.key];if(p)return p;p=this._cache.getAndRemove(l),p&&(this._setTileReloadTimer(l.key,p),p.tileID=l,this._state.initializeTileState(p,this.map?this.map.painter:null),this._cacheTimers[l.key]&&(clearTimeout(this._cacheTimers[l.key]),delete this._cacheTimers[l.key],this._setTileReloadTimer(l.key,p)));const b=p;return p||(p=new or(l,this._source.tileSize*l.overscaleFactor()),this._loadTile(p,l.key,p.state)),p.uses++,this._tiles[l.key]=p,b||this._source.fire(new a.l("dataloading",{tile:p,coord:p.tileID,dataType:"source"})),p}_setTileReloadTimer(l,p){l in this._timers&&(clearTimeout(this._timers[l]),delete this._timers[l]);const b=p.getExpiryTimeout();b&&(this._timers[l]=setTimeout(()=>{this._reloadTile(l,"expired"),delete this._timers[l]},b))}refreshTiles(l){for(const p in this._tiles)(this._isIdRenderable(p)||this._tiles[p].state=="errored")&&l.some(b=>b.equals(this._tiles[p].tileID.canonical))&&this._reloadTile(p,"expired")}_removeTile(l){const p=this._tiles[l];p&&(p.uses--,delete this._tiles[l],this._timers[l]&&(clearTimeout(this._timers[l]),delete this._timers[l]),p.uses>0||(p.hasData()&&p.state!=="reloading"?this._cache.add(p.tileID,p,p.getExpiryTimeout()):(p.aborted=!0,this._abortTile(p),this._unloadTile(p))))}_dataHandler(l){const p=l.sourceDataType;l.dataType==="source"&&p==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&l.dataType==="source"&&p==="content"&&(this.reload(l.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const l in this._tiles)this._removeTile(l);this._cache.reset()}tilesIn(l,p,b){const S=[],k=this.transform;if(!k)return S;const R=k.getCoveringTilesDetailsProvider().allowWorldCopies(),W=b?k.getCameraQueryGeometry(l):l,Z=Ae=>k.screenPointToMercatorCoordinate(Ae,this.terrain),ie=this.transformBbox(l,Z,!R),ce=this.transformBbox(W,Z,!R),xe=this.getIds(),be=a.a2.fromPoints(ce);for(let Ae=0;Ae<xe.length;Ae++){const Ue=this._tiles[xe[Ae]];if(Ue.holdingForFade())continue;const lt=R?[Ue.tileID]:[Ue.tileID.unwrapTo(-1),Ue.tileID.unwrapTo(0)],it=Math.pow(2,k.zoom-Ue.tileID.overscaledZ),ft=p*Ue.queryPadding*a.$/Ue.tileSize/it;for(const gt of lt){const Et=be.map(Mt=>gt.getTilePoint(new a.a1(Mt.x,Mt.y)));if(Et.expandBy(ft),Et.intersects(zr)){const Mt=ie.map(jt=>gt.getTilePoint(jt)),It=ce.map(jt=>gt.getTilePoint(jt));S.push({tile:Ue,tileID:R?gt:gt.unwrapTo(0),queryGeometry:Mt,cameraQueryGeometry:It,scale:it})}}}return S}transformBbox(l,p,b){let S=l.map(p);if(b){const k=a.a2.fromPoints(l);k.shrinkBy(.001*Math.min(k.width(),k.height()));const R=k.map(p);a.a2.fromPoints(S).covers(R)||(S=S.map(W=>W.x>.5?new a.a1(W.x-1,W.y,W.z):W))}return S}getVisibleCoordinates(l){const p=this.getRenderableIds(l).map(b=>this._tiles[b].tileID);return this.transform&&this.transform.populateCache(p),p}hasTransition(){if(this._source.hasTransition())return!0;if(Xr(this._source.type)){const l=_.now();for(const p in this._tiles)if(this._tiles[p].fadeEndTime>=l)return!0}return!1}setFeatureState(l,p,b){this._state.updateState(l=l||"_geojsonTileLayer",p,b)}removeFeatureState(l,p,b){this._state.removeFeatureState(l=l||"_geojsonTileLayer",p,b)}getFeatureState(l,p){return this._state.getState(l=l||"_geojsonTileLayer",p)}setDependencies(l,p,b){const S=this._tiles[l];S&&S.setDependencies(p,b)}reloadTilesForDependencies(l,p){for(const b in this._tiles)this._tiles[b].hasDependency(l,p)&&this._reloadTile(b,"reloading");this._cache.filter(b=>!b.hasDependency(l,p))}}function Ir(A,l){const p=Math.abs(2*A.wrap)-+(A.wrap<0),b=Math.abs(2*l.wrap)-+(l.wrap<0);return A.overscaledZ-l.overscaledZ||b-p||l.canonical.y-A.canonical.y||l.canonical.x-A.canonical.x}function Xr(A){return A==="raster"||A==="image"||A==="video"}Sr.maxOverzooming=10,Sr.maxUnderzooming=3;class qr{constructor(l,p){this.reset(l,p)}reset(l,p){this.points=l||[],this._distances=[0];for(let b=1;b<this.points.length;b++)this._distances[b]=this._distances[b-1]+this.points[b].dist(this.points[b-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(p||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(l){if(this.points.length===1)return this.points[0];l=a.ah(l,0,1);let p=1,b=this._distances[p];const S=l*this.paddedLength+this.padding;for(;b<S&&p<this._distances.length;)b=this._distances[++p];const k=p-1,R=this._distances[k],W=b-R,Z=W>0?(S-R)/W:0;return this.points[k].mult(1-Z).add(this.points[p].mult(Z))}}function An(A,l){let p=!0;return A==="always"||A!=="never"&&l!=="never"||(p=!1),p}class ge{constructor(l,p,b){const S=this.boxCells=[],k=this.circleCells=[];this.xCellCount=Math.ceil(l/b),this.yCellCount=Math.ceil(p/b);for(let R=0;R<this.xCellCount*this.yCellCount;R++)S.push([]),k.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=p,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/p,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(l,p,b,S,k){this._forEachCell(p,b,S,k,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(p),this.bboxes.push(b),this.bboxes.push(S),this.bboxes.push(k)}insertCircle(l,p,b,S){this._forEachCell(p-S,b-S,p+S,b+S,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(p),this.circles.push(b),this.circles.push(S)}_insertBoxCell(l,p,b,S,k,R){this.boxCells[k].push(R)}_insertCircleCell(l,p,b,S,k,R){this.circleCells[k].push(R)}_query(l,p,b,S,k,R,W){if(b<0||l>this.width||S<0||p>this.height)return[];const Z=[];if(l<=0&&p<=0&&this.width<=b&&this.height<=S){if(k)return[{key:null,x1:l,y1:p,x2:b,y2:S}];for(let ie=0;ie<this.boxKeys.length;ie++)Z.push({key:this.boxKeys[ie],x1:this.bboxes[4*ie],y1:this.bboxes[4*ie+1],x2:this.bboxes[4*ie+2],y2:this.bboxes[4*ie+3]});for(let ie=0;ie<this.circleKeys.length;ie++){const ce=this.circles[3*ie],xe=this.circles[3*ie+1],be=this.circles[3*ie+2];Z.push({key:this.circleKeys[ie],x1:ce-be,y1:xe-be,x2:ce+be,y2:xe+be})}}else this._forEachCell(l,p,b,S,this._queryCell,Z,{hitTest:k,overlapMode:R,seenUids:{box:{},circle:{}}},W);return Z}query(l,p,b,S){return this._query(l,p,b,S,!1,null)}hitTest(l,p,b,S,k,R){return this._query(l,p,b,S,!0,k,R).length>0}hitTestCircle(l,p,b,S,k){const R=l-b,W=l+b,Z=p-b,ie=p+b;if(W<0||R>this.width||ie<0||Z>this.height)return!1;const ce=[];return this._forEachCell(R,Z,W,ie,this._queryCellCircle,ce,{hitTest:!0,overlapMode:S,circle:{x:l,y:p,radius:b},seenUids:{box:{},circle:{}}},k),ce.length>0}_queryCell(l,p,b,S,k,R,W,Z){const{seenUids:ie,hitTest:ce,overlapMode:xe}=W,be=this.boxCells[k];if(be!==null){const Ue=this.bboxes;for(const lt of be)if(!ie.box[lt]){ie.box[lt]=!0;const it=4*lt,ft=this.boxKeys[lt];if(l<=Ue[it+2]&&p<=Ue[it+3]&&b>=Ue[it+0]&&S>=Ue[it+1]&&(!Z||Z(ft))&&(!ce||!An(xe,ft.overlapMode))&&(R.push({key:ft,x1:Ue[it],y1:Ue[it+1],x2:Ue[it+2],y2:Ue[it+3]}),ce))return!0}}const Ae=this.circleCells[k];if(Ae!==null){const Ue=this.circles;for(const lt of Ae)if(!ie.circle[lt]){ie.circle[lt]=!0;const it=3*lt,ft=this.circleKeys[lt];if(this._circleAndRectCollide(Ue[it],Ue[it+1],Ue[it+2],l,p,b,S)&&(!Z||Z(ft))&&(!ce||!An(xe,ft.overlapMode))){const gt=Ue[it],Et=Ue[it+1],Mt=Ue[it+2];if(R.push({key:ft,x1:gt-Mt,y1:Et-Mt,x2:gt+Mt,y2:Et+Mt}),ce)return!0}}}return!1}_queryCellCircle(l,p,b,S,k,R,W,Z){const{circle:ie,seenUids:ce,overlapMode:xe}=W,be=this.boxCells[k];if(be!==null){const Ue=this.bboxes;for(const lt of be)if(!ce.box[lt]){ce.box[lt]=!0;const it=4*lt,ft=this.boxKeys[lt];if(this._circleAndRectCollide(ie.x,ie.y,ie.radius,Ue[it+0],Ue[it+1],Ue[it+2],Ue[it+3])&&(!Z||Z(ft))&&!An(xe,ft.overlapMode))return R.push(!0),!0}}const Ae=this.circleCells[k];if(Ae!==null){const Ue=this.circles;for(const lt of Ae)if(!ce.circle[lt]){ce.circle[lt]=!0;const it=3*lt,ft=this.circleKeys[lt];if(this._circlesCollide(Ue[it],Ue[it+1],Ue[it+2],ie.x,ie.y,ie.radius)&&(!Z||Z(ft))&&!An(xe,ft.overlapMode))return R.push(!0),!0}}}_forEachCell(l,p,b,S,k,R,W,Z){const ie=this._convertToXCellCoord(l),ce=this._convertToYCellCoord(p),xe=this._convertToXCellCoord(b),be=this._convertToYCellCoord(S);for(let Ae=ie;Ae<=xe;Ae++)for(let Ue=ce;Ue<=be;Ue++)if(k.call(this,l,p,b,S,this.xCellCount*Ue+Ae,R,W,Z))return}_convertToXCellCoord(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))}_convertToYCellCoord(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))}_circlesCollide(l,p,b,S,k,R){const W=S-l,Z=k-p,ie=b+R;return ie*ie>W*W+Z*Z}_circleAndRectCollide(l,p,b,S,k,R,W){const Z=(R-S)/2,ie=Math.abs(l-(S+Z));if(ie>Z+b)return!1;const ce=(W-k)/2,xe=Math.abs(p-(k+ce));if(xe>ce+b)return!1;if(ie<=Z||xe<=ce)return!0;const be=ie-Z,Ae=xe-ce;return be*be+Ae*Ae<=b*b}}function ut(A,l,p){const b=a.L();if(!A){const{vecSouth:xe,vecEast:be}=Je(l),Ae=d();Ae[0]=be[0],Ae[1]=be[1],Ae[2]=xe[0],Ae[3]=xe[1],S=Ae,(ce=(R=(k=Ae)[0])*(ie=k[3])-(Z=k[2])*(W=k[1]))&&(S[0]=ie*(ce=1/ce),S[1]=-W*ce,S[2]=-Z*ce,S[3]=R*ce),b[0]=Ae[0],b[1]=Ae[1],b[4]=Ae[2],b[5]=Ae[3]}var S,k,R,W,Z,ie,ce;return a.N(b,b,[1/p,1/p,1]),b}function We(A,l,p,b){if(A){const S=a.L();if(!l){const{vecSouth:k,vecEast:R}=Je(p);S[0]=R[0],S[1]=R[1],S[4]=k[0],S[5]=k[1]}return a.N(S,S,[b,b,1]),S}return p.pixelsToClipSpaceMatrix}function Je(A){const l=Math.cos(A.rollInRadians),p=Math.sin(A.rollInRadians),b=Math.cos(A.pitchInRadians),S=Math.cos(A.bearingInRadians),k=Math.sin(A.bearingInRadians),R=a.ar();R[0]=-S*b*p-k*l,R[1]=-k*b*p+S*l;const W=a.as(R);W<1e-9?a.at(R):a.au(R,R,1/W);const Z=a.ar();Z[0]=S*b*l-k*p,Z[1]=k*b*l+S*p;const ie=a.as(Z);return ie<1e-9?a.at(Z):a.au(Z,Z,1/ie),{vecEast:Z,vecSouth:R}}function xt(A,l,p,b){let S;b?(S=[A,l,b(A,l),1],a.aw(S,S,p)):(S=[A,l,0,1],ra(S,S,p));const k=S[3];return{point:new a.P(S[0]/k,S[1]/k),signedDistanceFromCamera:k,isOccluded:!1}}function wt(A,l){return .5+A/l*.5}function pr(A,l){return A.x>=-l[0]&&A.x<=l[0]&&A.y>=-l[1]&&A.y<=l[1]}function Rr(A,l,p,b,S,k,R,W,Z,ie,ce,xe,be){const Ae=p?A.textSizeData:A.iconSizeData,Ue=a.an(Ae,l.transform.zoom),lt=[256/l.width*2+1,256/l.height*2+1],it=p?A.text.dynamicLayoutVertexArray:A.icon.dynamicLayoutVertexArray;it.clear();const ft=A.lineVertexArray,gt=p?A.text.placedSymbolArray:A.icon.placedSymbolArray,Et=l.transform.width/l.transform.height;let Mt=!1;for(let It=0;It<gt.length;It++){const jt=gt.get(It);if(jt.hidden||jt.writingMode===a.ao.vertical&&!Mt){ta(jt.numGlyphs,it);continue}Mt=!1;const St=new a.P(jt.anchorX,jt.anchorY),Wt={getElevation:be,pitchedLabelPlaneMatrix:b,lineVertexArray:ft,pitchWithMap:k,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:l.transform,tileAnchorPoint:St,unwrappedTileID:Z,width:ie,height:ce,translation:xe},ur=Uo(jt.anchorX,jt.anchorY,Wt);if(!pr(ur.point,lt)){ta(jt.numGlyphs,it);continue}const Jt=wt(l.transform.cameraToCenterDistance,ur.signedDistanceFromCamera),nr=a.ap(Ae,Ue,jt),cr=k?nr*l.transform.getPitchedTextCorrection(jt.anchorX,jt.anchorY,Z)/Jt:nr*Jt,Gr=_r({projectionContext:Wt,pitchedLabelPlaneMatrixInverse:S,symbol:jt,fontSize:cr,flip:!1,keepUpright:R,glyphOffsetArray:A.glyphOffsetArray,dynamicLayoutVertexArray:it,aspectRatio:Et,rotateToLine:W});Mt=Gr.useVertical,(Gr.notEnoughRoom||Mt||Gr.needsFlipping&&_r({projectionContext:Wt,pitchedLabelPlaneMatrixInverse:S,symbol:jt,fontSize:cr,flip:!0,keepUpright:R,glyphOffsetArray:A.glyphOffsetArray,dynamicLayoutVertexArray:it,aspectRatio:Et,rotateToLine:W}).notEnoughRoom)&&ta(jt.numGlyphs,it)}p?A.text.dynamicLayoutVertexBuffer.updateData(it):A.icon.dynamicLayoutVertexBuffer.updateData(it)}function On(A,l,p,b,S,k,R,W){const Z=k.glyphStartIndex+k.numGlyphs,ie=k.lineStartIndex,ce=k.lineStartIndex+k.lineLength,xe=l.getoffsetX(k.glyphStartIndex),be=l.getoffsetX(Z-1),Ae=Po(A*xe,p,b,S,k.segment,ie,ce,W,R);if(!Ae)return null;const Ue=Po(A*be,p,b,S,k.segment,ie,ce,W,R);return Ue?W.projectionCache.anyProjectionOccluded?null:{first:Ae,last:Ue}:null}function Mn(A,l,p,b){return A===a.ao.horizontal&&Math.abs(p.y-l.y)>Math.abs(p.x-l.x)*b?{useVertical:!0}:(A===a.ao.vertical?l.y<p.y:l.x>p.x)?{needsFlipping:!0}:null}function _r(A){const{projectionContext:l,pitchedLabelPlaneMatrixInverse:p,symbol:b,fontSize:S,flip:k,keepUpright:R,glyphOffsetArray:W,dynamicLayoutVertexArray:Z,aspectRatio:ie,rotateToLine:ce}=A,xe=S/24,be=b.lineOffsetX*xe,Ae=b.lineOffsetY*xe;let Ue;if(b.numGlyphs>1){const lt=b.glyphStartIndex+b.numGlyphs,it=b.lineStartIndex,ft=b.lineStartIndex+b.lineLength,gt=On(xe,W,be,Ae,k,b,ce,l);if(!gt)return{notEnoughRoom:!0};const Et=_o(gt.first.point.x,gt.first.point.y,l,p),Mt=_o(gt.last.point.x,gt.last.point.y,l,p);if(R&&!k){const It=Mn(b.writingMode,Et,Mt,ie);if(It)return It}Ue=[gt.first];for(let It=b.glyphStartIndex+1;It<lt-1;It++){const jt=Po(xe*W.getoffsetX(It),be,Ae,k,b.segment,it,ft,l,ce);if(!jt)return{notEnoughRoom:!0};Ue.push(jt)}Ue.push(gt.last)}else{if(R&&!k){const it=Vn(l.tileAnchorPoint.x,l.tileAnchorPoint.y,l).point,ft=b.lineStartIndex+b.segment+1,gt=new a.P(l.lineVertexArray.getx(ft),l.lineVertexArray.gety(ft)),Et=Vn(gt.x,gt.y,l),Mt=Et.signedDistanceFromCamera>0?Et.point:Or(l.tileAnchorPoint,gt,it,1,l),It=_o(it.x,it.y,l,p),jt=_o(Mt.x,Mt.y,l,p),St=Mn(b.writingMode,It,jt,ie);if(St)return St}const lt=Po(xe*W.getoffsetX(b.glyphStartIndex),be,Ae,k,b.segment,b.lineStartIndex,b.lineStartIndex+b.lineLength,l,ce);if(!lt||l.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};Ue=[lt]}for(const lt of Ue)a.av(Z,lt.point,lt.angle);return{}}function Or(A,l,p,b,S){const k=A.add(A.sub(l)._unit()),R=Vn(k.x,k.y,S).point,W=p.sub(R);return p.add(W._mult(b/W.mag()))}function an(A,l,p){const b=l.projectionCache;if(b.projections[A])return b.projections[A];const S=new a.P(l.lineVertexArray.getx(A),l.lineVertexArray.gety(A)),k=Vn(S.x,S.y,l);if(k.signedDistanceFromCamera>0)return b.projections[A]=k.point,b.anyProjectionOccluded=b.anyProjectionOccluded||k.isOccluded,k.point;const R=A-p.direction;return Or(p.distanceFromAnchor===0?l.tileAnchorPoint:new a.P(l.lineVertexArray.getx(R),l.lineVertexArray.gety(R)),S,p.previousVertex,p.absOffsetX-p.distanceFromAnchor+1,l)}function Vn(A,l,p){const b=A+p.translation[0],S=l+p.translation[1];let k;return p.pitchWithMap?(k=xt(b,S,p.pitchedLabelPlaneMatrix,p.getElevation),k.isOccluded=!1):(k=p.transform.projectTileCoordinates(b,S,p.unwrappedTileID,p.getElevation),k.point.x=(.5*k.point.x+.5)*p.width,k.point.y=(.5*-k.point.y+.5)*p.height),k}function _o(A,l,p,b){if(p.pitchWithMap){const S=[A,l,0,1];return a.aw(S,S,b),p.transform.projectTileCoordinates(S[0]/S[3],S[1]/S[3],p.unwrappedTileID,p.getElevation).point}return{x:A/p.width*2-1,y:1-l/p.height*2}}function Uo(A,l,p){return p.transform.projectTileCoordinates(A,l,p.unwrappedTileID,p.getElevation)}function yn(A,l,p){return A._unit()._perp()._mult(l*p)}function Vo(A,l,p,b,S,k,R,W,Z){if(W.projectionCache.offsets[A])return W.projectionCache.offsets[A];const ie=p.add(l);if(A+Z.direction<b||A+Z.direction>=S)return W.projectionCache.offsets[A]=ie,ie;const ce=an(A+Z.direction,W,Z),xe=yn(ce.sub(p),R,Z.direction),be=p.add(xe),Ae=ce.add(xe);return W.projectionCache.offsets[A]=a.ax(k,ie,be,Ae)||ie,W.projectionCache.offsets[A]}function Po(A,l,p,b,S,k,R,W,Z){const ie=b?A-l:A+l;let ce=ie>0?1:-1,xe=0;b&&(ce*=-1,xe=Math.PI),ce<0&&(xe+=Math.PI);let be,Ae=ce>0?k+S:k+S+1;W.projectionCache.cachedAnchorPoint?be=W.projectionCache.cachedAnchorPoint:(be=Vn(W.tileAnchorPoint.x,W.tileAnchorPoint.y,W).point,W.projectionCache.cachedAnchorPoint=be);let Ue,lt,it=be,ft=be,gt=0,Et=0;const Mt=Math.abs(ie),It=[];let jt;for(;gt+Et<=Mt;){if(Ae+=ce,Ae<k||Ae>=R)return null;gt+=Et,ft=it,lt=Ue;const ur={absOffsetX:Mt,direction:ce,distanceFromAnchor:gt,previousVertex:ft};if(it=an(Ae,W,ur),p===0)It.push(ft),jt=it.sub(ft);else{let Jt;const nr=it.sub(ft);Jt=nr.mag()===0?yn(an(Ae+ce,W,ur).sub(it),p,ce):yn(nr,p,ce),lt||(lt=ft.add(Jt)),Ue=Vo(Ae,Jt,it,k,R,lt,p,W,ur),It.push(lt),jt=Ue.sub(lt)}Et=jt.mag()}const St=jt._mult((Mt-gt)/Et)._add(lt||ft),Wt=xe+Math.atan2(it.y-ft.y,it.x-ft.x);return It.push(St),{point:St,angle:Z?Wt:0,path:It}}const pa=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ta(A,l){for(let p=0;p<A;p++){const b=l.length;l.resize(b+4),l.float32.set(pa,3*b)}}function ra(A,l,p){const b=l[0],S=l[1];return A[0]=p[0]*b+p[4]*S+p[12],A[1]=p[1]*b+p[5]*S+p[13],A[3]=p[3]*b+p[7]*S+p[15],A}const so=100;class Xs{constructor(l,p=new ge(l.width+200,l.height+200,25),b=new ge(l.width+200,l.height+200,25)){this.transform=l,this.grid=p,this.ignoredGrid=b,this.pitchFactor=Math.cos(l.pitch*Math.PI/180)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+so,this.screenBottomBoundary=l.height+so,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(l,p,b,S,k,R,W,Z,ie,ce,xe,be){const Ae=this.projectAndGetPerspectiveRatio(l.anchorPointX+Z[0],l.anchorPointY+Z[1],k,ce,be),Ue=b*Ae.perspectiveRatio;let lt;if(R||W)lt=this._projectCollisionBox(l,Ue,S,k,R,W,Z,Ae,ce,xe,be);else{const jt=Ae.x+(xe?xe.x*Ue:0),St=Ae.y+(xe?xe.y*Ue:0);lt={allPointsOccluded:!1,box:[jt+l.x1*Ue,St+l.y1*Ue,jt+l.x2*Ue,St+l.y2*Ue]}}const[it,ft,gt,Et]=lt.box,Mt=R?lt.allPointsOccluded:Ae.isOccluded;let It=Mt;return It||(It=Ae.perspectiveRatio<this.perspectiveRatioCutoff),It||(It=!this.isInsideGrid(it,ft,gt,Et)),It||p!=="always"&&this.grid.hitTest(it,ft,gt,Et,p,ie)?{box:[it,ft,gt,Et],placeable:!1,offscreen:!1,occluded:Mt}:{box:[it,ft,gt,Et],placeable:!0,offscreen:this.isOffscreen(it,ft,gt,Et),occluded:Mt}}placeCollisionCircles(l,p,b,S,k,R,W,Z,ie,ce,xe,be,Ae,Ue){const lt=[],it=new a.P(p.anchorX,p.anchorY),ft=this.getPerspectiveRatio(it.x,it.y,R,Ue),gt=(ie?k*this.transform.getPitchedTextCorrection(p.anchorX,p.anchorY,R)/ft:k*ft)/a.aB,Et={getElevation:Ue,pitchedLabelPlaneMatrix:W,lineVertexArray:b,pitchWithMap:ie,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:it,unwrappedTileID:R,width:this.transform.width,height:this.transform.height,translation:Ae},Mt=On(gt,S,p.lineOffsetX*gt,p.lineOffsetY*gt,!1,p,!1,Et);let It=!1,jt=!1,St=!0;if(Mt){const Wt=.5*xe*ft+be,ur=new a.P(-100,-100),Jt=new a.P(this.screenRightBoundary,this.screenBottomBoundary),nr=new qr,cr=Mt.first,Gr=Mt.last;let Yr=[];for(let mi=cr.path.length-1;mi>=1;mi--)Yr.push(cr.path[mi]);for(let mi=1;mi<Gr.path.length;mi++)Yr.push(Gr.path[mi]);const $r=2.5*Wt;if(ie){const mi=this.projectPathToScreenSpace(Yr,Et);Yr=mi.some(uo=>uo.signedDistanceFromCamera<=0)?[]:mi.map(uo=>uo.point)}let Tn=[];if(Yr.length>0){const mi=Yr[0].clone(),uo=Yr[0].clone();for(let go=1;go<Yr.length;go++)mi.x=Math.min(mi.x,Yr[go].x),mi.y=Math.min(mi.y,Yr[go].y),uo.x=Math.max(uo.x,Yr[go].x),uo.y=Math.max(uo.y,Yr[go].y);Tn=mi.x>=ur.x&&uo.x<=Jt.x&&mi.y>=ur.y&&uo.y<=Jt.y?[Yr]:uo.x<ur.x||mi.x>Jt.x||uo.y<ur.y||mi.y>Jt.y?[]:a.ay([Yr],ur.x,ur.y,Jt.x,Jt.y)}for(const mi of Tn){nr.reset(mi,.25*Wt);let uo=0;uo=nr.length<=.5*Wt?1:Math.ceil(nr.paddedLength/$r)+1;for(let go=0;go<uo;go++){const bo=go/Math.max(uo-1,1),zo=nr.lerp(bo),To=zo.x+so,ei=zo.y+so;lt.push(To,ei,Wt,0);const qi=To-Wt,ya=ei-Wt,Aa=To+Wt,Fa=ei+Wt;if(St=St&&this.isOffscreen(qi,ya,Aa,Fa),jt=jt||this.isInsideGrid(qi,ya,Aa,Fa),l!=="always"&&this.grid.hitTestCircle(To,ei,Wt,l,ce)&&(It=!0,!Z))return{circles:[],offscreen:!1,collisionDetected:It}}}}return{circles:!Z&&It||!jt||ft<this.perspectiveRatioCutoff?[]:lt,offscreen:St,collisionDetected:It}}projectPathToScreenSpace(l,p){const b=function(S,k){const R=a.L();return a.aq(R,k.pitchedLabelPlaneMatrix),S.map(W=>{const Z=xt(W.x,W.y,R,k.getElevation),ie=k.transform.projectTileCoordinates(Z.point.x,Z.point.y,k.unwrappedTileID,k.getElevation);return ie.point.x=(.5*ie.point.x+.5)*k.width,ie.point.y=(.5*-ie.point.y+.5)*k.height,ie})}(l,p);return function(S){let k=0,R=0,W=0,Z=0;for(let ie=0;ie<S.length;ie++)S[ie].isOccluded?(W=ie+1,Z=0):(Z++,Z>R&&(R=Z,k=W));return S.slice(k,k+R)}(b)}queryRenderedSymbols(l){if(l.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const p=[],b=new a.a2;for(const xe of l){const be=new a.P(xe.x+so,xe.y+so);b.extend(be),p.push(be)}const{minX:S,minY:k,maxX:R,maxY:W}=b,Z=this.grid.query(S,k,R,W).concat(this.ignoredGrid.query(S,k,R,W)),ie={},ce={};for(const xe of Z){const be=xe.key;if(ie[be.bucketInstanceId]===void 0&&(ie[be.bucketInstanceId]={}),ie[be.bucketInstanceId][be.featureIndex])continue;const Ae=[new a.P(xe.x1,xe.y1),new a.P(xe.x2,xe.y1),new a.P(xe.x2,xe.y2),new a.P(xe.x1,xe.y2)];a.az(p,Ae)&&(ie[be.bucketInstanceId][be.featureIndex]=!0,ce[be.bucketInstanceId]===void 0&&(ce[be.bucketInstanceId]=[]),ce[be.bucketInstanceId].push(be.featureIndex))}return ce}insertCollisionBox(l,p,b,S,k,R){(b?this.ignoredGrid:this.grid).insert({bucketInstanceId:S,featureIndex:k,collisionGroupID:R,overlapMode:p},l[0],l[1],l[2],l[3])}insertCollisionCircles(l,p,b,S,k,R){const W=b?this.ignoredGrid:this.grid,Z={bucketInstanceId:S,featureIndex:k,collisionGroupID:R,overlapMode:p};for(let ie=0;ie<l.length;ie+=4)W.insertCircle(Z,l[ie],l[ie+1],l[ie+2])}projectAndGetPerspectiveRatio(l,p,b,S,k){if(k){let R;S?(R=[l,p,S(l,p),1],a.aw(R,R,k)):(R=[l,p,0,1],ra(R,R,k));const W=R[3];return{x:(R[0]/W+1)/2*this.transform.width+so,y:(-R[1]/W+1)/2*this.transform.height+so,perspectiveRatio:.5+this.transform.cameraToCenterDistance/W*.5,isOccluded:!1,signedDistanceFromCamera:W}}{const R=this.transform.projectTileCoordinates(l,p,b,S);return{x:(R.point.x+1)/2*this.transform.width+so,y:(1-R.point.y)/2*this.transform.height+so,perspectiveRatio:.5+this.transform.cameraToCenterDistance/R.signedDistanceFromCamera*.5,isOccluded:R.isOccluded,signedDistanceFromCamera:R.signedDistanceFromCamera}}}getPerspectiveRatio(l,p,b,S){const k=this.transform.projectTileCoordinates(l,p,b,S);return .5+this.transform.cameraToCenterDistance/k.signedDistanceFromCamera*.5}isOffscreen(l,p,b,S){return b<so||l>=this.screenRightBoundary||S<so||p>this.screenBottomBoundary}isInsideGrid(l,p,b,S){return b>=0&&l<this.gridRightBoundary&&S>=0&&p<this.gridBottomBoundary}getViewportMatrix(){const l=a.ag([]);return a.M(l,l,[-100,-100,0]),l}_projectCollisionBox(l,p,b,S,k,R,W,Z,ie,ce,xe){let be=1,Ae=0,Ue=0,lt=1;const it=l.anchorPointX+W[0],ft=l.anchorPointY+W[1];if(R&&!k){const Yr=this.projectAndGetPerspectiveRatio(it+1,ft,S,ie,xe),$r=Yr.x-Z.x,Tn=Math.atan((Yr.y-Z.y)/$r)+($r<0?Math.PI:0),mi=Math.sin(Tn),uo=Math.cos(Tn);be=uo,Ae=mi,Ue=-mi,lt=uo}else if(!R&&k){const Yr=Je(this.transform);be=Yr.vecEast[0],Ae=Yr.vecEast[1],Ue=Yr.vecSouth[0],lt=Yr.vecSouth[1]}let gt=Z.x,Et=Z.y,Mt=p;k&&(gt=it,Et=ft,Mt=Math.pow(2,-(this.transform.zoom-b.overscaledZ)),Mt*=this.transform.getPitchedTextCorrection(it,ft,S),ce||(Mt*=a.ah(.5+Z.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),ce&&(gt+=be*ce.x*Mt+Ue*ce.y*Mt,Et+=Ae*ce.x*Mt+lt*ce.y*Mt);const It=l.x1*Mt,jt=l.x2*Mt,St=(It+jt)/2,Wt=l.y1*Mt,ur=l.y2*Mt,Jt=(Wt+ur)/2,nr=[{offsetX:It,offsetY:Wt},{offsetX:St,offsetY:Wt},{offsetX:jt,offsetY:Wt},{offsetX:jt,offsetY:Jt},{offsetX:jt,offsetY:ur},{offsetX:St,offsetY:ur},{offsetX:It,offsetY:ur},{offsetX:It,offsetY:Jt}];let cr=[];for(const{offsetX:Yr,offsetY:$r}of nr)cr.push(new a.P(gt+be*Yr+Ue*$r,Et+Ae*Yr+lt*$r));let Gr=!1;if(k){const Yr=cr.map($r=>this.projectAndGetPerspectiveRatio($r.x,$r.y,S,ie,xe));Gr=Yr.some($r=>!$r.isOccluded),cr=Yr.map($r=>new a.P($r.x,$r.y))}else Gr=!0;return{box:a.aA(cr),allPointsOccluded:!Gr}}}class xo{constructor(l,p,b,S){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?p:-p))):S&&b?1:0,this.placed=b}isHidden(){return this.opacity===0&&!this.placed}}class Qn{constructor(l,p,b,S,k){this.text=new xo(l?l.text:null,p,b,k),this.icon=new xo(l?l.icon:null,p,S,k)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class is{constructor(l,p,b){this.text=l,this.icon=p,this.skipFade=b}}class la{constructor(l,p,b,S,k){this.bucketInstanceId=l,this.featureIndex=p,this.sourceLayerIndex=b,this.bucketIndex=S,this.tileID=k}}class $s{constructor(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}}get(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){const p=++this.maxGroupID;this.collisionGroups[l]={ID:p,predicate:b=>b.collisionGroupID===p}}return this.collisionGroups[l]}}function wo(A,l,p,b,S){const{horizontalAlign:k,verticalAlign:R}=a.aH(A);return new a.P(-(k-.5)*l+b[0]*S,-(R-.5)*p+b[1]*S)}class Eo{constructor(l,p,b,S,k){this.transform=l.clone(),this.terrain=p,this.collisionIndex=new Xs(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=b,this.retainedQueryData={},this.collisionGroups=new $s(S),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=k,k&&(k.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(l){const p=this.terrain;return p?(b,S)=>p.getElevation(l,b,S):null}getBucketParts(l,p,b,S){const k=b.getBucket(p),R=b.latestFeatureIndex;if(!k||!R||p.id!==k.layerIds[0])return;const W=b.collisionBoxArray,Z=k.layers[0].layout,ie=k.layers[0].paint,ce=Math.pow(2,this.transform.zoom-b.tileID.overscaledZ),xe=b.tileSize/a.$,be=b.tileID.toUnwrapped(),Ae=Z.get("text-rotation-alignment")==="map",Ue=a.aC(b,1,this.transform.zoom),lt=a.aD(this.collisionIndex.transform,b,ie.get("text-translate"),ie.get("text-translate-anchor")),it=a.aD(this.collisionIndex.transform,b,ie.get("icon-translate"),ie.get("icon-translate-anchor")),ft=ut(Ae,this.transform,Ue);this.retainedQueryData[k.bucketInstanceId]=new la(k.bucketInstanceId,R,k.sourceLayerIndex,k.index,b.tileID);const gt={bucket:k,layout:Z,translationText:lt,translationIcon:it,unwrappedTileID:be,pitchedLabelPlaneMatrix:ft,scale:ce,textPixelRatio:xe,holdingForFade:b.holdingForFade(),collisionBoxArray:W,partiallyEvaluatedTextSize:a.an(k.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(k.sourceID)};if(S)for(const Et of k.sortKeyRanges){const{sortKey:Mt,symbolInstanceStart:It,symbolInstanceEnd:jt}=Et;l.push({sortKey:Mt,symbolInstanceStart:It,symbolInstanceEnd:jt,parameters:gt})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:k.symbolInstances.length,parameters:gt})}attemptAnchorPlacement(l,p,b,S,k,R,W,Z,ie,ce,xe,be,Ae,Ue,lt,it,ft,gt,Et,Mt){const It=a.aE[l.textAnchor],jt=[l.textOffset0,l.textOffset1],St=wo(It,b,S,jt,k),Wt=this.collisionIndex.placeCollisionBox(p,be,Z,ie,ce,W,R,it,xe.predicate,Et,St,Mt);if((!gt||this.collisionIndex.placeCollisionBox(gt,be,Z,ie,ce,W,R,ft,xe.predicate,Et,St,Mt).placeable)&&Wt.placeable){let ur;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ae.crossTileID]&&this.prevPlacement.placements[Ae.crossTileID]&&this.prevPlacement.placements[Ae.crossTileID].text&&(ur=this.prevPlacement.variableOffsets[Ae.crossTileID].anchor),Ae.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[Ae.crossTileID]={textOffset:jt,width:b,height:S,anchor:It,textBoxScale:k,prevAnchor:ur},this.markUsedJustification(Ue,It,Ae,lt),Ue.allowVerticalPlacement&&(this.markUsedOrientation(Ue,lt,Ae),this.placedOrientations[Ae.crossTileID]=lt),{shift:St,placedGlyphBoxes:Wt}}}placeLayerBucketPart(l,p,b){const{bucket:S,layout:k,translationText:R,translationIcon:W,unwrappedTileID:Z,pitchedLabelPlaneMatrix:ie,textPixelRatio:ce,holdingForFade:xe,collisionBoxArray:be,partiallyEvaluatedTextSize:Ae,collisionGroup:Ue}=l.parameters,lt=k.get("text-optional"),it=k.get("icon-optional"),ft=a.aF(k,"text-overlap","text-allow-overlap"),gt=ft==="always",Et=a.aF(k,"icon-overlap","icon-allow-overlap"),Mt=Et==="always",It=k.get("text-rotation-alignment")==="map",jt=k.get("text-pitch-alignment")==="map",St=k.get("icon-text-fit")!=="none",Wt=k.get("symbol-z-order")==="viewport-y",ur=gt&&(Mt||!S.hasIconData()||it),Jt=Mt&&(gt||!S.hasTextData()||lt);!S.collisionArrays&&be&&S.deserializeCollisionBoxes(be);const nr=this.retainedQueryData[S.bucketInstanceId].tileID,cr=this._getTerrainElevationFunc(nr),Gr=this.transform.getFastPathSimpleProjectionMatrix(nr),Yr=($r,Tn,mi)=>{var uo,go;if(p[$r.crossTileID])return;if(xe)return void(this.placements[$r.crossTileID]=new is(!1,!1,!1));let bo=!1,zo=!1,To=!0,ei=null,qi={box:null,placeable:!1,offscreen:null,occluded:!1},ya={placeable:!1},Aa=null,Fa=null,Js=null,Rl=0,Yc=0,Ad=0;Tn.textFeatureIndex?Rl=Tn.textFeatureIndex:$r.useRuntimeCollisionCircles&&(Rl=$r.featureIndex),Tn.verticalTextFeatureIndex&&(Yc=Tn.verticalTextFeatureIndex);const tf=Tn.textBox;if(tf){const Fl=hs=>{let As=a.ao.horizontal;if(S.allowVerticalPlacement&&!hs&&this.prevPlacement){const Qc=this.prevPlacement.placedOrientations[$r.crossTileID];Qc&&(this.placedOrientations[$r.crossTileID]=Qc,As=Qc,this.markUsedOrientation(S,As,$r))}return As},hu=(hs,As)=>{if(S.allowVerticalPlacement&&$r.numVerticalGlyphVertices>0&&Tn.verticalTextBox){for(const Qc of S.writingModes)if(Qc===a.ao.vertical?(qi=As(),ya=qi):qi=hs(),qi&&qi.placeable)break}else qi=hs()},zl=$r.textAnchorOffsetStartIndex,Cd=$r.textAnchorOffsetEndIndex;if(Cd===zl){const hs=(As,Qc)=>{const Xa=this.collisionIndex.placeCollisionBox(As,ft,ce,nr,Z,jt,It,R,Ue.predicate,cr,void 0,Gr);return Xa&&Xa.placeable&&(this.markUsedOrientation(S,Qc,$r),this.placedOrientations[$r.crossTileID]=Qc),Xa};hu(()=>hs(tf,a.ao.horizontal),()=>{const As=Tn.verticalTextBox;return S.allowVerticalPlacement&&$r.numVerticalGlyphVertices>0&&As?hs(As,a.ao.vertical):{box:null,offscreen:null}}),Fl(qi&&qi.placeable)}else{let hs=a.aE[(go=(uo=this.prevPlacement)===null||uo===void 0?void 0:uo.variableOffsets[$r.crossTileID])===null||go===void 0?void 0:go.anchor];const As=(Xa,cp,nf)=>{const Iu=Xa.x2-Xa.x1,fu=Xa.y2-Xa.y1,kd=$r.textBoxScale,Id=St&&Et==="never"?cp:null;let Cc=null,V_=ft==="never"?1:2,og="never";hs&&V_++;for(let am=0;am<V_;am++){for(let up=zl;up<Cd;up++){const Od=S.textAnchorOffsets.get(up);if(hs&&Od.textAnchor!==hs)continue;const nd=this.attemptAnchorPlacement(Od,Xa,Iu,fu,kd,It,jt,ce,nr,Z,Ue,og,$r,S,nf,R,W,Id,cr);if(nd&&(Cc=nd.placedGlyphBoxes,Cc&&Cc.placeable))return bo=!0,ei=nd.shift,Cc}hs?hs=null:og=ft}return b&&!Cc&&(Cc={box:this.collisionIndex.placeCollisionBox(tf,"always",ce,nr,Z,jt,It,R,Ue.predicate,cr,void 0,Gr).box,offscreen:!1,placeable:!1,occluded:!1}),Cc};hu(()=>As(tf,Tn.iconBox,a.ao.horizontal),()=>{const Xa=Tn.verticalTextBox;return S.allowVerticalPlacement&&(!qi||!qi.placeable)&&$r.numVerticalGlyphVertices>0&&Xa?As(Xa,Tn.verticalIconBox,a.ao.vertical):{box:null,occluded:!0,offscreen:null}}),qi&&(bo=qi.placeable,To=qi.offscreen);const Qc=Fl(qi&&qi.placeable);if(!bo&&this.prevPlacement){const Xa=this.prevPlacement.variableOffsets[$r.crossTileID];Xa&&(this.variableOffsets[$r.crossTileID]=Xa,this.markUsedJustification(S,Xa.anchor,$r,Qc))}}}if(Aa=qi,bo=Aa&&Aa.placeable,To=Aa&&Aa.offscreen,$r.useRuntimeCollisionCircles){const Fl=S.text.placedSymbolArray.get($r.centerJustifiedTextSymbolIndex),hu=a.ap(S.textSizeData,Ae,Fl),zl=k.get("text-padding");Fa=this.collisionIndex.placeCollisionCircles(ft,Fl,S.lineVertexArray,S.glyphOffsetArray,hu,Z,ie,b,jt,Ue.predicate,$r.collisionCircleDiameter,zl,R,cr),Fa.circles.length&&Fa.collisionDetected&&!b&&a.w("Collisions detected, but collision boxes are not shown"),bo=gt||Fa.circles.length>0&&!Fa.collisionDetected,To=To&&Fa.offscreen}if(Tn.iconFeatureIndex&&(Ad=Tn.iconFeatureIndex),Tn.iconBox){const Fl=hu=>this.collisionIndex.placeCollisionBox(hu,Et,ce,nr,Z,jt,It,W,Ue.predicate,cr,St&&ei?ei:void 0,Gr);ya&&ya.placeable&&Tn.verticalIconBox?(Js=Fl(Tn.verticalIconBox),zo=Js.placeable):(Js=Fl(Tn.iconBox),zo=Js.placeable),To=To&&Js.offscreen}const rf=lt||$r.numHorizontalGlyphVertices===0&&$r.numVerticalGlyphVertices===0,ph=it||$r.numIconVertices===0;rf||ph?ph?rf||(zo=zo&&bo):bo=zo&&bo:zo=bo=zo&&bo;const mh=zo&&Js.placeable;if(bo&&Aa.placeable&&this.collisionIndex.insertCollisionBox(Aa.box,ft,k.get("text-ignore-placement"),S.bucketInstanceId,ya&&ya.placeable&&Yc?Yc:Rl,Ue.ID),mh&&this.collisionIndex.insertCollisionBox(Js.box,Et,k.get("icon-ignore-placement"),S.bucketInstanceId,Ad,Ue.ID),Fa&&bo&&this.collisionIndex.insertCollisionCircles(Fa.circles,ft,k.get("text-ignore-placement"),S.bucketInstanceId,Rl,Ue.ID),b&&this.storeCollisionData(S.bucketInstanceId,mi,Tn,Aa,Js,Fa),$r.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(S.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[$r.crossTileID]=new is((bo||ur)&&!(Aa!=null&&Aa.occluded),(zo||Jt)&&!(Js!=null&&Js.occluded),To||S.justReloaded),p[$r.crossTileID]=!0};if(Wt){if(l.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const $r=S.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Tn=$r.length-1;Tn>=0;--Tn){const mi=$r[Tn];Yr(S.symbolInstances.get(mi),S.collisionArrays[mi],mi)}}else for(let $r=l.symbolInstanceStart;$r<l.symbolInstanceEnd;$r++)Yr(S.symbolInstances.get($r),S.collisionArrays[$r],$r);S.justReloaded=!1}storeCollisionData(l,p,b,S,k,R){if(b.textBox||b.iconBox){let W,Z;this.collisionBoxArrays.has(l)?W=this.collisionBoxArrays.get(l):(W=new Map,this.collisionBoxArrays.set(l,W)),W.has(p)?Z=W.get(p):(Z={text:null,icon:null},W.set(p,Z)),b.textBox&&(Z.text=S.box),b.iconBox&&(Z.icon=k.box)}if(R){let W=this.collisionCircleArrays[l];W===void 0&&(W=this.collisionCircleArrays[l]=[]);for(let Z=0;Z<R.circles.length;Z+=4)W.push(R.circles[Z+0]-so),W.push(R.circles[Z+1]-so),W.push(R.circles[Z+2]),W.push(R.collisionDetected?1:0)}}markUsedJustification(l,p,b,S){let k;k=S===a.ao.vertical?b.verticalPlacedTextSymbolIndex:{left:b.leftJustifiedTextSymbolIndex,center:b.centerJustifiedTextSymbolIndex,right:b.rightJustifiedTextSymbolIndex}[a.aG(p)];const R=[b.leftJustifiedTextSymbolIndex,b.centerJustifiedTextSymbolIndex,b.rightJustifiedTextSymbolIndex,b.verticalPlacedTextSymbolIndex];for(const W of R)W>=0&&(l.text.placedSymbolArray.get(W).crossTileID=k>=0&&W!==k?0:b.crossTileID)}markUsedOrientation(l,p,b){const S=p===a.ao.horizontal||p===a.ao.horizontalOnly?p:0,k=p===a.ao.vertical?p:0,R=[b.leftJustifiedTextSymbolIndex,b.centerJustifiedTextSymbolIndex,b.rightJustifiedTextSymbolIndex];for(const W of R)l.text.placedSymbolArray.get(W).placedOrientation=S;b.verticalPlacedTextSymbolIndex&&(l.text.placedSymbolArray.get(b.verticalPlacedTextSymbolIndex).placedOrientation=k)}commit(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;const p=this.prevPlacement;let b=!1;this.prevZoomAdjustment=p?p.zoomAdjustment(this.transform.zoom):0;const S=p?p.symbolFadeChange(l):1,k=p?p.opacities:{},R=p?p.variableOffsets:{},W=p?p.placedOrientations:{};for(const Z in this.placements){const ie=this.placements[Z],ce=k[Z];ce?(this.opacities[Z]=new Qn(ce,S,ie.text,ie.icon),b=b||ie.text!==ce.text.placed||ie.icon!==ce.icon.placed):(this.opacities[Z]=new Qn(null,S,ie.text,ie.icon,ie.skipFade),b=b||ie.text||ie.icon)}for(const Z in k){const ie=k[Z];if(!this.opacities[Z]){const ce=new Qn(ie,S,!1,!1);ce.isHidden()||(this.opacities[Z]=ce,b=b||ie.text.placed||ie.icon.placed)}}for(const Z in R)this.variableOffsets[Z]||!this.opacities[Z]||this.opacities[Z].isHidden()||(this.variableOffsets[Z]=R[Z]);for(const Z in W)this.placedOrientations[Z]||!this.opacities[Z]||this.opacities[Z].isHidden()||(this.placedOrientations[Z]=W[Z]);if(p&&p.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");b?this.lastPlacementChangeTime=l:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=p?p.lastPlacementChangeTime:l)}updateLayerOpacities(l,p){const b={};for(const S of p){const k=S.getBucket(l);k&&S.latestFeatureIndex&&l.id===k.layerIds[0]&&this.updateBucketOpacities(k,S.tileID,b,S.collisionBoxArray)}}updateBucketOpacities(l,p,b,S){l.hasTextData()&&(l.text.opacityVertexArray.clear(),l.text.hasVisibleVertices=!1),l.hasIconData()&&(l.icon.opacityVertexArray.clear(),l.icon.hasVisibleVertices=!1),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();const k=l.layers[0],R=k.layout,W=new Qn(null,0,!1,!1,!0),Z=R.get("text-allow-overlap"),ie=R.get("icon-allow-overlap"),ce=k._unevaluatedLayout.hasValue("text-variable-anchor")||k._unevaluatedLayout.hasValue("text-variable-anchor-offset"),xe=R.get("text-rotation-alignment")==="map",be=R.get("text-pitch-alignment")==="map",Ae=R.get("icon-text-fit")!=="none",Ue=new Qn(null,0,Z&&(ie||!l.hasIconData()||R.get("icon-optional")),ie&&(Z||!l.hasTextData()||R.get("text-optional")),!0);!l.collisionArrays&&S&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(S);const lt=(ft,gt,Et)=>{for(let Mt=0;Mt<gt/4;Mt++)ft.opacityVertexArray.emplaceBack(Et);ft.hasVisibleVertices=ft.hasVisibleVertices||Et!==Ga},it=this.collisionBoxArrays.get(l.bucketInstanceId);for(let ft=0;ft<l.symbolInstances.length;ft++){const gt=l.symbolInstances.get(ft),{numHorizontalGlyphVertices:Et,numVerticalGlyphVertices:Mt,crossTileID:It}=gt;let jt=this.opacities[It];b[It]?jt=W:jt||(jt=Ue,this.opacities[It]=jt),b[It]=!0;const St=gt.numIconVertices>0,Wt=this.placedOrientations[gt.crossTileID],ur=Wt===a.ao.vertical,Jt=Wt===a.ao.horizontal||Wt===a.ao.horizontalOnly;if(Et>0||Mt>0){const cr=ba(jt.text);lt(l.text,Et,ur?Ga:cr),lt(l.text,Mt,Jt?Ga:cr);const Gr=jt.text.isHidden();[gt.rightJustifiedTextSymbolIndex,gt.centerJustifiedTextSymbolIndex,gt.leftJustifiedTextSymbolIndex].forEach(Tn=>{Tn>=0&&(l.text.placedSymbolArray.get(Tn).hidden=Gr||ur?1:0)}),gt.verticalPlacedTextSymbolIndex>=0&&(l.text.placedSymbolArray.get(gt.verticalPlacedTextSymbolIndex).hidden=Gr||Jt?1:0);const Yr=this.variableOffsets[gt.crossTileID];Yr&&this.markUsedJustification(l,Yr.anchor,gt,Wt);const $r=this.placedOrientations[gt.crossTileID];$r&&(this.markUsedJustification(l,"left",gt,$r),this.markUsedOrientation(l,$r,gt))}if(St){const cr=ba(jt.icon),Gr=!(Ae&&gt.verticalPlacedIconSymbolIndex&&ur);gt.placedIconSymbolIndex>=0&&(lt(l.icon,gt.numIconVertices,Gr?cr:Ga),l.icon.placedSymbolArray.get(gt.placedIconSymbolIndex).hidden=jt.icon.isHidden()),gt.verticalPlacedIconSymbolIndex>=0&&(lt(l.icon,gt.numVerticalIconVertices,Gr?Ga:cr),l.icon.placedSymbolArray.get(gt.verticalPlacedIconSymbolIndex).hidden=jt.icon.isHidden())}const nr=it&&it.has(ft)?it.get(ft):{text:null,icon:null};if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){const cr=l.collisionArrays[ft];if(cr){let Gr=new a.P(0,0);if(cr.textBox||cr.verticalTextBox){let Yr=!0;if(ce){const $r=this.variableOffsets[It];$r?(Gr=wo($r.anchor,$r.width,$r.height,$r.textOffset,$r.textBoxScale),xe&&Gr._rotate(be?-this.transform.bearingInRadians:this.transform.bearingInRadians)):Yr=!1}if(cr.textBox||cr.verticalTextBox){let $r;cr.textBox&&($r=ur),cr.verticalTextBox&&($r=Jt),Wa(l.textCollisionBox.collisionVertexArray,jt.text.placed,!Yr||$r,nr.text,Gr.x,Gr.y)}}if(cr.iconBox||cr.verticalIconBox){const Yr=!!(!Jt&&cr.verticalIconBox);let $r;cr.iconBox&&($r=Yr),cr.verticalIconBox&&($r=!Yr),Wa(l.iconCollisionBox.collisionVertexArray,jt.icon.placed,$r,nr.icon,Ae?Gr.x:0,Ae?Gr.y:0)}}}}if(l.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.text.opacityVertexArray.length!==l.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${l.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${l.text.layoutVertexArray.length}) / 4`);if(l.icon.opacityVertexArray.length!==l.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${l.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${l.icon.layoutVertexArray.length}) / 4`);l.bucketInstanceId in this.collisionCircleArrays&&(l.collisionCircleArray=this.collisionCircleArrays[l.bucketInstanceId],delete this.collisionCircleArrays[l.bucketInstanceId])}symbolFadeChange(l){return this.fadeDuration===0?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(l){return Math.max(0,(this.transform.zoom-l)/1.5)}hasTransitions(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(l,p){const b=this.zoomAtLastRecencyCheck===p?1-this.zoomAdjustment(p):1;return this.zoomAtLastRecencyCheck=p,this.commitTime+this.fadeDuration*b>l}setStale(){this.stale=!0}}function Wa(A,l,p,b,S,k){b&&b.length!==0||(b=[0,0,0,0]);const R=b[0]-so,W=b[1]-so,Z=b[2]-so,ie=b[3]-so;A.emplaceBack(l?1:0,p?1:0,S||0,k||0,R,W),A.emplaceBack(l?1:0,p?1:0,S||0,k||0,Z,W),A.emplaceBack(l?1:0,p?1:0,S||0,k||0,Z,ie),A.emplaceBack(l?1:0,p?1:0,S||0,k||0,R,ie)}const ul=Math.pow(2,25),os=Math.pow(2,24),Pr=Math.pow(2,17),Hr=Math.pow(2,16),gn=Math.pow(2,9),Zi=Math.pow(2,8),dl=Math.pow(2,1);function ba(A){if(A.opacity===0&&!A.placed)return 0;if(A.opacity===1&&A.placed)return 4294967295;const l=A.placed?1:0,p=Math.floor(127*A.opacity);return p*ul+l*os+p*Pr+l*Hr+p*gn+l*Zi+p*dl+l}const Ga=0;class yo{constructor(l){this._sortAcrossTiles=l.layout.get("symbol-z-order")!=="viewport-y"&&!l.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(l,p,b,S,k){const R=this._bucketParts;for(;this._currentTileIndex<l.length;)if(p.getBucketParts(R,S,l[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,k())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,R.sort((W,Z)=>W.sortKey-Z.sortKey));this._currentPartIndex<R.length;)if(p.placeLayerBucketPart(R[this._currentPartIndex],this._seenCrossTileIDs,b),this._currentPartIndex++,k())return!0;return!1}}class Xl{constructor(l,p,b,S,k,R,W,Z){this.placement=new Eo(l,p,R,W,Z),this._currentPlacementIndex=b.length-1,this._forceFullPlacement=S,this._showCollisionBoxes=k,this._done=!1}isDone(){return this._done}continuePlacement(l,p,b){const S=_.now(),k=()=>!this._forceFullPlacement&&_.now()-S>2;for(;this._currentPlacementIndex>=0;){const R=p[l[this._currentPlacementIndex]],W=this.placement.collisionIndex.transform.zoom;if(R.type==="symbol"&&(!R.minzoom||R.minzoom<=W)&&(!R.maxzoom||R.maxzoom>W)){if(this._inProgressLayer||(this._inProgressLayer=new yo(R)),this._inProgressLayer.continuePlacement(b[R.source],this.placement,this._showCollisionBoxes,R,k))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(l){return this.placement.commit(l),this.placement}}const Dl=512/a.$/2;class Uc{constructor(l,p,b){this.tileID=l,this.bucketInstanceId=b,this._symbolsByKey={};const S=new Map;for(let k=0;k<p.length;k++){const R=p.get(k),W=R.key,Z=S.get(W);Z?Z.push(R):S.set(W,[R])}for(const[k,R]of S){const W={positions:R.map(Z=>({x:Math.floor(Z.anchorX*Dl),y:Math.floor(Z.anchorY*Dl)})),crossTileIDs:R.map(Z=>Z.crossTileID)};if(W.positions.length>128){const Z=new a.aI(W.positions.length,16,Uint16Array);for(const{x:ie,y:ce}of W.positions)Z.add(ie,ce);Z.finish(),delete W.positions,W.index=Z}this._symbolsByKey[k]=W}}getScaledCoordinates(l,p){const{x:b,y:S,z:k}=this.tileID.canonical,{x:R,y:W,z:Z}=p.canonical,ie=Dl/Math.pow(2,Z-k),ce=(W*a.$+l.anchorY)*ie,xe=S*a.$*Dl;return{x:Math.floor((R*a.$+l.anchorX)*ie-b*a.$*Dl),y:Math.floor(ce-xe)}}findMatches(l,p,b){const S=this.tileID.canonical.z<p.canonical.z?1:Math.pow(2,this.tileID.canonical.z-p.canonical.z);for(let k=0;k<l.length;k++){const R=l.get(k);if(R.crossTileID)continue;const W=this._symbolsByKey[R.key];if(!W)continue;const Z=this.getScaledCoordinates(R,p);if(W.index){const ie=W.index.range(Z.x-S,Z.y-S,Z.x+S,Z.y+S).sort();for(const ce of ie){const xe=W.crossTileIDs[ce];if(!b[xe]){b[xe]=!0,R.crossTileID=xe;break}}}else if(W.positions)for(let ie=0;ie<W.positions.length;ie++){const ce=W.positions[ie],xe=W.crossTileIDs[ie];if(Math.abs(ce.x-Z.x)<=S&&Math.abs(ce.y-Z.y)<=S&&!b[xe]){b[xe]=!0,R.crossTileID=xe;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:l})=>l)}}class Yt{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ie{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(l){const p=Math.round((l-this.lng)/360);if(p!==0)for(const b in this.indexes){const S=this.indexes[b],k={};for(const R in S){const W=S[R];W.tileID=W.tileID.unwrapTo(W.tileID.wrap+p),k[W.tileID.key]=W}this.indexes[b]=k}this.lng=l}addBucket(l,p,b){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===p.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(let k=0;k<p.symbolInstances.length;k++)p.symbolInstances.get(k).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]={});const S=this.usedCrossTileIDs[l.overscaledZ];for(const k in this.indexes){const R=this.indexes[k];if(Number(k)>l.overscaledZ)for(const W in R){const Z=R[W];Z.tileID.isChildOf(l)&&Z.findMatches(p.symbolInstances,l,S)}else{const W=R[l.scaledTo(Number(k)).key];W&&W.findMatches(p.symbolInstances,l,S)}}for(let k=0;k<p.symbolInstances.length;k++){const R=p.symbolInstances.get(k);R.crossTileID||(R.crossTileID=b.generate(),S[R.crossTileID]=!0)}return this.indexes[l.overscaledZ]===void 0&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new Uc(l,p.symbolInstances,p.bucketInstanceId),!0}removeBucketCrossTileIDs(l,p){for(const b of p.getCrossTileIDsLists())for(const S of b)delete this.usedCrossTileIDs[l][S]}removeStaleBuckets(l){let p=!1;for(const b in this.indexes){const S=this.indexes[b];for(const k in S)l[S[k].bucketInstanceId]||(this.removeBucketCrossTileIDs(b,S[k]),delete S[k],p=!0)}return p}}class rt{constructor(){this.layerIndexes={},this.crossTileIDs=new Yt,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(l,p,b){let S=this.layerIndexes[l.id];S===void 0&&(S=this.layerIndexes[l.id]=new Ie);let k=!1;const R={};S.handleWrapJump(b);for(const W of p){const Z=W.getBucket(l);Z&&l.id===Z.layerIds[0]&&(Z.bucketInstanceId||(Z.bucketInstanceId=++this.maxBucketInstanceId),S.addBucket(W.tileID,Z,this.crossTileIDs)&&(k=!0),R[Z.bucketInstanceId]=!0)}return S.removeStaleBuckets(R)&&(k=!0),k}pruneUnusedLayers(l){const p={};l.forEach(b=>{p[b]=!0});for(const b in this.layerIndexes)p[b]||delete this.layerIndexes[b]}}var Tt="void main() {fragColor=vec4(1.0);}";const Ft={prelude:Dt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Dt("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Dt("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Dt(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Dt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Dt(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Dt(Tt,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Dt(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Dt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Dt("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Dt("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:Dt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:Dt("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Dt(Tt,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Dt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Dt(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Dt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Dt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Dt(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Dt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Dt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Dt(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Dt(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Dt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Dt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Dt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Dt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Dt(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Dt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Dt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Dt("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Dt("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Dt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Dt("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Dt(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Dt("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Dt(A,l){const p=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,b=l.match(/in ([\w]+) ([\w]+)/g),S=A.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),k=l.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),R=k?k.concat(S):S,W={};return{fragmentSource:A=A.replace(p,(Z,ie,ce,xe,be)=>(W[be]=!0,ie==="define"?`
#ifndef HAS_UNIFORM_u_${be}
in ${ce} ${xe} ${be};
#else
uniform ${ce} ${xe} u_${be};
#endif
`:`
#ifdef HAS_UNIFORM_u_${be}
    ${ce} ${xe} ${be} = u_${be};
#endif
`)),vertexSource:l=l.replace(p,(Z,ie,ce,xe,be)=>{const Ae=xe==="float"?"vec2":"vec4",Ue=be.match(/color/)?"color":Ae;return W[be]?ie==="define"?`
#ifndef HAS_UNIFORM_u_${be}
uniform lowp float u_${be}_t;
in ${ce} ${Ae} a_${be};
out ${ce} ${xe} ${be};
#else
uniform ${ce} ${xe} u_${be};
#endif
`:Ue==="vec4"?`
#ifndef HAS_UNIFORM_u_${be}
    ${be} = a_${be};
#else
    ${ce} ${xe} ${be} = u_${be};
#endif
`:`
#ifndef HAS_UNIFORM_u_${be}
    ${be} = unpack_mix_${Ue}(a_${be}, u_${be}_t);
#else
    ${ce} ${xe} ${be} = u_${be};
#endif
`:ie==="define"?`
#ifndef HAS_UNIFORM_u_${be}
uniform lowp float u_${be}_t;
in ${ce} ${Ae} a_${be};
#else
uniform ${ce} ${xe} u_${be};
#endif
`:Ue==="vec4"?`
#ifndef HAS_UNIFORM_u_${be}
    ${ce} ${xe} ${be} = a_${be};
#else
    ${ce} ${xe} ${be} = u_${be};
#endif
`:`
#ifndef HAS_UNIFORM_u_${be}
    ${ce} ${xe} ${be} = unpack_mix_${Ue}(a_${be}, u_${be}_t);
#else
    ${ce} ${xe} ${be} = u_${be};
#endif
`}),staticAttributes:b,staticUniforms:R}}class yr{constructor(l,p,b){this.vertexBuffer=l,this.indexBuffer=p,this.segments=b}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var Vr=a.aJ([{name:"a_pos",type:"Int16",components:2}]);const en="#define PROJECTION_MERCATOR",Qr="mercator";class Dr{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Qr}get shaderDefine(){return en}get shaderPreludeCode(){return Ft.projectionMercator}get vertexShaderPreludeCode(){return Ft.projectionMercator.vertexSource}get subdivisionGranularity(){return a.aK.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(l){}getMeshFromTileID(l,p,b,S,k){if(this._cachedMesh)return this._cachedMesh;const R=new a.aL;R.emplaceBack(0,0),R.emplaceBack(a.$,0),R.emplaceBack(0,a.$),R.emplaceBack(a.$,a.$);const W=l.createVertexBuffer(R,Vr.members),Z=a.aM.simpleSegment(0,0,4,2),ie=new a.aN;ie.emplaceBack(1,0,2),ie.emplaceBack(1,2,3);const ce=l.createIndexBuffer(ie);return this._cachedMesh=new yr(W,ce,Z),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(l){}}class Ln{constructor(l=0,p=0,b=0,S=0){if(isNaN(l)||l<0||isNaN(p)||p<0||isNaN(b)||b<0||isNaN(S)||S<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=l,this.bottom=p,this.left=b,this.right=S}interpolate(l,p,b){return p.top!=null&&l.top!=null&&(this.top=a.C.number(l.top,p.top,b)),p.bottom!=null&&l.bottom!=null&&(this.bottom=a.C.number(l.bottom,p.bottom,b)),p.left!=null&&l.left!=null&&(this.left=a.C.number(l.left,p.left,b)),p.right!=null&&l.right!=null&&(this.right=a.C.number(l.right,p.right,b)),this}getCenter(l,p){const b=a.ah((this.left+l-this.right)/2,0,l),S=a.ah((this.top+p-this.bottom)/2,0,p);return new a.P(b,S)}equals(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right}clone(){return new Ln(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Ii(A,l){if(!A.renderWorldCopies||A.lngRange)return;const p=l.lng-A.center.lng;l.lng+=p>180?-360:p<-180?360:0}function vi(A){return Math.max(0,Math.floor(A))}class Ai{constructor(l,p,b,S,k,R){this._callbacks=l,this._tileSize=512,this._renderWorldCopies=R===void 0||!!R,this._minZoom=p||0,this._maxZoom=b||22,this._minPitch=S??0,this._maxPitch=k??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new a.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=vi(this._zoom),this._scale=a.af(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Ln,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(l,p,b){this._latRange=l.latRange,this._lngRange=l.lngRange,this._width=l.width,this._height=l.height,this._center=l.center,this._elevation=l.elevation,this._minElevationForCurrentTile=l.minElevationForCurrentTile,this._zoom=l.zoom,this._tileZoom=vi(this._zoom),this._scale=a.af(this._zoom),this._bearingInRadians=l.bearingInRadians,this._fovInRadians=l.fovInRadians,this._pitchInRadians=l.pitchInRadians,this._rollInRadians=l.rollInRadians,this._unmodified=l.unmodified,this._edgeInsets=new Ln(l.padding.top,l.padding.bottom,l.padding.left,l.padding.right),this._minZoom=l.minZoom,this._maxZoom=l.maxZoom,this._minPitch=l.minPitch,this._maxPitch=l.maxPitch,this._renderWorldCopies=l.renderWorldCopies,this._cameraToCenterDistance=l.cameraToCenterDistance,this._nearZ=l.nearZ,this._farZ=l.farZ,this._autoCalculateNearFarZ=!b&&l.autoCalculateNearFarZ,p&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(l){this._minElevationForCurrentTile=l}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(l){this._minZoom!==l&&(this._minZoom=l,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(l){this._maxZoom!==l&&(this._maxZoom=l,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(l){this._minPitch!==l&&(this._minPitch=l,this.setPitch(Math.max(this.pitch,l)))}get maxPitch(){return this._maxPitch}setMaxPitch(l){this._maxPitch!==l&&(this._maxPitch=l,this.setPitch(Math.min(this.pitch,l)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(l){l===void 0?l=!0:l===null&&(l=!1),this._renderWorldCopies=l}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(l){const p=a.aO(l,-180,180)*Math.PI/180;var b,S,k,R,W,Z,ie,ce,xe;this._bearingInRadians!==p&&(this._unmodified=!1,this._bearingInRadians=p,this._calcMatrices(),this._rotationMatrix=d(),b=this._rotationMatrix,k=-this._bearingInRadians,R=(S=this._rotationMatrix)[0],W=S[1],Z=S[2],ie=S[3],ce=Math.sin(k),xe=Math.cos(k),b[0]=R*xe+Z*ce,b[1]=W*xe+ie*ce,b[2]=R*-ce+Z*xe,b[3]=W*-ce+ie*xe)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(l){const p=a.ah(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==p&&(this._unmodified=!1,this._pitchInRadians=p,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(l){const p=l/180*Math.PI;this._rollInRadians!==p&&(this._unmodified=!1,this._rollInRadians=p,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return a.aP(this._fovInRadians)}setFov(l){l=a.ah(l,.1,150),this.fov!==l&&(this._unmodified=!1,this._fovInRadians=a.ae(l),this._calcMatrices())}get zoom(){return this._zoom}setZoom(l){const p=this.getConstrained(this._center,l).zoom;this._zoom!==p&&(this._unmodified=!1,this._zoom=p,this._tileZoom=Math.max(0,Math.floor(p)),this._scale=a.af(p),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(l){l!==this._elevation&&(this._elevation=l,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(l,p){this._autoCalculateNearFarZ=!1,this._nearZ=l,this._farZ=p,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(l){return this._edgeInsets.equals(l)}interpolatePadding(l,p,b){this._unmodified=!1,this._edgeInsets.interpolate(l,p,b),this._constrain(),this._calcMatrices()}resize(l,p,b=!0){this._width=l,this._height=p,b&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new ke([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(l){l?(this._lngRange=[l.getWest(),l.getEast()],this._latRange=[l.getSouth(),l.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-a.ai,a.ai])}getConstrained(l,p){return this._callbacks.getConstrained(l,p)}getCameraQueryGeometry(l,p){if(p.length===1)return[p[0],l];{const{minX:b,minY:S,maxX:k,maxY:R}=a.a2.fromPoints(p).extend(l);return[new a.P(b,S),new a.P(k,S),new a.P(k,R),new a.P(b,R),new a.P(b,S)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const l=this._unmodified,{center:p,zoom:b}=this.getConstrained(this.center,this.zoom);this.setCenter(p),this.setZoom(b),this._unmodified=l,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let l=a.ag(new Float64Array(16));a.N(l,l,[this._width/2,-this._height/2,1]),a.M(l,l,[1,-1,0]),this._clipSpaceToPixelsMatrix=l,l=a.ag(new Float64Array(16)),a.N(l,l,[1,-1,1]),a.M(l,l,[-1,-1,0]),a.N(l,l,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=l,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(l,p,b,S){const k=b!==void 0?b:this.bearing,R=S=S!==void 0?S:this.pitch,W=a.a1.fromLngLat(l,p),Z=-Math.cos(a.ae(R)),ie=Math.sin(a.ae(R)),ce=ie*Math.sin(a.ae(k)),xe=-ie*Math.cos(a.ae(k));let be=this.elevation;const Ae=p-be;let Ue;Z*Ae>=0||Math.abs(Z)<.1?(Ue=1e4,be=p+Ue*Z):Ue=-Ae/Z;let lt,it,ft=a.aQ(1,W.y),gt=0;do{if(gt+=1,gt>10)break;it=Ue/ft,lt=new a.a1(W.x+ce*it,W.y+xe*it),ft=1/lt.meterInMercatorCoordinateUnits()}while(Math.abs(Ue-it*ft)>1e-12);return{center:lt.toLngLat(),elevation:be,zoom:a.ak(this.height/2/Math.tan(this.fovInRadians/2)/it/this.tileSize)}}recalculateZoomAndCenter(l){if(this.elevation-l==0)return;const p=a.aj(1,this.center.lat)*this.worldSize,b=this.cameraToCenterDistance/p,S=a.a1.fromLngLat(this.center,this.elevation),k=Vt(this.center,this.elevation,this.pitch,this.bearing,b);this._elevation=l;const R=this.calculateCenterFromCameraLngLatAlt(k.toLngLat(),a.aQ(k.z,S.y),this.bearing,this.pitch);this._elevation=R.elevation,this._center=R.center,this.setZoom(R.zoom)}getCameraPoint(){const l=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.P(l*Math.sin(this.rollInRadians),l*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const l=a.aj(1,this.center.lat)*this.worldSize;return Vt(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/l).toLngLat()}getMercatorTileCoordinates(l){if(!l)return[0,0,1,1];const p=l.canonical.z>=0?1<<l.canonical.z:Math.pow(2,l.canonical.z);return[l.canonical.x/p,l.canonical.y/p,1/p/a.$,1/p/a.$]}}class rn{constructor(l,p){this.min=l,this.max=p,this.center=a.aR([],a.aS([],this.min,this.max),.5)}quadrant(l){const p=[l%2==0,l<2],b=a.aT(this.min),S=a.aT(this.max);for(let k=0;k<p.length;k++)b[k]=p[k]?this.min[k]:this.center[k],S[k]=p[k]?this.center[k]:this.max[k];return S[2]=this.max[2],new rn(b,S)}distanceX(l){return Math.max(Math.min(this.max[0],l[0]),this.min[0])-l[0]}distanceY(l){return Math.max(Math.min(this.max[1],l[1]),this.min[1])-l[1]}intersectsFrustum(l){let p=!0;for(let b=0;b<l.planes.length;b++){const S=this.intersectsPlane(l.planes[b]);if(S===0)return 0;S===1&&(p=!1)}return p?2:l.aabb.min[0]>this.max[0]||l.aabb.min[1]>this.max[1]||l.aabb.min[2]>this.max[2]||l.aabb.max[0]<this.min[0]||l.aabb.max[1]<this.min[1]||l.aabb.max[2]<this.min[2]?0:1}intersectsPlane(l){let p=l[3],b=l[3];for(let S=0;S<3;S++)l[S]>0?(p+=l[S]*this.min[S],b+=l[S]*this.max[S]):(b+=l[S]*this.min[S],p+=l[S]*this.max[S]);return p>=0?2:b<0?0:1}}class Xi{distanceToTile2d(l,p,b,S){const k=S.distanceX([l,p]),R=S.distanceY([l,p]);return Math.hypot(k,R)}getWrap(l,p,b){return b}getTileBoundingVolume(l,p,b,S){var k,R;let W=0,Z=0;if(S!=null&&S.terrain){const ce=new a.Z(l.z,p,l.z,l.x,l.y),xe=S.terrain.getMinMaxElevation(ce);W=(k=xe.minElevation)!==null&&k!==void 0?k:Math.min(0,b),Z=(R=xe.maxElevation)!==null&&R!==void 0?R:Math.max(0,b)}const ie=1<<l.z;return new rn([p+l.x/ie,l.y/ie,W],[p+(l.x+1)/ie,(l.y+1)/ie,Z])}allowVariableZoom(l,p){const b=l.fov*(Math.abs(Math.cos(l.rollInRadians))*l.height+Math.abs(Math.sin(l.rollInRadians))*l.width)/l.height,S=a.ah(78.5-b/2,0,60);return!!p.terrain||l.pitch>S}allowWorldCopies(){return!0}prepareNextFrame(){}}class Oi{constructor(l,p,b){this.points=l,this.planes=p,this.aabb=b}static fromInvProjectionMatrix(l,p=1,b=0,S,k){const R=k?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],W=Math.pow(2,b),Z=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(be=>function(Ae,Ue,lt,it){const ft=a.aw([],Ae,Ue),gt=1/ft[3]/lt*it;return a.aY(ft,ft,[gt,gt,1/ft[3],gt])}(be,l,p,W));S&&function(be,Ae,Ue,lt){const it=lt?4:0,ft=lt?0:4;let gt=0;const Et=[],Mt=[];for(let St=0;St<4;St++){const Wt=a.aU([],be[St+ft],be[St+it]),ur=a.aZ(Wt);a.aR(Wt,Wt,1/ur),Et.push(ur),Mt.push(Wt)}for(let St=0;St<4;St++){const Wt=a.a_(be[St+it],Mt[St],Ue);gt=Wt!==null&&Wt>=0?Math.max(gt,Wt):Math.max(gt,Et[St])}const It=function(St,Wt){const ur=a.aU([],St[Wt[0]],St[Wt[1]]),Jt=a.aU([],St[Wt[2]],St[Wt[1]]),nr=[0,0,0,0];return a.aV(nr,a.aW([],ur,Jt)),nr[3]=-a.aX(nr,St[Wt[0]]),nr}(be,Ae),jt=function(St,Wt){const ur=a.a$(St),Jt=a.b0([],St,1/ur),nr=a.aU([],Wt,a.aR([],Jt,a.aX(Wt,Jt))),cr=a.a$(nr);if(cr>0){const Gr=Math.sqrt(1-Jt[3]*Jt[3]),Yr=a.aR([],Jt,-Jt[3]),$r=a.aS([],Yr,a.aR([],nr,Gr/cr));return a.b1(Wt,$r)}return null}(Ue,It);if(jt!==null){const St=jt/a.aX(Mt[0],It);gt=Math.min(gt,St)}for(let St=0;St<4;St++){const Wt=Math.min(gt,Et[St]);be[St+ft]=[be[St+it][0]+Mt[St][0]*Wt,be[St+it][1]+Mt[St][1]*Wt,be[St+it][2]+Mt[St][2]*Wt,1]}}(Z,R[0],S,k);const ie=R.map(be=>{const Ae=a.aU([],Z[be[0]],Z[be[1]]),Ue=a.aU([],Z[be[2]],Z[be[1]]),lt=a.aV([],a.aW([],Ae,Ue)),it=-a.aX(lt,Z[be[1]]);return lt.concat(it)}),ce=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],xe=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const be of Z)for(let Ae=0;Ae<3;Ae++)ce[Ae]=Math.min(ce[Ae],be[Ae]),xe[Ae]=Math.max(xe[Ae],be[Ae]);return new Oi(Z,ie,new rn(ce,xe))}}class ri{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(l){this._helper.setMinZoom(l)}setMaxZoom(l){this._helper.setMaxZoom(l)}setMinPitch(l){this._helper.setMinPitch(l)}setMaxPitch(l){this._helper.setMaxPitch(l)}setRenderWorldCopies(l){this._helper.setRenderWorldCopies(l)}setBearing(l){this._helper.setBearing(l)}setPitch(l){this._helper.setPitch(l)}setRoll(l){this._helper.setRoll(l)}setFov(l){this._helper.setFov(l)}setZoom(l){this._helper.setZoom(l)}setCenter(l){this._helper.setCenter(l)}setElevation(l){this._helper.setElevation(l)}setMinElevationForCurrentTile(l){this._helper.setMinElevationForCurrentTile(l)}setPadding(l){this._helper.setPadding(l)}interpolatePadding(l,p,b){return this._helper.interpolatePadding(l,p,b)}isPaddingEqual(l){return this._helper.isPaddingEqual(l)}resize(l,p,b=!0){this._helper.resize(l,p,b)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(l){this._helper.setMaxBounds(l)}overrideNearFarZ(l,p){this._helper.overrideNearFarZ(l,p)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(l){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),l)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(l,p){}constructor(l,p,b,S,k){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new Ai({calcMatrices:()=>{this._calcMatrices()},getConstrained:(R,W)=>this.getConstrained(R,W)},l,p,b,S,k),this._coveringTilesDetailsProvider=new Xi}clone(){const l=new ri;return l.apply(this),l}apply(l,p,b){this._helper.apply(l,p,b)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(l){const p=[new a.b2(0,l)];if(this._helper._renderWorldCopies){const b=this.screenPointToMercatorCoordinate(new a.P(0,0)),S=this.screenPointToMercatorCoordinate(new a.P(this._helper._width,0)),k=this.screenPointToMercatorCoordinate(new a.P(this._helper._width,this._helper._height)),R=this.screenPointToMercatorCoordinate(new a.P(0,this._helper._height)),W=Math.floor(Math.min(b.x,S.x,k.x,R.x)),Z=Math.floor(Math.max(b.x,S.x,k.x,R.x)),ie=1;for(let ce=W-ie;ce<=Z+ie;ce++)ce!==0&&p.push(new a.b2(ce,l))}return p}getCameraFrustum(){return Oi.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(l){const p=this.screenPointToLocation(this.centerPoint,l),b=l?l.getElevationForLngLatZoom(p,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(b)}setLocationAtPoint(l,p){const b=a.aj(this.elevation,this.center.lat),S=this.screenPointToMercatorCoordinateAtZ(p,b),k=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,b),R=a.a1.fromLngLat(l),W=new a.a1(R.x-(S.x-k.x),R.y-(S.y-k.y));this.setCenter(W==null?void 0:W.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(l,p){return p?this.coordinatePoint(a.a1.fromLngLat(l),p.getElevationForLngLatZoom(l,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(a.a1.fromLngLat(l))}screenPointToLocation(l,p){var b;return(b=this.screenPointToMercatorCoordinate(l,p))===null||b===void 0?void 0:b.toLngLat()}screenPointToMercatorCoordinate(l,p){if(p){const b=p.pointCoordinate(l);if(b!=null)return b}return this.screenPointToMercatorCoordinateAtZ(l)}screenPointToMercatorCoordinateAtZ(l,p){const b=p||0,S=[l.x,l.y,0,1],k=[l.x,l.y,1,1];a.aw(S,S,this._pixelMatrixInverse),a.aw(k,k,this._pixelMatrixInverse);const R=S[3],W=k[3],Z=S[1]/R,ie=k[1]/W,ce=S[2]/R,xe=k[2]/W,be=ce===xe?0:(b-ce)/(xe-ce);return new a.a1(a.C.number(S[0]/R,k[0]/W,be)/this.worldSize,a.C.number(Z,ie,be)/this.worldSize,b)}coordinatePoint(l,p=0,b=this._pixelMatrix){const S=[l.x*this.worldSize,l.y*this.worldSize,p,1];return a.aw(S,S,b),new a.P(S[0]/S[3],S[1]/S[3])}getBounds(){const l=Math.max(0,this._helper._height/2-dt(this));return new ke().extend(this.screenPointToLocation(new a.P(0,l))).extend(this.screenPointToLocation(new a.P(this._helper._width,l))).extend(this.screenPointToLocation(new a.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new a.P(0,this._helper._height)))}isPointOnMapSurface(l,p){return p?p.pointCoordinate(l)!=null:l.y>this.height/2-dt(this)}calculatePosMatrix(l,p=!1,b){var S;const k=(S=l.key)!==null&&S!==void 0?S:a.b3(l.wrap,l.canonical.z,l.canonical.z,l.canonical.x,l.canonical.y),R=p?this._alignedPosMatrixCache:this._posMatrixCache;if(R.has(k)){const ie=R.get(k);return b?ie.f32:ie.f64}const W=Pt(l,this.worldSize);a.O(W,p?this._alignedProjMatrix:this._viewProjMatrix,W);const Z={f64:W,f32:new Float32Array(W)};return R.set(k,Z),b?Z.f32:Z.f64}calculateFogMatrix(l){const p=l.key,b=this._fogMatrixCacheF32;if(b.has(p))return b.get(p);const S=Pt(l,this.worldSize);return a.O(S,this._fogMatrix,S),b.set(p,new Float32Array(S)),b.get(p)}getConstrained(l,p){p=a.ah(+p,this.minZoom,this.maxZoom);const b={center:new a.S(l.lng,l.lat),zoom:p};let S=this._helper._lngRange;if(!this._helper._renderWorldCopies&&S===null){const Et=179.9999999999;S=[-Et,Et]}const k=this.tileSize*a.af(b.zoom);let R=0,W=k,Z=0,ie=k,ce=0,xe=0;const{x:be,y:Ae}=this.size;if(this._helper._latRange){const Et=this._helper._latRange;R=a.U(Et[1])*k,W=a.U(Et[0])*k,W-R<Ae&&(ce=Ae/(W-R))}S&&(Z=a.aO(a.V(S[0])*k,0,k),ie=a.aO(a.V(S[1])*k,0,k),ie<Z&&(ie+=k),ie-Z<be&&(xe=be/(ie-Z)));const{x:Ue,y:lt}=Ve(k,l);let it,ft;const gt=Math.max(xe||0,ce||0);if(gt){const Et=new a.P(xe?(ie+Z)/2:Ue,ce?(W+R)/2:lt);return b.center=Qe(k,Et).wrap(),b.zoom+=a.ak(gt),b}if(this._helper._latRange){const Et=Ae/2;lt-Et<R&&(ft=R+Et),lt+Et>W&&(ft=W-Et)}if(S){const Et=(Z+ie)/2;let Mt=Ue;this._helper._renderWorldCopies&&(Mt=a.aO(Ue,Et-k/2,Et+k/2));const It=be/2;Mt-It<Z&&(it=Z+It),Mt+It>ie&&(it=ie-It)}if(it!==void 0||ft!==void 0){const Et=new a.P(it??Ue,ft??lt);b.center=Qe(k,Et).wrap()}return b}calculateCenterFromCameraLngLatAlt(l,p,b,S){return this._helper.calculateCenterFromCameraLngLatAlt(l,p,b,S)}_calculateNearFarZIfNeeded(l,p,b){if(!this._helper.autoCalculateNearFarZ)return;const S=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),k=l-S*this._helper._pixelPerMeter/Math.cos(p),R=S<0?k:l,W=Math.PI/2+this.pitchInRadians,Z=a.ae(this.fov)*(Math.abs(Math.cos(a.ae(this.roll)))*this.height+Math.abs(Math.sin(a.ae(this.roll)))*this.width)/this.height*(.5+b.y/this.height),ie=Math.sin(Z)*R/Math.sin(a.ah(Math.PI-W-Z,.01,Math.PI-.01)),ce=dt(this),xe=Math.atan(ce/this._helper.cameraToCenterDistance),be=a.ae(.75),Ae=xe>be?2*xe*(.5+b.y/(2*ce)):be,Ue=Math.sin(Ae)*R/Math.sin(a.ah(Math.PI-W-Ae,.01,Math.PI-.01)),lt=Math.min(ie,Ue);this._helper._farZ=1.01*(Math.cos(Math.PI/2-p)*lt+R),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const l=this.centerOffset,p=Ve(this.worldSize,this.center),b=p.x,S=p.y;this._helper._pixelPerMeter=a.aj(1,this.center.lat)*this.worldSize;const k=a.ae(Math.min(this.pitch,Pe)),R=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(k));let W;this._calculateNearFarZIfNeeded(R,k,l),W=new Float64Array(16),a.b4(W,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),a.aq(this._invProjMatrix,W),W[8]=2*-l.x/this._helper._width,W[9]=2*l.y/this._helper._height,this._projectionMatrix=a.b5(W),a.N(W,W,[1,-1,1]),a.M(W,W,[0,0,-this._helper.cameraToCenterDistance]),a.b6(W,W,-this.rollInRadians),a.b7(W,W,this.pitchInRadians),a.b6(W,W,-this.bearingInRadians),a.M(W,W,[-b,-S,0]),this._mercatorMatrix=a.N([],W,[this.worldSize,this.worldSize,this.worldSize]),a.N(W,W,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=a.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,W),a.M(W,W,[0,0,-this.elevation]),this._viewProjMatrix=W,this._invViewProjMatrix=a.aq([],W);const Z=[0,0,-1,1];a.aw(Z,Z,this._invViewProjMatrix),this._cameraPosition=[Z[0]/Z[3],Z[1]/Z[3],Z[2]/Z[3]],this._fogMatrix=new Float64Array(16),a.b4(this._fogMatrix,this.fovInRadians,this.width/this.height,R,this._helper._farZ),this._fogMatrix[8]=2*-l.x/this.width,this._fogMatrix[9]=2*l.y/this.height,a.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),a.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),a.b6(this._fogMatrix,this._fogMatrix,-this.rollInRadians),a.b7(this._fogMatrix,this._fogMatrix,this.pitchInRadians),a.b6(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),a.M(this._fogMatrix,this._fogMatrix,[-b,-S,0]),a.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),a.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=a.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,W);const ie=this._helper._width%2/2,ce=this._helper._height%2/2,xe=Math.cos(this.bearingInRadians),be=Math.sin(-this.bearingInRadians),Ae=b-Math.round(b)+xe*ie+be*ce,Ue=S-Math.round(S)+xe*ce+be*ie,lt=new Float64Array(W);if(a.M(lt,lt,[Ae>.5?Ae-1:Ae,Ue>.5?Ue-1:Ue,0]),this._alignedProjMatrix=lt,W=a.aq(new Float64Array(16),this._pixelMatrix),!W)throw new Error("failed to invert matrix");this._pixelMatrixInverse=W,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const l=this.screenPointToMercatorCoordinate(new a.P(0,0)),p=[l.x*this.worldSize,l.y*this.worldSize,0,1];return a.aw(p,p,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const l=a.aj(1,this.center.lat)*this.worldSize;return Vt(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/l).toLngLat()}lngLatToCameraDepth(l,p){const b=a.a1.fromLngLat(l),S=[b.x*this.worldSize,b.y*this.worldSize,p,1];return a.aw(S,S,this._viewProjMatrix),S[2]/S[3]}getProjectionData(l){const{overscaledTileID:p,aligned:b,applyTerrainMatrix:S}=l,k=this._helper.getMercatorTileCoordinates(p),R=p?this.calculatePosMatrix(p,b,!0):null;let W;return W=p&&p.terrainRttPosMatrix32f&&S?p.terrainRttPosMatrix32f:R||a.b8(),{mainMatrix:W,tileMercatorCoords:k,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:W}}isLocationOccluded(l){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(l,p,b){return 1}transformLightDirection(l){return a.aT(l)}getRayDirectionFromPixel(l){throw new Error("Not implemented.")}projectTileCoordinates(l,p,b,S){const k=this.calculatePosMatrix(b);let R;S?(R=[l,p,S(l,p),1],a.aw(R,R,k)):(R=[l,p,0,1],ra(R,R,k));const W=R[3];return{point:new a.P(R[0]/W,R[1]/W),signedDistanceFromCamera:W,isOccluded:!1}}populateCache(l){for(const p of l)this.calculatePosMatrix(p)}getMatrixForModel(l,p){const b=a.a1.fromLngLat(l,p),S=b.meterInMercatorCoordinateUnits(),k=a.b9();return a.M(k,k,[b.x,b.y,b.z]),a.b6(k,k,Math.PI),a.b7(k,k,Math.PI/2),a.N(k,k,[-S,S,S]),k}getProjectionDataForCustomLayer(l=!0){const p=new a.Z(0,0,0,0,0),b=this.getProjectionData({overscaledTileID:p,applyGlobeMatrix:l}),S=Pt(p,this.worldSize);a.O(S,this._viewProjMatrix,S),b.tileMercatorCoords=[0,0,1,1];const k=[a.$,a.$,this.worldSize/this._helper.pixelsPerMeter],R=a.ba();return a.N(R,S,k),b.fallbackMatrix=R,b.mainMatrix=R,b}getFastPathSimpleProjectionMatrix(l){return this.calculatePosMatrix(l)}}function ma(){a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Ri(A){if(A.useSlerp)if(A.k<1){const l=a.bb(A.startEulerAngles.roll,A.startEulerAngles.pitch,A.startEulerAngles.bearing),p=a.bb(A.endEulerAngles.roll,A.endEulerAngles.pitch,A.endEulerAngles.bearing),b=new Float64Array(4);a.bc(b,l,p,A.k);const S=a.bd(b);A.tr.setRoll(S.roll),A.tr.setPitch(S.pitch),A.tr.setBearing(S.bearing)}else A.tr.setRoll(A.endEulerAngles.roll),A.tr.setPitch(A.endEulerAngles.pitch),A.tr.setBearing(A.endEulerAngles.bearing);else A.tr.setRoll(a.C.number(A.startEulerAngles.roll,A.endEulerAngles.roll,A.k)),A.tr.setPitch(a.C.number(A.startEulerAngles.pitch,A.endEulerAngles.pitch,A.k)),A.tr.setBearing(a.C.number(A.startEulerAngles.bearing,A.endEulerAngles.bearing,A.k))}function lo(A,l,p,b,S){const k=S.padding,R=Ve(S.worldSize,p.getNorthWest()),W=Ve(S.worldSize,p.getNorthEast()),Z=Ve(S.worldSize,p.getSouthEast()),ie=Ve(S.worldSize,p.getSouthWest()),ce=a.ae(-b),xe=R.rotate(ce),be=W.rotate(ce),Ae=Z.rotate(ce),Ue=ie.rotate(ce),lt=new a.P(Math.max(xe.x,be.x,Ue.x,Ae.x),Math.max(xe.y,be.y,Ue.y,Ae.y)),it=new a.P(Math.min(xe.x,be.x,Ue.x,Ae.x),Math.min(xe.y,be.y,Ue.y,Ae.y)),ft=lt.sub(it),gt=(S.width-(k.left+k.right+l.left+l.right))/ft.x,Et=(S.height-(k.top+k.bottom+l.top+l.bottom))/ft.y;if(Et<0||gt<0)return void ma();const Mt=Math.min(a.ak(S.scale*Math.min(gt,Et)),A.maxZoom),It=a.P.convert(A.offset),jt=new a.P((l.left-l.right)/2,(l.top-l.bottom)/2).rotate(a.ae(b)),St=It.add(jt).mult(S.scale/a.af(Mt));return{center:Qe(S.worldSize,R.add(Z).div(2).sub(St)),zoom:Mt,bearing:b}}class Mi{get useGlobeControls(){return!1}handlePanInertia(l,p){return{easingOffset:l,easingCenter:p.center}}handleMapControlsRollPitchBearingZoom(l,p){l.bearingDelta&&p.setBearing(p.bearing+l.bearingDelta),l.pitchDelta&&p.setPitch(p.pitch+l.pitchDelta),l.rollDelta&&p.setRoll(p.roll+l.rollDelta),l.zoomDelta&&p.setZoom(p.zoom+l.zoomDelta)}handleMapControlsPan(l,p,b){l.around.distSqr(p.centerPoint)<.01||p.setLocationAtPoint(b,l.around)}cameraForBoxAndBearing(l,p,b,S,k){return lo(l,p,b,S,k)}handleJumpToCenterZoom(l,p){l.zoom!==(p.zoom!==void 0?+p.zoom:l.zoom)&&l.setZoom(+p.zoom),p.center!==void 0&&l.setCenter(a.S.convert(p.center))}handleEaseTo(l,p){const b=l.zoom,S=l.padding,k={roll:l.roll,pitch:l.pitch,bearing:l.bearing},R={roll:p.roll===void 0?l.roll:p.roll,pitch:p.pitch===void 0?l.pitch:p.pitch,bearing:p.bearing===void 0?l.bearing:p.bearing},W=p.zoom!==void 0,Z=!l.isPaddingEqual(p.padding);let ie=!1;const ce=W?+p.zoom:l.zoom;let xe=l.centerPoint.add(p.offsetAsPoint);const be=l.screenPointToLocation(xe),{center:Ae,zoom:Ue}=l.getConstrained(a.S.convert(p.center||be),ce??b);Ii(l,Ae);const lt=Ve(l.worldSize,be),it=Ve(l.worldSize,Ae).sub(lt),ft=a.af(Ue-b);return ie=Ue!==b,{easeFunc:gt=>{if(ie&&l.setZoom(a.C.number(b,Ue,gt)),a.be(k,R)||Ri({startEulerAngles:k,endEulerAngles:R,tr:l,k:gt,useSlerp:k.roll!=R.roll}),Z&&(l.interpolatePadding(S,p.padding,gt),xe=l.centerPoint.add(p.offsetAsPoint)),p.around)l.setLocationAtPoint(p.around,p.aroundPoint);else{const Et=a.af(l.zoom-b),Mt=Ue>b?Math.min(2,ft):Math.max(.5,ft),It=Math.pow(Mt,1-gt),jt=Qe(l.worldSize,lt.add(it.mult(gt*It)).mult(Et));l.setLocationAtPoint(l.renderWorldCopies?jt.wrap():jt,xe)}},isZooming:ie,elevationCenter:Ae}}handleFlyTo(l,p){const b=p.zoom!==void 0,S=l.zoom,k=l.getConstrained(a.S.convert(p.center||p.locationAtOffset),b?+p.zoom:S),R=k.center,W=k.zoom;Ii(l,R);const Z=Ve(l.worldSize,p.locationAtOffset),ie=Ve(l.worldSize,R).sub(Z),ce=ie.mag(),xe=a.af(W-S);let be;if(p.minZoom!==void 0){const Ae=Math.min(+p.minZoom,S,W),Ue=l.getConstrained(R,Ae).zoom;be=a.af(Ue-S)}return{easeFunc:(Ae,Ue,lt,it)=>{l.setZoom(Ae===1?W:S+a.ak(Ue));const ft=Ae===1?R:Qe(l.worldSize,Z.add(ie.mult(lt)).mult(Ue));l.setLocationAtPoint(l.renderWorldCopies?ft.wrap():ft,it)},scaleOfZoom:xe,targetCenter:R,scaleOfMinZoom:be,pixelPathLength:ce}}}class di{constructor(l,p,b){this.blendFunction=l,this.blendColor=p,this.mask=b}}di.Replace=[1,0],di.disabled=new di(di.Replace,a.bf.transparent,[!1,!1,!1,!1]),di.unblended=new di(di.Replace,a.bf.transparent,[!0,!0,!0,!0]),di.alphaBlended=new di([1,771],a.bf.transparent,[!0,!0,!0,!0]);const Ho=2305;class bn{constructor(l,p,b){this.enable=l,this.mode=p,this.frontFace=b}}bn.disabled=new bn(!1,1029,Ho),bn.backCCW=new bn(!0,1029,Ho),bn.frontCCW=new bn(!0,1028,Ho);class Nn{constructor(l,p,b){this.func=l,this.mask=p,this.range=b}}Nn.ReadOnly=!1,Nn.ReadWrite=!0,Nn.disabled=new Nn(519,Nn.ReadOnly,[0,1]);const Mo=7680;class ni{constructor(l,p,b,S,k,R){this.test=l,this.ref=p,this.mask=b,this.fail=S,this.depthFail=k,this.pass=R}}ni.disabled=new ni({func:519,mask:0},0,0,Mo,Mo,Mo);const Yi=new WeakMap;function Qi(A){var l;if(Yi.has(A))return Yi.get(A);{const p=(l=A.getParameter(A.VERSION))===null||l===void 0?void 0:l.startsWith("WebGL 2.0");return Yi.set(A,p),p}}class co{get awaitingQuery(){return!!this._readbackQueue}constructor(l){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=l;const p=l.context,b=p.gl;this._texFormat=b.RGBA,this._texType=b.UNSIGNED_BYTE;const S=new a.aL;S.emplaceBack(-1,-1),S.emplaceBack(2,-1),S.emplaceBack(-1,2);const k=new a.aN;k.emplaceBack(0,1,2),this._fullscreenTriangle=new yr(p.createVertexBuffer(S,Vr.members),p.createIndexBuffer(k),a.aM.simpleSegment(0,0,S.length,k.length)),this._resultBuffer=new Uint8Array(4),p.activeTexture.set(b.TEXTURE1);const R=b.createTexture();b.bindTexture(b.TEXTURE_2D,R),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST),b.texImage2D(b.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=p.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(R),Qi(b)&&(this._pbo=b.createBuffer(),b.bindBuffer(b.PIXEL_PACK_BUFFER,this._pbo),b.bufferData(b.PIXEL_PACK_BUFFER,4,b.STREAM_READ),b.bindBuffer(b.PIXEL_PACK_BUFFER,null))}destroy(){const l=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),l.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(l,p){const b=this._updateCount;return this._readbackQueue?b>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():b>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(l,p),this._updateCount++,this._measuredError}_bindFramebuffer(){const l=this._cachedRenderContext.context,p=l.gl;l.activeTexture.set(p.TEXTURE1),p.bindTexture(p.TEXTURE_2D,this._fbo.colorAttachment.get()),l.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(l,p){const b=this._cachedRenderContext.context,S=b.gl;if(this._bindFramebuffer(),b.viewport.set([0,0,this._texWidth,this._texHeight]),b.clear({color:a.bf.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(b,S.TRIANGLES,Nn.disabled,ni.disabled,di.unblended,bn.disabled,((k,R)=>({u_input:k,u_output_expected:R}))(l,p),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Qi(S)){S.bindBuffer(S.PIXEL_PACK_BUFFER,this._pbo),S.readBuffer(S.COLOR_ATTACHMENT0),S.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),S.bindBuffer(S.PIXEL_PACK_BUFFER,null);const k=S.fenceSync(S.SYNC_GPU_COMMANDS_COMPLETE,0);S.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:k}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const l=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Qi(l)){const p=l.clientWaitSync(this._readbackQueue.sync,0,0);if(p===l.WAIT_FAILED)return a.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(p===l.TIMEOUT_EXPIRED)return;l.bindBuffer(l.PIXEL_PACK_BUFFER,this._pbo),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),l.bindBuffer(l.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),l.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=co._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(l){let p=0;return p+=l[0]/256,p+=l[1]/65536,p+=l[2]/16777216,l[3]<127&&(p=-p),p/128}}const po=a.$/128;function ga(A,l){const p=A.granularity!==void 0?Math.max(A.granularity,1):1,b=p+(A.generateBorders?2:0),S=p+(A.extendToNorthPole||A.generateBorders?1:0)+(A.extendToSouthPole||A.generateBorders?1:0),k=b+1,R=S+1,W=A.generateBorders?-1:0,Z=A.generateBorders||A.extendToNorthPole?-1:0,ie=p+(A.generateBorders?1:0),ce=p+(A.generateBorders||A.extendToSouthPole?1:0),xe=k*R,be=b*S*6,Ae=k*R>65536;if(Ae&&l==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const Ue=Ae||l==="32bit",lt=new Int16Array(2*xe);let it=0;for(let Et=Z;Et<=ce;Et++)for(let Mt=W;Mt<=ie;Mt++){let It=Mt/p*a.$;Mt===-1&&(It=-po),Mt===p+1&&(It=a.$+po);let jt=Et/p*a.$;Et===-1&&(jt=A.extendToNorthPole?a.bh:-po),Et===p+1&&(jt=A.extendToSouthPole?a.bi:a.$+po),lt[it++]=It,lt[it++]=jt}const ft=Ue?new Uint32Array(be):new Uint16Array(be);let gt=0;for(let Et=0;Et<S;Et++)for(let Mt=0;Mt<b;Mt++){const It=Mt+1+Et*k,jt=Mt+(Et+1)*k,St=Mt+1+(Et+1)*k;ft[gt++]=Mt+Et*k,ft[gt++]=jt,ft[gt++]=It,ft[gt++]=It,ft[gt++]=jt,ft[gt++]=St}return{vertices:lt.buffer.slice(0),indices:ft.buffer.slice(0),uses32bitIndices:Ue}}const ws=new a.aK({fill:new a.bj(128,2),line:new a.bj(512,0),tile:new a.bj(128,32),stencil:new a.bj(128,1),circle:3});class hl{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Ft.projectionGlobe}get vertexShaderPreludeCode(){return Ft.projectionMercator.vertexSource}get subdivisionGranularity(){return ws}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(l){this._errorMeasurement||(this._errorMeasurement=new co(l));const p=a.U(this._errorQueryLatitudeDegrees),b=2*Math.atan(Math.exp(Math.PI-p*Math.PI*2))-.5*Math.PI,S=this._errorMeasurement.updateErrorLoop(p,b),k=_.now();S!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=S,this._errorMeasurementLastChangeTime=k);const R=Math.min(Math.max((k-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=a.bk(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,a.bl(R))}_getMeshKey(l){return`${l.granularity.toString(36)}_${l.generateBorders?"b":""}${l.extendToNorthPole?"n":""}${l.extendToSouthPole?"s":""}`}getMeshFromTileID(l,p,b,S,k){const R=(k==="stencil"?ws.stencil:ws.tile).getGranularityForZoomLevel(p.z);return this._getMesh(l,{granularity:R,generateBorders:b,extendToNorthPole:p.y===0&&S,extendToSouthPole:p.y===(1<<p.z)-1&&S})}_getMesh(l,p){const b=this._getMeshKey(p);if(b in this._tileMeshCache)return this._tileMeshCache[b];const S=function(k,R){const W=ga(R,"16bit"),Z=a.aL.deserialize({arrayBuffer:W.vertices,length:W.vertices.byteLength/2/2}),ie=a.aN.deserialize({arrayBuffer:W.indices,length:W.indices.byteLength/2/3});return new yr(k.createVertexBuffer(Z,Vr.members),k.createIndexBuffer(ie),a.aM.simpleSegment(0,0,Z.length,ie.length))}(l,p);return this._tileMeshCache[b]=S,S}recalculate(l){}hasTransition(){const l=_.now();let p=!1;return p=p||(l-this._errorMeasurementLastChangeTime)/1e3<.7,p=p||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,p}setErrorQueryLatitudeDegrees(l){this._errorQueryLatitudeDegrees=l}}const fl=new a.r({type:new a.D(a.v.projection.type)});class Yl extends a.E{constructor(l){super(),this._transitionable=new a.t(fl),this.setProjection(l),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new a.F(0)),this._mercatorProjection=new Dr,this._verticalPerspectiveProjection=new hl}get transitionState(){const l=this.properties.get("type");if(typeof l=="string"&&l==="mercator")return 0;if(typeof l=="string"&&l==="vertical-perspective")return 1;if(l instanceof a.bm){if(l.from==="vertical-perspective"&&l.to==="mercator")return 1-l.transition;if(l.from==="mercator"&&l.to==="vertical-perspective")return l.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(l){this._mercatorProjection.updateGPUdependent(l),this._verticalPerspectiveProjection.updateGPUdependent(l)}getMeshFromTileID(l,p,b,S,k){return this.currentProjection.getMeshFromTileID(l,p,b,S,k)}setProjection(l){this._transitionable.setValue("type",(l==null?void 0:l.type)||"mercator")}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}setErrorQueryLatitudeDegrees(l){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(l),this._mercatorProjection.setErrorQueryLatitudeDegrees(l)}}function _c(A){const l=Ss(A.worldSize,A.center.lat);return 2*Math.PI*l}function Ms(A,l,p,b,S){const k=1/(1<<S),R=l/a.$*k+b*k,W=a.bo((A/a.$*k+p*k)*Math.PI*2+Math.PI,2*Math.PI),Z=2*Math.atan(Math.exp(Math.PI-R*Math.PI*2))-.5*Math.PI,ie=Math.cos(Z),ce=new Float64Array(3);return ce[0]=Math.sin(W)*ie,ce[1]=Math.sin(Z),ce[2]=Math.cos(W)*ie,ce}function vo(A){return function(l,p){const b=Math.cos(p),S=new Float64Array(3);return S[0]=Math.sin(l)*b,S[1]=Math.sin(p),S[2]=Math.cos(l)*b,S}(A.lng*Math.PI/180,A.lat*Math.PI/180)}function Ss(A,l){return A/(2*Math.PI)/Math.cos(l*Math.PI/180)}function re(A){const l=Math.asin(A[1])/Math.PI*180,p=Math.sqrt(A[0]*A[0]+A[2]*A[2]);if(p>1e-6){const b=A[0]/p,S=Math.acos(A[2]/p),k=(b>0?S:-S)/Math.PI*180;return new a.S(a.aO(k,-180,180),l)}return new a.S(0,l)}function ze(A){return Math.cos(A*Math.PI/180)}function pt(A,l){const p=ze(A),b=ze(l);return a.ak(b/p)}function Ut(A,l){const p=A.rotate(l.bearingInRadians),b=l.zoom+pt(l.center.lat,0),S=a.bk(1/ze(l.center.lat),1/ze(Math.min(Math.abs(l.center.lat),60)),a.bn(b,7,3,0,1)),k=360/_c({worldSize:l.worldSize,center:{lat:l.center.lat}});return new a.S(l.center.lng-p.x*k*S,a.ah(l.center.lat+p.y*k,-a.ai,a.ai))}function Qt(A){const l=.5*A,p=Math.sin(l),b=Math.cos(l);return Math.log(p+b)-Math.log(b-p)}function Er(A,l,p,b){const S=A.lat+p*b;if(Math.abs(p)>1){const k=(Math.sign(A.lat+p)!==Math.sign(A.lat)?-Math.abs(A.lat):Math.abs(A.lat))*Math.PI/180,R=Math.abs(A.lat+p)*Math.PI/180,W=Qt(k+b*(R-k)),Z=Qt(k),ie=Qt(R);return new a.S(A.lng+l*((W-Z)/(ie-Z)),S)}return new a.S(A.lng+l*b,S)}class jr{constructor(l){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=l}swapBuffers(){if(!this._hadAnyChanges)return;const l=this._cachePrevious;this._cachePrevious=this._cache,this._cache=l,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(l,p,b,S){const k=`${l.z}_${l.x}_${l.y}_${S!=null&&S.terrain?"t":""}`,R=this._cache.get(k);if(R)return R;const W=this._cachePrevious.get(k);if(W)return this._cache.set(k,W),W;const Z=this._boundingVolumeFactory(l,p,b,S);return this._cache.set(k,Z),this._hadAnyChanges=!0,Z}}class Sn{constructor(l,p,b,S){this.min=b,this.max=S,this.points=l,this.planes=p}static fromAabb(l,p){const b=[];for(let S=0;S<8;S++)b.push([1&~S?l[0]:p[0],(S>>1&1)==1?p[1]:l[1],(S>>2&1)==1?p[2]:l[2]]);return new Sn(b,[[-1,0,0,p[0]],[1,0,0,-l[0]],[0,-1,0,p[1]],[0,1,0,-l[1]],[0,0,-1,p[2]],[0,0,1,-l[2]]],l,p)}static fromCenterSizeAngles(l,p,b){const S=a.br([],b[0],b[1],b[2]),k=a.bs([],[p[0],0,0],S),R=a.bs([],[0,p[1],0],S),W=a.bs([],[0,0,p[2]],S),Z=[...l],ie=[...l];for(let xe=0;xe<8;xe++)for(let be=0;be<3;be++){const Ae=l[be]+k[be]*(1&~xe?-1:1)+R[be]*((xe>>1&1)==1?1:-1)+W[be]*((xe>>2&1)==1?1:-1);Z[be]=Math.min(Z[be],Ae),ie[be]=Math.max(ie[be],Ae)}const ce=[];for(let xe=0;xe<8;xe++){const be=[...l];a.aS(be,be,a.aR([],k,1&~xe?-1:1)),a.aS(be,be,a.aR([],R,(xe>>1&1)==1?1:-1)),a.aS(be,be,a.aR([],W,(xe>>2&1)==1?1:-1)),ce.push(be)}return new Sn(ce,[[...k,-a.aX(k,ce[0])],[...R,-a.aX(R,ce[0])],[...W,-a.aX(W,ce[0])],[-k[0],-k[1],-k[2],-a.aX(k,ce[7])],[-R[0],-R[1],-R[2],-a.aX(R,ce[7])],[-W[0],-W[1],-W[2],-a.aX(W,ce[7])]],Z,ie)}intersectsFrustum(l){let p=!0;const b=this.points.length,S=this.planes.length,k=l.planes.length,R=l.points.length;for(let W=0;W<k;W++){const Z=l.planes[W];let ie=0;for(let ce=0;ce<b;ce++){const xe=this.points[ce];Z[0]*xe[0]+Z[1]*xe[1]+Z[2]*xe[2]+Z[3]>=0&&ie++}if(ie===0)return 0;ie<b&&(p=!1)}if(p)return 2;for(let W=0;W<S;W++){const Z=this.planes[W];let ie=0;for(let ce=0;ce<R;ce++){const xe=l.points[ce];Z[0]*xe[0]+Z[1]*xe[1]+Z[2]*xe[2]+Z[3]>=0&&ie++}if(ie===0)return 0}return 1}intersectsPlane(l){const p=this.points.length;let b=0;for(let S=0;S<p;S++){const k=this.points[S];l[0]*k[0]+l[1]*k[1]+l[2]*k[2]+l[3]>=0&&b++}return b===p?2:b===0?0:1}}function vn(A,l,p){const b=A-l;return b<0?-b:Math.max(0,b-p)}function Zn(A,l,p,b,S){const k=A-p;let R;return R=k<0?Math.min(-k,1+k-S):k>1?Math.min(Math.max(k-S,0),1-k):0,Math.max(R,vn(l,b,S))}class Xn{constructor(){this._boundingVolumeCache=new jr(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(l,p,b,S){const k=1<<b.z,R=1/k,W=b.x/k,Z=b.y/k;let ie=2;return ie=Math.min(ie,Zn(l,p,W,Z,R)),ie=Math.min(ie,Zn(l,p,W+.5,-Z-R,R)),ie=Math.min(ie,Zn(l,p,W+.5,2-Z-R,R)),ie}getWrap(l,p,b){const S=1<<p.z,k=1/S,R=p.x/S,W=vn(l.x,R,k),Z=vn(l.x,R-1,k),ie=vn(l.x,R+1,k),ce=Math.min(W,Z,ie);return ce===ie?1:ce===Z?-1:0}allowVariableZoom(l,p){return Jr(l,p)>4}allowWorldCopies(){return!1}getTileBoundingVolume(l,p,b,S){return this._boundingVolumeCache.getTileBoundingVolume(l,p,b,S)}_computeTileBoundingVolume(l,p,b,S){var k,R;let W=0,Z=0;if(S!=null&&S.terrain){const ie=new a.Z(l.z,p,l.z,l.x,l.y),ce=S.terrain.getMinMaxElevation(ie);W=(k=ce.minElevation)!==null&&k!==void 0?k:Math.min(0,b),Z=(R=ce.maxElevation)!==null&&R!==void 0?R:Math.max(0,b)}if(W/=a.bu,Z/=a.bu,W+=1,Z+=1,l.z<=0)return Sn.fromAabb([-Z,-Z,-Z],[Z,Z,Z]);if(l.z===1)return Sn.fromAabb([l.x===0?-Z:0,l.y===0?0:-Z,-Z],[l.x===0?0:Z,l.y===0?Z:0,Z]);{const ie=[Ms(0,0,l.x,l.y,l.z),Ms(a.$,0,l.x,l.y,l.z),Ms(a.$,a.$,l.x,l.y,l.z),Ms(0,a.$,l.x,l.y,l.z)],ce=[];for(const nr of ie)ce.push(a.aR([],nr,Z));if(Z!==W)for(const nr of ie)ce.push(a.aR([],nr,W));l.y===0&&ce.push([0,1,0]),l.y===(1<<l.z)-1&&ce.push([0,-1,0]);const xe=[1,1,1],be=[-1,-1,-1];for(const nr of ce)for(let cr=0;cr<3;cr++)xe[cr]=Math.min(xe[cr],nr[cr]),be[cr]=Math.max(be[cr],nr[cr]);const Ae=Ms(a.$/2,a.$/2,l.x,l.y,l.z),Ue=a.aW([],[0,1,0],Ae);a.aV(Ue,Ue);const lt=a.aW([],Ae,Ue);a.aV(lt,lt);const it=a.aW([],ie[2],ie[1]);a.aV(it,it);const ft=a.aW([],ie[0],ie[3]);a.aV(ft,ft),ce.push(a.aR([],Ae,Z)),l.y>=(1<<l.z)/2&&ce.push(a.aR([],Ms(a.$/2,0,l.x,l.y,l.z),Z)),l.y<(1<<l.z)/2&&ce.push(a.aR([],Ms(a.$/2,a.$,l.x,l.y,l.z),Z));const gt=Ui(Ae,ce),Et=Ui(lt,ce),Mt=[-Ae[0],-Ae[1],-Ae[2],gt.max],It=[Ae[0],Ae[1],Ae[2],-gt.min],jt=[-lt[0],-lt[1],-lt[2],Et.max],St=[lt[0],lt[1],lt[2],-Et.min],Wt=[...it,0],ur=[...ft,0],Jt=[];return l.y===0?Jt.push(a.bt(ur,Wt,Mt),a.bt(ur,Wt,It)):Jt.push(a.bt(jt,Wt,Mt),a.bt(jt,Wt,It),a.bt(jt,ur,Mt),a.bt(jt,ur,It)),l.y===(1<<l.z)-1?Jt.push(a.bt(ur,Wt,Mt),a.bt(ur,Wt,It)):Jt.push(a.bt(St,Wt,Mt),a.bt(St,Wt,It),a.bt(St,ur,Mt),a.bt(St,ur,It)),new Sn(Jt,[Mt,It,jt,St,Wt,ur],xe,be)}}}function Ui(A,l){let p=1/0,b=-1/0;for(const S of l){const k=a.aX(A,S);p=Math.min(p,k),b=Math.max(b,k)}return{min:p,max:b}}class Ao{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(l){this._helper.setMinZoom(l)}setMaxZoom(l){this._helper.setMaxZoom(l)}setMinPitch(l){this._helper.setMinPitch(l)}setMaxPitch(l){this._helper.setMaxPitch(l)}setRenderWorldCopies(l){this._helper.setRenderWorldCopies(l)}setBearing(l){this._helper.setBearing(l)}setPitch(l){this._helper.setPitch(l)}setRoll(l){this._helper.setRoll(l)}setFov(l){this._helper.setFov(l)}setZoom(l){this._helper.setZoom(l)}setCenter(l){this._helper.setCenter(l)}setElevation(l){this._helper.setElevation(l)}setMinElevationForCurrentTile(l){this._helper.setMinElevationForCurrentTile(l)}setPadding(l){this._helper.setPadding(l)}interpolatePadding(l,p,b){return this._helper.interpolatePadding(l,p,b)}isPaddingEqual(l){return this._helper.isPaddingEqual(l)}resize(l,p){this._helper.resize(l,p)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(l){this._helper.setMaxBounds(l)}overrideNearFarZ(l,p){this._helper.overrideNearFarZ(l,p)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(l){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),l)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(l){}constructor(){this._cachedClippingPlane=a.bv(),this._projectionMatrix=a.b9(),this._globeViewProjMatrix32f=a.b8(),this._globeViewProjMatrixNoCorrection=a.b9(),this._globeViewProjMatrixNoCorrectionInverted=a.b9(),this._globeProjMatrixInverted=a.b9(),this._cameraPosition=a.bp(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new Ai({calcMatrices:()=>{this._calcMatrices()},getConstrained:(l,p)=>this.getConstrained(l,p)}),this._coveringTilesDetailsProvider=new Xn}clone(){const l=new Ao;return l.apply(this),l}apply(l,p){this._globeLatitudeErrorCorrectionRadians=p||0,this._helper.apply(l)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const l=a.bp();return l[0]=this._cameraPosition[0],l[1]=this._cameraPosition[1],l[2]=this._cameraPosition[2],l}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(l){const{overscaledTileID:p,applyGlobeMatrix:b}=l,S=this._helper.getMercatorTileCoordinates(p);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:S,clippingPlane:this._cachedClippingPlane,projectionTransition:b?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(l){const p=this.pitchInRadians,b=this.cameraToCenterDistance/l,S=Math.sin(p)*b,k=Math.cos(p)*b+1,R=1/Math.sqrt(S*S+k*k)*1;let W=-S,Z=k;const ie=Math.sqrt(W*W+Z*Z);W/=ie,Z/=ie;const ce=[0,W,Z];a.bw(ce,ce,[0,0,0],-this.bearingInRadians),a.bx(ce,ce,[0,0,0],-1*this.center.lat*Math.PI/180),a.by(ce,ce,[0,0,0],this.center.lng*Math.PI/180);const xe=1/a.aZ(ce);return a.aR(ce,ce,xe),[...ce,-R*xe]}isLocationOccluded(l){return!this.isSurfacePointVisible(vo(l))}transformLightDirection(l){const p=this._helper._center.lng*Math.PI/180,b=this._helper._center.lat*Math.PI/180,S=Math.cos(b),k=[Math.sin(p)*S,Math.sin(b),Math.cos(p)*S],R=[k[2],0,-k[0]],W=[0,0,0];a.aW(W,R,k),a.aV(R,R),a.aV(W,W);const Z=[0,0,0];return a.aV(Z,[R[0]*l[0]+W[0]*l[1]+k[0]*l[2],R[1]*l[0]+W[1]*l[1]+k[1]*l[2],R[2]*l[0]+W[2]*l[1]+k[2]*l[2]]),Z}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(l,p,b){const S=function(W,Z,ie){const ce=1/(1<<ie.z);return new a.a1(W/a.$*ce+ie.x*ce,Z/a.$*ce+ie.y*ce)}(l,p,b.canonical),k=(R=S.y,[a.bo(S.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-R*Math.PI*2))-.5*Math.PI]);var R;return this.getCircleRadiusCorrection()/Math.cos(k[1])}projectTileCoordinates(l,p,b,S){const k=b.canonical,R=Ms(l,p,k.x,k.y,k.z),W=1+(S?S(l,p):0)/a.bu,Z=[R[0]*W,R[1]*W,R[2]*W,1];a.aw(Z,Z,this._globeViewProjMatrixNoCorrection);const ie=this._cachedClippingPlane,ce=ie[0]*R[0]+ie[1]*R[1]+ie[2]*R[2]+ie[3]<0;return{point:new a.P(Z[0]/Z[3],Z[1]/Z[3]),signedDistanceFromCamera:Z[3],isOccluded:ce}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const l=Ss(this.worldSize,this.center.lat),p=a.ba(),b=a.ba();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*l),a.b4(p,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const S=this.centerOffset;p[8]=2*-S.x/this._helper._width,p[9]=2*S.y/this._helper._height,this._projectionMatrix=a.b5(p),this._globeProjMatrixInverted=a.ba(),a.aq(this._globeProjMatrixInverted,p),a.M(p,p,[0,0,-this.cameraToCenterDistance]),a.b6(p,p,this.rollInRadians),a.b7(p,p,-this.pitchInRadians),a.b6(p,p,this.bearingInRadians),a.M(p,p,[0,0,-l]);const k=a.bp();k[0]=l,k[1]=l,k[2]=l,a.b7(b,p,this.center.lat*Math.PI/180),a.bz(b,b,-this.center.lng*Math.PI/180),a.N(b,b,k),this._globeViewProjMatrixNoCorrection=b,a.b7(p,p,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),a.bz(p,p,-this.center.lng*Math.PI/180),a.N(p,p,k),this._globeViewProjMatrix32f=new Float32Array(p),this._globeViewProjMatrixNoCorrectionInverted=a.ba(),a.aq(this._globeViewProjMatrixNoCorrectionInverted,b);const R=a.bp();this._cameraPosition=a.bp(),this._cameraPosition[2]=this.cameraToCenterDistance/l,a.bw(this._cameraPosition,this._cameraPosition,R,-this.rollInRadians),a.bx(this._cameraPosition,this._cameraPosition,R,this.pitchInRadians),a.bw(this._cameraPosition,this._cameraPosition,R,-this.bearingInRadians),a.aS(this._cameraPosition,this._cameraPosition,[0,0,1]),a.bx(this._cameraPosition,this._cameraPosition,R,-this.center.lat*Math.PI/180),a.by(this._cameraPosition,this._cameraPosition,R,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(l);const W=a.b5(this._globeViewProjMatrixNoCorrectionInverted);a.N(W,W,[1,1,-1]),this._cachedFrustum=Oi.fromInvProjectionMatrix(W,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(l){a.w("calculateFogMatrix is not supported on globe projection.");const p=a.ba();return a.ag(p),p}getVisibleUnwrappedCoordinates(l){return[new a.b2(0,l)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(l){l&&a.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(l,p){if(!this._globeViewProjMatrixNoCorrection)return 1;const b=vo(l);a.aR(b,b,1+p/a.bu);const S=a.bv();return a.aw(S,[b[0],b[1],b[2],1],this._globeViewProjMatrixNoCorrection),S[2]/S[3]}populateCache(l){}getBounds(){const l=.5*this.width,p=.5*this.height,b=[new a.P(0,0),new a.P(l,0),new a.P(this.width,0),new a.P(this.width,p),new a.P(this.width,this.height),new a.P(l,this.height),new a.P(0,this.height),new a.P(0,p)],S=[];for(const xe of b)S.push(this.unprojectScreenPoint(xe));let k=0,R=0,W=0,Z=0;const ie=this.center;for(const xe of S){const be=a.bA(ie.lng,xe.lng),Ae=a.bA(ie.lat,xe.lat);be<R&&(R=be),be>k&&(k=be),Ae<Z&&(Z=Ae),Ae>W&&(W=Ae)}const ce=[ie.lng+R,ie.lat+Z,ie.lng+k,ie.lat+W];return this.isSurfacePointOnScreen([0,1,0])&&(ce[3]=90,ce[0]=-180,ce[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(ce[1]=-90,ce[0]=-180,ce[2]=180),new ke(ce)}getConstrained(l,p){const b=a.ah(l.lat,-a.ai,a.ai),S=a.ah(+p,this.minZoom+pt(0,b),this.maxZoom);return{center:new a.S(l.lng,b),zoom:S}}calculateCenterFromCameraLngLatAlt(l,p,b,S){return this._helper.calculateCenterFromCameraLngLatAlt(l,p,b,S)}setLocationAtPoint(l,p){const b=vo(this.unprojectScreenPoint(p)),S=vo(l),k=a.bp();a.bB(k);const R=a.bp();a.by(R,b,k,-this.center.lng*Math.PI/180),a.bx(R,R,k,this.center.lat*Math.PI/180);const W=S[0]*S[0]+S[2]*S[2],Z=R[0]*R[0];if(W<Z)return;const ie=Math.sqrt(W-Z),ce=-ie,xe=a.bC(S[0],S[2],R[0],ie),be=a.bC(S[0],S[2],R[0],ce),Ae=a.bp();a.by(Ae,S,k,-xe);const Ue=a.bC(Ae[1],Ae[2],R[1],R[2]),lt=a.bp();a.by(lt,S,k,-be);const it=a.bC(lt[1],lt[2],R[1],R[2]),ft=.5*Math.PI,gt=Ue>=-ft&&Ue<=ft,Et=it>=-ft&&it<=ft;let Mt,It;if(gt&&Et){const ur=this.center.lng*Math.PI/180,Jt=this.center.lat*Math.PI/180;a.bD(xe,ur)+a.bD(Ue,Jt)<a.bD(be,ur)+a.bD(it,Jt)?(Mt=xe,It=Ue):(Mt=be,It=it)}else if(gt)Mt=xe,It=Ue;else{if(!Et)return;Mt=be,It=it}const jt=Mt/Math.PI*180,St=It/Math.PI*180,Wt=this.center.lat;this.setCenter(new a.S(jt,a.ah(St,-90,90))),this.setZoom(this.zoom+pt(Wt,this.center.lat))}locationToScreenPoint(l,p){const b=vo(l);if(p){const S=p.getElevationForLngLatZoom(l,this._helper._tileZoom);a.aR(b,b,1+S/a.bu)}return this._projectSurfacePointToScreen(b)}_projectSurfacePointToScreen(l){const p=a.bv();return a.aw(p,[...l,1],this._globeViewProjMatrixNoCorrection),p[0]/=p[3],p[1]/=p[3],new a.P((.5*p[0]+.5)*this.width,(.5*-p[1]+.5)*this.height)}screenPointToMercatorCoordinate(l,p){if(p){const b=p.pointCoordinate(l);if(b)return b}return a.a1.fromLngLat(this.unprojectScreenPoint(l))}screenPointToLocation(l,p){var b;return(b=this.screenPointToMercatorCoordinate(l,p))===null||b===void 0?void 0:b.toLngLat()}isPointOnMapSurface(l,p){const b=this._cameraPosition,S=this.getRayDirectionFromPixel(l);return!!this.rayPlanetIntersection(b,S)}getRayDirectionFromPixel(l){const p=a.bv();p[0]=l.x/this.width*2-1,p[1]=-1*(l.y/this.height*2-1),p[2]=1,p[3]=1,a.aw(p,p,this._globeViewProjMatrixNoCorrectionInverted),p[0]/=p[3],p[1]/=p[3],p[2]/=p[3];const b=a.bp();b[0]=p[0]-this._cameraPosition[0],b[1]=p[1]-this._cameraPosition[1],b[2]=p[2]-this._cameraPosition[2];const S=a.bp();return a.aV(S,b),S}isSurfacePointVisible(l){const p=this._cachedClippingPlane;return p[0]*l[0]+p[1]*l[1]+p[2]*l[2]+p[3]>=0}isSurfacePointOnScreen(l){if(!this.isSurfacePointVisible(l))return!1;const p=a.bv();return a.aw(p,[...l,1],this._globeViewProjMatrixNoCorrection),p[0]/=p[3],p[1]/=p[3],p[2]/=p[3],p[0]>-1&&p[0]<1&&p[1]>-1&&p[1]<1&&p[2]>-1&&p[2]<1}rayPlanetIntersection(l,p){const b=a.aX(l,p),S=a.bp(),k=a.bp();a.aR(k,p,b),a.aU(S,l,k);const R=1-a.aX(S,S);if(R<0)return null;const W=a.aX(l,l)-1,Z=-b+(b<0?1:-1)*Math.sqrt(R),ie=W/Z,ce=Z;return{tMin:Math.min(ie,ce),tMax:Math.max(ie,ce)}}unprojectScreenPoint(l){const p=this._cameraPosition,b=this.getRayDirectionFromPixel(l),S=this.rayPlanetIntersection(p,b);if(S){const ce=a.bp();a.aS(ce,p,[b[0]*S.tMin,b[1]*S.tMin,b[2]*S.tMin]);const xe=a.bp();return a.aV(xe,ce),re(xe)}const k=this._cachedClippingPlane,R=k[0]*b[0]+k[1]*b[1]+k[2]*b[2],W=-a.b1(k,p)/R,Z=a.bp();if(W>0)a.aS(Z,p,[b[0]*W,b[1]*W,b[2]*W]);else{const ce=a.bp();a.aS(ce,p,[2*b[0],2*b[1],2*b[2]]);const xe=a.b1(this._cachedClippingPlane,ce);a.aU(Z,ce,[this._cachedClippingPlane[0]*xe,this._cachedClippingPlane[1]*xe,this._cachedClippingPlane[2]*xe])}const ie=function(ce){const xe=a.bp();return xe[0]=ce[0]*-ce[3],xe[1]=ce[1]*-ce[3],xe[2]=ce[2]*-ce[3],{center:xe,radius:Math.sqrt(1-ce[3]*ce[3])}}(k);return re(function(ce,xe,be){const Ae=a.bp();a.aU(Ae,be,ce);const Ue=a.bp();return a.bq(Ue,ce,Ae,xe/a.a$(Ae)),Ue}(ie.center,ie.radius,Z))}getMatrixForModel(l,p){const b=a.S.convert(l),S=1/a.bu,k=a.b9();return a.bz(k,k,b.lng/180*Math.PI),a.b7(k,k,-b.lat/180*Math.PI),a.M(k,k,[0,0,1+p/a.bu]),a.b7(k,k,.5*Math.PI),a.N(k,k,[S,S,S]),k}getProjectionDataForCustomLayer(l=!0){const p=this.getProjectionData({overscaledTileID:new a.Z(0,0,0,0,0),applyGlobeMatrix:l});return p.tileMercatorCoords=[0,0,1,1],p}getFastPathSimpleProjectionMatrix(l){}}class Ko{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(l){this._helper.setMinZoom(l)}setMaxZoom(l){this._helper.setMaxZoom(l)}setMinPitch(l){this._helper.setMinPitch(l)}setMaxPitch(l){this._helper.setMaxPitch(l)}setRenderWorldCopies(l){this._helper.setRenderWorldCopies(l)}setBearing(l){this._helper.setBearing(l)}setPitch(l){this._helper.setPitch(l)}setRoll(l){this._helper.setRoll(l)}setFov(l){this._helper.setFov(l)}setZoom(l){this._helper.setZoom(l)}setCenter(l){this._helper.setCenter(l)}setElevation(l){this._helper.setElevation(l)}setMinElevationForCurrentTile(l){this._helper.setMinElevationForCurrentTile(l)}setPadding(l){this._helper.setPadding(l)}interpolatePadding(l,p,b){return this._helper.interpolatePadding(l,p,b)}isPaddingEqual(l){return this._helper.isPaddingEqual(l)}resize(l,p,b=!0){this._helper.resize(l,p,b)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(l){this._helper.setMaxBounds(l)}overrideNearFarZ(l,p){this._helper.overrideNearFarZ(l,p)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(l){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),l)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(l,p){this._globeness=l,this._globeLatitudeErrorCorrectionRadians=p,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new Ai({calcMatrices:()=>{this._calcMatrices()},getConstrained:(l,p)=>this.getConstrained(l,p)}),this._globeness=1,this._mercatorTransform=new ri,this._verticalPerspectiveTransform=new Ao}clone(){const l=new Ko;return l._globeness=this._globeness,l._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,l.apply(this),l}apply(l){this._helper.apply(l),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(l){const p=this._mercatorTransform.getProjectionData(l),b=this._verticalPerspectiveTransform.getProjectionData(l);return{mainMatrix:this.isGlobeRendering?b.mainMatrix:p.mainMatrix,clippingPlane:b.clippingPlane,tileMercatorCoords:b.tileMercatorCoords,projectionTransition:l.applyGlobeMatrix?this._globeness:0,fallbackMatrix:p.fallbackMatrix}}isLocationOccluded(l){return this.currentTransform.isLocationOccluded(l)}transformLightDirection(l){return this.currentTransform.transformLightDirection(l)}getPixelScale(){return a.bk(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return a.bk(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(l,p,b){const S=this._mercatorTransform.getPitchedTextCorrection(l,p,b),k=this._verticalPerspectiveTransform.getPitchedTextCorrection(l,p,b);return a.bk(S,k,this._globeness)}projectTileCoordinates(l,p,b,S){return this.currentTransform.projectTileCoordinates(l,p,b,S)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(l){return this.currentTransform.calculateFogMatrix(l)}getVisibleUnwrappedCoordinates(l){return this.currentTransform.getVisibleUnwrappedCoordinates(l)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(l){this._mercatorTransform.recalculateZoomAndCenter(l),this._verticalPerspectiveTransform.recalculateZoomAndCenter(l)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(l,p){return this.currentTransform.lngLatToCameraDepth(l,p)}populateCache(l){this._mercatorTransform.populateCache(l),this._verticalPerspectiveTransform.populateCache(l)}getBounds(){return this.currentTransform.getBounds()}getConstrained(l,p){return this.currentTransform.getConstrained(l,p)}calculateCenterFromCameraLngLatAlt(l,p,b,S){return this._helper.calculateCenterFromCameraLngLatAlt(l,p,b,S)}setLocationAtPoint(l,p){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(l,p),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(l,p),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(l,p){return this.currentTransform.locationToScreenPoint(l,p)}screenPointToMercatorCoordinate(l,p){return this.currentTransform.screenPointToMercatorCoordinate(l,p)}screenPointToLocation(l,p){return this.currentTransform.screenPointToLocation(l,p)}isPointOnMapSurface(l,p){return this.currentTransform.isPointOnMapSurface(l,p)}getRayDirectionFromPixel(l){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(l)}getMatrixForModel(l,p){return this.currentTransform.getMatrixForModel(l,p)}getProjectionDataForCustomLayer(l=!0){const p=this._mercatorTransform.getProjectionDataForCustomLayer(l);if(!this.isGlobeRendering)return p;const b=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(l);return b.fallbackMatrix=p.mainMatrix,b}getFastPathSimpleProjectionMatrix(l){return this.currentTransform.getFastPathSimpleProjectionMatrix(l)}}class pi{get useGlobeControls(){return!0}handlePanInertia(l,p){const b=Ut(l,p);return Math.abs(b.lng-p.center.lng)>180&&(b.lng=p.center.lng+179.5*Math.sign(b.lng-p.center.lng)),{easingCenter:b,easingOffset:new a.P(0,0)}}handleMapControlsRollPitchBearingZoom(l,p){const b=l.around,S=p.screenPointToLocation(b);l.bearingDelta&&p.setBearing(p.bearing+l.bearingDelta),l.pitchDelta&&p.setPitch(p.pitch+l.pitchDelta),l.rollDelta&&p.setRoll(p.roll+l.rollDelta);const k=p.zoom;l.zoomDelta&&p.setZoom(p.zoom+l.zoomDelta);const R=p.zoom-k;if(R===0)return;const W=a.bA(p.center.lng,S.lng),Z=W/(Math.abs(W/180)+1),ie=a.bA(p.center.lat,S.lat),ce=p.getRayDirectionFromPixel(b),xe=p.cameraPosition,be=-1*a.aX(xe,ce),Ae=a.bp();a.aS(Ae,xe,[ce[0]*be,ce[1]*be,ce[2]*be]);const Ue=a.aZ(Ae)-1,lt=Math.exp(.5*-Math.max(Ue-.3,0)),it=Ss(p.worldSize,p.center.lat)/Math.min(p.width,p.height),ft=a.bn(it,.9,.5,1,.25),gt=(1-a.af(-R))*Math.min(lt,ft),Et=p.center.lat,Mt=p.zoom,It=new a.S(p.center.lng+Z*gt,a.ah(p.center.lat+ie*gt,-a.ai,a.ai));p.setLocationAtPoint(S,b);const jt=p.center,St=a.bn(Math.abs(W),45,85,0,1),Wt=a.bn(it,.75,.35,0,1),ur=Math.pow(Math.max(St,Wt),.25),Jt=a.bA(jt.lng,It.lng),nr=a.bA(jt.lat,It.lat);p.setCenter(new a.S(jt.lng+Jt*ur,jt.lat+nr*ur).wrap()),p.setZoom(Mt+pt(Et,p.center.lat))}handleMapControlsPan(l,p,b){if(!l.panDelta)return;const S=p.center.lat,k=p.zoom;p.setCenter(Ut(l.panDelta,p).wrap()),p.setZoom(k+pt(S,p.center.lat))}cameraForBoxAndBearing(l,p,b,S,k){const R=lo(l,p,b,S,k),W=p.left/k.width*2-1,Z=(k.width-p.right)/k.width*2-1,ie=p.top/k.height*-2+1,ce=(k.height-p.bottom)/k.height*-2+1,xe=a.bA(b.getWest(),b.getEast())<0,be=xe?b.getEast():b.getWest(),Ae=xe?b.getWest():b.getEast(),Ue=Math.max(b.getNorth(),b.getSouth()),lt=Math.min(b.getNorth(),b.getSouth()),it=be+.5*a.bA(be,Ae),ft=Ue+.5*a.bA(Ue,lt),gt=k.clone();gt.setCenter(R.center),gt.setBearing(R.bearing),gt.setPitch(0),gt.setRoll(0),gt.setZoom(R.zoom);const Et=gt.modelViewProjectionMatrix,Mt=[vo(b.getNorthWest()),vo(b.getNorthEast()),vo(b.getSouthWest()),vo(b.getSouthEast()),vo(new a.S(Ae,ft)),vo(new a.S(be,ft)),vo(new a.S(it,Ue)),vo(new a.S(it,lt))],It=vo(R.center);let jt=Number.POSITIVE_INFINITY;for(const St of Mt)W<0&&(jt=pi.getLesserNonNegativeNonNull(jt,pi.solveVectorScale(St,It,Et,"x",W))),Z>0&&(jt=pi.getLesserNonNegativeNonNull(jt,pi.solveVectorScale(St,It,Et,"x",Z))),ie>0&&(jt=pi.getLesserNonNegativeNonNull(jt,pi.solveVectorScale(St,It,Et,"y",ie))),ce<0&&(jt=pi.getLesserNonNegativeNonNull(jt,pi.solveVectorScale(St,It,Et,"y",ce)));if(Number.isFinite(jt)&&jt!==0)return R.zoom=gt.zoom+a.ak(jt),R;ma()}handleJumpToCenterZoom(l,p){const b=l.center.lat,S=l.getConstrained(p.center?a.S.convert(p.center):l.center,l.zoom).center;l.setCenter(S.wrap());const k=p.zoom!==void 0?+p.zoom:l.zoom+pt(b,S.lat);l.zoom!==k&&l.setZoom(k)}handleEaseTo(l,p){const b=l.zoom,S=l.center,k=l.padding,R={roll:l.roll,pitch:l.pitch,bearing:l.bearing},W={roll:p.roll===void 0?l.roll:p.roll,pitch:p.pitch===void 0?l.pitch:p.pitch,bearing:p.bearing===void 0?l.bearing:p.bearing},Z=p.zoom!==void 0,ie=!l.isPaddingEqual(p.padding);let ce=!1;const xe=p.center?a.S.convert(p.center):S,be=l.getConstrained(xe,b).center;Ii(l,be);const Ae=l.clone();Ae.setCenter(be),Ae.setZoom(Z?+p.zoom:b+pt(S.lat,xe.lat)),Ae.setBearing(p.bearing);const Ue=new a.P(a.ah(l.centerPoint.x+p.offsetAsPoint.x,0,l.width),a.ah(l.centerPoint.y+p.offsetAsPoint.y,0,l.height));Ae.setLocationAtPoint(be,Ue);const lt=(p.offset&&p.offsetAsPoint.mag())>0?Ae.center:be,it=Z?+p.zoom:b+pt(S.lat,lt.lat),ft=b+pt(S.lat,0),gt=it+pt(lt.lat,0),Et=a.bA(S.lng,lt.lng),Mt=a.bA(S.lat,lt.lat),It=a.af(gt-ft);return ce=it!==b,{easeFunc:jt=>{if(a.be(R,W)||Ri({startEulerAngles:R,endEulerAngles:W,tr:l,k:jt,useSlerp:R.roll!=W.roll}),ie&&l.interpolatePadding(k,p.padding,jt),p.around)a.w("Easing around a point is not supported under globe projection."),l.setLocationAtPoint(p.around,p.aroundPoint);else{const St=gt>ft?Math.min(2,It):Math.max(.5,It),Wt=Math.pow(St,1-jt),ur=Er(S,Et,Mt,jt*Wt);l.setCenter(ur.wrap())}if(ce){const St=a.C.number(ft,gt,jt)+pt(0,l.center.lat);l.setZoom(St)}},isZooming:ce,elevationCenter:lt}}handleFlyTo(l,p){const b=p.zoom!==void 0,S=l.center,k=l.zoom,R=l.padding,W=!l.isPaddingEqual(p.padding),Z=l.getConstrained(a.S.convert(p.center||p.locationAtOffset),k).center,ie=b?+p.zoom:l.zoom+pt(l.center.lat,Z.lat),ce=l.clone();ce.setCenter(Z),ce.setZoom(ie),ce.setBearing(p.bearing);const xe=new a.P(a.ah(l.centerPoint.x+p.offsetAsPoint.x,0,l.width),a.ah(l.centerPoint.y+p.offsetAsPoint.y,0,l.height));ce.setLocationAtPoint(Z,xe);const be=ce.center;Ii(l,be);const Ae=function(Mt,It,jt){const St=vo(It),Wt=vo(jt),ur=a.aX(St,Wt),Jt=Math.acos(ur),nr=_c(Mt);return Jt/(2*Math.PI)*nr}(l,S,be),Ue=k+pt(S.lat,0),lt=ie+pt(be.lat,0),it=a.af(lt-Ue);let ft;if(typeof p.minZoom=="number"){const Mt=+p.minZoom+pt(be.lat,0),It=Math.min(Mt,Ue,lt)+pt(0,be.lat),jt=l.getConstrained(be,It).zoom+pt(be.lat,0);ft=a.af(jt-Ue)}const gt=a.bA(S.lng,be.lng),Et=a.bA(S.lat,be.lat);return{easeFunc:(Mt,It,jt,St)=>{const Wt=Er(S,gt,Et,jt);W&&l.interpolatePadding(R,p.padding,Mt);const ur=Mt===1?be:Wt;l.setCenter(ur.wrap());const Jt=Ue+a.ak(It);l.setZoom(Mt===1?ie:Jt+pt(0,ur.lat))},scaleOfZoom:it,targetCenter:be,scaleOfMinZoom:ft,pixelPathLength:Ae}}static solveVectorScale(l,p,b,S,k){const R=S==="x"?[b[0],b[4],b[8],b[12]]:[b[1],b[5],b[9],b[13]],W=[b[3],b[7],b[11],b[15]],Z=l[0]*R[0]+l[1]*R[1]+l[2]*R[2],ie=l[0]*W[0]+l[1]*W[1]+l[2]*W[2],ce=p[0]*R[0]+p[1]*R[1]+p[2]*R[2],xe=p[0]*W[0]+p[1]*W[1]+p[2]*W[2];return ce+k*ie===Z+k*xe||W[3]*(Z-ce)+R[3]*(xe-ie)+Z*xe==ce*ie?null:(ce+R[3]-k*xe-k*W[3])/(ce-Z-k*xe+k*ie)}static getLesserNonNegativeNonNull(l,p){return p!==null&&p>=0&&p<l?p:l}}class ca{constructor(l){this._globe=l,this._mercatorCameraHelper=new Mi,this._verticalPerspectiveCameraHelper=new pi}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(l,p){return this.currentHelper.handlePanInertia(l,p)}handleMapControlsRollPitchBearingZoom(l,p){return this.currentHelper.handleMapControlsRollPitchBearingZoom(l,p)}handleMapControlsPan(l,p,b){this.currentHelper.handleMapControlsPan(l,p,b)}cameraForBoxAndBearing(l,p,b,S,k){return this.currentHelper.cameraForBoxAndBearing(l,p,b,S,k)}handleJumpToCenterZoom(l,p){this.currentHelper.handleJumpToCenterZoom(l,p)}handleEaseTo(l,p){return this.currentHelper.handleEaseTo(l,p)}handleFlyTo(l,p){return this.currentHelper.handleFlyTo(l,p)}}const jo=(A,l)=>a.y(A,l&&l.filter(p=>p.identifier!=="source.canvas")),Oa=a.bE();class pl extends a.E{constructor(l,p={}){var b,S;super(),this._rtlPluginLoaded=()=>{for(const R in this.sourceCaches){const W=this.sourceCaches[R].getSource().type;W!=="vector"&&W!=="geojson"||this.sourceCaches[R].reload()}},this.map=l,this.dispatcher=new Ce($e(),l._getMapId()),this.dispatcher.registerMessageHandler("GG",(R,W)=>this.getGlyphs(R,W)),this.dispatcher.registerMessageHandler("GI",(R,W)=>this.getImages(R,W)),this.imageManager=new U,this.imageManager.setEventedParent(this);const k=((b=l._container)===null||b===void 0?void 0:b.lang)||typeof document<"u"&&((S=document.documentElement)===null||S===void 0?void 0:S.lang)||void 0;this.glyphManager=new ee(l._requestManager,p.localIdeographFontFamily,k),this.lineAtlas=new fe(256,512),this.crossTileSymbolIndex=new rt,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.bF,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",a.bG()),xr().on(wr,this._rtlPluginLoaded),this.on("data",R=>{if(R.dataType!=="source"||R.sourceDataType!=="metadata")return;const W=this.sourceCaches[R.sourceId];if(!W)return;const Z=W.getSource();if(Z&&Z.vectorLayerIds)for(const ie in this._layers){const ce=this._layers[ie];ce.source===Z.id&&this._validateLayer(ce)}})}setGlobalStateProperty(l,p){var b,S,k;this._checkLoaded();const R=p===null?(k=(S=(b=this.stylesheet.state)===null||b===void 0?void 0:b[l])===null||S===void 0?void 0:S.default)!==null&&k!==void 0?k:null:p;if(a.bH(R,this._globalState[l]))return this;this._globalState[l]=R,this._applyGlobalStateChanges([l])}getGlobalState(){return this._globalState}setGlobalState(l){this._checkLoaded();const p=[];for(const b in l)!a.bH(this._globalState[b],l[b].default)&&(p.push(b),this._globalState[b]=l[b].default);this._applyGlobalStateChanges(p)}_applyGlobalStateChanges(l){if(l.length===0)return;const p=new Set;for(const b in this._layers){const S=this._layers[b],k=S.getLayoutAffectingGlobalStateRefs(),R=S.getPaintAffectingGlobalStateRefs();for(const W of l)if(k.has(W)&&p.add(S.source),R.has(W))for(const{name:Z,value:ie}of R.get(W))this._updatePaintProperty(S,Z,ie)}for(const b in this.sourceCaches)p.has(b)&&(this._reloadSource(b),this._changed=!0)}loadURL(l,p={},b){this.fire(new a.l("dataloading",{dataType:"style"})),p.validate=typeof p.validate!="boolean"||p.validate;const S=this.map._requestManager.transformRequest(l,"Style");this._loadStyleRequest=new AbortController;const k=this._loadStyleRequest;a.j(S,this._loadStyleRequest).then(R=>{this._loadStyleRequest=null,this._load(R.data,p,b)}).catch(R=>{this._loadStyleRequest=null,R&&!k.signal.aborted&&this.fire(new a.k(R))})}loadJSON(l,p={},b){this.fire(new a.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,_.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,p.validate=p.validate!==!1,this._load(l,p,b)}).catch(()=>{})}loadEmpty(){this.fire(new a.l("dataloading",{dataType:"style"})),this._load(Oa,{validate:!1})}_load(l,p,b){var S,k,R;let W=p.transformStyle?p.transformStyle(b,l):l;if(!p.validate||!jo(this,a.z(W))){W=Object.assign({},W),this._loaded=!0,this.stylesheet=W;for(const Z in W.sources)this.addSource(Z,W.sources[Z],{validate:!1});W.sprite?this._loadSprite(W.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(W.glyphs),this._createLayers(),this.light=new ye(this.stylesheet.light),this._setProjectionInternal(((S=this.stylesheet.projection)===null||S===void 0?void 0:S.type)||"mercator"),this.sky=new ue(this.stylesheet.sky),this.map.setTerrain((k=this.stylesheet.terrain)!==null&&k!==void 0?k:null),this.setGlobalState((R=this.stylesheet.state)!==null&&R!==void 0?R:null),this.fire(new a.l("data",{dataType:"style"})),this.fire(new a.l("style.load"))}}_createLayers(){const l=a.bI(this.stylesheet.layers);this.dispatcher.broadcast("SL",l),this._order=l.map(p=>p.id),this._layers={},this._serializedLayers=null;for(const p of l){const b=a.bJ(p);b.setEventedParent(this,{layer:{id:p.id}}),this._layers[p.id]=b}}_loadSprite(l,p=!1,b=void 0){let S;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(k,R,W,Z){return a._(this,void 0,void 0,function*(){const ie=N(k),ce=W>1?"@2x":"",xe={},be={};for(const{id:Ae,url:Ue}of ie){const lt=R.transformRequest(j(Ue,ce,".json"),"SpriteJSON");xe[Ae]=a.j(lt,Z);const it=R.transformRequest(j(Ue,ce,".png"),"SpriteImage");be[Ae]=D.getImage(it,Z)}return yield Promise.all([...Object.values(xe),...Object.values(be)]),function(Ae,Ue){return a._(this,void 0,void 0,function*(){const lt={};for(const it in Ae){lt[it]={};const ft=_.getImageCanvasContext((yield Ue[it]).data),gt=(yield Ae[it]).data;for(const Et in gt){const{width:Mt,height:It,x:jt,y:St,sdf:Wt,pixelRatio:ur,stretchX:Jt,stretchY:nr,content:cr,textFitWidth:Gr,textFitHeight:Yr}=gt[Et];lt[it][Et]={data:null,pixelRatio:ur,sdf:Wt,stretchX:Jt,stretchY:nr,content:cr,textFitWidth:Gr,textFitHeight:Yr,spriteData:{width:Mt,height:It,x:jt,y:St,context:ft}}}}return lt})}(xe,be)})}(l,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(k=>{if(this._spriteRequest=null,k)for(const R in k){this._spritesImagesIds[R]=[];const W=this._spritesImagesIds[R]?this._spritesImagesIds[R].filter(Z=>!(Z in k)):[];for(const Z of W)this.imageManager.removeImage(Z),this._changedImages[Z]=!0;for(const Z in k[R]){const ie=R==="default"?Z:`${R}:${Z}`;this._spritesImagesIds[R].push(ie),ie in this.imageManager.images?this.imageManager.updateImage(ie,k[R][Z],!1):this.imageManager.addImage(ie,k[R][Z]),p&&(this._changedImages[ie]=!0)}}}).catch(k=>{this._spriteRequest=null,S=k,this.fire(new a.k(S))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),p&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"})),b&&b(S)})}_unloadSprite(){for(const l of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(l),this._changedImages[l]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"}))}_validateLayer(l){const p=this.sourceCaches[l.source];if(!p)return;const b=l.sourceLayer;if(!b)return;const S=p.getSource();(S.type==="geojson"||S.vectorLayerIds&&S.vectorLayerIds.indexOf(b)===-1)&&this.fire(new a.k(new Error(`Source layer "${b}" does not exist on source "${S.id}" as specified by style layer "${l.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const l in this.sourceCaches)if(!this.sourceCaches[l].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(l,p=!1){const b=this._serializedAllLayers();if(!l||l.length===0)return Object.values(p?a.bK(b):b);const S=[];for(const k of l)if(b[k]){const R=p?a.bK(b[k]):b[k];S.push(R)}return S}_serializedAllLayers(){let l=this._serializedLayers;if(l)return l;l=this._serializedLayers={};const p=Object.keys(this._layers);for(const b of p){const S=this._layers[b];S.type!=="custom"&&(l[b]=S.serialize())}return l}hasTransitions(){var l,p,b;if(!((l=this.light)===null||l===void 0)&&l.hasTransition()||!((p=this.sky)===null||p===void 0)&&p.hasTransition()||!((b=this.projection)===null||b===void 0)&&b.hasTransition())return!0;for(const S in this.sourceCaches)if(this.sourceCaches[S].hasTransition())return!0;for(const S in this._layers)if(this._layers[S].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(l){if(!this._loaded)return;const p=this._changed;if(p){const S=Object.keys(this._updatedLayers),k=Object.keys(this._removedLayers);(S.length||k.length)&&this._updateWorkerLayers(S,k);for(const R in this._updatedSources){const W=this._updatedSources[R];if(W==="reload")this._reloadSource(R);else{if(W!=="clear")throw new Error(`Invalid action ${W}`);this._clearSource(R)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const R in this._updatedPaintProps)this._layers[R].updateTransitions(l);this.light.updateTransitions(l),this.sky.updateTransitions(l),this._resetUpdates()}const b={};for(const S in this.sourceCaches){const k=this.sourceCaches[S];b[S]=k.used,k.used=!1}for(const S of this._order){const k=this._layers[S];k.recalculate(l,this._availableImages),!k.isHidden(l.zoom)&&k.source&&(this.sourceCaches[k.source].used=!0)}for(const S in b){const k=this.sourceCaches[S];!!b[S]!=!!k.used&&k.fire(new a.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:S}))}this.light.recalculate(l),this.sky.recalculate(l),this.projection.recalculate(l),this.z=l.zoom,p&&this.fire(new a.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const l=Object.keys(this._changedImages);if(l.length){for(const p in this.sourceCaches)this.sourceCaches[p].reloadTilesForDependencies(["icons","patterns"],l);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const l in this.sourceCaches)this.sourceCaches[l].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(l,p){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(l,!1),removedIds:p})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(l,p={}){var b;this._checkLoaded();const S=this.serialize();if(l=p.transformStyle?p.transformStyle(S,l):l,((b=p.validate)===null||b===void 0||b)&&jo(this,a.z(l)))return!1;(l=a.bK(l)).layers=a.bI(l.layers);const k=a.bL(S,l),R=this._getOperationsToPerform(k);if(R.unimplemented.length>0)throw new Error(`Unimplemented: ${R.unimplemented.join(", ")}.`);if(R.operations.length===0)return!1;for(const W of R.operations)W();return this.stylesheet=l,this._serializedLayers=null,!0}_getOperationsToPerform(l){const p=[],b=[];for(const S of l)switch(S.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":p.push(()=>this.addLayer.apply(this,S.args));break;case"removeLayer":p.push(()=>this.removeLayer.apply(this,S.args));break;case"setPaintProperty":p.push(()=>this.setPaintProperty.apply(this,S.args));break;case"setLayoutProperty":p.push(()=>this.setLayoutProperty.apply(this,S.args));break;case"setFilter":p.push(()=>this.setFilter.apply(this,S.args));break;case"addSource":p.push(()=>this.addSource.apply(this,S.args));break;case"removeSource":p.push(()=>this.removeSource.apply(this,S.args));break;case"setLayerZoomRange":p.push(()=>this.setLayerZoomRange.apply(this,S.args));break;case"setLight":p.push(()=>this.setLight.apply(this,S.args));break;case"setGeoJSONSourceData":p.push(()=>this.setGeoJSONSourceData.apply(this,S.args));break;case"setGlyphs":p.push(()=>this.setGlyphs.apply(this,S.args));break;case"setSprite":p.push(()=>this.setSprite.apply(this,S.args));break;case"setTerrain":p.push(()=>this.map.setTerrain.apply(this,S.args));break;case"setSky":p.push(()=>this.setSky.apply(this,S.args));break;case"setProjection":this.setProjection.apply(this,S.args);break;case"setGlobalState":p.push(()=>this.setGlobalState.apply(this,S.args));break;case"setTransition":p.push(()=>{});break;default:b.push(S.command)}return{operations:p,unimplemented:b}}addImage(l,p){if(this.getImage(l))return this.fire(new a.k(new Error(`An image named "${l}" already exists.`)));this.imageManager.addImage(l,p),this._afterImageUpdated(l)}updateImage(l,p){this.imageManager.updateImage(l,p)}getImage(l){return this.imageManager.getImage(l)}removeImage(l){if(!this.getImage(l))return this.fire(new a.k(new Error(`An image named "${l}" does not exist.`)));this.imageManager.removeImage(l),this._afterImageUpdated(l)}_afterImageUpdated(l){this._availableImages=this.imageManager.listImages(),this._changedImages[l]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(l,p,b={}){if(this._checkLoaded(),this.sourceCaches[l]!==void 0)throw new Error(`Source "${l}" already exists.`);if(!p.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(p).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(p.type)>=0&&this._validate(a.z.source,`sources.${l}`,p,null,b))return;this.map&&this.map._collectResourceTiming&&(p.collectResourceTiming=!0);const S=this.sourceCaches[l]=new Sr(l,p,this.dispatcher);S.style=this,S.setEventedParent(this,()=>({isSourceLoaded:S.loaded(),source:S.serialize(),sourceId:l})),S.onAdd(this.map),this._changed=!0}removeSource(l){if(this._checkLoaded(),this.sourceCaches[l]===void 0)throw new Error("There is no source with this ID");for(const b in this._layers)if(this._layers[b].source===l)return this.fire(new a.k(new Error(`Source "${l}" cannot be removed while layer "${b}" is using it.`)));const p=this.sourceCaches[l];delete this.sourceCaches[l],delete this._updatedSources[l],p.fire(new a.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:l})),p.setEventedParent(null),p.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(l,p){if(this._checkLoaded(),this.sourceCaches[l]===void 0)throw new Error(`There is no source with this ID=${l}`);const b=this.sourceCaches[l].getSource();if(b.type!=="geojson")throw new Error(`geojsonSource.type is ${b.type}, which is !== 'geojson`);b.setData(p),this._changed=!0}getSource(l){return this.sourceCaches[l]&&this.sourceCaches[l].getSource()}addLayer(l,p,b={}){this._checkLoaded();const S=l.id;if(this.getLayer(S))return void this.fire(new a.k(new Error(`Layer "${S}" already exists on this map.`)));let k;if(l.type==="custom"){if(jo(this,a.bM(l)))return;k=a.bJ(l)}else{if("source"in l&&typeof l.source=="object"&&(this.addSource(S,l.source),l=a.bK(l),l=a.e(l,{source:S})),this._validate(a.z.layer,`layers.${S}`,l,{arrayIndex:-1},b))return;k=a.bJ(l),this._validateLayer(k),k.setEventedParent(this,{layer:{id:S}})}const R=p?this._order.indexOf(p):this._order.length;if(p&&R===-1)this.fire(new a.k(new Error(`Cannot add layer "${S}" before non-existing layer "${p}".`)));else{if(this._order.splice(R,0,S),this._layerOrderChanged=!0,this._layers[S]=k,this._removedLayers[S]&&k.source&&k.type!=="custom"){const W=this._removedLayers[S];delete this._removedLayers[S],W.type!==k.type?this._updatedSources[k.source]="clear":(this._updatedSources[k.source]="reload",this.sourceCaches[k.source].pause())}this._updateLayer(k),k.onAdd&&k.onAdd(this.map)}}moveLayer(l,p){if(this._checkLoaded(),this._changed=!0,!this._layers[l])return void this.fire(new a.k(new Error(`The layer '${l}' does not exist in the map's style and cannot be moved.`)));if(l===p)return;const b=this._order.indexOf(l);this._order.splice(b,1);const S=p?this._order.indexOf(p):this._order.length;p&&S===-1?this.fire(new a.k(new Error(`Cannot move layer "${l}" before non-existing layer "${p}".`))):(this._order.splice(S,0,l),this._layerOrderChanged=!0)}removeLayer(l){this._checkLoaded();const p=this._layers[l];if(!p)return void this.fire(new a.k(new Error(`Cannot remove non-existing layer "${l}".`)));p.setEventedParent(null);const b=this._order.indexOf(l);this._order.splice(b,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[l]=p,delete this._layers[l],this._serializedLayers&&delete this._serializedLayers[l],delete this._updatedLayers[l],delete this._updatedPaintProps[l],p.onRemove&&p.onRemove(this.map)}getLayer(l){return this._layers[l]}getLayersOrder(){return[...this._order]}hasLayer(l){return l in this._layers}setLayerZoomRange(l,p,b){this._checkLoaded();const S=this.getLayer(l);S?S.minzoom===p&&S.maxzoom===b||(p!=null&&(S.minzoom=p),b!=null&&(S.maxzoom=b),this._updateLayer(S)):this.fire(new a.k(new Error(`Cannot set the zoom range of non-existing layer "${l}".`)))}setFilter(l,p,b={}){this._checkLoaded();const S=this.getLayer(l);if(S){if(!a.bH(S.filter,p))return p==null?(S.setFilter(void 0),void this._updateLayer(S)):void(this._validate(a.z.filter,`layers.${S.id}.filter`,p,null,b)||(S.setFilter(a.bK(p)),this._updateLayer(S)))}else this.fire(new a.k(new Error(`Cannot filter non-existing layer "${l}".`)))}getFilter(l){return a.bK(this.getLayer(l).filter)}setLayoutProperty(l,p,b,S={}){this._checkLoaded();const k=this.getLayer(l);k?a.bH(k.getLayoutProperty(p),b)||(k.setLayoutProperty(p,b,S),this._updateLayer(k)):this.fire(new a.k(new Error(`Cannot style non-existing layer "${l}".`)))}getLayoutProperty(l,p){const b=this.getLayer(l);if(b)return b.getLayoutProperty(p);this.fire(new a.k(new Error(`Cannot get style of non-existing layer "${l}".`)))}setPaintProperty(l,p,b,S={}){this._checkLoaded();const k=this.getLayer(l);k?a.bH(k.getPaintProperty(p),b)||this._updatePaintProperty(k,p,b,S):this.fire(new a.k(new Error(`Cannot style non-existing layer "${l}".`)))}_updatePaintProperty(l,p,b,S={}){l.setPaintProperty(p,b,S)&&this._updateLayer(l),this._changed=!0,this._updatedPaintProps[l.id]=!0,this._serializedLayers=null}getPaintProperty(l,p){return this.getLayer(l).getPaintProperty(p)}setFeatureState(l,p){this._checkLoaded();const b=l.source,S=l.sourceLayer,k=this.sourceCaches[b];if(k===void 0)return void this.fire(new a.k(new Error(`The source '${b}' does not exist in the map's style.`)));const R=k.getSource().type;R==="geojson"&&S?this.fire(new a.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):R!=="vector"||S?(l.id===void 0&&this.fire(new a.k(new Error("The feature id parameter must be provided."))),k.setFeatureState(S,l.id,p)):this.fire(new a.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(l,p){this._checkLoaded();const b=l.source,S=this.sourceCaches[b];if(S===void 0)return void this.fire(new a.k(new Error(`The source '${b}' does not exist in the map's style.`)));const k=S.getSource().type,R=k==="vector"?l.sourceLayer:void 0;k!=="vector"||R?p&&typeof l.id!="string"&&typeof l.id!="number"?this.fire(new a.k(new Error("A feature id is required to remove its specific state property."))):S.removeFeatureState(R,l.id,p):this.fire(new a.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(l){this._checkLoaded();const p=l.source,b=l.sourceLayer,S=this.sourceCaches[p];if(S!==void 0)return S.getSource().type!=="vector"||b?(l.id===void 0&&this.fire(new a.k(new Error("The feature id parameter must be provided."))),S.getFeatureState(b,l.id)):void this.fire(new a.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new a.k(new Error(`The source '${p}' does not exist in the map's style.`)))}getTransition(){return a.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const l=a.bN(this.sourceCaches,k=>k.serialize()),p=this._serializeByIds(this._order,!0),b=this.map.getTerrain()||void 0,S=this.stylesheet;return a.bO({version:S.version,name:S.name,metadata:S.metadata,light:S.light,sky:S.sky,center:S.center,zoom:S.zoom,bearing:S.bearing,pitch:S.pitch,sprite:S.sprite,glyphs:S.glyphs,transition:S.transition,projection:S.projection,sources:l,layers:p,terrain:b},k=>k!==void 0)}_updateLayer(l){this._updatedLayers[l.id]=!0,l.source&&!this._updatedSources[l.source]&&this.sourceCaches[l.source].getSource().type!=="raster"&&(this._updatedSources[l.source]="reload",this.sourceCaches[l.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(l){const p=R=>this._layers[R].type==="fill-extrusion",b={},S=[];for(let R=this._order.length-1;R>=0;R--){const W=this._order[R];if(p(W)){b[W]=R;for(const Z of l){const ie=Z[W];if(ie)for(const ce of ie)S.push(ce)}}}S.sort((R,W)=>W.intersectionZ-R.intersectionZ);const k=[];for(let R=this._order.length-1;R>=0;R--){const W=this._order[R];if(p(W))for(let Z=S.length-1;Z>=0;Z--){const ie=S[Z].feature;if(b[ie.layer.id]<R)break;k.push(ie),S.pop()}else for(const Z of l){const ie=Z[W];if(ie)for(const ce of ie)k.push(ce.feature)}}return k}queryRenderedFeatures(l,p,b){p&&p.filter&&this._validate(a.z.filter,"queryRenderedFeatures.filter",p.filter,null,p);const S={};if(p&&p.layers){if(!(Array.isArray(p.layers)||p.layers instanceof Set))return this.fire(new a.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const ie of p.layers){const ce=this._layers[ie];if(!ce)return this.fire(new a.k(new Error(`The layer '${ie}' does not exist in the map's style and cannot be queried for features.`))),[];S[ce.source]=!0}}const k=[];p.availableImages=this._availableImages;const R=this._serializedAllLayers(),W=p.layers instanceof Set?p.layers:Array.isArray(p.layers)?new Set(p.layers):null,Z=Object.assign(Object.assign({},p),{layers:W});for(const ie in this.sourceCaches)p.layers&&!S[ie]||k.push(Ye(this.sourceCaches[ie],this._layers,R,l,Z,b,this.map.terrain?(ce,xe,be)=>this.map.terrain.getElevation(ce,xe,be):void 0));return this.placement&&k.push(function(ie,ce,xe,be,Ae,Ue,lt){const it={},ft=Ue.queryRenderedSymbols(be),gt=[];for(const Et of Object.keys(ft).map(Number))gt.push(lt[Et]);gt.sort(et);for(const Et of gt){const Mt=Et.featureIndex.lookupSymbolFeatures(ft[Et.bucketInstanceId],ce,Et.bucketIndex,Et.sourceLayerIndex,Ae.filter,Ae.layers,Ae.availableImages,ie);for(const It in Mt){const jt=it[It]=it[It]||[],St=Mt[It];St.sort((Wt,ur)=>{const Jt=Et.featureSortOrder;if(Jt){const nr=Jt.indexOf(Wt.featureIndex);return Jt.indexOf(ur.featureIndex)-nr}return ur.featureIndex-Wt.featureIndex});for(const Wt of St)jt.push(Wt)}}return function(Et,Mt,It){for(const jt in Et)for(const St of Et[jt])Te(St,It[Mt[jt].source]);return Et}(it,ie,xe)}(this._layers,R,this.sourceCaches,l,Z,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(k)}querySourceFeatures(l,p){p&&p.filter&&this._validate(a.z.filter,"querySourceFeatures.filter",p.filter,null,p);const b=this.sourceCaches[l];return b?function(S,k){const R=S.getRenderableIds().map(ie=>S.getTileByID(ie)),W=[],Z={};for(let ie=0;ie<R.length;ie++){const ce=R[ie],xe=ce.tileID.canonical.key;Z[xe]||(Z[xe]=!0,ce.querySourceFeatures(W,k))}return W}(b,p):[]}getLight(){return this.light.getLight()}setLight(l,p={}){this._checkLoaded();const b=this.light.getLight();let S=!1;for(const R in l)if(!a.bH(l[R],b[R])){S=!0;break}if(!S)return;const k={now:_.now(),transition:a.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(l,p),this.light.updateTransitions(k)}getProjection(){var l;return(l=this.stylesheet)===null||l===void 0?void 0:l.projection}setProjection(l){if(this._checkLoaded(),this.projection){if(this.projection.name===l.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=l,this._setProjectionInternal(l.type)}getSky(){var l;return(l=this.stylesheet)===null||l===void 0?void 0:l.sky}setSky(l,p={}){this._checkLoaded();const b=this.getSky();let S=!1;if(!l&&!b)return;if(l&&!b)S=!0;else if(!l&&b)S=!0;else for(const R in l)if(!a.bH(l[R],b[R])){S=!0;break}if(!S)return;const k={now:_.now(),transition:a.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=l,this.sky.setSky(l,p),this.sky.updateTransitions(k)}_setProjectionInternal(l){const p=function(b){if(Array.isArray(b)){const S=new Yl({type:b});return{projection:S,transform:new Ko,cameraHelper:new ca(S)}}switch(b){case"mercator":return{projection:new Dr,transform:new ri,cameraHelper:new Mi};case"globe":{const S=new Yl({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:S,transform:new Ko,cameraHelper:new ca(S)}}case"vertical-perspective":return{projection:new hl,transform:new Ao,cameraHelper:new pi};default:return a.w(`Unknown projection name: ${b}. Falling back to mercator projection.`),{projection:new Dr,transform:new ri,cameraHelper:new Mi}}}(l);this.projection=p.projection,this.map.migrateProjection(p.transform,p.cameraHelper);for(const b in this.sourceCaches)this.sourceCaches[b].reload()}_validate(l,p,b,S,k={}){return(!k||k.validate!==!1)&&jo(this,l.call(a.z,a.e({key:p,style:this.serialize(),value:b,styleSpec:a.v},S)))}_remove(l=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),xr().off(wr,this._rtlPluginLoaded);for(const p in this._layers)this._layers[p].setEventedParent(null);for(const p in this.sourceCaches){const b=this.sourceCaches[p];b.setEventedParent(null),b.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),l&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(l)}_clearSource(l){this.sourceCaches[l].clearTiles()}_reloadSource(l){this.sourceCaches[l].resume(),this.sourceCaches[l].reload()}_updateSources(l){for(const p in this.sourceCaches)this.sourceCaches[p].update(l,this.map.terrain)}_generateCollisionBoxes(){for(const l in this.sourceCaches)this._reloadSource(l)}_updatePlacement(l,p,b,S,k=!1){let R=!1,W=!1;const Z={};for(const ie of this._order){const ce=this._layers[ie];if(ce.type!=="symbol")continue;if(!Z[ce.source]){const be=this.sourceCaches[ce.source];Z[ce.source]=be.getRenderableIds(!0).map(Ae=>be.getTileByID(Ae)).sort((Ae,Ue)=>Ue.tileID.overscaledZ-Ae.tileID.overscaledZ||(Ae.tileID.isLessThan(Ue.tileID)?-1:1))}const xe=this.crossTileSymbolIndex.addLayer(ce,Z[ce.source],l.center.lng);R=R||xe}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((k=k||this._layerOrderChanged||b===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(_.now(),l.zoom))&&(this.pauseablePlacement=new Xl(l,this.map.terrain,this._order,k,p,b,S,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Z),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(_.now()),W=!0),R&&this.pauseablePlacement.placement.setStale()),W||R)for(const ie of this._order){const ce=this._layers[ie];ce.type==="symbol"&&this.placement.updateLayerOpacities(ce,Z[ce.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(_.now())}_releaseSymbolFadeTiles(){for(const l in this.sourceCaches)this.sourceCaches[l].releaseSymbolFadeTiles()}getImages(l,p){return a._(this,void 0,void 0,function*(){const b=yield this.imageManager.getImages(p.icons);this._updateTilesForChangedImages();const S=this.sourceCaches[p.source];return S&&S.setDependencies(p.tileID.key,p.type,p.icons),b})}getGlyphs(l,p){return a._(this,void 0,void 0,function*(){const b=yield this.glyphManager.getGlyphs(p.stacks),S=this.sourceCaches[p.source];return S&&S.setDependencies(p.tileID.key,p.type,[""]),b})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(l,p={}){this._checkLoaded(),l&&this._validate(a.z.glyphs,"glyphs",l,null,p)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=l,this.glyphManager.entries={},this.glyphManager.setURL(l))}addSprite(l,p,b={},S){this._checkLoaded();const k=[{id:l,url:p}],R=[...N(this.stylesheet.sprite),...k];this._validate(a.z.sprite,"sprite",R,null,b)||(this.stylesheet.sprite=R,this._loadSprite(k,!0,S))}removeSprite(l){this._checkLoaded();const p=N(this.stylesheet.sprite);if(p.find(b=>b.id===l)){if(this._spritesImagesIds[l])for(const b of this._spritesImagesIds[l])this.imageManager.removeImage(b),this._changedImages[b]=!0;p.splice(p.findIndex(b=>b.id===l),1),this.stylesheet.sprite=p.length>0?p:void 0,delete this._spritesImagesIds[l],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"}))}else this.fire(new a.k(new Error(`Sprite "${l}" doesn't exists on this map.`)))}getSprite(){return N(this.stylesheet.sprite)}setSprite(l,p={},b){this._checkLoaded(),l&&this._validate(a.z.sprite,"sprite",l,null,p)||(this.stylesheet.sprite=l,l?this._loadSprite(l,!0,b):(this._unloadSprite(),b&&b(null)))}}var yc=a.aJ([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Wh{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(l,p,b,S,k,R,W,Z,ie){this.context=l;let ce=this.boundPaintVertexBuffers.length!==S.length;for(let xe=0;!ce&&xe<S.length;xe++)this.boundPaintVertexBuffers[xe]!==S[xe]&&(ce=!0);!this.vao||this.boundProgram!==p||this.boundLayoutVertexBuffer!==b||ce||this.boundIndexBuffer!==k||this.boundVertexOffset!==R||this.boundDynamicVertexBuffer!==W||this.boundDynamicVertexBuffer2!==Z||this.boundDynamicVertexBuffer3!==ie?this.freshBind(p,b,S,k,R,W,Z,ie):(l.bindVertexArray.set(this.vao),W&&W.bind(),k&&k.dynamicDraw&&k.bind(),Z&&Z.bind(),ie&&ie.bind())}freshBind(l,p,b,S,k,R,W,Z){const ie=l.numAttributes,ce=this.context,xe=ce.gl;this.vao&&this.destroy(),this.vao=ce.createVertexArray(),ce.bindVertexArray.set(this.vao),this.boundProgram=l,this.boundLayoutVertexBuffer=p,this.boundPaintVertexBuffers=b,this.boundIndexBuffer=S,this.boundVertexOffset=k,this.boundDynamicVertexBuffer=R,this.boundDynamicVertexBuffer2=W,this.boundDynamicVertexBuffer3=Z,p.enableAttributes(xe,l);for(const be of b)be.enableAttributes(xe,l);R&&R.enableAttributes(xe,l),W&&W.enableAttributes(xe,l),Z&&Z.enableAttributes(xe,l),p.bind(),p.setVertexAttribPointers(xe,l,k);for(const be of b)be.bind(),be.setVertexAttribPointers(xe,l,k);R&&(R.bind(),R.setVertexAttribPointers(xe,l,k)),S&&S.bind(),W&&(W.bind(),W.setVertexAttribPointers(xe,l,k)),Z&&(Z.bind(),Z.setVertexAttribPointers(xe,l,k)),ce.currentNumAttributes=ie}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const su=(A,l,p,b,S)=>({u_texture:0,u_ele_delta:A,u_fog_matrix:l,u_fog_color:p?p.properties.get("fog-color"):a.bf.white,u_fog_ground_blend:p?p.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:S?0:p?p.calculateFogBlendOpacity(b):0,u_horizon_color:p?p.properties.get("horizon-color"):a.bf.white,u_horizon_fog_blend:p?p.properties.get("horizon-fog-blend"):1,u_is_globe_mode:S?1:0}),ml={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Pa(A){const l=[];for(let p=0;p<A.length;p++){if(A[p]===null)continue;const b=A[p].split(" ");l.push(b.pop())}return l}class vc{constructor(l,p,b,S,k,R,W,Z,ie=[]){const ce=l.gl;this.program=ce.createProgram();const xe=Pa(p.staticAttributes),be=b?b.getBinderAttributes():[],Ae=xe.concat(be),Ue=Ft.prelude.staticUniforms?Pa(Ft.prelude.staticUniforms):[],lt=W.staticUniforms?Pa(W.staticUniforms):[],it=p.staticUniforms?Pa(p.staticUniforms):[],ft=b?b.getBinderUniforms():[],gt=Ue.concat(lt).concat(it).concat(ft),Et=[];for(const Jt of gt)Et.indexOf(Jt)<0&&Et.push(Jt);const Mt=b?b.defines():[];Qi(ce)&&Mt.unshift("#version 300 es"),k&&Mt.push("#define OVERDRAW_INSPECTOR;"),R&&Mt.push("#define TERRAIN3D;"),Z&&Mt.push(Z),ie&&Mt.push(...ie);let It=Mt.concat(Ft.prelude.fragmentSource,W.fragmentSource,p.fragmentSource).join(`
`),jt=Mt.concat(Ft.prelude.vertexSource,W.vertexSource,p.vertexSource).join(`
`);Qi(ce)||(It=function(Jt){return Jt.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(It),jt=function(Jt){return Jt.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(jt));const St=ce.createShader(ce.FRAGMENT_SHADER);if(ce.isContextLost())return void(this.failedToCreate=!0);if(ce.shaderSource(St,It),ce.compileShader(St),!ce.getShaderParameter(St,ce.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${ce.getShaderInfoLog(St)}`);ce.attachShader(this.program,St);const Wt=ce.createShader(ce.VERTEX_SHADER);if(ce.isContextLost())return void(this.failedToCreate=!0);if(ce.shaderSource(Wt,jt),ce.compileShader(Wt),!ce.getShaderParameter(Wt,ce.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${ce.getShaderInfoLog(Wt)}`);ce.attachShader(this.program,Wt),this.attributes={};const ur={};this.numAttributes=Ae.length;for(let Jt=0;Jt<this.numAttributes;Jt++)Ae[Jt]&&(ce.bindAttribLocation(this.program,Jt,Ae[Jt]),this.attributes[Ae[Jt]]=Jt);if(ce.linkProgram(this.program),!ce.getProgramParameter(this.program,ce.LINK_STATUS))throw new Error(`Program failed to link: ${ce.getProgramInfoLog(this.program)}`);ce.deleteShader(Wt),ce.deleteShader(St);for(let Jt=0;Jt<Et.length;Jt++){const nr=Et[Jt];if(nr&&!ur[nr]){const cr=ce.getUniformLocation(this.program,nr);cr&&(ur[nr]=cr)}}this.fixedUniforms=S(l,ur),this.terrainUniforms=((Jt,nr)=>({u_depth:new a.bP(Jt,nr.u_depth),u_terrain:new a.bP(Jt,nr.u_terrain),u_terrain_dim:new a.bg(Jt,nr.u_terrain_dim),u_terrain_matrix:new a.bR(Jt,nr.u_terrain_matrix),u_terrain_unpack:new a.bS(Jt,nr.u_terrain_unpack),u_terrain_exaggeration:new a.bg(Jt,nr.u_terrain_exaggeration)}))(l,ur),this.projectionUniforms=((Jt,nr)=>({u_projection_matrix:new a.bR(Jt,nr.u_projection_matrix),u_projection_tile_mercator_coords:new a.bS(Jt,nr.u_projection_tile_mercator_coords),u_projection_clipping_plane:new a.bS(Jt,nr.u_projection_clipping_plane),u_projection_transition:new a.bg(Jt,nr.u_projection_transition),u_projection_fallback_matrix:new a.bR(Jt,nr.u_projection_fallback_matrix)}))(l,ur),this.binderUniforms=b?b.getUniforms(l,ur):[]}draw(l,p,b,S,k,R,W,Z,ie,ce,xe,be,Ae,Ue,lt,it,ft,gt,Et){const Mt=l.gl;if(this.failedToCreate)return;if(l.program.set(this.program),l.setDepthMode(b),l.setStencilMode(S),l.setColorMode(k),l.setCullFace(R),Z){l.activeTexture.set(Mt.TEXTURE2),Mt.bindTexture(Mt.TEXTURE_2D,Z.depthTexture),l.activeTexture.set(Mt.TEXTURE3),Mt.bindTexture(Mt.TEXTURE_2D,Z.texture);for(const jt in this.terrainUniforms)this.terrainUniforms[jt].set(Z[jt])}if(ie)for(const jt in ie)this.projectionUniforms[ml[jt]].set(ie[jt]);if(W)for(const jt in this.fixedUniforms)this.fixedUniforms[jt].set(W[jt]);it&&it.setUniforms(l,this.binderUniforms,Ue,{zoom:lt});let It=0;switch(p){case Mt.LINES:It=2;break;case Mt.TRIANGLES:It=3;break;case Mt.LINE_STRIP:It=1}for(const jt of Ae.get()){const St=jt.vaos||(jt.vaos={});(St[ce]||(St[ce]=new Wh)).bind(l,this,xe,it?it.getPaintVertexBuffers():[],be,jt.vertexOffset,ft,gt,Et),Mt.drawElements(p,jt.primitiveLength*It,Mt.UNSIGNED_SHORT,jt.primitiveOffset*It*2)}}}function bc(A,l,p){const b=1/a.aC(p,1,l.transform.tileZoom),S=Math.pow(2,p.tileID.overscaledZ),k=p.tileSize*Math.pow(2,l.transform.tileZoom)/S,R=k*(p.tileID.canonical.x+p.tileID.wrap*S),W=k*p.tileID.canonical.y;return{u_image:0,u_texsize:p.imageAtlasTexture.size,u_scale:[b,A.fromScale,A.toScale],u_fade:A.t,u_pixel_coord_upper:[R>>16,W>>16],u_pixel_coord_lower:[65535&R,65535&W]}}const La=(A,l,p,b)=>{const S=A.style.light,k=S.properties.get("position"),R=[k.x,k.y,k.z],W=a.bV();S.properties.get("anchor")==="viewport"&&a.bW(W,A.transform.bearingInRadians),a.bX(R,R,W);const Z=A.transform.transformLightDirection(R),ie=S.properties.get("color");return{u_lightpos:R,u_lightpos_globe:Z,u_lightintensity:S.properties.get("intensity"),u_lightcolor:[ie.r,ie.g,ie.b],u_vertical_gradient:+l,u_opacity:p,u_fill_translate:b}},Da=(A,l,p,b,S,k,R)=>a.e(La(A,l,p,b),bc(k,A,R),{u_height_factor:-Math.pow(2,S.overscaledZ)/R.tileSize/8}),gl=(A,l,p,b)=>a.e(bc(l,A,p),{u_fill_translate:b}),Ys=(A,l)=>({u_world:A,u_fill_translate:l}),Ql=(A,l,p,b,S)=>a.e(gl(A,l,p,S),{u_world:b}),Yu=(A,l,p,b,S)=>{const k=A.transform;let R,W,Z=0;if(p.paint.get("circle-pitch-alignment")==="map"){const ie=a.aC(l,1,k.zoom);R=!0,W=[ie,ie],Z=ie/(a.$*Math.pow(2,l.tileID.overscaledZ))*2*Math.PI*S}else R=!1,W=k.pixelsToGLUnits;return{u_camera_to_center_distance:k.cameraToCenterDistance,u_scale_with_map:+(p.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+R,u_device_pixel_ratio:A.pixelRatio,u_extrude_scale:W,u_globe_extrude_scale:Z,u_translate:b}},$a=A=>({u_pixel_extrude_scale:[1/A.width,1/A.height]}),Vc=A=>({u_viewport_size:[A.width,A.height]}),as=(A,l=1)=>({u_color:A,u_overlay:0,u_overlay_scale:l}),Wc=(A,l,p,b)=>{const S=a.aC(A,1,l)/(a.$*Math.pow(2,A.tileID.overscaledZ))*2*Math.PI*b;return{u_extrude_scale:a.aC(A,1,l),u_intensity:p,u_globe_extrude_scale:S}},ua=(A,l,p,b)=>{const S=a.L();a.bY(S,0,A.width,A.height,0,0,1);const k=A.context.gl;return{u_matrix:S,u_world:[k.drawingBufferWidth,k.drawingBufferHeight],u_image:p,u_color_ramp:b,u_opacity:l.paint.get("heatmap-opacity")}},_l=(A,l,p)=>{const b=p.paint.get("hillshade-accent-color");let S;switch(p.paint.get("hillshade-method")){case"basic":S=4;break;case"combined":S=1;break;case"igor":S=2;break;case"multidirectional":S=3;break;default:S=0}const k=p.getIlluminationProperties();for(let R=0;R<k.directionRadians.length;R++)p.paint.get("hillshade-illumination-anchor")==="viewport"&&(k.directionRadians[R]+=A.transform.bearingInRadians);return{u_image:0,u_latrange:Ns(0,l.tileID),u_exaggeration:p.paint.get("hillshade-exaggeration"),u_altitudes:k.altitudeRadians,u_azimuths:k.directionRadians,u_accent:b,u_method:S,u_highlights:k.highlightColor,u_shadows:k.shadowColor}},xc=(A,l)=>{const p=l.stride,b=a.L();return a.bY(b,0,a.$,-a.$,0,0,1),a.M(b,b,[0,-a.$,0]),{u_matrix:b,u_image:1,u_dimension:[p,p],u_zoom:A.overscaledZ,u_unpack:l.getUnpackVector()}};function Ns(A,l){const p=Math.pow(2,l.canonical.z),b=l.canonical.y;return[new a.a1(0,b/p).toLngLat().lat,new a.a1(0,(b+1)/p).toLngLat().lat]}const Jl=(A,l,p=0)=>({u_image:0,u_unpack:l.getUnpackVector(),u_dimension:[l.stride,l.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:p,u_opacity:A.paint.get("color-relief-opacity")}),wc=(A,l,p,b)=>{const S=A.transform;return{u_translation:ec(A,l,p),u_ratio:b/a.aC(l,1,S.zoom),u_device_pixel_ratio:A.pixelRatio,u_units_to_pixels:[1/S.pixelsToGLUnits[0],1/S.pixelsToGLUnits[1]]}},ss=(A,l,p,b,S)=>a.e(wc(A,l,p,b),{u_image:0,u_image_height:S}),Ts=(A,l,p,b,S)=>{const k=A.transform,R=Rs(l,k);return{u_translation:ec(A,l,p),u_texsize:l.imageAtlasTexture.size,u_ratio:b/a.aC(l,1,k.zoom),u_device_pixel_ratio:A.pixelRatio,u_image:0,u_scale:[R,S.fromScale,S.toScale],u_fade:S.t,u_units_to_pixels:[1/k.pixelsToGLUnits[0],1/k.pixelsToGLUnits[1]]}},js=(A,l,p,b,S,k)=>{const R=A.lineAtlas,W=Rs(l,A.transform),Z=p.layout.get("line-cap")==="round",ie=R.getDash(S.from,Z),ce=R.getDash(S.to,Z),xe=ie.width*k.fromScale,be=ce.width*k.toScale;return a.e(wc(A,l,p,b),{u_patternscale_a:[W/xe,-ie.height/2],u_patternscale_b:[W/be,-ce.height/2],u_sdfgamma:R.width/(256*Math.min(xe,be)*A.pixelRatio)/2,u_image:0,u_tex_y_a:ie.y,u_tex_y_b:ce.y,u_mix:k.t})};function Rs(A,l){return 1/a.aC(A,1,l.tileZoom)}function ec(A,l,p){return a.aD(A.transform,l,p.paint.get("line-translate"),p.paint.get("line-translate-anchor"))}const tc=(A,l,p,b,S)=>{return{u_tl_parent:A,u_scale_parent:l,u_buffer_scale:1,u_fade_t:p.mix,u_opacity:p.opacity*b.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:b.paint.get("raster-brightness-min"),u_brightness_high:b.paint.get("raster-brightness-max"),u_saturation_factor:(R=b.paint.get("raster-saturation"),R>0?1-1/(1.001-R):-R),u_contrast_factor:(k=b.paint.get("raster-contrast"),k>0?1/(1-k):1+k),u_spin_weights:Mc(b.paint.get("raster-hue-rotate")),u_coords_top:[S[0].x,S[0].y,S[1].x,S[1].y],u_coords_bottom:[S[3].x,S[3].y,S[2].x,S[2].y]};var k,R};function Mc(A){A*=Math.PI/180;const l=Math.sin(A),p=Math.cos(A);return[(2*p+1)/3,(-Math.sqrt(3)*l-p+1)/3,(Math.sqrt(3)*l-p+1)/3]}const Co=(A,l,p,b,S,k,R,W,Z,ie,ce,xe,be)=>{const Ae=R.transform;return{u_is_size_zoom_constant:+(A==="constant"||A==="source"),u_is_size_feature_constant:+(A==="constant"||A==="camera"),u_size_t:l?l.uSizeT:0,u_size:l?l.uSize:0,u_camera_to_center_distance:Ae.cameraToCenterDistance,u_pitch:Ae.pitch/360*2*Math.PI,u_rotate_symbol:+p,u_aspect_ratio:Ae.width/Ae.height,u_fade_change:R.options.fadeDuration?R.symbolFadeChange:1,u_label_plane_matrix:W,u_coord_matrix:Z,u_is_text:+ce,u_pitch_with_map:+b,u_is_along_line:S,u_is_variable_anchor:k,u_texsize:xe,u_texture:0,u_translation:ie,u_pitched_scale:be}},$n=(A,l,p,b,S,k,R,W,Z,ie,ce,xe,be,Ae)=>{const Ue=R.transform;return a.e(Co(A,l,p,b,S,k,R,W,Z,ie,ce,xe,Ae),{u_gamma_scale:b?Math.cos(Ue.pitch*Math.PI/180)*Ue.cameraToCenterDistance:1,u_device_pixel_ratio:R.pixelRatio,u_is_halo:1})},yl=(A,l,p,b,S,k,R,W,Z,ie,ce,xe,be)=>a.e($n(A,l,p,b,S,k,R,W,Z,ie,!0,ce,0,be),{u_texsize_icon:xe,u_texture_icon:1}),vl=(A,l)=>({u_opacity:A,u_color:l}),Gc=(A,l,p,b,S)=>a.e(function(k,R,W,Z){const ie=W.imageManager.getPattern(k.from.toString()),ce=W.imageManager.getPattern(k.to.toString()),{width:xe,height:be}=W.imageManager.getPixelSize(),Ae=Math.pow(2,Z.tileID.overscaledZ),Ue=Z.tileSize*Math.pow(2,W.transform.tileZoom)/Ae,lt=Ue*(Z.tileID.canonical.x+Z.tileID.wrap*Ae),it=Ue*Z.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:ie.tl,u_pattern_br_a:ie.br,u_pattern_tl_b:ce.tl,u_pattern_br_b:ce.br,u_texsize:[xe,be],u_mix:R.t,u_pattern_size_a:ie.displaySize,u_pattern_size_b:ce.displaySize,u_scale_a:R.fromScale,u_scale_b:R.toScale,u_tile_units_to_pixels:1/a.aC(Z,1,W.transform.tileZoom),u_pixel_coord_upper:[lt>>16,it>>16],u_pixel_coord_lower:[65535&lt,65535&it]}}(p,S,l,b),{u_opacity:A}),rc=(A,l)=>{},Na={fillExtrusion:(A,l)=>({u_lightpos:new a.bT(A,l.u_lightpos),u_lightpos_globe:new a.bT(A,l.u_lightpos_globe),u_lightintensity:new a.bg(A,l.u_lightintensity),u_lightcolor:new a.bT(A,l.u_lightcolor),u_vertical_gradient:new a.bg(A,l.u_vertical_gradient),u_opacity:new a.bg(A,l.u_opacity),u_fill_translate:new a.bU(A,l.u_fill_translate)}),fillExtrusionPattern:(A,l)=>({u_lightpos:new a.bT(A,l.u_lightpos),u_lightpos_globe:new a.bT(A,l.u_lightpos_globe),u_lightintensity:new a.bg(A,l.u_lightintensity),u_lightcolor:new a.bT(A,l.u_lightcolor),u_vertical_gradient:new a.bg(A,l.u_vertical_gradient),u_height_factor:new a.bg(A,l.u_height_factor),u_opacity:new a.bg(A,l.u_opacity),u_fill_translate:new a.bU(A,l.u_fill_translate),u_image:new a.bP(A,l.u_image),u_texsize:new a.bU(A,l.u_texsize),u_pixel_coord_upper:new a.bU(A,l.u_pixel_coord_upper),u_pixel_coord_lower:new a.bU(A,l.u_pixel_coord_lower),u_scale:new a.bT(A,l.u_scale),u_fade:new a.bg(A,l.u_fade)}),fill:(A,l)=>({u_fill_translate:new a.bU(A,l.u_fill_translate)}),fillPattern:(A,l)=>({u_image:new a.bP(A,l.u_image),u_texsize:new a.bU(A,l.u_texsize),u_pixel_coord_upper:new a.bU(A,l.u_pixel_coord_upper),u_pixel_coord_lower:new a.bU(A,l.u_pixel_coord_lower),u_scale:new a.bT(A,l.u_scale),u_fade:new a.bg(A,l.u_fade),u_fill_translate:new a.bU(A,l.u_fill_translate)}),fillOutline:(A,l)=>({u_world:new a.bU(A,l.u_world),u_fill_translate:new a.bU(A,l.u_fill_translate)}),fillOutlinePattern:(A,l)=>({u_world:new a.bU(A,l.u_world),u_image:new a.bP(A,l.u_image),u_texsize:new a.bU(A,l.u_texsize),u_pixel_coord_upper:new a.bU(A,l.u_pixel_coord_upper),u_pixel_coord_lower:new a.bU(A,l.u_pixel_coord_lower),u_scale:new a.bT(A,l.u_scale),u_fade:new a.bg(A,l.u_fade),u_fill_translate:new a.bU(A,l.u_fill_translate)}),circle:(A,l)=>({u_camera_to_center_distance:new a.bg(A,l.u_camera_to_center_distance),u_scale_with_map:new a.bP(A,l.u_scale_with_map),u_pitch_with_map:new a.bP(A,l.u_pitch_with_map),u_extrude_scale:new a.bU(A,l.u_extrude_scale),u_device_pixel_ratio:new a.bg(A,l.u_device_pixel_ratio),u_globe_extrude_scale:new a.bg(A,l.u_globe_extrude_scale),u_translate:new a.bU(A,l.u_translate)}),collisionBox:(A,l)=>({u_pixel_extrude_scale:new a.bU(A,l.u_pixel_extrude_scale)}),collisionCircle:(A,l)=>({u_viewport_size:new a.bU(A,l.u_viewport_size)}),debug:(A,l)=>({u_color:new a.bQ(A,l.u_color),u_overlay:new a.bP(A,l.u_overlay),u_overlay_scale:new a.bg(A,l.u_overlay_scale)}),depth:rc,clippingMask:rc,heatmap:(A,l)=>({u_extrude_scale:new a.bg(A,l.u_extrude_scale),u_intensity:new a.bg(A,l.u_intensity),u_globe_extrude_scale:new a.bg(A,l.u_globe_extrude_scale)}),heatmapTexture:(A,l)=>({u_matrix:new a.bR(A,l.u_matrix),u_world:new a.bU(A,l.u_world),u_image:new a.bP(A,l.u_image),u_color_ramp:new a.bP(A,l.u_color_ramp),u_opacity:new a.bg(A,l.u_opacity)}),hillshade:(A,l)=>({u_image:new a.bP(A,l.u_image),u_latrange:new a.bU(A,l.u_latrange),u_exaggeration:new a.bg(A,l.u_exaggeration),u_altitudes:new a.b_(A,l.u_altitudes),u_azimuths:new a.b_(A,l.u_azimuths),u_accent:new a.bQ(A,l.u_accent),u_method:new a.bP(A,l.u_method),u_shadows:new a.bZ(A,l.u_shadows),u_highlights:new a.bZ(A,l.u_highlights)}),hillshadePrepare:(A,l)=>({u_matrix:new a.bR(A,l.u_matrix),u_image:new a.bP(A,l.u_image),u_dimension:new a.bU(A,l.u_dimension),u_zoom:new a.bg(A,l.u_zoom),u_unpack:new a.bS(A,l.u_unpack)}),colorRelief:(A,l)=>({u_image:new a.bP(A,l.u_image),u_unpack:new a.bS(A,l.u_unpack),u_dimension:new a.bU(A,l.u_dimension),u_elevation_stops:new a.bP(A,l.u_elevation_stops),u_color_stops:new a.bP(A,l.u_color_stops),u_color_ramp_size:new a.bP(A,l.u_color_ramp_size),u_opacity:new a.bg(A,l.u_opacity)}),line:(A,l)=>({u_translation:new a.bU(A,l.u_translation),u_ratio:new a.bg(A,l.u_ratio),u_device_pixel_ratio:new a.bg(A,l.u_device_pixel_ratio),u_units_to_pixels:new a.bU(A,l.u_units_to_pixels)}),lineGradient:(A,l)=>({u_translation:new a.bU(A,l.u_translation),u_ratio:new a.bg(A,l.u_ratio),u_device_pixel_ratio:new a.bg(A,l.u_device_pixel_ratio),u_units_to_pixels:new a.bU(A,l.u_units_to_pixels),u_image:new a.bP(A,l.u_image),u_image_height:new a.bg(A,l.u_image_height)}),linePattern:(A,l)=>({u_translation:new a.bU(A,l.u_translation),u_texsize:new a.bU(A,l.u_texsize),u_ratio:new a.bg(A,l.u_ratio),u_device_pixel_ratio:new a.bg(A,l.u_device_pixel_ratio),u_image:new a.bP(A,l.u_image),u_units_to_pixels:new a.bU(A,l.u_units_to_pixels),u_scale:new a.bT(A,l.u_scale),u_fade:new a.bg(A,l.u_fade)}),lineSDF:(A,l)=>({u_translation:new a.bU(A,l.u_translation),u_ratio:new a.bg(A,l.u_ratio),u_device_pixel_ratio:new a.bg(A,l.u_device_pixel_ratio),u_units_to_pixels:new a.bU(A,l.u_units_to_pixels),u_patternscale_a:new a.bU(A,l.u_patternscale_a),u_patternscale_b:new a.bU(A,l.u_patternscale_b),u_sdfgamma:new a.bg(A,l.u_sdfgamma),u_image:new a.bP(A,l.u_image),u_tex_y_a:new a.bg(A,l.u_tex_y_a),u_tex_y_b:new a.bg(A,l.u_tex_y_b),u_mix:new a.bg(A,l.u_mix)}),raster:(A,l)=>({u_tl_parent:new a.bU(A,l.u_tl_parent),u_scale_parent:new a.bg(A,l.u_scale_parent),u_buffer_scale:new a.bg(A,l.u_buffer_scale),u_fade_t:new a.bg(A,l.u_fade_t),u_opacity:new a.bg(A,l.u_opacity),u_image0:new a.bP(A,l.u_image0),u_image1:new a.bP(A,l.u_image1),u_brightness_low:new a.bg(A,l.u_brightness_low),u_brightness_high:new a.bg(A,l.u_brightness_high),u_saturation_factor:new a.bg(A,l.u_saturation_factor),u_contrast_factor:new a.bg(A,l.u_contrast_factor),u_spin_weights:new a.bT(A,l.u_spin_weights),u_coords_top:new a.bS(A,l.u_coords_top),u_coords_bottom:new a.bS(A,l.u_coords_bottom)}),symbolIcon:(A,l)=>({u_is_size_zoom_constant:new a.bP(A,l.u_is_size_zoom_constant),u_is_size_feature_constant:new a.bP(A,l.u_is_size_feature_constant),u_size_t:new a.bg(A,l.u_size_t),u_size:new a.bg(A,l.u_size),u_camera_to_center_distance:new a.bg(A,l.u_camera_to_center_distance),u_pitch:new a.bg(A,l.u_pitch),u_rotate_symbol:new a.bP(A,l.u_rotate_symbol),u_aspect_ratio:new a.bg(A,l.u_aspect_ratio),u_fade_change:new a.bg(A,l.u_fade_change),u_label_plane_matrix:new a.bR(A,l.u_label_plane_matrix),u_coord_matrix:new a.bR(A,l.u_coord_matrix),u_is_text:new a.bP(A,l.u_is_text),u_pitch_with_map:new a.bP(A,l.u_pitch_with_map),u_is_along_line:new a.bP(A,l.u_is_along_line),u_is_variable_anchor:new a.bP(A,l.u_is_variable_anchor),u_texsize:new a.bU(A,l.u_texsize),u_texture:new a.bP(A,l.u_texture),u_translation:new a.bU(A,l.u_translation),u_pitched_scale:new a.bg(A,l.u_pitched_scale)}),symbolSDF:(A,l)=>({u_is_size_zoom_constant:new a.bP(A,l.u_is_size_zoom_constant),u_is_size_feature_constant:new a.bP(A,l.u_is_size_feature_constant),u_size_t:new a.bg(A,l.u_size_t),u_size:new a.bg(A,l.u_size),u_camera_to_center_distance:new a.bg(A,l.u_camera_to_center_distance),u_pitch:new a.bg(A,l.u_pitch),u_rotate_symbol:new a.bP(A,l.u_rotate_symbol),u_aspect_ratio:new a.bg(A,l.u_aspect_ratio),u_fade_change:new a.bg(A,l.u_fade_change),u_label_plane_matrix:new a.bR(A,l.u_label_plane_matrix),u_coord_matrix:new a.bR(A,l.u_coord_matrix),u_is_text:new a.bP(A,l.u_is_text),u_pitch_with_map:new a.bP(A,l.u_pitch_with_map),u_is_along_line:new a.bP(A,l.u_is_along_line),u_is_variable_anchor:new a.bP(A,l.u_is_variable_anchor),u_texsize:new a.bU(A,l.u_texsize),u_texture:new a.bP(A,l.u_texture),u_gamma_scale:new a.bg(A,l.u_gamma_scale),u_device_pixel_ratio:new a.bg(A,l.u_device_pixel_ratio),u_is_halo:new a.bP(A,l.u_is_halo),u_translation:new a.bU(A,l.u_translation),u_pitched_scale:new a.bg(A,l.u_pitched_scale)}),symbolTextAndIcon:(A,l)=>({u_is_size_zoom_constant:new a.bP(A,l.u_is_size_zoom_constant),u_is_size_feature_constant:new a.bP(A,l.u_is_size_feature_constant),u_size_t:new a.bg(A,l.u_size_t),u_size:new a.bg(A,l.u_size),u_camera_to_center_distance:new a.bg(A,l.u_camera_to_center_distance),u_pitch:new a.bg(A,l.u_pitch),u_rotate_symbol:new a.bP(A,l.u_rotate_symbol),u_aspect_ratio:new a.bg(A,l.u_aspect_ratio),u_fade_change:new a.bg(A,l.u_fade_change),u_label_plane_matrix:new a.bR(A,l.u_label_plane_matrix),u_coord_matrix:new a.bR(A,l.u_coord_matrix),u_is_text:new a.bP(A,l.u_is_text),u_pitch_with_map:new a.bP(A,l.u_pitch_with_map),u_is_along_line:new a.bP(A,l.u_is_along_line),u_is_variable_anchor:new a.bP(A,l.u_is_variable_anchor),u_texsize:new a.bU(A,l.u_texsize),u_texsize_icon:new a.bU(A,l.u_texsize_icon),u_texture:new a.bP(A,l.u_texture),u_texture_icon:new a.bP(A,l.u_texture_icon),u_gamma_scale:new a.bg(A,l.u_gamma_scale),u_device_pixel_ratio:new a.bg(A,l.u_device_pixel_ratio),u_is_halo:new a.bP(A,l.u_is_halo),u_translation:new a.bU(A,l.u_translation),u_pitched_scale:new a.bg(A,l.u_pitched_scale)}),background:(A,l)=>({u_opacity:new a.bg(A,l.u_opacity),u_color:new a.bQ(A,l.u_color)}),backgroundPattern:(A,l)=>({u_opacity:new a.bg(A,l.u_opacity),u_image:new a.bP(A,l.u_image),u_pattern_tl_a:new a.bU(A,l.u_pattern_tl_a),u_pattern_br_a:new a.bU(A,l.u_pattern_br_a),u_pattern_tl_b:new a.bU(A,l.u_pattern_tl_b),u_pattern_br_b:new a.bU(A,l.u_pattern_br_b),u_texsize:new a.bU(A,l.u_texsize),u_mix:new a.bg(A,l.u_mix),u_pattern_size_a:new a.bU(A,l.u_pattern_size_a),u_pattern_size_b:new a.bU(A,l.u_pattern_size_b),u_scale_a:new a.bg(A,l.u_scale_a),u_scale_b:new a.bg(A,l.u_scale_b),u_pixel_coord_upper:new a.bU(A,l.u_pixel_coord_upper),u_pixel_coord_lower:new a.bU(A,l.u_pixel_coord_lower),u_tile_units_to_pixels:new a.bg(A,l.u_tile_units_to_pixels)}),terrain:(A,l)=>({u_texture:new a.bP(A,l.u_texture),u_ele_delta:new a.bg(A,l.u_ele_delta),u_fog_matrix:new a.bR(A,l.u_fog_matrix),u_fog_color:new a.bQ(A,l.u_fog_color),u_fog_ground_blend:new a.bg(A,l.u_fog_ground_blend),u_fog_ground_blend_opacity:new a.bg(A,l.u_fog_ground_blend_opacity),u_horizon_color:new a.bQ(A,l.u_horizon_color),u_horizon_fog_blend:new a.bg(A,l.u_horizon_fog_blend),u_is_globe_mode:new a.bg(A,l.u_is_globe_mode)}),terrainDepth:(A,l)=>({u_ele_delta:new a.bg(A,l.u_ele_delta)}),terrainCoords:(A,l)=>({u_texture:new a.bP(A,l.u_texture),u_terrain_coords_id:new a.bg(A,l.u_terrain_coords_id),u_ele_delta:new a.bg(A,l.u_ele_delta)}),projectionErrorMeasurement:(A,l)=>({u_input:new a.bg(A,l.u_input),u_output_expected:new a.bg(A,l.u_output_expected)}),atmosphere:(A,l)=>({u_sun_pos:new a.bT(A,l.u_sun_pos),u_atmosphere_blend:new a.bg(A,l.u_atmosphere_blend),u_globe_position:new a.bT(A,l.u_globe_position),u_globe_radius:new a.bg(A,l.u_globe_radius),u_inv_proj_matrix:new a.bR(A,l.u_inv_proj_matrix)}),sky:(A,l)=>({u_sky_color:new a.bQ(A,l.u_sky_color),u_horizon_color:new a.bQ(A,l.u_horizon_color),u_horizon:new a.bU(A,l.u_horizon),u_horizon_normal:new a.bU(A,l.u_horizon_normal),u_sky_horizon_blend:new a.bg(A,l.u_sky_horizon_blend),u_sky_blend:new a.bg(A,l.u_sky_blend)})};class nc{constructor(l,p,b){this.context=l;const S=l.gl;this.buffer=S.createBuffer(),this.dynamicDraw=!!b,this.context.unbindVAO(),l.bindElementBuffer.set(this.buffer),S.bufferData(S.ELEMENT_ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||delete p.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(l){const p=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),p.bufferSubData(p.ELEMENT_ARRAY_BUFFER,0,l.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const bl={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class qa{constructor(l,p,b,S){this.length=p.length,this.attributes=b,this.itemSize=p.bytesPerElement,this.dynamicDraw=S,this.context=l;const k=l.gl;this.buffer=k.createBuffer(),l.bindVertexBuffer.set(this.buffer),k.bufferData(k.ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?k.DYNAMIC_DRAW:k.STATIC_DRAW),this.dynamicDraw||delete p.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(l){if(l.length!==this.length)throw new Error(`Length of new data is ${l.length}, which doesn't match current length of ${this.length}`);const p=this.context.gl;this.bind(),p.bufferSubData(p.ARRAY_BUFFER,0,l.arrayBuffer)}enableAttributes(l,p){for(let b=0;b<this.attributes.length;b++){const S=p.attributes[this.attributes[b].name];S!==void 0&&l.enableVertexAttribArray(S)}}setVertexAttribPointers(l,p,b){for(let S=0;S<this.attributes.length;S++){const k=this.attributes[S],R=p.attributes[k.name];R!==void 0&&l.vertexAttribPointer(R,k.components,l[bl[k.type]],!1,this.itemSize,k.offset+this.itemSize*(b||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class bi{constructor(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(l){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class qc extends bi{getDefault(){return a.bf.transparent}set(l){const p=this.current;(l.r!==p.r||l.g!==p.g||l.b!==p.b||l.a!==p.a||this.dirty)&&(this.gl.clearColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class ja extends bi{getDefault(){return 1}set(l){(l!==this.current||this.dirty)&&(this.gl.clearDepth(l),this.current=l,this.dirty=!1)}}class xl extends bi{getDefault(){return 0}set(l){(l!==this.current||this.dirty)&&(this.gl.clearStencil(l),this.current=l,this.dirty=!1)}}class So extends bi{getDefault(){return[!0,!0,!0,!0]}set(l){const p=this.current;(l[0]!==p[0]||l[1]!==p[1]||l[2]!==p[2]||l[3]!==p[3]||this.dirty)&&(this.gl.colorMask(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class Ji extends bi{getDefault(){return!0}set(l){(l!==this.current||this.dirty)&&(this.gl.depthMask(l),this.current=l,this.dirty=!1)}}class Fo extends bi{getDefault(){return 255}set(l){(l!==this.current||this.dirty)&&(this.gl.stencilMask(l),this.current=l,this.dirty=!1)}}class na extends bi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(l){const p=this.current;(l.func!==p.func||l.ref!==p.ref||l.mask!==p.mask||this.dirty)&&(this.gl.stencilFunc(l.func,l.ref,l.mask),this.current=l,this.dirty=!1)}}class wl extends bi{getDefault(){const l=this.gl;return[l.KEEP,l.KEEP,l.KEEP]}set(l){const p=this.current;(l[0]!==p[0]||l[1]!==p[1]||l[2]!==p[2]||this.dirty)&&(this.gl.stencilOp(l[0],l[1],l[2]),this.current=l,this.dirty=!1)}}class lu extends bi{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;l?p.enable(p.STENCIL_TEST):p.disable(p.STENCIL_TEST),this.current=l,this.dirty=!1}}class $l extends bi{getDefault(){return[0,1]}set(l){const p=this.current;(l[0]!==p[0]||l[1]!==p[1]||this.dirty)&&(this.gl.depthRange(l[0],l[1]),this.current=l,this.dirty=!1)}}class Hc extends bi{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;l?p.enable(p.DEPTH_TEST):p.disable(p.DEPTH_TEST),this.current=l,this.dirty=!1}}class oh extends bi{getDefault(){return this.gl.LESS}set(l){(l!==this.current||this.dirty)&&(this.gl.depthFunc(l),this.current=l,this.dirty=!1)}}class yd extends bi{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;l?p.enable(p.BLEND):p.disable(p.BLEND),this.current=l,this.dirty=!1}}class cu extends bi{getDefault(){const l=this.gl;return[l.ONE,l.ZERO]}set(l){const p=this.current;(l[0]!==p[0]||l[1]!==p[1]||this.dirty)&&(this.gl.blendFunc(l[0],l[1]),this.current=l,this.dirty=!1)}}class Y extends bi{getDefault(){return a.bf.transparent}set(l){const p=this.current;(l.r!==p.r||l.g!==p.g||l.b!==p.b||l.a!==p.a||this.dirty)&&(this.gl.blendColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class he extends bi{getDefault(){return this.gl.FUNC_ADD}set(l){(l!==this.current||this.dirty)&&(this.gl.blendEquation(l),this.current=l,this.dirty=!1)}}class Oe extends bi{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;l?p.enable(p.CULL_FACE):p.disable(p.CULL_FACE),this.current=l,this.dirty=!1}}class Ke extends bi{getDefault(){return this.gl.BACK}set(l){(l!==this.current||this.dirty)&&(this.gl.cullFace(l),this.current=l,this.dirty=!1)}}class at extends bi{getDefault(){return this.gl.CCW}set(l){(l!==this.current||this.dirty)&&(this.gl.frontFace(l),this.current=l,this.dirty=!1)}}class Ht extends bi{getDefault(){return null}set(l){(l!==this.current||this.dirty)&&(this.gl.useProgram(l),this.current=l,this.dirty=!1)}}class gr extends bi{getDefault(){return this.gl.TEXTURE0}set(l){(l!==this.current||this.dirty)&&(this.gl.activeTexture(l),this.current=l,this.dirty=!1)}}class Wr extends bi{getDefault(){const l=this.gl;return[0,0,l.drawingBufferWidth,l.drawingBufferHeight]}set(l){const p=this.current;(l[0]!==p[0]||l[1]!==p[1]||l[2]!==p[2]||l[3]!==p[3]||this.dirty)&&(this.gl.viewport(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class cn extends bi{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.bindFramebuffer(p.FRAMEBUFFER,l),this.current=l,this.dirty=!1}}class wn extends bi{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.bindRenderbuffer(p.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class Yn extends bi{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.bindTexture(p.TEXTURE_2D,l),this.current=l,this.dirty=!1}}class Ci extends bi{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.bindBuffer(p.ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class ro extends bi{getDefault(){return null}set(l){const p=this.gl;p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class da extends bi{getDefault(){return null}set(l){var p;if(l===this.current&&!this.dirty)return;const b=this.gl;Qi(b)?b.bindVertexArray(l):(p=b.getExtension("OES_vertex_array_object"))===null||p===void 0||p.bindVertexArrayOES(l),this.current=l,this.dirty=!1}}class Nl extends bi{getDefault(){return 4}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_ALIGNMENT,l),this.current=l,this.dirty=!1}}class ah extends bi{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),this.current=l,this.dirty=!1}}class Qu extends bi{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,l),this.current=l,this.dirty=!1}}class Kc extends bi{constructor(l,p){super(l),this.context=l,this.parent=p}getDefault(){return null}}class Gh extends Kc{setDirty(){this.dirty=!0}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const p=this.gl;p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}}class vd extends Kc{set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const p=this.gl;p.framebufferRenderbuffer(p.FRAMEBUFFER,p.DEPTH_ATTACHMENT,p.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class Jn extends Kc{set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const p=this.gl;p.framebufferRenderbuffer(p.FRAMEBUFFER,p.DEPTH_STENCIL_ATTACHMENT,p.RENDERBUFFER,l),this.current=l,this.dirty=!1}}const Fs="Framebuffer is not complete";class qh{constructor(l,p,b,S,k){this.context=l,this.width=p,this.height=b;const R=l.gl,W=this.framebuffer=R.createFramebuffer();if(this.colorAttachment=new Gh(l,W),S)this.depthAttachment=k?new Jn(l,W):new vd(l,W);else if(k)throw new Error("Stencil cannot be set without depth");if(R.checkFramebufferStatus(R.FRAMEBUFFER)!==R.FRAMEBUFFER_COMPLETE)throw new Error(Fs)}destroy(){const l=this.context.gl,p=this.colorAttachment.get();if(p&&l.deleteTexture(p),this.depthAttachment){const b=this.depthAttachment.get();b&&l.deleteRenderbuffer(b)}l.deleteFramebuffer(this.framebuffer)}}class bd{constructor(l){var p,b;if(this.gl=l,this.clearColor=new qc(this),this.clearDepth=new ja(this),this.clearStencil=new xl(this),this.colorMask=new So(this),this.depthMask=new Ji(this),this.stencilMask=new Fo(this),this.stencilFunc=new na(this),this.stencilOp=new wl(this),this.stencilTest=new lu(this),this.depthRange=new $l(this),this.depthTest=new Hc(this),this.depthFunc=new oh(this),this.blend=new yd(this),this.blendFunc=new cu(this),this.blendColor=new Y(this),this.blendEquation=new he(this),this.cullFace=new Oe(this),this.cullFaceSide=new Ke(this),this.frontFace=new at(this),this.program=new Ht(this),this.activeTexture=new gr(this),this.viewport=new Wr(this),this.bindFramebuffer=new cn(this),this.bindRenderbuffer=new wn(this),this.bindTexture=new Yn(this),this.bindVertexBuffer=new Ci(this),this.bindElementBuffer=new ro(this),this.bindVertexArray=new da(this),this.pixelStoreUnpack=new Nl(this),this.pixelStoreUnpackPremultiplyAlpha=new ah(this),this.pixelStoreUnpackFlipY=new Qu(this),this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE),Qi(l)){this.HALF_FLOAT=l.HALF_FLOAT;const S=l.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(p=l.RGBA16F)!==null&&p!==void 0?p:S==null?void 0:S.RGBA16F_EXT,this.RGB16F=(b=l.RGB16F)!==null&&b!==void 0?b:S==null?void 0:S.RGB16F_EXT,l.getExtension("EXT_color_buffer_float")}else{l.getExtension("EXT_color_buffer_half_float"),l.getExtension("OES_texture_half_float_linear");const S=l.getExtension("OES_texture_half_float");this.HALF_FLOAT=S==null?void 0:S.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(l,p){return new nc(this,l,p)}createVertexBuffer(l,p,b){return new qa(this,l,p,b)}createRenderbuffer(l,p,b){const S=this.gl,k=S.createRenderbuffer();return this.bindRenderbuffer.set(k),S.renderbufferStorage(S.RENDERBUFFER,l,p,b),this.bindRenderbuffer.set(null),k}createFramebuffer(l,p,b,S){return new qh(this,l,p,b,S)}clear({color:l,depth:p,stencil:b}){const S=this.gl;let k=0;l&&(k|=S.COLOR_BUFFER_BIT,this.clearColor.set(l),this.colorMask.set([!0,!0,!0,!0])),p!==void 0&&(k|=S.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(p),this.depthMask.set(!0)),b!==void 0&&(k|=S.STENCIL_BUFFER_BIT,this.clearStencil.set(b),this.stencilMask.set(255)),S.clear(k)}setCullFace(l){l.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))}setDepthMode(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)}setStencilMode(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)}setColorMode(l){a.bH(l.blendFunction,di.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor)),this.colorMask.set(l.mask)}createVertexArray(){var l;return Qi(this.gl)?this.gl.createVertexArray():(l=this.gl.getExtension("OES_vertex_array_object"))===null||l===void 0?void 0:l.createVertexArrayOES()}deleteVertexArray(l){var p;return Qi(this.gl)?this.gl.deleteVertexArray(l):(p=this.gl.getExtension("OES_vertex_array_object"))===null||p===void 0?void 0:p.deleteVertexArrayOES(l)}unbindVAO(){this.bindVertexArray.set(null)}}let uu;function sh(A,l,p,b,S){const k=A.context,R=A.transform,W=k.gl,Z=A.useProgram("collisionBox"),ie=[];let ce=0,xe=0;for(let ft=0;ft<b.length;ft++){const gt=b[ft],Et=l.getTile(gt).getBucket(p);if(!Et)continue;const Mt=S?Et.textCollisionBox:Et.iconCollisionBox,It=Et.collisionCircleArray;It.length>0&&(ie.push({circleArray:It,circleOffset:xe,coord:gt}),ce+=It.length/4,xe=ce),Mt&&Z.draw(k,W.LINES,Nn.disabled,ni.disabled,A.colorModeForRenderPass(),bn.disabled,$a(A.transform),A.style.map.terrain&&A.style.map.terrain.getTerrainData(gt),R.getProjectionData({overscaledTileID:gt,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),p.id,Mt.layoutVertexBuffer,Mt.indexBuffer,Mt.segments,null,A.transform.zoom,null,null,Mt.collisionVertexBuffer)}if(!S||!ie.length)return;const be=A.useProgram("collisionCircle"),Ae=new a.b$;Ae.resize(4*ce),Ae._trim();let Ue=0;for(const ft of ie)for(let gt=0;gt<ft.circleArray.length/4;gt++){const Et=4*gt,Mt=ft.circleArray[Et+0],It=ft.circleArray[Et+1],jt=ft.circleArray[Et+2],St=ft.circleArray[Et+3];Ae.emplace(Ue++,Mt,It,jt,St,0),Ae.emplace(Ue++,Mt,It,jt,St,1),Ae.emplace(Ue++,Mt,It,jt,St,2),Ae.emplace(Ue++,Mt,It,jt,St,3)}(!uu||uu.length<2*ce)&&(uu=function(ft){const gt=2*ft,Et=new a.c1;Et.resize(gt),Et._trim();for(let Mt=0;Mt<gt;Mt++){const It=6*Mt;Et.uint16[It+0]=4*Mt+0,Et.uint16[It+1]=4*Mt+1,Et.uint16[It+2]=4*Mt+2,Et.uint16[It+3]=4*Mt+2,Et.uint16[It+4]=4*Mt+3,Et.uint16[It+5]=4*Mt+0}return Et}(ce));const lt=k.createIndexBuffer(uu,!0),it=k.createVertexBuffer(Ae,a.c0.members,!0);for(const ft of ie){const gt=Vc(A.transform);be.draw(k,W.TRIANGLES,Nn.disabled,ni.disabled,A.colorModeForRenderPass(),bn.disabled,gt,A.style.map.terrain&&A.style.map.terrain.getTerrainData(ft.coord),null,p.id,it,lt,a.aM.simpleSegment(0,2*ft.circleOffset,ft.circleArray.length,ft.circleArray.length/2),null,A.transform.zoom,null,null,null)}it.destroy(),lt.destroy()}const lh=a.ag(new Float32Array(16));function Hh(A,l,p,b,S,k){const{horizontalAlign:R,verticalAlign:W}=a.aH(A);return new a.P((-(R-.5)*l/S+b[0])*k,(-(W-.5)*p/S+b[1])*k)}function tm(A,l,p,b,S,k){const R=l.tileAnchorPoint.add(new a.P(l.translation[0],l.translation[1]));if(l.pitchWithMap){let W=b.mult(k);p||(W=W.rotate(-S));const Z=R.add(W);return xt(Z.x,Z.y,l.pitchedLabelPlaneMatrix,l.getElevation).point}if(p){const W=Vn(l.tileAnchorPoint.x+1,l.tileAnchorPoint.y,l).point.sub(A),Z=Math.atan(W.y/W.x)+(W.x<0?Math.PI:0);return A.add(b.rotate(Z))}return A.add(b)}function xd(A,l,p,b,S,k,R,W,Z,ie,ce,xe){const be=A.text.placedSymbolArray,Ae=A.text.dynamicLayoutVertexArray,Ue=A.icon.dynamicLayoutVertexArray,lt={};Ae.clear();for(let it=0;it<be.length;it++){const ft=be.get(it),gt=ft.hidden||!ft.crossTileID||A.allowVerticalPlacement&&!ft.placedOrientation?null:b[ft.crossTileID];if(gt){const Et=new a.P(ft.anchorX,ft.anchorY),Mt={getElevation:xe,width:S.width,height:S.height,pitchedLabelPlaneMatrix:k,pitchWithMap:p,transform:S,tileAnchorPoint:Et,translation:ie,unwrappedTileID:ce},It=p?Uo(Et.x,Et.y,Mt):Vn(Et.x,Et.y,Mt),jt=wt(S.cameraToCenterDistance,It.signedDistanceFromCamera);let St=a.ap(A.textSizeData,W,ft)*jt/a.aB;p&&(St*=A.tilePixelRatio/R);const{width:Wt,height:ur,anchor:Jt,textOffset:nr,textBoxScale:cr}=gt,Gr=Hh(Jt,Wt,ur,nr,cr,St),Yr=S.getPitchedTextCorrection(Et.x+ie[0],Et.y+ie[1],ce),$r=tm(It.point,Mt,l,Gr,-S.bearingInRadians,Yr),Tn=A.allowVerticalPlacement&&ft.placedOrientation===a.ao.vertical?Math.PI/2:0;for(let mi=0;mi<ft.numGlyphs;mi++)a.av(Ae,$r,Tn);Z&&ft.associatedIconIndex>=0&&(lt[ft.associatedIconIndex]={shiftedAnchor:$r,angle:Tn})}else ta(ft.numGlyphs,Ae)}if(Z){Ue.clear();const it=A.icon.placedSymbolArray;for(let ft=0;ft<it.length;ft++){const gt=it.get(ft);if(gt.hidden)ta(gt.numGlyphs,Ue);else{const Et=lt[ft];if(Et)for(let Mt=0;Mt<gt.numGlyphs;Mt++)a.av(Ue,Et.shiftedAnchor,Et.angle);else ta(gt.numGlyphs,Ue)}}A.icon.dynamicLayoutVertexBuffer.updateData(Ue)}A.text.dynamicLayoutVertexBuffer.updateData(Ae)}function wd(A,l,p){return p.iconsInText&&l?"symbolTextAndIcon":A?"symbolSDF":"symbolIcon"}function Cu(A,l,p,b,S,k,R,W,Z,ie,ce,xe,be){const Ae=A.context,Ue=Ae.gl,lt=A.transform,it=W==="map",ft=Z==="map",gt=W!=="viewport"&&p.layout.get("symbol-placement")!=="point",Et=it&&!ft&&!gt,Mt=!p.layout.get("symbol-sort-key").isConstant();let It=!1;const jt=A.getDepthModeForSublayer(0,Nn.ReadOnly),St=p._unevaluatedLayout.hasValue("text-variable-anchor")||p._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Wt=[],ur=lt.getCircleRadiusCorrection();for(const Jt of b){const nr=l.getTile(Jt),cr=nr.getBucket(p);if(!cr)continue;const Gr=S?cr.text:cr.icon;if(!Gr||!Gr.segments.get().length||!Gr.hasVisibleVertices)continue;const Yr=Gr.programConfigurations.get(p.id),$r=S||cr.sdfIcons,Tn=S?cr.textSizeData:cr.iconSizeData,mi=ft||lt.pitch!==0,uo=A.useProgram(wd($r,S,cr),Yr),go=a.an(Tn,lt.zoom),bo=A.style.map.terrain&&A.style.map.terrain.getTerrainData(Jt);let zo,To,ei,qi,ya=[0,0],Aa=null;if(S)To=nr.glyphAtlasTexture,ei=Ue.LINEAR,zo=nr.glyphAtlasTexture.size,cr.iconsInText&&(ya=nr.imageAtlasTexture.size,Aa=nr.imageAtlasTexture,qi=mi||A.options.rotating||A.options.zooming||Tn.kind==="composite"||Tn.kind==="camera"?Ue.LINEAR:Ue.NEAREST);else{const hs=p.layout.get("icon-size").constantOr(0)!==1||cr.iconsNeedLinear;To=nr.imageAtlasTexture,ei=$r||A.options.rotating||A.options.zooming||hs||mi?Ue.LINEAR:Ue.NEAREST,zo=nr.imageAtlasTexture.size}const Fa=a.aC(nr,1,A.transform.zoom),Js=ut(it,A.transform,Fa),Rl=a.L();a.aq(Rl,Js);const Yc=We(ft,it,A.transform,Fa),Ad=a.aD(lt,nr,k,R),tf=lt.getProjectionData({overscaledTileID:Jt,applyGlobeMatrix:!be,applyTerrainMatrix:!0}),rf=St&&cr.hasTextData(),ph=p.layout.get("icon-text-fit")!=="none"&&rf&&cr.hasIconData();if(gt){const hs=A.style.map.terrain?(Qc,Xa)=>A.style.map.terrain.getElevation(Jt,Qc,Xa):null,As=p.layout.get("text-rotation-alignment")==="map";Rr(cr,A,S,Js,Rl,ft,ie,As,Jt.toUnwrapped(),lt.width,lt.height,Ad,hs)}const mh=S&&St||ph,Fl=gt||mh?lh:ft?Js:A.transform.clipSpaceToPixelsMatrix,hu=$r&&p.paint.get(S?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let zl;zl=$r?cr.iconsInText?yl(Tn.kind,go,Et,ft,gt,mh,A,Fl,Yc,Ad,zo,ya,ur):$n(Tn.kind,go,Et,ft,gt,mh,A,Fl,Yc,Ad,S,zo,0,ur):Co(Tn.kind,go,Et,ft,gt,mh,A,Fl,Yc,Ad,S,zo,ur);const Cd={program:uo,buffers:Gr,uniformValues:zl,projectionData:tf,atlasTexture:To,atlasTextureIcon:Aa,atlasInterpolation:ei,atlasInterpolationIcon:qi,isSDF:$r,hasHalo:hu};if(Mt&&cr.canOverlap){It=!0;const hs=Gr.segments.get();for(const As of hs)Wt.push({segments:new a.aM([As]),sortKey:As.sortKey,state:Cd,terrainData:bo})}else Wt.push({segments:Gr.segments,sortKey:0,state:Cd,terrainData:bo})}It&&Wt.sort((Jt,nr)=>Jt.sortKey-nr.sortKey);for(const Jt of Wt){const nr=Jt.state;if(Ae.activeTexture.set(Ue.TEXTURE0),nr.atlasTexture.bind(nr.atlasInterpolation,Ue.CLAMP_TO_EDGE),nr.atlasTextureIcon&&(Ae.activeTexture.set(Ue.TEXTURE1),nr.atlasTextureIcon&&nr.atlasTextureIcon.bind(nr.atlasInterpolationIcon,Ue.CLAMP_TO_EDGE)),nr.isSDF){const cr=nr.uniformValues;nr.hasHalo&&(cr.u_is_halo=1,ku(nr.buffers,Jt.segments,p,A,nr.program,jt,ce,xe,cr,nr.projectionData,Jt.terrainData)),cr.u_is_halo=0}ku(nr.buffers,Jt.segments,p,A,nr.program,jt,ce,xe,nr.uniformValues,nr.projectionData,Jt.terrainData)}}function ku(A,l,p,b,S,k,R,W,Z,ie,ce){const xe=b.context;S.draw(xe,xe.gl.TRIANGLES,k,R,W,bn.backCCW,Z,ce,ie,p.id,A.layoutVertexBuffer,A.indexBuffer,l,p.paint,b.transform.zoom,A.programConfigurations.get(p.id),A.dynamicLayoutVertexBuffer,A.opacityVertexBuffer)}function Jf(A,l,p,b,S){const k=A.context,R=k.gl,W=ni.disabled,Z=new di([R.ONE,R.ONE],a.bf.transparent,[!0,!0,!0,!0]),ie=l.getBucket(p);if(!ie)return;const ce=b.key;let xe=p.heatmapFbos.get(ce);xe||(xe=Ju(k,l.tileSize,l.tileSize),p.heatmapFbos.set(ce,xe)),k.bindFramebuffer.set(xe.framebuffer),k.viewport.set([0,0,l.tileSize,l.tileSize]),k.clear({color:a.bf.transparent});const be=ie.programConfigurations.get(p.id),Ae=A.useProgram("heatmap",be,!S),Ue=A.transform.getProjectionData({overscaledTileID:l.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),lt=A.style.map.terrain.getTerrainData(b);Ae.draw(k,R.TRIANGLES,Nn.disabled,W,Z,bn.disabled,Wc(l,A.transform.zoom,p.paint.get("heatmap-intensity"),1),lt,Ue,p.id,ie.layoutVertexBuffer,ie.indexBuffer,ie.segments,p.paint,A.transform.zoom,be)}function rm(A,l,p,b,S){const k=A.context,R=k.gl,W=A.transform;k.setColorMode(A.colorModeForRenderPass());const Z=ch(k,l),ie=p.key,ce=l.heatmapFbos.get(ie);if(!ce)return;k.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,ce.colorAttachment.get()),k.activeTexture.set(R.TEXTURE1),Z.bind(R.LINEAR,R.CLAMP_TO_EDGE);const xe=W.getProjectionData({overscaledTileID:p,applyTerrainMatrix:S,applyGlobeMatrix:!b});A.useProgram("heatmapTexture").draw(k,R.TRIANGLES,Nn.disabled,ni.disabled,A.colorModeForRenderPass(),bn.disabled,ua(A,l,0,1),null,xe,l.id,A.rasterBoundsBuffer,A.quadTriangleIndexBuffer,A.rasterBoundsSegments,l.paint,W.zoom),ce.destroy(),l.heatmapFbos.delete(ie)}function Ju(A,l,p){var b,S;const k=A.gl,R=k.createTexture();k.bindTexture(k.TEXTURE_2D,R),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,k.CLAMP_TO_EDGE),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,k.CLAMP_TO_EDGE),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,k.LINEAR),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,k.LINEAR);const W=(b=A.HALF_FLOAT)!==null&&b!==void 0?b:k.UNSIGNED_BYTE,Z=(S=A.RGBA16F)!==null&&S!==void 0?S:k.RGBA;k.texImage2D(k.TEXTURE_2D,0,Z,l,p,0,k.RGBA,W,null);const ie=A.createFramebuffer(l,p,!1,!1);return ie.colorAttachment.set(R),ie}function ch(A,l){return l.colorRampTexture||(l.colorRampTexture=new a.T(A,l.colorRamp,A.gl.RGBA)),l.colorRampTexture}function uh(A,l,p,b,S){if(!p||!b||!b.imageAtlas)return;const k=b.imageAtlas.patternPositions;let R=k[p.to.toString()],W=k[p.from.toString()];if(!R&&W&&(R=W),!W&&R&&(W=R),!R||!W){const Z=S.getPaintProperty(l);R=k[Z],W=k[Z]}R&&W&&A.setConstantPatternPositions(R,W)}function dh(A,l,p,b,S,k,R,W){const Z=A.context.gl,ie="fill-pattern",ce=p.paint.get(ie),xe=ce&&ce.constantOr(1),be=p.getCrossfadeParameters();let Ae,Ue,lt,it,ft;const gt=A.transform,Et=p.paint.get("fill-translate"),Mt=p.paint.get("fill-translate-anchor");R?(Ue=xe&&!p.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Ae=Z.LINES):(Ue=xe?"fillPattern":"fill",Ae=Z.TRIANGLES);const It=ce.constantOr(null);for(const jt of b){const St=l.getTile(jt);if(xe&&!St.patternsLoaded())continue;const Wt=St.getBucket(p);if(!Wt)continue;const ur=Wt.programConfigurations.get(p.id),Jt=A.useProgram(Ue,ur),nr=A.style.map.terrain&&A.style.map.terrain.getTerrainData(jt);xe&&(A.context.activeTexture.set(Z.TEXTURE0),St.imageAtlasTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),ur.updatePaintBuffers(be)),uh(ur,ie,It,St,p);const cr=gt.getProjectionData({overscaledTileID:jt,applyGlobeMatrix:!W,applyTerrainMatrix:!0}),Gr=a.aD(gt,St,Et,Mt);if(R){it=Wt.indexBuffer2,ft=Wt.segments2;const $r=[Z.drawingBufferWidth,Z.drawingBufferHeight];lt=Ue==="fillOutlinePattern"&&xe?Ql(A,be,St,$r,Gr):Ys($r,Gr)}else it=Wt.indexBuffer,ft=Wt.segments,lt=xe?gl(A,be,St,Gr):{u_fill_translate:Gr};const Yr=A.stencilModeForClipping(jt);Jt.draw(A.context,Ae,S,Yr,k,bn.backCCW,lt,nr,cr,p.id,Wt.layoutVertexBuffer,it,ft,p.paint,A.transform.zoom,ur)}}function ep(A,l,p,b,S,k,R,W){const Z=A.context,ie=Z.gl,ce="fill-extrusion-pattern",xe=p.paint.get(ce),be=xe.constantOr(1),Ae=p.getCrossfadeParameters(),Ue=p.paint.get("fill-extrusion-opacity"),lt=xe.constantOr(null),it=A.transform;for(const ft of b){const gt=l.getTile(ft),Et=gt.getBucket(p);if(!Et)continue;const Mt=A.style.map.terrain&&A.style.map.terrain.getTerrainData(ft),It=Et.programConfigurations.get(p.id),jt=A.useProgram(be?"fillExtrusionPattern":"fillExtrusion",It);be&&(A.context.activeTexture.set(ie.TEXTURE0),gt.imageAtlasTexture.bind(ie.LINEAR,ie.CLAMP_TO_EDGE),It.updatePaintBuffers(Ae));const St=it.getProjectionData({overscaledTileID:ft,applyGlobeMatrix:!W,applyTerrainMatrix:!0});uh(It,ce,lt,gt,p);const Wt=a.aD(it,gt,p.paint.get("fill-extrusion-translate"),p.paint.get("fill-extrusion-translate-anchor")),ur=p.paint.get("fill-extrusion-vertical-gradient"),Jt=be?Da(A,ur,Ue,Wt,ft,Ae,gt):La(A,ur,Ue,Wt);jt.draw(Z,Z.gl.TRIANGLES,S,k,R,bn.backCCW,Jt,Mt,St,p.id,Et.layoutVertexBuffer,Et.indexBuffer,Et.segments,p.paint,A.transform.zoom,It,A.style.map.terrain&&Et.centroidVertexBuffer)}}function ed(A,l,p,b,S,k,R,W,Z){var ie;const ce=A.style.projection,xe=A.context,be=A.transform,Ae=xe.gl,Ue=[`#define NUM_ILLUMINATION_SOURCES ${p.paint.get("hillshade-highlight-color").values.length}`],lt=A.useProgram("hillshade",null,!1,Ue),it=!A.options.moving;for(const ft of b){const gt=l.getTile(ft),Et=gt.fbo;if(!Et)continue;const Mt=ce.getMeshFromTileID(xe,ft.canonical,W,!0,"raster"),It=(ie=A.style.map.terrain)===null||ie===void 0?void 0:ie.getTerrainData(ft);xe.activeTexture.set(Ae.TEXTURE0),Ae.bindTexture(Ae.TEXTURE_2D,Et.colorAttachment.get());const jt=be.getProjectionData({overscaledTileID:ft,aligned:it,applyGlobeMatrix:!Z,applyTerrainMatrix:!0});lt.draw(xe,Ae.TRIANGLES,k,S[ft.overscaledZ],R,bn.backCCW,_l(A,gt,p),It,jt,p.id,Mt.vertexBuffer,Mt.indexBuffer,Mt.segments)}}function Md(A,l,p,b,S,k,R,W,Z){var ie;const ce=A.style.projection,xe=A.context,be=A.transform,Ae=xe.gl,Ue=A.useProgram("colorRelief"),lt=!A.options.moving;let it=!0,ft=0;for(const gt of b){const Et=l.getTile(gt),Mt=Et.dem;if(it){const Jt=Ae.getParameter(Ae.MAX_TEXTURE_SIZE),{elevationTexture:nr,colorTexture:cr}=p.getColorRampTextures(xe,Jt,Mt.getUnpackVector());xe.activeTexture.set(Ae.TEXTURE1),nr.bind(Ae.NEAREST,Ae.CLAMP_TO_EDGE),xe.activeTexture.set(Ae.TEXTURE4),cr.bind(Ae.LINEAR,Ae.CLAMP_TO_EDGE),it=!1,ft=nr.size[0]}if(!Mt||!Mt.data)continue;const It=Mt.stride,jt=Mt.getPixels();if(xe.activeTexture.set(Ae.TEXTURE0),xe.pixelStoreUnpackPremultiplyAlpha.set(!1),Et.demTexture=Et.demTexture||A.getTileTexture(It),Et.demTexture){const Jt=Et.demTexture;Jt.update(jt,{premultiply:!1}),Jt.bind(Ae.LINEAR,Ae.CLAMP_TO_EDGE)}else Et.demTexture=new a.T(xe,jt,Ae.RGBA,{premultiply:!1}),Et.demTexture.bind(Ae.LINEAR,Ae.CLAMP_TO_EDGE);const St=ce.getMeshFromTileID(xe,gt.canonical,W,!0,"raster"),Wt=(ie=A.style.map.terrain)===null||ie===void 0?void 0:ie.getTerrainData(gt),ur=be.getProjectionData({overscaledTileID:gt,aligned:lt,applyGlobeMatrix:!Z,applyTerrainMatrix:!0});Ue.draw(xe,Ae.TRIANGLES,k,S[gt.overscaledZ],R,bn.backCCW,Jl(p,Et.dem,ft),Wt,ur,p.id,St.vertexBuffer,St.indexBuffer,St.segments)}}const Sd=[new a.P(0,0),new a.P(a.$,0),new a.P(a.$,a.$),new a.P(0,a.$)];function Sc(A,l,p,b,S,k,R,W,Z=!1,ie=!1){const ce=b[b.length-1].overscaledZ,xe=A.context,be=xe.gl,Ae=A.useProgram("raster"),Ue=A.transform,lt=A.style.projection,it=A.colorModeForRenderPass(),ft=!A.options.moving;for(const gt of b){const Et=A.getDepthModeForSublayer(gt.overscaledZ-ce,p.paint.get("raster-opacity")===1?Nn.ReadWrite:Nn.ReadOnly,be.LESS),Mt=l.getTile(gt);Mt.registerFadeDuration(p.paint.get("raster-fade-duration"));const It=l.findLoadedParent(gt,0),jt=l.findLoadedSibling(gt),St=Kh(Mt,It||jt||null,l,p,A.transform,A.style.map.terrain);let Wt,ur;const Jt=p.paint.get("raster-resampling")==="nearest"?be.NEAREST:be.LINEAR;xe.activeTexture.set(be.TEXTURE0),Mt.texture.bind(Jt,be.CLAMP_TO_EDGE,be.LINEAR_MIPMAP_NEAREST),xe.activeTexture.set(be.TEXTURE1),It?(It.texture.bind(Jt,be.CLAMP_TO_EDGE,be.LINEAR_MIPMAP_NEAREST),Wt=Math.pow(2,It.tileID.overscaledZ-Mt.tileID.overscaledZ),ur=[Mt.tileID.canonical.x*Wt%1,Mt.tileID.canonical.y*Wt%1]):Mt.texture.bind(Jt,be.CLAMP_TO_EDGE,be.LINEAR_MIPMAP_NEAREST),Mt.texture.useMipmap&&xe.extTextureFilterAnisotropic&&A.transform.pitch>20&&be.texParameterf(be.TEXTURE_2D,xe.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,xe.extTextureFilterAnisotropicMax);const nr=A.style.map.terrain&&A.style.map.terrain.getTerrainData(gt),cr=Ue.getProjectionData({overscaledTileID:gt,aligned:ft,applyGlobeMatrix:!ie,applyTerrainMatrix:!0}),Gr=tc(ur||[0,0],Wt||1,St,p,W),Yr=lt.getMeshFromTileID(xe,gt.canonical,k,R,"raster");Ae.draw(xe,be.TRIANGLES,Et,S?S[gt.overscaledZ]:ni.disabled,it,Z?bn.frontCCW:bn.backCCW,Gr,nr,cr,p.id,Yr.vertexBuffer,Yr.indexBuffer,Yr.segments)}}function Kh(A,l,p,b,S,k){const R=b.paint.get("raster-fade-duration");if(!k&&R>0){const W=_.now(),Z=(W-A.timeAdded)/R,ie=l?(W-l.timeAdded)/R:-1,ce=p.getSource(),xe=Jr(S,{tileSize:ce.tileSize,roundZoom:ce.roundZoom}),be=!l||Math.abs(l.tileID.overscaledZ-xe)>Math.abs(A.tileID.overscaledZ-xe),Ae=be&&A.refreshedUponExpiration?1:a.ah(be?Z:1-ie,0,1);return A.refreshedUponExpiration&&Z>=1&&(A.refreshedUponExpiration=!1),l?{opacity:1,mix:1-Ae}:{opacity:Ae,mix:0}}return{opacity:1,mix:0}}const nm=new a.bf(1,0,0,1),tp=new a.bf(0,1,0,1),hh=new a.bf(0,0,1,1),rp=new a.bf(1,0,1,1),ig=new a.bf(0,1,1,1);function Zh(A,l,p,b){Ra(A,0,l+p/2,A.transform.width,p,b)}function ko(A,l,p,b){Ra(A,l-p/2,0,p,A.transform.height,b)}function Ra(A,l,p,b,S,k){const R=A.context,W=R.gl;W.enable(W.SCISSOR_TEST),W.scissor(l*A.pixelRatio,p*A.pixelRatio,b*A.pixelRatio,S*A.pixelRatio),R.clear({color:k}),W.disable(W.SCISSOR_TEST)}function Ea(A,l,p){const b=A.context,S=b.gl,k=A.useProgram("debug"),R=Nn.disabled,W=ni.disabled,Z=A.colorModeForRenderPass(),ie="$debug",ce=A.style.map.terrain&&A.style.map.terrain.getTerrainData(p);b.activeTexture.set(S.TEXTURE0);const xe=l.getTileByID(p.key).latestRawTileData,be=Math.floor((xe&&xe.byteLength||0)/1024),Ae=l.getTile(p).tileSize,Ue=512/Math.min(Ae,512)*(p.overscaledZ/A.transform.zoom)*.5;let lt=p.canonical.toString();p.overscaledZ!==p.canonical.z&&(lt+=` => ${p.overscaledZ}`),function(ft,gt){ft.initDebugOverlayCanvas();const Et=ft.debugOverlayCanvas,Mt=ft.context.gl,It=ft.debugOverlayCanvas.getContext("2d");It.clearRect(0,0,Et.width,Et.height),It.shadowColor="white",It.shadowBlur=2,It.lineWidth=1.5,It.strokeStyle="white",It.textBaseline="top",It.font="bold 36px Open Sans, sans-serif",It.fillText(gt,5,5),It.strokeText(gt,5,5),ft.debugOverlayTexture.update(Et),ft.debugOverlayTexture.bind(Mt.LINEAR,Mt.CLAMP_TO_EDGE)}(A,`${lt} ${be}kB`);const it=A.transform.getProjectionData({overscaledTileID:p,applyGlobeMatrix:!0,applyTerrainMatrix:!0});k.draw(b,S.TRIANGLES,R,W,di.alphaBlended,bn.disabled,as(a.bf.transparent,Ue),null,it,ie,A.debugBuffer,A.quadTriangleIndexBuffer,A.debugSegments),k.draw(b,S.LINE_STRIP,R,W,Z,bn.disabled,as(a.bf.red),ce,it,ie,A.debugBuffer,A.tileBorderIndexBuffer,A.debugSegments)}function Xh(A,l,p,b){const{isRenderingGlobe:S}=b,k=A.context,R=k.gl,W=A.transform,Z=A.colorModeForRenderPass(),ie=A.getDepthModeFor3D(),ce=A.useProgram("terrain");k.bindFramebuffer.set(null),k.viewport.set([0,0,A.width,A.height]);for(const xe of p){const be=l.getTerrainMesh(xe.tileID),Ae=A.renderToTexture.getTexture(xe),Ue=l.getTerrainData(xe.tileID);k.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,Ae.texture);const lt=l.getMeshFrameDelta(W.zoom),it=W.calculateFogMatrix(xe.tileID.toUnwrapped()),ft=su(lt,it,A.style.sky,W.pitch,S),gt=W.getProjectionData({overscaledTileID:xe.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});ce.draw(k,R.TRIANGLES,ie,ni.disabled,Z,bn.backCCW,ft,Ue,gt,"terrain",be.vertexBuffer,be.indexBuffer,be.segments)}}function Td(A,l){if(!l.mesh){const p=new a.aL;p.emplaceBack(-1,-1),p.emplaceBack(1,-1),p.emplaceBack(1,1),p.emplaceBack(-1,1);const b=new a.aN;b.emplaceBack(0,1,2),b.emplaceBack(0,2,3),l.mesh=new yr(A.createVertexBuffer(p,Vr.members),A.createIndexBuffer(b),a.aM.simpleSegment(0,0,p.length,b.length))}return l.mesh}class Zc{constructor(l,p){this.context=new bd(l),this.transform=p,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:a.ag(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Sr.maxUnderzooming+Sr.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new rt}resize(l,p,b){if(this.width=Math.floor(l*b),this.height=Math.floor(p*b),this.pixelRatio=b,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const S of this.style._order)this.style._layers[S].resize()}setup(){const l=this.context,p=new a.aL;p.emplaceBack(0,0),p.emplaceBack(a.$,0),p.emplaceBack(0,a.$),p.emplaceBack(a.$,a.$),this.tileExtentBuffer=l.createVertexBuffer(p,Vr.members),this.tileExtentSegments=a.aM.simpleSegment(0,0,4,2);const b=new a.aL;b.emplaceBack(0,0),b.emplaceBack(a.$,0),b.emplaceBack(0,a.$),b.emplaceBack(a.$,a.$),this.debugBuffer=l.createVertexBuffer(b,Vr.members),this.debugSegments=a.aM.simpleSegment(0,0,4,5);const S=new a.c6;S.emplaceBack(0,0,0,0),S.emplaceBack(a.$,0,a.$,0),S.emplaceBack(0,a.$,0,a.$),S.emplaceBack(a.$,a.$,a.$,a.$),this.rasterBoundsBuffer=l.createVertexBuffer(S,yc.members),this.rasterBoundsSegments=a.aM.simpleSegment(0,0,4,2);const k=new a.aL;k.emplaceBack(0,0),k.emplaceBack(a.$,0),k.emplaceBack(0,a.$),k.emplaceBack(a.$,a.$),this.rasterBoundsBufferPosOnly=l.createVertexBuffer(k,Vr.members),this.rasterBoundsSegmentsPosOnly=a.aM.simpleSegment(0,0,4,5);const R=new a.aL;R.emplaceBack(0,0),R.emplaceBack(1,0),R.emplaceBack(0,1),R.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(R,Vr.members),this.viewportSegments=a.aM.simpleSegment(0,0,4,2);const W=new a.c7;W.emplaceBack(0),W.emplaceBack(1),W.emplaceBack(3),W.emplaceBack(2),W.emplaceBack(0),this.tileBorderIndexBuffer=l.createIndexBuffer(W);const Z=new a.aN;Z.emplaceBack(1,0,2),Z.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=l.createIndexBuffer(Z);const ie=this.context.gl;this.stencilClearMode=new ni({func:ie.ALWAYS,mask:0},0,255,ie.ZERO,ie.ZERO,ie.ZERO),this.tileExtentMesh=new yr(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const l=this.context,p=l.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const b=a.L();a.bY(b,0,this.width,this.height,0,0,1),a.N(b,b,[p.drawingBufferWidth,p.drawingBufferHeight,0]);const S={mainMatrix:b,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:b};this.useProgram("clippingMask",null,!0).draw(l,p.TRIANGLES,Nn.disabled,this.stencilClearMode,di.disabled,bn.disabled,null,null,S,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(l,p,b){if(this.currentStencilSource===l.source||!l.isTileClipped()||!p||!p.length)return;this.currentStencilSource=l.source,this.nextStencilID+p.length>256&&this.clearStencil();const S=this.context;S.setColorMode(di.disabled),S.setDepthMode(Nn.disabled);const k={};for(const R of p)k[R.key]=this.nextStencilID++;this._renderTileMasks(k,p,b,!0),this._renderTileMasks(k,p,b,!1),this._tileClippingMaskIDs=k}_renderTileMasks(l,p,b,S){const k=this.context,R=k.gl,W=this.style.projection,Z=this.transform,ie=this.useProgram("clippingMask");for(const ce of p){const xe=l[ce.key],be=this.style.map.terrain&&this.style.map.terrain.getTerrainData(ce),Ae=W.getMeshFromTileID(this.context,ce.canonical,S,!0,"stencil"),Ue=Z.getProjectionData({overscaledTileID:ce,applyGlobeMatrix:!b,applyTerrainMatrix:!0});ie.draw(k,R.TRIANGLES,Nn.disabled,new ni({func:R.ALWAYS,mask:0},xe,255,R.KEEP,R.KEEP,R.REPLACE),di.disabled,b?bn.disabled:bn.backCCW,null,be,Ue,"$clipping",Ae.vertexBuffer,Ae.indexBuffer,Ae.segments)}}_renderTilesDepthBuffer(){const l=this.context,p=l.gl,b=this.style.projection,S=this.transform,k=this.useProgram("depth"),R=this.getDepthModeFor3D(),W=$t(S,{tileSize:S.tileSize});for(const Z of W){const ie=this.style.map.terrain&&this.style.map.terrain.getTerrainData(Z),ce=b.getMeshFromTileID(this.context,Z.canonical,!0,!0,"raster"),xe=S.getProjectionData({overscaledTileID:Z,applyGlobeMatrix:!0,applyTerrainMatrix:!0});k.draw(l,p.TRIANGLES,R,ni.disabled,di.disabled,bn.backCCW,null,ie,xe,"$clipping",ce.vertexBuffer,ce.indexBuffer,ce.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const l=this.nextStencilID++,p=this.context.gl;return new ni({func:p.NOTEQUAL,mask:255},l,255,p.KEEP,p.KEEP,p.REPLACE)}stencilModeForClipping(l){const p=this.context.gl;return new ni({func:p.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,p.KEEP,p.KEEP,p.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(l){const p=this.context.gl,b=l.sort((R,W)=>W.overscaledZ-R.overscaledZ),S=b[b.length-1].overscaledZ,k=b[0].overscaledZ-S+1;if(k>1){this.currentStencilSource=void 0,this.nextStencilID+k>256&&this.clearStencil();const R={};for(let W=0;W<k;W++)R[W+S]=new ni({func:p.GEQUAL,mask:255},W+this.nextStencilID,255,p.KEEP,p.KEEP,p.REPLACE);return this.nextStencilID+=k,[R,b]}return[{[S]:ni.disabled},b]}stencilConfigForOverlapTwoPass(l){const p=this.context.gl,b=l.sort((R,W)=>W.overscaledZ-R.overscaledZ),S=b[b.length-1].overscaledZ,k=b[0].overscaledZ-S+1;if(this.clearStencil(),k>1){const R={},W={};for(let Z=0;Z<k;Z++)R[Z+S]=new ni({func:p.GREATER,mask:255},k+1+Z,255,p.KEEP,p.KEEP,p.REPLACE),W[Z+S]=new ni({func:p.GREATER,mask:255},1+Z,255,p.KEEP,p.KEEP,p.REPLACE);return this.nextStencilID=2*k+1,[R,W,b]}return this.nextStencilID=3,[{[S]:new ni({func:p.GREATER,mask:255},2,255,p.KEEP,p.KEEP,p.REPLACE)},{[S]:new ni({func:p.GREATER,mask:255},1,255,p.KEEP,p.KEEP,p.REPLACE)},b]}colorModeForRenderPass(){const l=this.context.gl;return this._showOverdrawInspector?new di([l.CONSTANT_COLOR,l.ONE],new a.bf(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?di.unblended:di.alphaBlended}getDepthModeForSublayer(l,p,b){if(!this.opaquePassEnabledForLayer())return Nn.disabled;const S=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new Nn(b||this.context.gl.LEQUAL,p,[S,S])}getDepthModeFor3D(){return new Nn(this.context.gl.LEQUAL,Nn.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(l,p){var b,S;this.style=l,this.options=p,this.lineAtlas=l.lineAtlas,this.imageManager=l.imageManager,this.glyphManager=l.glyphManager,this.symbolFadeChange=l.placement.symbolFadeChange(_.now()),this.imageManager.beginFrame();const k=this.style._order,R=this.style.sourceCaches,W={},Z={},ie={},ce={isRenderingToTexture:!1,isRenderingGlobe:((b=l.projection)===null||b===void 0?void 0:b.transitionState)>0};for(const be in R){const Ae=R[be];Ae.used&&Ae.prepare(this.context),W[be]=Ae.getVisibleCoordinates(!1),Z[be]=W[be].slice().reverse(),ie[be]=Ae.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let be=0;be<k.length;be++)if(this.style._layers[k[be]].is3D()){this.opaquePassCutoff=be;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const be of k){const Ae=this.style._layers[be];if(!Ae.hasOffscreenPass()||Ae.isHidden(this.transform.zoom))continue;const Ue=Z[Ae.source];(Ae.type==="custom"||Ue.length)&&this.renderLayer(this,R[Ae.source],Ae,Ue,ce)}if((S=this.style.projection)===null||S===void 0||S.updateGPUdependent({context:this.context,useProgram:be=>this.useProgram(be)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:p.showOverdrawInspector?a.bf.black:a.bf.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(be,Ae){const Ue=be.context,lt=Ue.gl,it=((jt,St,Wt)=>{const ur=Math.cos(St.rollInRadians),Jt=Math.sin(St.rollInRadians),nr=dt(St),cr=St.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:jt.properties.get("sky-color"),u_horizon_color:jt.properties.get("horizon-color"),u_horizon:[(St.width/2-nr*Jt)*Wt,(St.height/2+nr*ur)*Wt],u_horizon_normal:[-Jt,ur],u_sky_horizon_blend:jt.properties.get("sky-horizon-blend")*St.height/2*Wt,u_sky_blend:cr}})(Ae,be.style.map.transform,be.pixelRatio),ft=new Nn(lt.LEQUAL,Nn.ReadWrite,[0,1]),gt=ni.disabled,Et=be.colorModeForRenderPass(),Mt=be.useProgram("sky"),It=Td(Ue,Ae);Mt.draw(Ue,lt.TRIANGLES,ft,gt,Et,bn.disabled,it,null,void 0,"sky",It.vertexBuffer,It.indexBuffer,It.segments)}(this,this.style.sky),this._showOverdrawInspector=p.showOverdrawInspector,this.depthRangeFor3D=[0,1-(l._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=k.length-1;this.currentLayer>=0;this.currentLayer--){const be=this.style._layers[k[this.currentLayer]],Ae=R[be.source],Ue=W[be.source];this._renderTileClippingMasks(be,Ue,!1),this.renderLayer(this,Ae,be,Ue,ce)}this.renderPass="translucent";let xe=!1;for(this.currentLayer=0;this.currentLayer<k.length;this.currentLayer++){const be=this.style._layers[k[this.currentLayer]],Ae=R[be.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(be,ce))continue;this.opaquePassEnabledForLayer()||xe||(xe=!0,ce.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const Ue=(be.type==="symbol"?ie:Z)[be.source];this._renderTileClippingMasks(be,W[be.source],!!this.renderToTexture),this.renderLayer(this,Ae,be,Ue,ce)}if(ce.isRenderingGlobe&&function(be,Ae,Ue){const lt=be.context,it=lt.gl,ft=be.useProgram("atmosphere"),gt=new Nn(it.LEQUAL,Nn.ReadOnly,[0,1]),Et=be.transform,Mt=function(cr,Gr){const Yr=cr.properties.get("position"),$r=[-Yr.x,-Yr.y,-Yr.z],Tn=a.ag(new Float64Array(16));return cr.properties.get("anchor")==="map"&&(a.b6(Tn,Tn,Gr.rollInRadians),a.b7(Tn,Tn,-Gr.pitchInRadians),a.b6(Tn,Tn,Gr.bearingInRadians),a.b7(Tn,Tn,Gr.center.lat*Math.PI/180),a.bz(Tn,Tn,-Gr.center.lng*Math.PI/180)),a.c5($r,$r,Tn),$r}(Ue,be.transform),It=Et.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),jt=Ae.properties.get("atmosphere-blend")*It.projectionTransition;if(jt===0)return;const St=Ss(Et.worldSize,Et.center.lat),Wt=Et.inverseProjectionMatrix,ur=new Float64Array(4);ur[3]=1,a.aw(ur,ur,Et.modelViewProjectionMatrix),ur[0]/=ur[3],ur[1]/=ur[3],ur[2]/=ur[3],ur[3]=1,a.aw(ur,ur,Wt),ur[0]/=ur[3],ur[1]/=ur[3],ur[2]/=ur[3],ur[3]=1;const Jt=((cr,Gr,Yr,$r,Tn)=>({u_sun_pos:cr,u_atmosphere_blend:Gr,u_globe_position:Yr,u_globe_radius:$r,u_inv_proj_matrix:Tn}))(Mt,jt,[ur[0],ur[1],ur[2]],St,Wt),nr=Td(lt,Ae);ft.draw(lt,it.TRIANGLES,gt,ni.disabled,di.alphaBlended,bn.disabled,Jt,null,null,"atmosphere",nr.vertexBuffer,nr.indexBuffer,nr.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const be=function(Ae,Ue){let lt=null;const it=Object.values(Ae._layers).flatMap(Mt=>Mt.source&&!Mt.isHidden(Ue)?[Ae.sourceCaches[Mt.source]]:[]),ft=it.filter(Mt=>Mt.getSource().type==="vector"),gt=it.filter(Mt=>Mt.getSource().type!=="vector"),Et=Mt=>{(!lt||lt.getSource().maxzoom<Mt.getSource().maxzoom)&&(lt=Mt)};return ft.forEach(Mt=>Et(Mt)),lt||gt.forEach(Mt=>Et(Mt)),lt}(this.style,this.transform.zoom);be&&function(Ae,Ue,lt){for(let it=0;it<lt.length;it++)Ea(Ae,Ue,lt[it])}(this,be,be.getVisibleCoordinates())}this.options.showPadding&&function(be){const Ae=be.transform.padding;Zh(be,be.transform.height-(Ae.top||0),3,nm),Zh(be,Ae.bottom||0,3,tp),ko(be,Ae.left||0,3,hh),ko(be,be.transform.width-(Ae.right||0),3,rp);const Ue=be.transform.centerPoint;(function(lt,it,ft,gt){Ra(lt,it-1,ft-10,2,20,gt),Ra(lt,it-10,ft-1,20,2,gt)})(be,Ue.x,be.transform.height-Ue.y,ig)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(l){if(!this.style||!this.style.map||!this.style.map.terrain)return;const p=this.terrainFacilitator.matrix,b=this.transform.modelViewProjectionMatrix;let S=this.terrainFacilitator.dirty;S||(S=l?!a.c8(p,b):!a.c9(p,b)),S||(S=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),S&&(a.ca(p,b),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(k,R){const W=k.context,Z=W.gl,ie=k.transform,ce=di.unblended,xe=new Nn(Z.LEQUAL,Nn.ReadWrite,[0,1]),be=R.sourceCache.getRenderableTiles(),Ae=k.useProgram("terrainDepth");W.bindFramebuffer.set(R.getFramebuffer("depth").framebuffer),W.viewport.set([0,0,k.width/devicePixelRatio,k.height/devicePixelRatio]),W.clear({color:a.bf.transparent,depth:1});for(const Ue of be){const lt=R.getTerrainMesh(Ue.tileID),it=R.getTerrainData(Ue.tileID),ft=ie.getProjectionData({overscaledTileID:Ue.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),gt={u_ele_delta:R.getMeshFrameDelta(ie.zoom)};Ae.draw(W,Z.TRIANGLES,xe,ni.disabled,ce,bn.backCCW,gt,it,ft,"terrain",lt.vertexBuffer,lt.indexBuffer,lt.segments)}W.bindFramebuffer.set(null),W.viewport.set([0,0,k.width,k.height])}(this,this.style.map.terrain),function(k,R){const W=k.context,Z=W.gl,ie=k.transform,ce=di.unblended,xe=new Nn(Z.LEQUAL,Nn.ReadWrite,[0,1]),be=R.getCoordsTexture(),Ae=R.sourceCache.getRenderableTiles(),Ue=k.useProgram("terrainCoords");W.bindFramebuffer.set(R.getFramebuffer("coords").framebuffer),W.viewport.set([0,0,k.width/devicePixelRatio,k.height/devicePixelRatio]),W.clear({color:a.bf.transparent,depth:1}),R.coordsIndex=[];for(const lt of Ae){const it=R.getTerrainMesh(lt.tileID),ft=R.getTerrainData(lt.tileID);W.activeTexture.set(Z.TEXTURE0),Z.bindTexture(Z.TEXTURE_2D,be.texture);const gt={u_terrain_coords_id:(255-R.coordsIndex.length)/255,u_texture:0,u_ele_delta:R.getMeshFrameDelta(ie.zoom)},Et=ie.getProjectionData({overscaledTileID:lt.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});Ue.draw(W,Z.TRIANGLES,xe,ni.disabled,ce,bn.backCCW,gt,ft,Et,"terrain",it.vertexBuffer,it.indexBuffer,it.segments),R.coordsIndex.push(lt.tileID.key)}W.bindFramebuffer.set(null),W.viewport.set([0,0,k.width,k.height])}(this,this.style.map.terrain))}renderLayer(l,p,b,S,k){b.isHidden(this.transform.zoom)||(b.type==="background"||b.type==="custom"||(S||[]).length)&&(this.id=b.id,a.cb(b)?function(R,W,Z,ie,ce,xe){if(R.renderPass!=="translucent")return;const{isRenderingToTexture:be}=xe,Ae=ni.disabled,Ue=R.colorModeForRenderPass();(Z._unevaluatedLayout.hasValue("text-variable-anchor")||Z._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(lt,it,ft,gt,Et,Mt,It,jt,St){const Wt=it.transform,ur=it.style.map.terrain,Jt=Et==="map",nr=Mt==="map";for(const cr of lt){const Gr=gt.getTile(cr),Yr=Gr.getBucket(ft);if(!Yr||!Yr.text||!Yr.text.segments.get().length)continue;const $r=a.an(Yr.textSizeData,Wt.zoom),Tn=a.aC(Gr,1,it.transform.zoom),mi=ut(Jt,it.transform,Tn),uo=ft.layout.get("icon-text-fit")!=="none"&&Yr.hasIconData();if($r){const go=Math.pow(2,Wt.zoom-Gr.tileID.overscaledZ),bo=ur?(zo,To)=>ur.getElevation(cr,zo,To):null;xd(Yr,Jt,nr,St,Wt,mi,go,$r,uo,a.aD(Wt,Gr,It,jt),cr.toUnwrapped(),bo)}}}(ie,R,Z,W,Z.layout.get("text-rotation-alignment"),Z.layout.get("text-pitch-alignment"),Z.paint.get("text-translate"),Z.paint.get("text-translate-anchor"),ce),Z.paint.get("icon-opacity").constantOr(1)!==0&&Cu(R,W,Z,ie,!1,Z.paint.get("icon-translate"),Z.paint.get("icon-translate-anchor"),Z.layout.get("icon-rotation-alignment"),Z.layout.get("icon-pitch-alignment"),Z.layout.get("icon-keep-upright"),Ae,Ue,be),Z.paint.get("text-opacity").constantOr(1)!==0&&Cu(R,W,Z,ie,!0,Z.paint.get("text-translate"),Z.paint.get("text-translate-anchor"),Z.layout.get("text-rotation-alignment"),Z.layout.get("text-pitch-alignment"),Z.layout.get("text-keep-upright"),Ae,Ue,be),W.map.showCollisionBoxes&&(sh(R,W,Z,ie,!0),sh(R,W,Z,ie,!1))}(l,p,b,S,this.style.placement.variableOffsets,k):a.cc(b)?function(R,W,Z,ie,ce){if(R.renderPass!=="translucent")return;const{isRenderingToTexture:xe}=ce,be=Z.paint.get("circle-opacity"),Ae=Z.paint.get("circle-stroke-width"),Ue=Z.paint.get("circle-stroke-opacity"),lt=!Z.layout.get("circle-sort-key").isConstant();if(be.constantOr(1)===0&&(Ae.constantOr(1)===0||Ue.constantOr(1)===0))return;const it=R.context,ft=it.gl,gt=R.transform,Et=R.getDepthModeForSublayer(0,Nn.ReadOnly),Mt=ni.disabled,It=R.colorModeForRenderPass(),jt=[],St=gt.getCircleRadiusCorrection();for(let Wt=0;Wt<ie.length;Wt++){const ur=ie[Wt],Jt=W.getTile(ur),nr=Jt.getBucket(Z);if(!nr)continue;const cr=Z.paint.get("circle-translate"),Gr=Z.paint.get("circle-translate-anchor"),Yr=a.aD(gt,Jt,cr,Gr),$r=nr.programConfigurations.get(Z.id),Tn=R.useProgram("circle",$r),mi=nr.layoutVertexBuffer,uo=nr.indexBuffer,go=R.style.map.terrain&&R.style.map.terrain.getTerrainData(ur),bo={programConfiguration:$r,program:Tn,layoutVertexBuffer:mi,indexBuffer:uo,uniformValues:Yu(R,Jt,Z,Yr,St),terrainData:go,projectionData:gt.getProjectionData({overscaledTileID:ur,applyGlobeMatrix:!xe,applyTerrainMatrix:!0})};if(lt){const zo=nr.segments.get();for(const To of zo)jt.push({segments:new a.aM([To]),sortKey:To.sortKey,state:bo})}else jt.push({segments:nr.segments,sortKey:0,state:bo})}lt&&jt.sort((Wt,ur)=>Wt.sortKey-ur.sortKey);for(const Wt of jt){const{programConfiguration:ur,program:Jt,layoutVertexBuffer:nr,indexBuffer:cr,uniformValues:Gr,terrainData:Yr,projectionData:$r}=Wt.state;Jt.draw(it,ft.TRIANGLES,Et,Mt,It,bn.backCCW,Gr,Yr,$r,Z.id,nr,cr,Wt.segments,Z.paint,R.transform.zoom,ur)}}(l,p,b,S,k):a.cd(b)?function(R,W,Z,ie,ce){if(Z.paint.get("heatmap-opacity")===0)return;const xe=R.context,{isRenderingToTexture:be,isRenderingGlobe:Ae}=ce;if(R.style.map.terrain){for(const Ue of ie){const lt=W.getTile(Ue);W.hasRenderableParent(Ue)||(R.renderPass==="offscreen"?Jf(R,lt,Z,Ue,Ae):R.renderPass==="translucent"&&rm(R,Z,Ue,be,Ae))}xe.viewport.set([0,0,R.width,R.height])}else R.renderPass==="offscreen"?function(Ue,lt,it,ft){const gt=Ue.context,Et=gt.gl,Mt=Ue.transform,It=ni.disabled,jt=new di([Et.ONE,Et.ONE],a.bf.transparent,[!0,!0,!0,!0]);(function(St,Wt,ur){const Jt=St.gl;St.activeTexture.set(Jt.TEXTURE1),St.viewport.set([0,0,Wt.width/4,Wt.height/4]);let nr=ur.heatmapFbos.get(a.c2);nr?(Jt.bindTexture(Jt.TEXTURE_2D,nr.colorAttachment.get()),St.bindFramebuffer.set(nr.framebuffer)):(nr=Ju(St,Wt.width/4,Wt.height/4),ur.heatmapFbos.set(a.c2,nr))})(gt,Ue,it),gt.clear({color:a.bf.transparent});for(let St=0;St<ft.length;St++){const Wt=ft[St];if(lt.hasRenderableParent(Wt))continue;const ur=lt.getTile(Wt),Jt=ur.getBucket(it);if(!Jt)continue;const nr=Jt.programConfigurations.get(it.id),cr=Ue.useProgram("heatmap",nr),Gr=Mt.getProjectionData({overscaledTileID:Wt,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),Yr=Mt.getCircleRadiusCorrection();cr.draw(gt,Et.TRIANGLES,Nn.disabled,It,jt,bn.backCCW,Wc(ur,Mt.zoom,it.paint.get("heatmap-intensity"),Yr),null,Gr,it.id,Jt.layoutVertexBuffer,Jt.indexBuffer,Jt.segments,it.paint,Mt.zoom,nr)}gt.viewport.set([0,0,Ue.width,Ue.height])}(R,W,Z,ie):R.renderPass==="translucent"&&function(Ue,lt){const it=Ue.context,ft=it.gl;it.setColorMode(Ue.colorModeForRenderPass());const gt=lt.heatmapFbos.get(a.c2);gt&&(it.activeTexture.set(ft.TEXTURE0),ft.bindTexture(ft.TEXTURE_2D,gt.colorAttachment.get()),it.activeTexture.set(ft.TEXTURE1),ch(it,lt).bind(ft.LINEAR,ft.CLAMP_TO_EDGE),Ue.useProgram("heatmapTexture").draw(it,ft.TRIANGLES,Nn.disabled,ni.disabled,Ue.colorModeForRenderPass(),bn.disabled,ua(Ue,lt,0,1),null,null,lt.id,Ue.viewportBuffer,Ue.quadTriangleIndexBuffer,Ue.viewportSegments,lt.paint,Ue.transform.zoom))}(R,Z)}(l,p,b,S,k):a.ce(b)?function(R,W,Z,ie,ce){if(R.renderPass!=="translucent")return;const{isRenderingToTexture:xe}=ce,be=Z.paint.get("line-opacity"),Ae=Z.paint.get("line-width");if(be.constantOr(1)===0||Ae.constantOr(1)===0)return;const Ue=R.getDepthModeForSublayer(0,Nn.ReadOnly),lt=R.colorModeForRenderPass(),it=Z.paint.get("line-dasharray"),ft=Z.paint.get("line-pattern"),gt=ft.constantOr(1),Et=Z.paint.get("line-gradient"),Mt=Z.getCrossfadeParameters(),It=gt?"linePattern":it?"lineSDF":Et?"lineGradient":"line",jt=R.context,St=jt.gl,Wt=R.transform;let ur=!0;for(const Jt of ie){const nr=W.getTile(Jt);if(gt&&!nr.patternsLoaded())continue;const cr=nr.getBucket(Z);if(!cr)continue;const Gr=cr.programConfigurations.get(Z.id),Yr=R.context.program.get(),$r=R.useProgram(It,Gr),Tn=ur||$r.program!==Yr,mi=R.style.map.terrain&&R.style.map.terrain.getTerrainData(Jt),uo=ft.constantOr(null);if(uo&&nr.imageAtlas){const ei=nr.imageAtlas,qi=ei.patternPositions[uo.to.toString()],ya=ei.patternPositions[uo.from.toString()];qi&&ya&&Gr.setConstantPatternPositions(qi,ya)}const go=Wt.getProjectionData({overscaledTileID:Jt,applyGlobeMatrix:!xe,applyTerrainMatrix:!0}),bo=Wt.getPixelScale(),zo=gt?Ts(R,nr,Z,bo,Mt):it?js(R,nr,Z,bo,it,Mt):Et?ss(R,nr,Z,bo,cr.lineClipsArray.length):wc(R,nr,Z,bo);if(gt)jt.activeTexture.set(St.TEXTURE0),nr.imageAtlasTexture.bind(St.LINEAR,St.CLAMP_TO_EDGE),Gr.updatePaintBuffers(Mt);else if(it&&(Tn||R.lineAtlas.dirty))jt.activeTexture.set(St.TEXTURE0),R.lineAtlas.bind(jt);else if(Et){const ei=cr.gradients[Z.id];let qi=ei.texture;if(Z.gradientVersion!==ei.version){let ya=256;if(Z.stepInterpolant){const Aa=W.getSource().maxzoom,Fa=Jt.canonical.z===Aa?Math.ceil(1<<R.transform.maxZoom-Jt.canonical.z):1;ya=a.ah(a.c3(cr.maxLineLength/a.$*1024*Fa),256,jt.maxTextureSize)}ei.gradient=a.c4({expression:Z.gradientExpression(),evaluationKey:"lineProgress",resolution:ya,image:ei.gradient||void 0,clips:cr.lineClipsArray}),ei.texture?ei.texture.update(ei.gradient):ei.texture=new a.T(jt,ei.gradient,St.RGBA),ei.version=Z.gradientVersion,qi=ei.texture}jt.activeTexture.set(St.TEXTURE0),qi.bind(Z.stepInterpolant?St.NEAREST:St.LINEAR,St.CLAMP_TO_EDGE)}const To=R.stencilModeForClipping(Jt);$r.draw(jt,St.TRIANGLES,Ue,To,lt,bn.disabled,zo,mi,go,Z.id,cr.layoutVertexBuffer,cr.indexBuffer,cr.segments,Z.paint,R.transform.zoom,Gr,cr.layoutVertexBuffer2),ur=!1}}(l,p,b,S,k):a.cf(b)?function(R,W,Z,ie,ce){const xe=Z.paint.get("fill-color"),be=Z.paint.get("fill-opacity");if(be.constantOr(1)===0)return;const{isRenderingToTexture:Ae}=ce,Ue=R.colorModeForRenderPass(),lt=Z.paint.get("fill-pattern"),it=R.opaquePassEnabledForLayer()&&!lt.constantOr(1)&&xe.constantOr(a.bf.transparent).a===1&&be.constantOr(0)===1?"opaque":"translucent";if(R.renderPass===it){const ft=R.getDepthModeForSublayer(1,R.renderPass==="opaque"?Nn.ReadWrite:Nn.ReadOnly);dh(R,W,Z,ie,ft,Ue,!1,Ae)}if(R.renderPass==="translucent"&&Z.paint.get("fill-antialias")){const ft=R.getDepthModeForSublayer(Z.getPaintProperty("fill-outline-color")?2:0,Nn.ReadOnly);dh(R,W,Z,ie,ft,Ue,!0,Ae)}}(l,p,b,S,k):a.cg(b)?function(R,W,Z,ie,ce){const xe=Z.paint.get("fill-extrusion-opacity");if(xe===0)return;const{isRenderingToTexture:be}=ce;if(R.renderPass==="translucent"){const Ae=new Nn(R.context.gl.LEQUAL,Nn.ReadWrite,R.depthRangeFor3D);if(xe!==1||Z.paint.get("fill-extrusion-pattern").constantOr(1))ep(R,W,Z,ie,Ae,ni.disabled,di.disabled,be),ep(R,W,Z,ie,Ae,R.stencilModeFor3D(),R.colorModeForRenderPass(),be);else{const Ue=R.colorModeForRenderPass();ep(R,W,Z,ie,Ae,ni.disabled,Ue,be)}}}(l,p,b,S,k):a.ch(b)?function(R,W,Z,ie,ce){if(R.renderPass!=="offscreen"&&R.renderPass!=="translucent")return;const{isRenderingToTexture:xe}=ce,be=R.context,Ae=R.style.projection.useSubdivision,Ue=R.getDepthModeForSublayer(0,Nn.ReadOnly),lt=R.colorModeForRenderPass();if(R.renderPass==="offscreen")(function(it,ft,gt,Et,Mt,It,jt){const St=it.context,Wt=St.gl;for(const ur of gt){const Jt=ft.getTile(ur),nr=Jt.dem;if(!nr||!nr.data||!Jt.needsHillshadePrepare)continue;const cr=nr.dim,Gr=nr.stride,Yr=nr.getPixels();if(St.activeTexture.set(Wt.TEXTURE1),St.pixelStoreUnpackPremultiplyAlpha.set(!1),Jt.demTexture=Jt.demTexture||it.getTileTexture(Gr),Jt.demTexture){const Tn=Jt.demTexture;Tn.update(Yr,{premultiply:!1}),Tn.bind(Wt.NEAREST,Wt.CLAMP_TO_EDGE)}else Jt.demTexture=new a.T(St,Yr,Wt.RGBA,{premultiply:!1}),Jt.demTexture.bind(Wt.NEAREST,Wt.CLAMP_TO_EDGE);St.activeTexture.set(Wt.TEXTURE0);let $r=Jt.fbo;if(!$r){const Tn=new a.T(St,{width:cr,height:cr,data:null},Wt.RGBA);Tn.bind(Wt.LINEAR,Wt.CLAMP_TO_EDGE),$r=Jt.fbo=St.createFramebuffer(cr,cr,!0,!1),$r.colorAttachment.set(Tn.texture)}St.bindFramebuffer.set($r.framebuffer),St.viewport.set([0,0,cr,cr]),it.useProgram("hillshadePrepare").draw(St,Wt.TRIANGLES,Mt,It,jt,bn.disabled,xc(Jt.tileID,nr),null,null,Et.id,it.rasterBoundsBuffer,it.quadTriangleIndexBuffer,it.rasterBoundsSegments),Jt.needsHillshadePrepare=!1}})(R,W,ie,Z,Ue,ni.disabled,lt),be.viewport.set([0,0,R.width,R.height]);else if(R.renderPass==="translucent")if(Ae){const[it,ft,gt]=R.stencilConfigForOverlapTwoPass(ie);ed(R,W,Z,gt,it,Ue,lt,!1,xe),ed(R,W,Z,gt,ft,Ue,lt,!0,xe)}else{const[it,ft]=R.getStencilConfigForOverlapAndUpdateStencilID(ie);ed(R,W,Z,ft,it,Ue,lt,!1,xe)}}(l,p,b,S,k):a.ci(b)?function(R,W,Z,ie,ce){if(R.renderPass!=="translucent"||!ie.length)return;const{isRenderingToTexture:xe}=ce,be=R.style.projection.useSubdivision,Ae=R.getDepthModeForSublayer(0,Nn.ReadOnly),Ue=R.colorModeForRenderPass();if(be){const[lt,it,ft]=R.stencilConfigForOverlapTwoPass(ie);Md(R,W,Z,ft,lt,Ae,Ue,!1,xe),Md(R,W,Z,ft,it,Ae,Ue,!0,xe)}else{const[lt,it]=R.getStencilConfigForOverlapAndUpdateStencilID(ie);Md(R,W,Z,it,lt,Ae,Ue,!1,xe)}}(l,p,b,S,k):a.cj(b)?function(R,W,Z,ie,ce){if(R.renderPass!=="translucent"||Z.paint.get("raster-opacity")===0||!ie.length)return;const{isRenderingToTexture:xe}=ce,be=W.getSource(),Ae=R.style.projection.useSubdivision;if(be instanceof mt)Sc(R,W,Z,ie,null,!1,!1,be.tileCoords,be.flippedWindingOrder,xe);else if(Ae){const[Ue,lt,it]=R.stencilConfigForOverlapTwoPass(ie);Sc(R,W,Z,it,Ue,!1,!0,Sd,!1,xe),Sc(R,W,Z,it,lt,!0,!0,Sd,!1,xe)}else{const[Ue,lt]=R.getStencilConfigForOverlapAndUpdateStencilID(ie);Sc(R,W,Z,lt,Ue,!1,!0,Sd,!1,xe)}}(l,p,b,S,k):a.ck(b)?function(R,W,Z,ie,ce){const xe=Z.paint.get("background-color"),be=Z.paint.get("background-opacity");if(be===0)return;const{isRenderingToTexture:Ae}=ce,Ue=R.context,lt=Ue.gl,it=R.style.projection,ft=R.transform,gt=ft.tileSize,Et=Z.paint.get("background-pattern");if(R.isPatternMissing(Et))return;const Mt=!Et&&xe.a===1&&be===1&&R.opaquePassEnabledForLayer()?"opaque":"translucent";if(R.renderPass!==Mt)return;const It=ni.disabled,jt=R.getDepthModeForSublayer(0,Mt==="opaque"?Nn.ReadWrite:Nn.ReadOnly),St=R.colorModeForRenderPass(),Wt=R.useProgram(Et?"backgroundPattern":"background"),ur=ie||$t(ft,{tileSize:gt,terrain:R.style.map.terrain});Et&&(Ue.activeTexture.set(lt.TEXTURE0),R.imageManager.bind(R.context));const Jt=Z.getCrossfadeParameters();for(const nr of ur){const cr=ft.getProjectionData({overscaledTileID:nr,applyGlobeMatrix:!Ae,applyTerrainMatrix:!0}),Gr=Et?Gc(be,R,Et,{tileID:nr,tileSize:gt},Jt):vl(be,xe),Yr=R.style.map.terrain&&R.style.map.terrain.getTerrainData(nr),$r=it.getMeshFromTileID(Ue,nr.canonical,!1,!0,"raster");Wt.draw(Ue,lt.TRIANGLES,jt,It,St,bn.backCCW,Gr,Yr,cr,Z.id,$r.vertexBuffer,$r.indexBuffer,$r.segments)}}(l,0,b,S,k):a.cl(b)&&function(R,W,Z,ie){const{isRenderingGlobe:ce}=ie,xe=R.context,be=Z.implementation,Ae=R.style.projection,Ue=R.transform,lt=Ue.getProjectionDataForCustomLayer(ce),it={farZ:Ue.farZ,nearZ:Ue.nearZ,fov:Ue.fov*Math.PI/180,modelViewProjectionMatrix:Ue.modelViewProjectionMatrix,projectionMatrix:Ue.projectionMatrix,shaderData:{variantName:Ae.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${Ae.shaderPreludeCode.vertexSource}`,define:Ae.shaderDefine},defaultProjectionData:lt},ft=be.renderingMode?be.renderingMode:"2d";if(R.renderPass==="offscreen"){const gt=be.prerender;gt&&(R.setCustomLayerDefaults(),xe.setColorMode(R.colorModeForRenderPass()),gt.call(be,xe.gl,it),xe.setDirty(),R.setBaseState())}else if(R.renderPass==="translucent"){R.setCustomLayerDefaults(),xe.setColorMode(R.colorModeForRenderPass()),xe.setStencilMode(ni.disabled);const gt=ft==="3d"?R.getDepthModeFor3D():R.getDepthModeForSublayer(0,Nn.ReadOnly);xe.setDepthMode(gt),be.render(xe.gl,it),xe.setDirty(),R.setBaseState(),xe.bindFramebuffer.set(null)}}(l,0,b,k))}saveTileTexture(l){const p=this._tileTextures[l.size[0]];p?p.push(l):this._tileTextures[l.size[0]]=[l]}getTileTexture(l){const p=this._tileTextures[l];return p&&p.length>0?p.pop():null}isPatternMissing(l){if(!l)return!1;if(!l.from||!l.to)return!0;const p=this.imageManager.getPattern(l.from.toString()),b=this.imageManager.getPattern(l.to.toString());return!p||!b}useProgram(l,p,b=!1,S=[]){this.cache=this.cache||{};const k=!!this.style.map.terrain,R=this.style.projection,W=b?Ft.projectionMercator:R.shaderPreludeCode,Z=b?en:R.shaderDefine,ie=l+(p?p.cacheKey:"")+`/${b?Qr:R.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(k?"/terrain":"")+(S?`/${S.join("/")}`:"");return this.cache[ie]||(this.cache[ie]=new vc(this.context,Ft[l],p,Na[l],this._showOverdrawInspector,k,W,Z,S)),this.cache[ie]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:l,drawingBufferHeight:p}=this.context.gl;return this.width!==l||this.height!==p}}function ls(A,l){let p,b=!1,S=null,k=null;const R=()=>{S=null,b&&(A.apply(k,p),S=setTimeout(R,l),b=!1)};return(...W)=>(b=!0,k=this,p=W,S||R(),S)}class Yh{constructor(l){this._getCurrentHash=()=>{const p=window.location.hash.replace("#","");if(this._hashName){let b;return p.split("&").map(S=>S.split("=")).forEach(S=>{S[0]===this._hashName&&(b=S)}),(b&&b[1]||"").split("/")}return p.split("/")},this._onHashChange=()=>{const p=this._getCurrentHash();if(!this._isValidHash(p))return!1;const b=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(p[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+p[2],+p[1]],zoom:+p[0],bearing:b,pitch:+(p[4]||0)}),!0},this._updateHashUnthrottled=()=>{const p=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,p)},this._removeHash=()=>{const p=this._getCurrentHash();if(p.length===0)return;const b=p.join("/");let S=b;S.split("&").length>0&&(S=S.split("&")[0]),this._hashName&&(S=`${this._hashName}=${b}`);let k=window.location.hash.replace(S,"");k.startsWith("#&")?k=k.slice(0,1)+k.slice(2):k==="#"&&(k="");let R=window.location.href.replace(/(#.+)?$/,k);R=R.replace("&&","&"),window.history.replaceState(window.history.state,null,R)},this._updateHash=ls(this._updateHashUnthrottled,300),this._hashName=l&&encodeURIComponent(l)}addTo(l){return this._map=l,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(l){const p=this._map.getCenter(),b=Math.round(100*this._map.getZoom())/100,S=Math.ceil((b*Math.LN2+Math.log(512/360/.5))/Math.LN10),k=Math.pow(10,S),R=Math.round(p.lng*k)/k,W=Math.round(p.lat*k)/k,Z=this._map.getBearing(),ie=this._map.getPitch();let ce="";if(ce+=l?`/${R}/${W}/${b}`:`${b}/${W}/${R}`,(Z||ie)&&(ce+="/"+Math.round(10*Z)/10),ie&&(ce+=`/${Math.round(ie)}`),this._hashName){const xe=this._hashName;let be=!1;const Ae=window.location.hash.slice(1).split("&").map(Ue=>{const lt=Ue.split("=")[0];return lt===xe?(be=!0,`${lt}=${ce}`):Ue}).filter(Ue=>Ue);return be||Ae.push(`${xe}=${ce}`),`#${Ae.join("&")}`}return`#${ce}`}_isValidHash(l){if(l.length<3||l.some(isNaN))return!1;try{new a.S(+l[2],+l[1])}catch{return!1}const p=+l[0],b=+(l[3]||0),S=+(l[4]||0);return p>=this._map.getMinZoom()&&p<=this._map.getMaxZoom()&&b>=-180&&b<=180&&S>=this._map.getMinPitch()&&S<=this._map.getMaxPitch()}}const du={linearity:.3,easing:a.cm(0,0,.3,1)},Qh=a.e({deceleration:2500,maxSpeed:1400},du),Jh=a.e({deceleration:20,maxSpeed:1400},du),np=a.e({deceleration:1e3,maxSpeed:360},du),ip=a.e({deceleration:1e3,maxSpeed:90},du),op=a.e({deceleration:1e3,maxSpeed:360},du);class fh{constructor(l){this._map=l,this.clear()}clear(){this._inertiaBuffer=[]}record(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:_.now(),settings:l})}_drainInertiaBuffer(){const l=this._inertiaBuffer,p=_.now();for(;l.length>0&&p-l[0].time>160;)l.shift()}_onMoveEnd(l){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const p={zoom:0,bearing:0,pitch:0,roll:0,pan:new a.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:k}of this._inertiaBuffer)p.zoom+=k.zoomDelta||0,p.bearing+=k.bearingDelta||0,p.pitch+=k.pitchDelta||0,p.roll+=k.rollDelta||0,k.panDelta&&p.pan._add(k.panDelta),k.around&&(p.around=k.around),k.pinchAround&&(p.pinchAround=k.pinchAround);const b=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,S={};if(p.pan.mag()){const k=Tc(p.pan.mag(),b,a.e({},Qh,l||{})),R=p.pan.mult(k.amount/p.pan.mag()),W=this._map.cameraHelper.handlePanInertia(R,this._map.transform);S.center=W.easingCenter,S.offset=W.easingOffset,Ml(S,k)}if(p.zoom){const k=Tc(p.zoom,b,Jh);S.zoom=this._map.transform.zoom+k.amount,Ml(S,k)}if(p.bearing){const k=Tc(p.bearing,b,np);S.bearing=this._map.transform.bearing+a.ah(k.amount,-179,179),Ml(S,k)}if(p.pitch){const k=Tc(p.pitch,b,ip);S.pitch=this._map.transform.pitch+k.amount,Ml(S,k)}if(p.roll){const k=Tc(p.roll,b,op);S.roll=this._map.transform.roll+a.ah(k.amount,-179,179),Ml(S,k)}if(S.zoom||S.bearing){const k=p.pinchAround===void 0?p.around:p.pinchAround;S.around=k?this._map.unproject(k):this._map.getCenter()}return this.clear(),a.e(S,{noMoveStart:!0})}}function Ml(A,l){(!A.duration||A.duration<l.duration)&&(A.duration=l.duration,A.easing=l.easing)}function Tc(A,l,p){const{maxSpeed:b,linearity:S,deceleration:k}=p,R=a.ah(A*S/(l/1e3),-b,b),W=Math.abs(R)/(k*S);return{easing:p.easing,duration:1e3*W,amount:R*(W/2)}}class zs extends a.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,p,b,S={}){b=b instanceof MouseEvent?b:new MouseEvent(l,b);const k=y.mousePos(p.getCanvas(),b),R=p.unproject(k);super(l,a.e({point:k,lngLat:R,originalEvent:b},S)),this._defaultPrevented=!1,this.target=p}}class td extends a.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,p,b){const S=l==="touchend"?b.changedTouches:b.touches,k=y.touchPos(p.getCanvasContainer(),S),R=k.map(Z=>p.unproject(Z)),W=k.reduce((Z,ie,ce,xe)=>Z.add(ie.div(xe.length)),new a.P(0,0));super(l,{points:k,point:W,lngLats:R,lngLat:p.unproject(W),originalEvent:b}),this._defaultPrevented=!1}}class ef extends a.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,p,b){super(l,{originalEvent:b}),this._defaultPrevented=!1}}class ap{constructor(l,p){this._map=l,this._clickTolerance=p.clickTolerance}reset(){delete this._mousedownPos}wheel(l){return this._firePreventable(new ef(l.type,this._map,l))}mousedown(l,p){return this._mousedownPos=p,this._firePreventable(new zs(l.type,this._map,l))}mouseup(l){this._map.fire(new zs(l.type,this._map,l))}click(l,p){this._mousedownPos&&this._mousedownPos.dist(p)>=this._clickTolerance||this._map.fire(new zs(l.type,this._map,l))}dblclick(l){return this._firePreventable(new zs(l.type,this._map,l))}mouseover(l){this._map.fire(new zs(l.type,this._map,l))}mouseout(l){this._map.fire(new zs(l.type,this._map,l))}touchstart(l){return this._firePreventable(new td(l.type,this._map,l))}touchmove(l){this._map.fire(new td(l.type,this._map,l))}touchend(l){this._map.fire(new td(l.type,this._map,l))}touchcancel(l){this._map.fire(new td(l.type,this._map,l))}_firePreventable(l){if(this._map.fire(l),l.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class im{constructor(l){this._map=l}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(l){this._map.fire(new zs(l.type,this._map,l))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new zs("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(l){this._delayContextMenu?this._contextMenuEvent=l:this._ignoreContextMenu||this._map.fire(new zs(l.type,this._map,l)),this._map.listens("contextmenu")&&l.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class rd{constructor(l){this._map=l}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(l){return this.transform.screenPointToLocation(a.P.convert(l),this._map.terrain)}}class sp{constructor(l,p){this._map=l,this._tr=new rd(l),this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=p.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(l,p){this.isEnabled()&&l.shiftKey&&l.button===0&&(y.disableDrag(),this._startPos=this._lastPos=p,this._active=!0)}mousemoveWindow(l,p){if(!this._active)return;const b=p;if(this._lastPos.equals(b)||!this._box&&b.dist(this._startPos)<this._clickTolerance)return;const S=this._startPos;this._lastPos=b,this._box||(this._box=y.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",l));const k=Math.min(S.x,b.x),R=Math.max(S.x,b.x),W=Math.min(S.y,b.y),Z=Math.max(S.y,b.y);y.setTransform(this._box,`translate(${k}px,${W}px)`),this._box.style.width=R-k+"px",this._box.style.height=Z-W+"px"}mouseupWindow(l,p){if(!this._active||l.button!==0)return;const b=this._startPos,S=p;if(this.reset(),y.suppressClick(),b.x!==S.x||b.y!==S.y)return this._map.fire(new a.l("boxzoomend",{originalEvent:l})),{cameraAnimation:k=>k.fitScreenCoordinates(b,S,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",l)}keydown(l){this._active&&l.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",l))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(y.remove(this._box),this._box=null),y.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(l,p){return this._map.fire(new a.l(l,{originalEvent:p}))}}function Pd(A,l){if(A.length!==l.length)throw new Error(`The number of touches and points are not equal - touches ${A.length}, points ${l.length}`);const p={};for(let b=0;b<A.length;b++)p[A[b].identifier]=l[b];return p}class lp{constructor(l){this.reset(),this.numTouches=l.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(l,p,b){(this.centroid||b.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=l.timeStamp),b.length===this.numTouches&&(this.centroid=function(S){const k=new a.P(0,0);for(const R of S)k._add(R);return k.div(S.length)}(p),this.touches=Pd(b,p)))}touchmove(l,p,b){if(this.aborted||!this.centroid)return;const S=Pd(b,p);for(const k in this.touches){const R=S[k];(!R||R.dist(this.touches[k])>30)&&(this.aborted=!0)}}touchend(l,p,b){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),b.length===0){const S=!this.aborted&&this.centroid;if(this.reset(),S)return S}}}class Sl{constructor(l){this.singleTap=new lp(l),this.numTaps=l.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(l,p,b){this.singleTap.touchstart(l,p,b)}touchmove(l,p,b){this.singleTap.touchmove(l,p,b)}touchend(l,p,b){const S=this.singleTap.touchend(l,p,b);if(S){const k=l.timeStamp-this.lastTime<500,R=!this.lastTap||this.lastTap.dist(S)<30;if(k&&R||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=S,this.count===this.numTaps)return this.reset(),S}}}class ic{constructor(l){this._tr=new rd(l),this._zoomIn=new Sl({numTouches:1,numTaps:2}),this._zoomOut=new Sl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(l,p,b){this._zoomIn.touchstart(l,p,b),this._zoomOut.touchstart(l,p,b)}touchmove(l,p,b){this._zoomIn.touchmove(l,p,b),this._zoomOut.touchmove(l,p,b)}touchend(l,p,b){const S=this._zoomIn.touchend(l,p,b),k=this._zoomOut.touchend(l,p,b),R=this._tr;return S?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:W=>W.easeTo({duration:300,zoom:R.zoom+1,around:R.unproject(S)},{originalEvent:l})}):k?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:W=>W.easeTo({duration:300,zoom:R.zoom-1,around:R.unproject(k)},{originalEvent:l})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Xc{constructor(l){this._enabled=!!l.enable,this._moveStateManager=l.moveStateManager,this._clickTolerance=l.clickTolerance||1,this._moveFunction=l.move,this._activateOnStart=!!l.activateOnStart,l.assignEvents(this),this.reset()}reset(l){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(l)}_move(...l){const p=this._moveFunction(...l);if(p.bearingDelta||p.pitchDelta||p.rollDelta||p.around||p.panDelta)return this._active=!0,p}dragStart(l,p){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(l)&&(this._moveStateManager.startMove(l),this._lastPoint=Array.isArray(p)?p[0]:p,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(l,p){if(!this.isEnabled())return;const b=this._lastPoint;if(!b)return;if(l.preventDefault(),!this._moveStateManager.isValidMoveEvent(l))return void this.reset(l);const S=Array.isArray(p)?p[0]:p;return!this._moved&&S.dist(b)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=S,this._move(b,S))}dragEnd(l){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(l)&&(this._moved&&y.suppressClick(),this.reset(l))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Pc=0,Ed=2,om={[Pc]:1,[Ed]:2};class B{constructor(l){this._correctEvent=l.checkCorrectEvent}startMove(l){const p=y.mouseButton(l);this._eventButton=p}endMove(l){delete this._eventButton}isValidStartEvent(l){return this._correctEvent(l)}isValidMoveEvent(l){return!function(p,b){const S=om[b];return p.buttons===void 0||(p.buttons&S)!==S}(l,this._eventButton)}isValidEndEvent(l){return y.mouseButton(l)===this._eventButton}}class q{constructor(){this._firstTouch=void 0}_isOneFingerTouch(l){return l.targetTouches.length===1}_isSameTouchEvent(l){return l.targetTouches[0].identifier===this._firstTouch}startMove(l){this._firstTouch=l.targetTouches[0].identifier}endMove(l){delete this._firstTouch}isValidStartEvent(l){return this._isOneFingerTouch(l)}isValidMoveEvent(l){return this._isOneFingerTouch(l)&&this._isSameTouchEvent(l)}isValidEndEvent(l){return this._isOneFingerTouch(l)&&this._isSameTouchEvent(l)}}class le{constructor(l=new B({checkCorrectEvent:()=>!0}),p=new q){this.mouseMoveStateManager=l,this.oneFingerTouchMoveStateManager=p}_executeRelevantHandler(l,p,b){return l instanceof MouseEvent?p(l):typeof TouchEvent<"u"&&l instanceof TouchEvent?b(l):void 0}startMove(l){this._executeRelevantHandler(l,p=>this.mouseMoveStateManager.startMove(p),p=>this.oneFingerTouchMoveStateManager.startMove(p))}endMove(l){this._executeRelevantHandler(l,p=>this.mouseMoveStateManager.endMove(p),p=>this.oneFingerTouchMoveStateManager.endMove(p))}isValidStartEvent(l){return this._executeRelevantHandler(l,p=>this.mouseMoveStateManager.isValidStartEvent(p),p=>this.oneFingerTouchMoveStateManager.isValidStartEvent(p))}isValidMoveEvent(l){return this._executeRelevantHandler(l,p=>this.mouseMoveStateManager.isValidMoveEvent(p),p=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(p))}isValidEndEvent(l){return this._executeRelevantHandler(l,p=>this.mouseMoveStateManager.isValidEndEvent(p),p=>this.oneFingerTouchMoveStateManager.isValidEndEvent(p))}}const we=A=>{A.mousedown=A.dragStart,A.mousemoveWindow=A.dragMove,A.mouseup=A.dragEnd,A.contextmenu=l=>{l.preventDefault()}};class Be{constructor(l,p){this._clickTolerance=l.clickTolerance||1,this._map=p,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new a.P(0,0)}_shouldBePrevented(l){return l<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(l,p,b){return this._calculateTransform(l,p,b)}touchmove(l,p,b){if(this._active){if(!this._shouldBePrevented(b.length))return l.preventDefault(),this._calculateTransform(l,p,b);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",l)}}touchend(l,p,b){this._calculateTransform(l,p,b),this._active&&this._shouldBePrevented(b.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(l,p,b){b.length>0&&(this._active=!0);const S=Pd(b,p),k=new a.P(0,0),R=new a.P(0,0);let W=0;for(const ie in S){const ce=S[ie],xe=this._touches[ie];xe&&(k._add(ce),R._add(ce.sub(xe)),W++,S[ie]=ce)}if(this._touches=S,this._shouldBePrevented(W)||!R.mag())return;const Z=R.div(W);return this._sum._add(Z),this._sum.mag()<this._clickTolerance?void 0:{around:k.div(W),panDelta:Z}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ze{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(l,p,b){this._firstTwoTouches||b.length<2||(this._firstTwoTouches=[b[0].identifier,b[1].identifier],this._start([p[0],p[1]]))}touchmove(l,p,b){if(!this._firstTwoTouches)return;l.preventDefault();const[S,k]=this._firstTwoTouches,R=Re(b,p,S),W=Re(b,p,k);if(!R||!W)return;const Z=this._aroundCenter?null:R.add(W).div(2);return this._move([R,W],Z,l)}touchend(l,p,b){if(!this._firstTwoTouches)return;const[S,k]=this._firstTwoTouches,R=Re(b,p,S),W=Re(b,p,k);R&&W||(this._active&&y.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(l){this._enabled=!0,this._aroundCenter=!!l&&l.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Re(A,l,p){for(let b=0;b<A.length;b++)if(A[b].identifier===p)return l[b]}function nt(A,l){return Math.log(A/l)/Math.LN2}class ht extends Ze{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(l){this._startDistance=this._distance=l[0].dist(l[1])}_move(l,p){const b=this._distance;if(this._distance=l[0].dist(l[1]),this._active||!(Math.abs(nt(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:nt(this._distance,b),pinchAround:p}}}function bt(A,l){return 180*A.angleWith(l)/Math.PI}class Gt extends Ze{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(l){this._startVector=this._vector=l[0].sub(l[1]),this._minDiameter=l[0].dist(l[1])}_move(l,p,b){const S=this._vector;if(this._vector=l[0].sub(l[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:bt(this._vector,S),pinchAround:p}}_isBelowThreshold(l){this._minDiameter=Math.min(this._minDiameter,l.mag());const p=25/(Math.PI*this._minDiameter)*360,b=bt(l,this._startVector);return Math.abs(b)<p}}function ar(A){return Math.abs(A.y)>Math.abs(A.x)}class vt extends Ze{constructor(l){super(),this._currentTouchCount=0,this._map=l}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(l,p,b){super.touchstart(l,p,b),this._currentTouchCount=b.length}_start(l){this._lastPoints=l,ar(l[0].sub(l[1]))&&(this._valid=!1)}_move(l,p,b){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const S=l[0].sub(this._lastPoints[0]),k=l[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(S,k,b.timeStamp),this._valid?(this._lastPoints=l,this._active=!0,{pitchDelta:(S.y+k.y)/2*-.5}):void 0}gestureBeginsVertically(l,p,b){if(this._valid!==void 0)return this._valid;const S=l.mag()>=2,k=p.mag()>=2;if(!S&&!k)return;if(!S||!k)return this._firstMove===void 0&&(this._firstMove=b),b-this._firstMove<100&&void 0;const R=l.y>0==p.y>0;return ar(l)&&ar(p)&&R}}const Nt={panStep:100,bearingStep:15,pitchStep:10};class tr{constructor(l){this._tr=new rd(l);const p=Nt;this._panStep=p.panStep,this._bearingStep=p.bearingStep,this._pitchStep=p.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(l){if(l.altKey||l.ctrlKey||l.metaKey)return;let p=0,b=0,S=0,k=0,R=0;switch(l.keyCode){case 61:case 107:case 171:case 187:p=1;break;case 189:case 109:case 173:p=-1;break;case 37:l.shiftKey?b=-1:(l.preventDefault(),k=-1);break;case 39:l.shiftKey?b=1:(l.preventDefault(),k=1);break;case 38:l.shiftKey?S=1:(l.preventDefault(),R=-1);break;case 40:l.shiftKey?S=-1:(l.preventDefault(),R=1);break;default:return}return this._rotationDisabled&&(b=0,S=0),{cameraAnimation:W=>{const Z=this._tr;W.easeTo({duration:300,easeId:"keyboardHandler",easing:Tr,zoom:p?Math.round(Z.zoom)+p*(l.shiftKey?2:1):Z.zoom,bearing:Z.bearing+b*this._bearingStep,pitch:Z.pitch+S*this._pitchStep,offset:[-k*this._panStep,-R*this._panStep],center:Z.center},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Tr(A){return A*(2-A)}const sr=4.000244140625,Ar=1/450;class Lr{constructor(l,p){this._onTimeout=b=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(b)},this._map=l,this._tr=new rd(l),this._triggerRenderFrame=p,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Ar}setZoomRate(l){this._defaultZoomRate=l}setWheelZoomRate(l){this._wheelZoomRate=l}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!l&&l.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(l){return!!this._map.cooperativeGestures.isEnabled()&&!(l.ctrlKey||this._map.cooperativeGestures.isBypassed(l))}wheel(l){if(!this.isEnabled())return;if(this._shouldBePrevented(l))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",l);let p=l.deltaMode===WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY;const b=_.now(),S=b-(this._lastWheelEventTime||0);this._lastWheelEventTime=b,p!==0&&p%sr==0?this._type="wheel":p!==0&&Math.abs(p)<4?this._type="trackpad":S>400?(this._type=null,this._lastValue=p,this._timeout=setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(S*p)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,p+=this._lastValue)),l.shiftKey&&p&&(p/=4),this._type&&(this._lastWheelEvent=l,this._delta-=p,this._active||this._start(l)),l.preventDefault()}_start(l){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const p=y.mousePos(this._map.getCanvas(),l),b=this._tr;this._aroundPoint=this._aroundCenter?b.transform.locationToScreenPoint(a.S.convert(b.center)):p,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const l=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const W=l.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=W),typeof this._targetZoom=="number"&&(this._targetZoom+=W)}if(this._delta!==0){const W=this._type==="wheel"&&Math.abs(this._delta)>sr?this._wheelZoomRate:this._defaultZoomRate;let Z=2/(1+Math.exp(-Math.abs(this._delta*W)));this._delta<0&&Z!==0&&(Z=1/Z);const ie=typeof this._targetZoom!="number"?l.scale:a.af(this._targetZoom);this._targetZoom=l.getConstrained(l.getCameraLngLat(),a.ak(ie*Z)).zoom,this._type==="wheel"&&(this._startZoom=l.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const p=typeof this._targetZoom!="number"?l.zoom:this._targetZoom,b=this._startZoom,S=this._easing;let k,R=!1;if(this._type==="wheel"&&b&&S){const W=_.now()-this._lastWheelEventTime,Z=Math.min((W+5)/200,1),ie=S(Z);k=a.C.number(b,p,ie),Z<1?this._frameId||(this._frameId=!0):R=!0}else k=p,R=!0;return this._active=!0,R&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=k,{noInertia:!0,needsRenderFrame:!R,zoomDelta:k-l.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(l){let p=a.co;if(this._prevEase){const b=this._prevEase,S=(_.now()-b.start)/b.duration,k=b.easing(S+.01)-b.easing(S),R=.27/Math.sqrt(k*k+1e-4)*.01,W=Math.sqrt(.0729-R*R);p=a.cm(R,W,.25,1)}return this._prevEase={start:_.now(),duration:l,easing:p},p}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Zr{constructor(l,p){this._clickZoom=l,this._tapZoom=p}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Ur{constructor(l){this._tr=new rd(l),this.reset()}reset(){this._active=!1}dblclick(l,p){return l.preventDefault(),{cameraAnimation:b=>{b.easeTo({duration:300,zoom:this._tr.zoom+(l.shiftKey?-1:1),around:this._tr.unproject(p)},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class zn{constructor(){this._tap=new Sl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(l,p,b){if(!this._swipePoint)if(this._tapTime){const S=p[0],k=l.timeStamp-this._tapTime<500,R=this._tapPoint.dist(S)<30;k&&R?b.length>0&&(this._swipePoint=S,this._swipeTouch=b[0].identifier):this.reset()}else this._tap.touchstart(l,p,b)}touchmove(l,p,b){if(this._tapTime){if(this._swipePoint){if(b[0].identifier!==this._swipeTouch)return;const S=p[0],k=S.y-this._swipePoint.y;return this._swipePoint=S,l.preventDefault(),this._active=!0,{zoomDelta:k/128}}}else this._tap.touchmove(l,p,b)}touchend(l,p,b){if(this._tapTime)this._swipePoint&&b.length===0&&this.reset();else{const S=this._tap.touchend(l,p,b);S&&(this._tapTime=l.timeStamp,this._tapPoint=S)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Cn{constructor(l,p,b){this._el=l,this._mousePan=p,this._touchPan=b}enable(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Si{constructor(l,p,b,S){this._pitchWithRotate=l.pitchWithRotate,this._rollEnabled=l.rollEnabled,this._mouseRotate=p,this._mousePitch=b,this._mouseRoll=S}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class jn{constructor(l,p,b,S){this._el=l,this._touchZoom=p,this._touchRotate=b,this._tapDragZoom=S,this._rotationDisabled=!1,this._enabled=!0}enable(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Gi{constructor(l,p){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=l,this._options=p,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const l=this._map.getCanvasContainer();l.classList.add("maplibregl-cooperative-gestures"),this._container=y.create("div","maplibregl-cooperative-gesture-screen",l);let p=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(p=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const b=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),S=document.createElement("div");S.className="maplibregl-desktop-message",S.textContent=p,this._container.appendChild(S);const k=document.createElement("div");k.className="maplibregl-mobile-message",k.textContent=b,this._container.appendChild(k),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(y.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(l){return l[this._bypassKey]}notifyGestureBlocked(l,p){this._enabled&&(this._map.fire(new a.l("cooperativegestureprevented",{gestureType:l,originalEvent:p})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Ro=A=>A.zoom||A.drag||A.roll||A.pitch||A.rotate;class En extends a.l{}function kn(A){return A.panDelta&&A.panDelta.mag()||A.zoomDelta||A.bearingDelta||A.pitchDelta||A.rollDelta}class mn{constructor(l,p){this.handleWindowEvent=S=>{this.handleEvent(S,`${S.type}Window`)},this.handleEvent=(S,k)=>{if(S.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const R=S.type==="renderFrame"?void 0:S,W={needsRenderFrame:!1},Z={},ie={};for(const{handlerName:be,handler:Ae,allowed:Ue}of this._handlers){if(!Ae.isEnabled())continue;let lt;if(this._blockedByActive(ie,Ue,be))Ae.reset();else if(Ae[k||S.type]){if(a.cp(S,k||S.type)){const it=y.mousePos(this._map.getCanvas(),S);lt=Ae[k||S.type](S,it)}else if(a.cq(S,k||S.type)){const it=this._getMapTouches(S.touches),ft=y.touchPos(this._map.getCanvas(),it);lt=Ae[k||S.type](S,ft,it)}else a.cr(k||S.type)||(lt=Ae[k||S.type](S));this.mergeHandlerResult(W,Z,lt,be,R),lt&&lt.needsRenderFrame&&this._triggerRenderFrame()}(lt||Ae.isActive())&&(ie[be]=Ae)}const ce={};for(const be in this._previousActiveHandlers)ie[be]||(ce[be]=R);this._previousActiveHandlers=ie,(Object.keys(ce).length||kn(W))&&(this._changes.push([W,Z,ce]),this._triggerRenderFrame()),(Object.keys(ie).length||kn(W))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:xe}=W;xe&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],xe(this._map))},this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new fh(l),this._bearingSnap=p.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(p);const b=this._el;this._listeners=[[b,"touchstart",{passive:!0}],[b,"touchmove",{passive:!1}],[b,"touchend",void 0],[b,"touchcancel",void 0],[b,"mousedown",void 0],[b,"mousemove",void 0],[b,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[b,"mouseover",void 0],[b,"mouseout",void 0],[b,"dblclick",void 0],[b,"click",void 0],[b,"keydown",{capture:!1}],[b,"keyup",void 0],[b,"wheel",{passive:!1}],[b,"contextmenu",void 0],[window,"blur",void 0]];for(const[S,k,R]of this._listeners)y.addEventListener(S,k,S===document?this.handleWindowEvent:this.handleEvent,R)}destroy(){for(const[l,p,b]of this._listeners)y.removeEventListener(l,p,l===document?this.handleWindowEvent:this.handleEvent,b)}_addDefaultHandlers(l){const p=this._map,b=p.getCanvasContainer();this._add("mapEvent",new ap(p,l));const S=p.boxZoom=new sp(p,l);this._add("boxZoom",S),l.interactive&&l.boxZoom&&S.enable();const k=p.cooperativeGestures=new Gi(p,l.cooperativeGestures);this._add("cooperativeGestures",k),l.cooperativeGestures&&k.enable();const R=new ic(p),W=new Ur(p);p.doubleClickZoom=new Zr(W,R),this._add("tapZoom",R),this._add("clickZoom",W),l.interactive&&l.doubleClickZoom&&p.doubleClickZoom.enable();const Z=new zn;this._add("tapDragZoom",Z);const ie=p.touchPitch=new vt(p);this._add("touchPitch",ie),l.interactive&&l.touchPitch&&p.touchPitch.enable(l.touchPitch);const ce=()=>p.project(p.getCenter()),xe=function({enable:Mt,clickTolerance:It,aroundCenter:jt=!0,minPixelCenterThreshold:St=100,rotateDegreesPerPixelMoved:Wt=.8},ur){const Jt=new B({checkCorrectEvent:nr=>y.mouseButton(nr)===0&&nr.ctrlKey||y.mouseButton(nr)===2&&!nr.ctrlKey});return new Xc({clickTolerance:It,move:(nr,cr)=>{const Gr=ur();if(jt&&Math.abs(Gr.y-nr.y)>St)return{bearingDelta:a.cn(new a.P(nr.x,cr.y),cr,Gr)};let Yr=(cr.x-nr.x)*Wt;return jt&&cr.y<Gr.y&&(Yr=-Yr),{bearingDelta:Yr}},moveStateManager:Jt,enable:Mt,assignEvents:we})}(l,ce),be=function({enable:Mt,clickTolerance:It,pitchDegreesPerPixelMoved:jt=-.5}){const St=new B({checkCorrectEvent:Wt=>y.mouseButton(Wt)===0&&Wt.ctrlKey||y.mouseButton(Wt)===2});return new Xc({clickTolerance:It,move:(Wt,ur)=>({pitchDelta:(ur.y-Wt.y)*jt}),moveStateManager:St,enable:Mt,assignEvents:we})}(l),Ae=function({enable:Mt,clickTolerance:It,rollDegreesPerPixelMoved:jt=.3},St){const Wt=new B({checkCorrectEvent:ur=>y.mouseButton(ur)===2&&ur.ctrlKey});return new Xc({clickTolerance:It,move:(ur,Jt)=>{const nr=St();let cr=(Jt.x-ur.x)*jt;return Jt.y<nr.y&&(cr=-cr),{rollDelta:cr}},moveStateManager:Wt,enable:Mt,assignEvents:we})}(l,ce);p.dragRotate=new Si(l,xe,be,Ae),this._add("mouseRotate",xe,["mousePitch"]),this._add("mousePitch",be,["mouseRotate","mouseRoll"]),this._add("mouseRoll",Ae,["mousePitch"]),l.interactive&&l.dragRotate&&p.dragRotate.enable();const Ue=function({enable:Mt,clickTolerance:It}){const jt=new B({checkCorrectEvent:St=>y.mouseButton(St)===0&&!St.ctrlKey});return new Xc({clickTolerance:It,move:(St,Wt)=>({around:Wt,panDelta:Wt.sub(St)}),activateOnStart:!0,moveStateManager:jt,enable:Mt,assignEvents:we})}(l),lt=new Be(l,p);p.dragPan=new Cn(b,Ue,lt),this._add("mousePan",Ue),this._add("touchPan",lt,["touchZoom","touchRotate"]),l.interactive&&l.dragPan&&p.dragPan.enable(l.dragPan);const it=new Gt,ft=new ht;p.touchZoomRotate=new jn(b,ft,it,Z),this._add("touchRotate",it,["touchPan","touchZoom"]),this._add("touchZoom",ft,["touchPan","touchRotate"]),l.interactive&&l.touchZoomRotate&&p.touchZoomRotate.enable(l.touchZoomRotate);const gt=p.scrollZoom=new Lr(p,()=>this._triggerRenderFrame());this._add("scrollZoom",gt,["mousePan"]),l.interactive&&l.scrollZoom&&p.scrollZoom.enable(l.scrollZoom);const Et=p.keyboard=new tr(p);this._add("keyboard",Et),l.interactive&&l.keyboard&&p.keyboard.enable(),this._add("blockableMapEvent",new im(p))}_add(l,p,b){this._handlers.push({handlerName:l,handler:p,allowed:b}),this._handlersById[l]=p}stop(l){if(!this._updatingCamera){for(const{handler:p}of this._handlers)p.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[]}}isActive(){for(const{handler:l}of this._handlers)if(l.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Ro(this._eventsInProgress)||this.isZooming()}_blockedByActive(l,p,b){for(const S in l)if(S!==b&&(!p||p.indexOf(S)<0))return!0;return!1}_getMapTouches(l){const p=[];for(const b of l)this._el.contains(b.target)&&p.push(b);return p}mergeHandlerResult(l,p,b,S,k){if(!b)return;a.e(l,b);const R={handlerName:S,originalEvent:b.originalEvent||k};b.zoomDelta!==void 0&&(p.zoom=R),b.panDelta!==void 0&&(p.drag=R),b.rollDelta!==void 0&&(p.roll=R),b.pitchDelta!==void 0&&(p.pitch=R),b.bearingDelta!==void 0&&(p.rotate=R)}_applyChanges(){const l={},p={},b={};for(const[S,k,R]of this._changes)S.panDelta&&(l.panDelta=(l.panDelta||new a.P(0,0))._add(S.panDelta)),S.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+S.zoomDelta),S.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+S.bearingDelta),S.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+S.pitchDelta),S.rollDelta&&(l.rollDelta=(l.rollDelta||0)+S.rollDelta),S.around!==void 0&&(l.around=S.around),S.pinchAround!==void 0&&(l.pinchAround=S.pinchAround),S.noInertia&&(l.noInertia=S.noInertia),a.e(p,k),a.e(b,R);this._updateMapTransform(l,p,b),this._changes=[]}_updateMapTransform(l,p,b){const S=this._map,k=S._getTransformForUpdate(),R=S.terrain;if(!(kn(l)||R&&this._terrainMovement))return this._fireEvents(p,b,!0);S._stop(!0);let{panDelta:W,zoomDelta:Z,bearingDelta:ie,pitchDelta:ce,rollDelta:xe,around:be,pinchAround:Ae}=l;Ae!==void 0&&(be=Ae),be=be||S.transform.centerPoint,R&&!k.isPointOnMapSurface(be)&&(be=k.centerPoint);const Ue={panDelta:W,zoomDelta:Z,rollDelta:xe,pitchDelta:ce,bearingDelta:ie,around:be};this._map.cameraHelper.useGlobeControls&&!k.isPointOnMapSurface(be)&&(be=k.centerPoint);const lt=be.distSqr(k.centerPoint)<.01?k.center:k.screenPointToLocation(W?be.sub(W):be);R?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(Ue,k),this._terrainMovement||!p.drag&&!p.zoom?p.drag&&this._terrainMovement?k.setCenter(k.screenPointToLocation(k.centerPoint.sub(W))):this._map.cameraHelper.handleMapControlsPan(Ue,k,lt):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(Ue,k,lt))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(Ue,k),this._map.cameraHelper.handleMapControlsPan(Ue,k,lt)),S._applyUpdatedTransform(k),this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(p,b,!0)}_fireEvents(l,p,b){const S=Ro(this._eventsInProgress),k=Ro(l),R={};for(const xe in l){const{originalEvent:be}=l[xe];this._eventsInProgress[xe]||(R[`${xe}start`]=be),this._eventsInProgress[xe]=l[xe]}!S&&k&&this._fireEvent("movestart",k.originalEvent);for(const xe in R)this._fireEvent(xe,R[xe]);k&&this._fireEvent("move",k.originalEvent);for(const xe in l){const{originalEvent:be}=l[xe];this._fireEvent(xe,be)}const W={};let Z;for(const xe in this._eventsInProgress){const{handlerName:be,originalEvent:Ae}=this._eventsInProgress[xe];this._handlersById[be].isActive()||(delete this._eventsInProgress[xe],Z=p[be]||Ae,W[`${xe}end`]=Z)}for(const xe in W)this._fireEvent(xe,W[xe]);const ie=Ro(this._eventsInProgress),ce=(S||k)&&!ie;if(ce&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const xe=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&xe.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(xe)}if(b&&ce){this._updatingCamera=!0;const xe=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),be=Ae=>Ae!==0&&-this._bearingSnap<Ae&&Ae<this._bearingSnap;!xe||!xe.essential&&_.prefersReducedMotion?(this._map.fire(new a.l("moveend",{originalEvent:Z})),be(this._map.getBearing())&&this._map.resetNorth()):(be(xe.bearing||this._map.getBearing())&&(xe.bearing=0),xe.freezeElevation=!0,this._map.easeTo(xe,{originalEvent:Z})),this._updatingCamera=!1}}_fireEvent(l,p){this._map.fire(new a.l(l,p?{originalEvent:p}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(l=>{delete this._frameId,this.handleEvent(new En("renderFrame",{timeStamp:l})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class xa extends a.E{constructor(l,p,b){super(),this._renderFrameCallback=()=>{const S=Math.min((_.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(S)),S<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=l,this._bearingSnap=b.bearingSnap,this.cameraHelper=p,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(l,p){l.apply(this.transform),this.transform=l,this.cameraHelper=p}getCenter(){return new a.S(this.transform.center.lng,this.transform.center.lat)}setCenter(l,p){return this.jumpTo({center:l},p)}getCenterElevation(){return this.transform.elevation}setCenterElevation(l,p){return this.jumpTo({elevation:l},p),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(l){this._centerClampedToGround=l}panBy(l,p,b){return l=a.P.convert(l).mult(-1),this.panTo(this.transform.center,a.e({offset:l},p),b)}panTo(l,p,b){return this.easeTo(a.e({center:l},p),b)}getZoom(){return this.transform.zoom}setZoom(l,p){return this.jumpTo({zoom:l},p),this}zoomTo(l,p,b){return this.easeTo(a.e({zoom:l},p),b)}zoomIn(l,p){return this.zoomTo(this.getZoom()+1,l,p),this}zoomOut(l,p){return this.zoomTo(this.getZoom()-1,l,p),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(l,p){return l!=this.transform.fov&&(this.transform.setFov(l),this.fire(new a.l("movestart",p)).fire(new a.l("move",p)).fire(new a.l("moveend",p))),this}getBearing(){return this.transform.bearing}setBearing(l,p){return this.jumpTo({bearing:l},p),this}getPadding(){return this.transform.padding}setPadding(l,p){return this.jumpTo({padding:l},p),this}rotateTo(l,p,b){return this.easeTo(a.e({bearing:l},p),b)}resetNorth(l,p){return this.rotateTo(0,a.e({duration:1e3},l),p),this}resetNorthPitch(l,p){return this.easeTo(a.e({bearing:0,pitch:0,roll:0,duration:1e3},l),p),this}snapToNorth(l,p){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(l,p):this}getPitch(){return this.transform.pitch}setPitch(l,p){return this.jumpTo({pitch:l},p),this}getRoll(){return this.transform.roll}setRoll(l,p){return this.jumpTo({roll:l},p),this}cameraForBounds(l,p){l=ke.convert(l).adjustAntiMeridian();const b=p&&p.bearing||0;return this._cameraForBoxAndBearing(l.getNorthWest(),l.getSouthEast(),b,p)}_cameraForBoxAndBearing(l,p,b,S){const k={top:0,bottom:0,right:0,left:0};if(typeof(S=a.e({padding:k,offset:[0,0],maxZoom:this.transform.maxZoom},S)).padding=="number"){const ie=S.padding;S.padding={top:ie,bottom:ie,right:ie,left:ie}}const R=a.e(k,S.padding);S.padding=R;const W=this.transform,Z=new ke(l,p);return this.cameraHelper.cameraForBoxAndBearing(S,R,Z,b,W)}fitBounds(l,p,b){return this._fitInternal(this.cameraForBounds(l,p),p,b)}fitScreenCoordinates(l,p,b,S,k){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(a.P.convert(l)),this.transform.screenPointToLocation(a.P.convert(p)),b,S),S,k)}_fitInternal(l,p,b){return l?(delete(p=a.e(l,p)).padding,p.linear?this.easeTo(p,b):this.flyTo(p,b)):this}jumpTo(l,p){this.stop();const b=this._getTransformForUpdate();let S=!1,k=!1,R=!1;const W=b.zoom;this.cameraHelper.handleJumpToCenterZoom(b,l);const Z=b.zoom!==W;return"elevation"in l&&b.elevation!==+l.elevation&&b.setElevation(+l.elevation),"bearing"in l&&b.bearing!==+l.bearing&&(S=!0,b.setBearing(+l.bearing)),"pitch"in l&&b.pitch!==+l.pitch&&(k=!0,b.setPitch(+l.pitch)),"roll"in l&&b.roll!==+l.roll&&(R=!0,b.setRoll(+l.roll)),l.padding==null||b.isPaddingEqual(l.padding)||b.setPadding(l.padding),this._applyUpdatedTransform(b),this.fire(new a.l("movestart",p)).fire(new a.l("move",p)),Z&&this.fire(new a.l("zoomstart",p)).fire(new a.l("zoom",p)).fire(new a.l("zoomend",p)),S&&this.fire(new a.l("rotatestart",p)).fire(new a.l("rotate",p)).fire(new a.l("rotateend",p)),k&&this.fire(new a.l("pitchstart",p)).fire(new a.l("pitch",p)).fire(new a.l("pitchend",p)),R&&this.fire(new a.l("rollstart",p)).fire(new a.l("roll",p)).fire(new a.l("rollend",p)),this.fire(new a.l("moveend",p))}calculateCameraOptionsFromTo(l,p,b,S=0){const k=a.a1.fromLngLat(l,p),R=a.a1.fromLngLat(b,S),W=R.x-k.x,Z=R.y-k.y,ie=R.z-k.z,ce=Math.hypot(W,Z,ie);if(ce===0)throw new Error("Can't calculate camera options with same From and To");const xe=Math.hypot(W,Z),be=a.ak(this.transform.cameraToCenterDistance/ce/this.transform.tileSize),Ae=180*Math.atan2(W,-Z)/Math.PI;let Ue=180*Math.acos(xe/ce)/Math.PI;return Ue=ie<0?90-Ue:90+Ue,{center:R.toLngLat(),elevation:S,zoom:be,pitch:Ue,bearing:Ae}}calculateCameraOptionsFromCameraLngLatAltRotation(l,p,b,S,k){const R=this.transform.calculateCenterFromCameraLngLatAlt(l,p,b,S);return{center:R.center,elevation:R.elevation,zoom:R.zoom,bearing:b,pitch:S,roll:k}}easeTo(l,p){this._stop(!1,l.easeId),((l=a.e({offset:[0,0],duration:500,easing:a.co},l)).animate===!1||!l.essential&&_.prefersReducedMotion)&&(l.duration=0);const b=this._getTransformForUpdate(),S=this.getBearing(),k=b.pitch,R=b.roll,W="bearing"in l?this._normalizeBearing(l.bearing,S):S,Z="pitch"in l?+l.pitch:k,ie="roll"in l?this._normalizeBearing(l.roll,R):R,ce="padding"in l?l.padding:b.padding,xe=a.P.convert(l.offset);let be,Ae;l.around&&(be=a.S.convert(l.around),Ae=b.locationToScreenPoint(be));const Ue={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},lt=this.cameraHelper.handleEaseTo(b,{bearing:W,pitch:Z,roll:ie,padding:ce,around:be,aroundPoint:Ae,offsetAsPoint:xe,offset:l.offset,zoom:l.zoom,center:l.center});return this._rotating=this._rotating||S!==W,this._pitching=this._pitching||Z!==k,this._rolling=this._rolling||ie!==R,this._padding=!b.isPaddingEqual(ce),this._zooming=this._zooming||lt.isZooming,this._easeId=l.easeId,this._prepareEase(p,l.noMoveStart,Ue),this.terrain&&this._prepareElevation(lt.elevationCenter),this._ease(it=>{lt.easeFunc(it),this.terrain&&!l.freezeElevation&&this._updateElevation(it),this._applyUpdatedTransform(b),this._fireMoveEvents(p)},it=>{this.terrain&&l.freezeElevation&&this._finalizeElevation(),this._afterEase(p,it)},l),this}_prepareEase(l,p,b={}){this._moving=!0,p||b.moving||this.fire(new a.l("movestart",l)),this._zooming&&!b.zooming&&this.fire(new a.l("zoomstart",l)),this._rotating&&!b.rotating&&this.fire(new a.l("rotatestart",l)),this._pitching&&!b.pitching&&this.fire(new a.l("pitchstart",l)),this._rolling&&!b.rolling&&this.fire(new a.l("rollstart",l))}_prepareElevation(l){this._elevationCenter=l,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(l,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(l){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const p=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(l<1&&p!==this._elevationTarget){const b=this._elevationTarget-this._elevationStart;this._elevationStart+=l*(b-(p-(b*l+this._elevationStart))/(1-l)),this._elevationTarget=p}this.transform.setElevation(a.C.number(this._elevationStart,this._elevationTarget,l))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(l){if(!this.terrain&&l.elevation>=0&&l.pitch<=90)return{};const p=l.getCameraLngLat(),b=l.getCameraAltitude(),S=this.terrain?this.terrain.getElevationForLngLatZoom(p,l.zoom):0;if(b<S){const k=this.calculateCameraOptionsFromTo(p,S,l.center,l.elevation);return{pitch:k.pitch,zoom:k.zoom}}return{}}_applyUpdatedTransform(l){const p=[];if(p.push(S=>this._elevateCameraIfInsideTerrain(S)),this.transformCameraUpdate&&p.push(S=>this.transformCameraUpdate(S)),!p.length)return;const b=l.clone();for(const S of p){const k=b.clone(),{center:R,zoom:W,roll:Z,pitch:ie,bearing:ce,elevation:xe}=S(k);R&&k.setCenter(R),xe!==void 0&&k.setElevation(xe),W!==void 0&&k.setZoom(W),Z!==void 0&&k.setRoll(Z),ie!==void 0&&k.setPitch(ie),ce!==void 0&&k.setBearing(ce),b.apply(k)}this.transform.apply(b)}_fireMoveEvents(l){this.fire(new a.l("move",l)),this._zooming&&this.fire(new a.l("zoom",l)),this._rotating&&this.fire(new a.l("rotate",l)),this._pitching&&this.fire(new a.l("pitch",l)),this._rolling&&this.fire(new a.l("roll",l))}_afterEase(l,p){if(this._easeId&&p&&this._easeId===p)return;delete this._easeId;const b=this._zooming,S=this._rotating,k=this._pitching,R=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,b&&this.fire(new a.l("zoomend",l)),S&&this.fire(new a.l("rotateend",l)),k&&this.fire(new a.l("pitchend",l)),R&&this.fire(new a.l("rollend",l)),this.fire(new a.l("moveend",l))}flyTo(l,p){if(!l.essential&&_.prefersReducedMotion){const cr=a.Q(l,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(cr,p)}this.stop(),l=a.e({offset:[0,0],speed:1.2,curve:1.42,easing:a.co},l);const b=this._getTransformForUpdate(),S=b.bearing,k=b.pitch,R=b.roll,W=b.padding,Z="bearing"in l?this._normalizeBearing(l.bearing,S):S,ie="pitch"in l?+l.pitch:k,ce="roll"in l?this._normalizeBearing(l.roll,R):R,xe="padding"in l?l.padding:b.padding,be=a.P.convert(l.offset);let Ae=b.centerPoint.add(be);const Ue=b.screenPointToLocation(Ae),lt=this.cameraHelper.handleFlyTo(b,{bearing:Z,pitch:ie,roll:ce,padding:xe,locationAtOffset:Ue,offsetAsPoint:be,center:l.center,minZoom:l.minZoom,zoom:l.zoom});let it=l.curve;const ft=Math.max(b.width,b.height),gt=ft/lt.scaleOfZoom,Et=lt.pixelPathLength;typeof lt.scaleOfMinZoom=="number"&&(it=Math.sqrt(ft/lt.scaleOfMinZoom/Et*2));const Mt=it*it;function It(cr){const Gr=(gt*gt-ft*ft+(cr?-1:1)*Mt*Mt*Et*Et)/(2*(cr?gt:ft)*Mt*Et);return Math.log(Math.sqrt(Gr*Gr+1)-Gr)}function jt(cr){return(Math.exp(cr)-Math.exp(-cr))/2}function St(cr){return(Math.exp(cr)+Math.exp(-cr))/2}const Wt=It(!1);let ur=function(cr){return St(Wt)/St(Wt+it*cr)},Jt=function(cr){return ft*((St(Wt)*(jt(Gr=Wt+it*cr)/St(Gr))-jt(Wt))/Mt)/Et;var Gr},nr=(It(!0)-Wt)/it;if(Math.abs(Et)<2e-6||!isFinite(nr)){if(Math.abs(ft-gt)<1e-6)return this.easeTo(l,p);const cr=gt<ft?-1:1;nr=Math.abs(Math.log(gt/ft))/it,Jt=()=>0,ur=Gr=>Math.exp(cr*it*Gr)}return l.duration="duration"in l?+l.duration:1e3*nr/("screenSpeed"in l?+l.screenSpeed/it:+l.speed),l.maxDuration&&l.duration>l.maxDuration&&(l.duration=0),this._zooming=!0,this._rotating=S!==Z,this._pitching=ie!==k,this._rolling=ce!==R,this._padding=!b.isPaddingEqual(xe),this._prepareEase(p,!1),this.terrain&&this._prepareElevation(lt.targetCenter),this._ease(cr=>{const Gr=cr*nr,Yr=1/ur(Gr),$r=Jt(Gr);this._rotating&&b.setBearing(a.C.number(S,Z,cr)),this._pitching&&b.setPitch(a.C.number(k,ie,cr)),this._rolling&&b.setRoll(a.C.number(R,ce,cr)),this._padding&&(b.interpolatePadding(W,xe,cr),Ae=b.centerPoint.add(be)),lt.easeFunc(cr,Yr,$r,Ae),this.terrain&&!l.freezeElevation&&this._updateElevation(cr),this._applyUpdatedTransform(b),this._fireMoveEvents(p)},()=>{this.terrain&&l.freezeElevation&&this._finalizeElevation(),this._afterEase(p)},l),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(l,p){var b;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const S=this._onEaseEnd;delete this._onEaseEnd,S.call(this,p)}return l||(b=this.handlers)===null||b===void 0||b.stop(!1),this}_ease(l,p,b){b.animate===!1||b.duration===0?(l(1),p()):(this._easeStart=_.now(),this._easeOptions=b,this._onEaseFrame=l,this._onEaseEnd=p,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(l,p){l=a.aO(l,-180,180);const b=Math.abs(l-p);return Math.abs(l-360-p)<b&&(l-=360),Math.abs(l+360-p)<b&&(l+=360),l}queryTerrainElevation(l){return this.terrain?this.terrain.getElevationForLngLatZoom(a.S.convert(l),this.transform.tileZoom):null}}const hi={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class eo{constructor(l=hi){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=p=>{!p||p.sourceDataType!=="metadata"&&p.sourceDataType!=="visibility"&&p.dataType!=="style"&&p.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=l}getDefaultPosition(){return"bottom-right"}onAdd(l){return this._map=l,this._compact=this.options.compact,this._container=y.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=y.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=y.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){y.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(l,p){const b=this._map._getUIString(`AttributionControl.${p}`);l.title=b,l.setAttribute("aria-label",b)}_updateAttributions(){if(!this._map.style)return;let l=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=l.concat(this.options.customAttribution.map(S=>typeof S!="string"?"":S)):typeof this.options.customAttribution=="string"&&l.push(this.options.customAttribution)),this._map.style.stylesheet){const S=this._map.style.stylesheet;this.styleOwner=S.owner,this.styleId=S.id}const p=this._map.style.sourceCaches;for(const S in p){const k=p[S];if(k.used||k.usedForTerrain){const R=k.getSource();R.attribution&&l.indexOf(R.attribution)<0&&l.push(R.attribution)}}l=l.filter(S=>String(S).trim()),l.sort((S,k)=>S.length-k.length),l=l.filter((S,k)=>{for(let R=k+1;R<l.length;R++)if(l[R].indexOf(S)>=0)return!1;return!0});const b=l.join(" | ");b!==this._attribHTML&&(this._attribHTML=b,l.length?(this._innerContainer.innerHTML=y.sanitize(b),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Zo{constructor(l={}){this._updateCompact=()=>{const p=this._container.children;if(p.length){const b=p[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&b.classList.add("maplibregl-compact"):b.classList.remove("maplibregl-compact")}},this.options=l}getDefaultPosition(){return"bottom-left"}onAdd(l){this._map=l,this._compact=this.options&&this.options.compact,this._container=y.create("div","maplibregl-ctrl");const p=y.create("a","maplibregl-ctrl-logo");return p.target="_blank",p.rel="noopener nofollow",p.href="https://maplibre.org/",p.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),p.setAttribute("rel","noopener nofollow"),this._container.appendChild(p),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){y.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Wo{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(l){const p=++this._id;return this._queue.push({callback:l,id:p,cancelled:!1}),p}remove(l){const p=this._currentlyRunning,b=p?this._queue.concat(p):this._queue;for(const S of b)if(S.id===l)return void(S.cancelled=!0)}run(l=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const p=this._currentlyRunning=this._queue;this._queue=[];for(const b of p)if(!b.cancelled&&(b.callback(l),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Ha=a.aJ([{name:"a_pos3d",type:"Int16",components:3}]);class on extends a.E{constructor(l){super(),this._lastTilesetChange=_.now(),this.sourceCache=l,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=l._source.tileSize*2**this.deltaZoom,l.usedForTerrain=!0,l.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(l,p){this.sourceCache.update(l,p),this._renderableTilesKeys=[];const b={};for(const S of $t(l,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:p,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))b[S.key]=!0,this._renderableTilesKeys.push(S.key),this._tiles[S.key]||(S.terrainRttPosMatrix32f=new Float64Array(16),a.bY(S.terrainRttPosMatrix32f,0,a.$,a.$,0,0,1),this._tiles[S.key]=new or(S,this.tileSize),this._lastTilesetChange=_.now());for(const S in this._tiles)b[S]||delete this._tiles[S]}freeRtt(l){for(const p in this._tiles){const b=this._tiles[p];(!l||b.tileID.equals(l)||b.tileID.isChildOf(l)||l.isChildOf(b.tileID))&&(b.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(l=>this.getTileByID(l))}getTileByID(l){return this._tiles[l]}getTerrainCoords(l,p){return p?this._getTerrainCoordsForTileRanges(l,p):this._getTerrainCoordsForRegularTile(l)}_getTerrainCoordsForRegularTile(l){const p={};for(const b of this._renderableTilesKeys){const S=this._tiles[b].tileID,k=l.clone(),R=a.ba();if(S.canonical.equals(l.canonical))a.bY(R,0,a.$,a.$,0,0,1);else if(S.canonical.isChildOf(l.canonical)){const W=S.canonical.z-l.canonical.z,Z=S.canonical.x-(S.canonical.x>>W<<W),ie=S.canonical.y-(S.canonical.y>>W<<W),ce=a.$>>W;a.bY(R,0,ce,ce,0,0,1),a.M(R,R,[-Z*ce,-ie*ce,0])}else{if(!l.canonical.isChildOf(S.canonical))continue;{const W=l.canonical.z-S.canonical.z,Z=l.canonical.x-(l.canonical.x>>W<<W),ie=l.canonical.y-(l.canonical.y>>W<<W),ce=a.$>>W;a.bY(R,0,a.$,a.$,0,0,1),a.M(R,R,[Z*ce,ie*ce,0]),a.N(R,R,[1/2**W,1/2**W,0])}}k.terrainRttPosMatrix32f=new Float32Array(R),p[b]=k}return p}_getTerrainCoordsForTileRanges(l,p){const b={};for(const S of this._renderableTilesKeys){const k=this._tiles[S].tileID;if(!this._isWithinTileRanges(k,p))continue;const R=l.clone(),W=a.ba();if(k.canonical.z===l.canonical.z){const Z=l.canonical.x-k.canonical.x,ie=l.canonical.y-k.canonical.y;a.bY(W,0,a.$,a.$,0,0,1),a.M(W,W,[Z*a.$,ie*a.$,0])}else if(k.canonical.z>l.canonical.z){const Z=k.canonical.z-l.canonical.z,ie=k.canonical.x-(k.canonical.x>>Z<<Z),ce=k.canonical.y-(k.canonical.y>>Z<<Z),xe=l.canonical.x-(k.canonical.x>>Z),be=l.canonical.y-(k.canonical.y>>Z),Ae=a.$>>Z;a.bY(W,0,Ae,Ae,0,0,1),a.M(W,W,[-ie*Ae+xe*a.$,-ce*Ae+be*a.$,0])}else{const Z=l.canonical.z-k.canonical.z,ie=l.canonical.x-(l.canonical.x>>Z<<Z),ce=l.canonical.y-(l.canonical.y>>Z<<Z),xe=(l.canonical.x>>Z)-k.canonical.x,be=(l.canonical.y>>Z)-k.canonical.y,Ae=a.$<<Z;a.bY(W,0,Ae,Ae,0,0,1),a.M(W,W,[ie*a.$+xe*Ae,ce*a.$+be*Ae,0])}R.terrainRttPosMatrix32f=new Float32Array(W),b[S]=R}return b}getSourceTile(l,p){const b=this.sourceCache._source;let S=l.overscaledZ-this.deltaZoom;if(S>b.maxzoom&&(S=b.maxzoom),S<b.minzoom)return null;this._sourceTileCache[l.key]||(this._sourceTileCache[l.key]=l.scaledTo(S).key);let k=this.sourceCache.getTileByID(this._sourceTileCache[l.key]);if((!k||!k.dem)&&p)for(;S>=b.minzoom&&(!k||!k.dem);)k=this.sourceCache.getTileByID(l.scaledTo(S--).key);return k}anyTilesAfterTime(l=Date.now()){return this._lastTilesetChange>=l}_isWithinTileRanges(l,p){return p[l.canonical.z]&&l.canonical.x>=p[l.canonical.z].minTileX&&l.canonical.x<=p[l.canonical.z].maxTileX&&l.canonical.y>=p[l.canonical.z].minTileY&&l.canonical.y<=p[l.canonical.z].maxTileY}}class xn{constructor(l,p,b){this._meshCache={},this.painter=l,this.sourceCache=new on(p),this.options=b,this.exaggeration=typeof b.exaggeration=="number"?b.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(l,p,b,S=a.$){var k;if(!(p>=0&&p<S&&b>=0&&b<S))return 0;const R=this.getTerrainData(l),W=(k=R.tile)===null||k===void 0?void 0:k.dem;if(!W)return 0;const Z=a.cs([],[p/S*a.$,b/S*a.$],R.u_terrain_matrix),ie=[Z[0]*W.dim,Z[1]*W.dim],ce=Math.floor(ie[0]),xe=Math.floor(ie[1]),be=ie[0]-ce,Ae=ie[1]-xe;return W.get(ce,xe)*(1-be)*(1-Ae)+W.get(ce+1,xe)*be*(1-Ae)+W.get(ce,xe+1)*(1-be)*Ae+W.get(ce+1,xe+1)*be*Ae}getElevationForLngLatZoom(l,p){if(!a.ct(p,l.wrap()))return 0;const{tileID:b,mercatorX:S,mercatorY:k}=this._getOverscaledTileIDFromLngLatZoom(l,p);return this.getElevation(b,S%a.$,k%a.$,a.$)}getElevation(l,p,b,S=a.$){return this.getDEMElevation(l,p,b,S)*this.exaggeration}getTerrainData(l){if(!this._emptyDemTexture){const S=this.painter.context,k=new a.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new a.T(S,k,S.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new a.T(S,new a.R({width:1,height:1}),S.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(S.gl.NEAREST,S.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=a.ag([])}const p=this.sourceCache.getSourceTile(l,!0);if(p&&p.dem&&(!p.demTexture||p.needsTerrainPrepare)){const S=this.painter.context;p.demTexture=this.painter.getTileTexture(p.dem.stride),p.demTexture?p.demTexture.update(p.dem.getPixels(),{premultiply:!1}):p.demTexture=new a.T(S,p.dem.getPixels(),S.gl.RGBA,{premultiply:!1}),p.demTexture.bind(S.gl.NEAREST,S.gl.CLAMP_TO_EDGE),p.needsTerrainPrepare=!1}const b=p&&p+p.tileID.key+l.key;if(b&&!this._demMatrixCache[b]){const S=this.sourceCache.sourceCache._source.maxzoom;let k=l.canonical.z-p.tileID.canonical.z;l.overscaledZ>l.canonical.z&&(l.canonical.z>=S?k=l.canonical.z-S:a.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const R=l.canonical.x-(l.canonical.x>>k<<k),W=l.canonical.y-(l.canonical.y>>k<<k),Z=a.cu(new Float64Array(16),[1/(a.$<<k),1/(a.$<<k),0]);a.M(Z,Z,[R*a.$,W*a.$,0]),this._demMatrixCache[l.key]={matrix:Z,coord:l}}return{u_depth:2,u_terrain:3,u_terrain_dim:p&&p.dem&&p.dem.dim||1,u_terrain_matrix:b?this._demMatrixCache[l.key].matrix:this._emptyDemMatrix,u_terrain_unpack:p&&p.dem&&p.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(p&&p.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:p}}getFramebuffer(l){const p=this.painter,b=p.width/devicePixelRatio,S=p.height/devicePixelRatio;return!this._fbo||this._fbo.width===b&&this._fbo.height===S||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new a.T(p.context,{width:b,height:S,data:null},p.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(p.context.gl.NEAREST,p.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new a.T(p.context,{width:b,height:S,data:null},p.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(p.context.gl.NEAREST,p.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=p.context.createFramebuffer(b,S,!0,!1),this._fbo.depthAttachment.set(p.context.createRenderbuffer(p.context.gl.DEPTH_COMPONENT16,b,S))),this._fbo.colorAttachment.set(l==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const l=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const p=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let k=0,R=0;k<this._coordsTextureSize;k++)for(let W=0;W<this._coordsTextureSize;W++,R+=4)p[R+0]=255&W,p[R+1]=255&k,p[R+2]=W>>8<<4|k>>8,p[R+3]=0;const b=new a.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(p.buffer)),S=new a.T(l,b,l.gl.RGBA,{premultiply:!1});return S.bind(l.gl.NEAREST,l.gl.CLAMP_TO_EDGE),this._coordsTexture=S,S}pointCoordinate(l){this.painter.maybeDrawDepthAndCoords(!0);const p=new Uint8Array(4),b=this.painter.context,S=b.gl,k=Math.round(l.x*this.painter.pixelRatio/devicePixelRatio),R=Math.round(l.y*this.painter.pixelRatio/devicePixelRatio),W=Math.round(this.painter.height/devicePixelRatio);b.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),S.readPixels(k,W-R-1,1,1,S.RGBA,S.UNSIGNED_BYTE,p),b.bindFramebuffer.set(null);const Z=p[0]+(p[2]>>4<<8),ie=p[1]+((15&p[2])<<8),ce=this.coordsIndex[255-p[3]],xe=ce&&this.sourceCache.getTileByID(ce);if(!xe)return null;const be=this._coordsTextureSize,Ae=(1<<xe.tileID.canonical.z)*be;return new a.a1((xe.tileID.canonical.x*be+Z)/Ae+xe.tileID.wrap,(xe.tileID.canonical.y*be+ie)/Ae,this.getElevation(xe.tileID,Z,ie,be))}depthAtPoint(l){const p=new Uint8Array(4),b=this.painter.context,S=b.gl;return b.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),S.readPixels(l.x,this.painter.height/devicePixelRatio-l.y-1,1,1,S.RGBA,S.UNSIGNED_BYTE,p),b.bindFramebuffer.set(null),(p[0]/16777216+p[1]/65536+p[2]/256+p[3])/256}getTerrainMesh(l){var p;const b=((p=this.painter.style.projection)===null||p===void 0?void 0:p.transitionState)>0,S=b&&l.canonical.y===0,k=b&&l.canonical.y===(1<<l.canonical.z)-1,R=`m_${S?"n":""}_${k?"s":""}`;if(this._meshCache[R])return this._meshCache[R];const W=this.painter.context,Z=new a.cv,ie=new a.aN,ce=this.meshSize,xe=a.$/ce,be=ce*ce;for(let St=0;St<=ce;St++)for(let Wt=0;Wt<=ce;Wt++)Z.emplaceBack(Wt*xe,St*xe,0);for(let St=0;St<be;St+=ce+1)for(let Wt=0;Wt<ce;Wt++)ie.emplaceBack(Wt+St,ce+Wt+St+1,ce+Wt+St+2),ie.emplaceBack(Wt+St,ce+Wt+St+2,Wt+St+1);const Ae=Z.length,Ue=Ae+(ce+1),lt=(ce+1)*ce,it=S?a.bh:0,ft=S?0:1,gt=k?a.bi:a.$,Et=k?0:1;for(let St=0;St<=ce;St++)Z.emplaceBack(St*xe,it,ft);for(let St=0;St<=ce;St++)Z.emplaceBack(St*xe,gt,Et);for(let St=0;St<ce;St++)ie.emplaceBack(lt+St,Ue+St,Ue+St+1),ie.emplaceBack(lt+St,Ue+St+1,lt+St+1),ie.emplaceBack(0+St,Ae+St+1,Ae+St),ie.emplaceBack(0+St,0+St+1,Ae+St+1);const Mt=Z.length,It=Mt+2*(ce+1);for(const St of[0,1])for(let Wt=0;Wt<=ce;Wt++)for(const ur of[0,1])Z.emplaceBack(St*a.$,Wt*xe,ur);for(let St=0;St<2*ce;St+=2)ie.emplaceBack(Mt+St,Mt+St+1,Mt+St+3),ie.emplaceBack(Mt+St,Mt+St+3,Mt+St+2),ie.emplaceBack(It+St,It+St+3,It+St+1),ie.emplaceBack(It+St,It+St+2,It+St+3);const jt=new yr(W.createVertexBuffer(Z,Ha.members),W.createIndexBuffer(ie),a.aM.simpleSegment(0,0,Z.length,ie.length));return this._meshCache[R]=jt,jt}getMeshFrameDelta(l){return 2*Math.PI*a.bu/Math.pow(2,Math.max(l,0))/5}getMinTileElevationForLngLatZoom(l,p){var b;const{tileID:S}=this._getOverscaledTileIDFromLngLatZoom(l,p);return(b=this.getMinMaxElevation(S).minElevation)!==null&&b!==void 0?b:0}getMinMaxElevation(l){const p=this.getTerrainData(l).tile,b={minElevation:null,maxElevation:null};return p&&p.dem&&(b.minElevation=p.dem.min*this.exaggeration,b.maxElevation=p.dem.max*this.exaggeration),b}_getOverscaledTileIDFromLngLatZoom(l,p){const b=a.a1.fromLngLat(l.wrap()),S=(1<<p)*a.$,k=b.x*S,R=b.y*S,W=Math.floor(k/a.$),Z=Math.floor(R/a.$);return{tileID:new a.Z(p,0,p,W,Z),mercatorX:k,mercatorY:R}}}class cs{constructor(l,p,b){this._context=l,this._size=p,this._tileSize=b,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const l of this._objects)l.texture.destroy(),l.fbo.destroy()}_createObject(l){const p=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),b=new a.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return b.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),p.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),p.colorAttachment.set(b.texture),{id:l,fbo:p,texture:b,stamp:-1,inUse:!1}}getObjectForId(l){return this._objects[l]}useObject(l){l.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(p=>l.id!==p),this._recentlyUsed.push(l.id)}stampObject(l){l.stamp=++this._stamp}getOrCreateFreeObject(){for(const p of this._recentlyUsed)if(!this._objects[p].inUse)return this._objects[p];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const l=this._createObject(this._objects.length);return this._objects.push(l),l}freeObject(l){l.inUse=!1}freeAllObjects(){for(const l of this._objects)this.freeObject(l)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(l=>!l.inUse)===!1}}const Xo={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class Fi{constructor(l,p){this.painter=l,this.terrain=p,this.pool=new cs(l.context,30,p.sourceCache.tileSize*p.qualityFactor)}destruct(){this.pool.destruct()}getTexture(l){return this.pool.getObjectForId(l.rtt[this._stacks.length-1].id).texture}prepareForRender(l,p){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=l._order.filter(b=>!l._layers[b].isHidden(p)),this._coordsAscending={};for(const b in l.sourceCaches){this._coordsAscending[b]={};const S=l.sourceCaches[b].getVisibleCoordinates(),k=l.sourceCaches[b].getSource(),R=k instanceof mt?k.terrainTileRanges:null;for(const W of S){const Z=this.terrain.sourceCache.getTerrainCoords(W,R);for(const ie in Z)this._coordsAscending[b][ie]||(this._coordsAscending[b][ie]=[]),this._coordsAscending[b][ie].push(Z[ie])}}this._coordsAscendingStr={};for(const b of l._order){const S=l._layers[b],k=S.source;if(Xo[S.type]&&!this._coordsAscendingStr[k]){this._coordsAscendingStr[k]={};for(const R in this._coordsAscending[k])this._coordsAscendingStr[k][R]=this._coordsAscending[k][R].map(W=>W.key).sort().join()}}for(const b of this._renderableTiles)for(const S in this._coordsAscendingStr){const k=this._coordsAscendingStr[S][b.tileID.key];k&&k!==b.rttCoords[S]&&(b.rtt=[])}}renderLayer(l,p){if(l.isHidden(this.painter.transform.zoom))return!1;const b=Object.assign(Object.assign({},p),{isRenderingToTexture:!0}),S=l.type,k=this.painter,R=this._renderableLayerIds[this._renderableLayerIds.length-1]===l.id;if(Xo[S]&&(this._prevType&&Xo[this._prevType]||this._stacks.push([]),this._prevType=S,this._stacks[this._stacks.length-1].push(l.id),!R))return!0;if(Xo[this._prevType]||Xo[S]&&R){this._prevType=S;const W=this._stacks.length-1,Z=this._stacks[W]||[];for(const ie of this._renderableTiles){if(this.pool.isFull()&&(Xh(this.painter,this.terrain,this._rttTiles,b),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(ie),ie.rtt[W]){const xe=this.pool.getObjectForId(ie.rtt[W].id);if(xe.stamp===ie.rtt[W].stamp){this.pool.useObject(xe);continue}}const ce=this.pool.getOrCreateFreeObject();this.pool.useObject(ce),this.pool.stampObject(ce),ie.rtt[W]={id:ce.id,stamp:ce.stamp},k.context.bindFramebuffer.set(ce.fbo.framebuffer),k.context.clear({color:a.bf.transparent,stencil:0}),k.currentStencilSource=void 0;for(let xe=0;xe<Z.length;xe++){const be=k.style._layers[Z[xe]],Ae=be.source?this._coordsAscending[be.source][ie.tileID.key]:[ie.tileID];k.context.viewport.set([0,0,ce.fbo.width,ce.fbo.height]),k._renderTileClippingMasks(be,Ae,!0),k.renderLayer(k,k.style.sourceCaches[be.source],be,Ae,b),be.source&&(ie.rttCoords[be.source]=this._coordsAscendingStr[be.source][ie.tileID.key])}}return Xh(this.painter,this.terrain,this._rttTiles,b),this._rttTiles=[],this.pool.freeAllObjects(),Xo[S]}return!1}}const wi={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},_a=u,Li={hash:!1,interactive:!0,bearingSnap:7,attributionControl:hi,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:a.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},Ps={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Bs{constructor(l,p,b=!1){this.mousedown=k=>{this.startMove(k,y.mousePos(this.element,k)),y.addEventListener(window,"mousemove",this.mousemove),y.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=k=>{this.move(k,y.mousePos(this.element,k))},this.mouseup=k=>{this._rotatePitchHandler.dragEnd(k),this.offTemp()},this.touchstart=k=>{k.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=y.touchPos(this.element,k.targetTouches)[0],this.startMove(k,this._startPos),y.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),y.addEventListener(window,"touchend",this.touchend))},this.touchmove=k=>{k.targetTouches.length!==1?this.reset():(this._lastPos=y.touchPos(this.element,k.targetTouches)[0],this.move(k,this._lastPos))},this.touchend=k=>{k.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=p;const S=new le;this._rotatePitchHandler=new Xc({clickTolerance:3,move:(k,R)=>{const W=p.getBoundingClientRect(),Z=new a.P((W.bottom-W.top)/2,(W.right-W.left)/2);return{bearingDelta:a.cn(new a.P(k.x,R.y),R,Z),pitchDelta:b?-.5*(R.y-k.y):void 0}},moveStateManager:S,enable:!0,assignEvents:()=>{}}),this.map=l,y.addEventListener(p,"mousedown",this.mousedown),y.addEventListener(p,"touchstart",this.touchstart,{passive:!1}),y.addEventListener(p,"touchcancel",this.reset)}startMove(l,p){this._rotatePitchHandler.dragStart(l,p),y.disableDrag()}move(l,p){const b=this.map,{bearingDelta:S,pitchDelta:k}=this._rotatePitchHandler.dragMove(l,p)||{};S&&b.setBearing(b.getBearing()+S),k&&b.setPitch(b.getPitch()+k)}off(){const l=this.element;y.removeEventListener(l,"mousedown",this.mousedown),y.removeEventListener(l,"touchstart",this.touchstart,{passive:!1}),y.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),y.removeEventListener(window,"touchend",this.touchend),y.removeEventListener(l,"touchcancel",this.reset),this.offTemp()}offTemp(){y.enableDrag(),y.removeEventListener(window,"mousemove",this.mousemove),y.removeEventListener(window,"mouseup",this.mouseup),y.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),y.removeEventListener(window,"touchend",this.touchend)}}let si;function no(A,l,p,b=!1){if(b||!p.getCoveringTilesDetailsProvider().allowWorldCopies())return A==null?void 0:A.wrap();const S=new a.S(A.lng,A.lat);if(A=new a.S(A.lng,A.lat),l){const k=new a.S(A.lng-360,A.lat),R=new a.S(A.lng+360,A.lat),W=p.locationToScreenPoint(A).distSqr(l);p.locationToScreenPoint(k).distSqr(l)<W?A=k:p.locationToScreenPoint(R).distSqr(l)<W&&(A=R)}for(;Math.abs(A.lng-p.center.lng)>180;){const k=p.locationToScreenPoint(A);if(k.x>=0&&k.y>=0&&k.x<=p.width&&k.y<=p.height)break;A.lng>p.center.lng?A.lng-=360:A.lng+=360}return A.lng!==S.lng&&p.isPointOnMapSurface(p.locationToScreenPoint(A))?A:S}const Io={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ia(A,l,p){const b=A.classList;for(const S in Io)b.remove(`maplibregl-${p}-anchor-${S}`);b.add(`maplibregl-${p}-anchor-${l}`)}class us extends a.E{constructor(l){if(super(),this._onKeyPress=p=>{const b=p.code,S=p.charCode||p.keyCode;b!=="Space"&&b!=="Enter"&&S!==32&&S!==13||this.togglePopup()},this._onMapClick=p=>{const b=p.originalEvent.target,S=this._element;this._popup&&(b===S||S.contains(b))&&this.togglePopup()},this._update=p=>{if(!this._map)return;const b=this._map.loaded()&&!this._map.isMoving();((p==null?void 0:p.type)==="terrain"||(p==null?void 0:p.type)==="render"&&!b)&&this._map.once("render",this._update),this._lngLat=no(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let S="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?S=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(S=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let k="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?k="rotateX(0deg)":this._pitchAlignment==="map"&&(k=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||p&&p.type!=="moveend"||(this._pos=this._pos.round()),y.setTransform(this._element,`${Io[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${k} ${S}`),_.frameAsync(new AbortController).then(()=>{this._updateOpacity(p&&p.type==="moveend")}).catch(()=>{})},this._onMove=p=>{if(!this._isDragging){const b=this._clickTolerance||this._map._clickTolerance;this._isDragging=p.point.dist(this._pointerdownPos)>=b}this._isDragging&&(this._pos=p.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.l("dragstart"))),this.fire(new a.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.l("dragend")),this._state="inactive"},this._addDragHandler=p=>{this._element.contains(p.originalEvent.target)&&(p.preventDefault(),this._positionDelta=p.point.sub(this._pos).add(this._offset),this._pointerdownPos=p.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=l&&l.anchor||"center",this._color=l&&l.color||"#3FB1CE",this._scale=l&&l.scale||1,this._draggable=l&&l.draggable||!1,this._clickTolerance=l&&l.clickTolerance||0,this._subpixelPositioning=l&&l.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=l&&l.rotation||0,this._rotationAlignment=l&&l.rotationAlignment||"auto",this._pitchAlignment=l&&l.pitchAlignment&&l.pitchAlignment!=="auto"?l.pitchAlignment:this._rotationAlignment,this.setOpacity(l==null?void 0:l.opacity,l==null?void 0:l.opacityWhenCovered),l&&l.element)this._element=l.element,this._offset=a.P.convert(l&&l.offset||[0,0]);else{this._defaultMarker=!0,this._element=y.create("div");const p=y.createNS("http://www.w3.org/2000/svg","svg"),b=41,S=27;p.setAttributeNS(null,"display","block"),p.setAttributeNS(null,"height",`${b}px`),p.setAttributeNS(null,"width",`${S}px`),p.setAttributeNS(null,"viewBox",`0 0 ${S} ${b}`);const k=y.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"stroke","none"),k.setAttributeNS(null,"stroke-width","1"),k.setAttributeNS(null,"fill","none"),k.setAttributeNS(null,"fill-rule","evenodd");const R=y.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"fill-rule","nonzero");const W=y.createNS("http://www.w3.org/2000/svg","g");W.setAttributeNS(null,"transform","translate(3.0, 29.0)"),W.setAttributeNS(null,"fill","#000000");const Z=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ft of Z){const gt=y.createNS("http://www.w3.org/2000/svg","ellipse");gt.setAttributeNS(null,"opacity","0.04"),gt.setAttributeNS(null,"cx","10.5"),gt.setAttributeNS(null,"cy","5.80029008"),gt.setAttributeNS(null,"rx",ft.rx),gt.setAttributeNS(null,"ry",ft.ry),W.appendChild(gt)}const ie=y.createNS("http://www.w3.org/2000/svg","g");ie.setAttributeNS(null,"fill",this._color);const ce=y.createNS("http://www.w3.org/2000/svg","path");ce.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),ie.appendChild(ce);const xe=y.createNS("http://www.w3.org/2000/svg","g");xe.setAttributeNS(null,"opacity","0.25"),xe.setAttributeNS(null,"fill","#000000");const be=y.createNS("http://www.w3.org/2000/svg","path");be.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),xe.appendChild(be);const Ae=y.createNS("http://www.w3.org/2000/svg","g");Ae.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Ae.setAttributeNS(null,"fill","#FFFFFF");const Ue=y.createNS("http://www.w3.org/2000/svg","g");Ue.setAttributeNS(null,"transform","translate(8.0, 8.0)");const lt=y.createNS("http://www.w3.org/2000/svg","circle");lt.setAttributeNS(null,"fill","#000000"),lt.setAttributeNS(null,"opacity","0.25"),lt.setAttributeNS(null,"cx","5.5"),lt.setAttributeNS(null,"cy","5.5"),lt.setAttributeNS(null,"r","5.4999962");const it=y.createNS("http://www.w3.org/2000/svg","circle");it.setAttributeNS(null,"fill","#FFFFFF"),it.setAttributeNS(null,"cx","5.5"),it.setAttributeNS(null,"cy","5.5"),it.setAttributeNS(null,"r","5.4999962"),Ue.appendChild(lt),Ue.appendChild(it),R.appendChild(W),R.appendChild(ie),R.appendChild(xe),R.appendChild(Ae),R.appendChild(Ue),p.appendChild(R),p.setAttributeNS(null,"height",b*this._scale+"px"),p.setAttributeNS(null,"width",S*this._scale+"px"),this._element.appendChild(p),this._offset=a.P.convert(l&&l.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",p=>{p.preventDefault()}),this._element.addEventListener("mousedown",p=>{p.preventDefault()}),ia(this._element,this._anchor,"marker"),l&&l.className)for(const p of l.className.split(" "))this._element.classList.add(p);this._popup=null}addTo(l){return this.remove(),this._map=l,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",l._getUIString("Marker.Title")),l.getCanvasContainer().appendChild(this._element),l.on("move",this._update),l.on("moveend",this._update),l.on("terrain",this._update),l.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),y.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(l){return this._lngLat=a.S.convert(l),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(l){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),l){if(!("offset"in l.options)){const S=Math.abs(13.5)/Math.SQRT2;l.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[S,-1*(38.1-13.5+S)],"bottom-right":[-S,-1*(38.1-13.5+S)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=l,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(l){return this._subpixelPositioning=l,this}getPopup(){return this._popup}togglePopup(){const l=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:l?(l.isOpen()?l.remove():(l.setLngLat(this._lngLat),l.addTo(this._map)),this):this}_updateOpacity(l=!1){var p,b;const S=(p=this._map)===null||p===void 0?void 0:p.terrain,k=this._map.transform.isLocationOccluded(this._lngLat);if(!S||k){const Ae=k?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==Ae&&(this._element.style.opacity=Ae))}if(l)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const R=this._map,W=R.terrain.depthAtPoint(this._pos),Z=R.terrain.getElevationForLngLatZoom(this._lngLat,R.transform.tileZoom);if(R.transform.lngLatToCameraDepth(this._lngLat,Z)-W<.006)return void(this._element.style.opacity=this._opacity);const ie=-this._offset.y/R.transform.pixelsPerMeter,ce=Math.sin(R.getPitch()*Math.PI/180)*ie,xe=R.terrain.depthAtPoint(new a.P(this._pos.x,this._pos.y-this._offset.y)),be=R.transform.lngLatToCameraDepth(this._lngLat,Z+ce)-xe>.006;!((b=this._popup)===null||b===void 0)&&b.isOpen()&&be&&this._popup.remove(),this._element.style.opacity=be?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(l){return this._offset=a.P.convert(l),this._update(),this}addClassName(l){this._element.classList.add(l)}removeClassName(l){this._element.classList.remove(l)}toggleClassName(l){return this._element.classList.toggle(l)}setDraggable(l){return this._draggable=!!l,this._map&&(l?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(l){return this._rotation=l||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(l){return this._rotationAlignment=l||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(l){return this._pitchAlignment=l&&l!=="auto"?l:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(l,p){return(this._opacity===void 0||l===void 0&&p===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),l!==void 0&&(this._opacity=l),p!==void 0&&(this._opacityWhenCovered=p),this._map&&this._updateOpacity(!0),this}}const Es={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Ka=0,Za=!1;const ds={maxWidth:100,unit:"metric"};function Us(A,l,p){const b=p&&p.maxWidth||100,S=A._container.clientHeight/2,k=A._container.clientWidth/2,R=A.unproject([k-b/2,S]),W=A.unproject([k+b/2,S]),Z=Math.round(A.project(W).x-A.project(R).x),ie=Math.min(b,Z,A._container.clientWidth),ce=R.distanceTo(W);if(p&&p.unit==="imperial"){const xe=3.2808*ce;xe>5280?mo(l,ie,xe/5280,A._getUIString("ScaleControl.Miles")):mo(l,ie,xe,A._getUIString("ScaleControl.Feet"))}else p&&p.unit==="nautical"?mo(l,ie,ce/1852,A._getUIString("ScaleControl.NauticalMiles")):ce>=1e3?mo(l,ie,ce/1e3,A._getUIString("ScaleControl.Kilometers")):mo(l,ie,ce,A._getUIString("ScaleControl.Meters"))}function mo(A,l,p,b){const S=function(k){const R=Math.pow(10,`${Math.floor(k)}`.length-1);let W=k/R;return W=W>=10?10:W>=5?5:W>=3?3:W>=2?2:W>=1?1:function(Z){const ie=Math.pow(10,Math.ceil(-Math.log(Z)/Math.LN10));return Math.round(Z*ie)/ie}(W),R*W}(p);A.style.width=l*(S/p)+"px",A.innerHTML=`${S}&nbsp;${b}`}const Qs={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},jl=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ec(A){if(A){if(typeof A=="number"){const l=Math.round(Math.abs(A)/Math.SQRT2);return{center:new a.P(0,0),top:new a.P(0,A),"top-left":new a.P(l,l),"top-right":new a.P(-l,l),bottom:new a.P(0,-A),"bottom-left":new a.P(l,-l),"bottom-right":new a.P(-l,-l),left:new a.P(A,0),right:new a.P(-A,0)}}if(A instanceof a.P||Array.isArray(A)){const l=a.P.convert(A);return{center:l,top:l,"top-left":l,"top-right":l,bottom:l,"bottom-left":l,"bottom-right":l,left:l,right:l}}return{center:a.P.convert(A.center||[0,0]),top:a.P.convert(A.top||[0,0]),"top-left":a.P.convert(A["top-left"]||[0,0]),"top-right":a.P.convert(A["top-right"]||[0,0]),bottom:a.P.convert(A.bottom||[0,0]),"bottom-left":a.P.convert(A["bottom-left"]||[0,0]),"bottom-right":a.P.convert(A["bottom-right"]||[0,0]),left:a.P.convert(A.left||[0,0]),right:a.P.convert(A.right||[0,0])}}return Ec(new a.P(0,0))}const Ac=u;s.AJAXError=a.cz,s.Event=a.l,s.Evented=a.E,s.LngLat=a.S,s.MercatorCoordinate=a.a1,s.Point=a.P,s.addProtocol=a.cA,s.config=a.a,s.removeProtocol=a.cB,s.AttributionControl=eo,s.BoxZoomHandler=sp,s.CanvasSource=Kt,s.CooperativeGesturesHandler=Gi,s.DoubleClickZoomHandler=Zr,s.DragPanHandler=Cn,s.DragRotateHandler=Si,s.EdgeInsets=Ln,s.FullscreenControl=class extends a.E{constructor(A={}){super(),this._onFullscreenChange=()=>{var l;let p=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((l=p==null?void 0:p.shadowRoot)===null||l===void 0)&&l.fullscreenElement;)p=p.shadowRoot.fullscreenElement;p===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,A&&A.container&&(A.container instanceof HTMLElement?this._container=A.container:a.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(A){return this._map=A,this._container||(this._container=this._map.getContainer()),this._controlContainer=y.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){y.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const A=this._fullscreenButton=y.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);y.create("span","maplibregl-ctrl-icon",A).setAttribute("aria-hidden","true"),A.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const A=this._getTitle();this._fullscreenButton.setAttribute("aria-label",A),this._fullscreenButton.title=A}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new a.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new a.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},s.GeoJSONSource=kt,s.GeolocateControl=class extends a.E{constructor(A){super(),this._onSuccess=l=>{if(this._map){if(this._isOutOfMapMaxBounds(l))return this._setErrorState(),this.fire(new a.l("outofmaxbounds",l)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=l,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(l),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(l),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new a.l("geolocate",l)),this._finish()}},this._updateCamera=l=>{const p=new a.S(l.coords.longitude,l.coords.latitude),b=l.coords.accuracy,S=this._map.getBearing(),k=a.e({bearing:S},this.options.fitBoundsOptions),R=ke.fromLngLat(p,b);this._map.fitBounds(R,k,{geolocateSource:!0})},this._updateMarker=l=>{if(l){const p=new a.S(l.coords.longitude,l.coords.latitude);this._accuracyCircleMarker.setLngLat(p).addTo(this._map),this._userLocationDotMarker.setLngLat(p).addTo(this._map),this._accuracy=l.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=l=>{if(this._map){if(l.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const p=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=p,this._geolocateButton.setAttribute("aria-label",p),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(l.code===3&&Za)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new a.l("error",l)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",l=>l.preventDefault()),this._geolocateButton=y.create("button","maplibregl-ctrl-geolocate",this._container),y.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=l=>{if(this._map){if(l===!1){a.w("Geolocation support is not available so the GeolocateControl will be disabled.");const p=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=p,this._geolocateButton.setAttribute("aria-label",p)}else{const p=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=p,this._geolocateButton.setAttribute("aria-label",p)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=y.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new us({element:this._dotElement}),this._circleElement=y.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new us({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",p=>{const b=(p==null?void 0:p[0])instanceof ResizeObserverEntry;p.geolocateSource||this._watchState!=="ACTIVE_LOCK"||b||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new a.l("trackuserlocationend")),this.fire(new a.l("userlocationlostfocus")))})}},this.options=a.e({},Es,A)}onAdd(A){return this._map=A,this._container=y.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return a._(this,arguments,void 0,function*(l=!1){if(si!==void 0&&!l)return si;if(window.navigator.permissions===void 0)return si=!!window.navigator.geolocation,si;try{si=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{si=!!window.navigator.geolocation}return si})}().then(l=>this._finishSetupUI(l)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),y.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ka=0,Za=!1}_isOutOfMapMaxBounds(A){const l=this._map.getMaxBounds(),p=A.coords;return l&&(p.longitude<l.getWest()||p.longitude>l.getEast()||p.latitude<l.getSouth()||p.latitude>l.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const A=this._map.getBounds(),l=A.getSouthEast(),p=A.getNorthEast(),b=l.distanceTo(p),S=Math.ceil(this._accuracy/(b/this._map._container.clientHeight)*2);this._circleElement.style.width=`${S}px`,this._circleElement.style.height=`${S}px`}trigger(){if(!this._setup)return a.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ka--,Za=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new a.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.l("trackuserlocationstart")),this.fire(new a.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let A;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Ka++,Ka>1?(A={maximumAge:6e5,timeout:0},Za=!0):(A=this.options.positionOptions,Za=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,A)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},s.GlobeControl=class{constructor(){this._toggleProjection=()=>{var A;const l=(A=this._map.getProjection())===null||A===void 0?void 0:A.type;this._map.setProjection(l!=="mercator"&&l?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var A;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((A=this._map.getProjection())===null||A===void 0?void 0:A.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(A){return this._map=A,this._container=y.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=y.create("button","maplibregl-ctrl-globe",this._container),y.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){y.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},s.Hash=Yh,s.ImageSource=mt,s.KeyboardHandler=tr,s.LngLatBounds=ke,s.LogoControl=Zo,s.Map=class extends xa{constructor(A){var l,p;a.cw.mark(a.cx.create);const b=Object.assign(Object.assign(Object.assign({},Li),A),{canvasContextAttributes:Object.assign(Object.assign({},Li.canvasContextAttributes),A.canvasContextAttributes)});if(b.minZoom!=null&&b.maxZoom!=null&&b.minZoom>b.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(b.minPitch!=null&&b.maxPitch!=null&&b.minPitch>b.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(b.minPitch!=null&&b.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(b.maxPitch!=null&&b.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const S=new ri,k=new Mi;if(b.minZoom!==void 0&&S.setMinZoom(b.minZoom),b.maxZoom!==void 0&&S.setMaxZoom(b.maxZoom),b.minPitch!==void 0&&S.setMinPitch(b.minPitch),b.maxPitch!==void 0&&S.setMaxPitch(b.maxPitch),b.renderWorldCopies!==void 0&&S.setRenderWorldCopies(b.renderWorldCopies),super(S,k,{bearingSnap:b.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Wo,this._controls=[],this._mapId=a.a7(),this._contextLost=W=>{W.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new a.l("webglcontextlost",{originalEvent:W}))},this._contextRestored=W=>{this._setupPainter(),this.resize(),this._update(),this.fire(new a.l("webglcontextrestored",{originalEvent:W}))},this._onMapScroll=W=>{if(W.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=b.interactive,this._maxTileCacheSize=b.maxTileCacheSize,this._maxTileCacheZoomLevels=b.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},b.canvasContextAttributes),this._trackResize=b.trackResize===!0,this._bearingSnap=b.bearingSnap,this._centerClampedToGround=b.centerClampedToGround,this._refreshExpiredTiles=b.refreshExpiredTiles===!0,this._fadeDuration=b.fadeDuration,this._crossSourceCollisions=b.crossSourceCollisions===!0,this._collectResourceTiming=b.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},wi),b.locale),this._clickTolerance=b.clickTolerance,this._overridePixelRatio=b.pixelRatio,this._maxCanvasSize=b.maxCanvasSize,this.transformCameraUpdate=b.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=b.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=D.addThrottleControl(()=>this.isMoving()),this._requestManager=new L(b.transformRequest),typeof b.container=="string"){if(this._container=document.getElementById(b.container),!this._container)throw new Error(`Container '${b.container}' not found.`)}else{if(!(b.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=b.container}if(b.maxBounds&&this.setMaxBounds(b.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let W=!1;const Z=ls(ie=>{this._trackResize&&!this._removed&&(this.resize(ie),this.redraw())},50);this._resizeObserver=new ResizeObserver(ie=>{W?Z(ie):W=!0}),this._resizeObserver.observe(this._container)}this.handlers=new mn(this,b),this._hash=b.hash&&new Yh(typeof b.hash=="string"&&b.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:b.center,elevation:b.elevation,zoom:b.zoom,bearing:b.bearing,pitch:b.pitch,roll:b.roll}),b.bounds&&(this.resize(),this.fitBounds(b.bounds,a.e({},b.fitBoundsOptions,{duration:0}))));const R=typeof b.style=="string"||((p=(l=b.style)===null||l===void 0?void 0:l.projection)===null||p===void 0?void 0:p.type)!=="globe";this.resize(null,R),this._localIdeographFontFamily=b.localIdeographFontFamily,this._validateStyle=b.validateStyle,b.style&&this.setStyle(b.style,{localIdeographFontFamily:b.localIdeographFontFamily}),b.attributionControl&&this.addControl(new eo(typeof b.attributionControl=="boolean"?void 0:b.attributionControl)),b.maplibreLogo&&this.addControl(new Zo,b.logoPosition),this.on("style.load",()=>{if(R||this._resizeTransform(),this.transform.unmodified){const W=a.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(W)}}),this.on("data",W=>{this._update(W.dataType==="style"),this.fire(new a.l(`${W.dataType}data`,W))}),this.on("dataloading",W=>{this.fire(new a.l(`${W.dataType}dataloading`,W))}),this.on("dataabort",W=>{this.fire(new a.l("sourcedataabort",W))})}_getMapId(){return this._mapId}setGlobalStateProperty(A,l){return this.style.setGlobalStateProperty(A,l),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(A,l){if(l===void 0&&(l=A.getDefaultPosition?A.getDefaultPosition():"top-right"),!A||!A.onAdd)return this.fire(new a.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const p=A.onAdd(this);this._controls.push(A);const b=this._controlPositions[l];return l.indexOf("bottom")!==-1?b.insertBefore(p,b.firstChild):b.appendChild(p),this}removeControl(A){if(!A||!A.onRemove)return this.fire(new a.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const l=this._controls.indexOf(A);return l>-1&&this._controls.splice(l,1),A.onRemove(this),this}hasControl(A){return this._controls.indexOf(A)>-1}coveringTiles(A){return $t(this.transform,A)}calculateCameraOptionsFromTo(A,l,p,b){return b==null&&this.terrain&&(b=this.terrain.getElevationForLngLatZoom(p,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(A,l,p,b)}resize(A,l=!0){const[p,b]=this._containerDimensions(),S=this._getClampedPixelRatio(p,b);if(this._resizeCanvas(p,b,S),this.painter.resize(p,b,S),this.painter.overLimit()){const R=this.painter.context.gl;this._maxCanvasSize=[R.drawingBufferWidth,R.drawingBufferHeight];const W=this._getClampedPixelRatio(p,b);this._resizeCanvas(p,b,W),this.painter.resize(p,b,W)}this._resizeTransform(l);const k=!this._moving;return k&&(this.stop(),this.fire(new a.l("movestart",A)).fire(new a.l("move",A))),this.fire(new a.l("resize",A)),k&&this.fire(new a.l("moveend",A)),this}_resizeTransform(A=!0){var l;const[p,b]=this._containerDimensions();this.transform.resize(p,b,A),(l=this._requestedCameraState)===null||l===void 0||l.resize(p,b,A)}_getClampedPixelRatio(A,l){const{0:p,1:b}=this._maxCanvasSize,S=this.getPixelRatio(),k=A*S,R=l*S;return Math.min(k>p?p/k:1,R>b?b/R:1)*S}getPixelRatio(){var A;return(A=this._overridePixelRatio)!==null&&A!==void 0?A:devicePixelRatio}setPixelRatio(A){this._overridePixelRatio=A,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(A){return this.transform.setMaxBounds(ke.convert(A)),this._update()}setMinZoom(A){if((A=A??-2)>=-2&&A<=this.transform.maxZoom)return this.transform.setMinZoom(A),this._update(),this.getZoom()<A&&this.setZoom(A),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(A){if((A=A??22)>=this.transform.minZoom)return this.transform.setMaxZoom(A),this._update(),this.getZoom()>A&&this.setZoom(A),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(A){if((A=A??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(A>=0&&A<=this.transform.maxPitch)return this.transform.setMinPitch(A),this._update(),this.getPitch()<A&&this.setPitch(A),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(A){if((A=A??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(A>=this.transform.minPitch)return this.transform.setMaxPitch(A),this._update(),this.getPitch()>A&&this.setPitch(A),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(A){return this.transform.setRenderWorldCopies(A),this._update()}project(A){return this.transform.locationToScreenPoint(a.S.convert(A),this.style&&this.terrain)}unproject(A){return this.transform.screenPointToLocation(a.P.convert(A),this.terrain)}isMoving(){var A;return this._moving||((A=this.handlers)===null||A===void 0?void 0:A.isMoving())}isZooming(){var A;return this._zooming||((A=this.handlers)===null||A===void 0?void 0:A.isZooming())}isRotating(){var A;return this._rotating||((A=this.handlers)===null||A===void 0?void 0:A.isRotating())}_createDelegatedListener(A,l,p){if(A==="mouseenter"||A==="mouseover"){let b=!1;return{layers:l,listener:p,delegates:{mousemove:k=>{const R=l.filter(Z=>this.getLayer(Z)),W=R.length!==0?this.queryRenderedFeatures(k.point,{layers:R}):[];W.length?b||(b=!0,p.call(this,new zs(A,this,k.originalEvent,{features:W}))):b=!1},mouseout:()=>{b=!1}}}}if(A==="mouseleave"||A==="mouseout"){let b=!1;return{layers:l,listener:p,delegates:{mousemove:R=>{const W=l.filter(Z=>this.getLayer(Z));(W.length!==0?this.queryRenderedFeatures(R.point,{layers:W}):[]).length?b=!0:b&&(b=!1,p.call(this,new zs(A,this,R.originalEvent)))},mouseout:R=>{b&&(b=!1,p.call(this,new zs(A,this,R.originalEvent)))}}}}{const b=S=>{const k=l.filter(W=>this.getLayer(W)),R=k.length!==0?this.queryRenderedFeatures(S.point,{layers:k}):[];R.length&&(S.features=R,p.call(this,S),delete S.features)};return{layers:l,listener:p,delegates:{[A]:b}}}}_saveDelegatedListener(A,l){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[A]=this._delegatedListeners[A]||[],this._delegatedListeners[A].push(l)}_removeDelegatedListener(A,l,p){if(!this._delegatedListeners||!this._delegatedListeners[A])return;const b=this._delegatedListeners[A];for(let S=0;S<b.length;S++){const k=b[S];if(k.listener===p&&k.layers.length===l.length&&k.layers.every(R=>l.includes(R))){for(const R in k.delegates)this.off(R,k.delegates[R]);return void b.splice(S,1)}}}on(A,l,p){if(p===void 0)return super.on(A,l);const b=typeof l=="string"?[l]:l,S=this._createDelegatedListener(A,b,p);this._saveDelegatedListener(A,S);for(const k in S.delegates)this.on(k,S.delegates[k]);return{unsubscribe:()=>{this._removeDelegatedListener(A,b,p)}}}once(A,l,p){if(p===void 0)return super.once(A,l);const b=typeof l=="string"?[l]:l,S=this._createDelegatedListener(A,b,p);for(const k in S.delegates){const R=S.delegates[k];S.delegates[k]=(...W)=>{this._removeDelegatedListener(A,b,p),R(...W)}}this._saveDelegatedListener(A,S);for(const k in S.delegates)this.once(k,S.delegates[k]);return this}off(A,l,p){return p===void 0?super.off(A,l):(this._removeDelegatedListener(A,typeof l=="string"?[l]:l,p),this)}queryRenderedFeatures(A,l){if(!this.style)return[];let p;const b=A instanceof a.P||Array.isArray(A),S=b?A:[[0,0],[this.transform.width,this.transform.height]];if(l=l||(b?{}:A)||{},S instanceof a.P||typeof S[0]=="number")p=[a.P.convert(S)];else{const k=a.P.convert(S[0]),R=a.P.convert(S[1]);p=[k,new a.P(R.x,k.y),R,new a.P(k.x,R.y),k]}return this.style.queryRenderedFeatures(p,l,this.transform)}querySourceFeatures(A,l){return this.style.querySourceFeatures(A,l)}setStyle(A,l){return(l=a.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},l)).diff!==!1&&l.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&A?(this._diffStyle(A,l),this):(this._localIdeographFontFamily=l.localIdeographFontFamily,this._updateStyle(A,l))}setTransformRequest(A){return this._requestManager.setTransformRequest(A),this}_getUIString(A){const l=this._locale[A];if(l==null)throw new Error(`Missing UI string '${A}'`);return l}_updateStyle(A,l){var p,b;if(l.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(A,l));const S=this.style&&l.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!A)),A?(this.style=new pl(this,l||{}),this.style.setEventedParent(this,{style:this.style}),typeof A=="string"?this.style.loadURL(A,l,S):this.style.loadJSON(A,l,S),this):((b=(p=this.style)===null||p===void 0?void 0:p.projection)===null||b===void 0||b.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new pl(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(A,l){if(typeof A=="string"){const p=this._requestManager.transformRequest(A,"Style");a.j(p,new AbortController).then(b=>{this._updateDiff(b.data,l)}).catch(b=>{b&&this.fire(new a.k(b))})}else typeof A=="object"&&this._updateDiff(A,l)}_updateDiff(A,l){try{this.style.setState(A,l)&&this._update(!0)}catch(p){a.w(`Unable to perform style diff: ${p.message||p.error||p}.  Rebuilding the style from scratch.`),this._updateStyle(A,l)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():a.w("There is no style added to the map.")}addSource(A,l){return this._lazyInitEmptyStyle(),this.style.addSource(A,l),this._update(!0)}isSourceLoaded(A){const l=this.style&&this.style.sourceCaches[A];if(l!==void 0)return l.loaded();this.fire(new a.k(new Error(`There is no source with ID '${A}'`)))}setTerrain(A){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),A){const l=this.style.sourceCaches[A.source];if(!l)throw new Error(`cannot load terrain, because there exists no source with ID: ${A.source}`);this.terrain===null&&l.reload();for(const p in this.style._layers){const b=this.style._layers[p];b.type==="hillshade"&&b.source===A.source&&a.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),b.type==="color-relief"&&b.source===A.source&&a.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new xn(this.painter,l,A),this.painter.renderToTexture=new Fi(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=p=>{var b;p.dataType==="style"?this.terrain.sourceCache.freeRtt():p.dataType==="source"&&p.tile&&(p.sourceId!==A.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((b=p.source)===null||b===void 0?void 0:b.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(p.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new a.l("terrain",{terrain:A})),this}getTerrain(){var A,l;return(l=(A=this.terrain)===null||A===void 0?void 0:A.options)!==null&&l!==void 0?l:null}areTilesLoaded(){const A=this.style&&this.style.sourceCaches;for(const l in A){const p=A[l]._tiles;for(const b in p){const S=p[b];if(S.state!=="loaded"&&S.state!=="errored")return!1}}return!0}removeSource(A){return this.style.removeSource(A),this._update(!0)}getSource(A){return this.style.getSource(A)}setSourceTileLodParams(A,l,p){if(p){const b=this.getSource(p);if(!b)throw new Error(`There is no source with ID "${p}", cannot set LOD parameters`);b.calculateTileZoom=er(Math.max(1,A),Math.max(1,l))}else for(const b in this.style.sourceCaches)this.style.sourceCaches[b].getSource().calculateTileZoom=er(Math.max(1,A),Math.max(1,l));return this._update(!0),this}refreshTiles(A,l){const p=this.style.sourceCaches[A];if(!p)throw new Error(`There is no source cache with ID "${A}", cannot refresh tile`);l===void 0?p.reload(!0):p.refreshTiles(l.map(b=>new a.a4(b.z,b.x,b.y)))}addImage(A,l,p={}){const{pixelRatio:b=1,sdf:S=!1,stretchX:k,stretchY:R,content:W,textFitWidth:Z,textFitHeight:ie}=p;if(this._lazyInitEmptyStyle(),!(l instanceof HTMLImageElement||a.b(l))){if(l.width===void 0||l.height===void 0)return this.fire(new a.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:ce,height:xe,data:be}=l,Ae=l;return this.style.addImage(A,{data:new a.R({width:ce,height:xe},new Uint8Array(be)),pixelRatio:b,stretchX:k,stretchY:R,content:W,textFitWidth:Z,textFitHeight:ie,sdf:S,version:0,userImage:Ae}),Ae.onAdd&&Ae.onAdd(this,A),this}}{const{width:ce,height:xe,data:be}=_.getImageData(l);this.style.addImage(A,{data:new a.R({width:ce,height:xe},be),pixelRatio:b,stretchX:k,stretchY:R,content:W,textFitWidth:Z,textFitHeight:ie,sdf:S,version:0})}}updateImage(A,l){const p=this.style.getImage(A);if(!p)return this.fire(new a.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const b=l instanceof HTMLImageElement||a.b(l)?_.getImageData(l):l,{width:S,height:k,data:R}=b;if(S===void 0||k===void 0)return this.fire(new a.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(S!==p.data.width||k!==p.data.height)return this.fire(new a.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const W=!(l instanceof HTMLImageElement||a.b(l));return p.data.replace(R,W),this.style.updateImage(A,p),this}getImage(A){return this.style.getImage(A)}hasImage(A){return A?!!this.style.getImage(A):(this.fire(new a.k(new Error("Missing required image id"))),!1)}removeImage(A){this.style.removeImage(A)}loadImage(A){return D.getImage(this._requestManager.transformRequest(A,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(A,l){return this._lazyInitEmptyStyle(),this.style.addLayer(A,l),this._update(!0)}moveLayer(A,l){return this.style.moveLayer(A,l),this._update(!0)}removeLayer(A){return this.style.removeLayer(A),this._update(!0)}getLayer(A){return this.style.getLayer(A)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(A,l,p){return this.style.setLayerZoomRange(A,l,p),this._update(!0)}setFilter(A,l,p={}){return this.style.setFilter(A,l,p),this._update(!0)}getFilter(A){return this.style.getFilter(A)}setPaintProperty(A,l,p,b={}){return this.style.setPaintProperty(A,l,p,b),this._update(!0)}getPaintProperty(A,l){return this.style.getPaintProperty(A,l)}setLayoutProperty(A,l,p,b={}){return this.style.setLayoutProperty(A,l,p,b),this._update(!0)}getLayoutProperty(A,l){return this.style.getLayoutProperty(A,l)}setGlyphs(A,l={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(A,l),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(A,l,p={}){return this._lazyInitEmptyStyle(),this.style.addSprite(A,l,p,b=>{b||this._update(!0)}),this}removeSprite(A){return this._lazyInitEmptyStyle(),this.style.removeSprite(A),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(A,l={}){return this._lazyInitEmptyStyle(),this.style.setSprite(A,l,p=>{p||this._update(!0)}),this}setLight(A,l={}){return this._lazyInitEmptyStyle(),this.style.setLight(A,l),this._update(!0)}getLight(){return this.style.getLight()}setSky(A,l={}){return this._lazyInitEmptyStyle(),this.style.setSky(A,l),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(A,l){return this.style.setFeatureState(A,l),this._update()}removeFeatureState(A,l){return this.style.removeFeatureState(A,l),this._update()}getFeatureState(A){return this.style.getFeatureState(A)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let A=0,l=0;return this._container&&(A=this._container.clientWidth||400,l=this._container.clientHeight||300),[A,l]}_setupContainer(){const A=this._container;A.classList.add("maplibregl-map");const l=this._canvasContainer=y.create("div","maplibregl-canvas-container",A);this._interactive&&l.classList.add("maplibregl-interactive"),this._canvas=y.create("canvas","maplibregl-canvas",l),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const p=this._containerDimensions(),b=this._getClampedPixelRatio(p[0],p[1]);this._resizeCanvas(p[0],p[1],b);const S=this._controlContainer=y.create("div","maplibregl-control-container",A),k=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(R=>{k[R]=y.create("div",`maplibregl-ctrl-${R} `,S)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(A,l,p){this._canvas.width=Math.floor(p*A),this._canvas.height=Math.floor(p*l),this._canvas.style.width=`${A}px`,this._canvas.style.height=`${l}px`}_setupPainter(){const A=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let l=null;this._canvas.addEventListener("webglcontextcreationerror",b=>{l={requestedAttributes:A},b&&(l.statusMessage=b.statusMessage,l.type=b.type)},{once:!0});let p=null;if(p=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,A):this._canvas.getContext("webgl2",A)||this._canvas.getContext("webgl",A),!p){const b="Failed to initialize WebGL";throw l?(l.message=b,new Error(JSON.stringify(l))):new Error(b)}this.painter=new Zc(p,this.transform),M.testSupport(p)}migrateProjection(A,l){super.migrateProjection(A,l),this.painter.transform=A,this.fire(new a.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(A){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||A,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(A){return this._update(),this._renderTaskQueue.add(A)}_cancelRenderFrame(A){this._renderTaskQueue.remove(A)}_render(A){var l,p,b,S,k;const R=this._idleTriggered?this._fadeDuration:0,W=((l=this.style.projection)===null||l===void 0?void 0:l.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(A),this._removed)return;let Z=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const xe=this.transform.zoom,be=_.now();this.style.zoomHistory.update(xe,be);const Ae=new a.F(xe,{now:be,fadeDuration:R,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition(),globalState:this.style.getGlobalState()}),Ue=Ae.crossFadingFactor();Ue===1&&Ue===this._crossFadingFactor||(Z=!0,this._crossFadingFactor=Ue),this.style.update(Ae)}const ie=((p=this.style.projection)===null||p===void 0?void 0:p.transitionState)>0!==W;(b=this.style.projection)===null||b===void 0||b.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((S=this.style.projection)===null||S===void 0?void 0:S.transitionState,(k=this.style.projection)===null||k===void 0?void 0:k.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||ie)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,R,this._crossSourceCollisions,ie),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:R,showPadding:this.showPadding}),this.fire(new a.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,a.cw.mark(a.cx.load),this.fire(new a.l("load"))),this.style&&(this.style.hasTransitions()||Z)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const ce=this._sourcesDirty||this._styleDirty||this._placementDirty;return ce||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.l("idle")),!this._loaded||this._fullyLoaded||ce||(this._fullyLoaded=!0,a.cw.mark(a.cx.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var A;this._hash&&this._hash.remove();for(const p of this._controls)p.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),D.removeThrottleControl(this._imageQueueHandle),(A=this._resizeObserver)===null||A===void 0||A.disconnect();const l=this.painter.context.gl.getExtension("WEBGL_lose_context");l!=null&&l.loseContext&&l.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),y.remove(this._canvasContainer),y.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),a.cw.clearMetrics(),this._removed=!0,this.fire(new a.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,_.frame(this._frameRequest,A=>{a.cw.frame(A),this._frameRequest=null;try{this._render(A)}catch(l){if(!a.cy(l)&&!function(p){return p.message===Fs}(l))throw l}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(A){this._showTileBoundaries!==A&&(this._showTileBoundaries=A,this._update())}get showPadding(){return!!this._showPadding}set showPadding(A){this._showPadding!==A&&(this._showPadding=A,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(A){this._showCollisionBoxes!==A&&(this._showCollisionBoxes=A,A?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(A){this._showOverdrawInspector!==A&&(this._showOverdrawInspector=A,this._update())}get repaint(){return!!this._repaint}set repaint(A){this._repaint!==A&&(this._repaint=A,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(A){this._vertices=A,this._update()}get version(){return _a}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(A){return this._lazyInitEmptyStyle(),this.style.setProjection(A),this._update(!0)}},s.MapMouseEvent=zs,s.MapTouchEvent=td,s.MapWheelEvent=ef,s.Marker=us,s.NavigationControl=class{constructor(A){this._updateZoomButtons=()=>{const l=this._map.getZoom(),p=l===this._map.getMaxZoom(),b=l===this._map.getMinZoom();this._zoomInButton.disabled=p,this._zoomOutButton.disabled=b,this._zoomInButton.setAttribute("aria-disabled",p.toString()),this._zoomOutButton.setAttribute("aria-disabled",b.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(l,p)=>{const b=this._map._getUIString(`NavigationControl.${p}`);l.title=b,l.setAttribute("aria-label",b)},this.options=a.e({},Ps,A),this._container=y.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",l=>l.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",l=>this._map.zoomIn({},{originalEvent:l})),y.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",l=>this._map.zoomOut({},{originalEvent:l})),y.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",l=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:l}):this._map.resetNorth({},{originalEvent:l})}),this._compassIcon=y.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(A){return this._map=A,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Bs(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){y.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(A,l){const p=y.create("button",A,this._container);return p.type="button",p.addEventListener("click",l),p}},s.Popup=class extends a.E{constructor(A){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&y.remove(this._content),this._container&&(y.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new a.l("close"))),this),this._onMouseUp=l=>{this._update(l.point)},this._onMouseMove=l=>{this._update(l.point)},this._onDrag=l=>{this._update(l.point)},this._update=l=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=y.create("div","maplibregl-popup",this._map.getContainer()),this._tip=y.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const R of this.options.className.split(" "))this._container.classList.add(R);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=no(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!l)return;const p=this._flatPos=this._pos=this._trackPointer&&l?l:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&l?l:this._map.transform.locationToScreenPoint(this._lngLat));let b=this.options.anchor;const S=Ec(this.options.offset);if(!b){const R=this._container.offsetWidth,W=this._container.offsetHeight;let Z;Z=p.y+S.bottom.y<W?["top"]:p.y>this._map.transform.height-W?["bottom"]:[],p.x<R/2?Z.push("left"):p.x>this._map.transform.width-R/2&&Z.push("right"),b=Z.length===0?"bottom":Z.join("-")}let k=p.add(S[b]);this.options.subpixelPositioning||(k=k.round()),y.setTransform(this._container,`${Io[b]} translate(${k.x}px,${k.y}px)`),ia(this._container,b,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=a.e(Object.create(Qs),A)}addTo(A){return this._map&&this.remove(),this._map=A,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new a.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(A){return this._lngLat=a.S.convert(A),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(A){return this.setDOMContent(document.createTextNode(A))}setHTML(A){const l=document.createDocumentFragment(),p=document.createElement("body");let b;for(p.innerHTML=A;b=p.firstChild,b;)l.appendChild(b);return this.setDOMContent(l)}getMaxWidth(){var A;return(A=this._container)===null||A===void 0?void 0:A.style.maxWidth}setMaxWidth(A){return this.options.maxWidth=A,this._update(),this}setDOMContent(A){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=y.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(A),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(A){return this._container&&this._container.classList.add(A),this}removeClassName(A){return this._container&&this._container.classList.remove(A),this}setOffset(A){return this.options.offset=A,this._update(),this}toggleClassName(A){if(this._container)return this._container.classList.toggle(A)}setSubpixelPositioning(A){this.options.subpixelPositioning=A}_createCloseButton(){this.options.closeButton&&(this._closeButton=y.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const A=this._container.querySelector(jl);A&&A.focus()}},s.RasterDEMTileSource=Lt,s.RasterTileSource=Ot,s.ScaleControl=class{constructor(A){this._onMove=()=>{Us(this._map,this._container,this.options)},this.setUnit=l=>{this.options.unit=l,Us(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},ds),A)}getDefaultPosition(){return"bottom-left"}onAdd(A){return this._map=A,this._container=y.create("div","maplibregl-ctrl maplibregl-ctrl-scale",A.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){y.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},s.ScrollZoomHandler=Lr,s.Style=pl,s.TerrainControl=class{constructor(A){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=A}onAdd(A){return this._map=A,this._container=y.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=y.create("button","maplibregl-ctrl-terrain",this._container),y.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){y.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},s.TwoFingersTouchPitchHandler=vt,s.TwoFingersTouchRotateHandler=Gt,s.TwoFingersTouchZoomHandler=ht,s.TwoFingersTouchZoomRotateHandler=jn,s.VectorTileSource=Ne,s.VideoSource=Zt,s.addSourceType=(A,l)=>a._(void 0,void 0,void 0,function*(){if(Bt(A))throw new Error(`A source type called "${A}" already exists.`);((p,b)=>{dr[p]=b})(A,l)}),s.clearPrewarmedResources=function(){const A=te;A&&(A.isPreloaded()&&A.numActive()===1?(A.release(De),te=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},s.createTileMesh=ga,s.getMaxParallelImageRequests=function(){return a.a.MAX_PARALLEL_IMAGE_REQUESTS},s.getRTLTextPluginStatus=function(){return xr().getRTLTextPluginStatus()},s.getVersion=function(){return Ac},s.getWorkerCount=function(){return pe.workerCount},s.getWorkerUrl=function(){return a.a.WORKER_URL},s.importScriptInWorkers=function(A){return Ge().broadcast("IS",A)},s.prewarm=function(){$e().acquire(De)},s.setMaxParallelImageRequests=function(A){a.a.MAX_PARALLEL_IMAGE_REQUESTS=A},s.setRTLTextPlugin=function(A,l){return xr().setRTLTextPlugin(A,l)},s.setWorkerCount=function(A){pe.workerCount=A},s.setWorkerUrl=function(A){a.a.WORKER_URL=A}});var o=r;return o})})(xue);var CZe=xue.exports;const YP=sa(CZe);function AH(e,[t,r]){return Math.min(r,Math.max(t,e))}function Mue(e){const t=oe.useRef({value:e,previous:e});return oe.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var kZe=[" ","Enter","ArrowUp","ArrowDown"],IZe=[" ","Enter"],w0="Select",[Ek,Ak,OZe]=p5(w0),[tx,Fet]=Bh(w0,[OZe,$b]),Ck=$b(),[LZe,B_]=tx(w0),[DZe,$Ze]=tx(w0),Sue=e=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:i,onOpenChange:o,value:s,defaultValue:a,onValueChange:u,dir:d,name:m,autoComplete:g,disabled:_,required:y,form:M}=e,x=Ck(t),[E,T]=oe.useState(null),[P,C]=oe.useState(null),[D,L]=oe.useState(!1),N=wj(d),[j,$]=s0({prop:n,defaultProp:i??!1,onChange:o,caller:w0}),[U,G]=s0({prop:s,defaultProp:a,onChange:u,caller:w0}),H=oe.useRef(null),X=E?M||!!E.closest("form"):!0,[ee,ae]=oe.useState(new Set),de=Array.from(ee).map(ye=>ye.props.value).join(";");return F.jsx(LQ,{...x,children:F.jsxs(LZe,{required:y,scope:t,trigger:E,onTriggerChange:T,valueNode:P,onValueNodeChange:C,valueNodeHasChildren:D,onValueNodeHasChildrenChange:L,contentId:jm(),value:U,onValueChange:G,open:j,onOpenChange:$,dir:N,triggerPointerDownPosRef:H,disabled:_,children:[F.jsx(Ek.Provider,{scope:t,children:F.jsx(DZe,{scope:e.__scopeSelect,onNativeOptionAdd:oe.useCallback(ye=>{ae(_e=>new Set(_e).add(ye))},[]),onNativeOptionRemove:oe.useCallback(ye=>{ae(_e=>{const ue=new Set(_e);return ue.delete(ye),ue})},[]),children:r})}),X?F.jsxs(Kue,{"aria-hidden":!0,required:y,tabIndex:-1,name:m,autoComplete:g,value:U,onChange:ye=>G(ye.target.value),disabled:_,form:M,children:[U===void 0?F.jsx("option",{value:""}):null,Array.from(ee)]},de):null]})})};Sue.displayName=w0;var Tue="SelectTrigger",Pue=oe.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:n=!1,...i}=e,o=Ck(r),s=B_(Tue,r),a=s.disabled||n,u=ea(t,s.onTriggerChange),d=Ak(r),m=oe.useRef("touch"),[g,_,y]=Xue(x=>{const E=d().filter(C=>!C.disabled),T=E.find(C=>C.value===s.value),P=Yue(E,x,T);P!==void 0&&s.onValueChange(P.value)}),M=x=>{a||(s.onOpenChange(!0),y()),x&&(s.triggerPointerDownPosRef.current={x:Math.round(x.pageX),y:Math.round(x.pageY)})};return F.jsx(dj,{asChild:!0,...o,children:F.jsx(Ei.button,{type:"button",role:"combobox","aria-controls":s.contentId,"aria-expanded":s.open,"aria-required":s.required,"aria-autocomplete":"none",dir:s.dir,"data-state":s.open?"open":"closed",disabled:a,"data-disabled":a?"":void 0,"data-placeholder":Zue(s.value)?"":void 0,...i,ref:u,onClick:In(i.onClick,x=>{x.currentTarget.focus(),m.current!=="mouse"&&M(x)}),onPointerDown:In(i.onPointerDown,x=>{m.current=x.pointerType;const E=x.target;E.hasPointerCapture(x.pointerId)&&E.releasePointerCapture(x.pointerId),x.button===0&&x.ctrlKey===!1&&x.pointerType==="mouse"&&(M(x),x.preventDefault())}),onKeyDown:In(i.onKeyDown,x=>{const E=g.current!=="";!(x.ctrlKey||x.altKey||x.metaKey)&&x.key.length===1&&_(x.key),!(E&&x.key===" ")&&kZe.includes(x.key)&&(M(),x.preventDefault())})})})});Pue.displayName=Tue;var Eue="SelectValue",Aue=oe.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:i,children:o,placeholder:s="",...a}=e,u=B_(Eue,r),{onValueNodeHasChildrenChange:d}=u,m=o!==void 0,g=ea(t,u.onValueNodeChange);return Zl(()=>{d(m)},[d,m]),F.jsx(Ei.span,{...a,ref:g,style:{pointerEvents:"none"},children:Zue(u.value)?F.jsx(F.Fragment,{children:s}):o})});Aue.displayName=Eue;var NZe="SelectIcon",Cue=oe.forwardRef((e,t)=>{const{__scopeSelect:r,children:n,...i}=e;return F.jsx(Ei.span,{"aria-hidden":!0,...i,ref:t,children:n||"▼"})});Cue.displayName=NZe;var jZe="SelectPortal",kue=e=>F.jsx(uS,{asChild:!0,...e});kue.displayName=jZe;var M0="SelectContent",Iue=oe.forwardRef((e,t)=>{const r=B_(M0,e.__scopeSelect),[n,i]=oe.useState();if(Zl(()=>{i(new DocumentFragment)},[]),!r.open){const o=n;return o?C0.createPortal(F.jsx(Oue,{scope:e.__scopeSelect,children:F.jsx(Ek.Slot,{scope:e.__scopeSelect,children:F.jsx("div",{children:e.children})})}),o):null}return F.jsx(Lue,{...e,ref:t})});Iue.displayName=M0;var Mf=10,[Oue,U_]=tx(M0),RZe="SelectContentImpl",FZe=a0("SelectContent.RemoveScroll"),Lue=oe.forwardRef((e,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:o,onPointerDownOutside:s,side:a,sideOffset:u,align:d,alignOffset:m,arrowPadding:g,collisionBoundary:_,collisionPadding:y,sticky:M,hideWhenDetached:x,avoidCollisions:E,...T}=e,P=B_(M0,r),[C,D]=oe.useState(null),[L,N]=oe.useState(null),j=ea(t,Ge=>D(Ge)),[$,U]=oe.useState(null),[G,H]=oe.useState(null),X=Ak(r),[ee,ae]=oe.useState(!1),de=oe.useRef(!1);oe.useEffect(()=>{if(C)return Sj(C)},[C]),Mj();const ye=oe.useCallback(Ge=>{const[ot,...Ye]=X().map(Le=>Le.ref.current),[et]=Ye.slice(-1),Te=document.activeElement;for(const Le of Ge)if(Le===Te||(Le==null||Le.scrollIntoView({block:"nearest"}),Le===ot&&L&&(L.scrollTop=0),Le===et&&L&&(L.scrollTop=L.scrollHeight),Le==null||Le.focus(),document.activeElement!==Te))return},[X,L]),_e=oe.useCallback(()=>ye([$,C]),[ye,$,C]);oe.useEffect(()=>{ee&&_e()},[ee,_e]);const{onOpenChange:ue,triggerPointerDownPosRef:fe}=P;oe.useEffect(()=>{if(C){let Ge={x:0,y:0};const ot=et=>{var Te,Le;Ge={x:Math.abs(Math.round(et.pageX)-(((Te=fe.current)==null?void 0:Te.x)??0)),y:Math.abs(Math.round(et.pageY)-(((Le=fe.current)==null?void 0:Le.y)??0))}},Ye=et=>{Ge.x<=10&&Ge.y<=10?et.preventDefault():C.contains(et.target)||ue(!1),document.removeEventListener("pointermove",ot),fe.current=null};return fe.current!==null&&(document.addEventListener("pointermove",ot),document.addEventListener("pointerup",Ye,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",ot),document.removeEventListener("pointerup",Ye,{capture:!0})}}},[C,ue,fe]),oe.useEffect(()=>{const Ge=()=>ue(!1);return window.addEventListener("blur",Ge),window.addEventListener("resize",Ge),()=>{window.removeEventListener("blur",Ge),window.removeEventListener("resize",Ge)}},[ue]);const[De,pe]=Xue(Ge=>{const ot=X().filter(Te=>!Te.disabled),Ye=ot.find(Te=>Te.ref.current===document.activeElement),et=Yue(ot,Ge,Ye);et&&setTimeout(()=>et.ref.current.focus())}),K=oe.useCallback((Ge,ot,Ye)=>{const et=!de.current&&!Ye;(P.value!==void 0&&P.value===ot||et)&&(U(Ge),et&&(de.current=!0))},[P.value]),te=oe.useCallback(()=>C==null?void 0:C.focus(),[C]),ve=oe.useCallback((Ge,ot,Ye)=>{const et=!de.current&&!Ye;(P.value!==void 0&&P.value===ot||et)&&H(Ge)},[P.value]),$e=n==="popper"?IN:Due,Ce=$e===IN?{side:a,sideOffset:u,align:d,alignOffset:m,arrowPadding:g,collisionBoundary:_,collisionPadding:y,sticky:M,hideWhenDetached:x,avoidCollisions:E}:{};return F.jsx(Oue,{scope:r,content:C,viewport:L,onViewportChange:N,itemRefCallback:K,selectedItem:$,onItemLeave:te,itemTextRefCallback:ve,focusSelectedItem:_e,selectedItemText:G,position:n,isPositioned:ee,searchRef:De,children:F.jsx(A5,{as:FZe,allowPinchZoom:!0,children:F.jsx(P5,{asChild:!0,trapped:P.open,onMountAutoFocus:Ge=>{Ge.preventDefault()},onUnmountAutoFocus:In(i,Ge=>{var ot;(ot=P.trigger)==null||ot.focus({preventScroll:!0}),Ge.preventDefault()}),children:F.jsx(Ib,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:o,onPointerDownOutside:s,onFocusOutside:Ge=>Ge.preventDefault(),onDismiss:()=>P.onOpenChange(!1),children:F.jsx($e,{role:"listbox",id:P.contentId,"data-state":P.open?"open":"closed",dir:P.dir,onContextMenu:Ge=>Ge.preventDefault(),...T,...Ce,onPlaced:()=>ae(!0),ref:j,style:{display:"flex",flexDirection:"column",outline:"none",...T.style},onKeyDown:In(T.onKeyDown,Ge=>{const ot=Ge.ctrlKey||Ge.altKey||Ge.metaKey;if(Ge.key==="Tab"&&Ge.preventDefault(),!ot&&Ge.key.length===1&&pe(Ge.key),["ArrowUp","ArrowDown","Home","End"].includes(Ge.key)){let et=X().filter(Te=>!Te.disabled).map(Te=>Te.ref.current);if(["ArrowUp","End"].includes(Ge.key)&&(et=et.slice().reverse()),["ArrowUp","ArrowDown"].includes(Ge.key)){const Te=Ge.target,Le=et.indexOf(Te);et=et.slice(Le+1)}setTimeout(()=>ye(et)),Ge.preventDefault()}})})})})})})});Lue.displayName=RZe;var zZe="SelectItemAlignedPosition",Due=oe.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:n,...i}=e,o=B_(M0,r),s=U_(M0,r),[a,u]=oe.useState(null),[d,m]=oe.useState(null),g=ea(t,j=>m(j)),_=Ak(r),y=oe.useRef(!1),M=oe.useRef(!0),{viewport:x,selectedItem:E,selectedItemText:T,focusSelectedItem:P}=s,C=oe.useCallback(()=>{if(o.trigger&&o.valueNode&&a&&d&&x&&E&&T){const j=o.trigger.getBoundingClientRect(),$=d.getBoundingClientRect(),U=o.valueNode.getBoundingClientRect(),G=T.getBoundingClientRect();if(o.dir!=="rtl"){const Te=G.left-$.left,Le=U.left-Te,ke=j.left-Le,Xe=j.width+ke,Ne=Math.max(Xe,$.width),Ot=window.innerWidth-Mf,Lt=AH(Le,[Mf,Math.max(Mf,Ot-Ne)]);a.style.minWidth=Xe+"px",a.style.left=Lt+"px"}else{const Te=$.right-G.right,Le=window.innerWidth-U.right-Te,ke=window.innerWidth-j.right-Le,Xe=j.width+ke,Ne=Math.max(Xe,$.width),Ot=window.innerWidth-Mf,Lt=AH(Le,[Mf,Math.max(Mf,Ot-Ne)]);a.style.minWidth=Xe+"px",a.style.right=Lt+"px"}const H=_(),X=window.innerHeight-Mf*2,ee=x.scrollHeight,ae=window.getComputedStyle(d),de=parseInt(ae.borderTopWidth,10),ye=parseInt(ae.paddingTop,10),_e=parseInt(ae.borderBottomWidth,10),ue=parseInt(ae.paddingBottom,10),fe=de+ye+ee+ue+_e,De=Math.min(E.offsetHeight*5,fe),pe=window.getComputedStyle(x),K=parseInt(pe.paddingTop,10),te=parseInt(pe.paddingBottom,10),ve=j.top+j.height/2-Mf,$e=X-ve,Ce=E.offsetHeight/2,Ge=E.offsetTop+Ce,ot=de+ye+Ge,Ye=fe-ot;if(ot<=ve){const Te=H.length>0&&E===H[H.length-1].ref.current;a.style.bottom="0px";const Le=d.clientHeight-x.offsetTop-x.offsetHeight,ke=Math.max($e,Ce+(Te?te:0)+Le+_e),Xe=ot+ke;a.style.height=Xe+"px"}else{const Te=H.length>0&&E===H[0].ref.current;a.style.top="0px";const ke=Math.max(ve,de+x.offsetTop+(Te?K:0)+Ce)+Ye;a.style.height=ke+"px",x.scrollTop=ot-ve+x.offsetTop}a.style.margin=`${Mf}px 0`,a.style.minHeight=De+"px",a.style.maxHeight=X+"px",n==null||n(),requestAnimationFrame(()=>y.current=!0)}},[_,o.trigger,o.valueNode,a,d,x,E,T,o.dir,n]);Zl(()=>C(),[C]);const[D,L]=oe.useState();Zl(()=>{d&&L(window.getComputedStyle(d).zIndex)},[d]);const N=oe.useCallback(j=>{j&&M.current===!0&&(C(),P==null||P(),M.current=!1)},[C,P]);return F.jsx(UZe,{scope:r,contentWrapper:a,shouldExpandOnScrollRef:y,onScrollButtonChange:N,children:F.jsx("div",{ref:u,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:D},children:F.jsx(Ei.div,{...i,ref:g,style:{boxSizing:"border-box",maxHeight:"100%",...i.style}})})})});Due.displayName=zZe;var BZe="SelectPopperPosition",IN=oe.forwardRef((e,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:i=Mf,...o}=e,s=Ck(r);return F.jsx(hj,{...s,...o,ref:t,align:n,collisionPadding:i,style:{boxSizing:"border-box",...o.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});IN.displayName=BZe;var[UZe,YF]=tx(M0,{}),ON="SelectViewport",$ue=oe.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:n,...i}=e,o=U_(ON,r),s=YF(ON,r),a=ea(t,o.onViewportChange),u=oe.useRef(0);return F.jsxs(F.Fragment,{children:[F.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),F.jsx(Ek.Slot,{scope:r,children:F.jsx(Ei.div,{"data-radix-select-viewport":"",role:"presentation",...i,ref:a,style:{position:"relative",flex:1,overflow:"hidden auto",...i.style},onScroll:In(i.onScroll,d=>{const m=d.currentTarget,{contentWrapper:g,shouldExpandOnScrollRef:_}=s;if(_!=null&&_.current&&g){const y=Math.abs(u.current-m.scrollTop);if(y>0){const M=window.innerHeight-Mf*2,x=parseFloat(g.style.minHeight),E=parseFloat(g.style.height),T=Math.max(x,E);if(T<M){const P=T+y,C=Math.min(M,P),D=P-C;g.style.height=C+"px",g.style.bottom==="0px"&&(m.scrollTop=D>0?D:0,g.style.justifyContent="flex-end")}}}u.current=m.scrollTop})})})]})});$ue.displayName=ON;var Nue="SelectGroup",[VZe,WZe]=tx(Nue),GZe=oe.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,i=jm();return F.jsx(VZe,{scope:r,id:i,children:F.jsx(Ei.div,{role:"group","aria-labelledby":i,...n,ref:t})})});GZe.displayName=Nue;var jue="SelectLabel",Rue=oe.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,i=WZe(jue,r);return F.jsx(Ei.div,{id:i.id,...n,ref:t})});Rue.displayName=jue;var UC="SelectItem",[qZe,Fue]=tx(UC),zue=oe.forwardRef((e,t)=>{const{__scopeSelect:r,value:n,disabled:i=!1,textValue:o,...s}=e,a=B_(UC,r),u=U_(UC,r),d=a.value===n,[m,g]=oe.useState(o??""),[_,y]=oe.useState(!1),M=ea(t,P=>{var C;return(C=u.itemRefCallback)==null?void 0:C.call(u,P,n,i)}),x=jm(),E=oe.useRef("touch"),T=()=>{i||(a.onValueChange(n),a.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return F.jsx(qZe,{scope:r,value:n,disabled:i,textId:x,isSelected:d,onItemTextChange:oe.useCallback(P=>{g(C=>C||((P==null?void 0:P.textContent)??"").trim())},[]),children:F.jsx(Ek.ItemSlot,{scope:r,value:n,disabled:i,textValue:m,children:F.jsx(Ei.div,{role:"option","aria-labelledby":x,"data-highlighted":_?"":void 0,"aria-selected":d&&_,"data-state":d?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1,...s,ref:M,onFocus:In(s.onFocus,()=>y(!0)),onBlur:In(s.onBlur,()=>y(!1)),onClick:In(s.onClick,()=>{E.current!=="mouse"&&T()}),onPointerUp:In(s.onPointerUp,()=>{E.current==="mouse"&&T()}),onPointerDown:In(s.onPointerDown,P=>{E.current=P.pointerType}),onPointerMove:In(s.onPointerMove,P=>{var C;E.current=P.pointerType,i?(C=u.onItemLeave)==null||C.call(u):E.current==="mouse"&&P.currentTarget.focus({preventScroll:!0})}),onPointerLeave:In(s.onPointerLeave,P=>{var C;P.currentTarget===document.activeElement&&((C=u.onItemLeave)==null||C.call(u))}),onKeyDown:In(s.onKeyDown,P=>{var D;((D=u.searchRef)==null?void 0:D.current)!==""&&P.key===" "||(IZe.includes(P.key)&&T(),P.key===" "&&P.preventDefault())})})})})});zue.displayName=UC;var Qw="SelectItemText",Bue=oe.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:i,...o}=e,s=B_(Qw,r),a=U_(Qw,r),u=Fue(Qw,r),d=$Ze(Qw,r),[m,g]=oe.useState(null),_=ea(t,T=>g(T),u.onItemTextChange,T=>{var P;return(P=a.itemTextRefCallback)==null?void 0:P.call(a,T,u.value,u.disabled)}),y=m==null?void 0:m.textContent,M=oe.useMemo(()=>F.jsx("option",{value:u.value,disabled:u.disabled,children:y},u.value),[u.disabled,u.value,y]),{onNativeOptionAdd:x,onNativeOptionRemove:E}=d;return Zl(()=>(x(M),()=>E(M)),[x,E,M]),F.jsxs(F.Fragment,{children:[F.jsx(Ei.span,{id:u.textId,...o,ref:_}),u.isSelected&&s.valueNode&&!s.valueNodeHasChildren?C0.createPortal(o.children,s.valueNode):null]})});Bue.displayName=Qw;var Uue="SelectItemIndicator",Vue=oe.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return Fue(Uue,r).isSelected?F.jsx(Ei.span,{"aria-hidden":!0,...n,ref:t}):null});Vue.displayName=Uue;var LN="SelectScrollUpButton",Wue=oe.forwardRef((e,t)=>{const r=U_(LN,e.__scopeSelect),n=YF(LN,e.__scopeSelect),[i,o]=oe.useState(!1),s=ea(t,n.onScrollButtonChange);return Zl(()=>{if(r.viewport&&r.isPositioned){let a=function(){const d=u.scrollTop>0;o(d)};const u=r.viewport;return a(),u.addEventListener("scroll",a),()=>u.removeEventListener("scroll",a)}},[r.viewport,r.isPositioned]),i?F.jsx(que,{...e,ref:s,onAutoScroll:()=>{const{viewport:a,selectedItem:u}=r;a&&u&&(a.scrollTop=a.scrollTop-u.offsetHeight)}}):null});Wue.displayName=LN;var DN="SelectScrollDownButton",Gue=oe.forwardRef((e,t)=>{const r=U_(DN,e.__scopeSelect),n=YF(DN,e.__scopeSelect),[i,o]=oe.useState(!1),s=ea(t,n.onScrollButtonChange);return Zl(()=>{if(r.viewport&&r.isPositioned){let a=function(){const d=u.scrollHeight-u.clientHeight,m=Math.ceil(u.scrollTop)<d;o(m)};const u=r.viewport;return a(),u.addEventListener("scroll",a),()=>u.removeEventListener("scroll",a)}},[r.viewport,r.isPositioned]),i?F.jsx(que,{...e,ref:s,onAutoScroll:()=>{const{viewport:a,selectedItem:u}=r;a&&u&&(a.scrollTop=a.scrollTop+u.offsetHeight)}}):null});Gue.displayName=DN;var que=oe.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:n,...i}=e,o=U_("SelectScrollButton",r),s=oe.useRef(null),a=Ak(r),u=oe.useCallback(()=>{s.current!==null&&(window.clearInterval(s.current),s.current=null)},[]);return oe.useEffect(()=>()=>u(),[u]),Zl(()=>{var m;const d=a().find(g=>g.ref.current===document.activeElement);(m=d==null?void 0:d.ref.current)==null||m.scrollIntoView({block:"nearest"})},[a]),F.jsx(Ei.div,{"aria-hidden":!0,...i,ref:t,style:{flexShrink:0,...i.style},onPointerDown:In(i.onPointerDown,()=>{s.current===null&&(s.current=window.setInterval(n,50))}),onPointerMove:In(i.onPointerMove,()=>{var d;(d=o.onItemLeave)==null||d.call(o),s.current===null&&(s.current=window.setInterval(n,50))}),onPointerLeave:In(i.onPointerLeave,()=>{u()})})}),HZe="SelectSeparator",Hue=oe.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return F.jsx(Ei.div,{"aria-hidden":!0,...n,ref:t})});Hue.displayName=HZe;var $N="SelectArrow",KZe=oe.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,i=Ck(r),o=B_($N,r),s=U_($N,r);return o.open&&s.position==="popper"?F.jsx(fj,{...i,...n,ref:t}):null});KZe.displayName=$N;var ZZe="SelectBubbleInput",Kue=oe.forwardRef(({__scopeSelect:e,value:t,...r},n)=>{const i=oe.useRef(null),o=ea(n,i),s=Mue(t);return oe.useEffect(()=>{const a=i.current;if(!a)return;const u=window.HTMLSelectElement.prototype,m=Object.getOwnPropertyDescriptor(u,"value").set;if(s!==t&&m){const g=new Event("change",{bubbles:!0});m.call(a,t),a.dispatchEvent(g)}},[s,t]),F.jsx(Ei.select,{...r,style:{...PY,...r.style},ref:o,defaultValue:t})});Kue.displayName=ZZe;function Zue(e){return e===""||e===void 0}function Xue(e){const t=Hu(e),r=oe.useRef(""),n=oe.useRef(0),i=oe.useCallback(s=>{const a=r.current+s;t(a),function u(d){r.current=d,window.clearTimeout(n.current),d!==""&&(n.current=window.setTimeout(()=>u(""),1e3))}(a)},[t]),o=oe.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return oe.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,i,o]}function Yue(e,t,r){const i=t.length>1&&Array.from(t).every(d=>d===t[0])?t[0]:t,o=r?e.indexOf(r):-1;let s=XZe(e,Math.max(o,0));i.length===1&&(s=s.filter(d=>d!==r));const u=s.find(d=>d.textValue.toLowerCase().startsWith(i.toLowerCase()));return u!==r?u:void 0}function XZe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var YZe=Sue,Que=Pue,QZe=Aue,JZe=Cue,eXe=kue,Jue=Iue,tXe=$ue,ede=Rue,tde=zue,rXe=Bue,nXe=Vue,rde=Wue,nde=Gue,ide=Hue;const VC=YZe,WC=QZe,qM=oe.forwardRef(({className:e,children:t,...r},n)=>F.jsxs(Que,{ref:n,className:_i("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[t,F.jsx(JZe,{asChild:!0,children:F.jsx(ZY,{className:"h-4 w-4 opacity-50"})})]}));qM.displayName=Que.displayName;const ode=oe.forwardRef(({className:e,...t},r)=>F.jsx(rde,{ref:r,className:_i("flex cursor-default items-center justify-center py-1",e),...t,children:F.jsx(fge,{className:"h-4 w-4"})}));ode.displayName=rde.displayName;const ade=oe.forwardRef(({className:e,...t},r)=>F.jsx(nde,{ref:r,className:_i("flex cursor-default items-center justify-center py-1",e),...t,children:F.jsx(ZY,{className:"h-4 w-4"})}));ade.displayName=nde.displayName;const HM=oe.forwardRef(({className:e,children:t,position:r="popper",...n},i)=>F.jsx(eXe,{children:F.jsxs(Jue,{ref:i,className:_i("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...n,children:[F.jsx(ode,{}),F.jsx(tXe,{className:_i("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),F.jsx(ade,{})]})}));HM.displayName=Jue.displayName;const iXe=oe.forwardRef(({className:e,...t},r)=>F.jsx(ede,{ref:r,className:_i("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));iXe.displayName=ede.displayName;const ad=oe.forwardRef(({className:e,children:t,...r},n)=>F.jsxs(tde,{ref:n,className:_i("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[F.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:F.jsx(nXe,{children:F.jsx(J4,{className:"h-4 w-4"})})}),F.jsx(rXe,{children:t})]}));ad.displayName=tde.displayName;const oXe=oe.forwardRef(({className:e,...t},r)=>F.jsx(ide,{ref:r,className:_i("-mx-1 my-1 h-px bg-muted",e),...t}));oXe.displayName=ide.displayName;const aXe=()=>{const{user:e}=Xp(),t=oe.useRef(null),r=oe.useRef(null),[n,i]=oe.useState("chhattisgarh"),[o,s]=oe.useState("all"),[a,u]=oe.useState("fra-claims"),d={"fra-claims":{count:156,color:"#22c55e",name:"FRA Claims"},"community-rights":{count:89,color:"#3b82f6",name:"Community Rights"},"pending-claims":{count:42,color:"#f59e0b",name:"Pending Claims"}},m=[{id:"FRA/CGH/BST/2024/001",coordinates:[81.2849,19.1383],beneficiary:"Ramesh Kumar",status:"approved",landArea:2.5,village:"Kondagaon"},{id:"FRA/CGH/BST/2024/002",coordinates:[81.3849,19.2383],beneficiary:"Sunita Devi",status:"pending",landArea:1.8,village:"Tokapal"},{id:"FRA/CGH/BST/2024/003",coordinates:[81.1849,19.0383],beneficiary:"Mohan Lal",status:"community",landArea:3.2,village:"Bhanupratappur"}];oe.useEffect(()=>{if(t.current)return r.current=new YP.Map({container:t.current,style:{version:8,sources:{osm:{type:"raster",tiles:["https://tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256,attribution:"© OpenStreetMap contributors"}},layers:[{id:"osm",type:"raster",source:"osm"}]},center:[81.2849,19.1383],zoom:8}),r.current.addControl(new YP.NavigationControl,"top-right"),r.current.on("load",()=>{r.current.addSource("water-source",{type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Polygon",coordinates:[[[81.25,19.1],[81.3,19.1],[81.3,19.15],[81.25,19.15],[81.25,19.1]]]},properties:{type:"reservoir"}}]}}),r.current.addLayer({id:"water-layer",type:"fill",source:"water-source",paint:{"fill-color":"#0080ff","fill-opacity":.6}}),r.current.addSource("forest-source",{type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Polygon",coordinates:[[[81.2,19.08],[81.35,19.08],[81.35,19.18],[81.2,19.18],[81.2,19.08]]]},properties:{type:"dense_forest"}}]}}),r.current.addLayer({id:"forest-layer",type:"fill",source:"forest-source",paint:{"fill-color":"#1a5f1a","fill-opacity":.4}}),m.forEach(_=>{const y=_.status==="approved"?"#22c55e":_.status==="pending"?"#f59e0b":"#3b82f6",M=document.createElement("div");M.className="custom-marker",M.style.cssText=`
          width: 12px;
          height: 12px;
          background-color: ${y};
          border: 2px solid white;
          border-radius: 50%;
          cursor: pointer;
          box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        `;const x=new YP.Popup({offset:15,closeButton:!0,closeOnClick:!0}).setHTML(`
          <div class="p-3">
            <h3 class="font-semibold text-sm mb-2">${_.id}</h3>
            <div class="space-y-1 text-xs">
              <div><strong>Beneficiary:</strong> ${_.beneficiary}</div>
              <div><strong>Village:</strong> ${_.village}</div>
              <div><strong>Land Area:</strong> ${_.landArea} acres</div>
              <div><strong>Status:</strong> 
                <span class="px-1.5 py-0.5 rounded text-xs font-medium ${_.status==="approved"?"bg-green-100 text-green-800":_.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}">
                  ${_.status.toUpperCase()}
                </span>
              </div>
            </div>
          </div>
        `);new YP.Marker(M).setLngLat([_.coordinates[0],_.coordinates[1]]).setPopup(x).addTo(r.current)})}),()=>{var _;(_=r.current)==null||_.remove()}},[]);const g=[{id:"fra-claims",name:"FRA Claims",icon:Mge,color:"text-success"},{id:"community-rights",name:"Community Rights",icon:l0,color:"text-primary"},{id:"pending-claims",name:"Pending Claims",icon:O_,color:"text-warning"}];return F.jsx(jf.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"container mx-auto px-4 py-8",children:F.jsxs("div",{className:"space-y-6",children:[F.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between space-y-4 md:space-y-0",children:[F.jsxs("div",{children:[F.jsxs("h1",{className:"text-3xl font-bold gov-heading flex items-center space-x-3",children:[F.jsx(YY,{className:"w-8 h-8 text-primary"}),F.jsx("span",{children:"FRA Atlas"})]}),F.jsx("p",{className:"text-muted-foreground mt-1",children:"Interactive map of Forest Rights Act claims and community lands"})]}),F.jsxs("div",{className:"flex items-center space-x-3",children:[F.jsxs(VC,{value:n,onValueChange:i,children:[F.jsx(qM,{className:"w-40",children:F.jsx(WC,{})}),F.jsxs(HM,{children:[F.jsx(ad,{value:"chhattisgarh",children:"Chhattisgarh"}),F.jsx(ad,{value:"odisha",children:"Odisha"}),F.jsx(ad,{value:"jharkhand",children:"Jharkhand"})]})]}),F.jsxs(VC,{value:o,onValueChange:s,children:[F.jsx(qM,{className:"w-32",children:F.jsx(WC,{placeholder:"District"})}),F.jsxs(HM,{children:[F.jsx(ad,{value:"all",children:"All Districts"}),F.jsx(ad,{value:"bastar",children:"Bastar"}),F.jsx(ad,{value:"kanker",children:"Kanker"}),F.jsx(ad,{value:"kondagaon",children:"Kondagaon"})]})]})]})]}),F.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[F.jsx("div",{className:"lg:col-span-3",children:F.jsxs(ci,{className:"overflow-hidden",children:[F.jsx(oo,{className:"pb-3",children:F.jsxs("div",{className:"flex items-center justify-between",children:[F.jsxs(ao,{className:"flex items-center space-x-2",children:[F.jsx(wge,{className:"w-5 h-5"}),F.jsx("span",{children:"Interactive Map"})]}),F.jsxs("div",{className:"flex items-center space-x-2",children:[F.jsx(XY,{className:"w-4 h-4 text-muted-foreground"}),F.jsx("span",{className:"text-sm text-muted-foreground",children:(e==null?void 0:e.role)==="user"?"Personal View":(e==null?void 0:e.role)==="officer"?"District View":"State View"})]})]})}),F.jsx(ui,{className:"p-0",children:F.jsx("div",{ref:t,className:"w-full h-[600px] rounded-b-lg"})})]})}),F.jsxs("div",{className:"space-y-6",children:[F.jsxs(ci,{children:[F.jsx(oo,{children:F.jsx(ao,{className:"text-lg",children:"Map Layers"})}),F.jsx(ui,{className:"space-y-3",children:g.map(_=>{const y=_.icon,M=d[_.id];return F.jsxs(iu,{variant:a===_.id?"default":"outline",className:"w-full justify-start",onClick:()=>u(_.id),children:[F.jsx(y,{className:`w-4 h-4 mr-3 ${_.color}`}),F.jsx("div",{className:"flex-1 text-left",children:F.jsxs("div",{className:"flex items-center justify-between",children:[F.jsx("span",{children:_.name}),F.jsx(Hd,{variant:"secondary",className:"ml-2",children:M.count})]})})]},_.id)})})]}),F.jsxs(ci,{children:[F.jsx(oo,{children:F.jsx(ao,{className:"text-lg",children:"Legend"})}),F.jsxs(ui,{className:"space-y-3",children:[F.jsxs("div",{className:"flex items-center space-x-3",children:[F.jsx("div",{className:"w-4 h-4 bg-success rounded-full border-2 border-white shadow-sm"}),F.jsx("span",{className:"text-sm",children:"Approved Claims"})]}),F.jsxs("div",{className:"flex items-center space-x-3",children:[F.jsx("div",{className:"w-4 h-4 bg-warning rounded-full border-2 border-white shadow-sm"}),F.jsx("span",{className:"text-sm",children:"Pending Claims"})]}),F.jsxs("div",{className:"flex items-center space-x-3",children:[F.jsx("div",{className:"w-4 h-4 bg-primary rounded-full border-2 border-white shadow-sm"}),F.jsx("span",{className:"text-sm",children:"Community Rights"})]}),F.jsxs("div",{className:"flex items-center space-x-3",children:[F.jsx("div",{className:"w-4 h-4 bg-destructive rounded-full border-2 border-white shadow-sm"}),F.jsx("span",{className:"text-sm",children:"Rejected Claims"})]})]})]}),F.jsxs(ci,{children:[F.jsx(oo,{children:F.jsx(ao,{className:"text-lg",children:"Quick Stats"})}),F.jsxs(ui,{className:"space-y-4",children:[F.jsxs("div",{className:"text-center",children:[F.jsx("div",{className:"text-2xl font-bold text-primary",children:"156"}),F.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Claims"})]}),F.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[F.jsxs("div",{children:[F.jsx("div",{className:"text-lg font-bold text-success",children:"89"}),F.jsx("div",{className:"text-xs text-muted-foreground",children:"Approved"})]}),F.jsxs("div",{children:[F.jsx("div",{className:"text-lg font-bold text-warning",children:"42"}),F.jsx("div",{className:"text-xs text-muted-foreground",children:"Pending"})]})]}),F.jsxs("div",{className:"text-center pt-2 border-t",children:[F.jsx("div",{className:"text-lg font-bold",children:"245.8 acres"}),F.jsx("div",{className:"text-xs text-muted-foreground",children:"Total Land Approved"})]})]})]})]})]})]})})},sXe=()=>{const e=[{state:"Chhattisgarh",approved:1567,pending:623,rejected:266},{state:"Odisha",approved:1234,pending:456,rejected:198},{state:"Jharkhand",approved:987,pending:345,rejected:156},{state:"Maharashtra",approved:876,pending:234,rejected:123},{state:"Gujarat",experienced:654,pending:189,rejected:98}],t=[{name:"Agricultural",value:2456,color:"#22c55e"},{name:"Forest Land",value:1834,color:"#3b82f6"},{name:"Water Bodies",value:602,color:"#f59e0b"},{name:"Grazing Land",value:445,color:"#8b5cf6"}],r=[{month:"Jan",applications:145,approvals:98,efficiency:67},{month:"Feb",applications:167,approvals:112,efficiency:67},{month:"Mar",applications:189,approvals:134,efficiency:71},{month:"Apr",applications:203,approvals:156,efficiency:77},{month:"May",applications:178,approvals:142,efficiency:80},{month:"Jun",applications:234,approvals:187,efficiency:80}],n=[{metric:"Processing Time",value:"45 days",trend:-12,status:"improving"},{metric:"Approval Rate",value:"63.8%",trend:5.2,status:"good"},{metric:"Document Accuracy",value:"87.4%",trend:2.1,status:"good"},{metric:"Beneficiary Satisfaction",value:"78.9%",trend:8.3,status:"improving"}],i=[{title:"Claim Processing Forecast",prediction:"Expected 15% increase in applications next quarter",confidence:87,recommendation:"Increase officer allocation in high-demand districts"},{title:"Seasonal Pattern Analysis",prediction:"Peak applications expected in March-May period",confidence:92,recommendation:"Pre-position resources for seasonal surge"},{title:"Document Quality Trends",prediction:"Document completeness improving by 12% annually",confidence:78,recommendation:"Continue digital literacy programs"}],o=a=>{switch(a){case"good":return F.jsx(Yd,{className:"w-4 h-4 text-success"});case"improving":return F.jsx(ME,{className:"w-4 h-4 text-primary"});case"warning":return F.jsx(QL,{className:"w-4 h-4 text-warning"});default:return F.jsx(q2,{className:"w-4 h-4 text-muted-foreground"})}},s=a=>a>0?"text-success":a<0?"text-destructive":"text-muted-foreground";return F.jsx(jf.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"container mx-auto px-4 py-8",children:F.jsxs("div",{className:"space-y-6",children:[F.jsxs("div",{className:"bg-gradient-card rounded-lg p-6 border border-border",children:[F.jsxs("h1",{className:"text-3xl font-bold gov-heading flex items-center space-x-3 mb-2",children:[F.jsx(KY,{className:"w-8 h-8 text-primary"}),F.jsx("span",{children:"AI Insights Dashboard"})]}),F.jsx("p",{className:"text-muted-foreground",children:"Advanced analytics and AI-powered insights for FRA implementation"})]}),F.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:n.map((a,u)=>F.jsxs(ci,{children:[F.jsx(oo,{className:"pb-3",children:F.jsxs("div",{className:"flex items-center justify-between",children:[F.jsx(ao,{className:"text-sm font-medium text-muted-foreground",children:a.metric}),o(a.status)]})}),F.jsx(ui,{children:F.jsxs("div",{className:"space-y-2",children:[F.jsx("div",{className:"text-2xl font-bold",children:a.value}),F.jsxs("div",{className:`flex items-center space-x-1 text-sm ${s(a.trend)}`,children:[F.jsx(ME,{className:"w-4 h-4"}),F.jsxs("span",{children:[a.trend>0?"+":"",a.trend,"% vs last month"]})]})]})})]},u))}),F.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[F.jsxs(ci,{children:[F.jsxs(oo,{children:[F.jsxs(ao,{className:"flex items-center space-x-2",children:[F.jsx(BC,{className:"w-5 h-5"}),F.jsx("span",{children:"State-wise Claims Analysis"})]}),F.jsx(Fc,{children:"Approved vs Pending claims by state"})]}),F.jsx(ui,{children:F.jsx(M1,{width:"100%",height:300,children:F.jsxs(BC,{data:e,children:[F.jsx(VM,{strokeDasharray:"3 3"}),F.jsx(Qm,{dataKey:"state"}),F.jsx(Wp,{}),F.jsx(Fu,{}),F.jsx(Nh,{dataKey:"approved",fill:"#22c55e",name:"Approved"}),F.jsx(Nh,{dataKey:"pending",fill:"#f59e0b",name:"Pending"}),F.jsx(Nh,{dataKey:"rejected",fill:"#ef4444",name:"Rejected"})]})})})]}),F.jsxs(ci,{children:[F.jsxs(oo,{children:[F.jsx(ao,{children:"Land Use Classification"}),F.jsx(Fc,{children:"AI-analyzed land type distribution"})]}),F.jsx(ui,{children:F.jsx(M1,{width:"100%",height:300,children:F.jsxs(bue,{children:[F.jsx(Jp,{data:t,cx:"50%",cy:"50%",outerRadius:100,dataKey:"value",label:({name:a,percent:u})=>`${a} ${(u*100).toFixed(0)}%`,children:t.map((a,u)=>F.jsx(wS,{fill:a.color},`cell-${u}`))}),F.jsx(Fu,{})]})})})]})]}),F.jsxs(ci,{children:[F.jsxs(oo,{children:[F.jsxs(ao,{className:"flex items-center space-x-2",children:[F.jsx(ME,{className:"w-5 h-5"}),F.jsx("span",{children:"Processing Efficiency Trends"})]}),F.jsx(Fc,{children:"Monthly application volume and approval efficiency"})]}),F.jsx(ui,{children:F.jsx(M1,{width:"100%",height:400,children:F.jsxs(PZe,{data:r,children:[F.jsx(VM,{strokeDasharray:"3 3"}),F.jsx(Qm,{dataKey:"month"}),F.jsx(Wp,{yAxisId:"left"}),F.jsx(Wp,{yAxisId:"right",orientation:"right"}),F.jsx(Fu,{}),F.jsx(Ym,{yAxisId:"left",type:"monotone",dataKey:"applications",stackId:"1",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.3,name:"Applications"}),F.jsx(Ym,{yAxisId:"left",type:"monotone",dataKey:"approvals",stackId:"1",stroke:"#22c55e",fill:"#22c55e",fillOpacity:.3,name:"Approvals"}),F.jsx(x0,{yAxisId:"right",type:"monotone",dataKey:"efficiency",stroke:"#f59e0b",strokeWidth:3,name:"Efficiency %"})]})})})]}),F.jsxs(ci,{children:[F.jsxs(oo,{children:[F.jsxs(ao,{className:"flex items-center space-x-2",children:[F.jsx(q2,{className:"w-5 h-5"}),F.jsx("span",{children:"AI Predictions & Recommendations"})]}),F.jsx(Fc,{children:"Machine learning insights for policy optimization"})]}),F.jsx(ui,{className:"space-y-6",children:i.map((a,u)=>F.jsxs("div",{className:"border border-border rounded-lg p-4",children:[F.jsxs("div",{className:"flex items-start justify-between mb-3",children:[F.jsx("h3",{className:"font-semibold",children:a.title}),F.jsxs("div",{className:"flex items-center space-x-2",children:[F.jsx("span",{className:"text-sm text-muted-foreground",children:"Confidence:"}),F.jsxs("div",{className:"flex items-center space-x-1",children:[F.jsx("div",{className:"w-16 h-2 bg-muted rounded-full overflow-hidden",children:F.jsx("div",{className:"h-full bg-primary rounded-full",style:{width:`${a.confidence}%`}})}),F.jsxs("span",{className:"text-sm font-medium",children:[a.confidence,"%"]})]})]})]}),F.jsx("p",{className:"text-muted-foreground mb-3",children:a.prediction}),F.jsxs("div",{className:"flex items-center space-x-2 p-3 bg-primary/5 rounded-lg",children:[F.jsx(QL,{className:"w-4 h-4 text-primary"}),F.jsxs("span",{className:"text-sm font-medium",children:["Recommendation: ",a.recommendation]})]})]},u))})]}),F.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[F.jsx(ci,{className:"text-center",children:F.jsxs(ui,{className:"p-6",children:[F.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center mx-auto mb-4",children:F.jsx(l0,{className:"w-6 h-6 text-primary"})}),F.jsx("h3",{className:"font-semibold mb-2",children:"Beneficiary Impact"}),F.jsx("p",{className:"text-2xl font-bold text-primary mb-1",children:"1,567"}),F.jsx("p",{className:"text-sm text-muted-foreground",children:"Families benefited this year"})]})}),F.jsx(ci,{className:"text-center",children:F.jsxs(ui,{className:"p-6",children:[F.jsx("div",{className:"w-12 h-12 bg-success/10 rounded-lg flex items-center justify-center mx-auto mb-4",children:F.jsx(O_,{className:"w-6 h-6 text-success"})}),F.jsx("h3",{className:"font-semibold mb-2",children:"Land Secured"}),F.jsx("p",{className:"text-2xl font-bold text-success mb-1",children:"4,892"}),F.jsx("p",{className:"text-sm text-muted-foreground",children:"Acres of forest rights secured"})]})}),F.jsx(ci,{className:"text-center",children:F.jsxs(ui,{className:"p-6",children:[F.jsx("div",{className:"w-12 h-12 bg-warning/10 rounded-lg flex items-center justify-center mx-auto mb-4",children:F.jsx(w_,{className:"w-6 h-6 text-warning"})}),F.jsx("h3",{className:"font-semibold mb-2",children:"Processing Speed"}),F.jsx("p",{className:"text-2xl font-bold text-warning mb-1",children:"45"}),F.jsx("p",{className:"text-sm text-muted-foreground",children:"Average days to process"})]})})]})]})})},lXe=()=>{var u;const{user:e}=Xp(),t=()=>{switch(e==null?void 0:e.role){case"user":return r;case"officer":return n;case"admin":return i;default:return r}},r=[{id:1,scheme:"PM-KISAN",title:"Direct Income Support",description:"You are eligible for ₹6,000 annual direct benefit transfer",eligibility:"eligible",priority:"high",icon:wE,steps:["Visit nearest Common Service Center","Carry FRA land documents","Complete Aadhaar verification","Submit bank account details"],benefits:"₹6,000/year in 3 installments",deadline:"2024-03-31"},{id:2,scheme:"Jal Jeevan Mission",title:"Household Water Connection",description:"Your village qualifies for piped water supply under JJM",eligibility:"eligible",priority:"high",icon:mge,steps:["Village committee to submit application","Community contribution arrangement","Site survey and technical approval","Implementation by approved contractor"],benefits:"Free water connection + 55L/day assured supply",deadline:"2024-06-30"},{id:3,scheme:"MGNREGA",title:"Employment Guarantee",description:"Guaranteed 100 days employment available",eligibility:"eligible",priority:"medium",icon:l0,steps:["Apply for job card at Gram Panchayat","Submit work demand application","Join allocated work projects","Ensure attendance marking"],benefits:"₹220/day wages for 100 days",deadline:"Ongoing"}],n=[{id:1,title:"Accelerated Claim Processing",description:"Current backlog: 42 pending claims. Recommended action plan.",priority:"high",icon:q2,metrics:{current:42,target:20,deadline:"30 days"},actions:["Organize weekend verification camps","Deploy additional survey teams","Implement digital document verification","Set up mobile verification units"]},{id:2,title:"Village-Level Awareness Campaign",description:"Low application rate in 8 villages. Outreach recommended.",priority:"medium",icon:l0,metrics:{villages:8,coverage:"45%",target:"80%"},actions:["Schedule village meetings","Distribute multilingual materials","Train local facilitators","Use mobile announcement systems"]},{id:3,title:"Inter-Department Coordination",description:"Sync with Revenue, Forest, and Tribal Welfare departments.",priority:"medium",icon:JL,metrics:{departments:3,meetings:"Monthly",coordination:"70%"},actions:["Schedule monthly coordination meetings","Create shared digital dashboards","Establish joint verification protocols","Implement cross-department training"]}],i=[{id:1,title:"State Policy Optimization",description:"AI analysis suggests policy improvements for better outcomes.",priority:"high",icon:q2,impact:{beneficiaries:"25,000+",efficiency:"+35%",cost:"₹2.5Cr savings"},policies:["Digitize entire FRA workflow","Implement GPS-based land verification","Create unified tribal welfare portal","Establish mobile courts for quick resolution"]},{id:2,title:"Budget Reallocation",description:"Fund distribution optimization based on district performance.",priority:"high",icon:wE,impact:{districts:28,allocation:"₹45Cr",efficiency:"+28%"},allocations:["Increase allocation to high-performing districts","Create incentive fund for target achievement","Allocate emergency fund for pending cases","Technology upgrade fund allocation"]},{id:3,title:"Capacity Building Program",description:"Officer training program to improve processing efficiency.",priority:"medium",icon:bge,impact:{officers:156,training:"40 hours",improvement:"+25%"},modules:["Digital systems training","Legal procedures workshop","Community engagement techniques","Conflict resolution skills"]}],o=d=>{switch(d){case"high":return"bg-destructive text-destructive-foreground";case"medium":return"bg-warning text-warning-foreground";case"low":return"bg-success text-success-foreground";default:return"bg-muted text-muted-foreground"}},s=d=>{switch(d){case"eligible":return"bg-success text-success-foreground";case"pending":return"bg-warning text-warning-foreground";case"not_eligible":return"bg-destructive text-destructive-foreground";default:return"bg-muted text-muted-foreground"}},a=t();return F.jsx(jf.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"container mx-auto px-4 py-8",children:F.jsxs("div",{className:"space-y-6",children:[F.jsxs("div",{className:"bg-gradient-card rounded-lg p-6 border border-border",children:[F.jsxs("h1",{className:"text-3xl font-bold gov-heading flex items-center space-x-3 mb-2",children:[F.jsx(JL,{className:"w-8 h-8 text-primary"}),F.jsx("span",{children:"Decision Support System"})]}),F.jsxs("p",{className:"text-muted-foreground",children:["AI-powered recommendations for ",(e==null?void 0:e.role)==="user"?"eligible schemes":(e==null?void 0:e.role)==="officer"?"district operations":"state policy decisions"]}),F.jsxs("div",{className:"flex items-center space-x-2 mt-3",children:[F.jsxs(Hd,{className:"bg-primary text-primary-foreground",children:[(u=e==null?void 0:e.role)==null?void 0:u.toUpperCase()," DASHBOARD"]}),F.jsx("span",{className:"text-sm text-muted-foreground",children:(e==null?void 0:e.role)==="user"?`Village: ${e==null?void 0:e.district}`:(e==null?void 0:e.role)==="officer"?`District: ${e==null?void 0:e.district}`:`State: ${e==null?void 0:e.state}`})]})]}),(e==null?void 0:e.role)==="user"&&F.jsxs("div",{className:"space-y-6",children:[F.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[F.jsx(ci,{className:"text-center",children:F.jsxs(ui,{className:"p-6",children:[F.jsx(Yd,{className:"w-8 h-8 text-success mx-auto mb-3"}),F.jsx("h3",{className:"font-semibold mb-1",children:"Eligible Schemes"}),F.jsx("p",{className:"text-2xl font-bold text-success",children:"3"})]})}),F.jsx(ci,{className:"text-center",children:F.jsxs(ui,{className:"p-6",children:[F.jsx(wE,{className:"w-8 h-8 text-primary mx-auto mb-3"}),F.jsx("h3",{className:"font-semibold mb-1",children:"Total Benefits"}),F.jsx("p",{className:"text-2xl font-bold text-primary",children:"₹6,000+"})]})}),F.jsx(ci,{className:"text-center",children:F.jsxs(ui,{className:"p-6",children:[F.jsx(ej,{className:"w-8 h-8 text-warning mx-auto mb-3"}),F.jsx("h3",{className:"font-semibold mb-1",children:"Pending Applications"}),F.jsx("p",{className:"text-2xl font-bold text-warning",children:"1"})]})})]}),r.map(d=>{const m=d.icon;return F.jsxs(ci,{children:[F.jsx(oo,{children:F.jsxs("div",{className:"flex items-start justify-between",children:[F.jsxs("div",{className:"flex items-center space-x-3",children:[F.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center",children:F.jsx(m,{className:"w-6 h-6 text-primary"})}),F.jsxs("div",{children:[F.jsxs(ao,{className:"flex items-center space-x-2",children:[F.jsx("span",{children:d.title}),F.jsx(Hd,{className:o(d.priority),children:d.priority.toUpperCase()})]}),F.jsx(Fc,{children:d.scheme})]})]}),F.jsx(Hd,{className:s(d.eligibility),children:d.eligibility.toUpperCase()})]})}),F.jsxs(ui,{className:"space-y-4",children:[F.jsx("p",{className:"text-muted-foreground",children:d.description}),F.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[F.jsxs("div",{children:[F.jsx("h4",{className:"font-semibold mb-3",children:"Application Steps:"}),F.jsx("ol",{className:"space-y-2",children:d.steps.map((g,_)=>F.jsxs("li",{className:"flex items-start space-x-2",children:[F.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-xs font-medium",children:_+1}),F.jsx("span",{className:"text-sm",children:g})]},_))})]}),F.jsxs("div",{className:"space-y-4",children:[F.jsxs("div",{children:[F.jsx("h4",{className:"font-semibold mb-2",children:"Benefits:"}),F.jsx("p",{className:"text-sm bg-success/10 text-success-foreground p-3 rounded-lg",children:d.benefits})]}),F.jsxs("div",{children:[F.jsx("h4",{className:"font-semibold mb-2",children:"Deadline:"}),F.jsx("p",{className:"text-sm font-medium",children:d.deadline})]}),F.jsxs(iu,{className:"w-full",children:["Apply Now",F.jsx(uge,{className:"w-4 h-4 ml-2"})]})]})]})]})]},d.id)})]}),((e==null?void 0:e.role)==="officer"||(e==null?void 0:e.role)==="admin")&&F.jsx("div",{className:"space-y-6",children:a.map(d=>{const m=d.icon;return F.jsxs(ci,{children:[F.jsx(oo,{children:F.jsxs("div",{className:"flex items-start justify-between",children:[F.jsxs("div",{className:"flex items-center space-x-3",children:[F.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center",children:F.jsx(m,{className:"w-6 h-6 text-primary"})}),F.jsx("div",{children:F.jsxs(ao,{className:"flex items-center space-x-2",children:[F.jsx("span",{children:d.title}),F.jsx(Hd,{className:o(d.priority),children:d.priority.toUpperCase()})]})})]}),F.jsx(iu,{variant:"outline",size:"sm",children:"Implement"})]})}),F.jsxs(ui,{className:"space-y-4",children:[F.jsx("p",{className:"text-muted-foreground",children:d.description}),(e==null?void 0:e.role)==="officer"&&d.metrics&&F.jsxs("div",{className:"grid grid-cols-3 gap-4 p-4 bg-muted/50 rounded-lg",children:[F.jsxs("div",{className:"text-center",children:[F.jsx("div",{className:"font-bold text-lg",children:d.metrics.current}),F.jsx("div",{className:"text-sm text-muted-foreground",children:"Current"})]}),F.jsxs("div",{className:"text-center",children:[F.jsx("div",{className:"font-bold text-lg text-success",children:d.metrics.target}),F.jsx("div",{className:"text-sm text-muted-foreground",children:"Target"})]}),F.jsxs("div",{className:"text-center",children:[F.jsx("div",{className:"font-bold text-lg text-primary",children:d.metrics.deadline}),F.jsx("div",{className:"text-sm text-muted-foreground",children:"Timeline"})]})]}),(e==null?void 0:e.role)==="admin"&&d.impact&&F.jsxs("div",{className:"grid grid-cols-3 gap-4 p-4 bg-primary/5 rounded-lg",children:[F.jsxs("div",{className:"text-center",children:[F.jsx("div",{className:"font-bold text-lg text-primary",children:d.impact.beneficiaries||d.impact.districts}),F.jsx("div",{className:"text-sm text-muted-foreground",children:d.impact.beneficiaries?"Beneficiaries":"Districts"})]}),F.jsxs("div",{className:"text-center",children:[F.jsx("div",{className:"font-bold text-lg text-success",children:d.impact.efficiency}),F.jsx("div",{className:"text-sm text-muted-foreground",children:"Efficiency Gain"})]}),F.jsxs("div",{className:"text-center",children:[F.jsx("div",{className:"font-bold text-lg text-warning",children:d.impact.cost||d.impact.allocation}),F.jsx("div",{className:"text-sm text-muted-foreground",children:d.impact.cost?"Cost Impact":"Budget"})]})]}),F.jsxs("div",{children:[F.jsx("h4",{className:"font-semibold mb-3",children:"Recommended Actions:"}),F.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:(d.actions||d.policies||d.allocations||d.modules||[]).map((g,_)=>F.jsxs("div",{className:"flex items-center space-x-2 p-3 border border-border rounded-lg",children:[F.jsx(Yd,{className:"w-4 h-4 text-success"}),F.jsx("span",{className:"text-sm",children:g})]},_))})]})]})]},d.id)})})]})})};var kk="Checkbox",[cXe,zet]=Bh(kk),[uXe,QF]=cXe(kk);function dXe(e){const{__scopeCheckbox:t,checked:r,children:n,defaultChecked:i,disabled:o,form:s,name:a,onCheckedChange:u,required:d,value:m="on",internal_do_not_use_render:g}=e,[_,y]=s0({prop:r,defaultProp:i??!1,onChange:u,caller:kk}),[M,x]=oe.useState(null),[E,T]=oe.useState(null),P=oe.useRef(!1),C=M?!!s||!!M.closest("form"):!0,D={checked:_,disabled:o,setChecked:y,control:M,setControl:x,name:a,form:s,value:m,hasConsumerStoppedPropagationRef:P,required:d,defaultChecked:g_(i)?!1:i,isFormControl:C,bubbleInput:E,setBubbleInput:T};return F.jsx(uXe,{scope:t,...D,children:hXe(g)?g(D):n})}var sde="CheckboxTrigger",lde=oe.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:r,...n},i)=>{const{control:o,value:s,disabled:a,checked:u,required:d,setControl:m,setChecked:g,hasConsumerStoppedPropagationRef:_,isFormControl:y,bubbleInput:M}=QF(sde,e),x=ea(i,m),E=oe.useRef(u);return oe.useEffect(()=>{const T=o==null?void 0:o.form;if(T){const P=()=>g(E.current);return T.addEventListener("reset",P),()=>T.removeEventListener("reset",P)}},[o,g]),F.jsx(Ei.button,{type:"button",role:"checkbox","aria-checked":g_(u)?"mixed":u,"aria-required":d,"data-state":fde(u),"data-disabled":a?"":void 0,disabled:a,value:s,...n,ref:x,onKeyDown:In(t,T=>{T.key==="Enter"&&T.preventDefault()}),onClick:In(r,T=>{g(P=>g_(P)?!0:!P),M&&y&&(_.current=T.isPropagationStopped(),_.current||T.stopPropagation())})})});lde.displayName=sde;var JF=oe.forwardRef((e,t)=>{const{__scopeCheckbox:r,name:n,checked:i,defaultChecked:o,required:s,disabled:a,value:u,onCheckedChange:d,form:m,...g}=e;return F.jsx(dXe,{__scopeCheckbox:r,checked:i,defaultChecked:o,disabled:a,required:s,onCheckedChange:d,name:n,form:m,value:u,internal_do_not_use_render:({isFormControl:_})=>F.jsxs(F.Fragment,{children:[F.jsx(lde,{...g,ref:t,__scopeCheckbox:r}),_&&F.jsx(hde,{__scopeCheckbox:r})]})})});JF.displayName=kk;var cde="CheckboxIndicator",ude=oe.forwardRef((e,t)=>{const{__scopeCheckbox:r,forceMount:n,...i}=e,o=QF(cde,r);return F.jsx(Hf,{present:n||g_(o.checked)||o.checked===!0,children:F.jsx(Ei.span,{"data-state":fde(o.checked),"data-disabled":o.disabled?"":void 0,...i,ref:t,style:{pointerEvents:"none",...e.style}})})});ude.displayName=cde;var dde="CheckboxBubbleInput",hde=oe.forwardRef(({__scopeCheckbox:e,...t},r)=>{const{control:n,hasConsumerStoppedPropagationRef:i,checked:o,defaultChecked:s,required:a,disabled:u,name:d,value:m,form:g,bubbleInput:_,setBubbleInput:y}=QF(dde,e),M=ea(r,y),x=Mue(o),E=MQ(n);oe.useEffect(()=>{const P=_;if(!P)return;const C=window.HTMLInputElement.prototype,L=Object.getOwnPropertyDescriptor(C,"checked").set,N=!i.current;if(x!==o&&L){const j=new Event("click",{bubbles:N});P.indeterminate=g_(o),L.call(P,g_(o)?!1:o),P.dispatchEvent(j)}},[_,x,o,i]);const T=oe.useRef(g_(o)?!1:o);return F.jsx(Ei.input,{type:"checkbox","aria-hidden":!0,defaultChecked:s??T.current,required:a,disabled:u,name:d,value:m,form:g,...t,tabIndex:-1,ref:M,style:{...t.style,...E,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});hde.displayName=dde;function hXe(e){return typeof e=="function"}function g_(e){return e==="indeterminate"}function fde(e){return g_(e)?"indeterminate":e?"checked":"unchecked"}const NN=oe.forwardRef(({className:e,...t},r)=>F.jsx(JF,{ref:r,className:_i("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:F.jsx(ude,{className:_i("flex items-center justify-center text-current"),children:F.jsx(J4,{className:"h-4 w-4"})})}));NN.displayName=JF.displayName;const fXe="modulepreload",pXe=function(e){return"/forest_right_portal.github.io/"+e},CH={},AO=function(t,r,n){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),a=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));i=Promise.allSettled(r.map(u=>{if(u=pXe(u),u in CH)return;CH[u]=!0;const d=u.endsWith(".css"),m=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${m}`))return;const g=document.createElement("link");if(g.rel=d?"stylesheet":fXe,d||(g.as="script"),g.crossOrigin="",g.href=u,a&&g.setAttribute("nonce",a),document.head.appendChild(g),d)return new Promise((_,y)=>{g.addEventListener("load",_),g.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${u}`)))})}))}function o(s){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s}return i.then(s=>{for(const a of s||[])a.status==="rejected"&&o(a.reason);return t().catch(o)})};function Ma(e){"@babel/helpers - typeof";return Ma=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ma(e)}var qf=Uint8Array,Kd=Uint16Array,ez=Int32Array,tz=new qf([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),rz=new qf([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),kH=new qf([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),pde=function(e,t){for(var r=new Kd(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var i=new ez(r[30]),n=1;n<30;++n)for(var o=r[n];o<r[n+1];++o)i[o]=o-r[n]<<5|n;return{b:r,r:i}},mde=pde(tz,2),mXe=mde.b,jN=mde.r;mXe[28]=258,jN[258]=28;var gXe=pde(rz,0),IH=gXe.r,RN=new Kd(32768);for(var bs=0;bs<32768;++bs){var Ig=(bs&43690)>>1|(bs&21845)<<1;Ig=(Ig&52428)>>2|(Ig&13107)<<2,Ig=(Ig&61680)>>4|(Ig&3855)<<4,RN[bs]=((Ig&65280)>>8|(Ig&255)<<8)>>1}var S2=function(e,t,r){for(var n=e.length,i=0,o=new Kd(t);i<n;++i)e[i]&&++o[e[i]-1];var s=new Kd(t);for(i=1;i<t;++i)s[i]=s[i-1]+o[i-1]<<1;var a;if(r){a=new Kd(1<<t);var u=15-t;for(i=0;i<n;++i)if(e[i])for(var d=i<<4|e[i],m=t-e[i],g=s[e[i]-1]++<<m,_=g|(1<<m)-1;g<=_;++g)a[RN[g]>>u]=d}else for(a=new Kd(n),i=0;i<n;++i)e[i]&&(a[i]=RN[s[e[i]-1]++]>>15-e[i]);return a},S0=new qf(288);for(var bs=0;bs<144;++bs)S0[bs]=8;for(var bs=144;bs<256;++bs)S0[bs]=9;for(var bs=256;bs<280;++bs)S0[bs]=7;for(var bs=280;bs<288;++bs)S0[bs]=8;var GC=new qf(32);for(var bs=0;bs<32;++bs)GC[bs]=5;var _Xe=S2(S0,9,0),yXe=S2(GC,5,0),gde=function(e){return(e+7)/8|0},vXe=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new qf(e.subarray(t,r))},xm=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},jw=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},CO=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var i=r.length,o=r.slice();if(!i)return{t:yde,l:0};if(i==1){var s=new qf(r[0].s+1);return s[r[0].s]=1,{t:s,l:1}}r.sort(function(L,N){return L.f-N.f}),r.push({s:-1,f:25001});var a=r[0],u=r[1],d=0,m=1,g=2;for(r[0]={s:-1,f:a.f+u.f,l:a,r:u};m!=i-1;)a=r[r[d].f<r[g].f?d++:g++],u=r[d!=m&&r[d].f<r[g].f?d++:g++],r[m++]={s:-1,f:a.f+u.f,l:a,r:u};for(var _=o[0].s,n=1;n<i;++n)o[n].s>_&&(_=o[n].s);var y=new Kd(_+1),M=FN(r[m-1],y,0);if(M>t){var n=0,x=0,E=M-t,T=1<<E;for(o.sort(function(N,j){return y[j.s]-y[N.s]||N.f-j.f});n<i;++n){var P=o[n].s;if(y[P]>t)x+=T-(1<<M-y[P]),y[P]=t;else break}for(x>>=E;x>0;){var C=o[n].s;y[C]<t?x-=1<<t-y[C]++-1:++n}for(;n>=0&&x;--n){var D=o[n].s;y[D]==t&&(--y[D],++x)}M=t}return{t:new qf(y),l:M}},FN=function(e,t,r){return e.s==-1?Math.max(FN(e.l,t,r+1),FN(e.r,t,r+1)):t[e.s]=r},OH=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new Kd(++t),n=0,i=e[0],o=1,s=function(u){r[n++]=u},a=1;a<=t;++a)if(e[a]==i&&a!=t)++o;else{if(!i&&o>2){for(;o>138;o-=138)s(32754);o>2&&(s(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(s(i),--o;o>6;o-=6)s(8304);o>2&&(s(o-3<<5|8208),o=0)}for(;o--;)s(i);o=1,i=e[a]}return{c:r.subarray(0,n),n:t}},Rw=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},_de=function(e,t,r){var n=r.length,i=gde(t+2);e[i]=n&255,e[i+1]=n>>8,e[i+2]=e[i]^255,e[i+3]=e[i+1]^255;for(var o=0;o<n;++o)e[i+o+4]=r[o];return(i+4+n)*8},LH=function(e,t,r,n,i,o,s,a,u,d,m){xm(t,m++,r),++i[256];for(var g=CO(i,15),_=g.t,y=g.l,M=CO(o,15),x=M.t,E=M.l,T=OH(_),P=T.c,C=T.n,D=OH(x),L=D.c,N=D.n,j=new Kd(19),$=0;$<P.length;++$)++j[P[$]&31];for(var $=0;$<L.length;++$)++j[L[$]&31];for(var U=CO(j,7),G=U.t,H=U.l,X=19;X>4&&!G[kH[X-1]];--X);var ee=d+5<<3,ae=Rw(i,S0)+Rw(o,GC)+s,de=Rw(i,_)+Rw(o,x)+s+14+3*X+Rw(j,G)+2*j[16]+3*j[17]+7*j[18];if(u>=0&&ee<=ae&&ee<=de)return _de(t,m,e.subarray(u,u+d));var ye,_e,ue,fe;if(xm(t,m,1+(de<ae)),m+=2,de<ae){ye=S2(_,y,0),_e=_,ue=S2(x,E,0),fe=x;var De=S2(G,H,0);xm(t,m,C-257),xm(t,m+5,N-1),xm(t,m+10,X-4),m+=14;for(var $=0;$<X;++$)xm(t,m+3*$,G[kH[$]]);m+=3*X;for(var pe=[P,L],K=0;K<2;++K)for(var te=pe[K],$=0;$<te.length;++$){var ve=te[$]&31;xm(t,m,De[ve]),m+=G[ve],ve>15&&(xm(t,m,te[$]>>5&127),m+=te[$]>>12)}}else ye=_Xe,_e=S0,ue=yXe,fe=GC;for(var $=0;$<a;++$){var $e=n[$];if($e>255){var ve=$e>>18&31;jw(t,m,ye[ve+257]),m+=_e[ve+257],ve>7&&(xm(t,m,$e>>23&31),m+=tz[ve]);var Ce=$e&31;jw(t,m,ue[Ce]),m+=fe[Ce],Ce>3&&(jw(t,m,$e>>5&8191),m+=rz[Ce])}else jw(t,m,ye[$e]),m+=_e[$e]}return jw(t,m,ye[256]),m+_e[256]},bXe=new ez([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),yde=new qf(0),xXe=function(e,t,r,n,i,o){var s=o.z||e.length,a=new qf(n+s+5*(1+Math.ceil(s/7e3))+i),u=a.subarray(n,a.length-i),d=o.l,m=(o.r||0)&7;if(t){m&&(u[0]=o.r>>3);for(var g=bXe[t-1],_=g>>13,y=g&8191,M=(1<<r)-1,x=o.p||new Kd(32768),E=o.h||new Kd(M+1),T=Math.ceil(r/3),P=2*T,C=function(Xe){return(e[Xe]^e[Xe+1]<<T^e[Xe+2]<<P)&M},D=new ez(25e3),L=new Kd(288),N=new Kd(32),j=0,$=0,U=o.i||0,G=0,H=o.w||0,X=0;U+2<s;++U){var ee=C(U),ae=U&32767,de=E[ee];if(x[ae]=de,E[ee]=ae,H<=U){var ye=s-U;if((j>7e3||G>24576)&&(ye>423||!d)){m=LH(e,u,0,D,L,N,$,G,X,U-X,m),G=j=$=0,X=U;for(var _e=0;_e<286;++_e)L[_e]=0;for(var _e=0;_e<30;++_e)N[_e]=0}var ue=2,fe=0,De=y,pe=ae-de&32767;if(ye>2&&ee==C(U-pe))for(var K=Math.min(_,ye)-1,te=Math.min(32767,U),ve=Math.min(258,ye);pe<=te&&--De&&ae!=de;){if(e[U+ue]==e[U+ue-pe]){for(var $e=0;$e<ve&&e[U+$e]==e[U+$e-pe];++$e);if($e>ue){if(ue=$e,fe=pe,$e>K)break;for(var Ce=Math.min(pe,$e-2),Ge=0,_e=0;_e<Ce;++_e){var ot=U-pe+_e&32767,Ye=x[ot],et=ot-Ye&32767;et>Ge&&(Ge=et,de=ot)}}}ae=de,de=x[ae],pe+=ae-de&32767}if(fe){D[G++]=268435456|jN[ue]<<18|IH[fe];var Te=jN[ue]&31,Le=IH[fe]&31;$+=tz[Te]+rz[Le],++L[257+Te],++N[Le],H=U+ue,++j}else D[G++]=e[U],++L[e[U]]}}for(U=Math.max(U,H);U<s;++U)D[G++]=e[U],++L[e[U]];m=LH(e,u,d,D,L,N,$,G,X,U-X,m),d||(o.r=m&7|u[m/8|0]<<3,m-=7,o.h=E,o.p=x,o.i=U,o.w=H)}else{for(var U=o.w||0;U<s+d;U+=65535){var ke=U+65535;ke>=s&&(u[m/8|0]=d,ke=s),m=_de(u,m+1,e.subarray(U,ke))}o.i=s}return vXe(a,0,n+gde(m)+i)},vde=function(){var e=1,t=0;return{p:function(r){for(var n=e,i=t,o=r.length|0,s=0;s!=o;){for(var a=Math.min(s+2655,o);s<a;++s)i+=n+=r[s];n=(n&65535)+15*(n>>16),i=(i&65535)+15*(i>>16)}e=n,t=i},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},wXe=function(e,t,r,n,i){if(!i&&(i={l:1},t.dictionary)){var o=t.dictionary.subarray(-32768),s=new qf(o.length+e.length);s.set(o),s.set(e,o.length),e=s,i.w=o.length}return xXe(e,t.level==null?6:t.level,t.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,i)},bde=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},MXe=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var i=vde();i.p(t.dictionary),bde(e,2,i.d())}};function zN(e,t){t||(t={});var r=vde();r.p(e);var n=wXe(e,t,t.dictionary?6:2,4);return MXe(n,t),bde(n,n.length-4,r.d()),n}var SXe=typeof TextDecoder<"u"&&new TextDecoder,TXe=0;try{SXe.decode(yde,{stream:!0}),TXe=1}catch{}function PXe(e){if(Array.isArray(e))return e}function EXe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],u=!0,d=!1;try{if(o=(r=r.call(e)).next,t!==0)for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);u=!0);}catch(m){d=!0,i=m}finally{try{if(!u&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw i}}return a}}function DH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function AXe(e,t){if(e){if(typeof e=="string")return DH(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?DH(e,t):void 0}}function CXe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $H(e,t){return PXe(e)||EXe(e,t)||AXe(e,t)||CXe()}function NH(e,t="utf8"){return new TextDecoder(t).decode(e)}const kXe=new TextEncoder;function IXe(e){return kXe.encode(e)}const OXe=1024*8,LXe=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),kO={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class nz{constructor(t=OXe,r={}){_t(this,"buffer");_t(this,"byteLength");_t(this,"byteOffset");_t(this,"length");_t(this,"offset");_t(this,"lastWrittenByte");_t(this,"littleEndian");_t(this,"_data");_t(this,"_mark");_t(this,"_marks");let n=!1;typeof t=="number"?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const i=r.offset?r.offset>>>0:0,o=t.byteLength-i;let s=i;(ArrayBuffer.isView(t)||t instanceof nz)&&(t.byteLength!==t.buffer.byteLength&&(s=t.byteOffset+i),t=t.buffer),n?this.lastWrittenByte=o:this.lastWrittenByte=0,this.buffer=t,this.length=o,this.byteLength=o,this.byteOffset=s,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,s,o),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const n=(this.offset+t)*2,i=new Uint8Array(n);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const n=kO[r].BYTES_PER_ELEMENT*t,i=this.byteOffset+this.offset,o=this.buffer.slice(i,i+n);if(this.littleEndian===LXe&&r!=="uint8"&&r!=="int8"){const a=new Uint8Array(this.buffer.slice(i,i+n));a.reverse();const u=new kO[r](a.buffer);return this.offset+=n,u.reverse(),u}const s=new kO[r](o);return this.offset+=n,s}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let n=0;n<t;n++)r+=this.readChar();return r}readUtf8(t=1){return NH(this.readBytes(t))}decodeText(t=1,r="utf8"){return NH(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(IXe(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const DXe=4,jH=0,RH=1,$Xe=2;function rx(e){let t=e.length;for(;--t>=0;)e[t]=0}const NXe=0,xde=1,jXe=2,RXe=3,FXe=258,iz=29,CS=256,KM=CS+1+iz,P1=30,oz=19,wde=2*KM+1,Ry=15,IO=16,zXe=7,az=256,Mde=16,Sde=17,Tde=18,BN=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),NE=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),BXe=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Pde=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),UXe=512,Em=new Array((KM+2)*2);rx(Em);const T2=new Array(P1*2);rx(T2);const ZM=new Array(UXe);rx(ZM);const XM=new Array(FXe-RXe+1);rx(XM);const sz=new Array(iz);rx(sz);const qC=new Array(P1);rx(qC);function OO(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}let Ede,Ade,Cde;function LO(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}const kde=e=>e<256?ZM[e]:ZM[256+(e>>>7)],YM=(e,t)=>{e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255},hd=(e,t,r)=>{e.bi_valid>IO-r?(e.bi_buf|=t<<e.bi_valid&65535,YM(e,e.bi_buf),e.bi_buf=t>>IO-e.bi_valid,e.bi_valid+=r-IO):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},kp=(e,t,r)=>{hd(e,r[t*2],r[t*2+1])},Ide=(e,t)=>{let r=0;do r|=e&1,e>>>=1,r<<=1;while(--t>0);return r>>>1},VXe=e=>{e.bi_valid===16?(YM(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},WXe=(e,t)=>{const r=t.dyn_tree,n=t.max_code,i=t.stat_desc.static_tree,o=t.stat_desc.has_stree,s=t.stat_desc.extra_bits,a=t.stat_desc.extra_base,u=t.stat_desc.max_length;let d,m,g,_,y,M,x=0;for(_=0;_<=Ry;_++)e.bl_count[_]=0;for(r[e.heap[e.heap_max]*2+1]=0,d=e.heap_max+1;d<wde;d++)m=e.heap[d],_=r[r[m*2+1]*2+1]+1,_>u&&(_=u,x++),r[m*2+1]=_,!(m>n)&&(e.bl_count[_]++,y=0,m>=a&&(y=s[m-a]),M=r[m*2],e.opt_len+=M*(_+y),o&&(e.static_len+=M*(i[m*2+1]+y)));if(x!==0){do{for(_=u-1;e.bl_count[_]===0;)_--;e.bl_count[_]--,e.bl_count[_+1]+=2,e.bl_count[u]--,x-=2}while(x>0);for(_=u;_!==0;_--)for(m=e.bl_count[_];m!==0;)g=e.heap[--d],!(g>n)&&(r[g*2+1]!==_&&(e.opt_len+=(_-r[g*2+1])*r[g*2],r[g*2+1]=_),m--)}},Ode=(e,t,r)=>{const n=new Array(Ry+1);let i=0,o,s;for(o=1;o<=Ry;o++)i=i+r[o-1]<<1,n[o]=i;for(s=0;s<=t;s++){let a=e[s*2+1];a!==0&&(e[s*2]=Ide(n[a]++,a))}},GXe=()=>{let e,t,r,n,i;const o=new Array(Ry+1);for(r=0,n=0;n<iz-1;n++)for(sz[n]=r,e=0;e<1<<BN[n];e++)XM[r++]=n;for(XM[r-1]=n,i=0,n=0;n<16;n++)for(qC[n]=i,e=0;e<1<<NE[n];e++)ZM[i++]=n;for(i>>=7;n<P1;n++)for(qC[n]=i<<7,e=0;e<1<<NE[n]-7;e++)ZM[256+i++]=n;for(t=0;t<=Ry;t++)o[t]=0;for(e=0;e<=143;)Em[e*2+1]=8,e++,o[8]++;for(;e<=255;)Em[e*2+1]=9,e++,o[9]++;for(;e<=279;)Em[e*2+1]=7,e++,o[7]++;for(;e<=287;)Em[e*2+1]=8,e++,o[8]++;for(Ode(Em,KM+1,o),e=0;e<P1;e++)T2[e*2+1]=5,T2[e*2]=Ide(e,5);Ede=new OO(Em,BN,CS+1,KM,Ry),Ade=new OO(T2,NE,0,P1,Ry),Cde=new OO(new Array(0),BXe,0,oz,zXe)},Lde=e=>{let t;for(t=0;t<KM;t++)e.dyn_ltree[t*2]=0;for(t=0;t<P1;t++)e.dyn_dtree[t*2]=0;for(t=0;t<oz;t++)e.bl_tree[t*2]=0;e.dyn_ltree[az*2]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},Dde=e=>{e.bi_valid>8?YM(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},FH=(e,t,r,n)=>{const i=t*2,o=r*2;return e[i]<e[o]||e[i]===e[o]&&n[t]<=n[r]},DO=(e,t,r)=>{const n=e.heap[r];let i=r<<1;for(;i<=e.heap_len&&(i<e.heap_len&&FH(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!FH(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n},zH=(e,t,r)=>{let n,i,o=0,s,a;if(e.sym_next!==0)do n=e.pending_buf[e.sym_buf+o++]&255,n+=(e.pending_buf[e.sym_buf+o++]&255)<<8,i=e.pending_buf[e.sym_buf+o++],n===0?kp(e,i,t):(s=XM[i],kp(e,s+CS+1,t),a=BN[s],a!==0&&(i-=sz[s],hd(e,i,a)),n--,s=kde(n),kp(e,s,r),a=NE[s],a!==0&&(n-=qC[s],hd(e,n,a)));while(o<e.sym_next);kp(e,az,t)},UN=(e,t)=>{const r=t.dyn_tree,n=t.stat_desc.static_tree,i=t.stat_desc.has_stree,o=t.stat_desc.elems;let s,a,u=-1,d;for(e.heap_len=0,e.heap_max=wde,s=0;s<o;s++)r[s*2]!==0?(e.heap[++e.heap_len]=u=s,e.depth[s]=0):r[s*2+1]=0;for(;e.heap_len<2;)d=e.heap[++e.heap_len]=u<2?++u:0,r[d*2]=1,e.depth[d]=0,e.opt_len--,i&&(e.static_len-=n[d*2+1]);for(t.max_code=u,s=e.heap_len>>1;s>=1;s--)DO(e,r,s);d=o;do s=e.heap[1],e.heap[1]=e.heap[e.heap_len--],DO(e,r,1),a=e.heap[1],e.heap[--e.heap_max]=s,e.heap[--e.heap_max]=a,r[d*2]=r[s*2]+r[a*2],e.depth[d]=(e.depth[s]>=e.depth[a]?e.depth[s]:e.depth[a])+1,r[s*2+1]=r[a*2+1]=d,e.heap[1]=d++,DO(e,r,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],WXe(e,t),Ode(r,u,e.bl_count)},BH=(e,t,r)=>{let n,i=-1,o,s=t[0*2+1],a=0,u=7,d=4;for(s===0&&(u=138,d=3),t[(r+1)*2+1]=65535,n=0;n<=r;n++)o=s,s=t[(n+1)*2+1],!(++a<u&&o===s)&&(a<d?e.bl_tree[o*2]+=a:o!==0?(o!==i&&e.bl_tree[o*2]++,e.bl_tree[Mde*2]++):a<=10?e.bl_tree[Sde*2]++:e.bl_tree[Tde*2]++,a=0,i=o,s===0?(u=138,d=3):o===s?(u=6,d=3):(u=7,d=4))},UH=(e,t,r)=>{let n,i=-1,o,s=t[0*2+1],a=0,u=7,d=4;for(s===0&&(u=138,d=3),n=0;n<=r;n++)if(o=s,s=t[(n+1)*2+1],!(++a<u&&o===s)){if(a<d)do kp(e,o,e.bl_tree);while(--a!==0);else o!==0?(o!==i&&(kp(e,o,e.bl_tree),a--),kp(e,Mde,e.bl_tree),hd(e,a-3,2)):a<=10?(kp(e,Sde,e.bl_tree),hd(e,a-3,3)):(kp(e,Tde,e.bl_tree),hd(e,a-11,7));a=0,i=o,s===0?(u=138,d=3):o===s?(u=6,d=3):(u=7,d=4)}},qXe=e=>{let t;for(BH(e,e.dyn_ltree,e.l_desc.max_code),BH(e,e.dyn_dtree,e.d_desc.max_code),UN(e,e.bl_desc),t=oz-1;t>=3&&e.bl_tree[Pde[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t},HXe=(e,t,r,n)=>{let i;for(hd(e,t-257,5),hd(e,r-1,5),hd(e,n-4,4),i=0;i<n;i++)hd(e,e.bl_tree[Pde[i]*2+1],3);UH(e,e.dyn_ltree,t-1),UH(e,e.dyn_dtree,r-1)},KXe=e=>{let t=4093624447,r;for(r=0;r<=31;r++,t>>>=1)if(t&1&&e.dyn_ltree[r*2]!==0)return jH;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return RH;for(r=32;r<CS;r++)if(e.dyn_ltree[r*2]!==0)return RH;return jH};let VH=!1;const ZXe=e=>{VH||(GXe(),VH=!0),e.l_desc=new LO(e.dyn_ltree,Ede),e.d_desc=new LO(e.dyn_dtree,Ade),e.bl_desc=new LO(e.bl_tree,Cde),e.bi_buf=0,e.bi_valid=0,Lde(e)},$de=(e,t,r,n)=>{hd(e,(NXe<<1)+(n?1:0),3),Dde(e),YM(e,r),YM(e,~r),r&&e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r},XXe=e=>{hd(e,xde<<1,3),kp(e,az,Em),VXe(e)},YXe=(e,t,r,n)=>{let i,o,s=0;e.level>0?(e.strm.data_type===$Xe&&(e.strm.data_type=KXe(e)),UN(e,e.l_desc),UN(e,e.d_desc),s=qXe(e),i=e.opt_len+3+7>>>3,o=e.static_len+3+7>>>3,o<=i&&(i=o)):i=o=r+5,r+4<=i&&t!==-1?$de(e,t,r,n):e.strategy===DXe||o===i?(hd(e,(xde<<1)+(n?1:0),3),zH(e,Em,T2)):(hd(e,(jXe<<1)+(n?1:0),3),HXe(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),zH(e,e.dyn_ltree,e.dyn_dtree)),Lde(e),n&&Dde(e)},QXe=(e,t,r)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=r,t===0?e.dyn_ltree[r*2]++:(e.matches++,t--,e.dyn_ltree[(XM[r]+CS+1)*2]++,e.dyn_dtree[kde(t)*2]++),e.sym_next===e.sym_end);var JXe=ZXe,eYe=$de,tYe=YXe,rYe=QXe,nYe=XXe,iYe={_tr_init:JXe,_tr_stored_block:eYe,_tr_flush_block:tYe,_tr_tally:rYe,_tr_align:nYe};const oYe=(e,t,r,n)=>{let i=e&65535|0,o=e>>>16&65535|0,s=0;for(;r!==0;){s=r>2e3?2e3:r,r-=s;do i=i+t[n++]|0,o=o+i|0;while(--s);i%=65521,o%=65521}return i|o<<16|0};var QM=oYe;const aYe=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},sYe=new Uint32Array(aYe()),lYe=(e,t,r,n)=>{const i=sYe,o=n+r;e^=-1;for(let s=n;s<o;s++)e=e>>>8^i[(e^t[s])&255];return e^-1};var Dc=lYe,Tb={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},kS={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:cYe,_tr_stored_block:VN,_tr_flush_block:uYe,_tr_tally:__,_tr_align:dYe}=iYe,{Z_NO_FLUSH:y_,Z_PARTIAL_FLUSH:hYe,Z_FULL_FLUSH:fYe,Z_FINISH:Ch,Z_BLOCK:WH,Z_OK:ru,Z_STREAM_END:GH,Z_STREAM_ERROR:Gp,Z_DATA_ERROR:pYe,Z_BUF_ERROR:$O,Z_DEFAULT_COMPRESSION:mYe,Z_FILTERED:gYe,Z_HUFFMAN_ONLY:QP,Z_RLE:_Ye,Z_FIXED:yYe,Z_DEFAULT_STRATEGY:vYe,Z_UNKNOWN:bYe,Z_DEFLATED:Ik}=kS,xYe=9,wYe=15,MYe=8,SYe=29,TYe=256,WN=TYe+1+SYe,PYe=30,EYe=19,AYe=2*WN+1,CYe=15,Bo=3,i_=258,qp=i_+Bo+1,kYe=32,Pb=42,lz=57,GN=69,qN=73,HN=91,KN=103,Fy=113,Jw=666,Gu=1,nx=2,T0=3,ix=4,IYe=3,zy=(e,t)=>(e.msg=Tb[t],t),qH=e=>e*2-(e>4?9:0),Hg=e=>{let t=e.length;for(;--t>=0;)e[t]=0},OYe=e=>{let t,r,n,i=e.w_size;t=e.hash_size,n=t;do r=e.head[--n],e.head[n]=r>=i?r-i:0;while(--t);t=i,n=t;do r=e.prev[--n],e.prev[n]=r>=i?r-i:0;while(--t)};let LYe=(e,t,r)=>(t<<e.hash_shift^r)&e.hash_mask,v_=LYe;const zd=e=>{const t=e.state;let r=t.pending;r>e.avail_out&&(r=e.avail_out),r!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,t.pending===0&&(t.pending_out=0))},Zd=(e,t)=>{uYe(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,zd(e.strm)},ha=(e,t)=>{e.pending_buf[e.pending++]=t},Fw=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255},ZN=(e,t,r,n)=>{let i=e.avail_in;return i>n&&(i=n),i===0?0:(e.avail_in-=i,t.set(e.input.subarray(e.next_in,e.next_in+i),r),e.state.wrap===1?e.adler=QM(e.adler,t,i,r):e.state.wrap===2&&(e.adler=Dc(e.adler,t,i,r)),e.next_in+=i,e.total_in+=i,i)},Nde=(e,t)=>{let r=e.max_chain_length,n=e.strstart,i,o,s=e.prev_length,a=e.nice_match;const u=e.strstart>e.w_size-qp?e.strstart-(e.w_size-qp):0,d=e.window,m=e.w_mask,g=e.prev,_=e.strstart+i_;let y=d[n+s-1],M=d[n+s];e.prev_length>=e.good_match&&(r>>=2),a>e.lookahead&&(a=e.lookahead);do if(i=t,!(d[i+s]!==M||d[i+s-1]!==y||d[i]!==d[n]||d[++i]!==d[n+1])){n+=2,i++;do;while(d[++n]===d[++i]&&d[++n]===d[++i]&&d[++n]===d[++i]&&d[++n]===d[++i]&&d[++n]===d[++i]&&d[++n]===d[++i]&&d[++n]===d[++i]&&d[++n]===d[++i]&&n<_);if(o=i_-(_-n),n=_-i_,o>s){if(e.match_start=t,s=o,o>=a)break;y=d[n+s-1],M=d[n+s]}}while((t=g[t&m])>u&&--r!==0);return s<=e.lookahead?s:e.lookahead},Eb=e=>{const t=e.w_size;let r,n,i;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-qp)&&(e.window.set(e.window.subarray(t,t+t-n),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),OYe(e),n+=t),e.strm.avail_in===0)break;if(r=ZN(e.strm,e.window,e.strstart+e.lookahead,n),e.lookahead+=r,e.lookahead+e.insert>=Bo)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=v_(e,e.ins_h,e.window[i+1]);e.insert&&(e.ins_h=v_(e,e.ins_h,e.window[i+Bo-1]),e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<Bo)););}while(e.lookahead<qp&&e.strm.avail_in!==0)},jde=(e,t)=>{let r=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,n,i,o,s=0,a=e.strm.avail_in;do{if(n=65535,o=e.bi_valid+42>>3,e.strm.avail_out<o||(o=e.strm.avail_out-o,i=e.strstart-e.block_start,n>i+e.strm.avail_in&&(n=i+e.strm.avail_in),n>o&&(n=o),n<r&&(n===0&&t!==Ch||t===y_||n!==i+e.strm.avail_in)))break;s=t===Ch&&n===i+e.strm.avail_in?1:0,VN(e,0,0,s),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,zd(e.strm),i&&(i>n&&(i=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+i),e.strm.next_out),e.strm.next_out+=i,e.strm.avail_out-=i,e.strm.total_out+=i,e.block_start+=i,n-=i),n&&(ZN(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(s===0);return a-=e.strm.avail_in,a&&(a>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=a&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-a,e.strm.next_in),e.strstart),e.strstart+=a,e.insert+=a>e.w_size-e.insert?e.w_size-e.insert:a),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),s?ix:t!==y_&&t!==Ch&&e.strm.avail_in===0&&e.strstart===e.block_start?nx:(o=e.window_size-e.strstart,e.strm.avail_in>o&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,o+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),o>e.strm.avail_in&&(o=e.strm.avail_in),o&&(ZN(e.strm,e.window,e.strstart,o),e.strstart+=o,e.insert+=o>e.w_size-e.insert?e.w_size-e.insert:o),e.high_water<e.strstart&&(e.high_water=e.strstart),o=e.bi_valid+42>>3,o=e.pending_buf_size-o>65535?65535:e.pending_buf_size-o,r=o>e.w_size?e.w_size:o,i=e.strstart-e.block_start,(i>=r||(i||t===Ch)&&t!==y_&&e.strm.avail_in===0&&i<=o)&&(n=i>o?o:i,s=t===Ch&&e.strm.avail_in===0&&n===i?1:0,VN(e,e.block_start,n,s),e.block_start+=n,zd(e.strm)),s?T0:Gu)},NO=(e,t)=>{let r,n;for(;;){if(e.lookahead<qp){if(Eb(e),e.lookahead<qp&&t===y_)return Gu;if(e.lookahead===0)break}if(r=0,e.lookahead>=Bo&&(e.ins_h=v_(e,e.ins_h,e.window[e.strstart+Bo-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),r!==0&&e.strstart-r<=e.w_size-qp&&(e.match_length=Nde(e,r)),e.match_length>=Bo)if(n=__(e,e.strstart-e.match_start,e.match_length-Bo),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=Bo){e.match_length--;do e.strstart++,e.ins_h=v_(e,e.ins_h,e.window[e.strstart+Bo-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=v_(e,e.ins_h,e.window[e.strstart+1]);else n=__(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(Zd(e,!1),e.strm.avail_out===0))return Gu}return e.insert=e.strstart<Bo-1?e.strstart:Bo-1,t===Ch?(Zd(e,!0),e.strm.avail_out===0?T0:ix):e.sym_next&&(Zd(e,!1),e.strm.avail_out===0)?Gu:nx},Iv=(e,t)=>{let r,n,i;for(;;){if(e.lookahead<qp){if(Eb(e),e.lookahead<qp&&t===y_)return Gu;if(e.lookahead===0)break}if(r=0,e.lookahead>=Bo&&(e.ins_h=v_(e,e.ins_h,e.window[e.strstart+Bo-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=Bo-1,r!==0&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-qp&&(e.match_length=Nde(e,r),e.match_length<=5&&(e.strategy===gYe||e.match_length===Bo&&e.strstart-e.match_start>4096)&&(e.match_length=Bo-1)),e.prev_length>=Bo&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-Bo,n=__(e,e.strstart-1-e.prev_match,e.prev_length-Bo),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=i&&(e.ins_h=v_(e,e.ins_h,e.window[e.strstart+Bo-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=Bo-1,e.strstart++,n&&(Zd(e,!1),e.strm.avail_out===0))return Gu}else if(e.match_available){if(n=__(e,0,e.window[e.strstart-1]),n&&Zd(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return Gu}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=__(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<Bo-1?e.strstart:Bo-1,t===Ch?(Zd(e,!0),e.strm.avail_out===0?T0:ix):e.sym_next&&(Zd(e,!1),e.strm.avail_out===0)?Gu:nx},DYe=(e,t)=>{let r,n,i,o;const s=e.window;for(;;){if(e.lookahead<=i_){if(Eb(e),e.lookahead<=i_&&t===y_)return Gu;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=Bo&&e.strstart>0&&(i=e.strstart-1,n=s[i],n===s[++i]&&n===s[++i]&&n===s[++i])){o=e.strstart+i_;do;while(n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&i<o);e.match_length=i_-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=Bo?(r=__(e,1,e.match_length-Bo),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=__(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(Zd(e,!1),e.strm.avail_out===0))return Gu}return e.insert=0,t===Ch?(Zd(e,!0),e.strm.avail_out===0?T0:ix):e.sym_next&&(Zd(e,!1),e.strm.avail_out===0)?Gu:nx},$Ye=(e,t)=>{let r;for(;;){if(e.lookahead===0&&(Eb(e),e.lookahead===0)){if(t===y_)return Gu;break}if(e.match_length=0,r=__(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(Zd(e,!1),e.strm.avail_out===0))return Gu}return e.insert=0,t===Ch?(Zd(e,!0),e.strm.avail_out===0?T0:ix):e.sym_next&&(Zd(e,!1),e.strm.avail_out===0)?Gu:nx};function wp(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}const e2=[new wp(0,0,0,0,jde),new wp(4,4,8,4,NO),new wp(4,5,16,8,NO),new wp(4,6,32,32,NO),new wp(4,4,16,16,Iv),new wp(8,16,32,32,Iv),new wp(8,16,128,128,Iv),new wp(8,32,128,256,Iv),new wp(32,128,258,1024,Iv),new wp(32,258,258,4096,Iv)],NYe=e=>{e.window_size=2*e.w_size,Hg(e.head),e.max_lazy_match=e2[e.level].max_lazy,e.good_match=e2[e.level].good_length,e.nice_match=e2[e.level].nice_length,e.max_chain_length=e2[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=Bo-1,e.match_available=0,e.ins_h=0};function jYe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Ik,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(AYe*2),this.dyn_dtree=new Uint16Array((2*PYe+1)*2),this.bl_tree=new Uint16Array((2*EYe+1)*2),Hg(this.dyn_ltree),Hg(this.dyn_dtree),Hg(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(CYe+1),this.heap=new Uint16Array(2*WN+1),Hg(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*WN+1),Hg(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const IS=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==Pb&&t.status!==lz&&t.status!==GN&&t.status!==qN&&t.status!==HN&&t.status!==KN&&t.status!==Fy&&t.status!==Jw?1:0},Rde=e=>{if(IS(e))return zy(e,Gp);e.total_in=e.total_out=0,e.data_type=bYe;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?lz:t.wrap?Pb:Fy,e.adler=t.wrap===2?0:1,t.last_flush=-2,cYe(t),ru},Fde=e=>{const t=Rde(e);return t===ru&&NYe(e.state),t},RYe=(e,t)=>IS(e)||e.state.wrap!==2?Gp:(e.state.gzhead=t,ru),zde=(e,t,r,n,i,o)=>{if(!e)return Gp;let s=1;if(t===mYe&&(t=6),n<0?(s=0,n=-n):n>15&&(s=2,n-=16),i<1||i>xYe||r!==Ik||n<8||n>15||t<0||t>9||o<0||o>yYe||n===8&&s!==1)return zy(e,Gp);n===8&&(n=9);const a=new jYe;return e.state=a,a.strm=e,a.status=Pb,a.wrap=s,a.gzhead=null,a.w_bits=n,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=i+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+Bo-1)/Bo),a.window=new Uint8Array(a.w_size*2),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<i+6,a.pending_buf_size=a.lit_bufsize*4,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=(a.lit_bufsize-1)*3,a.level=t,a.strategy=o,a.method=r,Fde(e)},FYe=(e,t)=>zde(e,t,Ik,wYe,MYe,vYe),zYe=(e,t)=>{if(IS(e)||t>WH||t<0)return e?zy(e,Gp):Gp;const r=e.state;if(!e.output||e.avail_in!==0&&!e.input||r.status===Jw&&t!==Ch)return zy(e,e.avail_out===0?$O:Gp);const n=r.last_flush;if(r.last_flush=t,r.pending!==0){if(zd(e),e.avail_out===0)return r.last_flush=-1,ru}else if(e.avail_in===0&&qH(t)<=qH(n)&&t!==Ch)return zy(e,$O);if(r.status===Jw&&e.avail_in!==0)return zy(e,$O);if(r.status===Pb&&r.wrap===0&&(r.status=Fy),r.status===Pb){let i=Ik+(r.w_bits-8<<4)<<8,o=-1;if(r.strategy>=QP||r.level<2?o=0:r.level<6?o=1:r.level===6?o=2:o=3,i|=o<<6,r.strstart!==0&&(i|=kYe),i+=31-i%31,Fw(r,i),r.strstart!==0&&(Fw(r,e.adler>>>16),Fw(r,e.adler&65535)),e.adler=1,r.status=Fy,zd(e),r.pending!==0)return r.last_flush=-1,ru}if(r.status===lz){if(e.adler=0,ha(r,31),ha(r,139),ha(r,8),r.gzhead)ha(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),ha(r,r.gzhead.time&255),ha(r,r.gzhead.time>>8&255),ha(r,r.gzhead.time>>16&255),ha(r,r.gzhead.time>>24&255),ha(r,r.level===9?2:r.strategy>=QP||r.level<2?4:0),ha(r,r.gzhead.os&255),r.gzhead.extra&&r.gzhead.extra.length&&(ha(r,r.gzhead.extra.length&255),ha(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=Dc(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=GN;else if(ha(r,0),ha(r,0),ha(r,0),ha(r,0),ha(r,0),ha(r,r.level===9?2:r.strategy>=QP||r.level<2?4:0),ha(r,IYe),r.status=Fy,zd(e),r.pending!==0)return r.last_flush=-1,ru}if(r.status===GN){if(r.gzhead.extra){let i=r.pending,o=(r.gzhead.extra.length&65535)-r.gzindex;for(;r.pending+o>r.pending_buf_size;){let a=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+a),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>i&&(e.adler=Dc(e.adler,r.pending_buf,r.pending-i,i)),r.gzindex+=a,zd(e),r.pending!==0)return r.last_flush=-1,ru;i=0,o-=a}let s=new Uint8Array(r.gzhead.extra);r.pending_buf.set(s.subarray(r.gzindex,r.gzindex+o),r.pending),r.pending+=o,r.gzhead.hcrc&&r.pending>i&&(e.adler=Dc(e.adler,r.pending_buf,r.pending-i,i)),r.gzindex=0}r.status=qN}if(r.status===qN){if(r.gzhead.name){let i=r.pending,o;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>i&&(e.adler=Dc(e.adler,r.pending_buf,r.pending-i,i)),zd(e),r.pending!==0)return r.last_flush=-1,ru;i=0}r.gzindex<r.gzhead.name.length?o=r.gzhead.name.charCodeAt(r.gzindex++)&255:o=0,ha(r,o)}while(o!==0);r.gzhead.hcrc&&r.pending>i&&(e.adler=Dc(e.adler,r.pending_buf,r.pending-i,i)),r.gzindex=0}r.status=HN}if(r.status===HN){if(r.gzhead.comment){let i=r.pending,o;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>i&&(e.adler=Dc(e.adler,r.pending_buf,r.pending-i,i)),zd(e),r.pending!==0)return r.last_flush=-1,ru;i=0}r.gzindex<r.gzhead.comment.length?o=r.gzhead.comment.charCodeAt(r.gzindex++)&255:o=0,ha(r,o)}while(o!==0);r.gzhead.hcrc&&r.pending>i&&(e.adler=Dc(e.adler,r.pending_buf,r.pending-i,i))}r.status=KN}if(r.status===KN){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(zd(e),r.pending!==0))return r.last_flush=-1,ru;ha(r,e.adler&255),ha(r,e.adler>>8&255),e.adler=0}if(r.status=Fy,zd(e),r.pending!==0)return r.last_flush=-1,ru}if(e.avail_in!==0||r.lookahead!==0||t!==y_&&r.status!==Jw){let i=r.level===0?jde(r,t):r.strategy===QP?$Ye(r,t):r.strategy===_Ye?DYe(r,t):e2[r.level].func(r,t);if((i===T0||i===ix)&&(r.status=Jw),i===Gu||i===T0)return e.avail_out===0&&(r.last_flush=-1),ru;if(i===nx&&(t===hYe?dYe(r):t!==WH&&(VN(r,0,0,!1),t===fYe&&(Hg(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),zd(e),e.avail_out===0))return r.last_flush=-1,ru}return t!==Ch?ru:r.wrap<=0?GH:(r.wrap===2?(ha(r,e.adler&255),ha(r,e.adler>>8&255),ha(r,e.adler>>16&255),ha(r,e.adler>>24&255),ha(r,e.total_in&255),ha(r,e.total_in>>8&255),ha(r,e.total_in>>16&255),ha(r,e.total_in>>24&255)):(Fw(r,e.adler>>>16),Fw(r,e.adler&65535)),zd(e),r.wrap>0&&(r.wrap=-r.wrap),r.pending!==0?ru:GH)},BYe=e=>{if(IS(e))return Gp;const t=e.state.status;return e.state=null,t===Fy?zy(e,pYe):ru},UYe=(e,t)=>{let r=t.length;if(IS(e))return Gp;const n=e.state,i=n.wrap;if(i===2||i===1&&n.status!==Pb||n.lookahead)return Gp;if(i===1&&(e.adler=QM(e.adler,t,r,0)),n.wrap=0,r>=n.w_size){i===0&&(Hg(n.head),n.strstart=0,n.block_start=0,n.insert=0);let u=new Uint8Array(n.w_size);u.set(t.subarray(r-n.w_size,r),0),t=u,r=n.w_size}const o=e.avail_in,s=e.next_in,a=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,Eb(n);n.lookahead>=Bo;){let u=n.strstart,d=n.lookahead-(Bo-1);do n.ins_h=v_(n,n.ins_h,n.window[u+Bo-1]),n.prev[u&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=u,u++;while(--d);n.strstart=u,n.lookahead=Bo-1,Eb(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=Bo-1,n.match_available=0,e.next_in=s,e.input=a,e.avail_in=o,n.wrap=i,ru};var VYe=FYe,WYe=zde,GYe=Fde,qYe=Rde,HYe=RYe,KYe=zYe,ZYe=BYe,XYe=UYe,YYe="pako deflate (from Nodeca project)",P2={deflateInit:VYe,deflateInit2:WYe,deflateReset:GYe,deflateResetKeep:qYe,deflateSetHeader:HYe,deflate:KYe,deflateEnd:ZYe,deflateSetDictionary:XYe,deflateInfo:YYe};const QYe=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var JYe=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)QYe(r,n)&&(e[n]=r[n])}}return e},eQe=e=>{let t=0;for(let n=0,i=e.length;n<i;n++)t+=e[n].length;const r=new Uint8Array(t);for(let n=0,i=0,o=e.length;n<o;n++){let s=e[n];r.set(s,i),i+=s.length}return r},Ok={assign:JYe,flattenChunks:eQe};let Bde=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Bde=!1}const JM=new Uint8Array(256);for(let e=0;e<256;e++)JM[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;JM[254]=JM[254]=1;var tQe=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,n,i,o,s=e.length,a=0;for(i=0;i<s;i++)r=e.charCodeAt(i),(r&64512)===55296&&i+1<s&&(n=e.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),a+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(a),o=0,i=0;o<a;i++)r=e.charCodeAt(i),(r&64512)===55296&&i+1<s&&(n=e.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?t[o++]=r:r<2048?(t[o++]=192|r>>>6,t[o++]=128|r&63):r<65536?(t[o++]=224|r>>>12,t[o++]=128|r>>>6&63,t[o++]=128|r&63):(t[o++]=240|r>>>18,t[o++]=128|r>>>12&63,t[o++]=128|r>>>6&63,t[o++]=128|r&63);return t};const rQe=(e,t)=>{if(t<65534&&e.subarray&&Bde)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r};var nQe=(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let n,i;const o=new Array(r*2);for(i=0,n=0;n<r;){let s=e[n++];if(s<128){o[i++]=s;continue}let a=JM[s];if(a>4){o[i++]=65533,n+=a-1;continue}for(s&=a===2?31:a===3?15:7;a>1&&n<r;)s=s<<6|e[n++]&63,a--;if(a>1){o[i++]=65533;continue}s<65536?o[i++]=s:(s-=65536,o[i++]=55296|s>>10&1023,o[i++]=56320|s&1023)}return rQe(o,i)},iQe=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+JM[e[r]]>t?r:t},eS={string2buf:tQe,buf2string:nQe,utf8border:iQe};function oQe(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Ude=oQe;const Vde=Object.prototype.toString,{Z_NO_FLUSH:aQe,Z_SYNC_FLUSH:sQe,Z_FULL_FLUSH:lQe,Z_FINISH:cQe,Z_OK:HC,Z_STREAM_END:uQe,Z_DEFAULT_COMPRESSION:dQe,Z_DEFAULT_STRATEGY:hQe,Z_DEFLATED:fQe}=kS;function cz(e){this.options=Ok.assign({level:dQe,method:fQe,chunkSize:16384,windowBits:15,memLevel:8,strategy:hQe},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ude,this.strm.avail_out=0;let r=P2.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==HC)throw new Error(Tb[r]);if(t.header&&P2.deflateSetHeader(this.strm,t.header),t.dictionary){let n;if(typeof t.dictionary=="string"?n=eS.string2buf(t.dictionary):Vde.call(t.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(t.dictionary):n=t.dictionary,r=P2.deflateSetDictionary(this.strm,n),r!==HC)throw new Error(Tb[r]);this._dict_set=!0}}cz.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize;let i,o;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?cQe:aQe,typeof e=="string"?r.input=eS.string2buf(e):Vde.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){if(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(o===sQe||o===lQe)&&r.avail_out<=6){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(i=P2.deflate(r,o),i===uQe)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),i=P2.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===HC;if(r.avail_out===0){this.onData(r.output);continue}if(o>0&&r.next_out>0){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(r.avail_in===0)break}return!0};cz.prototype.onData=function(e){this.chunks.push(e)};cz.prototype.onEnd=function(e){e===HC&&(this.result=Ok.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};const JP=16209,pQe=16191;var mQe=function(t,r){let n,i,o,s,a,u,d,m,g,_,y,M,x,E,T,P,C,D,L,N,j,$,U,G;const H=t.state;n=t.next_in,U=t.input,i=n+(t.avail_in-5),o=t.next_out,G=t.output,s=o-(r-t.avail_out),a=o+(t.avail_out-257),u=H.dmax,d=H.wsize,m=H.whave,g=H.wnext,_=H.window,y=H.hold,M=H.bits,x=H.lencode,E=H.distcode,T=(1<<H.lenbits)-1,P=(1<<H.distbits)-1;e:do{M<15&&(y+=U[n++]<<M,M+=8,y+=U[n++]<<M,M+=8),C=x[y&T];t:for(;;){if(D=C>>>24,y>>>=D,M-=D,D=C>>>16&255,D===0)G[o++]=C&65535;else if(D&16){L=C&65535,D&=15,D&&(M<D&&(y+=U[n++]<<M,M+=8),L+=y&(1<<D)-1,y>>>=D,M-=D),M<15&&(y+=U[n++]<<M,M+=8,y+=U[n++]<<M,M+=8),C=E[y&P];r:for(;;){if(D=C>>>24,y>>>=D,M-=D,D=C>>>16&255,D&16){if(N=C&65535,D&=15,M<D&&(y+=U[n++]<<M,M+=8,M<D&&(y+=U[n++]<<M,M+=8)),N+=y&(1<<D)-1,N>u){t.msg="invalid distance too far back",H.mode=JP;break e}if(y>>>=D,M-=D,D=o-s,N>D){if(D=N-D,D>m&&H.sane){t.msg="invalid distance too far back",H.mode=JP;break e}if(j=0,$=_,g===0){if(j+=d-D,D<L){L-=D;do G[o++]=_[j++];while(--D);j=o-N,$=G}}else if(g<D){if(j+=d+g-D,D-=g,D<L){L-=D;do G[o++]=_[j++];while(--D);if(j=0,g<L){D=g,L-=D;do G[o++]=_[j++];while(--D);j=o-N,$=G}}}else if(j+=g-D,D<L){L-=D;do G[o++]=_[j++];while(--D);j=o-N,$=G}for(;L>2;)G[o++]=$[j++],G[o++]=$[j++],G[o++]=$[j++],L-=3;L&&(G[o++]=$[j++],L>1&&(G[o++]=$[j++]))}else{j=o-N;do G[o++]=G[j++],G[o++]=G[j++],G[o++]=G[j++],L-=3;while(L>2);L&&(G[o++]=G[j++],L>1&&(G[o++]=G[j++]))}}else if(D&64){t.msg="invalid distance code",H.mode=JP;break e}else{C=E[(C&65535)+(y&(1<<D)-1)];continue r}break}}else if(D&64)if(D&32){H.mode=pQe;break e}else{t.msg="invalid literal/length code",H.mode=JP;break e}else{C=x[(C&65535)+(y&(1<<D)-1)];continue t}break}}while(n<i&&o<a);L=M>>3,n-=L,M-=L<<3,y&=(1<<M)-1,t.next_in=n,t.next_out=o,t.avail_in=n<i?5+(i-n):5-(n-i),t.avail_out=o<a?257+(a-o):257-(o-a),H.hold=y,H.bits=M};const Ov=15,HH=852,KH=592,ZH=0,jO=1,XH=2,gQe=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),_Qe=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),yQe=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),vQe=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),bQe=(e,t,r,n,i,o,s,a)=>{const u=a.bits;let d=0,m=0,g=0,_=0,y=0,M=0,x=0,E=0,T=0,P=0,C,D,L,N,j,$=null,U;const G=new Uint16Array(Ov+1),H=new Uint16Array(Ov+1);let X=null,ee,ae,de;for(d=0;d<=Ov;d++)G[d]=0;for(m=0;m<n;m++)G[t[r+m]]++;for(y=u,_=Ov;_>=1&&G[_]===0;_--);if(y>_&&(y=_),_===0)return i[o++]=1<<24|64<<16|0,i[o++]=1<<24|64<<16|0,a.bits=1,0;for(g=1;g<_&&G[g]===0;g++);for(y<g&&(y=g),E=1,d=1;d<=Ov;d++)if(E<<=1,E-=G[d],E<0)return-1;if(E>0&&(e===ZH||_!==1))return-1;for(H[1]=0,d=1;d<Ov;d++)H[d+1]=H[d]+G[d];for(m=0;m<n;m++)t[r+m]!==0&&(s[H[t[r+m]]++]=m);if(e===ZH?($=X=s,U=20):e===jO?($=gQe,X=_Qe,U=257):($=yQe,X=vQe,U=0),P=0,m=0,d=g,j=o,M=y,x=0,L=-1,T=1<<y,N=T-1,e===jO&&T>HH||e===XH&&T>KH)return 1;for(;;){ee=d-x,s[m]+1<U?(ae=0,de=s[m]):s[m]>=U?(ae=X[s[m]-U],de=$[s[m]-U]):(ae=96,de=0),C=1<<d-x,D=1<<M,g=D;do D-=C,i[j+(P>>x)+D]=ee<<24|ae<<16|de|0;while(D!==0);for(C=1<<d-1;P&C;)C>>=1;if(C!==0?(P&=C-1,P+=C):P=0,m++,--G[d]===0){if(d===_)break;d=t[r+s[m]]}if(d>y&&(P&N)!==L){for(x===0&&(x=y),j+=g,M=d-x,E=1<<M;M+x<_&&(E-=G[M+x],!(E<=0));)M++,E<<=1;if(T+=1<<M,e===jO&&T>HH||e===XH&&T>KH)return 1;L=P&N,i[L]=y<<24|M<<16|j-o|0}}return P!==0&&(i[j+P]=d-x<<24|64<<16|0),a.bits=y,0};var E2=bQe;const xQe=0,Wde=1,Gde=2,{Z_FINISH:YH,Z_BLOCK:wQe,Z_TREES:eE,Z_OK:P0,Z_STREAM_END:MQe,Z_NEED_DICT:SQe,Z_STREAM_ERROR:zh,Z_DATA_ERROR:qde,Z_MEM_ERROR:Hde,Z_BUF_ERROR:TQe,Z_DEFLATED:QH}=kS,Lk=16180,JH=16181,eK=16182,tK=16183,rK=16184,nK=16185,iK=16186,oK=16187,aK=16188,sK=16189,KC=16190,wm=16191,RO=16192,lK=16193,FO=16194,cK=16195,uK=16196,dK=16197,hK=16198,tE=16199,rE=16200,fK=16201,pK=16202,mK=16203,gK=16204,_K=16205,zO=16206,yK=16207,vK=16208,ks=16209,Kde=16210,Zde=16211,PQe=852,EQe=592,AQe=15,CQe=AQe,bK=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function kQe(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const z0=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Lk||t.mode>Zde?1:0},Xde=e=>{if(z0(e))return zh;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=Lk,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(PQe),t.distcode=t.distdyn=new Int32Array(EQe),t.sane=1,t.back=-1,P0},Yde=e=>{if(z0(e))return zh;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Xde(e)},Qde=(e,t)=>{let r;if(z0(e))return zh;const n=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?zh:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,Yde(e))},Jde=(e,t)=>{if(!e)return zh;const r=new kQe;e.state=r,r.strm=e,r.window=null,r.mode=Lk;const n=Qde(e,t);return n!==P0&&(e.state=null),n},IQe=e=>Jde(e,CQe);let xK=!0,BO,UO;const OQe=e=>{if(xK){BO=new Int32Array(512),UO=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(E2(Wde,e.lens,0,288,BO,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;E2(Gde,e.lens,0,32,UO,0,e.work,{bits:5}),xK=!1}e.lencode=BO,e.lenbits=9,e.distcode=UO,e.distbits=5},ehe=(e,t,r,n)=>{let i;const o=e.state;return o.window===null&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),n>=o.wsize?(o.window.set(t.subarray(r-o.wsize,r),0),o.wnext=0,o.whave=o.wsize):(i=o.wsize-o.wnext,i>n&&(i=n),o.window.set(t.subarray(r-n,r-n+i),o.wnext),n-=i,n?(o.window.set(t.subarray(r-n,r),0),o.wnext=n,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0},LQe=(e,t)=>{let r,n,i,o,s,a,u,d,m,g,_,y,M,x,E=0,T,P,C,D,L,N,j,$;const U=new Uint8Array(4);let G,H;const X=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(z0(e)||!e.output||!e.input&&e.avail_in!==0)return zh;r=e.state,r.mode===wm&&(r.mode=RO),s=e.next_out,i=e.output,u=e.avail_out,o=e.next_in,n=e.input,a=e.avail_in,d=r.hold,m=r.bits,g=a,_=u,$=P0;e:for(;;)switch(r.mode){case Lk:if(r.wrap===0){r.mode=RO;break}for(;m<16;){if(a===0)break e;a--,d+=n[o++]<<m,m+=8}if(r.wrap&2&&d===35615){r.wbits===0&&(r.wbits=15),r.check=0,U[0]=d&255,U[1]=d>>>8&255,r.check=Dc(r.check,U,2,0),d=0,m=0,r.mode=JH;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((d&255)<<8)+(d>>8))%31){e.msg="incorrect header check",r.mode=ks;break}if((d&15)!==QH){e.msg="unknown compression method",r.mode=ks;break}if(d>>>=4,m-=4,j=(d&15)+8,r.wbits===0&&(r.wbits=j),j>15||j>r.wbits){e.msg="invalid window size",r.mode=ks;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=d&512?sK:wm,d=0,m=0;break;case JH:for(;m<16;){if(a===0)break e;a--,d+=n[o++]<<m,m+=8}if(r.flags=d,(r.flags&255)!==QH){e.msg="unknown compression method",r.mode=ks;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=ks;break}r.head&&(r.head.text=d>>8&1),r.flags&512&&r.wrap&4&&(U[0]=d&255,U[1]=d>>>8&255,r.check=Dc(r.check,U,2,0)),d=0,m=0,r.mode=eK;case eK:for(;m<32;){if(a===0)break e;a--,d+=n[o++]<<m,m+=8}r.head&&(r.head.time=d),r.flags&512&&r.wrap&4&&(U[0]=d&255,U[1]=d>>>8&255,U[2]=d>>>16&255,U[3]=d>>>24&255,r.check=Dc(r.check,U,4,0)),d=0,m=0,r.mode=tK;case tK:for(;m<16;){if(a===0)break e;a--,d+=n[o++]<<m,m+=8}r.head&&(r.head.xflags=d&255,r.head.os=d>>8),r.flags&512&&r.wrap&4&&(U[0]=d&255,U[1]=d>>>8&255,r.check=Dc(r.check,U,2,0)),d=0,m=0,r.mode=rK;case rK:if(r.flags&1024){for(;m<16;){if(a===0)break e;a--,d+=n[o++]<<m,m+=8}r.length=d,r.head&&(r.head.extra_len=d),r.flags&512&&r.wrap&4&&(U[0]=d&255,U[1]=d>>>8&255,r.check=Dc(r.check,U,2,0)),d=0,m=0}else r.head&&(r.head.extra=null);r.mode=nK;case nK:if(r.flags&1024&&(y=r.length,y>a&&(y=a),y&&(r.head&&(j=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(o,o+y),j)),r.flags&512&&r.wrap&4&&(r.check=Dc(r.check,n,y,o)),a-=y,o+=y,r.length-=y),r.length))break e;r.length=0,r.mode=iK;case iK:if(r.flags&2048){if(a===0)break e;y=0;do j=n[o+y++],r.head&&j&&r.length<65536&&(r.head.name+=String.fromCharCode(j));while(j&&y<a);if(r.flags&512&&r.wrap&4&&(r.check=Dc(r.check,n,y,o)),a-=y,o+=y,j)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=oK;case oK:if(r.flags&4096){if(a===0)break e;y=0;do j=n[o+y++],r.head&&j&&r.length<65536&&(r.head.comment+=String.fromCharCode(j));while(j&&y<a);if(r.flags&512&&r.wrap&4&&(r.check=Dc(r.check,n,y,o)),a-=y,o+=y,j)break e}else r.head&&(r.head.comment=null);r.mode=aK;case aK:if(r.flags&512){for(;m<16;){if(a===0)break e;a--,d+=n[o++]<<m,m+=8}if(r.wrap&4&&d!==(r.check&65535)){e.msg="header crc mismatch",r.mode=ks;break}d=0,m=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=wm;break;case sK:for(;m<32;){if(a===0)break e;a--,d+=n[o++]<<m,m+=8}e.adler=r.check=bK(d),d=0,m=0,r.mode=KC;case KC:if(r.havedict===0)return e.next_out=s,e.avail_out=u,e.next_in=o,e.avail_in=a,r.hold=d,r.bits=m,SQe;e.adler=r.check=1,r.mode=wm;case wm:if(t===wQe||t===eE)break e;case RO:if(r.last){d>>>=m&7,m-=m&7,r.mode=zO;break}for(;m<3;){if(a===0)break e;a--,d+=n[o++]<<m,m+=8}switch(r.last=d&1,d>>>=1,m-=1,d&3){case 0:r.mode=lK;break;case 1:if(OQe(r),r.mode=tE,t===eE){d>>>=2,m-=2;break e}break;case 2:r.mode=uK;break;case 3:e.msg="invalid block type",r.mode=ks}d>>>=2,m-=2;break;case lK:for(d>>>=m&7,m-=m&7;m<32;){if(a===0)break e;a--,d+=n[o++]<<m,m+=8}if((d&65535)!==(d>>>16^65535)){e.msg="invalid stored block lengths",r.mode=ks;break}if(r.length=d&65535,d=0,m=0,r.mode=FO,t===eE)break e;case FO:r.mode=cK;case cK:if(y=r.length,y){if(y>a&&(y=a),y>u&&(y=u),y===0)break e;i.set(n.subarray(o,o+y),s),a-=y,o+=y,u-=y,s+=y,r.length-=y;break}r.mode=wm;break;case uK:for(;m<14;){if(a===0)break e;a--,d+=n[o++]<<m,m+=8}if(r.nlen=(d&31)+257,d>>>=5,m-=5,r.ndist=(d&31)+1,d>>>=5,m-=5,r.ncode=(d&15)+4,d>>>=4,m-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=ks;break}r.have=0,r.mode=dK;case dK:for(;r.have<r.ncode;){for(;m<3;){if(a===0)break e;a--,d+=n[o++]<<m,m+=8}r.lens[X[r.have++]]=d&7,d>>>=3,m-=3}for(;r.have<19;)r.lens[X[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,G={bits:r.lenbits},$=E2(xQe,r.lens,0,19,r.lencode,0,r.work,G),r.lenbits=G.bits,$){e.msg="invalid code lengths set",r.mode=ks;break}r.have=0,r.mode=hK;case hK:for(;r.have<r.nlen+r.ndist;){for(;E=r.lencode[d&(1<<r.lenbits)-1],T=E>>>24,P=E>>>16&255,C=E&65535,!(T<=m);){if(a===0)break e;a--,d+=n[o++]<<m,m+=8}if(C<16)d>>>=T,m-=T,r.lens[r.have++]=C;else{if(C===16){for(H=T+2;m<H;){if(a===0)break e;a--,d+=n[o++]<<m,m+=8}if(d>>>=T,m-=T,r.have===0){e.msg="invalid bit length repeat",r.mode=ks;break}j=r.lens[r.have-1],y=3+(d&3),d>>>=2,m-=2}else if(C===17){for(H=T+3;m<H;){if(a===0)break e;a--,d+=n[o++]<<m,m+=8}d>>>=T,m-=T,j=0,y=3+(d&7),d>>>=3,m-=3}else{for(H=T+7;m<H;){if(a===0)break e;a--,d+=n[o++]<<m,m+=8}d>>>=T,m-=T,j=0,y=11+(d&127),d>>>=7,m-=7}if(r.have+y>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=ks;break}for(;y--;)r.lens[r.have++]=j}}if(r.mode===ks)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=ks;break}if(r.lenbits=9,G={bits:r.lenbits},$=E2(Wde,r.lens,0,r.nlen,r.lencode,0,r.work,G),r.lenbits=G.bits,$){e.msg="invalid literal/lengths set",r.mode=ks;break}if(r.distbits=6,r.distcode=r.distdyn,G={bits:r.distbits},$=E2(Gde,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,G),r.distbits=G.bits,$){e.msg="invalid distances set",r.mode=ks;break}if(r.mode=tE,t===eE)break e;case tE:r.mode=rE;case rE:if(a>=6&&u>=258){e.next_out=s,e.avail_out=u,e.next_in=o,e.avail_in=a,r.hold=d,r.bits=m,mQe(e,_),s=e.next_out,i=e.output,u=e.avail_out,o=e.next_in,n=e.input,a=e.avail_in,d=r.hold,m=r.bits,r.mode===wm&&(r.back=-1);break}for(r.back=0;E=r.lencode[d&(1<<r.lenbits)-1],T=E>>>24,P=E>>>16&255,C=E&65535,!(T<=m);){if(a===0)break e;a--,d+=n[o++]<<m,m+=8}if(P&&!(P&240)){for(D=T,L=P,N=C;E=r.lencode[N+((d&(1<<D+L)-1)>>D)],T=E>>>24,P=E>>>16&255,C=E&65535,!(D+T<=m);){if(a===0)break e;a--,d+=n[o++]<<m,m+=8}d>>>=D,m-=D,r.back+=D}if(d>>>=T,m-=T,r.back+=T,r.length=C,P===0){r.mode=_K;break}if(P&32){r.back=-1,r.mode=wm;break}if(P&64){e.msg="invalid literal/length code",r.mode=ks;break}r.extra=P&15,r.mode=fK;case fK:if(r.extra){for(H=r.extra;m<H;){if(a===0)break e;a--,d+=n[o++]<<m,m+=8}r.length+=d&(1<<r.extra)-1,d>>>=r.extra,m-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=pK;case pK:for(;E=r.distcode[d&(1<<r.distbits)-1],T=E>>>24,P=E>>>16&255,C=E&65535,!(T<=m);){if(a===0)break e;a--,d+=n[o++]<<m,m+=8}if(!(P&240)){for(D=T,L=P,N=C;E=r.distcode[N+((d&(1<<D+L)-1)>>D)],T=E>>>24,P=E>>>16&255,C=E&65535,!(D+T<=m);){if(a===0)break e;a--,d+=n[o++]<<m,m+=8}d>>>=D,m-=D,r.back+=D}if(d>>>=T,m-=T,r.back+=T,P&64){e.msg="invalid distance code",r.mode=ks;break}r.offset=C,r.extra=P&15,r.mode=mK;case mK:if(r.extra){for(H=r.extra;m<H;){if(a===0)break e;a--,d+=n[o++]<<m,m+=8}r.offset+=d&(1<<r.extra)-1,d>>>=r.extra,m-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=ks;break}r.mode=gK;case gK:if(u===0)break e;if(y=_-u,r.offset>y){if(y=r.offset-y,y>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=ks;break}y>r.wnext?(y-=r.wnext,M=r.wsize-y):M=r.wnext-y,y>r.length&&(y=r.length),x=r.window}else x=i,M=s-r.offset,y=r.length;y>u&&(y=u),u-=y,r.length-=y;do i[s++]=x[M++];while(--y);r.length===0&&(r.mode=rE);break;case _K:if(u===0)break e;i[s++]=r.length,u--,r.mode=rE;break;case zO:if(r.wrap){for(;m<32;){if(a===0)break e;a--,d|=n[o++]<<m,m+=8}if(_-=u,e.total_out+=_,r.total+=_,r.wrap&4&&_&&(e.adler=r.check=r.flags?Dc(r.check,i,_,s-_):QM(r.check,i,_,s-_)),_=u,r.wrap&4&&(r.flags?d:bK(d))!==r.check){e.msg="incorrect data check",r.mode=ks;break}d=0,m=0}r.mode=yK;case yK:if(r.wrap&&r.flags){for(;m<32;){if(a===0)break e;a--,d+=n[o++]<<m,m+=8}if(r.wrap&4&&d!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=ks;break}d=0,m=0}r.mode=vK;case vK:$=MQe;break e;case ks:$=qde;break e;case Kde:return Hde;case Zde:default:return zh}return e.next_out=s,e.avail_out=u,e.next_in=o,e.avail_in=a,r.hold=d,r.bits=m,(r.wsize||_!==e.avail_out&&r.mode<ks&&(r.mode<zO||t!==YH))&&ehe(e,e.output,e.next_out,_-e.avail_out),g-=e.avail_in,_-=e.avail_out,e.total_in+=g,e.total_out+=_,r.total+=_,r.wrap&4&&_&&(e.adler=r.check=r.flags?Dc(r.check,i,_,e.next_out-_):QM(r.check,i,_,e.next_out-_)),e.data_type=r.bits+(r.last?64:0)+(r.mode===wm?128:0)+(r.mode===tE||r.mode===FO?256:0),(g===0&&_===0||t===YH)&&$===P0&&($=TQe),$},DQe=e=>{if(z0(e))return zh;let t=e.state;return t.window&&(t.window=null),e.state=null,P0},$Qe=(e,t)=>{if(z0(e))return zh;const r=e.state;return r.wrap&2?(r.head=t,t.done=!1,P0):zh},NQe=(e,t)=>{const r=t.length;let n,i,o;return z0(e)||(n=e.state,n.wrap!==0&&n.mode!==KC)?zh:n.mode===KC&&(i=1,i=QM(i,t,r,0),i!==n.check)?qde:(o=ehe(e,t,r,r),o?(n.mode=Kde,Hde):(n.havedict=1,P0))};var jQe=Yde,RQe=Qde,FQe=Xde,zQe=IQe,BQe=Jde,UQe=LQe,VQe=DQe,WQe=$Qe,GQe=NQe,qQe="pako inflate (from Nodeca project)",Am={inflateReset:jQe,inflateReset2:RQe,inflateResetKeep:FQe,inflateInit:zQe,inflateInit2:BQe,inflate:UQe,inflateEnd:VQe,inflateGetHeader:WQe,inflateSetDictionary:GQe,inflateInfo:qQe};function HQe(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var KQe=HQe;const the=Object.prototype.toString,{Z_NO_FLUSH:ZQe,Z_FINISH:XQe,Z_OK:tS,Z_STREAM_END:VO,Z_NEED_DICT:WO,Z_STREAM_ERROR:YQe,Z_DATA_ERROR:wK,Z_MEM_ERROR:QQe}=kS;function OS(e){this.options=Ok.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ude,this.strm.avail_out=0;let r=Am.inflateInit2(this.strm,t.windowBits);if(r!==tS)throw new Error(Tb[r]);if(this.header=new KQe,Am.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=eS.string2buf(t.dictionary):the.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=Am.inflateSetDictionary(this.strm,t.dictionary),r!==tS)))throw new Error(Tb[r])}OS.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,i=this.options.dictionary;let o,s,a;if(this.ended)return!1;for(t===~~t?s=t:s=t===!0?XQe:ZQe,the.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),o=Am.inflate(r,s),o===WO&&i&&(o=Am.inflateSetDictionary(r,i),o===tS?o=Am.inflate(r,s):o===wK&&(o=WO));r.avail_in>0&&o===VO&&r.state.wrap>0&&e[r.next_in]!==0;)Am.inflateReset(r),o=Am.inflate(r,s);switch(o){case YQe:case wK:case WO:case QQe:return this.onEnd(o),this.ended=!0,!1}if(a=r.avail_out,r.next_out&&(r.avail_out===0||o===VO))if(this.options.to==="string"){let u=eS.utf8border(r.output,r.next_out),d=r.next_out-u,m=eS.buf2string(r.output,u);r.next_out=d,r.avail_out=n-d,d&&r.output.set(r.output.subarray(u,u+d),0),this.onData(m)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(o===tS&&a===0)){if(o===VO)return o=Am.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};OS.prototype.onData=function(e){this.chunks.push(e)};OS.prototype.onEnd=function(e){e===tS&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Ok.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function uz(e,t){const r=new OS(t);if(r.push(e),r.err)throw r.msg||Tb[r.err];return r.result}function JQe(e,t){return t=t||{},t.raw=!0,uz(e,t)}var eJe=OS,tJe=uz,rJe=JQe,nJe=uz,iJe=kS,oJe={Inflate:eJe,inflate:tJe,inflateRaw:rJe,ungzip:nJe,constants:iJe};const{Inflate:aJe,inflate:sJe,inflateRaw:Bet,ungzip:Uet}=oJe;var MK=aJe,lJe=sJe;const rhe=[];for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;rhe[e]=t}const SK=4294967295;function cJe(e,t,r){let n=e;for(let i=0;i<r;i++)n=rhe[(n^t[i])&255]^n>>>8;return n}function uJe(e,t){return(cJe(SK,e,t)^SK)>>>0}function TK(e,t,r){const n=e.readUint32(),i=uJe(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(i!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${i}`)}function nhe(e,t,r){for(let n=0;n<r;n++)t[n]=e[n]}function ihe(e,t,r,n){let i=0;for(;i<n;i++)t[i]=e[i];for(;i<r;i++)t[i]=e[i]+t[i-n]&255}function ohe(e,t,r,n){let i=0;if(r.length===0)for(;i<n;i++)t[i]=e[i];else for(;i<n;i++)t[i]=e[i]+r[i]&255}function ahe(e,t,r,n,i){let o=0;if(r.length===0){for(;o<i;o++)t[o]=e[o];for(;o<n;o++)t[o]=e[o]+(t[o-i]>>1)&255}else{for(;o<i;o++)t[o]=e[o]+(r[o]>>1)&255;for(;o<n;o++)t[o]=e[o]+(t[o-i]+r[o]>>1)&255}}function she(e,t,r,n,i){let o=0;if(r.length===0){for(;o<i;o++)t[o]=e[o];for(;o<n;o++)t[o]=e[o]+t[o-i]&255}else{for(;o<i;o++)t[o]=e[o]+r[o]&255;for(;o<n;o++)t[o]=e[o]+dJe(t[o-i],r[o],r[o-i])&255}}function dJe(e,t,r){const n=e+t-r,i=Math.abs(n-e),o=Math.abs(n-t),s=Math.abs(n-r);return i<=o&&i<=s?e:o<=s?t:r}function hJe(e,t,r,n,i,o){switch(e){case 0:nhe(t,r,i);break;case 1:ihe(t,r,i,o);break;case 2:ohe(t,r,n,i);break;case 3:ahe(t,r,n,i,o);break;case 4:she(t,r,n,i,o);break;default:throw new Error(`Unsupported filter: ${e}`)}}const fJe=new Uint16Array([255]),pJe=new Uint8Array(fJe.buffer),mJe=pJe[0]===255;function gJe(e){const{data:t,width:r,height:n,channels:i,depth:o}=e,s=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],a=Math.ceil(o/8)*i,u=new Uint8Array(n*r*a);let d=0;for(let m=0;m<7;m++){const g=s[m],_=Math.ceil((r-g.x)/g.xStep),y=Math.ceil((n-g.y)/g.yStep);if(_<=0||y<=0)continue;const M=_*a,x=new Uint8Array(M);for(let E=0;E<y;E++){const T=t[d++],P=t.subarray(d,d+M);d+=M;const C=new Uint8Array(M);hJe(T,P,C,x,M,a),x.set(C);for(let D=0;D<_;D++){const L=g.x+D*g.xStep,N=g.y+E*g.yStep;if(!(L>=r||N>=n))for(let j=0;j<a;j++)u[(N*r+L)*a+j]=C[D*a+j]}}}if(o===16){const m=new Uint16Array(u.buffer);if(mJe)for(let g=0;g<m.length;g++)m[g]=_Je(m[g]);return m}else return u}function _Je(e){return(e&255)<<8|e>>8&255}const yJe=new Uint16Array([255]),vJe=new Uint8Array(yJe.buffer),bJe=vJe[0]===255,xJe=new Uint8Array(0);function PK(e){const{data:t,width:r,height:n,channels:i,depth:o}=e,s=Math.ceil(o/8)*i,a=Math.ceil(o/8*i*r),u=new Uint8Array(n*a);let d=xJe,m=0,g,_;for(let y=0;y<n;y++){switch(g=t.subarray(m+1,m+1+a),_=u.subarray(y*a,(y+1)*a),t[m]){case 0:nhe(g,_,a);break;case 1:ihe(g,_,a,s);break;case 2:ohe(g,_,d,a);break;case 3:ahe(g,_,d,a,s);break;case 4:she(g,_,d,a,s);break;default:throw new Error(`Unsupported filter: ${t[m]}`)}d=_,m+=a+1}if(o===16){const y=new Uint16Array(u.buffer);if(bJe)for(let M=0;M<y.length;M++)y[M]=wJe(y[M]);return y}else return u}function wJe(e){return(e&255)<<8|e>>8&255}const jE=Uint8Array.of(137,80,78,71,13,10,26,10);function EK(e){if(!MJe(e.readBytes(jE.length)))throw new Error("wrong PNG signature")}function MJe(e){if(e.length<jE.length)return!1;for(let t=0;t<jE.length;t++)if(e[t]!==jE[t])return!1;return!0}const SJe="tEXt",TJe=0,lhe=new TextDecoder("latin1");function PJe(e){if(AJe(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const EJe=/^[\u0000-\u00FF]*$/;function AJe(e){if(!EJe.test(e))throw new Error("invalid latin1 text")}function CJe(e,t,r){const n=che(t);e[n]=kJe(t,r-n.length-1)}function che(e){for(e.mark();e.readByte()!==TJe;);const t=e.offset;e.reset();const r=lhe.decode(e.readBytes(t-e.offset-1));return e.skip(1),PJe(r),r}function kJe(e,t){return lhe.decode(e.readBytes(t))}const Nd={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},GO={UNKNOWN:-1,DEFLATE:0},AK={UNKNOWN:-1,ADAPTIVE:0},qO={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},nE={NONE:0,BACKGROUND:1,PREVIOUS:2},HO={SOURCE:0,OVER:1};class IJe extends nz{constructor(r,n={}){super(r);_t(this,"_checkCrc");_t(this,"_inflator");_t(this,"_png");_t(this,"_apng");_t(this,"_end");_t(this,"_hasPalette");_t(this,"_palette");_t(this,"_hasTransparency");_t(this,"_transparency");_t(this,"_compressionMethod");_t(this,"_filterMethod");_t(this,"_interlaceMethod");_t(this,"_colorType");_t(this,"_isAnimated");_t(this,"_numberOfFrames");_t(this,"_numberOfPlays");_t(this,"_frames");_t(this,"_writingDataChunks");const{checkCrc:i=!1}=n;this._checkCrc=i,this._inflator=new MK,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=GO.UNKNOWN,this._filterMethod=AK.UNKNOWN,this._interlaceMethod=qO.UNKNOWN,this._colorType=Nd.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(EK(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(EK(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const i=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case SJe:CJe(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-i!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?TK(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const i=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=i+r;break}if(this.offset-i!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?TK(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=OJe(this.readUint8());const n=this.readUint8();this._colorType=n;let i;switch(n){case Nd.GREYSCALE:i=1;break;case Nd.TRUECOLOUR:i=3;break;case Nd.INDEXED_COLOUR:i=1;break;case Nd.GREYSCALE_ALPHA:i=2;break;case Nd.TRUECOLOUR_ALPHA:i=4;break;case Nd.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=i,this._compressionMethod=this.readUint8(),this._compressionMethod!==GO.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const i=[];this._palette=i;for(let o=0;o<n;o++)i.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,i=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,i,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,i=this.offset+this.byteOffset;if(i+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,i,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case Nd.GREYSCALE:case Nd.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case Nd.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const i=this.readByte();this._palette[n].push(i)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case Nd.UNKNOWN:case Nd.GREYSCALE_ALPHA:case Nd.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=che(this),i=this.readUint8();if(i!==GO.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${i}`);const o=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:lJe(o)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),i=this.readByte();this._png.resolution={x:r,y:n,unit:i}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},i=this._frames.at(r);if(i){if(i.data=PK({data:i.data,width:i.width,height:i.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||i.xOffset===0&&i.yOffset===0&&i.width===this._png.width&&i.height===this._png.height)n.data=i.data;else{const o=this._apng.frames.at(r-1);this.disposeFrame(i,o,n),this.addFrameDataToCanvas(n,i)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,i){switch(r.disposeOp){case nE.NONE:break;case nE.BACKGROUND:for(let o=0;o<this._png.height;o++)for(let s=0;s<this._png.width;s++){const a=(o*r.width+s)*this._png.channels;for(let u=0;u<this._png.channels;u++)i.data[a+u]=0}break;case nE.PREVIOUS:i.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const i=1<<this._png.depth,o=(s,a)=>{const u=((s+n.yOffset)*this._png.width+n.xOffset+a)*this._png.channels,d=(s*n.width+a)*this._png.channels;return{index:u,frameIndex:d}};switch(n.blendOp){case HO.SOURCE:for(let s=0;s<n.height;s++)for(let a=0;a<n.width;a++){const{index:u,frameIndex:d}=o(s,a);for(let m=0;m<this._png.channels;m++)r.data[u+m]=n.data[d+m]}break;case HO.OVER:for(let s=0;s<n.height;s++)for(let a=0;a<n.width;a++){const{index:u,frameIndex:d}=o(s,a);for(let m=0;m<this._png.channels;m++){const g=n.data[d+this._png.channels-1]/i,_=m%(this._png.channels-1)===0?1:n.data[d+m],y=Math.floor(g*_+(1-g)*r.data[u+m]);r.data[u+m]+=y}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==AK.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===qO.NO_INTERLACE)this._png.data=PK({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===qO.ADAM7)this._png.data=gJe({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:nE.NONE,blendOp:HO.SOURCE,data:r}),this._inflator=new MK,this._writingDataChunks=!1}}function OJe(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var CK;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(CK||(CK={}));function LJe(e,t){return new IJe(e,t).decode()}var Ni=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function KO(){Ni.console&&typeof Ni.console.log=="function"&&Ni.console.log.apply(Ni.console,arguments)}var Ba={log:KO,warn:function(e){Ni.console&&(typeof Ni.console.warn=="function"?Ni.console.warn.apply(Ni.console,arguments):KO.call(null,arguments))},error:function(e){Ni.console&&(typeof Ni.console.error=="function"?Ni.console.error.apply(Ni.console,arguments):KO(e))}};function ZO(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){wy(n.response,t,r)},n.onerror=function(){Ba.error("could not download file")},n.send()}function kK(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function iE(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var wy=Ni.saveAs||((typeof window>"u"?"undefined":Ma(window))!=="object"||window!==Ni?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=Ni.URL||Ni.webkitURL,i=document.createElement("a");t=t||e.name||"download",i.download=t,i.rel="noopener",typeof e=="string"?(i.href=e,i.origin!==location.origin?kK(i.href)?ZO(e,t,r):iE(i,i.target="_blank"):iE(i)):(i.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){iE(i)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(kK(e))ZO(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){iE(n)})}else navigator.msSaveOrOpenBlob(function(i,o){return o===void 0?o={autoBom:!1}:Ma(o)!=="object"&&(Ba.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return ZO(e,t,r);var i=e.type==="application/octet-stream",o=/constructor/i.test(Ni.HTMLElement)||Ni.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||i&&o)&&(typeof FileReader>"u"?"undefined":Ma(FileReader))==="object"){var a=new FileReader;a.onloadend=function(){var m=a.result;m=s?m:m.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=m:location=m,n=null},a.readAsDataURL(e)}else{var u=Ni.URL||Ni.webkitURL,d=u.createObjectURL(e);n?n.location=d:location.href=d,n=null,setTimeout(function(){u.revokeObjectURL(d)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function uhe(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}],n=0;n<r.length;n++){var i=r[n].re,o=r[n].process,s=i.exec(e);s&&(t=o(s),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var a=this.r.toString(16),u=this.g.toString(16),d=this.b.toString(16);return a.length==1&&(a="0"+a),u.length==1&&(u="0"+u),d.length==1&&(d="0"+d),"#"+a+u+d}}var RE=Ni.atob.bind(Ni),IK=Ni.btoa.bind(Ni);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function XO(e,t){var r=e[0],n=e[1],i=e[2],o=e[3];r=yu(r,n,i,o,t[0],7,-680876936),o=yu(o,r,n,i,t[1],12,-389564586),i=yu(i,o,r,n,t[2],17,606105819),n=yu(n,i,o,r,t[3],22,-1044525330),r=yu(r,n,i,o,t[4],7,-176418897),o=yu(o,r,n,i,t[5],12,1200080426),i=yu(i,o,r,n,t[6],17,-1473231341),n=yu(n,i,o,r,t[7],22,-45705983),r=yu(r,n,i,o,t[8],7,1770035416),o=yu(o,r,n,i,t[9],12,-1958414417),i=yu(i,o,r,n,t[10],17,-42063),n=yu(n,i,o,r,t[11],22,-1990404162),r=yu(r,n,i,o,t[12],7,1804603682),o=yu(o,r,n,i,t[13],12,-40341101),i=yu(i,o,r,n,t[14],17,-1502002290),r=vu(r,n=yu(n,i,o,r,t[15],22,1236535329),i,o,t[1],5,-165796510),o=vu(o,r,n,i,t[6],9,-1069501632),i=vu(i,o,r,n,t[11],14,643717713),n=vu(n,i,o,r,t[0],20,-373897302),r=vu(r,n,i,o,t[5],5,-701558691),o=vu(o,r,n,i,t[10],9,38016083),i=vu(i,o,r,n,t[15],14,-660478335),n=vu(n,i,o,r,t[4],20,-405537848),r=vu(r,n,i,o,t[9],5,568446438),o=vu(o,r,n,i,t[14],9,-1019803690),i=vu(i,o,r,n,t[3],14,-187363961),n=vu(n,i,o,r,t[8],20,1163531501),r=vu(r,n,i,o,t[13],5,-1444681467),o=vu(o,r,n,i,t[2],9,-51403784),i=vu(i,o,r,n,t[7],14,1735328473),r=bu(r,n=vu(n,i,o,r,t[12],20,-1926607734),i,o,t[5],4,-378558),o=bu(o,r,n,i,t[8],11,-2022574463),i=bu(i,o,r,n,t[11],16,1839030562),n=bu(n,i,o,r,t[14],23,-35309556),r=bu(r,n,i,o,t[1],4,-1530992060),o=bu(o,r,n,i,t[4],11,1272893353),i=bu(i,o,r,n,t[7],16,-155497632),n=bu(n,i,o,r,t[10],23,-1094730640),r=bu(r,n,i,o,t[13],4,681279174),o=bu(o,r,n,i,t[0],11,-358537222),i=bu(i,o,r,n,t[3],16,-722521979),n=bu(n,i,o,r,t[6],23,76029189),r=bu(r,n,i,o,t[9],4,-640364487),o=bu(o,r,n,i,t[12],11,-421815835),i=bu(i,o,r,n,t[15],16,530742520),r=xu(r,n=bu(n,i,o,r,t[2],23,-995338651),i,o,t[0],6,-198630844),o=xu(o,r,n,i,t[7],10,1126891415),i=xu(i,o,r,n,t[14],15,-1416354905),n=xu(n,i,o,r,t[5],21,-57434055),r=xu(r,n,i,o,t[12],6,1700485571),o=xu(o,r,n,i,t[3],10,-1894986606),i=xu(i,o,r,n,t[10],15,-1051523),n=xu(n,i,o,r,t[1],21,-2054922799),r=xu(r,n,i,o,t[8],6,1873313359),o=xu(o,r,n,i,t[15],10,-30611744),i=xu(i,o,r,n,t[6],15,-1560198380),n=xu(n,i,o,r,t[13],21,1309151649),r=xu(r,n,i,o,t[4],6,-145523070),o=xu(o,r,n,i,t[11],10,-1120210379),i=xu(i,o,r,n,t[2],15,718787259),n=xu(n,i,o,r,t[9],21,-343485551),e[0]=o_(r,e[0]),e[1]=o_(n,e[1]),e[2]=o_(i,e[2]),e[3]=o_(o,e[3])}function Dk(e,t,r,n,i,o){return t=o_(o_(t,e),o_(n,o)),o_(t<<i|t>>>32-i,r)}function yu(e,t,r,n,i,o,s){return Dk(t&r|~t&n,e,t,i,o,s)}function vu(e,t,r,n,i,o,s){return Dk(t&n|r&~n,e,t,i,o,s)}function bu(e,t,r,n,i,o,s){return Dk(t^r^n,e,t,i,o,s)}function xu(e,t,r,n,i,o,s){return Dk(r^(t|~n),e,t,i,o,s)}function dhe(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)XO(n,DJe(e.substring(t-64,t)));e=e.substring(t-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)i[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(i[t>>2]|=128<<(t%4<<3),t>55)for(XO(n,i),t=0;t<16;t++)i[t]=0;return i[14]=8*r,XO(n,i),n}function DJe(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var OK="0123456789abcdef".split("");function $Je(e){for(var t="",r=0;r<4;r++)t+=OK[e>>8*r+4&15]+OK[e>>8*r&15];return t}function NJe(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function XN(e){return dhe(e).map(NJe).join("")}var jJe=function(e){for(var t=0;t<e.length;t++)e[t]=$Je(e[t]);return e.join("")}(dhe("hello"))!="5d41402abc4b2a76b9719d911017c592";function o_(e,t){if(jJe){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function YN(e,t){var r,n,i,o;if(e!==r){for(var s=(i=e,o=1+(256/e.length|0),new Array(o+1).join(i)),a=[],u=0;u<256;u++)a[u]=u;var d=0;for(u=0;u<256;u++){var m=a[u];d=(d+m+s.charCodeAt(u))%256,a[u]=a[d],a[d]=m}r=e,n=a}else a=n;var g=t.length,_=0,y=0,M="";for(u=0;u<g;u++)y=(y+(m=a[_=(_+1)%256]))%256,a[_]=a[y],a[y]=m,s=a[(a[_]+a[y])%256],M+=String.fromCharCode(t.charCodeAt(u)^s);return M}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var LK={print:4,modify:8,copy:16,"annot-forms":32};function jv(e,t,r,n){this.v=1,this.r=2;var i=192;e.forEach(function(a){if(LK.perm!==void 0)throw new Error("Invalid permission: "+a);i+=LK[a]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var o=(t+this.padding).substr(0,32),s=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(o,s),this.P=-(1+(255^i)),this.encryptionKey=XN(o+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=YN(this.encryptionKey,this.padding)}function Rv(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var i=e.charCodeAt(n);t+=i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?"#"+("0"+i.toString(16)).slice(-2):e[n]}return t}function DK(e){if(Ma(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,i){if(i=i||!1,typeof r!="string"||typeof n!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var o=Math.random().toString(35);return t[r][o]=[n,!!i],o},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),i=[];for(var o in t[r]){var s=t[r][o];try{s[0].apply(e,n)}catch(a){Ni.console&&Ba.error("jsPDF PubSub Error",a.message,a)}s[1]&&i.push(o)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function ZC(e){if(!(this instanceof ZC))return new ZC(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function hhe(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function Py(e,t,r,n,i){if(!(this instanceof Py))return new Py(e,t,r,n,i);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,hhe.call(this,n,i)}function u1(e,t,r,n,i){if(!(this instanceof u1))return new u1(e,t,r,n,i);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,hhe.call(this,n,i)}function ai(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],i=arguments[2],o=arguments[3],s=[],a=1,u=16,d="S",m=null;Ma(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,i=e.format||i,o=e.compress||e.compressPdf||o,(m=e.encryption||null)!==null&&(m.userPassword=m.userPassword||"",m.ownerPassword=m.ownerPassword||"",m.userPermissions=m.userPermissions||[]),a=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(u=e.floatPrecision),d=e.defaultPathOperation||"S"),s=e.filters||(o===!0?["FlateEncode"]:s),n=n||"mm",r=(""+(r||"P")).toLowerCase();var g=e.putOnlyUsedFonts||!1,_={},y={internal:{},__private__:{}};y.__private__.PubSub=DK;var M="1.3",x=y.__private__.getPdfVersion=function(){return M};y.__private__.setPdfVersion=function(re){M=re};var E={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};y.__private__.getPageFormats=function(){return E};var T=y.__private__.getPageFormat=function(re){return E[re]};i=i||"a4";var P="compat",C="advanced",D=P;function L(){this.saveGraphicsState(),Ne(new ge(Se,0,0,-Se,0,vo()*Se).toString()+" cm"),this.setFontSize(this.getFontSize()/Se),d="n",D=C}function N(){this.restoreGraphicsState(),d="S",D=P}var j=y.__private__.combineFontStyleAndFontWeight=function(re,ze){if(re=="bold"&&ze=="normal"||re=="bold"&&ze==400||re=="normal"&&ze=="italic"||re=="bold"&&ze=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return ze&&(re=ze==400||ze==="normal"?re==="italic"?"italic":"normal":ze!=700&&ze!=="bold"||re!=="normal"?(ze==700?"bold":ze)+""+re:"bold"),re};y.advancedAPI=function(re){var ze=D===P;return ze&&L.call(this),typeof re!="function"||(re(this),ze&&N.call(this)),this},y.compatAPI=function(re){var ze=D===C;return ze&&N.call(this),typeof re!="function"||(re(this),ze&&L.call(this)),this},y.isAdvancedAPI=function(){return D===C};var $,U=function(re){if(D!==C)throw new Error(re+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},G=y.roundToPrecision=y.__private__.roundToPrecision=function(re,ze){var pt=t||ze;if(isNaN(re)||isNaN(pt))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return re.toFixed(pt).replace(/0+$/,"")};$=y.hpf=y.__private__.hpf=typeof u=="number"?function(re){if(isNaN(re))throw new Error("Invalid argument passed to jsPDF.hpf");return G(re,u)}:u==="smart"?function(re){if(isNaN(re))throw new Error("Invalid argument passed to jsPDF.hpf");return G(re,re>-1&&re<1?16:5)}:function(re){if(isNaN(re))throw new Error("Invalid argument passed to jsPDF.hpf");return G(re,16)};var H=y.f2=y.__private__.f2=function(re){if(isNaN(re))throw new Error("Invalid argument passed to jsPDF.f2");return G(re,2)},X=y.__private__.f3=function(re){if(isNaN(re))throw new Error("Invalid argument passed to jsPDF.f3");return G(re,3)},ee=y.scale=y.__private__.scale=function(re){if(isNaN(re))throw new Error("Invalid argument passed to jsPDF.scale");return D===P?re*Se:D===C?re:void 0},ae=function(re){return ee(function(ze){return D===P?vo()-ze:D===C?ze:void 0}(re))};y.__private__.setPrecision=y.setPrecision=function(re){typeof parseInt(re,10)=="number"&&(t=parseInt(re,10))};var de,ye="00000000000000000000000000000000",_e=y.__private__.getFileId=function(){return ye},ue=y.__private__.setFileId=function(re){return ye=re!==void 0&&/^[a-fA-F0-9]{32}$/.test(re)?re.toUpperCase():ye.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),m!==null&&(yo=new jv(m.userPermissions,m.userPassword,m.ownerPassword,ye)),ye};y.setFileId=function(re){return ue(re),this},y.getFileId=function(){return _e()};var fe=y.__private__.convertDateToPDFDate=function(re){var ze=re.getTimezoneOffset(),pt=ze<0?"+":"-",Ut=Math.floor(Math.abs(ze/60)),Qt=Math.abs(ze%60),Er=[pt,ve(Ut),"'",ve(Qt),"'"].join("");return["D:",re.getFullYear(),ve(re.getMonth()+1),ve(re.getDate()),ve(re.getHours()),ve(re.getMinutes()),ve(re.getSeconds()),Er].join("")},De=y.__private__.convertPDFDateToDate=function(re){var ze=parseInt(re.substr(2,4),10),pt=parseInt(re.substr(6,2),10)-1,Ut=parseInt(re.substr(8,2),10),Qt=parseInt(re.substr(10,2),10),Er=parseInt(re.substr(12,2),10),jr=parseInt(re.substr(14,2),10);return new Date(ze,pt,Ut,Qt,Er,jr,0)},pe=y.__private__.setCreationDate=function(re){var ze;if(re===void 0&&(re=new Date),re instanceof Date)ze=fe(re);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(re))throw new Error("Invalid argument passed to jsPDF.setCreationDate");ze=re}return de=ze},K=y.__private__.getCreationDate=function(re){var ze=de;return re==="jsDate"&&(ze=De(de)),ze};y.setCreationDate=function(re){return pe(re),this},y.getCreationDate=function(re){return K(re)};var te,ve=y.__private__.padd2=function(re){return("0"+parseInt(re)).slice(-2)},$e=y.__private__.padd2Hex=function(re){return("00"+(re=re.toString())).substr(re.length)},Ce=0,Ge=[],ot=[],Ye=0,et=[],Te=[],Le=!1,ke=ot;y.__private__.setCustomOutputDestination=function(re){Le=!0,ke=re};var Xe=function(re){Le||(ke=re)};y.__private__.resetCustomOutputDestination=function(){Le=!1,ke=ot};var Ne=y.__private__.out=function(re){return re=re.toString(),Ye+=re.length+1,ke.push(re),ke},Ot=y.__private__.write=function(re){return Ne(arguments.length===1?re.toString():Array.prototype.join.call(arguments," "))},Lt=y.__private__.getArrayBuffer=function(re){for(var ze=re.length,pt=new ArrayBuffer(ze),Ut=new Uint8Array(pt);ze--;)Ut[ze]=re.charCodeAt(ze);return pt},kt=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];y.__private__.getStandardFonts=function(){return kt};var mt=e.fontSize||16;y.__private__.setFontSize=y.setFontSize=function(re){return mt=D===C?re/Se:re,this};var Zt,Kt=y.__private__.getFontSize=y.getFontSize=function(){return D===P?mt:mt*Se},dr=e.R2L||!1;y.__private__.setR2L=y.setR2L=function(re){return dr=re,this},y.__private__.getR2L=y.getR2L=function(){return dr};var Bt,wr=y.__private__.setZoomMode=function(re){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(re))Zt=re;else if(isNaN(re)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(re)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+re+'" is not recognized.');Zt=re}else Zt=parseInt(re,10)};y.__private__.getZoomMode=function(){return Zt};var mr,hr=y.__private__.setPageMode=function(re){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(re)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+re+'" is not recognized.');Bt=re};y.__private__.getPageMode=function(){return Bt};var xr=y.__private__.setLayoutMode=function(re){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(re)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+re+'" is not recognized.');mr=re};y.__private__.getLayoutMode=function(){return mr},y.__private__.setDisplayMode=y.setDisplayMode=function(re,ze,pt){return wr(re),xr(ze),hr(pt),this};var or={title:"",subject:"",author:"",keywords:"",creator:""};y.__private__.getDocumentProperty=function(re){if(Object.keys(or).indexOf(re)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return or[re]},y.__private__.getDocumentProperties=function(){return or},y.__private__.setDocumentProperties=y.setProperties=y.setDocumentProperties=function(re){for(var ze in or)or.hasOwnProperty(ze)&&re[ze]&&(or[ze]=re[ze]);return this},y.__private__.setDocumentProperty=function(re,ze){if(Object.keys(or).indexOf(re)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return or[re]=ze};var tt,Se,Pe,Ve,Qe,dt={},Pt={},Vt=[],At={},qt={},er={},fr={},Jr=null,$t=0,zr=[],Sr=new DK(y),Ir=e.hotfixes||[],Xr={},qr={},An=[],ge=function re(ze,pt,Ut,Qt,Er,jr){if(!(this instanceof re))return new re(ze,pt,Ut,Qt,Er,jr);isNaN(ze)&&(ze=1),isNaN(pt)&&(pt=0),isNaN(Ut)&&(Ut=0),isNaN(Qt)&&(Qt=1),isNaN(Er)&&(Er=0),isNaN(jr)&&(jr=0),this._matrix=[ze,pt,Ut,Qt,Er,jr]};Object.defineProperty(ge.prototype,"sx",{get:function(){return this._matrix[0]},set:function(re){this._matrix[0]=re}}),Object.defineProperty(ge.prototype,"shy",{get:function(){return this._matrix[1]},set:function(re){this._matrix[1]=re}}),Object.defineProperty(ge.prototype,"shx",{get:function(){return this._matrix[2]},set:function(re){this._matrix[2]=re}}),Object.defineProperty(ge.prototype,"sy",{get:function(){return this._matrix[3]},set:function(re){this._matrix[3]=re}}),Object.defineProperty(ge.prototype,"tx",{get:function(){return this._matrix[4]},set:function(re){this._matrix[4]=re}}),Object.defineProperty(ge.prototype,"ty",{get:function(){return this._matrix[5]},set:function(re){this._matrix[5]=re}}),Object.defineProperty(ge.prototype,"a",{get:function(){return this._matrix[0]},set:function(re){this._matrix[0]=re}}),Object.defineProperty(ge.prototype,"b",{get:function(){return this._matrix[1]},set:function(re){this._matrix[1]=re}}),Object.defineProperty(ge.prototype,"c",{get:function(){return this._matrix[2]},set:function(re){this._matrix[2]=re}}),Object.defineProperty(ge.prototype,"d",{get:function(){return this._matrix[3]},set:function(re){this._matrix[3]=re}}),Object.defineProperty(ge.prototype,"e",{get:function(){return this._matrix[4]},set:function(re){this._matrix[4]=re}}),Object.defineProperty(ge.prototype,"f",{get:function(){return this._matrix[5]},set:function(re){this._matrix[5]=re}}),Object.defineProperty(ge.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(ge.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(ge.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(ge.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),ge.prototype.join=function(re){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map($).join(re)},ge.prototype.multiply=function(re){var ze=re.sx*this.sx+re.shy*this.shx,pt=re.sx*this.shy+re.shy*this.sy,Ut=re.shx*this.sx+re.sy*this.shx,Qt=re.shx*this.shy+re.sy*this.sy,Er=re.tx*this.sx+re.ty*this.shx+this.tx,jr=re.tx*this.shy+re.ty*this.sy+this.ty;return new ge(ze,pt,Ut,Qt,Er,jr)},ge.prototype.decompose=function(){var re=this.sx,ze=this.shy,pt=this.shx,Ut=this.sy,Qt=this.tx,Er=this.ty,jr=Math.sqrt(re*re+ze*ze),Sn=(re/=jr)*pt+(ze/=jr)*Ut;pt-=re*Sn,Ut-=ze*Sn;var vn=Math.sqrt(pt*pt+Ut*Ut);return Sn/=vn,re*(Ut/=vn)<ze*(pt/=vn)&&(re=-re,ze=-ze,Sn=-Sn,jr=-jr),{scale:new ge(jr,0,0,vn,0,0),translate:new ge(1,0,0,1,Qt,Er),rotate:new ge(re,ze,-ze,re,0,0),skew:new ge(1,0,Sn,1,0,0)}},ge.prototype.toString=function(re){return this.join(" ")},ge.prototype.inversed=function(){var re=this.sx,ze=this.shy,pt=this.shx,Ut=this.sy,Qt=this.tx,Er=this.ty,jr=1/(re*Ut-ze*pt),Sn=Ut*jr,vn=-ze*jr,Zn=-pt*jr,Xn=re*jr;return new ge(Sn,vn,Zn,Xn,-Sn*Qt-Zn*Er,-vn*Qt-Xn*Er)},ge.prototype.applyToPoint=function(re){var ze=re.x*this.sx+re.y*this.shx+this.tx,pt=re.x*this.shy+re.y*this.sy+this.ty;return new ga(ze,pt)},ge.prototype.applyToRectangle=function(re){var ze=this.applyToPoint(re),pt=this.applyToPoint(new ga(re.x+re.w,re.y+re.h));return new ws(ze.x,ze.y,pt.x-ze.x,pt.y-ze.y)},ge.prototype.clone=function(){var re=this.sx,ze=this.shy,pt=this.shx,Ut=this.sy,Qt=this.tx,Er=this.ty;return new ge(re,ze,pt,Ut,Qt,Er)},y.Matrix=ge;var ut=y.matrixMult=function(re,ze){return ze.multiply(re)},We=new ge(1,0,0,1,0,0);y.unitMatrix=y.identityMatrix=We;var Je=function(re,ze){if(!qt[re]){var pt=(ze instanceof Py?"Sh":"P")+(Object.keys(At).length+1).toString(10);ze.id=pt,qt[re]=pt,At[pt]=ze,Sr.publish("addPattern",ze)}};y.ShadingPattern=Py,y.TilingPattern=u1,y.addShadingPattern=function(re,ze){return U("addShadingPattern()"),Je(re,ze),this},y.beginTilingPattern=function(re){U("beginTilingPattern()"),fl(re.boundingBox[0],re.boundingBox[1],re.boundingBox[2]-re.boundingBox[0],re.boundingBox[3]-re.boundingBox[1],re.matrix)},y.endTilingPattern=function(re,ze){U("endTilingPattern()"),ze.stream=Te[te].join(`
`),Je(re,ze),Sr.publish("endTilingPattern",ze),An.pop().restore()};var xt,wt=y.__private__.newObject=function(){var re=pr();return Rr(re,!0),re},pr=y.__private__.newObjectDeferred=function(){return Ce++,Ge[Ce]=function(){return Ye},Ce},Rr=function(re,ze){return ze=typeof ze=="boolean"&&ze,Ge[re]=Ye,ze&&Ne(re+" 0 obj"),re},On=y.__private__.newAdditionalObject=function(){var re={objId:pr(),content:""};return et.push(re),re},Mn=pr(),_r=pr(),Or=y.__private__.decodeColorString=function(re){var ze=re.split(" ");if(ze.length!==2||ze[1]!=="g"&&ze[1]!=="G")ze.length!==5||ze[4]!=="k"&&ze[4]!=="K"||(ze=[(1-ze[0])*(1-ze[3]),(1-ze[1])*(1-ze[3]),(1-ze[2])*(1-ze[3]),"r"]);else{var pt=parseFloat(ze[0]);ze=[pt,pt,pt,"r"]}for(var Ut="#",Qt=0;Qt<3;Qt++)Ut+=("0"+Math.floor(255*parseFloat(ze[Qt])).toString(16)).slice(-2);return Ut},an=y.__private__.encodeColorString=function(re){var ze;typeof re=="string"&&(re={ch1:re});var pt=re.ch1,Ut=re.ch2,Qt=re.ch3,Er=re.ch4,jr=re.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof pt=="string"&&pt.charAt(0)!=="#"){var Sn=new uhe(pt);if(Sn.ok)pt=Sn.toHex();else if(!/^\d*\.?\d*$/.test(pt))throw new Error('Invalid color "'+pt+'" passed to jsPDF.encodeColorString.')}if(typeof pt=="string"&&/^#[0-9A-Fa-f]{3}$/.test(pt)&&(pt="#"+pt[1]+pt[1]+pt[2]+pt[2]+pt[3]+pt[3]),typeof pt=="string"&&/^#[0-9A-Fa-f]{6}$/.test(pt)){var vn=parseInt(pt.substr(1),16);pt=vn>>16&255,Ut=vn>>8&255,Qt=255&vn}if(Ut===void 0||Er===void 0&&pt===Ut&&Ut===Qt)ze=typeof pt=="string"?pt+" "+jr[0]:re.precision===2?H(pt/255)+" "+jr[0]:X(pt/255)+" "+jr[0];else if(Er===void 0||Ma(Er)==="object"){if(Er&&!isNaN(Er.a)&&Er.a===0)return["1.","1.","1.",jr[1]].join(" ");ze=typeof pt=="string"?[pt,Ut,Qt,jr[1]].join(" "):re.precision===2?[H(pt/255),H(Ut/255),H(Qt/255),jr[1]].join(" "):[X(pt/255),X(Ut/255),X(Qt/255),jr[1]].join(" ")}else ze=typeof pt=="string"?[pt,Ut,Qt,Er,jr[2]].join(" "):re.precision===2?[H(pt),H(Ut),H(Qt),H(Er),jr[2]].join(" "):[X(pt),X(Ut),X(Qt),X(Er),jr[2]].join(" ");return ze},Vn=y.__private__.getFilters=function(){return s},_o=y.__private__.putStream=function(re){var ze=(re=re||{}).data||"",pt=re.filters||Vn(),Ut=re.alreadyAppliedFilters||[],Qt=re.addLength1||!1,Er=ze.length,jr=re.objectId,Sn=function(ca){return ca};if(m!==null&&jr===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");m!==null&&(Sn=yo.encryptor(jr,0));var vn={};pt===!0&&(pt=["FlateEncode"]);var Zn=re.additionalKeyValues||[],Xn=(vn=ai.API.processDataByFilters!==void 0?ai.API.processDataByFilters(ze,pt):{data:ze,reverseChain:[]}).reverseChain+(Array.isArray(Ut)?Ut.join(" "):Ut.toString());if(vn.data.length!==0&&(Zn.push({key:"Length",value:vn.data.length}),Qt===!0&&Zn.push({key:"Length1",value:Er})),Xn.length!=0)if(Xn.split("/").length-1==1)Zn.push({key:"Filter",value:Xn});else{Zn.push({key:"Filter",value:"["+Xn+"]"});for(var Ui=0;Ui<Zn.length;Ui+=1)if(Zn[Ui].key==="DecodeParms"){for(var Ao=[],Ko=0;Ko<vn.reverseChain.split("/").length-1;Ko+=1)Ao.push("null");Ao.push(Zn[Ui].value),Zn[Ui].value="["+Ao.join(" ")+"]"}}Ne("<<");for(var pi=0;pi<Zn.length;pi++)Ne("/"+Zn[pi].key+" "+Zn[pi].value);Ne(">>"),vn.data.length!==0&&(Ne("stream"),Ne(Sn(vn.data)),Ne("endstream"))},Uo=y.__private__.putPage=function(re){var ze=re.number,pt=re.data,Ut=re.objId,Qt=re.contentsObjId;Rr(Ut,!0),Ne("<</Type /Page"),Ne("/Parent "+re.rootDictionaryObjId+" 0 R"),Ne("/Resources "+re.resourceDictionaryObjId+" 0 R"),Ne("/MediaBox ["+parseFloat($(re.mediaBox.bottomLeftX))+" "+parseFloat($(re.mediaBox.bottomLeftY))+" "+$(re.mediaBox.topRightX)+" "+$(re.mediaBox.topRightY)+"]"),re.cropBox!==null&&Ne("/CropBox ["+$(re.cropBox.bottomLeftX)+" "+$(re.cropBox.bottomLeftY)+" "+$(re.cropBox.topRightX)+" "+$(re.cropBox.topRightY)+"]"),re.bleedBox!==null&&Ne("/BleedBox ["+$(re.bleedBox.bottomLeftX)+" "+$(re.bleedBox.bottomLeftY)+" "+$(re.bleedBox.topRightX)+" "+$(re.bleedBox.topRightY)+"]"),re.trimBox!==null&&Ne("/TrimBox ["+$(re.trimBox.bottomLeftX)+" "+$(re.trimBox.bottomLeftY)+" "+$(re.trimBox.topRightX)+" "+$(re.trimBox.topRightY)+"]"),re.artBox!==null&&Ne("/ArtBox ["+$(re.artBox.bottomLeftX)+" "+$(re.artBox.bottomLeftY)+" "+$(re.artBox.topRightX)+" "+$(re.artBox.topRightY)+"]"),typeof re.userUnit=="number"&&re.userUnit!==1&&Ne("/UserUnit "+re.userUnit),Sr.publish("putPage",{objId:Ut,pageContext:zr[ze],pageNumber:ze,page:pt}),Ne("/Contents "+Qt+" 0 R"),Ne(">>"),Ne("endobj");var Er=pt.join(`
`);return D===C&&(Er+=`
Q`),Rr(Qt,!0),_o({data:Er,filters:Vn(),objectId:Qt}),Ne("endobj"),Ut},yn=y.__private__.putPages=function(){var re,ze,pt=[];for(re=1;re<=$t;re++)zr[re].objId=pr(),zr[re].contentsObjId=pr();for(re=1;re<=$t;re++)pt.push(Uo({number:re,data:Te[re],objId:zr[re].objId,contentsObjId:zr[re].contentsObjId,mediaBox:zr[re].mediaBox,cropBox:zr[re].cropBox,bleedBox:zr[re].bleedBox,trimBox:zr[re].trimBox,artBox:zr[re].artBox,userUnit:zr[re].userUnit,rootDictionaryObjId:Mn,resourceDictionaryObjId:_r}));Rr(Mn,!0),Ne("<</Type /Pages");var Ut="/Kids [";for(ze=0;ze<$t;ze++)Ut+=pt[ze]+" 0 R ";Ne(Ut+"]"),Ne("/Count "+$t),Ne(">>"),Ne("endobj"),Sr.publish("postPutPages")},Vo=function(re){Sr.publish("putFont",{font:re,out:Ne,newObject:wt,putStream:_o}),re.isAlreadyPutted!==!0&&(re.objectNumber=wt(),Ne("<<"),Ne("/Type /Font"),Ne("/BaseFont /"+Rv(re.postScriptName)),Ne("/Subtype /Type1"),typeof re.encoding=="string"&&Ne("/Encoding /"+re.encoding),Ne("/FirstChar 32"),Ne("/LastChar 255"),Ne(">>"),Ne("endobj"))},Po=function(re){re.objectNumber=wt();var ze=[];ze.push({key:"Type",value:"/XObject"}),ze.push({key:"Subtype",value:"/Form"}),ze.push({key:"BBox",value:"["+[$(re.x),$(re.y),$(re.x+re.width),$(re.y+re.height)].join(" ")+"]"}),ze.push({key:"Matrix",value:"["+re.matrix.toString()+"]"});var pt=re.pages[1].join(`
`);_o({data:pt,additionalKeyValues:ze,objectId:re.objectNumber}),Ne("endobj")},pa=function(re,ze){ze||(ze=21);var pt=wt(),Ut=function(jr,Sn){var vn,Zn=[],Xn=1/(Sn-1);for(vn=0;vn<1;vn+=Xn)Zn.push(vn);if(Zn.push(1),jr[0].offset!=0){var Ui={offset:0,color:jr[0].color};jr.unshift(Ui)}if(jr[jr.length-1].offset!=1){var Ao={offset:1,color:jr[jr.length-1].color};jr.push(Ao)}for(var Ko="",pi=0,ca=0;ca<Zn.length;ca++){for(vn=Zn[ca];vn>jr[pi+1].offset;)pi++;var jo=jr[pi].offset,Oa=(vn-jo)/(jr[pi+1].offset-jo),pl=jr[pi].color,yc=jr[pi+1].color;Ko+=$e(Math.round((1-Oa)*pl[0]+Oa*yc[0]).toString(16))+$e(Math.round((1-Oa)*pl[1]+Oa*yc[1]).toString(16))+$e(Math.round((1-Oa)*pl[2]+Oa*yc[2]).toString(16))}return Ko.trim()}(re.colors,ze),Qt=[];Qt.push({key:"FunctionType",value:"0"}),Qt.push({key:"Domain",value:"[0.0 1.0]"}),Qt.push({key:"Size",value:"["+ze+"]"}),Qt.push({key:"BitsPerSample",value:"8"}),Qt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Qt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),_o({data:Ut,additionalKeyValues:Qt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:pt}),Ne("endobj"),re.objectNumber=wt(),Ne("<< /ShadingType "+re.type),Ne("/ColorSpace /DeviceRGB");var Er="/Coords ["+$(parseFloat(re.coords[0]))+" "+$(parseFloat(re.coords[1]))+" ";re.type===2?Er+=$(parseFloat(re.coords[2]))+" "+$(parseFloat(re.coords[3])):Er+=$(parseFloat(re.coords[2]))+" "+$(parseFloat(re.coords[3]))+" "+$(parseFloat(re.coords[4]))+" "+$(parseFloat(re.coords[5])),Ne(Er+="]"),re.matrix&&Ne("/Matrix ["+re.matrix.toString()+"]"),Ne("/Function "+pt+" 0 R"),Ne("/Extend [true true]"),Ne(">>"),Ne("endobj")},ta=function(re,ze){var pt=pr(),Ut=wt();ze.push({resourcesOid:pt,objectOid:Ut}),re.objectNumber=Ut;var Qt=[];Qt.push({key:"Type",value:"/Pattern"}),Qt.push({key:"PatternType",value:"1"}),Qt.push({key:"PaintType",value:"1"}),Qt.push({key:"TilingType",value:"1"}),Qt.push({key:"BBox",value:"["+re.boundingBox.map($).join(" ")+"]"}),Qt.push({key:"XStep",value:$(re.xStep)}),Qt.push({key:"YStep",value:$(re.yStep)}),Qt.push({key:"Resources",value:pt+" 0 R"}),re.matrix&&Qt.push({key:"Matrix",value:"["+re.matrix.toString()+"]"}),_o({data:re.stream,additionalKeyValues:Qt,objectId:re.objectNumber}),Ne("endobj")},ra=function(re){for(var ze in re.objectNumber=wt(),Ne("<<"),re)switch(ze){case"opacity":Ne("/ca "+H(re[ze]));break;case"stroke-opacity":Ne("/CA "+H(re[ze]))}Ne(">>"),Ne("endobj")},so=function(re){Rr(re.resourcesOid,!0),Ne("<<"),Ne("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var ze in Ne("/Font <<"),dt)dt.hasOwnProperty(ze)&&(g===!1||g===!0&&_.hasOwnProperty(ze))&&Ne("/"+ze+" "+dt[ze].objectNumber+" 0 R");Ne(">>")}(),function(){if(Object.keys(At).length>0){for(var ze in Ne("/Shading <<"),At)At.hasOwnProperty(ze)&&At[ze]instanceof Py&&At[ze].objectNumber>=0&&Ne("/"+ze+" "+At[ze].objectNumber+" 0 R");Sr.publish("putShadingPatternDict"),Ne(">>")}}(),function(ze){if(Object.keys(At).length>0){for(var pt in Ne("/Pattern <<"),At)At.hasOwnProperty(pt)&&At[pt]instanceof y.TilingPattern&&At[pt].objectNumber>=0&&At[pt].objectNumber<ze&&Ne("/"+pt+" "+At[pt].objectNumber+" 0 R");Sr.publish("putTilingPatternDict"),Ne(">>")}}(re.objectOid),function(){if(Object.keys(er).length>0){var ze;for(ze in Ne("/ExtGState <<"),er)er.hasOwnProperty(ze)&&er[ze].objectNumber>=0&&Ne("/"+ze+" "+er[ze].objectNumber+" 0 R");Sr.publish("putGStateDict"),Ne(">>")}}(),function(){for(var ze in Ne("/XObject <<"),Xr)Xr.hasOwnProperty(ze)&&Xr[ze].objectNumber>=0&&Ne("/"+ze+" "+Xr[ze].objectNumber+" 0 R");Sr.publish("putXobjectDict"),Ne(">>")}(),Ne(">>"),Ne("endobj")},Xs=function(re){Pt[re.fontName]=Pt[re.fontName]||{},Pt[re.fontName][re.fontStyle]=re.id},xo=function(re,ze,pt,Ut,Qt){var Er={id:"F"+(Object.keys(dt).length+1).toString(10),postScriptName:re,fontName:ze,fontStyle:pt,encoding:Ut,isStandardFont:Qt||!1,metadata:{}};return Sr.publish("addFont",{font:Er,instance:this}),dt[Er.id]=Er,Xs(Er),Er.id},Qn=y.__private__.pdfEscape=y.pdfEscape=function(re,ze){return function(pt,Ut){var Qt,Er,jr,Sn,vn,Zn,Xn,Ui,Ao;if(jr=(Ut=Ut||{}).sourceEncoding||"Unicode",vn=Ut.outputEncoding,(Ut.autoencode||vn)&&dt[tt].metadata&&dt[tt].metadata[jr]&&dt[tt].metadata[jr].encoding&&(Sn=dt[tt].metadata[jr].encoding,!vn&&dt[tt].encoding&&(vn=dt[tt].encoding),!vn&&Sn.codePages&&(vn=Sn.codePages[0]),typeof vn=="string"&&(vn=Sn[vn]),vn)){for(Xn=!1,Zn=[],Qt=0,Er=pt.length;Qt<Er;Qt++)(Ui=vn[pt.charCodeAt(Qt)])?Zn.push(String.fromCharCode(Ui)):Zn.push(pt[Qt]),Zn[Qt].charCodeAt(0)>>8&&(Xn=!0);pt=Zn.join("")}for(Qt=pt.length;Xn===void 0&&Qt!==0;)pt.charCodeAt(Qt-1)>>8&&(Xn=!0),Qt--;if(!Xn)return pt;for(Zn=Ut.noBOM?[]:[254,255],Qt=0,Er=pt.length;Qt<Er;Qt++){if((Ao=(Ui=pt.charCodeAt(Qt))>>8)>>8)throw new Error("Character at position "+Qt+" of string '"+pt+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Zn.push(Ao),Zn.push(Ui-(Ao<<8))}return String.fromCharCode.apply(void 0,Zn)}(re,ze).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},is=y.__private__.beginPage=function(re){Te[++$t]=[],zr[$t]={objId:0,contentsObjId:0,userUnit:Number(a),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(re[0]),topRightY:Number(re[1])}},wo($t),Xe(Te[te])},la=function(re,ze){var pt,Ut,Qt;switch(r=ze||r,typeof re=="string"&&(pt=T(re.toLowerCase()),Array.isArray(pt)&&(Ut=pt[0],Qt=pt[1])),Array.isArray(re)&&(Ut=re[0]*Se,Qt=re[1]*Se),isNaN(Ut)&&(Ut=i[0],Qt=i[1]),(Ut>14400||Qt>14400)&&(Ba.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Ut=Math.min(14400,Ut),Qt=Math.min(14400,Qt)),i=[Ut,Qt],r.substr(0,1)){case"l":Qt>Ut&&(i=[Qt,Ut]);break;case"p":Ut>Qt&&(i=[Qt,Ut])}is(i),Xi(Ai),Ne(Ho),Qi!==0&&Ne(Qi+" J"),co!==0&&Ne(co+" j"),Sr.publish("addPage",{pageNumber:$t})},$s=function(re){re>0&&re<=$t&&(Te.splice(re,1),zr.splice(re,1),$t--,te>$t&&(te=$t),this.setPage(te))},wo=function(re){re>0&&re<=$t&&(te=re)},Eo=y.__private__.getNumberOfPages=y.getNumberOfPages=function(){return Te.length-1},Wa=function(re,ze,pt){var Ut,Qt=void 0;return pt=pt||{},re=re!==void 0?re:dt[tt].fontName,ze=ze!==void 0?ze:dt[tt].fontStyle,Ut=re.toLowerCase(),Pt[Ut]!==void 0&&Pt[Ut][ze]!==void 0?Qt=Pt[Ut][ze]:Pt[re]!==void 0&&Pt[re][ze]!==void 0?Qt=Pt[re][ze]:pt.disableWarning===!1&&Ba.warn("Unable to look up font label for font '"+re+"', '"+ze+"'. Refer to getFontList() for available fonts."),Qt||pt.noFallback||(Qt=Pt.times[ze])==null&&(Qt=Pt.times.normal),Qt},ul=y.__private__.putInfo=function(){var re=wt(),ze=function(Ut){return Ut};for(var pt in m!==null&&(ze=yo.encryptor(re,0)),Ne("<<"),Ne("/Producer ("+Qn(ze("jsPDF "+ai.version))+")"),or)or.hasOwnProperty(pt)&&or[pt]&&Ne("/"+pt.substr(0,1).toUpperCase()+pt.substr(1)+" ("+Qn(ze(or[pt]))+")");Ne("/CreationDate ("+Qn(ze(de))+")"),Ne(">>"),Ne("endobj")},os=y.__private__.putCatalog=function(re){var ze=(re=re||{}).rootDictionaryObjId||Mn;switch(wt(),Ne("<<"),Ne("/Type /Catalog"),Ne("/Pages "+ze+" 0 R"),Zt||(Zt="fullwidth"),Zt){case"fullwidth":Ne("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Ne("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Ne("/OpenAction [3 0 R /Fit]");break;case"original":Ne("/OpenAction [3 0 R /XYZ null null 1]");break;default:var pt=""+Zt;pt.substr(pt.length-1)==="%"&&(Zt=parseInt(Zt)/100),typeof Zt=="number"&&Ne("/OpenAction [3 0 R /XYZ null null "+H(Zt)+"]")}switch(mr||(mr="continuous"),mr){case"continuous":Ne("/PageLayout /OneColumn");break;case"single":Ne("/PageLayout /SinglePage");break;case"two":case"twoleft":Ne("/PageLayout /TwoColumnLeft");break;case"tworight":Ne("/PageLayout /TwoColumnRight")}Bt&&Ne("/PageMode /"+Bt),Sr.publish("putCatalog"),Ne(">>"),Ne("endobj")},Pr=y.__private__.putTrailer=function(){Ne("trailer"),Ne("<<"),Ne("/Size "+(Ce+1)),Ne("/Root "+Ce+" 0 R"),Ne("/Info "+(Ce-1)+" 0 R"),m!==null&&Ne("/Encrypt "+yo.oid+" 0 R"),Ne("/ID [ <"+ye+"> <"+ye+"> ]"),Ne(">>")},Hr=y.__private__.putHeader=function(){Ne("%PDF-"+M),Ne("%ºß¬à")},gn=y.__private__.putXRef=function(){var re="0000000000";Ne("xref"),Ne("0 "+(Ce+1)),Ne("0000000000 65535 f ");for(var ze=1;ze<=Ce;ze++)typeof Ge[ze]=="function"?Ne((re+Ge[ze]()).slice(-10)+" 00000 n "):Ge[ze]!==void 0?Ne((re+Ge[ze]).slice(-10)+" 00000 n "):Ne("0000000000 00000 n ")},Zi=y.__private__.buildDocument=function(){var re;Ce=0,Ye=0,ot=[],Ge=[],et=[],Mn=pr(),_r=pr(),Xe(ot),Sr.publish("buildDocument"),Hr(),yn(),function(){Sr.publish("putAdditionalObjects");for(var pt=0;pt<et.length;pt++){var Ut=et[pt];Rr(Ut.objId,!0),Ne(Ut.content),Ne("endobj")}Sr.publish("postPutAdditionalObjects")}(),re=[],function(){for(var pt in dt)dt.hasOwnProperty(pt)&&(g===!1||g===!0&&_.hasOwnProperty(pt))&&Vo(dt[pt])}(),function(){var pt;for(pt in er)er.hasOwnProperty(pt)&&ra(er[pt])}(),function(){for(var pt in Xr)Xr.hasOwnProperty(pt)&&Po(Xr[pt])}(),function(pt){var Ut;for(Ut in At)At.hasOwnProperty(Ut)&&(At[Ut]instanceof Py?pa(At[Ut]):At[Ut]instanceof u1&&ta(At[Ut],pt))}(re),Sr.publish("putResources"),re.forEach(so),so({resourcesOid:_r,objectOid:Number.MAX_SAFE_INTEGER}),Sr.publish("postPutResources"),m!==null&&(yo.oid=wt(),Ne("<<"),Ne("/Filter /Standard"),Ne("/V "+yo.v),Ne("/R "+yo.r),Ne("/U <"+yo.toHexString(yo.U)+">"),Ne("/O <"+yo.toHexString(yo.O)+">"),Ne("/P "+yo.P),Ne(">>"),Ne("endobj")),ul(),os();var ze=Ye;return gn(),Pr(),Ne("startxref"),Ne(""+ze),Ne("%%EOF"),Xe(Te[te]),ot.join(`
`)},dl=y.__private__.getBlob=function(re){return new Blob([Lt(re)],{type:"application/pdf"})},ba=y.output=y.__private__.output=(xt=function(re,ze){switch(typeof(ze=ze||{})=="string"?ze={filename:ze}:ze.filename=ze.filename||"generated.pdf",re){case void 0:return Zi();case"save":y.save(ze.filename);break;case"arraybuffer":return Lt(Zi());case"blob":return dl(Zi());case"bloburi":case"bloburl":if(Ni.URL!==void 0&&typeof Ni.URL.createObjectURL=="function")return Ni.URL&&Ni.URL.createObjectURL(dl(Zi()))||void 0;Ba.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var pt="",Ut=Zi();try{pt=IK(Ut)}catch{pt=IK(unescape(encodeURIComponent(Ut)))}return"data:application/pdf;filename="+ze.filename+";base64,"+pt;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Ni)==="[object Window]"){var Qt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Er=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';ze.pdfObjectUrl&&(Qt=ze.pdfObjectUrl,Er="");var jr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Qt+'"'+Er+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(ze)+");<\/script></body></html>",Sn=Ni.open();return Sn!==null&&Sn.document.write(jr),Sn}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Ni)==="[object Window]"){var vn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(ze.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+ze.filename+'" width="500px" height="400px" /></body></html>',Zn=Ni.open();if(Zn!==null){Zn.document.write(vn);var Xn=this;Zn.document.documentElement.querySelector("#pdfViewer").onload=function(){Zn.document.title=ze.filename,Zn.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Xn.output("bloburl"))}}return Zn}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Ni)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Ui='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",ze)+'"></iframe></body></html>',Ao=Ni.open();if(Ao!==null&&(Ao.document.write(Ui),Ao.document.title=ze.filename),Ao||typeof safari>"u")return Ao;break;case"datauri":case"dataurl":return Ni.document.location.href=this.output("datauristring",ze);default:return null}},xt.foo=function(){try{return xt.apply(this,arguments)}catch(pt){var re=pt.stack||"";~re.indexOf(" at ")&&(re=re.split(" at ")[1]);var ze="Error in function "+re.split(`
`)[0].split("<")[0]+": "+pt.message;if(!Ni.console)throw new Error(ze);Ni.console.error(ze,pt),Ni.alert&&alert(ze)}},xt.foo.bar=xt,xt.foo),Ga=function(re){return Array.isArray(Ir)===!0&&Ir.indexOf(re)>-1};switch(n){case"pt":Se=1;break;case"mm":Se=72/25.4;break;case"cm":Se=72/2.54;break;case"in":Se=72;break;case"px":Se=Ga("px_scaling")==1?.75:96/72;break;case"pc":case"em":Se=12;break;case"ex":Se=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);Se=n}var yo=null;pe(),ue();var Xl=y.__private__.getPageInfo=y.getPageInfo=function(re){if(isNaN(re)||re%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:zr[re].objId,pageNumber:re,pageContext:zr[re]}},Dl=y.__private__.getPageInfoByObjId=function(re){if(isNaN(re)||re%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var ze in zr)if(zr[ze].objId===re)break;return Xl(ze)},Uc=y.__private__.getCurrentPageInfo=y.getCurrentPageInfo=function(){return{objId:zr[te].objId,pageNumber:te,pageContext:zr[te]}};y.addPage=function(){return la.apply(this,arguments),this},y.setPage=function(){return wo.apply(this,arguments),Xe.call(this,Te[te]),this},y.insertPage=function(re){return this.addPage(),this.movePage(te,re),this},y.movePage=function(re,ze){var pt,Ut;if(re>ze){pt=Te[re],Ut=zr[re];for(var Qt=re;Qt>ze;Qt--)Te[Qt]=Te[Qt-1],zr[Qt]=zr[Qt-1];Te[ze]=pt,zr[ze]=Ut,this.setPage(ze)}else if(re<ze){pt=Te[re],Ut=zr[re];for(var Er=re;Er<ze;Er++)Te[Er]=Te[Er+1],zr[Er]=zr[Er+1];Te[ze]=pt,zr[ze]=Ut,this.setPage(ze)}return this},y.deletePage=function(){return $s.apply(this,arguments),this},y.__private__.text=y.text=function(re,ze,pt,Ut,Qt){var Er,jr,Sn,vn,Zn,Xn,Ui,Ao,Ko,pi=(Ut=Ut||{}).scope||this;if(typeof re=="number"&&typeof ze=="number"&&(typeof pt=="string"||Array.isArray(pt))){var ca=pt;pt=ze,ze=re,re=ca}if(arguments[3]instanceof ge==0?(Sn=arguments[4],vn=arguments[5],Ma(Ui=arguments[3])==="object"&&Ui!==null||(typeof Sn=="string"&&(vn=Sn,Sn=null),typeof Ui=="string"&&(vn=Ui,Ui=null),typeof Ui=="number"&&(Sn=Ui,Ui=null),Ut={flags:Ui,angle:Sn,align:vn})):(U("The transform parameter of text() with a Matrix value"),Ko=Qt),isNaN(ze)||isNaN(pt)||re==null)throw new Error("Invalid arguments passed to jsPDF.text");if(re.length===0)return pi;var jo,Oa="",pl=typeof Ut.lineHeightFactor=="number"?Ut.lineHeightFactor:vi,yc=pi.internal.scaleFactor;function Wh(So){return So=So.split("	").join(Array(Ut.TabLen||9).join(" ")),Qn(So,Ui)}function su(So){for(var Ji,Fo=So.concat(),na=[],wl=Fo.length;wl--;)typeof(Ji=Fo.shift())=="string"?na.push(Ji):Array.isArray(So)&&(Ji.length===1||Ji[1]===void 0&&Ji[2]===void 0)?na.push(Ji[0]):na.push([Ji[0],Ji[1],Ji[2]]);return na}function ml(So,Ji){var Fo;if(typeof So=="string")Fo=Ji(So)[0];else if(Array.isArray(So)){for(var na,wl,lu=So.concat(),$l=[],Hc=lu.length;Hc--;)typeof(na=lu.shift())=="string"?$l.push(Ji(na)[0]):Array.isArray(na)&&typeof na[0]=="string"&&(wl=Ji(na[0],na[1],na[2]),$l.push([wl[0],wl[1],wl[2]]));Fo=$l}return Fo}var Pa=!1,vc=!0;if(typeof re=="string")Pa=!0;else if(Array.isArray(re)){var bc=re.concat();jr=[];for(var La,Da=bc.length;Da--;)(typeof(La=bc.shift())!="string"||Array.isArray(La)&&typeof La[0]!="string")&&(vc=!1);Pa=vc}if(Pa===!1)throw new Error('Type of text must be string or Array. "'+re+'" is not recognized.');typeof re=="string"&&(re=re.match(/[\r?\n]/)?re.split(/\r\n|\r|\n/g):[re]);var gl=mt/pi.internal.scaleFactor,Ys=gl*(pl-1);switch(Ut.baseline){case"bottom":pt-=Ys;break;case"top":pt+=gl-Ys;break;case"hanging":pt+=gl-2*Ys;break;case"middle":pt+=gl/2-Ys}if((Xn=Ut.maxWidth||0)>0&&(typeof re=="string"?re=pi.splitTextToSize(re,Xn):Object.prototype.toString.call(re)==="[object Array]"&&(re=re.reduce(function(So,Ji){return So.concat(pi.splitTextToSize(Ji,Xn))},[]))),Er={text:re,x:ze,y:pt,options:Ut,mutex:{pdfEscape:Qn,activeFontKey:tt,fonts:dt,activeFontSize:mt}},Sr.publish("preProcessText",Er),re=Er.text,Sn=(Ut=Er.options).angle,Ko instanceof ge==0&&Sn&&typeof Sn=="number"){Sn*=Math.PI/180,Ut.rotationDirection===0&&(Sn=-Sn),D===C&&(Sn=-Sn);var Ql=Math.cos(Sn),Yu=Math.sin(Sn);Ko=new ge(Ql,Yu,-Yu,Ql,0,0)}else Sn&&Sn instanceof ge&&(Ko=Sn);D!==C||Ko||(Ko=We),(Zn=Ut.charSpace||ni)!==void 0&&(Oa+=$(ee(Zn))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Ao=Ut.horizontalScale)!==void 0&&(Oa+=$(100*Ao)+` Tz
`),Ut.lang;var $a=-1,Vc=Ut.renderingMode!==void 0?Ut.renderingMode:Ut.stroke,as=pi.internal.getCurrentPageInfo().pageContext;switch(Vc){case 0:case!1:case"fill":$a=0;break;case 1:case!0:case"stroke":$a=1;break;case 2:case"fillThenStroke":$a=2;break;case 3:case"invisible":$a=3;break;case 4:case"fillAndAddForClipping":$a=4;break;case 5:case"strokeAndAddPathForClipping":$a=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":$a=6;break;case 7:case"addToPathForClipping":$a=7}var Wc=as.usedRenderingMode!==void 0?as.usedRenderingMode:-1;$a!==-1?Oa+=$a+` Tr
`:Wc!==-1&&(Oa+=`0 Tr
`),$a!==-1&&(as.usedRenderingMode=$a),vn=Ut.align||"left";var ua,_l=mt*pl,xc=pi.internal.pageSize.getWidth(),Ns=dt[tt];Zn=Ut.charSpace||ni,Xn=Ut.maxWidth||0,Ui=Object.assign({autoencode:!0,noBOM:!0},Ut.flags);var Jl=[],wc=function(So){return pi.getStringUnitWidth(So,{font:Ns,charSpace:Zn,fontSize:mt,doKerning:!1})*mt/yc};if(Object.prototype.toString.call(re)==="[object Array]"){var ss;jr=su(re),vn!=="left"&&(ua=jr.map(wc));var Ts,js=0;if(vn==="right"){ze-=ua[0],re=[],Da=jr.length;for(var Rs=0;Rs<Da;Rs++)Rs===0?(Ts=Ri(ze),ss=lo(pt)):(Ts=ee(js-ua[Rs]),ss=-_l),re.push([jr[Rs],Ts,ss]),js=ua[Rs]}else if(vn==="center"){ze-=ua[0]/2,re=[],Da=jr.length;for(var ec=0;ec<Da;ec++)ec===0?(Ts=Ri(ze),ss=lo(pt)):(Ts=ee((js-ua[ec])/2),ss=-_l),re.push([jr[ec],Ts,ss]),js=ua[ec]}else if(vn==="left"){re=[],Da=jr.length;for(var tc=0;tc<Da;tc++)re.push(jr[tc])}else if(vn==="justify"&&Ns.encoding==="Identity-H"){re=[],Da=jr.length,Xn=Xn!==0?Xn:xc;for(var Mc=0,Co=0;Co<Da;Co++)if(ss=Co===0?lo(pt):-_l,Ts=Co===0?Ri(ze):Mc,Co<Da-1){var $n=ee((Xn-ua[Co])/(jr[Co].split(" ").length-1)),yl=jr[Co].split(" ");re.push([yl[0]+" ",Ts,ss]),Mc=0;for(var vl=1;vl<yl.length;vl++){var Gc=(wc(yl[vl-1]+" "+yl[vl])-wc(yl[vl]))*yc+$n;vl==yl.length-1?re.push([yl[vl],Gc,0]):re.push([yl[vl]+" ",Gc,0]),Mc-=Gc}}else re.push([jr[Co],Ts,ss]);re.push(["",Mc,0])}else{if(vn!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(re=[],Da=jr.length,Xn=Xn!==0?Xn:xc,Co=0;Co<Da;Co++)ss=Co===0?lo(pt):-_l,Ts=Co===0?Ri(ze):0,Co<Da-1?Jl.push($(ee((Xn-ua[Co])/(jr[Co].split(" ").length-1)))):Jl.push(0),re.push([jr[Co],Ts,ss])}}(typeof Ut.R2L=="boolean"?Ut.R2L:dr)===!0&&(re=ml(re,function(So,Ji,Fo){return[So.split("").reverse().join(""),Ji,Fo]})),Er={text:re,x:ze,y:pt,options:Ut,mutex:{pdfEscape:Qn,activeFontKey:tt,fonts:dt,activeFontSize:mt}},Sr.publish("postProcessText",Er),re=Er.text,jo=Er.mutex.isHex||!1;var rc=dt[tt].encoding;rc!=="WinAnsiEncoding"&&rc!=="StandardEncoding"||(re=ml(re,function(So,Ji,Fo){return[Wh(So),Ji,Fo]})),jr=su(re),re=[];for(var Na,nc,bl,qa=Array.isArray(jr[0])?1:0,bi="",qc=function(So,Ji,Fo){var na="";return Fo instanceof ge?(Fo=typeof Ut.angle=="number"?ut(Fo,new ge(1,0,0,1,So,Ji)):ut(new ge(1,0,0,1,So,Ji),Fo),D===C&&(Fo=ut(new ge(1,0,0,-1,0,0),Fo)),na=Fo.join(" ")+` Tm
`):na=$(So)+" "+$(Ji)+` Td
`,na},ja=0;ja<jr.length;ja++){switch(bi="",qa){case 1:bl=(jo?"<":"(")+jr[ja][0]+(jo?">":")"),Na=parseFloat(jr[ja][1]),nc=parseFloat(jr[ja][2]);break;case 0:bl=(jo?"<":"(")+jr[ja]+(jo?">":")"),Na=Ri(ze),nc=lo(pt)}Jl!==void 0&&Jl[ja]!==void 0&&(bi=Jl[ja]+` Tw
`),ja===0?re.push(bi+qc(Na,nc,Ko)+bl):qa===0?re.push(bi+bl):qa===1&&re.push(bi+qc(Na,nc,Ko)+bl)}re=qa===0?re.join(` Tj
T* `):re.join(` Tj
`),re+=` Tj
`;var xl=`BT
/`;return xl+=tt+" "+mt+` Tf
`,xl+=$(mt*pl)+` TL
`,xl+=Nn+`
`,xl+=Oa,xl+=re,Ne(xl+="ET"),_[tt]=!0,pi};var Yt=y.__private__.clip=y.clip=function(re){return Ne(re==="evenodd"?"W*":"W"),this};y.clipEvenOdd=function(){return Yt("evenodd")},y.__private__.discardPath=y.discardPath=function(){return Ne("n"),this};var Ie=y.__private__.isValidStyle=function(re){var ze=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(re)!==-1&&(ze=!0),ze};y.__private__.setDefaultPathOperation=y.setDefaultPathOperation=function(re){return Ie(re)&&(d=re),this};var rt=y.__private__.getStyle=y.getStyle=function(re){var ze=d;switch(re){case"D":case"S":ze="S";break;case"F":ze="f";break;case"FD":case"DF":ze="B";break;case"f":case"f*":case"B":case"B*":ze=re}return ze},Tt=y.close=function(){return Ne("h"),this};y.stroke=function(){return Ne("S"),this},y.fill=function(re){return Ft("f",re),this},y.fillEvenOdd=function(re){return Ft("f*",re),this},y.fillStroke=function(re){return Ft("B",re),this},y.fillStrokeEvenOdd=function(re){return Ft("B*",re),this};var Ft=function(re,ze){Ma(ze)==="object"?Vr(ze,re):Ne(re)},Dt=function(re){re===null||D===C&&re===void 0||(re=rt(re),Ne(re))};function yr(re,ze,pt,Ut,Qt){var Er=new u1(ze||this.boundingBox,pt||this.xStep,Ut||this.yStep,this.gState,Qt||this.matrix);Er.stream=this.stream;var jr=re+"$$"+this.cloneIndex+++"$$";return Je(jr,Er),Er}var Vr=function(re,ze){var pt=qt[re.key],Ut=At[pt];if(Ut instanceof Py)Ne("q"),Ne(en(ze)),Ut.gState&&y.setGState(Ut.gState),Ne(re.matrix.toString()+" cm"),Ne("/"+pt+" sh"),Ne("Q");else if(Ut instanceof u1){var Qt=new ge(1,0,0,-1,0,vo());re.matrix&&(Qt=Qt.multiply(re.matrix||We),pt=yr.call(Ut,re.key,re.boundingBox,re.xStep,re.yStep,Qt).id),Ne("q"),Ne("/Pattern cs"),Ne("/"+pt+" scn"),Ut.gState&&y.setGState(Ut.gState),Ne(ze),Ne("Q")}},en=function(re){switch(re){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Qr=y.moveTo=function(re,ze){return Ne($(ee(re))+" "+$(ae(ze))+" m"),this},Dr=y.lineTo=function(re,ze){return Ne($(ee(re))+" "+$(ae(ze))+" l"),this},Ln=y.curveTo=function(re,ze,pt,Ut,Qt,Er){return Ne([$(ee(re)),$(ae(ze)),$(ee(pt)),$(ae(Ut)),$(ee(Qt)),$(ae(Er)),"c"].join(" ")),this};y.__private__.line=y.line=function(re,ze,pt,Ut,Qt){if(isNaN(re)||isNaN(ze)||isNaN(pt)||isNaN(Ut)||!Ie(Qt))throw new Error("Invalid arguments passed to jsPDF.line");return D===P?this.lines([[pt-re,Ut-ze]],re,ze,[1,1],Qt||"S"):this.lines([[pt-re,Ut-ze]],re,ze,[1,1]).stroke()},y.__private__.lines=y.lines=function(re,ze,pt,Ut,Qt,Er){var jr,Sn,vn,Zn,Xn,Ui,Ao,Ko,pi,ca,jo,Oa;if(typeof re=="number"&&(Oa=pt,pt=ze,ze=re,re=Oa),Ut=Ut||[1,1],Er=Er||!1,isNaN(ze)||isNaN(pt)||!Array.isArray(re)||!Array.isArray(Ut)||!Ie(Qt)||typeof Er!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Qr(ze,pt),jr=Ut[0],Sn=Ut[1],Zn=re.length,ca=ze,jo=pt,vn=0;vn<Zn;vn++)(Xn=re[vn]).length===2?(ca=Xn[0]*jr+ca,jo=Xn[1]*Sn+jo,Dr(ca,jo)):(Ui=Xn[0]*jr+ca,Ao=Xn[1]*Sn+jo,Ko=Xn[2]*jr+ca,pi=Xn[3]*Sn+jo,ca=Xn[4]*jr+ca,jo=Xn[5]*Sn+jo,Ln(Ui,Ao,Ko,pi,ca,jo));return Er&&Tt(),Dt(Qt),this},y.path=function(re){for(var ze=0;ze<re.length;ze++){var pt=re[ze],Ut=pt.c;switch(pt.op){case"m":Qr(Ut[0],Ut[1]);break;case"l":Dr(Ut[0],Ut[1]);break;case"c":Ln.apply(this,Ut);break;case"h":Tt()}}return this},y.__private__.rect=y.rect=function(re,ze,pt,Ut,Qt){if(isNaN(re)||isNaN(ze)||isNaN(pt)||isNaN(Ut)||!Ie(Qt))throw new Error("Invalid arguments passed to jsPDF.rect");return D===P&&(Ut=-Ut),Ne([$(ee(re)),$(ae(ze)),$(ee(pt)),$(ee(Ut)),"re"].join(" ")),Dt(Qt),this},y.__private__.triangle=y.triangle=function(re,ze,pt,Ut,Qt,Er,jr){if(isNaN(re)||isNaN(ze)||isNaN(pt)||isNaN(Ut)||isNaN(Qt)||isNaN(Er)||!Ie(jr))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[pt-re,Ut-ze],[Qt-pt,Er-Ut],[re-Qt,ze-Er]],re,ze,[1,1],jr,!0),this},y.__private__.roundedRect=y.roundedRect=function(re,ze,pt,Ut,Qt,Er,jr){if(isNaN(re)||isNaN(ze)||isNaN(pt)||isNaN(Ut)||isNaN(Qt)||isNaN(Er)||!Ie(jr))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Sn=4/3*(Math.SQRT2-1);return Qt=Math.min(Qt,.5*pt),Er=Math.min(Er,.5*Ut),this.lines([[pt-2*Qt,0],[Qt*Sn,0,Qt,Er-Er*Sn,Qt,Er],[0,Ut-2*Er],[0,Er*Sn,-Qt*Sn,Er,-Qt,Er],[2*Qt-pt,0],[-Qt*Sn,0,-Qt,-Er*Sn,-Qt,-Er],[0,2*Er-Ut],[0,-Er*Sn,Qt*Sn,-Er,Qt,-Er]],re+Qt,ze,[1,1],jr,!0),this},y.__private__.ellipse=y.ellipse=function(re,ze,pt,Ut,Qt){if(isNaN(re)||isNaN(ze)||isNaN(pt)||isNaN(Ut)||!Ie(Qt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Er=4/3*(Math.SQRT2-1)*pt,jr=4/3*(Math.SQRT2-1)*Ut;return Qr(re+pt,ze),Ln(re+pt,ze-jr,re+Er,ze-Ut,re,ze-Ut),Ln(re-Er,ze-Ut,re-pt,ze-jr,re-pt,ze),Ln(re-pt,ze+jr,re-Er,ze+Ut,re,ze+Ut),Ln(re+Er,ze+Ut,re+pt,ze+jr,re+pt,ze),Dt(Qt),this},y.__private__.circle=y.circle=function(re,ze,pt,Ut){if(isNaN(re)||isNaN(ze)||isNaN(pt)||!Ie(Ut))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(re,ze,pt,pt,Ut)},y.setFont=function(re,ze,pt){return pt&&(ze=j(ze,pt)),tt=Wa(re,ze,{disableWarning:!1}),this};var Ii=y.__private__.getFont=y.getFont=function(){return dt[Wa.apply(y,arguments)]};y.__private__.getFontList=y.getFontList=function(){var re,ze,pt={};for(re in Pt)if(Pt.hasOwnProperty(re))for(ze in pt[re]=[],Pt[re])Pt[re].hasOwnProperty(ze)&&pt[re].push(ze);return pt},y.addFont=function(re,ze,pt,Ut,Qt){var Er=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Er.indexOf(arguments[3])!==-1?Qt=arguments[3]:arguments[3]&&Er.indexOf(arguments[3])==-1&&(pt=j(pt,Ut)),xo.call(this,re,ze,pt,Qt=Qt||"Identity-H")};var vi,Ai=e.lineWidth||.200025,rn=y.__private__.getLineWidth=y.getLineWidth=function(){return Ai},Xi=y.__private__.setLineWidth=y.setLineWidth=function(re){return Ai=re,Ne($(ee(re))+" w"),this};y.__private__.setLineDash=ai.API.setLineDash=ai.API.setLineDashPattern=function(re,ze){if(re=re||[],ze=ze||0,isNaN(ze)||!Array.isArray(re))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return re=re.map(function(pt){return $(ee(pt))}).join(" "),ze=$(ee(ze)),Ne("["+re+"] "+ze+" d"),this};var Oi=y.__private__.getLineHeight=y.getLineHeight=function(){return mt*vi};y.__private__.getLineHeight=y.getLineHeight=function(){return mt*vi};var ri=y.__private__.setLineHeightFactor=y.setLineHeightFactor=function(re){return typeof(re=re||1.15)=="number"&&(vi=re),this},ma=y.__private__.getLineHeightFactor=y.getLineHeightFactor=function(){return vi};ri(e.lineHeight);var Ri=y.__private__.getHorizontalCoordinate=function(re){return ee(re)},lo=y.__private__.getVerticalCoordinate=function(re){return D===C?re:zr[te].mediaBox.topRightY-zr[te].mediaBox.bottomLeftY-ee(re)},Mi=y.__private__.getHorizontalCoordinateString=y.getHorizontalCoordinateString=function(re){return $(Ri(re))},di=y.__private__.getVerticalCoordinateString=y.getVerticalCoordinateString=function(re){return $(lo(re))},Ho=e.strokeColor||"0 G";y.__private__.getStrokeColor=y.getDrawColor=function(){return Or(Ho)},y.__private__.setStrokeColor=y.setDrawColor=function(re,ze,pt,Ut){return Ho=an({ch1:re,ch2:ze,ch3:pt,ch4:Ut,pdfColorType:"draw",precision:2}),Ne(Ho),this};var bn=e.fillColor||"0 g";y.__private__.getFillColor=y.getFillColor=function(){return Or(bn)},y.__private__.setFillColor=y.setFillColor=function(re,ze,pt,Ut){return bn=an({ch1:re,ch2:ze,ch3:pt,ch4:Ut,pdfColorType:"fill",precision:2}),Ne(bn),this};var Nn=e.textColor||"0 g",Mo=y.__private__.getTextColor=y.getTextColor=function(){return Or(Nn)};y.__private__.setTextColor=y.setTextColor=function(re,ze,pt,Ut){return Nn=an({ch1:re,ch2:ze,ch3:pt,ch4:Ut,pdfColorType:"text",precision:3}),this};var ni=e.charSpace,Yi=y.__private__.getCharSpace=y.getCharSpace=function(){return parseFloat(ni||0)};y.__private__.setCharSpace=y.setCharSpace=function(re){if(isNaN(re))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return ni=re,this};var Qi=0;y.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},y.__private__.setLineCap=y.setLineCap=function(re){var ze=y.CapJoinStyles[re];if(ze===void 0)throw new Error("Line cap style of '"+re+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Qi=ze,Ne(ze+" J"),this};var co=0;y.__private__.setLineJoin=y.setLineJoin=function(re){var ze=y.CapJoinStyles[re];if(ze===void 0)throw new Error("Line join style of '"+re+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return co=ze,Ne(ze+" j"),this},y.__private__.setLineMiterLimit=y.__private__.setMiterLimit=y.setLineMiterLimit=y.setMiterLimit=function(re){if(re=re||0,isNaN(re))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Ne($(ee(re))+" M"),this},y.GState=ZC,y.setGState=function(re){(re=typeof re=="string"?er[fr[re]]:po(null,re)).equals(Jr)||(Ne("/"+re.id+" gs"),Jr=re)};var po=function(re,ze){if(!re||!fr[re]){var pt=!1;for(var Ut in er)if(er.hasOwnProperty(Ut)&&er[Ut].equals(ze)){pt=!0;break}if(pt)ze=er[Ut];else{var Qt="GS"+(Object.keys(er).length+1).toString(10);er[Qt]=ze,ze.id=Qt}return re&&(fr[re]=ze.id),Sr.publish("addGState",ze),ze}};y.addGState=function(re,ze){return po(re,ze),this},y.saveGraphicsState=function(){return Ne("q"),Vt.push({key:tt,size:mt,color:Nn}),this},y.restoreGraphicsState=function(){Ne("Q");var re=Vt.pop();return tt=re.key,mt=re.size,Nn=re.color,Jr=null,this},y.setCurrentTransformationMatrix=function(re){return Ne(re.toString()+" cm"),this},y.comment=function(re){return Ne("#"+re),this};var ga=function(re,ze){var pt=re||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return pt},set:function(Er){isNaN(Er)||(pt=parseFloat(Er))}});var Ut=ze||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Ut},set:function(Er){isNaN(Er)||(Ut=parseFloat(Er))}});var Qt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Qt},set:function(Er){Qt=Er.toString()}}),this},ws=function(re,ze,pt,Ut){ga.call(this,re,ze),this.type="rect";var Qt=pt||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Qt},set:function(jr){isNaN(jr)||(Qt=parseFloat(jr))}});var Er=Ut||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Er},set:function(jr){isNaN(jr)||(Er=parseFloat(jr))}}),this},hl=function(){this.page=$t,this.currentPage=te,this.pages=Te.slice(0),this.pagesContext=zr.slice(0),this.x=Pe,this.y=Ve,this.matrix=Qe,this.width=_c(te),this.height=vo(te),this.outputDestination=ke,this.id="",this.objectNumber=-1};hl.prototype.restore=function(){$t=this.page,te=this.currentPage,zr=this.pagesContext,Te=this.pages,Pe=this.x,Ve=this.y,Qe=this.matrix,Ms(te,this.width),Ss(te,this.height),ke=this.outputDestination};var fl=function(re,ze,pt,Ut,Qt){An.push(new hl),$t=te=0,Te=[],Pe=re,Ve=ze,Qe=Qt,is([pt,Ut])};for(var Yl in y.beginFormObject=function(re,ze,pt,Ut,Qt){return fl(re,ze,pt,Ut,Qt),this},y.endFormObject=function(re){return function(ze){if(qr[ze])An.pop().restore();else{var pt=new hl,Ut="Xo"+(Object.keys(Xr).length+1).toString(10);pt.id=Ut,qr[ze]=Ut,Xr[Ut]=pt,Sr.publish("addFormObject",pt),An.pop().restore()}}(re),this},y.doFormObject=function(re,ze){var pt=Xr[qr[re]];return Ne("q"),Ne(ze.toString()+" cm"),Ne("/"+pt.id+" Do"),Ne("Q"),this},y.getFormObject=function(re){var ze=Xr[qr[re]];return{x:ze.x,y:ze.y,width:ze.width,height:ze.height,matrix:ze.matrix}},y.save=function(re,ze){return re=re||"generated.pdf",(ze=ze||{}).returnPromise=ze.returnPromise||!1,ze.returnPromise===!1?(wy(dl(Zi()),re),typeof wy.unload=="function"&&Ni.setTimeout&&setTimeout(wy.unload,911),this):new Promise(function(pt,Ut){try{var Qt=wy(dl(Zi()),re);typeof wy.unload=="function"&&Ni.setTimeout&&setTimeout(wy.unload,911),pt(Qt)}catch(Er){Ut(Er.message)}})},ai.API)ai.API.hasOwnProperty(Yl)&&(Yl==="events"&&ai.API.events.length?function(re,ze){var pt,Ut,Qt;for(Qt=ze.length-1;Qt!==-1;Qt--)pt=ze[Qt][0],Ut=ze[Qt][1],re.subscribe.apply(re,[pt].concat(typeof Ut=="function"?[Ut]:Ut))}(Sr,ai.API.events):y[Yl]=ai.API[Yl]);var _c=y.getPageWidth=function(re){return(zr[re=re||te].mediaBox.topRightX-zr[re].mediaBox.bottomLeftX)/Se},Ms=y.setPageWidth=function(re,ze){zr[re].mediaBox.topRightX=ze*Se+zr[re].mediaBox.bottomLeftX},vo=y.getPageHeight=function(re){return(zr[re=re||te].mediaBox.topRightY-zr[re].mediaBox.bottomLeftY)/Se},Ss=y.setPageHeight=function(re,ze){zr[re].mediaBox.topRightY=ze*Se+zr[re].mediaBox.bottomLeftY};return y.internal={pdfEscape:Qn,getStyle:rt,getFont:Ii,getFontSize:Kt,getCharSpace:Yi,getTextColor:Mo,getLineHeight:Oi,getLineHeightFactor:ma,getLineWidth:rn,write:Ot,getHorizontalCoordinate:Ri,getVerticalCoordinate:lo,getCoordinateString:Mi,getVerticalCoordinateString:di,collections:{},newObject:wt,newAdditionalObject:On,newObjectDeferred:pr,newObjectDeferredBegin:Rr,getFilters:Vn,putStream:_o,events:Sr,scaleFactor:Se,pageSize:{getWidth:function(){return _c(te)},setWidth:function(re){Ms(te,re)},getHeight:function(){return vo(te)},setHeight:function(re){Ss(te,re)}},encryptionOptions:m,encryption:yo,getEncryptor:function(re){return m!==null?yo.encryptor(re,0):function(ze){return ze}},output:ba,getNumberOfPages:Eo,pages:Te,out:Ne,f2:H,f3:X,getPageInfo:Xl,getPageInfoByObjId:Dl,getCurrentPageInfo:Uc,getPDFVersion:x,Point:ga,Rectangle:ws,Matrix:ge,hasHotfix:Ga},Object.defineProperty(y.internal.pageSize,"width",{get:function(){return _c(te)},set:function(re){Ms(te,re)},enumerable:!0,configurable:!0}),Object.defineProperty(y.internal.pageSize,"height",{get:function(){return vo(te)},set:function(re){Ss(te,re)},enumerable:!0,configurable:!0}),(function(re){for(var ze=0,pt=kt.length;ze<pt;ze++){var Ut=xo.call(this,re[ze][0],re[ze][1],re[ze][2],kt[ze][3],!0);g===!1&&(_[Ut]=!0);var Qt=re[ze][0].split("-");Xs({id:Ut,fontName:Qt[0],fontStyle:Qt[1]||""})}Sr.publish("addFonts",{fonts:dt,dictionary:Pt})}).call(y,kt),tt="F1",la(i,r),Sr.publish("initialized"),y}jv.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},jv.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},jv.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},jv.prototype.processOwnerPassword=function(e,t){return YN(XN(t).substr(0,5),e)},jv.prototype.encryptor=function(e,t){var r=XN(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return YN(r,n)}},ZC.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||Ma(e)!==Ma(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},ai.API={events:[]},ai.version="3.0.2";var al=ai.API,dz=1,B0=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Lv=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Hi=function(e){return e.toFixed(2)},Og=function(e){return e.toFixed(5)};al.__acroform__={};var _d=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},$K=function(e){return e*dz},Mp=function(e){var t=new phe,r=Gn.internal.getHeight(e)||0,n=Gn.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Hi(n)),Number(Hi(r))],t},RJe=al.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},FJe=al.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},zJe=al.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},Cl=al.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return zJe(e,t-1)},kl=al.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return RJe(e,t-1)},Il=al.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return FJe(e,t-1)},BJe=al.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,i=e[0],o=e[1],s=e[2],a=e[3],u={};return u.lowerLeft_X=r(i)||0,u.lowerLeft_Y=n(o+a)||0,u.upperRight_X=r(i+s)||0,u.upperRight_Y=n(o)||0,[Number(Hi(u.lowerLeft_X)),Number(Hi(u.lowerLeft_Y)),Number(Hi(u.upperRight_X)),Number(Hi(u.upperRight_Y))]},UJe=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=QN(e,r),i=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+i+" "+Hi(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var o=Mp(e);return o.scope=e.scope,o.stream=t.join(`
`),o}},QN=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},i=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");i=e.multiline?i.map(function(H){return H.split(`
`)}):i.map(function(H){return[H]});var o=r,s=Gn.internal.getHeight(e)||0;s=s<0?-s:s;var a=Gn.internal.getWidth(e)||0;a=a<0?-a:a;var u=function(H,X,ee){if(H+1<i.length){var ae=X+" "+i[H+1][0];return oE(ae,e,ee).width<=a-4}return!1};o++;e:for(;o>0;){t="",o--;var d,m,g=oE("3",e,o).height,_=e.multiline?s-o:(s-g)/2,y=_+=2,M=0,x=0,E=0;if(o<=0){t=`(...) Tj
`,t+="% Width of Text: "+oE(t,e,o=12).width+", FieldWidth:"+a+`
`;break}for(var T="",P=0,C=0;C<i.length;C++)if(i.hasOwnProperty(C)){var D=!1;if(i[C].length!==1&&E!==i[C].length-1){if((g+2)*(P+2)+2>s)continue e;T+=i[C][E],D=!0,x=C,C--}else{T=(T+=i[C][E]+" ").substr(T.length-1)==" "?T.substr(0,T.length-1):T;var L=parseInt(C),N=u(L,T,o),j=C>=i.length-1;if(N&&!j){T+=" ",E=0;continue}if(N||j){if(j)x=L;else if(e.multiline&&(g+2)*(P+2)+2>s)continue e}else{if(!e.multiline||(g+2)*(P+2)+2>s)continue e;x=L}}for(var $="",U=M;U<=x;U++){var G=i[U];if(e.multiline){if(U===x){$+=G[E]+" ",E=(E+1)%G.length;continue}if(U===M){$+=G[G.length-1]+" ";continue}}$+=G[0]+" "}switch($=$.substr($.length-1)==" "?$.substr(0,$.length-1):$,m=oE($,e,o).width,e.textAlign){case"right":d=a-m-2;break;case"center":d=(a-m)/2;break;default:d=2}t+=Hi(d)+" "+Hi(y)+` Td
`,t+="("+B0($)+`) Tj
`,t+=-Hi(d)+` 0 Td
`,y=-(o+2),m=0,M=D?x:x+1,P++,T=""}break}return n.text=t,n.fontSize=o,n},oE=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),i=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:i}},VJe={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},WJe=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},GJe=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(Yf.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(VJe)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");dz=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new mhe,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in n)if(n.hasOwnProperty(i)){var o=n[i];o.objId=void 0,o.hasAnnotation&&WJe(o,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,i){var o=!n;for(var s in n||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(s)){var a=n[s],u=[],d=a.Rect;if(a.Rect&&(a.Rect=BJe(a.Rect,i)),i.internal.newObjectDeferredBegin(a.objId,!0),a.DA=Gn.createDefaultAppearanceStream(a),Ma(a)==="object"&&typeof a.getKeyValueListForStream=="function"&&(u=a.getKeyValueListForStream()),a.Rect=d,a.hasAppearanceStream&&!a.appearanceStreamContent){var m=UJe(a);u.push({key:"AP",value:"<</N "+m+">>"}),i.internal.acroformPlugin.xForms.push(m)}if(a.appearanceStreamContent){var g="";for(var _ in a.appearanceStreamContent)if(a.appearanceStreamContent.hasOwnProperty(_)){var y=a.appearanceStreamContent[_];if(g+="/"+_+" ",g+="<<",Object.keys(y).length>=1||Array.isArray(y)){for(var s in y)if(y.hasOwnProperty(s)){var M=y[s];typeof M=="function"&&(M=M.call(i,a)),g+="/"+s+" "+M+" ",i.internal.acroformPlugin.xForms.indexOf(M)>=0||i.internal.acroformPlugin.xForms.push(M)}}else typeof(M=y)=="function"&&(M=M.call(i,a)),g+="/"+s+" "+M,i.internal.acroformPlugin.xForms.indexOf(M)>=0||i.internal.acroformPlugin.xForms.push(M);g+=">>"}u.push({key:"AP",value:`<<
`+g+">>"})}i.internal.putStream({additionalKeyValues:u,objectId:a.objId}),i.internal.out("endobj")}o&&function(x,E){for(var T in x)if(x.hasOwnProperty(T)){var P=T,C=x[T];E.internal.newObjectDeferredBegin(C.objId,!0),Ma(C)==="object"&&typeof C.putStream=="function"&&C.putStream(),delete x[P]}}(i.internal.acroformPlugin.xForms,i)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},fhe=al.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(s){return s};if(Array.isArray(e)){for(var i="[",o=0;o<e.length;o++)switch(o!==0&&(i+=" "),Ma(e[o])){case"boolean":case"number":case"object":i+=e[o].toString();break;case"string":e[o].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),i+="("+B0(n(e[o].toString()))+")"):i+=e[o].toString()}return i+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},YO=function(e,t,r){var n=function(i){return i};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+B0(n(e))+")"},Dp=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Dp.prototype.toString=function(){return this.objId+" 0 R"},Dp.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Dp.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(o){return o!="content"&&o!="appearanceStreamContent"&&o!="scope"&&o!="objId"&&o.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],i=this[n];i&&(Array.isArray(i)?e.push({key:n,value:fhe(i,this.objId,this.scope)}):i instanceof Dp?(i.scope=this.scope,e.push({key:n,value:i.objId+" 0 R"})):typeof i!="function"&&e.push({key:n,value:i}))}return e};var phe=function(){Dp.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};_d(phe,Dp);var mhe=function(){Dp.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+B0(r(e))+")"}},set:function(r){e=r}})};_d(mhe,Dp);var Yf=function e(){Dp.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(T){if(isNaN(T))throw new Error('Invalid value "'+T+'" for attribute F supplied.');t=T}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Cl(t,3)},set:function(T){T?this.F=kl(t,3):this.F=Il(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(T){if(isNaN(T))throw new Error('Invalid value "'+T+'" for attribute Ff supplied.');r=T}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(T){n=T!==void 0?T:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(T){n[0]=T}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(T){n[1]=T}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(T){n[2]=T}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(T){n[3]=T}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(T){switch(T){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=T;break;default:throw new Error('Invalid value "'+T+'" for attribute FT supplied.')}}});var o=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!o||o.length<1){if(this instanceof XC)return;o="FieldObject"+e.FieldNum++}var T=function(P){return P};return this.scope&&(T=this.scope.internal.getEncryptor(this.objId)),"("+B0(T(o))+")"},set:function(T){o=T.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return o},set:function(T){o=T}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(T){s=T}});var a="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return a},set:function(T){a=T}});var u=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return u},set:function(T){u=T}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return d===void 0?50/dz:d},set:function(T){d=T}});var m="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return m},set:function(T){m=T}});var g="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!g||this instanceof XC||this instanceof e0))return YO(g,this.objId,this.scope)},set:function(T){T=T.toString(),g=T}});var _=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(_)return this instanceof jc==0?YO(_,this.objId,this.scope):_},set:function(T){T=T.toString(),_=this instanceof jc==0?T.substr(0,1)==="("?Lv(T.substr(1,T.length-2)):Lv(T):T}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof jc==1?Lv(_.substr(1,_.length-1)):_},set:function(T){T=T.toString(),_=this instanceof jc==1?"/"+T:T}});var y=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(y)return y},set:function(T){this.V=T}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(y)return this instanceof jc==0?YO(y,this.objId,this.scope):y},set:function(T){T=T.toString(),y=this instanceof jc==0?T.substr(0,1)==="("?Lv(T.substr(1,T.length-2)):Lv(T):T}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof jc==1?Lv(y.substr(1,y.length-1)):y},set:function(T){T=T.toString(),y=this instanceof jc==1?"/"+T:T}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var M,x=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return x},set:function(T){T=!!T,x=T}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(M)return M},set:function(T){M=T}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Cl(this.Ff,1)},set:function(T){T?this.Ff=kl(this.Ff,1):this.Ff=Il(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Cl(this.Ff,2)},set:function(T){T?this.Ff=kl(this.Ff,2):this.Ff=Il(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Cl(this.Ff,3)},set:function(T){T?this.Ff=kl(this.Ff,3):this.Ff=Il(this.Ff,3)}});var E=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(E!==null)return E},set:function(T){if([0,1,2].indexOf(T)===-1)throw new Error('Invalid value "'+T+'" for attribute Q supplied.');E=T}}),Object.defineProperty(this,"textAlign",{get:function(){var T;switch(E){case 0:default:T="left";break;case 1:T="center";break;case 2:T="right"}return T},configurable:!0,enumerable:!0,set:function(T){switch(T){case"right":case 2:E=2;break;case"center":case 1:E=1;break;default:E=0}}})};_d(Yf,Dp);var E1=function(){Yf.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return fhe(t,this.objId,this.scope)},set:function(r){var n,i;i=[],typeof(n=r)=="string"&&(i=function(o,s,a){a||(a=1);for(var u,d=[];u=s.exec(o);)d.push(u[a]);return d}(n,/\((.*?)\)/g)),t=i}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Cl(this.Ff,18)},set:function(r){r?this.Ff=kl(this.Ff,18):this.Ff=Il(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Cl(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=kl(this.Ff,19):this.Ff=Il(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Cl(this.Ff,20)},set:function(r){r?(this.Ff=kl(this.Ff,20),t.sort()):this.Ff=Il(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Cl(this.Ff,22)},set:function(r){r?this.Ff=kl(this.Ff,22):this.Ff=Il(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Cl(this.Ff,23)},set:function(r){r?this.Ff=kl(this.Ff,23):this.Ff=Il(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Cl(this.Ff,27)},set:function(r){r?this.Ff=kl(this.Ff,27):this.Ff=Il(this.Ff,27)}}),this.hasAppearanceStream=!1};_d(E1,Yf);var A1=function(){E1.call(this),this.fontName="helvetica",this.combo=!1};_d(A1,E1);var C1=function(){A1.call(this),this.combo=!0};_d(C1,A1);var FE=function(){C1.call(this),this.edit=!0};_d(FE,C1);var jc=function(){Yf.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Cl(this.Ff,15)},set:function(r){r?this.Ff=kl(this.Ff,15):this.Ff=Il(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Cl(this.Ff,16)},set:function(r){r?this.Ff=kl(this.Ff,16):this.Ff=Il(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Cl(this.Ff,17)},set:function(r){r?this.Ff=kl(this.Ff,17):this.Ff=Il(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Cl(this.Ff,26)},set:function(r){r?this.Ff=kl(this.Ff,26):this.Ff=Il(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(o){return o};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,i=[];for(n in i.push("<<"),t)i.push("/"+n+" ("+B0(r(t[n]))+")");return i.push(">>"),i.join(`
`)}},set:function(r){Ma(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};_d(jc,Yf);var zE=function(){jc.call(this),this.pushButton=!0};_d(zE,jc);var k1=function(){jc.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};_d(k1,jc);var XC=function(){var e,t;Yf.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(i){e=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(i){t=i}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(a){return a};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var o,s=[];for(o in s.push("<<"),n)s.push("/"+o+" ("+B0(i(n[o]))+")");return s.push(">>"),s.join(`
`)},set:function(i){Ma(i)==="object"&&(n=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(i){typeof i=="string"&&(n.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(i){r="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Gn.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};_d(XC,Yf),k1.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},k1.prototype.createOption=function(e){var t=new XC;return t.Parent=this,t.optionName=e,this.Kids.push(t),qJe.call(this.scope,t),t};var BE=function(){jc.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Gn.CheckBox.createAppearanceStream()};_d(BE,jc);var e0=function(){Yf.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Cl(this.Ff,13)},set:function(t){t?this.Ff=kl(this.Ff,13):this.Ff=Il(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Cl(this.Ff,21)},set:function(t){t?this.Ff=kl(this.Ff,21):this.Ff=Il(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Cl(this.Ff,23)},set:function(t){t?this.Ff=kl(this.Ff,23):this.Ff=Il(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Cl(this.Ff,24)},set:function(t){t?this.Ff=kl(this.Ff,24):this.Ff=Il(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Cl(this.Ff,25)},set:function(t){t?this.Ff=kl(this.Ff,25):this.Ff=Il(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Cl(this.Ff,26)},set:function(t){t?this.Ff=kl(this.Ff,26):this.Ff=Il(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};_d(e0,Yf);var UE=function(){e0.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Cl(this.Ff,14)},set:function(e){e?this.Ff=kl(this.Ff,14):this.Ff=Il(this.Ff,14)}}),this.password=!0};_d(UE,e0);var Gn={CheckBox:{createAppearanceStream:function(){return{N:{On:Gn.CheckBox.YesNormal},D:{On:Gn.CheckBox.YesPushDown,Off:Gn.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=Mp(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,i=e.scope.__private__.encodeColorString(e.color),o=QN(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+Hi(Gn.internal.getWidth(e))+" "+Hi(Gn.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Hi(o.fontSize)+" Tf "+i),r.push("BT"),r.push(o.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=Mp(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),i=[],o=Gn.internal.getHeight(e),s=Gn.internal.getWidth(e),a=QN(e,e.caption);return i.push("1 g"),i.push("0 0 "+Hi(s)+" "+Hi(o)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+Hi(s-1)+" "+Hi(o-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+r+" "+Hi(a.fontSize)+" Tf "+n),i.push(a.text),i.push("ET"),i.push("Q"),t.stream=i.join(`
`),t},OffPushDown:function(e){var t=Mp(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Hi(Gn.internal.getWidth(e))+" "+Hi(Gn.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:Gn.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=Gn.RadioButton.Circle.YesNormal,t.D[e]=Gn.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=Mp(e);t.scope=e.scope;var r=[],n=Gn.internal.getWidth(e)<=Gn.internal.getHeight(e)?Gn.internal.getWidth(e)/4:Gn.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=Gn.internal.Bezier_C,o=Number((n*i).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Og(Gn.internal.getWidth(e)/2)+" "+Og(Gn.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Mp(e);t.scope=e.scope;var r=[],n=Gn.internal.getWidth(e)<=Gn.internal.getHeight(e)?Gn.internal.getWidth(e)/4:Gn.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),o=Number((i*Gn.internal.Bezier_C).toFixed(5)),s=Number((n*Gn.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Og(Gn.internal.getWidth(e)/2)+" "+Og(Gn.internal.getHeight(e)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),r.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),r.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),r.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Og(Gn.internal.getWidth(e)/2)+" "+Og(Gn.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=Mp(e);t.scope=e.scope;var r=[],n=Gn.internal.getWidth(e)<=Gn.internal.getHeight(e)?Gn.internal.getWidth(e)/4:Gn.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),o=Number((i*Gn.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Og(Gn.internal.getWidth(e)/2)+" "+Og(Gn.internal.getHeight(e)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),r.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),r.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),r.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:Gn.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=Gn.RadioButton.Cross.YesNormal,t.D[e]=Gn.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=Mp(e);t.scope=e.scope;var r=[],n=Gn.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+Hi(Gn.internal.getWidth(e)-2)+" "+Hi(Gn.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(Hi(n.x1.x)+" "+Hi(n.x1.y)+" m"),r.push(Hi(n.x2.x)+" "+Hi(n.x2.y)+" l"),r.push(Hi(n.x4.x)+" "+Hi(n.x4.y)+" m"),r.push(Hi(n.x3.x)+" "+Hi(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Mp(e);t.scope=e.scope;var r=Gn.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+Hi(Gn.internal.getWidth(e))+" "+Hi(Gn.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Hi(Gn.internal.getWidth(e)-2)+" "+Hi(Gn.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(Hi(r.x1.x)+" "+Hi(r.x1.y)+" m"),n.push(Hi(r.x2.x)+" "+Hi(r.x2.y)+" l"),n.push(Hi(r.x4.x)+" "+Hi(r.x4.y)+" m"),n.push(Hi(r.x3.x)+" "+Hi(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=Mp(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Hi(Gn.internal.getWidth(e))+" "+Hi(Gn.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};Gn.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=Gn.internal.getWidth(e),r=Gn.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},Gn.internal.getWidth=function(e){var t=0;return Ma(e)==="object"&&(t=$K(e.Rect[2])),t},Gn.internal.getHeight=function(e){var t=0;return Ma(e)==="object"&&(t=$K(e.Rect[3])),t};var qJe=al.addField=function(e){if(GJe(this,e),!(e instanceof Yf))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};al.AcroFormChoiceField=E1,al.AcroFormListBox=A1,al.AcroFormComboBox=C1,al.AcroFormEditBox=FE,al.AcroFormButton=jc,al.AcroFormPushButton=zE,al.AcroFormRadioButton=k1,al.AcroFormCheckBox=BE,al.AcroFormTextField=e0,al.AcroFormPasswordField=UE,al.AcroFormAppearance=Gn,al.AcroForm={ChoiceField:E1,ListBox:A1,ComboBox:C1,EditBox:FE,Button:jc,PushButton:zE,RadioButton:k1,CheckBox:BE,TextField:e0,PasswordField:UE,Appearance:Gn},ai.AcroForm={ChoiceField:E1,ListBox:A1,ComboBox:C1,EditBox:FE,Button:jc,PushButton:zE,RadioButton:k1,CheckBox:BE,TextField:e0,PasswordField:UE,Appearance:Gn};function ghe(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},i=e.__addimage__.getImageFileTypeByImageData=function(H,X){var ee,ae,de,ye,_e,ue=r;if((X=X||r)==="RGBA"||H.data!==void 0&&H.data instanceof Uint8ClampedArray&&"height"in H&&"width"in H)return"RGBA";if(N(H))for(_e in n)for(de=n[_e],ee=0;ee<de.length;ee+=1){for(ye=!0,ae=0;ae<de[ee].length;ae+=1)if(de[ee][ae]!==void 0&&de[ee][ae]!==H[ae]){ye=!1;break}if(ye===!0){ue=_e;break}}else for(_e in n)for(de=n[_e],ee=0;ee<de.length;ee+=1){for(ye=!0,ae=0;ae<de[ee].length;ae+=1)if(de[ee][ae]!==void 0&&de[ee][ae]!==H.charCodeAt(ae)){ye=!1;break}if(ye===!0){ue=_e;break}}return ue===r&&X!==r&&(ue=X),ue},o=function H(X){for(var ee=this.internal.write,ae=this.internal.putStream,de=(0,this.internal.getFilters)();de.indexOf("FlateEncode")!==-1;)de.splice(de.indexOf("FlateEncode"),1);X.objectId=this.internal.newObject();var ye=[];if(ye.push({key:"Type",value:"/XObject"}),ye.push({key:"Subtype",value:"/Image"}),ye.push({key:"Width",value:X.width}),ye.push({key:"Height",value:X.height}),X.colorSpace===T.INDEXED?ye.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(X.palette.length/3-1)+" "+("sMask"in X&&X.sMask!==void 0?X.objectId+2:X.objectId+1)+" 0 R]"}):(ye.push({key:"ColorSpace",value:"/"+X.colorSpace}),X.colorSpace===T.DEVICE_CMYK&&ye.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ye.push({key:"BitsPerComponent",value:X.bitsPerComponent}),"decodeParameters"in X&&X.decodeParameters!==void 0&&ye.push({key:"DecodeParms",value:"<<"+X.decodeParameters+">>"}),"transparency"in X&&Array.isArray(X.transparency)){for(var _e="",ue=0,fe=X.transparency.length;ue<fe;ue++)_e+=X.transparency[ue]+" "+X.transparency[ue]+" ";ye.push({key:"Mask",value:"["+_e+"]"})}X.sMask!==void 0&&ye.push({key:"SMask",value:X.objectId+1+" 0 R"});var De=X.filter!==void 0?["/"+X.filter]:void 0;if(ae({data:X.data,additionalKeyValues:ye,alreadyAppliedFilters:De,objectId:X.objectId}),ee("endobj"),"sMask"in X&&X.sMask!==void 0){var pe=(X.predictor!=null?"/Predictor "+X.predictor:"")+" /Colors 1 /BitsPerComponent 8 /Columns "+X.width,K={width:X.width,height:X.height,colorSpace:"DeviceGray",bitsPerComponent:X.bitsPerComponent,decodeParameters:pe,data:X.sMask};"filter"in X&&(K.filter=X.filter),H.call(this,K)}if(X.colorSpace===T.INDEXED){var te=this.internal.newObject();ae({data:$(new Uint8Array(X.palette)),objectId:te}),ee("endobj")}},s=function(){var H=this.internal.collections[t+"images"];for(var X in H)o.call(this,H[X])},a=function(){var H,X=this.internal.collections[t+"images"],ee=this.internal.write;for(var ae in X)ee("/I"+(H=X[ae]).index,H.objectId,"0","R")},u=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",a))},d=function(){var H=this.internal.collections[t+"images"];return u.call(this),H},m=function(){return Object.keys(this.internal.collections[t+"images"]).length},g=function(H){return typeof e["process"+H.toUpperCase()]=="function"},_=function(H){return Ma(H)==="object"&&H.nodeType===1},y=function(H,X){if(H.nodeName==="IMG"&&H.hasAttribute("src")){var ee=""+H.getAttribute("src");if(ee.indexOf("data:image/")===0)return RE(unescape(ee).split("base64,").pop());var ae=e.loadFile(ee,!0);if(ae!==void 0)return ae}if(H.nodeName==="CANVAS"){if(H.width===0||H.height===0)throw new Error("Given canvas must have data. Canvas width: "+H.width+", height: "+H.height);var de;switch(X){case"PNG":de="image/png";break;case"WEBP":de="image/webp";break;default:de="image/jpeg"}return RE(H.toDataURL(de,1).split("base64,").pop())}},M=function(H){var X=this.internal.collections[t+"images"];if(X){for(var ee in X)if(H===X[ee].alias)return X[ee]}},x=function(H,X,ee){return H||X||(H=-96,X=-96),H<0&&(H=-1*ee.width*72/H/this.internal.scaleFactor),X<0&&(X=-1*ee.height*72/X/this.internal.scaleFactor),H===0&&(H=X*ee.width/ee.height),X===0&&(X=H*ee.height/ee.width),[H,X]},E=function(H,X,ee,ae,de,ye){var _e=x.call(this,ee,ae,de),ue=this.internal.getCoordinateString,fe=this.internal.getVerticalCoordinateString,De=d.call(this);if(ee=_e[0],ae=_e[1],De[de.index]=de,ye){ye*=Math.PI/180;var pe=Math.cos(ye),K=Math.sin(ye),te=function($e){return $e.toFixed(4)},ve=[te(pe),te(K),te(-1*K),te(pe),0,0,"cm"]}this.internal.write("q"),ye?(this.internal.write([1,"0","0",1,ue(H),fe(X+ae),"cm"].join(" ")),this.internal.write(ve.join(" ")),this.internal.write([ue(ee),"0","0",ue(ae),"0","0","cm"].join(" "))):this.internal.write([ue(ee),"0","0",ue(ae),ue(H),fe(X+ae),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+de.index+" Do"),this.internal.write("Q")},T=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var P=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},C=e.__addimage__.sHashCode=function(H){var X,ee,ae=0;if(typeof H=="string")for(ee=H.length,X=0;X<ee;X++)ae=(ae<<5)-ae+H.charCodeAt(X),ae|=0;else if(N(H))for(ee=H.byteLength/2,X=0;X<ee;X++)ae=(ae<<5)-ae+H[X],ae|=0;return ae},D=e.__addimage__.validateStringAsBase64=function(H){(H=H||"").toString().trim();var X=!0;return H.length===0&&(X=!1),H.length%4!=0&&(X=!1),/^[A-Za-z0-9+/]+$/.test(H.substr(0,H.length-2))===!1&&(X=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(H.substr(-2))===!1&&(X=!1),X},L=e.__addimage__.extractImageFromDataUrl=function(H){if(H==null||!(H=H.trim()).startsWith("data:"))return null;var X=H.indexOf(",");return X<0?null:H.substring(0,X).trim().endsWith("base64")?H.substring(X+1):null};e.__addimage__.isArrayBuffer=function(H){return H instanceof ArrayBuffer};var N=e.__addimage__.isArrayBufferView=function(H){return H instanceof Int8Array||H instanceof Uint8Array||H instanceof Uint8ClampedArray||H instanceof Int16Array||H instanceof Uint16Array||H instanceof Int32Array||H instanceof Uint32Array||H instanceof Float32Array||H instanceof Float64Array},j=e.__addimage__.binaryStringToUint8Array=function(H){for(var X=H.length,ee=new Uint8Array(X),ae=0;ae<X;ae++)ee[ae]=H.charCodeAt(ae);return ee},$=e.__addimage__.arrayBufferToBinaryString=function(H){for(var X="",ee=N(H)?H:new Uint8Array(H),ae=0;ae<ee.length;ae+=8192)X+=String.fromCharCode.apply(null,ee.subarray(ae,ae+8192));return X};e.addImage=function(){var H,X,ee,ae,de,ye,_e,ue,fe;if(typeof arguments[1]=="number"?(X=r,ee=arguments[1],ae=arguments[2],de=arguments[3],ye=arguments[4],_e=arguments[5],ue=arguments[6],fe=arguments[7]):(X=arguments[1],ee=arguments[2],ae=arguments[3],de=arguments[4],ye=arguments[5],_e=arguments[6],ue=arguments[7],fe=arguments[8]),Ma(H=arguments[0])==="object"&&!_(H)&&"imageData"in H){var De=H;H=De.imageData,X=De.format||X||r,ee=De.x||ee||0,ae=De.y||ae||0,de=De.w||De.width||de,ye=De.h||De.height||ye,_e=De.alias||_e,ue=De.compression||ue,fe=De.rotation||De.angle||fe}var pe=this.internal.getFilters();if(ue===void 0&&pe.indexOf("FlateEncode")!==-1&&(ue="SLOW"),isNaN(ee)||isNaN(ae))throw new Error("Invalid coordinates passed to jsPDF.addImage");u.call(this);var K=U.call(this,H,X,_e,ue);return E.call(this,ee,ae,de,ye,K,fe),this};var U=function(H,X,ee,ae){var de,ye,_e;if(typeof H=="string"&&i(H)===r){H=unescape(H);var ue=G(H,!1);(ue!==""||(ue=e.loadFile(H,!0))!==void 0)&&(H=ue)}if(_(H)&&(H=y(H,X)),X=i(H,X),!g(X))throw new Error("addImage does not support files of type '"+X+"', please ensure that a plugin for '"+X+"' support is added.");if(((_e=ee)==null||_e.length===0)&&(ee=function(fe){return typeof fe=="string"||N(fe)?C(fe):N(fe.data)?C(fe.data):null}(H)),(de=M.call(this,ee))||(H instanceof Uint8Array||X==="RGBA"||(ye=H,H=j(H)),de=this["process"+X.toUpperCase()](H,m.call(this),ee,function(fe){return fe&&typeof fe=="string"&&(fe=fe.toUpperCase()),fe in e.image_compression?fe:P.NONE}(ae),ye)),!de)throw new Error("An unknown error occurred whilst processing the image.");return de},G=e.__addimage__.convertBase64ToBinaryString=function(H,X){X=typeof X!="boolean"||X;var ee,ae="";if(typeof H=="string"){var de;ee=(de=L(H))!==null&&de!==void 0?de:H;try{ae=RE(ee)}catch(ye){if(X)throw D(ee)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ye.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return ae};e.getImageProperties=function(H){var X,ee,ae="";if(_(H)&&(H=y(H)),typeof H=="string"&&i(H)===r&&((ae=G(H,!1))===""&&(ae=e.loadFile(H)||""),H=ae),ee=i(H),!g(ee))throw new Error("addImage does not support files of type '"+ee+"', please ensure that a plugin for '"+ee+"' support is added.");if(H instanceof Uint8Array||(H=j(H)),!(X=this["process"+ee.toUpperCase()](H)))throw new Error("An unknown error occurred whilst processing the image");return X.fileType=ee,X}})(ai.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};ai.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,i,o,s=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,u=this.internal.getPageInfoByObjId(r.objId),d=r.pageContext.annotations,m=!1,g=0;g<d.length&&!m;g++)switch((n=d[g]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(m=!0);break;case"reference":case"text":case"freetext":m=!0}if(m!=0){this.internal.write("/Annots [");for(var _=0;_<d.length;_++){n=d[_];var y=this.internal.pdfEscape,M=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var x=this.internal.newAdditionalObject(),E=this.internal.newAdditionalObject(),T=this.internal.getEncryptor(x.objId),P=n.title||"Note";o="<</Type /Annot /Subtype /Text "+(i="/Rect ["+s(n.bounds.x)+" "+a(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w)+" "+a(n.bounds.y)+"] ")+"/Contents ("+y(T(n.contents))+")",o+=" /Popup "+E.objId+" 0 R",o+=" /P "+u.objId+" 0 R",o+=" /T ("+y(T(P))+") >>",x.content=o;var C=x.objId+" 0 R";o="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+s(n.bounds.x+30)+" "+a(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w+30)+" "+a(n.bounds.y)+"] ")+" /Parent "+C,n.open&&(o+=" /Open true"),o+=" >>",E.content=o,this.internal.write(x.objId,"0 R",E.objId,"0 R");break;case"freetext":i="/Rect ["+s(n.bounds.x)+" "+a(n.bounds.y)+" "+s(n.bounds.x+n.bounds.w)+" "+a(n.bounds.y+n.bounds.h)+"] ";var D=n.color||"#000000";o="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+y(M(n.contents))+")",o+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+D+")",o+=" /Border [0 0 0]",o+=" >>",this.internal.write(o);break;case"link":if(n.options.name){var L=this.annotations._nameMap[n.options.name];n.options.pageNumber=L.page,n.options.top=L.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",o="",n.options.url)o="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+y(M(n.options.url))+") >>";else if(n.options.pageNumber)switch(o="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":o+=" /Fit]";break;case"FitH":o+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,o+=" /FitV "+n.options.left+"]";break;default:var N=a(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),o+=" /XYZ "+n.options.left+" "+N+" "+n.options.zoom+"]"}o!=""&&(o+=" >>",this.internal.write(o))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,i,o,s){var a=this.internal.getCurrentPageInfo(),u=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString;a.pageContext.annotations.push({finalBounds:{x:u(r),y:d(n),w:u(r+i),h:d(n+o)},options:s,type:"link"})},e.textWithLink=function(r,n,i,o){var s,a,u=this.getTextWidth(r),d=this.internal.getLineHeight()/this.internal.scaleFactor;if(o.maxWidth!==void 0){a=o.maxWidth;var m=this.splitTextToSize(r,a).length;s=Math.ceil(d*m)}else a=u,s=d;return this.text(r,n,i,o),i+=.2*d,o.align==="center"&&(n-=u/2),o.align==="right"&&(n-=u),this.link(n,i-d,a,s,o),u},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(ai.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];e.__arabicParser__={};var o=e.__arabicParser__.isInArabicSubstitutionA=function(x){return t[x.charCodeAt(0)]!==void 0},s=e.__arabicParser__.isArabicLetter=function(x){return typeof x=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(x)},a=e.__arabicParser__.isArabicEndLetter=function(x){return s(x)&&o(x)&&t[x.charCodeAt(0)].length<=2},u=e.__arabicParser__.isArabicAlfLetter=function(x){return s(x)&&i.indexOf(x.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(x){return s(x)&&o(x)&&t[x.charCodeAt(0)].length>=1};var d=e.__arabicParser__.arabicLetterHasFinalForm=function(x){return s(x)&&o(x)&&t[x.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(x){return s(x)&&o(x)&&t[x.charCodeAt(0)].length>=3};var m=e.__arabicParser__.arabicLetterHasMedialForm=function(x){return s(x)&&o(x)&&t[x.charCodeAt(0)].length==4},g=e.__arabicParser__.resolveLigatures=function(x){var E=0,T=r,P="",C=0;for(E=0;E<x.length;E+=1)T[x.charCodeAt(E)]!==void 0?(C++,typeof(T=T[x.charCodeAt(E)])=="number"&&(P+=String.fromCharCode(T),T=r,C=0),E===x.length-1&&(T=r,P+=x.charAt(E-(C-1)),E-=C-1,C=0)):(T=r,P+=x.charAt(E-C),E-=C,C=0);return P};e.__arabicParser__.isArabicDiacritic=function(x){return x!==void 0&&n[x.charCodeAt(0)]!==void 0};var _=e.__arabicParser__.getCorrectForm=function(x,E,T){return s(x)?o(x)===!1?-1:!d(x)||!s(E)&&!s(T)||!s(T)&&a(E)||a(x)&&!s(E)||a(x)&&u(E)||a(x)&&a(E)?0:m(x)&&s(E)&&!a(E)&&s(T)&&d(T)?3:a(x)||!s(T)?1:2:-1},y=function(x){var E=0,T=0,P=0,C="",D="",L="",N=(x=x||"").split("\\s+"),j=[];for(E=0;E<N.length;E+=1){for(j.push(""),T=0;T<N[E].length;T+=1)C=N[E][T],D=N[E][T-1],L=N[E][T+1],s(C)?(P=_(C,D,L),j[E]+=P!==-1?String.fromCharCode(t[C.charCodeAt(0)][P]):C):j[E]+=C;j[E]=g(j[E])}return j.join(" ")},M=e.__arabicParser__.processArabic=e.processArabic=function(){var x,E=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,T=[];if(Array.isArray(E)){var P=0;for(T=[],P=0;P<E.length;P+=1)Array.isArray(E[P])?T.push([y(E[P][0]),E[P][1],E[P][2]]):T.push([y(E[P])]);x=T}else x=y(E);return typeof arguments[0]=="string"?x:(arguments[0].text=x,arguments[0])};e.events.push(["preProcessText",M])}(ai.API),ai.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(a){r=a}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(a){n=isNaN(a)||Number.isInteger(a)===!1||a<0?150:a,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(a){i=isNaN(a)||Number.isInteger(a)===!1||a<0?300:a,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var o=[];Object.defineProperty(this,"childNodes",{get:function(){return o},set:function(a){o=a}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(a){s=a}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var i;if((r=r||"2d")!=="2d")return null;for(i in n)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=n[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(ai.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new o,this.internal.__cell__.pages=1},o=function(){var u=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return u},set:function(x){u=x}});var d=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return d},set:function(x){d=x}});var m=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return m},set:function(x){m=x}});var g=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return g},set:function(x){g=x}});var _=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return _},set:function(x){_=x}});var y=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return y},set:function(x){y=x}});var M=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return M},set:function(x){M=x}}),this};o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},o.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(u){return n.call(this),this.internal.__cell__.headerFunction=typeof u=="function"?u:void 0,this},e.getTextDimensions=function(u,d){n.call(this);var m=(d=d||{}).fontSize||this.getFontSize(),g=d.font||this.getFont(),_=d.scaleFactor||this.internal.scaleFactor,y=0,M=0,x=0,E=this;if(!Array.isArray(u)&&typeof u!="string"){if(typeof u!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");u=String(u)}var T=d.maxWidth;T>0?typeof u=="string"?u=this.splitTextToSize(u,T):Object.prototype.toString.call(u)==="[object Array]"&&(u=u.reduce(function(C,D){return C.concat(E.splitTextToSize(D,T))},[])):u=Array.isArray(u)?u:[u];for(var P=0;P<u.length;P++)y<(x=this.getStringUnitWidth(u[P],{font:g})*m)&&(y=x);return y!==0&&(M=u.length),{w:y/=_,h:Math.max((M*m*this.getLineHeightFactor()-m*(this.getLineHeightFactor()-1))/_,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var u=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new o(u.left,u.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=e.cell=function(){var u;u=arguments[0]instanceof o?arguments[0]:new o(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var d=this.internal.__cell__.lastCell,m=this.internal.__cell__.padding,g=this.internal.__cell__.margins||t,_=this.internal.__cell__.tableHeaderRow,y=this.internal.__cell__.printHeaders;return d.lineNumber!==void 0&&(d.lineNumber===u.lineNumber?(u.x=(d.x||0)+(d.width||0),u.y=d.y||0):d.y+d.height+u.height+g.bottom>this.getPageHeight()?(this.cellAddPage(),u.y=g.top,y&&_&&(this.printHeaderRow(u.lineNumber,!0),u.y+=_[0].height)):u.y=d.y+d.height||u.y),u.text[0]!==void 0&&(this.rect(u.x,u.y,u.width,u.height,r===!0?"FD":void 0),u.align==="right"?this.text(u.text,u.x+u.width-m,u.y+m,{align:"right",baseline:"top"}):u.align==="center"?this.text(u.text,u.x+u.width/2,u.y+m,{align:"center",baseline:"top",maxWidth:u.width-m-m}):this.text(u.text,u.x+m,u.y+m,{align:"left",baseline:"top",maxWidth:u.width-m-m})),this.internal.__cell__.lastCell=u,this};e.table=function(u,d,m,g,_){if(n.call(this),!m)throw new Error("No data for PDF table.");var y,M,x,E,T=[],P=[],C=[],D={},L={},N=[],j=[],$=(_=_||{}).autoSize||!1,U=_.printHeaders!==!1,G=_.css&&_.css["font-size"]!==void 0?16*_.css["font-size"]:_.fontSize||12,H=_.margins||Object.assign({width:this.getPageWidth()},t),X=typeof _.padding=="number"?_.padding:3,ee=_.headerBackgroundColor||"#c8c8c8",ae=_.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=U,this.internal.__cell__.margins=H,this.internal.__cell__.table_font_size=G,this.internal.__cell__.padding=X,this.internal.__cell__.headerBackgroundColor=ee,this.internal.__cell__.headerTextColor=ae,this.setFontSize(G),g==null)P=T=Object.keys(m[0]),C=T.map(function(){return"left"});else if(Array.isArray(g)&&Ma(g[0])==="object")for(T=g.map(function(De){return De.name}),P=g.map(function(De){return De.prompt||De.name||""}),C=g.map(function(De){return De.align||"left"}),y=0;y<g.length;y+=1)L[g[y].name]=.7499990551181103*g[y].width;else Array.isArray(g)&&typeof g[0]=="string"&&(P=T=g,C=T.map(function(){return"left"}));if($||Array.isArray(g)&&typeof g[0]=="string")for(y=0;y<T.length;y+=1){for(D[E=T[y]]=m.map(function(De){return De[E]}),this.setFont(void 0,"bold"),N.push(this.getTextDimensions(P[y],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),M=D[E],this.setFont(void 0,"normal"),x=0;x<M.length;x+=1)N.push(this.getTextDimensions(M[x],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);L[E]=Math.max.apply(null,N)+X+X,N=[]}if(U){var de={};for(y=0;y<T.length;y+=1)de[T[y]]={},de[T[y]].text=P[y],de[T[y]].align=C[y];var ye=a.call(this,de,L);j=T.map(function(De){return new o(u,d,L[De],ye,de[De].text,void 0,de[De].align)}),this.setTableHeaderRow(j),this.printHeaderRow(1,!1)}var _e=g.reduce(function(De,pe){return De[pe.name]=pe.align,De},{});for(y=0;y<m.length;y+=1){"rowStart"in _&&_.rowStart instanceof Function&&_.rowStart({row:y,data:m[y]},this);var ue=a.call(this,m[y],L);for(x=0;x<T.length;x+=1){var fe=m[y][T[x]];"cellStart"in _&&_.cellStart instanceof Function&&_.cellStart({row:y,col:x,data:fe},this),s.call(this,new o(u,d,L[T[x]],ue,fe,y+2,_e[T[x]]))}}return this.internal.__cell__.table_x=u,this.internal.__cell__.table_y=d,this};var a=function(u,d){var m=this.internal.__cell__.padding,g=this.internal.__cell__.table_font_size,_=this.internal.scaleFactor;return Object.keys(u).map(function(y){var M=u[y];return this.splitTextToSize(M.hasOwnProperty("text")?M.text:M,d[y]-m-m)},this).map(function(y){return this.getLineHeightFactor()*y.length*g/_+m+m},this).reduce(function(y,M){return Math.max(y,M)},0)};e.setTableHeaderRow=function(u){n.call(this),this.internal.__cell__.tableHeaderRow=u},e.printHeaderRow=function(u,d){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var m;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var g=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new o(g[0],g[1],g[2],g[3],void 0,-1)}this.setFont(void 0,"bold");for(var _=[],y=0;y<this.internal.__cell__.tableHeaderRow.length;y+=1){m=this.internal.__cell__.tableHeaderRow[y].clone(),d&&(m.y=this.internal.__cell__.margins.top||0,_.push(m)),m.lineNumber=u;var M=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,m),this.setTextColor(M)}_.length>0&&this.setTableHeaderRow(_),this.setFont(void 0,"normal"),r=!1}}(ai.API);var _he={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},yhe=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],JN=ghe(yhe),vhe=[100,200,300,400,500,600,700,800,900],HJe=ghe(vhe);function QO(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(o){return _he[o=o||"normal"]?o:"normal"}(e.style),n=function(o){return o?typeof o=="number"?o>=100&&o<=900&&o%100==0?o:400:/^\d00$/.test(o)?parseInt(o):o==="bold"?700:400:400}(e.weight),i=function(o){return typeof JN[o=o||"normal"]=="number"?o:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:i,src:e.src||[],ref:e.ref||{name:t,style:[i,r,n].join(" ")}}}function NK(e,t,r,n){var i;for(i=r;i>=0&&i<t.length;i+=n)if(e[t[i]])return e[t[i]];for(i=r;i>=0&&i<t.length;i-=n)if(e[t[i]])return e[t[i]]}var KJe={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},jK={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function RK(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function FK(e){return e.trimLeft()}function ZJe(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function XJe(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var aE,zK,BK,Dv,sE,UK,VK,WK,JO=["times"];function GK(e,t,r,n){var i=4,o=HK;switch(n){case ai.API.image_compression.FAST:i=1,o=qK;break;case ai.API.image_compression.MEDIUM:i=6,o=KK;break;case ai.API.image_compression.SLOW:i=9,o=ZK}e=function(a,u,d,m){for(var g,_=a.length/u,y=new Uint8Array(a.length+_),M=[YJe,qK,HK,KK,ZK],x=0;x<_;x+=1){var E=x*u,T=a.subarray(E,E+u);if(m)y.set(m(T,d,g),E+x);else{for(var P=M.length,C=[],D=0;D<P;D+=1)C[D]=M[D](T,d,g);var L=JJe(C.concat());y.set(C[L],E+x)}g=T}return y}(e,t,r,o);var s=zN(e,{level:i});return ai.API.__addimage__.arrayBufferToBinaryString(s)}function YJe(e){var t=Array.apply([],e);return t.unshift(0),t}function qK(e,t){var r=e.length,n=[];n[0]=1;for(var i=0;i<r;i+=1){var o=e[i-t]||0;n[i+1]=e[i]-o+256&255}return n}function HK(e,t,r){var n=e.length,i=[];i[0]=2;for(var o=0;o<n;o+=1){var s=r&&r[o]||0;i[o+1]=e[o]-s+256&255}return i}function KK(e,t,r){var n=e.length,i=[];i[0]=3;for(var o=0;o<n;o+=1){var s=e[o-t]||0,a=r&&r[o]||0;i[o+1]=e[o]+256-(s+a>>>1)&255}return i}function ZK(e,t,r){var n=e.length,i=[];i[0]=4;for(var o=0;o<n;o+=1){var s=QJe(e[o-t]||0,r&&r[o]||0,r&&r[o-t]||0);i[o+1]=e[o]-s+256&255}return i}function QJe(e,t,r){if(e===t&&t===r)return e;var n=Math.abs(t-r),i=Math.abs(e-r),o=Math.abs(e+t-r-r);return n<=i&&n<=o?e:i<=o?t:r}function JJe(e){var t=e.map(function(r){return r.reduce(function(n,i){return n+Math.abs(i)},0)});return t.indexOf(Math.min.apply(null,t))}function eL(e,t,r){var n=t*r,i=Math.floor(n/8),o=16-(n-8*i+r),s=(1<<r)-1;return bhe(e,i)>>o&s}function XK(e,t,r,n){var i=r*n,o=Math.floor(i/8),s=16-(i-8*o+n),a=(1<<n)-1,u=(t&a)<<s;(function(d,m,g){if(m+1<d.byteLength)d.setUint16(m,g,!1);else{var _=g>>8&255;d.setUint8(m,_)}})(e,o,bhe(e,o)&~(a<<s)&65535|u)}function bhe(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function eet(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,i=e[t++],o=i>>7,s=1<<1+(7&i);e[t++],e[t++];var a=null,u=null;o&&(a=t,u=s,t+=3*s);var d=!0,m=[],g=0,_=null,y=0,M=null;for(this.width=r,this.height=n;d&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,M=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((H=e[t++])>=0))throw Error("Invalid block size");if(H===0)break;t+=H}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var x=e[t++];g=e[t++]|e[t++]<<8,_=e[t++],1&x||(_=null),y=x>>2&7,t++;break;case 254:for(;;){if(!((H=e[t++])>=0))throw Error("Invalid block size");if(H===0)break;t+=H}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var E=e[t++]|e[t++]<<8,T=e[t++]|e[t++]<<8,P=e[t++]|e[t++]<<8,C=e[t++]|e[t++]<<8,D=e[t++],L=D>>6&1,N=1<<1+(7&D),j=a,$=u,U=!1;D>>7&&(U=!0,j=t,$=N,t+=3*N);var G=t;for(t++;;){var H;if(!((H=e[t++])>=0))throw Error("Invalid block size");if(H===0)break;t+=H}m.push({x:E,y:T,width:P,height:C,has_local_palette:U,palette_offset:j,palette_size:$,data_offset:G,data_length:t-G,transparent_index:_,interlaced:!!L,delay:g,disposal:y});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return m.length},this.loopCount=function(){return M},this.frameInfo=function(X){if(X<0||X>=m.length)throw new Error("Frame index out of range.");return m[X]},this.decodeAndBlitFrameBGRA=function(X,ee){var ae=this.frameInfo(X),de=ae.width*ae.height,ye=new Uint8Array(de);YK(e,ae.data_offset,ye,de);var _e=ae.palette_offset,ue=ae.transparent_index;ue===null&&(ue=256);var fe=ae.width,De=r-fe,pe=fe,K=4*(ae.y*r+ae.x),te=4*((ae.y+ae.height)*r+ae.x),ve=K,$e=4*De;ae.interlaced===!0&&($e+=4*r*7);for(var Ce=8,Ge=0,ot=ye.length;Ge<ot;++Ge){var Ye=ye[Ge];if(pe===0&&(pe=fe,(ve+=$e)>=te&&($e=4*De+4*r*(Ce-1),ve=K+(fe+De)*(Ce<<1),Ce>>=1)),Ye===ue)ve+=4;else{var et=e[_e+3*Ye],Te=e[_e+3*Ye+1],Le=e[_e+3*Ye+2];ee[ve++]=Le,ee[ve++]=Te,ee[ve++]=et,ee[ve++]=255}--pe}},this.decodeAndBlitFrameRGBA=function(X,ee){var ae=this.frameInfo(X),de=ae.width*ae.height,ye=new Uint8Array(de);YK(e,ae.data_offset,ye,de);var _e=ae.palette_offset,ue=ae.transparent_index;ue===null&&(ue=256);var fe=ae.width,De=r-fe,pe=fe,K=4*(ae.y*r+ae.x),te=4*((ae.y+ae.height)*r+ae.x),ve=K,$e=4*De;ae.interlaced===!0&&($e+=4*r*7);for(var Ce=8,Ge=0,ot=ye.length;Ge<ot;++Ge){var Ye=ye[Ge];if(pe===0&&(pe=fe,(ve+=$e)>=te&&($e=4*De+4*r*(Ce-1),ve=K+(fe+De)*(Ce<<1),Ce>>=1)),Ye===ue)ve+=4;else{var et=e[_e+3*Ye],Te=e[_e+3*Ye+1],Le=e[_e+3*Ye+2];ee[ve++]=et,ee[ve++]=Te,ee[ve++]=Le,ee[ve++]=255}--pe}}}function YK(e,t,r,n){for(var i=e[t++],o=1<<i,s=o+1,a=s+1,u=i+1,d=(1<<u)-1,m=0,g=0,_=0,y=e[t++],M=new Int32Array(4096),x=null;;){for(;m<16&&y!==0;)g|=e[t++]<<m,m+=8,y===1?y=e[t++]:--y;if(m<u)break;var E=g&d;if(g>>=u,m-=u,E!==o){if(E===s)break;for(var T=E<a?E:x,P=0,C=T;C>o;)C=M[C]>>8,++P;var D=C;if(_+P+(T!==E?1:0)>n)return void Ba.log("Warning, gif stream longer than expected.");r[_++]=D;var L=_+=P;for(T!==E&&(r[_++]=D),C=T;P--;)C=M[C],r[--L]=255&C,C>>=8;x!==null&&a<4096&&(M[a++]=x<<8|D,a>=d+1&&u<12&&(++u,d=d<<1|1)),x=E}else a=s+1,d=(1<<(u=i+1))-1,x=null}return _!==n&&Ba.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function tL(e){var t,r,n,i,o,s=Math.floor,a=new Array(64),u=new Array(64),d=new Array(64),m=new Array(64),g=new Array(65535),_=new Array(65535),y=new Array(64),M=new Array(64),x=[],E=0,T=7,P=new Array(64),C=new Array(64),D=new Array(64),L=new Array(256),N=new Array(2048),j=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],$=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],U=[0,1,2,3,4,5,6,7,8,9,10,11],G=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],H=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],X=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],ee=[0,1,2,3,4,5,6,7,8,9,10,11],ae=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],de=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ye(K,te){for(var ve=0,$e=0,Ce=new Array,Ge=1;Ge<=16;Ge++){for(var ot=1;ot<=K[Ge];ot++)Ce[te[$e]]=[],Ce[te[$e]][0]=ve,Ce[te[$e]][1]=Ge,$e++,ve++;ve*=2}return Ce}function _e(K){for(var te=K[0],ve=K[1]-1;ve>=0;)te&1<<ve&&(E|=1<<T),ve--,--T<0&&(E==255?(ue(255),ue(0)):ue(E),T=7,E=0)}function ue(K){x.push(K)}function fe(K){ue(K>>8&255),ue(255&K)}function De(K,te,ve,$e,Ce){for(var Ge,ot=Ce[0],Ye=Ce[240],et=function(mt,Zt){var Kt,dr,Bt,wr,mr,hr,xr,or,tt,Se,Pe=0;for(tt=0;tt<8;++tt){Kt=mt[Pe],dr=mt[Pe+1],Bt=mt[Pe+2],wr=mt[Pe+3],mr=mt[Pe+4],hr=mt[Pe+5],xr=mt[Pe+6];var Ve=Kt+(or=mt[Pe+7]),Qe=Kt-or,dt=dr+xr,Pt=dr-xr,Vt=Bt+hr,At=Bt-hr,qt=wr+mr,er=wr-mr,fr=Ve+qt,Jr=Ve-qt,$t=dt+Vt,zr=dt-Vt;mt[Pe]=fr+$t,mt[Pe+4]=fr-$t;var Sr=.707106781*(zr+Jr);mt[Pe+2]=Jr+Sr,mt[Pe+6]=Jr-Sr;var Ir=.382683433*((fr=er+At)-(zr=Pt+Qe)),Xr=.5411961*fr+Ir,qr=1.306562965*zr+Ir,An=.707106781*($t=At+Pt),ge=Qe+An,ut=Qe-An;mt[Pe+5]=ut+Xr,mt[Pe+3]=ut-Xr,mt[Pe+1]=ge+qr,mt[Pe+7]=ge-qr,Pe+=8}for(Pe=0,tt=0;tt<8;++tt){Kt=mt[Pe],dr=mt[Pe+8],Bt=mt[Pe+16],wr=mt[Pe+24],mr=mt[Pe+32],hr=mt[Pe+40],xr=mt[Pe+48];var We=Kt+(or=mt[Pe+56]),Je=Kt-or,xt=dr+xr,wt=dr-xr,pr=Bt+hr,Rr=Bt-hr,On=wr+mr,Mn=wr-mr,_r=We+On,Or=We-On,an=xt+pr,Vn=xt-pr;mt[Pe]=_r+an,mt[Pe+32]=_r-an;var _o=.707106781*(Vn+Or);mt[Pe+16]=Or+_o,mt[Pe+48]=Or-_o;var Uo=.382683433*((_r=Mn+Rr)-(Vn=wt+Je)),yn=.5411961*_r+Uo,Vo=1.306562965*Vn+Uo,Po=.707106781*(an=Rr+wt),pa=Je+Po,ta=Je-Po;mt[Pe+40]=ta+yn,mt[Pe+24]=ta-yn,mt[Pe+8]=pa+Vo,mt[Pe+56]=pa-Vo,Pe++}for(tt=0;tt<64;++tt)Se=mt[tt]*Zt[tt],y[tt]=Se>0?Se+.5|0:Se-.5|0;return y}(K,te),Te=0;Te<64;++Te)M[j[Te]]=et[Te];var Le=M[0]-ve;ve=M[0],Le==0?_e($e[0]):(_e($e[_[Ge=32767+Le]]),_e(g[Ge]));for(var ke=63;ke>0&&M[ke]==0;)ke--;if(ke==0)return _e(ot),ve;for(var Xe,Ne=1;Ne<=ke;){for(var Ot=Ne;M[Ne]==0&&Ne<=ke;)++Ne;var Lt=Ne-Ot;if(Lt>=16){Xe=Lt>>4;for(var kt=1;kt<=Xe;++kt)_e(Ye);Lt&=15}Ge=32767+M[Ne],_e(Ce[(Lt<<4)+_[Ge]]),_e(g[Ge]),Ne++}return ke!=63&&_e(ot),ve}function pe(K){K=Math.min(Math.max(K,1),100),o!=K&&(function(te){for(var ve=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],$e=0;$e<64;$e++){var Ce=s((ve[$e]*te+50)/100);Ce=Math.min(Math.max(Ce,1),255),a[j[$e]]=Ce}for(var Ge=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ot=0;ot<64;ot++){var Ye=s((Ge[ot]*te+50)/100);Ye=Math.min(Math.max(Ye,1),255),u[j[ot]]=Ye}for(var et=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Te=0,Le=0;Le<8;Le++)for(var ke=0;ke<8;ke++)d[Te]=1/(a[j[Te]]*et[Le]*et[ke]*8),m[Te]=1/(u[j[Te]]*et[Le]*et[ke]*8),Te++}(K<50?Math.floor(5e3/K):Math.floor(200-2*K)),o=K)}this.encode=function(K,te){te&&pe(te),x=new Array,E=0,T=7,fe(65496),fe(65504),fe(16),ue(74),ue(70),ue(73),ue(70),ue(0),ue(1),ue(1),ue(0),fe(1),fe(1),ue(0),ue(0),function(){fe(65499),fe(132),ue(0);for(var dr=0;dr<64;dr++)ue(a[dr]);ue(1);for(var Bt=0;Bt<64;Bt++)ue(u[Bt])}(),function(dr,Bt){fe(65472),fe(17),ue(8),fe(Bt),fe(dr),ue(3),ue(1),ue(17),ue(0),ue(2),ue(17),ue(1),ue(3),ue(17),ue(1)}(K.width,K.height),function(){fe(65476),fe(418),ue(0);for(var dr=0;dr<16;dr++)ue($[dr+1]);for(var Bt=0;Bt<=11;Bt++)ue(U[Bt]);ue(16);for(var wr=0;wr<16;wr++)ue(G[wr+1]);for(var mr=0;mr<=161;mr++)ue(H[mr]);ue(1);for(var hr=0;hr<16;hr++)ue(X[hr+1]);for(var xr=0;xr<=11;xr++)ue(ee[xr]);ue(17);for(var or=0;or<16;or++)ue(ae[or+1]);for(var tt=0;tt<=161;tt++)ue(de[tt])}(),fe(65498),fe(12),ue(3),ue(1),ue(0),ue(2),ue(17),ue(3),ue(17),ue(0),ue(63),ue(0);var ve=0,$e=0,Ce=0;E=0,T=7,this.encode.displayName="_encode_";for(var Ge,ot,Ye,et,Te,Le,ke,Xe,Ne,Ot=K.data,Lt=K.width,kt=K.height,mt=4*Lt,Zt=0;Zt<kt;){for(Ge=0;Ge<mt;){for(Te=mt*Zt+Ge,ke=-1,Xe=0,Ne=0;Ne<64;Ne++)Le=Te+(Xe=Ne>>3)*mt+(ke=4*(7&Ne)),Zt+Xe>=kt&&(Le-=mt*(Zt+1+Xe-kt)),Ge+ke>=mt&&(Le-=Ge+ke-mt+4),ot=Ot[Le++],Ye=Ot[Le++],et=Ot[Le++],P[Ne]=(N[ot]+N[Ye+256|0]+N[et+512|0]>>16)-128,C[Ne]=(N[ot+768|0]+N[Ye+1024|0]+N[et+1280|0]>>16)-128,D[Ne]=(N[ot+1280|0]+N[Ye+1536|0]+N[et+1792|0]>>16)-128;ve=De(P,d,ve,t,n),$e=De(C,m,$e,r,i),Ce=De(D,m,Ce,r,i),Ge+=32}Zt+=8}if(T>=0){var Kt=[];Kt[1]=T+1,Kt[0]=(1<<T+1)-1,_e(Kt)}return fe(65497),new Uint8Array(x)},e=e||50,function(){for(var K=String.fromCharCode,te=0;te<256;te++)L[te]=K(te)}(),t=ye($,U),r=ye(X,ee),n=ye(G,H),i=ye(ae,de),function(){for(var K=1,te=2,ve=1;ve<=15;ve++){for(var $e=K;$e<te;$e++)_[32767+$e]=ve,g[32767+$e]=[],g[32767+$e][1]=ve,g[32767+$e][0]=$e;for(var Ce=-(te-1);Ce<=-K;Ce++)_[32767+Ce]=ve,g[32767+Ce]=[],g[32767+Ce][1]=ve,g[32767+Ce][0]=te-1+Ce;K<<=1,te<<=1}}(),function(){for(var K=0;K<256;K++)N[K]=19595*K,N[K+256|0]=38470*K,N[K+512|0]=7471*K+32768,N[K+768|0]=-11059*K,N[K+1024|0]=-21709*K,N[K+1280|0]=32768*K+8421375,N[K+1536|0]=-27439*K,N[K+1792|0]=-5329*K}(),pe(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function xf(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function QK(e){function t(U){if(!U)throw Error("assert :P")}function r(U,G,H){for(var X=0;4>X;X++)if(U[G+X]!=H.charCodeAt(X))return!0;return!1}function n(U,G,H,X,ee){for(var ae=0;ae<ee;ae++)U[G+ae]=H[X+ae]}function i(U,G,H,X){for(var ee=0;ee<X;ee++)U[G+ee]=H}function o(U){return new Int32Array(U)}function s(U,G){for(var H=[],X=0;X<U;X++)H.push(new G);return H}function a(U,G){var H=[];return function X(ee,ae,de){for(var ye=de[ae],_e=0;_e<ye&&(ee.push(de.length>ae+1?[]:new G),!(de.length<ae+1));_e++)X(ee[_e],ae+1,de)}(H,0,U),H}var u=function(){var U=this;function G(B,q){for(var le=1<<q-1>>>0;B&le;)le>>>=1;return le?(B&le-1)+le:B}function H(B,q,le,we,Be){t(!(we%le));do B[q+(we-=le)]=Be;while(0<we)}function X(B,q,le,we,Be){if(t(2328>=Be),512>=Be)var Ze=o(512);else if((Ze=o(Be))==null)return 0;return function(Re,nt,ht,bt,Gt,ar){var vt,Nt,tr=nt,Tr=1<<ht,sr=o(16),Ar=o(16);for(t(Gt!=0),t(bt!=null),t(Re!=null),t(0<ht),Nt=0;Nt<Gt;++Nt){if(15<bt[Nt])return 0;++sr[bt[Nt]]}if(sr[0]==Gt)return 0;for(Ar[1]=0,vt=1;15>vt;++vt){if(sr[vt]>1<<vt)return 0;Ar[vt+1]=Ar[vt]+sr[vt]}for(Nt=0;Nt<Gt;++Nt)vt=bt[Nt],0<bt[Nt]&&(ar[Ar[vt]++]=Nt);if(Ar[15]==1)return(bt=new ee).g=0,bt.value=ar[0],H(Re,tr,1,Tr,bt),Tr;var Lr,Zr=-1,Ur=Tr-1,zn=0,Cn=1,Si=1,jn=1<<ht;for(Nt=0,vt=1,Gt=2;vt<=ht;++vt,Gt<<=1){if(Cn+=Si<<=1,0>(Si-=sr[vt]))return 0;for(;0<sr[vt];--sr[vt])(bt=new ee).g=vt,bt.value=ar[Nt++],H(Re,tr+zn,Gt,jn,bt),zn=G(zn,vt)}for(vt=ht+1,Gt=2;15>=vt;++vt,Gt<<=1){if(Cn+=Si<<=1,0>(Si-=sr[vt]))return 0;for(;0<sr[vt];--sr[vt]){if(bt=new ee,(zn&Ur)!=Zr){for(tr+=jn,Lr=1<<(Zr=vt)-ht;15>Zr&&!(0>=(Lr-=sr[Zr]));)++Zr,Lr<<=1;Tr+=jn=1<<(Lr=Zr-ht),Re[nt+(Zr=zn&Ur)].g=Lr+ht,Re[nt+Zr].value=tr-nt-Zr}bt.g=vt-ht,bt.value=ar[Nt++],H(Re,tr+(zn>>ht),Gt,jn,bt),zn=G(zn,vt)}}return Cn!=2*Ar[15]-1?0:Tr}(B,q,le,we,Be,Ze)}function ee(){this.value=this.g=0}function ae(){this.value=this.g=0}function de(){this.G=s(5,ee),this.H=o(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(Rs,ae)}function ye(B,q,le,we){t(B!=null),t(q!=null),t(2147483648>we),B.Ca=254,B.I=0,B.b=-8,B.Ka=0,B.oa=q,B.pa=le,B.Jd=q,B.Yc=le+we,B.Zc=4<=we?le+we-4+1:le,ot(B)}function _e(B,q){for(var le=0;0<q--;)le|=et(B,128)<<q;return le}function ue(B,q){var le=_e(B,q);return Ye(B)?-le:le}function fe(B,q,le,we){var Be,Ze=0;for(t(B!=null),t(q!=null),t(4294967288>we),B.Sb=we,B.Ra=0,B.u=0,B.h=0,4<we&&(we=4),Be=0;Be<we;++Be)Ze+=q[le+Be]<<8*Be;B.Ra=Ze,B.bb=we,B.oa=q,B.pa=le}function De(B){for(;8<=B.u&&B.bb<B.Sb;)B.Ra>>>=8,B.Ra+=B.oa[B.pa+B.bb]<<Mc-8>>>0,++B.bb,B.u-=8;$e(B)&&(B.h=1,B.u=0)}function pe(B,q){if(t(0<=q),!B.h&&q<=tc){var le=ve(B)&ec[q];return B.u+=q,De(B),le}return B.h=1,B.u=0}function K(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function te(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function ve(B){return B.Ra>>>(B.u&Mc-1)>>>0}function $e(B){return t(B.bb<=B.Sb),B.h||B.bb==B.Sb&&B.u>Mc}function Ce(B,q){B.u=q,B.h=$e(B)}function Ge(B){B.u>=Co&&(t(B.u>=Co),De(B))}function ot(B){t(B!=null&&B.oa!=null),B.pa<B.Zc?(B.I=(B.oa[B.pa++]|B.I<<8)>>>0,B.b+=8):(t(B!=null&&B.oa!=null),B.pa<B.Yc?(B.b+=8,B.I=B.oa[B.pa++]|B.I<<8):B.Ka?B.b=0:(B.I<<=8,B.b+=8,B.Ka=1))}function Ye(B){return _e(B,1)}function et(B,q){var le=B.Ca;0>B.b&&ot(B);var we=B.b,Be=le*q>>>8,Ze=(B.I>>>we>Be)+0;for(Ze?(le-=Be,B.I-=Be+1<<we>>>0):le=Be+1,we=le,Be=0;256<=we;)Be+=8,we>>=8;return we=7^Be+$n[we],B.b-=we,B.Ca=(le<<we)-1,Ze}function Te(B,q,le){B[q+0]=le>>24&255,B[q+1]=le>>16&255,B[q+2]=le>>8&255,B[q+3]=255&le}function Le(B,q){return B[q+0]|B[q+1]<<8}function ke(B,q){return Le(B,q)|B[q+2]<<16}function Xe(B,q){return Le(B,q)|Le(B,q+2)<<16}function Ne(B,q){var le=1<<q;return t(B!=null),t(0<q),B.X=o(le),B.X==null?0:(B.Mb=32-q,B.Xa=q,1)}function Ot(B,q){t(B!=null),t(q!=null),t(B.Xa==q.Xa),n(q.X,0,B.X,0,1<<q.Xa)}function Lt(){this.X=[],this.Xa=this.Mb=0}function kt(B,q,le,we){t(le!=null),t(we!=null);var Be=le[0],Ze=we[0];return Be==0&&(Be=(B*Ze+q/2)/q),Ze==0&&(Ze=(q*Be+B/2)/B),0>=Be||0>=Ze?0:(le[0]=Be,we[0]=Ze,1)}function mt(B,q){return B+(1<<q)-1>>>q}function Zt(B,q){return((4278255360&B)+(4278255360&q)>>>0&4278255360)+((16711935&B)+(16711935&q)>>>0&16711935)>>>0}function Kt(B,q){U[q]=function(le,we,Be,Ze,Re,nt,ht){var bt;for(bt=0;bt<Re;++bt){var Gt=U[B](nt[ht+bt-1],Be,Ze+bt);nt[ht+bt]=Zt(le[we+bt],Gt)}}}function dr(){this.ud=this.hd=this.jd=0}function Bt(B,q){return((4278124286&(B^q))>>>1)+(B&q)>>>0}function wr(B){return 0<=B&&256>B?B:0>B?0:255<B?255:void 0}function mr(B,q){return wr(B+(B-q+.5>>1))}function hr(B,q,le){return Math.abs(q-le)-Math.abs(B-le)}function xr(B,q,le,we,Be,Ze,Re){for(we=Ze[Re-1],le=0;le<Be;++le)Ze[Re+le]=we=Zt(B[q+le],we)}function or(B,q,le,we,Be){var Ze;for(Ze=0;Ze<le;++Ze){var Re=B[q+Ze],nt=Re>>8&255,ht=16711935&(ht=(ht=16711935&Re)+((nt<<16)+nt));we[Be+Ze]=(4278255360&Re)+ht>>>0}}function tt(B,q){q.jd=255&B,q.hd=B>>8&255,q.ud=B>>16&255}function Se(B,q,le,we,Be,Ze){var Re;for(Re=0;Re<we;++Re){var nt=q[le+Re],ht=nt>>>8,bt=nt,Gt=255&(Gt=(Gt=nt>>>16)+((B.jd<<24>>24)*(ht<<24>>24)>>>5));bt=255&(bt=(bt+=(B.hd<<24>>24)*(ht<<24>>24)>>>5)+((B.ud<<24>>24)*(Gt<<24>>24)>>>5)),Be[Ze+Re]=(4278255360&nt)+(Gt<<16)+bt}}function Pe(B,q,le,we,Be){U[q]=function(Ze,Re,nt,ht,bt,Gt,ar,vt,Nt){for(ht=ar;ht<vt;++ht)for(ar=0;ar<Nt;++ar)bt[Gt++]=Be(nt[we(Ze[Re++])])},U[B]=function(Ze,Re,nt,ht,bt,Gt,ar){var vt=8>>Ze.b,Nt=Ze.Ea,tr=Ze.K[0],Tr=Ze.w;if(8>vt)for(Ze=(1<<Ze.b)-1,Tr=(1<<vt)-1;Re<nt;++Re){var sr,Ar=0;for(sr=0;sr<Nt;++sr)sr&Ze||(Ar=we(ht[bt++])),Gt[ar++]=Be(tr[Ar&Tr]),Ar>>=vt}else U["VP8LMapColor"+le](ht,bt,tr,Tr,Gt,ar,Re,nt,Nt)}}function Ve(B,q,le,we,Be){for(le=q+le;q<le;){var Ze=B[q++];we[Be++]=Ze>>16&255,we[Be++]=Ze>>8&255,we[Be++]=255&Ze}}function Qe(B,q,le,we,Be){for(le=q+le;q<le;){var Ze=B[q++];we[Be++]=Ze>>16&255,we[Be++]=Ze>>8&255,we[Be++]=255&Ze,we[Be++]=Ze>>24&255}}function dt(B,q,le,we,Be){for(le=q+le;q<le;){var Ze=(Re=B[q++])>>16&240|Re>>12&15,Re=240&Re|Re>>28&15;we[Be++]=Ze,we[Be++]=Re}}function Pt(B,q,le,we,Be){for(le=q+le;q<le;){var Ze=(Re=B[q++])>>16&248|Re>>13&7,Re=Re>>5&224|Re>>3&31;we[Be++]=Ze,we[Be++]=Re}}function Vt(B,q,le,we,Be){for(le=q+le;q<le;){var Ze=B[q++];we[Be++]=255&Ze,we[Be++]=Ze>>8&255,we[Be++]=Ze>>16&255}}function At(B,q,le,we,Be,Ze){if(Ze==0)for(le=q+le;q<le;)Te(we,((Ze=B[q++])[0]>>24|Ze[1]>>8&65280|Ze[2]<<8&16711680|Ze[3]<<24)>>>0),Be+=32;else n(we,Be,B,q,le)}function qt(B,q){U[q][0]=U[B+"0"],U[q][1]=U[B+"1"],U[q][2]=U[B+"2"],U[q][3]=U[B+"3"],U[q][4]=U[B+"4"],U[q][5]=U[B+"5"],U[q][6]=U[B+"6"],U[q][7]=U[B+"7"],U[q][8]=U[B+"8"],U[q][9]=U[B+"9"],U[q][10]=U[B+"10"],U[q][11]=U[B+"11"],U[q][12]=U[B+"12"],U[q][13]=U[B+"13"],U[q][14]=U[B+"0"],U[q][15]=U[B+"0"]}function er(B){return B==xd||B==wd||B==Cu||B==ku}function fr(){this.eb=[],this.size=this.A=this.fb=0}function Jr(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function $t(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new fr,this.f.kb=new Jr,this.sd=null}function zr(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Sr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Ir(B){return alert("todo:WebPSamplerProcessPlane"),B.T}function Xr(B,q){var le=B.T,we=q.ba.f.RGBA,Be=we.eb,Ze=we.fb+B.ka*we.A,Re=ls[q.ba.S],nt=B.y,ht=B.O,bt=B.f,Gt=B.N,ar=B.ea,vt=B.W,Nt=q.cc,tr=q.dc,Tr=q.Mc,sr=q.Nc,Ar=B.ka,Lr=B.ka+B.T,Zr=B.U,Ur=Zr+1>>1;for(Ar==0?Re(nt,ht,null,null,bt,Gt,ar,vt,bt,Gt,ar,vt,Be,Ze,null,null,Zr):(Re(q.ec,q.fc,nt,ht,Nt,tr,Tr,sr,bt,Gt,ar,vt,Be,Ze-we.A,Be,Ze,Zr),++le);Ar+2<Lr;Ar+=2)Nt=bt,tr=Gt,Tr=ar,sr=vt,Gt+=B.Rc,vt+=B.Rc,Ze+=2*we.A,Re(nt,(ht+=2*B.fa)-B.fa,nt,ht,Nt,tr,Tr,sr,bt,Gt,ar,vt,Be,Ze-we.A,Be,Ze,Zr);return ht+=B.fa,B.j+Lr<B.o?(n(q.ec,q.fc,nt,ht,Zr),n(q.cc,q.dc,bt,Gt,Ur),n(q.Mc,q.Nc,ar,vt,Ur),le--):1&Lr||Re(nt,ht,null,null,bt,Gt,ar,vt,bt,Gt,ar,vt,Be,Ze+we.A,null,null,Zr),le}function qr(B,q,le){var we=B.F,Be=[B.J];if(we!=null){var Ze=B.U,Re=q.ba.S,nt=Re==lh||Re==Cu;q=q.ba.f.RGBA;var ht=[0],bt=B.ka;ht[0]=B.T,B.Kb&&(bt==0?--ht[0]:(--bt,Be[0]-=B.width),B.j+B.ka+B.T==B.o&&(ht[0]=B.o-B.j-bt));var Gt=q.eb;bt=q.fb+bt*q.A,B=Ci(we,Be[0],B.width,Ze,ht,Gt,bt+(nt?0:3),q.A),t(le==ht),B&&er(Re)&&wn(Gt,bt,nt,Ze,ht,q.A)}return 0}function An(B){var q=B.ma,le=q.ba.S,we=11>le,Be=le==bd||le==sh||le==lh||le==Hh||le==12||er(le);if(q.memory=null,q.Ib=null,q.Jb=null,q.Nd=null,!ss(q.Oa,B,Be?11:12))return 0;if(Be&&er(le)&&vc(),B.da)alert("todo:use_scaling");else{if(we){if(q.Ib=Ir,B.Kb){if(le=B.U+1>>1,q.memory=o(B.U+2*le),q.memory==null)return 0;q.ec=q.memory,q.fc=0,q.cc=q.ec,q.dc=q.fc+B.U,q.Mc=q.cc,q.Nc=q.dc+le,q.Ib=Xr,vc()}}else alert("todo:EmitYUV");Be&&(q.Jb=qr,we&&ml())}if(we&&!ap){for(B=0;256>B;++B)im[B]=89858*(B-128)+Ml>>fh,Pd[B]=-22014*(B-128)+Ml,sp[B]=-45773*(B-128),rd[B]=113618*(B-128)+Ml>>fh;for(B=Tc;B<zs;++B)q=76283*(B-16)+Ml>>fh,lp[B-Tc]=ua(q,255),Sl[B-Tc]=ua(q+8>>4,15);ap=1}return 1}function ge(B){var q=B.ma,le=B.U,we=B.T;return t(!(1&B.ka)),0>=le||0>=we?0:(le=q.Ib(B,q),q.Jb!=null&&q.Jb(B,q,le),q.Dc+=le,1)}function ut(B){B.ma.memory=null}function We(B,q,le,we){return pe(B,8)!=47?0:(q[0]=pe(B,14)+1,le[0]=pe(B,14)+1,we[0]=pe(B,1),pe(B,3)!=0?0:!B.h)}function Je(B,q){if(4>B)return B+1;var le=B-2>>1;return(2+(1&B)<<le)+pe(q,le)+1}function xt(B,q){return 120<q?q-120:1<=(le=((le=dh[q-1])>>4)*B+(8-(15&le)))?le:1;var le}function wt(B,q,le){var we=ve(le),Be=B[q+=255&we].g-8;return 0<Be&&(Ce(le,le.u+8),we=ve(le),q+=B[q].value,q+=we&(1<<Be)-1),Ce(le,le.u+B[q].g),B[q].value}function pr(B,q,le){return le.g+=B.g,le.value+=B.value<<q>>>0,t(8>=le.g),B.g}function Rr(B,q,le){var we=B.xc;return t((q=we==0?0:B.vc[B.md*(le>>we)+(q>>we)])<B.Wb),B.Ya[q]}function On(B,q,le,we){var Be=B.ab,Ze=B.c*q,Re=B.C;q=Re+q;var nt=le,ht=we;for(we=B.Ta,le=B.Ua;0<Be--;){var bt=B.gc[Be],Gt=Re,ar=q,vt=nt,Nt=ht,tr=(ht=we,nt=le,bt.Ea);switch(t(Gt<ar),t(ar<=bt.nc),bt.hc){case 2:Gc(vt,Nt,(ar-Gt)*tr,ht,nt);break;case 0:var Tr=Gt,sr=ar,Ar=ht,Lr=nt,Zr=(jn=bt).Ea;Tr==0&&(yl(vt,Nt,null,null,1,Ar,Lr),xr(vt,Nt+1,0,0,Zr-1,Ar,Lr+1),Nt+=Zr,Lr+=Zr,++Tr);for(var Ur=1<<jn.b,zn=Ur-1,Cn=mt(Zr,jn.b),Si=jn.K,jn=jn.w+(Tr>>jn.b)*Cn;Tr<sr;){var Gi=Si,Ro=jn,En=1;for(vl(vt,Nt,Ar,Lr-Zr,1,Ar,Lr);En<Zr;){var kn=(En&~zn)+Ur;kn>Zr&&(kn=Zr),(0,qa[Gi[Ro++]>>8&15])(vt,Nt+ +En,Ar,Lr+En-Zr,kn-En,Ar,Lr+En),En=kn}Nt+=Zr,Lr+=Zr,++Tr&zn||(jn+=Cn)}ar!=bt.nc&&n(ht,nt-tr,ht,nt+(ar-Gt-1)*tr,tr);break;case 1:for(tr=vt,sr=Nt,Zr=(vt=bt.Ea)-(Lr=vt&~(Ar=(Nt=1<<bt.b)-1)),Tr=mt(vt,bt.b),Ur=bt.K,bt=bt.w+(Gt>>bt.b)*Tr;Gt<ar;){for(zn=Ur,Cn=bt,Si=new dr,jn=sr+Lr,Gi=sr+vt;sr<jn;)tt(zn[Cn++],Si),bi(Si,tr,sr,Nt,ht,nt),sr+=Nt,nt+=Nt;sr<Gi&&(tt(zn[Cn++],Si),bi(Si,tr,sr,Zr,ht,nt),sr+=Zr,nt+=Zr),++Gt&Ar||(bt+=Tr)}break;case 3:if(vt==ht&&Nt==nt&&0<bt.b){for(sr=ht,vt=tr=nt+(ar-Gt)*tr-(Lr=(ar-Gt)*mt(bt.Ea,bt.b)),Nt=ht,Ar=nt,Tr=[],Lr=(Zr=Lr)-1;0<=Lr;--Lr)Tr[Lr]=Nt[Ar+Lr];for(Lr=Zr-1;0<=Lr;--Lr)sr[vt+Lr]=Tr[Lr];rc(bt,Gt,ar,ht,tr,ht,nt)}else rc(bt,Gt,ar,vt,Nt,ht,nt)}nt=we,ht=le}ht!=le&&n(we,le,nt,ht,Ze)}function Mn(B,q){var le=B.V,we=B.Ba+B.c*B.C,Be=q-B.C;if(t(q<=B.l.o),t(16>=Be),0<Be){var Ze=B.l,Re=B.Ta,nt=B.Ua,ht=Ze.width;if(On(B,Be,le,we),Be=nt=[nt],t((le=B.C)<(we=q)),t(Ze.v<Ze.va),we>Ze.o&&(we=Ze.o),le<Ze.j){var bt=Ze.j-le;le=Ze.j,Be[0]+=bt*ht}if(le>=we?le=0:(Be[0]+=4*Ze.v,Ze.ka=le-Ze.j,Ze.U=Ze.va-Ze.v,Ze.T=we-le,le=1),le){if(nt=nt[0],11>(le=B.ca).S){var Gt=le.f.RGBA,ar=(we=le.S,Be=Ze.U,Ze=Ze.T,bt=Gt.eb,Gt.A),vt=Ze;for(Gt=Gt.fb+B.Ma*Gt.A;0<vt--;){var Nt=Re,tr=nt,Tr=Be,sr=bt,Ar=Gt;switch(we){case qh:qc(Nt,tr,Tr,sr,Ar);break;case bd:ja(Nt,tr,Tr,sr,Ar);break;case xd:ja(Nt,tr,Tr,sr,Ar),wn(sr,Ar,0,Tr,1,0);break;case uu:Ji(Nt,tr,Tr,sr,Ar);break;case sh:At(Nt,tr,Tr,sr,Ar,1);break;case wd:At(Nt,tr,Tr,sr,Ar,1),wn(sr,Ar,0,Tr,1,0);break;case lh:At(Nt,tr,Tr,sr,Ar,0);break;case Cu:At(Nt,tr,Tr,sr,Ar,0),wn(sr,Ar,1,Tr,1,0);break;case Hh:xl(Nt,tr,Tr,sr,Ar);break;case ku:xl(Nt,tr,Tr,sr,Ar),Yn(sr,Ar,Tr,1,0);break;case tm:So(Nt,tr,Tr,sr,Ar);break;default:t(0)}nt+=ht,Gt+=ar}B.Ma+=Ze}else alert("todo:EmitRescaledRowsYUVA");t(B.Ma<=le.height)}}B.C=q,t(B.C<=B.i)}function _r(B){var q;if(0<B.ua)return 0;for(q=0;q<B.Wb;++q){var le=B.Ya[q].G,we=B.Ya[q].H;if(0<le[1][we[1]+0].g||0<le[2][we[2]+0].g||0<le[3][we[3]+0].g)return 0}return 1}function Or(B,q,le,we,Be,Ze){if(B.Z!=0){var Re=B.qd,nt=B.rd;for(t(Zc[B.Z]!=null);q<le;++q)Zc[B.Z](Re,nt,we,Be,we,Be,Ze),Re=we,nt=Be,Be+=Ze;B.qd=Re,B.rd=nt}}function an(B,q){var le=B.l.ma,we=le.Z==0||le.Z==1?B.l.j:B.C;if(we=B.C<we?we:B.C,t(q<=B.l.o),q>we){var Be=B.l.width,Ze=le.ca,Re=le.tb+Be*we,nt=B.V,ht=B.Ba+B.c*we,bt=B.gc;t(B.ab==1),t(bt[0].hc==3),nc(bt[0],we,q,nt,ht,Ze,Re),Or(le,we,q,Ze,Re,Be)}B.C=B.Ma=q}function Vn(B,q,le,we,Be,Ze,Re){var nt=B.$/we,ht=B.$%we,bt=B.m,Gt=B.s,ar=le+B.$,vt=ar;Be=le+we*Be;var Nt=le+we*Ze,tr=280+Gt.ua,Tr=B.Pb?nt:16777216,sr=0<Gt.ua?Gt.Wa:null,Ar=Gt.wc,Lr=ar<Nt?Rr(Gt,ht,nt):null;t(B.C<Ze),t(Nt<=Be);var Zr=!1;e:for(;;){for(;Zr||ar<Nt;){var Ur=0;if(nt>=Tr){var zn=ar-le;t((Tr=B).Pb),Tr.wd=Tr.m,Tr.xd=zn,0<Tr.s.ua&&Ot(Tr.s.Wa,Tr.s.vb),Tr=nt+ed}if(ht&Ar||(Lr=Rr(Gt,ht,nt)),t(Lr!=null),Lr.Qb&&(q[ar]=Lr.qb,Zr=!0),!Zr)if(Ge(bt),Lr.jc){Ur=bt,zn=q;var Cn=ar,Si=Lr.pd[ve(Ur)&Rs-1];t(Lr.jc),256>Si.g?(Ce(Ur,Ur.u+Si.g),zn[Cn]=Si.value,Ur=0):(Ce(Ur,Ur.u+Si.g-256),t(256<=Si.value),Ur=Si.value),Ur==0&&(Zr=!0)}else Ur=wt(Lr.G[0],Lr.H[0],bt);if(bt.h)break;if(Zr||256>Ur){if(!Zr)if(Lr.nd)q[ar]=(Lr.qb|Ur<<8)>>>0;else{if(Ge(bt),Zr=wt(Lr.G[1],Lr.H[1],bt),Ge(bt),zn=wt(Lr.G[2],Lr.H[2],bt),Cn=wt(Lr.G[3],Lr.H[3],bt),bt.h)break;q[ar]=(Cn<<24|Zr<<16|Ur<<8|zn)>>>0}if(Zr=!1,++ar,++ht>=we&&(ht=0,++nt,Re!=null&&nt<=Ze&&!(nt%16)&&Re(B,nt),sr!=null))for(;vt<ar;)Ur=q[vt++],sr.X[(506832829*Ur&4294967295)>>>sr.Mb]=Ur}else if(280>Ur){if(Ur=Je(Ur-256,bt),zn=wt(Lr.G[4],Lr.H[4],bt),Ge(bt),zn=xt(we,zn=Je(zn,bt)),bt.h)break;if(ar-le<zn||Be-ar<Ur)break e;for(Cn=0;Cn<Ur;++Cn)q[ar+Cn]=q[ar+Cn-zn];for(ar+=Ur,ht+=Ur;ht>=we;)ht-=we,++nt,Re!=null&&nt<=Ze&&!(nt%16)&&Re(B,nt);if(t(ar<=Be),ht&Ar&&(Lr=Rr(Gt,ht,nt)),sr!=null)for(;vt<ar;)Ur=q[vt++],sr.X[(506832829*Ur&4294967295)>>>sr.Mb]=Ur}else{if(!(Ur<tr))break e;for(Zr=Ur-280,t(sr!=null);vt<ar;)Ur=q[vt++],sr.X[(506832829*Ur&4294967295)>>>sr.Mb]=Ur;Ur=ar,t(!(Zr>>>(zn=sr).Xa)),q[Ur]=zn.X[Zr],Zr=!0}Zr||t(bt.h==$e(bt))}if(B.Pb&&bt.h&&ar<Be)t(B.m.h),B.a=5,B.m=B.wd,B.$=B.xd,0<B.s.ua&&Ot(B.s.vb,B.s.Wa);else{if(bt.h)break e;Re!=null&&Re(B,nt>Ze?Ze:nt),B.a=0,B.$=ar-le}return 1}return B.a=3,0}function _o(B){t(B!=null),B.vc=null,B.yc=null,B.Ya=null;var q=B.Wa;q!=null&&(q.X=null),B.vb=null,t(B!=null)}function Uo(){var B=new Ao;return B==null?null:(B.a=0,B.xb=Td,qt("Predictor","VP8LPredictors"),qt("Predictor","VP8LPredictors_C"),qt("PredictorAdd","VP8LPredictorsAdd"),qt("PredictorAdd","VP8LPredictorsAdd_C"),Gc=or,bi=Se,qc=Ve,ja=Qe,xl=dt,So=Pt,Ji=Vt,U.VP8LMapColor32b=Na,U.VP8LMapColor8b=bl,B)}function yn(B,q,le,we,Be){var Ze=1,Re=[B],nt=[q],ht=we.m,bt=we.s,Gt=null,ar=0;e:for(;;){if(le)for(;Ze&&pe(ht,1);){var vt=Re,Nt=nt,tr=we,Tr=1,sr=tr.m,Ar=tr.gc[tr.ab],Lr=pe(sr,2);if(tr.Oc&1<<Lr)Ze=0;else{switch(tr.Oc|=1<<Lr,Ar.hc=Lr,Ar.Ea=vt[0],Ar.nc=Nt[0],Ar.K=[null],++tr.ab,t(4>=tr.ab),Lr){case 0:case 1:Ar.b=pe(sr,3)+2,Tr=yn(mt(Ar.Ea,Ar.b),mt(Ar.nc,Ar.b),0,tr,Ar.K),Ar.K=Ar.K[0];break;case 3:var Zr,Ur=pe(sr,8)+1,zn=16<Ur?0:4<Ur?1:2<Ur?2:3;if(vt[0]=mt(Ar.Ea,zn),Ar.b=zn,Zr=Tr=yn(Ur,1,0,tr,Ar.K)){var Cn,Si=Ur,jn=Ar,Gi=1<<(8>>jn.b),Ro=o(Gi);if(Ro==null)Zr=0;else{var En=jn.K[0],kn=jn.w;for(Ro[0]=jn.K[0][0],Cn=1;Cn<1*Si;++Cn)Ro[Cn]=Zt(En[kn+Cn],Ro[Cn-1]);for(;Cn<4*Gi;++Cn)Ro[Cn]=0;jn.K[0]=null,jn.K[0]=Ro,Zr=1}}Tr=Zr;break;case 2:break;default:t(0)}Ze=Tr}}if(Re=Re[0],nt=nt[0],Ze&&pe(ht,1)&&!(Ze=1<=(ar=pe(ht,4))&&11>=ar)){we.a=3;break e}var mn;if(mn=Ze)t:{var xa,hi,eo,Zo=we,Wo=Re,Ha=nt,on=ar,xn=le,cs=Zo.m,Xo=Zo.s,Fi=[null],wi=1,_a=0,Li=ep[on];r:for(;;){if(xn&&pe(cs,1)){var Ps=pe(cs,3)+2,Bs=mt(Wo,Ps),si=mt(Ha,Ps),no=Bs*si;if(!yn(Bs,si,0,Zo,Fi))break r;for(Fi=Fi[0],Xo.xc=Ps,xa=0;xa<no;++xa){var Io=Fi[xa]>>8&65535;Fi[xa]=Io,Io>=wi&&(wi=Io+1)}}if(cs.h)break r;for(hi=0;5>hi;++hi){var ia=Ju[hi];!hi&&0<on&&(ia+=1<<on),_a<ia&&(_a=ia)}var us=s(wi*Li,ee),Es=wi,Ka=s(Es,de);if(Ka==null)var Za=null;else t(65536>=Es),Za=Ka;var ds=o(_a);if(Za==null||ds==null||us==null){Zo.a=1;break r}var Us=us;for(xa=eo=0;xa<wi;++xa){var mo=Za[xa],Qs=mo.G,jl=mo.H,Ec=0,Ac=1,A=0;for(hi=0;5>hi;++hi){ia=Ju[hi],Qs[hi]=Us,jl[hi]=eo,!hi&&0<on&&(ia+=1<<on);i:{var l,p=ia,b=Zo,S=ds,k=Us,R=eo,W=0,Z=b.m,ie=pe(Z,1);if(i(S,0,0,p),ie){var ce=pe(Z,1)+1,xe=pe(Z,1),be=pe(Z,xe==0?1:8);S[be]=1,ce==2&&(S[be=pe(Z,8)]=1);var Ae=1}else{var Ue=o(19),lt=pe(Z,4)+4;if(19<lt){b.a=3;var it=0;break i}for(l=0;l<lt;++l)Ue[uh[l]]=pe(Z,3);var ft=void 0,gt=void 0,Et=b,Mt=Ue,It=p,jt=S,St=0,Wt=Et.m,ur=8,Jt=s(128,ee);n:for(;X(Jt,0,7,Mt,19);){if(pe(Wt,1)){var nr=2+2*pe(Wt,3);if((ft=2+pe(Wt,nr))>It)break n}else ft=It;for(gt=0;gt<It&&ft--;){Ge(Wt);var cr=Jt[0+(127&ve(Wt))];Ce(Wt,Wt.u+cr.g);var Gr=cr.value;if(16>Gr)jt[gt++]=Gr,Gr!=0&&(ur=Gr);else{var Yr=Gr==16,$r=Gr-16,Tn=rm[$r],mi=pe(Wt,Jf[$r])+Tn;if(gt+mi>It)break n;for(var uo=Yr?ur:0;0<mi--;)jt[gt++]=uo}}St=1;break n}St||(Et.a=3),Ae=St}(Ae=Ae&&!Z.h)&&(W=X(k,R,8,S,p)),Ae&&W!=0?it=W:(b.a=3,it=0)}if(it==0)break r;if(Ac&&ch[hi]==1&&(Ac=Us[eo].g==0),Ec+=Us[eo].g,eo+=it,3>=hi){var go,bo=ds[0];for(go=1;go<ia;++go)ds[go]>bo&&(bo=ds[go]);A+=bo}}if(mo.nd=Ac,mo.Qb=0,Ac&&(mo.qb=(Qs[3][jl[3]+0].value<<24|Qs[1][jl[1]+0].value<<16|Qs[2][jl[2]+0].value)>>>0,Ec==0&&256>Qs[0][jl[0]+0].value&&(mo.Qb=1,mo.qb+=Qs[0][jl[0]+0].value<<8)),mo.jc=!mo.Qb&&6>A,mo.jc){var zo,To=mo;for(zo=0;zo<Rs;++zo){var ei=zo,qi=To.pd[ei],ya=To.G[0][To.H[0]+ei];256<=ya.value?(qi.g=ya.g+256,qi.value=ya.value):(qi.g=0,qi.value=0,ei>>=pr(ya,8,qi),ei>>=pr(To.G[1][To.H[1]+ei],16,qi),ei>>=pr(To.G[2][To.H[2]+ei],0,qi),pr(To.G[3][To.H[3]+ei],24,qi))}}}Xo.vc=Fi,Xo.Wb=wi,Xo.Ya=Za,Xo.yc=us,mn=1;break t}mn=0}if(!(Ze=mn)){we.a=3;break e}if(0<ar){if(bt.ua=1<<ar,!Ne(bt.Wa,ar)){we.a=1,Ze=0;break e}}else bt.ua=0;var Aa=we,Fa=Re,Js=nt,Rl=Aa.s,Yc=Rl.xc;if(Aa.c=Fa,Aa.i=Js,Rl.md=mt(Fa,Yc),Rl.wc=Yc==0?-1:(1<<Yc)-1,le){we.xb=Xh;break e}if((Gt=o(Re*nt))==null){we.a=1,Ze=0;break e}Ze=(Ze=Vn(we,Gt,0,Re,nt,nt,null))&&!ht.h;break e}return Ze?(Be!=null?Be[0]=Gt:(t(Gt==null),t(le)),we.$=0,le||_o(bt)):_o(bt),Ze}function Vo(B,q){var le=B.c*B.i,we=le+q+16*q;return t(B.c<=q),B.V=o(we),B.V==null?(B.Ta=null,B.Ua=0,B.a=1,0):(B.Ta=B.V,B.Ua=B.Ba+le+q,1)}function Po(B,q){var le=B.C,we=q-le,Be=B.V,Ze=B.Ba+B.c*le;for(t(q<=B.l.o);0<we;){var Re=16<we?16:we,nt=B.l.ma,ht=B.l.width,bt=ht*Re,Gt=nt.ca,ar=nt.tb+ht*le,vt=B.Ta,Nt=B.Ua;On(B,Re,Be,Ze),ro(vt,Nt,Gt,ar,bt),Or(nt,le,le+Re,Gt,ar,ht),we-=Re,Be+=Re*B.c,le+=Re}t(le==q),B.C=B.Ma=q}function pa(){this.ub=this.yd=this.td=this.Rb=0}function ta(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function ra(){this.Fb=this.Bb=this.Cb=0,this.Zb=o(4),this.Lb=o(4)}function so(){this.Yb=function(){var B=[];return function q(le,we,Be){for(var Ze=Be[we],Re=0;Re<Ze&&(le.push(Be.length>we+1?[]:0),!(Be.length<we+1));Re++)q(le[Re],we+1,Be)}(B,0,[3,11]),B}()}function Xs(){this.jb=o(3),this.Wc=a([4,8],so),this.Xc=a([4,17],so)}function xo(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new o(4),this.od=new o(4)}function Qn(){this.ld=this.La=this.dd=this.tc=0}function is(){this.Na=this.la=0}function la(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function $s(){this.ad=o(384),this.Za=0,this.Ob=o(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function wo(){this.uc=this.M=this.Nb=0,this.wa=Array(new Qn),this.Y=0,this.ya=Array(new $s),this.aa=0,this.l=new ul}function Eo(){this.y=o(16),this.f=o(8),this.ea=o(8)}function Wa(){this.cb=this.a=0,this.sc="",this.m=new K,this.Od=new pa,this.Kc=new ta,this.ed=new xo,this.Qa=new ra,this.Ic=this.$c=this.Aa=0,this.D=new wo,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,K),this.ia=0,this.pb=s(4,la),this.Pa=new Xs,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Eo),this.Hd=0,this.rb=Array(new is),this.sb=0,this.wa=Array(new Qn),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new $s),this.L=this.aa=0,this.gd=a([4,2],Qn),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function ul(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function os(){var B=new Wa;return B!=null&&(B.a=0,B.sc="OK",B.cb=0,B.Xb=0,Sc||(Sc=Zi)),B}function Pr(B,q,le){return B.a==0&&(B.a=q,B.sc=le,B.cb=0),0}function Hr(B,q,le){return 3<=le&&B[q+0]==157&&B[q+1]==1&&B[q+2]==42}function gn(B,q){if(B==null)return 0;if(B.a=0,B.sc="OK",q==null)return Pr(B,2,"null VP8Io passed to VP8GetHeaders()");var le=q.data,we=q.w,Be=q.ha;if(4>Be)return Pr(B,7,"Truncated header.");var Ze=le[we+0]|le[we+1]<<8|le[we+2]<<16,Re=B.Od;if(Re.Rb=!(1&Ze),Re.td=Ze>>1&7,Re.yd=Ze>>4&1,Re.ub=Ze>>5,3<Re.td)return Pr(B,3,"Incorrect keyframe parameters.");if(!Re.yd)return Pr(B,4,"Frame not displayable.");we+=3,Be-=3;var nt=B.Kc;if(Re.Rb){if(7>Be)return Pr(B,7,"cannot parse picture header");if(!Hr(le,we,Be))return Pr(B,3,"Bad code word");nt.c=16383&(le[we+4]<<8|le[we+3]),nt.Td=le[we+4]>>6,nt.i=16383&(le[we+6]<<8|le[we+5]),nt.Ud=le[we+6]>>6,we+=7,Be-=7,B.za=nt.c+15>>4,B.Ub=nt.i+15>>4,q.width=nt.c,q.height=nt.i,q.Da=0,q.j=0,q.v=0,q.va=q.width,q.o=q.height,q.da=0,q.ib=q.width,q.hb=q.height,q.U=q.width,q.T=q.height,i((Ze=B.Pa).jb,0,255,Ze.jb.length),t((Ze=B.Qa)!=null),Ze.Cb=0,Ze.Bb=0,Ze.Fb=1,i(Ze.Zb,0,0,Ze.Zb.length),i(Ze.Lb,0,0,Ze.Lb)}if(Re.ub>Be)return Pr(B,7,"bad partition length");ye(Ze=B.m,le,we,Re.ub),we+=Re.ub,Be-=Re.ub,Re.Rb&&(nt.Ld=Ye(Ze),nt.Kd=Ye(Ze)),nt=B.Qa;var ht,bt=B.Pa;if(t(Ze!=null),t(nt!=null),nt.Cb=Ye(Ze),nt.Cb){if(nt.Bb=Ye(Ze),Ye(Ze)){for(nt.Fb=Ye(Ze),ht=0;4>ht;++ht)nt.Zb[ht]=Ye(Ze)?ue(Ze,7):0;for(ht=0;4>ht;++ht)nt.Lb[ht]=Ye(Ze)?ue(Ze,6):0}if(nt.Bb)for(ht=0;3>ht;++ht)bt.jb[ht]=Ye(Ze)?_e(Ze,8):255}else nt.Bb=0;if(Ze.Ka)return Pr(B,3,"cannot parse segment header");if((nt=B.ed).zd=Ye(Ze),nt.Tb=_e(Ze,6),nt.wb=_e(Ze,3),nt.Pc=Ye(Ze),nt.Pc&&Ye(Ze)){for(bt=0;4>bt;++bt)Ye(Ze)&&(nt.vd[bt]=ue(Ze,6));for(bt=0;4>bt;++bt)Ye(Ze)&&(nt.od[bt]=ue(Ze,6))}if(B.L=nt.Tb==0?0:nt.zd?1:2,Ze.Ka)return Pr(B,3,"cannot parse filter header");var Gt=Be;if(Be=ht=we,we=ht+Gt,nt=Gt,B.Xb=(1<<_e(B.m,2))-1,Gt<3*(bt=B.Xb))le=7;else{for(ht+=3*bt,nt-=3*bt,Gt=0;Gt<bt;++Gt){var ar=le[Be+0]|le[Be+1]<<8|le[Be+2]<<16;ar>nt&&(ar=nt),ye(B.Jc[+Gt],le,ht,ar),ht+=ar,nt-=ar,Be+=3}ye(B.Jc[+bt],le,ht,nt),le=ht<we?0:5}if(le!=0)return Pr(B,le,"cannot parse partitions");for(le=_e(ht=B.m,7),Be=Ye(ht)?ue(ht,4):0,we=Ye(ht)?ue(ht,4):0,nt=Ye(ht)?ue(ht,4):0,bt=Ye(ht)?ue(ht,4):0,ht=Ye(ht)?ue(ht,4):0,Gt=B.Qa,ar=0;4>ar;++ar){if(Gt.Cb){var vt=Gt.Zb[ar];Gt.Fb||(vt+=le)}else{if(0<ar){B.pb[ar]=B.pb[0];continue}vt=le}var Nt=B.pb[ar];Nt.Sc[0]=Md[ua(vt+Be,127)],Nt.Sc[1]=Sd[ua(vt+0,127)],Nt.Eb[0]=2*Md[ua(vt+we,127)],Nt.Eb[1]=101581*Sd[ua(vt+nt,127)]>>16,8>Nt.Eb[1]&&(Nt.Eb[1]=8),Nt.Qc[0]=Md[ua(vt+bt,117)],Nt.Qc[1]=Sd[ua(vt+ht,127)],Nt.lc=vt+ht}if(!Re.Rb)return Pr(B,4,"Not a key frame.");for(Ye(Ze),Re=B.Pa,le=0;4>le;++le){for(Be=0;8>Be;++Be)for(we=0;3>we;++we)for(nt=0;11>nt;++nt)bt=et(Ze,ig[le][Be][we][nt])?_e(Ze,8):hh[le][Be][we][nt],Re.Wc[le][Be].Yb[we][nt]=bt;for(Be=0;17>Be;++Be)Re.Xc[le][Be]=Re.Wc[le][Zh[Be]]}return B.kc=Ye(Ze),B.kc&&(B.Bd=_e(Ze,8)),B.cb=1}function Zi(B,q,le,we,Be,Ze,Re){var nt=q[Be].Yb[le];for(le=0;16>Be;++Be){if(!et(B,nt[le+0]))return Be;for(;!et(B,nt[le+1]);)if(nt=q[++Be].Yb[0],le=0,Be==16)return 16;var ht=q[Be+1].Yb;if(et(B,nt[le+2])){var bt=B,Gt=0;if(et(bt,(vt=nt)[(ar=le)+3]))if(et(bt,vt[ar+6])){for(nt=0,ar=2*(Gt=et(bt,vt[ar+8]))+(vt=et(bt,vt[ar+9+Gt])),Gt=0,vt=Kh[ar];vt[nt];++nt)Gt+=Gt+et(bt,vt[nt]);Gt+=3+(8<<ar)}else et(bt,vt[ar+7])?(Gt=7+2*et(bt,165),Gt+=et(bt,145)):Gt=5+et(bt,159);else Gt=et(bt,vt[ar+4])?3+et(bt,vt[ar+5]):2;nt=ht[2]}else Gt=1,nt=ht[1];ht=Re+nm[Be],0>(bt=B).b&&ot(bt);var ar,vt=bt.b,Nt=(ar=bt.Ca>>1)-(bt.I>>vt)>>31;--bt.b,bt.Ca+=Nt,bt.Ca|=1,bt.I-=(ar+1&Nt)<<vt,Ze[ht]=((Gt^Nt)-Nt)*we[(0<Be)+0]}return 16}function dl(B){var q=B.rb[B.sb-1];q.la=0,q.Na=0,i(B.zc,0,0,B.zc.length),B.ja=0}function ba(B,q,le,we,Be){Be=B[q+le+32*we]+(Be>>3),B[q+le+32*we]=-256&Be?0>Be?0:255:Be}function Ga(B,q,le,we,Be,Ze){ba(B,q,0,le,we+Be),ba(B,q,1,le,we+Ze),ba(B,q,2,le,we-Ze),ba(B,q,3,le,we-Be)}function yo(B){return(20091*B>>16)+B}function Xl(B,q,le,we){var Be,Ze=0,Re=o(16);for(Be=0;4>Be;++Be){var nt=B[q+0]+B[q+8],ht=B[q+0]-B[q+8],bt=(35468*B[q+4]>>16)-yo(B[q+12]),Gt=yo(B[q+4])+(35468*B[q+12]>>16);Re[Ze+0]=nt+Gt,Re[Ze+1]=ht+bt,Re[Ze+2]=ht-bt,Re[Ze+3]=nt-Gt,Ze+=4,q++}for(Be=Ze=0;4>Be;++Be)nt=(B=Re[Ze+0]+4)+Re[Ze+8],ht=B-Re[Ze+8],bt=(35468*Re[Ze+4]>>16)-yo(Re[Ze+12]),ba(le,we,0,0,nt+(Gt=yo(Re[Ze+4])+(35468*Re[Ze+12]>>16))),ba(le,we,1,0,ht+bt),ba(le,we,2,0,ht-bt),ba(le,we,3,0,nt-Gt),Ze++,we+=32}function Dl(B,q,le,we){var Be=B[q+0]+4,Ze=35468*B[q+4]>>16,Re=yo(B[q+4]),nt=35468*B[q+1]>>16;Ga(le,we,0,Be+Re,B=yo(B[q+1]),nt),Ga(le,we,1,Be+Ze,B,nt),Ga(le,we,2,Be-Ze,B,nt),Ga(le,we,3,Be-Re,B,nt)}function Uc(B,q,le,we,Be){Xl(B,q,le,we),Be&&Xl(B,q+16,le,we+4)}function Yt(B,q,le,we){na(B,q+0,le,we,1),na(B,q+32,le,we+128,1)}function Ie(B,q,le,we){var Be;for(B=B[q+0]+4,Be=0;4>Be;++Be)for(q=0;4>q;++q)ba(le,we,q,Be,B)}function rt(B,q,le,we){B[q+0]&&$l(B,q+0,le,we),B[q+16]&&$l(B,q+16,le,we+4),B[q+32]&&$l(B,q+32,le,we+128),B[q+48]&&$l(B,q+48,le,we+128+4)}function Tt(B,q,le,we){var Be,Ze=o(16);for(Be=0;4>Be;++Be){var Re=B[q+0+Be]+B[q+12+Be],nt=B[q+4+Be]+B[q+8+Be],ht=B[q+4+Be]-B[q+8+Be],bt=B[q+0+Be]-B[q+12+Be];Ze[0+Be]=Re+nt,Ze[8+Be]=Re-nt,Ze[4+Be]=bt+ht,Ze[12+Be]=bt-ht}for(Be=0;4>Be;++Be)Re=(B=Ze[0+4*Be]+3)+Ze[3+4*Be],nt=Ze[1+4*Be]+Ze[2+4*Be],ht=Ze[1+4*Be]-Ze[2+4*Be],bt=B-Ze[3+4*Be],le[we+0]=Re+nt>>3,le[we+16]=bt+ht>>3,le[we+32]=Re-nt>>3,le[we+48]=bt-ht>>3,we+=64}function Ft(B,q,le){var we,Be=q-32,Ze=Jn,Re=255-B[Be-1];for(we=0;we<le;++we){var nt,ht=Ze,bt=Re+B[q-1];for(nt=0;nt<le;++nt)B[q+nt]=ht[bt+B[Be+nt]];q+=32}}function Dt(B,q){Ft(B,q,4)}function yr(B,q){Ft(B,q,8)}function Vr(B,q){Ft(B,q,16)}function en(B,q){var le;for(le=0;16>le;++le)n(B,q+32*le,B,q-32,16)}function Qr(B,q){var le;for(le=16;0<le;--le)i(B,q,B[q-1],16),q+=32}function Dr(B,q,le){var we;for(we=0;16>we;++we)i(q,le+32*we,B,16)}function Ln(B,q){var le,we=16;for(le=0;16>le;++le)we+=B[q-1+32*le]+B[q+le-32];Dr(we>>5,B,q)}function Ii(B,q){var le,we=8;for(le=0;16>le;++le)we+=B[q-1+32*le];Dr(we>>4,B,q)}function vi(B,q){var le,we=8;for(le=0;16>le;++le)we+=B[q+le-32];Dr(we>>4,B,q)}function Ai(B,q){Dr(128,B,q)}function rn(B,q,le){return B+2*q+le+2>>2}function Xi(B,q){var le,we=q-32;for(we=new Uint8Array([rn(B[we-1],B[we+0],B[we+1]),rn(B[we+0],B[we+1],B[we+2]),rn(B[we+1],B[we+2],B[we+3]),rn(B[we+2],B[we+3],B[we+4])]),le=0;4>le;++le)n(B,q+32*le,we,0,we.length)}function Oi(B,q){var le=B[q-1],we=B[q-1+32],Be=B[q-1+64],Ze=B[q-1+96];Te(B,q+0,16843009*rn(B[q-1-32],le,we)),Te(B,q+32,16843009*rn(le,we,Be)),Te(B,q+64,16843009*rn(we,Be,Ze)),Te(B,q+96,16843009*rn(Be,Ze,Ze))}function ri(B,q){var le,we=4;for(le=0;4>le;++le)we+=B[q+le-32]+B[q-1+32*le];for(we>>=3,le=0;4>le;++le)i(B,q+32*le,we,4)}function ma(B,q){var le=B[q-1+0],we=B[q-1+32],Be=B[q-1+64],Ze=B[q-1-32],Re=B[q+0-32],nt=B[q+1-32],ht=B[q+2-32],bt=B[q+3-32];B[q+0+96]=rn(we,Be,B[q-1+96]),B[q+1+96]=B[q+0+64]=rn(le,we,Be),B[q+2+96]=B[q+1+64]=B[q+0+32]=rn(Ze,le,we),B[q+3+96]=B[q+2+64]=B[q+1+32]=B[q+0+0]=rn(Re,Ze,le),B[q+3+64]=B[q+2+32]=B[q+1+0]=rn(nt,Re,Ze),B[q+3+32]=B[q+2+0]=rn(ht,nt,Re),B[q+3+0]=rn(bt,ht,nt)}function Ri(B,q){var le=B[q+1-32],we=B[q+2-32],Be=B[q+3-32],Ze=B[q+4-32],Re=B[q+5-32],nt=B[q+6-32],ht=B[q+7-32];B[q+0+0]=rn(B[q+0-32],le,we),B[q+1+0]=B[q+0+32]=rn(le,we,Be),B[q+2+0]=B[q+1+32]=B[q+0+64]=rn(we,Be,Ze),B[q+3+0]=B[q+2+32]=B[q+1+64]=B[q+0+96]=rn(Be,Ze,Re),B[q+3+32]=B[q+2+64]=B[q+1+96]=rn(Ze,Re,nt),B[q+3+64]=B[q+2+96]=rn(Re,nt,ht),B[q+3+96]=rn(nt,ht,ht)}function lo(B,q){var le=B[q-1+0],we=B[q-1+32],Be=B[q-1+64],Ze=B[q-1-32],Re=B[q+0-32],nt=B[q+1-32],ht=B[q+2-32],bt=B[q+3-32];B[q+0+0]=B[q+1+64]=Ze+Re+1>>1,B[q+1+0]=B[q+2+64]=Re+nt+1>>1,B[q+2+0]=B[q+3+64]=nt+ht+1>>1,B[q+3+0]=ht+bt+1>>1,B[q+0+96]=rn(Be,we,le),B[q+0+64]=rn(we,le,Ze),B[q+0+32]=B[q+1+96]=rn(le,Ze,Re),B[q+1+32]=B[q+2+96]=rn(Ze,Re,nt),B[q+2+32]=B[q+3+96]=rn(Re,nt,ht),B[q+3+32]=rn(nt,ht,bt)}function Mi(B,q){var le=B[q+0-32],we=B[q+1-32],Be=B[q+2-32],Ze=B[q+3-32],Re=B[q+4-32],nt=B[q+5-32],ht=B[q+6-32],bt=B[q+7-32];B[q+0+0]=le+we+1>>1,B[q+1+0]=B[q+0+64]=we+Be+1>>1,B[q+2+0]=B[q+1+64]=Be+Ze+1>>1,B[q+3+0]=B[q+2+64]=Ze+Re+1>>1,B[q+0+32]=rn(le,we,Be),B[q+1+32]=B[q+0+96]=rn(we,Be,Ze),B[q+2+32]=B[q+1+96]=rn(Be,Ze,Re),B[q+3+32]=B[q+2+96]=rn(Ze,Re,nt),B[q+3+64]=rn(Re,nt,ht),B[q+3+96]=rn(nt,ht,bt)}function di(B,q){var le=B[q-1+0],we=B[q-1+32],Be=B[q-1+64],Ze=B[q-1+96];B[q+0+0]=le+we+1>>1,B[q+2+0]=B[q+0+32]=we+Be+1>>1,B[q+2+32]=B[q+0+64]=Be+Ze+1>>1,B[q+1+0]=rn(le,we,Be),B[q+3+0]=B[q+1+32]=rn(we,Be,Ze),B[q+3+32]=B[q+1+64]=rn(Be,Ze,Ze),B[q+3+64]=B[q+2+64]=B[q+0+96]=B[q+1+96]=B[q+2+96]=B[q+3+96]=Ze}function Ho(B,q){var le=B[q-1+0],we=B[q-1+32],Be=B[q-1+64],Ze=B[q-1+96],Re=B[q-1-32],nt=B[q+0-32],ht=B[q+1-32],bt=B[q+2-32];B[q+0+0]=B[q+2+32]=le+Re+1>>1,B[q+0+32]=B[q+2+64]=we+le+1>>1,B[q+0+64]=B[q+2+96]=Be+we+1>>1,B[q+0+96]=Ze+Be+1>>1,B[q+3+0]=rn(nt,ht,bt),B[q+2+0]=rn(Re,nt,ht),B[q+1+0]=B[q+3+32]=rn(le,Re,nt),B[q+1+32]=B[q+3+64]=rn(we,le,Re),B[q+1+64]=B[q+3+96]=rn(Be,we,le),B[q+1+96]=rn(Ze,Be,we)}function bn(B,q){var le;for(le=0;8>le;++le)n(B,q+32*le,B,q-32,8)}function Nn(B,q){var le;for(le=0;8>le;++le)i(B,q,B[q-1],8),q+=32}function Mo(B,q,le){var we;for(we=0;8>we;++we)i(q,le+32*we,B,8)}function ni(B,q){var le,we=8;for(le=0;8>le;++le)we+=B[q+le-32]+B[q-1+32*le];Mo(we>>4,B,q)}function Yi(B,q){var le,we=4;for(le=0;8>le;++le)we+=B[q+le-32];Mo(we>>3,B,q)}function Qi(B,q){var le,we=4;for(le=0;8>le;++le)we+=B[q-1+32*le];Mo(we>>3,B,q)}function co(B,q){Mo(128,B,q)}function po(B,q,le){var we=B[q-le],Be=B[q+0],Ze=3*(Be-we)+Gh[1020+B[q-2*le]-B[q+le]],Re=vd[112+(Ze+4>>3)];B[q-le]=Jn[255+we+vd[112+(Ze+3>>3)]],B[q+0]=Jn[255+Be-Re]}function ga(B,q,le,we){var Be=B[q+0],Ze=B[q+le];return Fs[255+B[q-2*le]-B[q-le]]>we||Fs[255+Ze-Be]>we}function ws(B,q,le,we){return 4*Fs[255+B[q-le]-B[q+0]]+Fs[255+B[q-2*le]-B[q+le]]<=we}function hl(B,q,le,we,Be){var Ze=B[q-3*le],Re=B[q-2*le],nt=B[q-le],ht=B[q+0],bt=B[q+le],Gt=B[q+2*le],ar=B[q+3*le];return 4*Fs[255+nt-ht]+Fs[255+Re-bt]>we?0:Fs[255+B[q-4*le]-Ze]<=Be&&Fs[255+Ze-Re]<=Be&&Fs[255+Re-nt]<=Be&&Fs[255+ar-Gt]<=Be&&Fs[255+Gt-bt]<=Be&&Fs[255+bt-ht]<=Be}function fl(B,q,le,we){var Be=2*we+1;for(we=0;16>we;++we)ws(B,q+we,le,Be)&&po(B,q+we,le)}function Yl(B,q,le,we){var Be=2*we+1;for(we=0;16>we;++we)ws(B,q+we*le,1,Be)&&po(B,q+we*le,1)}function _c(B,q,le,we){var Be;for(Be=3;0<Be;--Be)fl(B,q+=4*le,le,we)}function Ms(B,q,le,we){var Be;for(Be=3;0<Be;--Be)Yl(B,q+=4,le,we)}function vo(B,q,le,we,Be,Ze,Re,nt){for(Ze=2*Ze+1;0<Be--;){if(hl(B,q,le,Ze,Re))if(ga(B,q,le,nt))po(B,q,le);else{var ht=B,bt=q,Gt=le,ar=ht[bt-2*Gt],vt=ht[bt-Gt],Nt=ht[bt+0],tr=ht[bt+Gt],Tr=ht[bt+2*Gt],sr=27*(Lr=Gh[1020+3*(Nt-vt)+Gh[1020+ar-tr]])+63>>7,Ar=18*Lr+63>>7,Lr=9*Lr+63>>7;ht[bt-3*Gt]=Jn[255+ht[bt-3*Gt]+Lr],ht[bt-2*Gt]=Jn[255+ar+Ar],ht[bt-Gt]=Jn[255+vt+sr],ht[bt+0]=Jn[255+Nt-sr],ht[bt+Gt]=Jn[255+tr-Ar],ht[bt+2*Gt]=Jn[255+Tr-Lr]}q+=we}}function Ss(B,q,le,we,Be,Ze,Re,nt){for(Ze=2*Ze+1;0<Be--;){if(hl(B,q,le,Ze,Re))if(ga(B,q,le,nt))po(B,q,le);else{var ht=B,bt=q,Gt=le,ar=ht[bt-Gt],vt=ht[bt+0],Nt=ht[bt+Gt],tr=vd[112+(4+(Tr=3*(vt-ar))>>3)],Tr=vd[112+(Tr+3>>3)],sr=tr+1>>1;ht[bt-2*Gt]=Jn[255+ht[bt-2*Gt]+sr],ht[bt-Gt]=Jn[255+ar+Tr],ht[bt+0]=Jn[255+vt-tr],ht[bt+Gt]=Jn[255+Nt-sr]}q+=we}}function re(B,q,le,we,Be,Ze){vo(B,q,le,1,16,we,Be,Ze)}function ze(B,q,le,we,Be,Ze){vo(B,q,1,le,16,we,Be,Ze)}function pt(B,q,le,we,Be,Ze){var Re;for(Re=3;0<Re;--Re)Ss(B,q+=4*le,le,1,16,we,Be,Ze)}function Ut(B,q,le,we,Be,Ze){var Re;for(Re=3;0<Re;--Re)Ss(B,q+=4,1,le,16,we,Be,Ze)}function Qt(B,q,le,we,Be,Ze,Re,nt){vo(B,q,Be,1,8,Ze,Re,nt),vo(le,we,Be,1,8,Ze,Re,nt)}function Er(B,q,le,we,Be,Ze,Re,nt){vo(B,q,1,Be,8,Ze,Re,nt),vo(le,we,1,Be,8,Ze,Re,nt)}function jr(B,q,le,we,Be,Ze,Re,nt){Ss(B,q+4*Be,Be,1,8,Ze,Re,nt),Ss(le,we+4*Be,Be,1,8,Ze,Re,nt)}function Sn(B,q,le,we,Be,Ze,Re,nt){Ss(B,q+4,1,Be,8,Ze,Re,nt),Ss(le,we+4,1,Be,8,Ze,Re,nt)}function vn(){this.ba=new $t,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Sr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Zn(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Xn(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Ui(){this.ua=0,this.Wa=new Lt,this.vb=new Lt,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new de,this.yc=new ee}function Ao(){this.xb=this.a=0,this.l=new ul,this.ca=new $t,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new te,this.Pb=0,this.wd=new te,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Ui,this.ab=0,this.gc=s(4,Xn),this.Oc=0}function Ko(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new ul,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function pi(B,q,le,we,Be,Ze,Re){for(B=B==null?0:B[q+0],q=0;q<Re;++q)Be[Ze+q]=B+le[we+q]&255,B=Be[Ze+q]}function ca(B,q,le,we,Be,Ze,Re){var nt;if(B==null)pi(null,null,le,we,Be,Ze,Re);else for(nt=0;nt<Re;++nt)Be[Ze+nt]=B[q+nt]+le[we+nt]&255}function jo(B,q,le,we,Be,Ze,Re){if(B==null)pi(null,null,le,we,Be,Ze,Re);else{var nt,ht=B[q+0],bt=ht,Gt=ht;for(nt=0;nt<Re;++nt)bt=Gt+(ht=B[q+nt])-bt,Gt=le[we+nt]+(-256&bt?0>bt?0:255:bt)&255,bt=ht,Be[Ze+nt]=Gt}}function Oa(B,q,le,we){var Be=q.width,Ze=q.o;if(t(B!=null&&q!=null),0>le||0>=we||le+we>Ze)return null;if(!B.Cc){if(B.ga==null){var Re;if(B.ga=new Ko,(Re=B.ga==null)||(Re=q.width*q.o,t(B.Gb.length==0),B.Gb=o(Re),B.Uc=0,B.Gb==null?Re=0:(B.mb=B.Gb,B.nb=B.Uc,B.rc=null,Re=1),Re=!Re),!Re){Re=B.ga;var nt=B.Fa,ht=B.P,bt=B.qc,Gt=B.mb,ar=B.nb,vt=ht+1,Nt=bt-1,tr=Re.l;if(t(nt!=null&&Gt!=null&&q!=null),Zc[0]=null,Zc[1]=pi,Zc[2]=ca,Zc[3]=jo,Re.ca=Gt,Re.tb=ar,Re.c=q.width,Re.i=q.height,t(0<Re.c&&0<Re.i),1>=bt)q=0;else if(Re.$a=3&nt[ht+0],Re.Z=nt[ht+0]>>2&3,Re.Lc=nt[ht+0]>>4&3,ht=nt[ht+0]>>6&3,0>Re.$a||1<Re.$a||4<=Re.Z||1<Re.Lc||ht)q=0;else if(tr.put=ge,tr.ac=An,tr.bc=ut,tr.ma=Re,tr.width=q.width,tr.height=q.height,tr.Da=q.Da,tr.v=q.v,tr.va=q.va,tr.j=q.j,tr.o=q.o,Re.$a)e:{t(Re.$a==1),q=Uo();t:for(;;){if(q==null){q=0;break e}if(t(Re!=null),Re.mc=q,q.c=Re.c,q.i=Re.i,q.l=Re.l,q.l.ma=Re,q.l.width=Re.c,q.l.height=Re.i,q.a=0,fe(q.m,nt,vt,Nt),!yn(Re.c,Re.i,1,q,null)||(q.ab==1&&q.gc[0].hc==3&&_r(q.s)?(Re.ic=1,nt=q.c*q.i,q.Ta=null,q.Ua=0,q.V=o(nt),q.Ba=0,q.V==null?(q.a=1,q=0):q=1):(Re.ic=0,q=Vo(q,Re.c)),!q))break t;q=1;break e}Re.mc=null,q=0}else q=Nt>=Re.c*Re.i;Re=!q}if(Re)return null;B.ga.Lc!=1?B.Ga=0:we=Ze-le}t(B.ga!=null),t(le+we<=Ze);e:{if(q=(nt=B.ga).c,Ze=nt.l.o,nt.$a==0){if(vt=B.rc,Nt=B.Vc,tr=B.Fa,ht=B.P+1+le*q,bt=B.mb,Gt=B.nb+le*q,t(ht<=B.P+B.qc),nt.Z!=0)for(t(Zc[nt.Z]!=null),Re=0;Re<we;++Re)Zc[nt.Z](vt,Nt,tr,ht,bt,Gt,q),vt=bt,Nt=Gt,Gt+=q,ht+=q;else for(Re=0;Re<we;++Re)n(bt,Gt,tr,ht,q),vt=bt,Nt=Gt,Gt+=q,ht+=q;B.rc=vt,B.Vc=Nt}else{if(t(nt.mc!=null),q=le+we,t((Re=nt.mc)!=null),t(q<=Re.i),Re.C>=q)q=1;else if(nt.ic||ml(),nt.ic){nt=Re.V,vt=Re.Ba,Nt=Re.c;var Tr=Re.i,sr=(tr=1,ht=Re.$/Nt,bt=Re.$%Nt,Gt=Re.m,ar=Re.s,Re.$),Ar=Nt*Tr,Lr=Nt*q,Zr=ar.wc,Ur=sr<Lr?Rr(ar,bt,ht):null;t(sr<=Ar),t(q<=Tr),t(_r(ar));t:for(;;){for(;!Gt.h&&sr<Lr;){if(bt&Zr||(Ur=Rr(ar,bt,ht)),t(Ur!=null),Ge(Gt),256>(Tr=wt(Ur.G[0],Ur.H[0],Gt)))nt[vt+sr]=Tr,++sr,++bt>=Nt&&(bt=0,++ht<=q&&!(ht%16)&&an(Re,ht));else{if(!(280>Tr)){tr=0;break t}Tr=Je(Tr-256,Gt);var zn,Cn=wt(Ur.G[4],Ur.H[4],Gt);if(Ge(Gt),!(sr>=(Cn=xt(Nt,Cn=Je(Cn,Gt)))&&Ar-sr>=Tr)){tr=0;break t}for(zn=0;zn<Tr;++zn)nt[vt+sr+zn]=nt[vt+sr+zn-Cn];for(sr+=Tr,bt+=Tr;bt>=Nt;)bt-=Nt,++ht<=q&&!(ht%16)&&an(Re,ht);sr<Lr&&bt&Zr&&(Ur=Rr(ar,bt,ht))}t(Gt.h==$e(Gt))}an(Re,ht>q?q:ht);break t}!tr||Gt.h&&sr<Ar?(tr=0,Re.a=Gt.h?5:3):Re.$=sr,q=tr}else q=Vn(Re,Re.V,Re.Ba,Re.c,Re.i,q,Po);if(!q){we=0;break e}}le+we>=Ze&&(B.Cc=1),we=1}if(!we)return null;if(B.Cc&&((we=B.ga)!=null&&(we.mc=null),B.ga=null,0<B.Ga))return alert("todo:WebPDequantizeLevels"),null}return B.nb+le*Be}function pl(B,q,le,we,Be,Ze){for(;0<Be--;){var Re,nt=B,ht=q+(le?1:0),bt=B,Gt=q+(le?0:3);for(Re=0;Re<we;++Re){var ar=bt[Gt+4*Re];ar!=255&&(ar*=32897,nt[ht+4*Re+0]=nt[ht+4*Re+0]*ar>>23,nt[ht+4*Re+1]=nt[ht+4*Re+1]*ar>>23,nt[ht+4*Re+2]=nt[ht+4*Re+2]*ar>>23)}q+=Ze}}function yc(B,q,le,we,Be){for(;0<we--;){var Ze;for(Ze=0;Ze<le;++Ze){var Re=B[q+2*Ze+0],nt=15&(bt=B[q+2*Ze+1]),ht=4369*nt,bt=(240&bt|bt>>4)*ht>>16;B[q+2*Ze+0]=(240&Re|Re>>4)*ht>>16&240|(15&Re|Re<<4)*ht>>16>>4&15,B[q+2*Ze+1]=240&bt|nt}q+=Be}}function Wh(B,q,le,we,Be,Ze,Re,nt){var ht,bt,Gt=255;for(bt=0;bt<Be;++bt){for(ht=0;ht<we;++ht){var ar=B[q+ht];Ze[Re+4*ht]=ar,Gt&=ar}q+=le,Re+=nt}return Gt!=255}function su(B,q,le,we,Be){var Ze;for(Ze=0;Ze<Be;++Ze)le[we+Ze]=B[q+Ze]>>8}function ml(){wn=pl,Yn=yc,Ci=Wh,ro=su}function Pa(B,q,le){U[B]=function(we,Be,Ze,Re,nt,ht,bt,Gt,ar,vt,Nt,tr,Tr,sr,Ar,Lr,Zr){var Ur,zn=Zr-1>>1,Cn=nt[ht+0]|bt[Gt+0]<<16,Si=ar[vt+0]|Nt[tr+0]<<16;t(we!=null);var jn=3*Cn+Si+131074>>2;for(q(we[Be+0],255&jn,jn>>16,Tr,sr),Ze!=null&&(jn=3*Si+Cn+131074>>2,q(Ze[Re+0],255&jn,jn>>16,Ar,Lr)),Ur=1;Ur<=zn;++Ur){var Gi=nt[ht+Ur]|bt[Gt+Ur]<<16,Ro=ar[vt+Ur]|Nt[tr+Ur]<<16,En=Cn+Gi+Si+Ro+524296,kn=En+2*(Gi+Si)>>3;jn=kn+Cn>>1,Cn=(En=En+2*(Cn+Ro)>>3)+Gi>>1,q(we[Be+2*Ur-1],255&jn,jn>>16,Tr,sr+(2*Ur-1)*le),q(we[Be+2*Ur-0],255&Cn,Cn>>16,Tr,sr+(2*Ur-0)*le),Ze!=null&&(jn=En+Si>>1,Cn=kn+Ro>>1,q(Ze[Re+2*Ur-1],255&jn,jn>>16,Ar,Lr+(2*Ur-1)*le),q(Ze[Re+2*Ur+0],255&Cn,Cn>>16,Ar,Lr+(2*Ur+0)*le)),Cn=Gi,Si=Ro}1&Zr||(jn=3*Cn+Si+131074>>2,q(we[Be+Zr-1],255&jn,jn>>16,Tr,sr+(Zr-1)*le),Ze!=null&&(jn=3*Si+Cn+131074>>2,q(Ze[Re+Zr-1],255&jn,jn>>16,Ar,Lr+(Zr-1)*le)))}}function vc(){ls[qh]=Yh,ls[bd]=Qh,ls[uu]=du,ls[sh]=Jh,ls[lh]=np,ls[Hh]=ip,ls[tm]=op,ls[xd]=Qh,ls[wd]=Jh,ls[Cu]=np,ls[ku]=ip}function bc(B){return B&~ef?0>B?0:255:B>>td}function La(B,q){return bc((19077*B>>8)+(26149*q>>8)-14234)}function Da(B,q,le){return bc((19077*B>>8)-(6419*q>>8)-(13320*le>>8)+8708)}function gl(B,q){return bc((19077*B>>8)+(33050*q>>8)-17685)}function Ys(B,q,le,we,Be){we[Be+0]=La(B,le),we[Be+1]=Da(B,q,le),we[Be+2]=gl(B,q)}function Ql(B,q,le,we,Be){we[Be+0]=gl(B,q),we[Be+1]=Da(B,q,le),we[Be+2]=La(B,le)}function Yu(B,q,le,we,Be){var Ze=Da(B,q,le);q=Ze<<3&224|gl(B,q)>>3,we[Be+0]=248&La(B,le)|Ze>>5,we[Be+1]=q}function $a(B,q,le,we,Be){var Ze=240&gl(B,q)|15;we[Be+0]=240&La(B,le)|Da(B,q,le)>>4,we[Be+1]=Ze}function Vc(B,q,le,we,Be){we[Be+0]=255,Ys(B,q,le,we,Be+1)}function as(B,q,le,we,Be){Ql(B,q,le,we,Be),we[Be+3]=255}function Wc(B,q,le,we,Be){Ys(B,q,le,we,Be),we[Be+3]=255}function ua(B,q){return 0>B?0:B>q?q:B}function _l(B,q,le){U[B]=function(we,Be,Ze,Re,nt,ht,bt,Gt,ar){for(var vt=Gt+(-2&ar)*le;Gt!=vt;)q(we[Be+0],Ze[Re+0],nt[ht+0],bt,Gt),q(we[Be+1],Ze[Re+0],nt[ht+0],bt,Gt+le),Be+=2,++Re,++ht,Gt+=2*le;1&ar&&q(we[Be+0],Ze[Re+0],nt[ht+0],bt,Gt)}}function xc(B,q,le){return le==0?B==0?q==0?6:5:q==0?4:0:le}function Ns(B,q,le,we,Be){switch(B>>>30){case 3:na(q,le,we,Be,0);break;case 2:wl(q,le,we,Be);break;case 1:$l(q,le,we,Be)}}function Jl(B,q){var le,we,Be=q.M,Ze=q.Nb,Re=B.oc,nt=B.pc+40,ht=B.oc,bt=B.pc+584,Gt=B.oc,ar=B.pc+600;for(le=0;16>le;++le)Re[nt+32*le-1]=129;for(le=0;8>le;++le)ht[bt+32*le-1]=129,Gt[ar+32*le-1]=129;for(0<Be?Re[nt-1-32]=ht[bt-1-32]=Gt[ar-1-32]=129:(i(Re,nt-32-1,127,21),i(ht,bt-32-1,127,9),i(Gt,ar-32-1,127,9)),we=0;we<B.za;++we){var vt=q.ya[q.aa+we];if(0<we){for(le=-1;16>le;++le)n(Re,nt+32*le-4,Re,nt+32*le+12,4);for(le=-1;8>le;++le)n(ht,bt+32*le-4,ht,bt+32*le+4,4),n(Gt,ar+32*le-4,Gt,ar+32*le+4,4)}var Nt=B.Gd,tr=B.Hd+we,Tr=vt.ad,sr=vt.Hc;if(0<Be&&(n(Re,nt-32,Nt[tr].y,0,16),n(ht,bt-32,Nt[tr].f,0,8),n(Gt,ar-32,Nt[tr].ea,0,8)),vt.Za){var Ar=Re,Lr=nt-32+16;for(0<Be&&(we>=B.za-1?i(Ar,Lr,Nt[tr].y[15],4):n(Ar,Lr,Nt[tr+1].y,0,4)),le=0;4>le;le++)Ar[Lr+128+le]=Ar[Lr+256+le]=Ar[Lr+384+le]=Ar[Lr+0+le];for(le=0;16>le;++le,sr<<=2)Ar=Re,Lr=nt+ic[le],Ra[vt.Ob[le]](Ar,Lr),Ns(sr,Tr,16*+le,Ar,Lr)}else if(Ar=xc(we,Be,vt.Ob[0]),ko[Ar](Re,nt),sr!=0)for(le=0;16>le;++le,sr<<=2)Ns(sr,Tr,16*+le,Re,nt+ic[le]);for(le=vt.Gc,Ar=xc(we,Be,vt.Dd),Ea[Ar](ht,bt),Ea[Ar](Gt,ar),sr=Tr,Ar=ht,Lr=bt,255&(vt=0|le)&&(170&vt?lu(sr,256,Ar,Lr):Hc(sr,256,Ar,Lr)),vt=Gt,sr=ar,255&(le>>=8)&&(170&le?lu(Tr,320,vt,sr):Hc(Tr,320,vt,sr)),Be<B.Ub-1&&(n(Nt[tr].y,0,Re,nt+480,16),n(Nt[tr].f,0,ht,bt+224,8),n(Nt[tr].ea,0,Gt,ar+224,8)),le=8*Ze*B.B,Nt=B.sa,tr=B.ta+16*we+16*Ze*B.R,Tr=B.qa,vt=B.ra+8*we+le,sr=B.Ha,Ar=B.Ia+8*we+le,le=0;16>le;++le)n(Nt,tr+le*B.R,Re,nt+32*le,16);for(le=0;8>le;++le)n(Tr,vt+le*B.B,ht,bt+32*le,8),n(sr,Ar+le*B.B,Gt,ar+32*le,8)}}function wc(B,q,le,we,Be,Ze,Re,nt,ht){var bt=[0],Gt=[0],ar=0,vt=ht!=null?ht.kd:0,Nt=ht??new Zn;if(B==null||12>le)return 7;Nt.data=B,Nt.w=q,Nt.ha=le,q=[q],le=[le],Nt.gb=[Nt.gb];e:{var tr=q,Tr=le,sr=Nt.gb;if(t(B!=null),t(Tr!=null),t(sr!=null),sr[0]=0,12<=Tr[0]&&!r(B,tr[0],"RIFF")){if(r(B,tr[0]+8,"WEBP")){sr=3;break e}var Ar=Xe(B,tr[0]+4);if(12>Ar||4294967286<Ar){sr=3;break e}if(vt&&Ar>Tr[0]-8){sr=7;break e}sr[0]=Ar,tr[0]+=12,Tr[0]-=12}sr=0}if(sr!=0)return sr;for(Ar=0<Nt.gb[0],le=le[0];;){e:{var Lr=B;Tr=q,sr=le;var Zr=bt,Ur=Gt,zn=tr=[0];if((jn=ar=[ar])[0]=0,8>sr[0])sr=7;else{if(!r(Lr,Tr[0],"VP8X")){if(Xe(Lr,Tr[0]+4)!=10){sr=3;break e}if(18>sr[0]){sr=7;break e}var Cn=Xe(Lr,Tr[0]+8),Si=1+ke(Lr,Tr[0]+12);if(2147483648<=Si*(Lr=1+ke(Lr,Tr[0]+15))){sr=3;break e}zn!=null&&(zn[0]=Cn),Zr!=null&&(Zr[0]=Si),Ur!=null&&(Ur[0]=Lr),Tr[0]+=18,sr[0]-=18,jn[0]=1}sr=0}}if(ar=ar[0],tr=tr[0],sr!=0)return sr;if(Tr=!!(2&tr),!Ar&&ar)return 3;if(Ze!=null&&(Ze[0]=!!(16&tr)),Re!=null&&(Re[0]=Tr),nt!=null&&(nt[0]=0),Re=bt[0],tr=Gt[0],ar&&Tr&&ht==null){sr=0;break}if(4>le){sr=7;break}if(Ar&&ar||!Ar&&!ar&&!r(B,q[0],"ALPH")){le=[le],Nt.na=[Nt.na],Nt.P=[Nt.P],Nt.Sa=[Nt.Sa];e:{Cn=B,sr=q,Ar=le;var jn=Nt.gb;Zr=Nt.na,Ur=Nt.P,zn=Nt.Sa,Si=22,t(Cn!=null),t(Ar!=null),Lr=sr[0];var Gi=Ar[0];for(t(Zr!=null),t(zn!=null),Zr[0]=null,Ur[0]=null,zn[0]=0;;){if(sr[0]=Lr,Ar[0]=Gi,8>Gi){sr=7;break e}var Ro=Xe(Cn,Lr+4);if(4294967286<Ro){sr=3;break e}var En=8+Ro+1&-2;if(Si+=En,0<jn&&Si>jn){sr=3;break e}if(!r(Cn,Lr,"VP8 ")||!r(Cn,Lr,"VP8L")){sr=0;break e}if(Gi[0]<En){sr=7;break e}r(Cn,Lr,"ALPH")||(Zr[0]=Cn,Ur[0]=Lr+8,zn[0]=Ro),Lr+=En,Gi-=En}}if(le=le[0],Nt.na=Nt.na[0],Nt.P=Nt.P[0],Nt.Sa=Nt.Sa[0],sr!=0)break}le=[le],Nt.Ja=[Nt.Ja],Nt.xa=[Nt.xa];e:if(jn=B,sr=q,Ar=le,Zr=Nt.gb[0],Ur=Nt.Ja,zn=Nt.xa,Cn=sr[0],Lr=!r(jn,Cn,"VP8 "),Si=!r(jn,Cn,"VP8L"),t(jn!=null),t(Ar!=null),t(Ur!=null),t(zn!=null),8>Ar[0])sr=7;else{if(Lr||Si){if(jn=Xe(jn,Cn+4),12<=Zr&&jn>Zr-12){sr=3;break e}if(vt&&jn>Ar[0]-8){sr=7;break e}Ur[0]=jn,sr[0]+=8,Ar[0]-=8,zn[0]=Si}else zn[0]=5<=Ar[0]&&jn[Cn+0]==47&&!(jn[Cn+4]>>5),Ur[0]=Ar[0];sr=0}if(le=le[0],Nt.Ja=Nt.Ja[0],Nt.xa=Nt.xa[0],q=q[0],sr!=0)break;if(4294967286<Nt.Ja)return 3;if(nt==null||Tr||(nt[0]=Nt.xa?2:1),Re=[Re],tr=[tr],Nt.xa){if(5>le){sr=7;break}nt=Re,vt=tr,Tr=Ze,B==null||5>le?B=0:5<=le&&B[q+0]==47&&!(B[q+4]>>5)?(Ar=[0],jn=[0],Zr=[0],fe(Ur=new te,B,q,le),We(Ur,Ar,jn,Zr)?(nt!=null&&(nt[0]=Ar[0]),vt!=null&&(vt[0]=jn[0]),Tr!=null&&(Tr[0]=Zr[0]),B=1):B=0):B=0}else{if(10>le){sr=7;break}nt=tr,B==null||10>le||!Hr(B,q+3,le-3)?B=0:(vt=B[q+0]|B[q+1]<<8|B[q+2]<<16,Tr=16383&(B[q+7]<<8|B[q+6]),B=16383&(B[q+9]<<8|B[q+8]),1&vt||3<(vt>>1&7)||!(vt>>4&1)||vt>>5>=Nt.Ja||!Tr||!B?B=0:(Re&&(Re[0]=Tr),nt&&(nt[0]=B),B=1))}if(!B||(Re=Re[0],tr=tr[0],ar&&(bt[0]!=Re||Gt[0]!=tr)))return 3;ht!=null&&(ht[0]=Nt,ht.offset=q-ht.w,t(4294967286>q-ht.w),t(ht.offset==ht.ha-le));break}return sr==0||sr==7&&ar&&ht==null?(Ze!=null&&(Ze[0]|=Nt.na!=null&&0<Nt.na.length),we!=null&&(we[0]=Re),Be!=null&&(Be[0]=tr),0):sr}function ss(B,q,le){var we=q.width,Be=q.height,Ze=0,Re=0,nt=we,ht=Be;if(q.Da=B!=null&&0<B.Da,q.Da&&(nt=B.cd,ht=B.bd,Ze=B.v,Re=B.j,11>le||(Ze&=-2,Re&=-2),0>Ze||0>Re||0>=nt||0>=ht||Ze+nt>we||Re+ht>Be))return 0;if(q.v=Ze,q.j=Re,q.va=Ze+nt,q.o=Re+ht,q.U=nt,q.T=ht,q.da=B!=null&&0<B.da,q.da){if(!kt(nt,ht,le=[B.ib],Ze=[B.hb]))return 0;q.ib=le[0],q.hb=Ze[0]}return q.ob=B!=null&&B.ob,q.Kb=B==null||!B.Sd,q.da&&(q.ob=q.ib<3*we/4&&q.hb<3*Be/4,q.Kb=0),1}function Ts(B){if(B==null)return 2;if(11>B.S){var q=B.f.RGBA;q.fb+=(B.height-1)*q.A,q.A=-q.A}else q=B.f.kb,B=B.height,q.O+=(B-1)*q.fa,q.fa=-q.fa,q.N+=(B-1>>1)*q.Ab,q.Ab=-q.Ab,q.W+=(B-1>>1)*q.Db,q.Db=-q.Db,q.F!=null&&(q.J+=(B-1)*q.lb,q.lb=-q.lb);return 0}function js(B,q,le,we){if(we==null||0>=B||0>=q)return 2;if(le!=null){if(le.Da){var Be=le.cd,Ze=le.bd,Re=-2&le.v,nt=-2&le.j;if(0>Re||0>nt||0>=Be||0>=Ze||Re+Be>B||nt+Ze>q)return 2;B=Be,q=Ze}if(le.da){if(!kt(B,q,Be=[le.ib],Ze=[le.hb]))return 2;B=Be[0],q=Ze[0]}}we.width=B,we.height=q;e:{var ht=we.width,bt=we.height;if(B=we.S,0>=ht||0>=bt||!(B>=qh&&13>B))B=2;else{if(0>=we.Rd&&we.sd==null){Re=Ze=Be=q=0;var Gt=(nt=ht*om[B])*bt;if(11>B||(Ze=(bt+1)/2*(q=(ht+1)/2),B==12&&(Re=(Be=ht)*bt)),(bt=o(Gt+2*Ze+Re))==null){B=1;break e}we.sd=bt,11>B?((ht=we.f.RGBA).eb=bt,ht.fb=0,ht.A=nt,ht.size=Gt):((ht=we.f.kb).y=bt,ht.O=0,ht.fa=nt,ht.Fd=Gt,ht.f=bt,ht.N=0+Gt,ht.Ab=q,ht.Cd=Ze,ht.ea=bt,ht.W=0+Gt+Ze,ht.Db=q,ht.Ed=Ze,B==12&&(ht.F=bt,ht.J=0+Gt+2*Ze),ht.Tc=Re,ht.lb=Be)}if(q=1,Be=we.S,Ze=we.width,Re=we.height,Be>=qh&&13>Be)if(11>Be)B=we.f.RGBA,q&=(nt=Math.abs(B.A))*(Re-1)+Ze<=B.size,q&=nt>=Ze*om[Be],q&=B.eb!=null;else{B=we.f.kb,nt=(Ze+1)/2,Gt=(Re+1)/2,ht=Math.abs(B.fa),bt=Math.abs(B.Ab);var ar=Math.abs(B.Db),vt=Math.abs(B.lb),Nt=vt*(Re-1)+Ze;q&=ht*(Re-1)+Ze<=B.Fd,q&=bt*(Gt-1)+nt<=B.Cd,q=(q&=ar*(Gt-1)+nt<=B.Ed)&ht>=Ze&bt>=nt&ar>=nt,q&=B.y!=null,q&=B.f!=null,q&=B.ea!=null,Be==12&&(q&=vt>=Ze,q&=Nt<=B.Tc,q&=B.F!=null)}else q=0;B=q?0:2}}return B!=0||le!=null&&le.fd&&(B=Ts(we)),B}var Rs=64,ec=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],tc=24,Mc=32,Co=8,$n=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Kt("Predictor0","PredictorAdd0"),U.Predictor0=function(){return 4278190080},U.Predictor1=function(B){return B},U.Predictor2=function(B,q,le){return q[le+0]},U.Predictor3=function(B,q,le){return q[le+1]},U.Predictor4=function(B,q,le){return q[le-1]},U.Predictor5=function(B,q,le){return Bt(Bt(B,q[le+1]),q[le+0])},U.Predictor6=function(B,q,le){return Bt(B,q[le-1])},U.Predictor7=function(B,q,le){return Bt(B,q[le+0])},U.Predictor8=function(B,q,le){return Bt(q[le-1],q[le+0])},U.Predictor9=function(B,q,le){return Bt(q[le+0],q[le+1])},U.Predictor10=function(B,q,le){return Bt(Bt(B,q[le-1]),Bt(q[le+0],q[le+1]))},U.Predictor11=function(B,q,le){var we=q[le+0];return 0>=hr(we>>24&255,B>>24&255,(q=q[le-1])>>24&255)+hr(we>>16&255,B>>16&255,q>>16&255)+hr(we>>8&255,B>>8&255,q>>8&255)+hr(255&we,255&B,255&q)?we:B},U.Predictor12=function(B,q,le){var we=q[le+0];return(wr((B>>24&255)+(we>>24&255)-((q=q[le-1])>>24&255))<<24|wr((B>>16&255)+(we>>16&255)-(q>>16&255))<<16|wr((B>>8&255)+(we>>8&255)-(q>>8&255))<<8|wr((255&B)+(255&we)-(255&q)))>>>0},U.Predictor13=function(B,q,le){var we=q[le-1];return(mr((B=Bt(B,q[le+0]))>>24&255,we>>24&255)<<24|mr(B>>16&255,we>>16&255)<<16|mr(B>>8&255,we>>8&255)<<8|mr(255&B,255&we))>>>0};var yl=U.PredictorAdd0;U.PredictorAdd1=xr,Kt("Predictor2","PredictorAdd2"),Kt("Predictor3","PredictorAdd3"),Kt("Predictor4","PredictorAdd4"),Kt("Predictor5","PredictorAdd5"),Kt("Predictor6","PredictorAdd6"),Kt("Predictor7","PredictorAdd7"),Kt("Predictor8","PredictorAdd8"),Kt("Predictor9","PredictorAdd9"),Kt("Predictor10","PredictorAdd10"),Kt("Predictor11","PredictorAdd11"),Kt("Predictor12","PredictorAdd12"),Kt("Predictor13","PredictorAdd13");var vl=U.PredictorAdd2;Pe("ColorIndexInverseTransform","MapARGB","32b",function(B){return B>>8&255},function(B){return B}),Pe("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(B){return B},function(B){return B>>8&255});var Gc,rc=U.ColorIndexInverseTransform,Na=U.MapARGB,nc=U.VP8LColorIndexInverseTransformAlpha,bl=U.MapAlpha,qa=U.VP8LPredictorsAdd=[];qa.length=16,(U.VP8LPredictors=[]).length=16,(U.VP8LPredictorsAdd_C=[]).length=16,(U.VP8LPredictors_C=[]).length=16;var bi,qc,ja,xl,So,Ji,Fo,na,wl,lu,$l,Hc,oh,yd,cu,Y,he,Oe,Ke,at,Ht,gr,Wr,cn,wn,Yn,Ci,ro,da=o(511),Nl=o(2041),ah=o(225),Qu=o(767),Kc=0,Gh=Nl,vd=ah,Jn=Qu,Fs=da,qh=0,bd=1,uu=2,sh=3,lh=4,Hh=5,tm=6,xd=7,wd=8,Cu=9,ku=10,Jf=[2,3,7],rm=[3,3,11],Ju=[280,256,256,256,40],ch=[0,1,1,1,0],uh=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],dh=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],ep=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],ed=8,Md=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Sd=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Sc=null,Kh=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],nm=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],tp=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],hh=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],rp=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],ig=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Zh=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],ko=[],Ra=[],Ea=[],Xh=1,Td=2,Zc=[],ls=[];Pa("UpsampleRgbLinePair",Ys,3),Pa("UpsampleBgrLinePair",Ql,3),Pa("UpsampleRgbaLinePair",Wc,4),Pa("UpsampleBgraLinePair",as,4),Pa("UpsampleArgbLinePair",Vc,4),Pa("UpsampleRgba4444LinePair",$a,2),Pa("UpsampleRgb565LinePair",Yu,2);var Yh=U.UpsampleRgbLinePair,du=U.UpsampleBgrLinePair,Qh=U.UpsampleRgbaLinePair,Jh=U.UpsampleBgraLinePair,np=U.UpsampleArgbLinePair,ip=U.UpsampleRgba4444LinePair,op=U.UpsampleRgb565LinePair,fh=16,Ml=1<<fh-1,Tc=-227,zs=482,td=6,ef=(256<<td)-1,ap=0,im=o(256),rd=o(256),sp=o(256),Pd=o(256),lp=o(zs-Tc),Sl=o(zs-Tc);_l("YuvToRgbRow",Ys,3),_l("YuvToBgrRow",Ql,3),_l("YuvToRgbaRow",Wc,4),_l("YuvToBgraRow",as,4),_l("YuvToArgbRow",Vc,4),_l("YuvToRgba4444Row",$a,2),_l("YuvToRgb565Row",Yu,2);var ic=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Xc=[0,2,8],Pc=[8,7,6,4,4,2,2,2,1,1,1,1],Ed=1;this.WebPDecodeRGBA=function(B,q,le,we,Be){var Ze=bd,Re=new vn,nt=new $t;Re.ba=nt,nt.S=Ze,nt.width=[nt.width],nt.height=[nt.height];var ht=nt.width,bt=nt.height,Gt=new zr;if(Gt==null||B==null)var ar=2;else t(Gt!=null),ar=wc(B,q,le,Gt.width,Gt.height,Gt.Pd,Gt.Qd,Gt.format,null);if(ar!=0?ht=0:(ht!=null&&(ht[0]=Gt.width[0]),bt!=null&&(bt[0]=Gt.height[0]),ht=1),ht){nt.width=nt.width[0],nt.height=nt.height[0],we!=null&&(we[0]=nt.width),Be!=null&&(Be[0]=nt.height);e:{if(we=new ul,(Be=new Zn).data=B,Be.w=q,Be.ha=le,Be.kd=1,q=[0],t(Be!=null),((B=wc(Be.data,Be.w,Be.ha,null,null,null,q,null,Be))==0||B==7)&&q[0]&&(B=4),(q=B)==0){if(t(Re!=null),we.data=Be.data,we.w=Be.w+Be.offset,we.ha=Be.ha-Be.offset,we.put=ge,we.ac=An,we.bc=ut,we.ma=Re,Be.xa){if((B=Uo())==null){Re=1;break e}if(function(vt,Nt){var tr=[0],Tr=[0],sr=[0];t:for(;;){if(vt==null)return 0;if(Nt==null)return vt.a=2,0;if(vt.l=Nt,vt.a=0,fe(vt.m,Nt.data,Nt.w,Nt.ha),!We(vt.m,tr,Tr,sr)){vt.a=3;break t}if(vt.xb=Td,Nt.width=tr[0],Nt.height=Tr[0],!yn(tr[0],Tr[0],1,vt,null))break t;return 1}return t(vt.a!=0),0}(B,we)){if(we=(q=js(we.width,we.height,Re.Oa,Re.ba))==0){t:{we=B;r:for(;;){if(we==null){we=0;break t}if(t(we.s.yc!=null),t(we.s.Ya!=null),t(0<we.s.Wb),t((le=we.l)!=null),t((Be=le.ma)!=null),we.xb!=0){if(we.ca=Be.ba,we.tb=Be.tb,t(we.ca!=null),!ss(Be.Oa,le,sh)){we.a=2;break r}if(!Vo(we,le.width)||le.da)break r;if((le.da||er(we.ca.S))&&ml(),11>we.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),we.ca.f.kb.F!=null&&ml()),we.Pb&&0<we.s.ua&&we.s.vb.X==null&&!Ne(we.s.vb,we.s.Wa.Xa)){we.a=1;break r}we.xb=0}if(!Vn(we,we.V,we.Ba,we.c,we.i,le.o,Mn))break r;Be.Dc=we.Ma,we=1;break t}t(we.a!=0),we=0}we=!we}we&&(q=B.a)}else q=B.a}else{if((B=new os)==null){Re=1;break e}if(B.Fa=Be.na,B.P=Be.P,B.qc=Be.Sa,gn(B,we)){if((q=js(we.width,we.height,Re.Oa,Re.ba))==0){if(B.Aa=0,le=Re.Oa,t((Be=B)!=null),le!=null){if(0<(ht=0>(ht=le.Md)?0:100<ht?255:255*ht/100)){for(bt=Gt=0;4>bt;++bt)12>(ar=Be.pb[bt]).lc&&(ar.ia=ht*Pc[0>ar.lc?0:ar.lc]>>3),Gt|=ar.ia;Gt&&(alert("todo:VP8InitRandom"),Be.ia=1)}Be.Ga=le.Id,100<Be.Ga?Be.Ga=100:0>Be.Ga&&(Be.Ga=0)}(function(vt,Nt){if(vt==null)return 0;if(Nt==null)return Pr(vt,2,"NULL VP8Io parameter in VP8Decode().");if(!vt.cb&&!gn(vt,Nt))return 0;if(t(vt.cb),Nt.ac==null||Nt.ac(Nt)){Nt.ob&&(vt.L=0);var tr=Xc[vt.L];if(vt.L==2?(vt.yb=0,vt.zb=0):(vt.yb=Nt.v-tr>>4,vt.zb=Nt.j-tr>>4,0>vt.yb&&(vt.yb=0),0>vt.zb&&(vt.zb=0)),vt.Va=Nt.o+15+tr>>4,vt.Hb=Nt.va+15+tr>>4,vt.Hb>vt.za&&(vt.Hb=vt.za),vt.Va>vt.Ub&&(vt.Va=vt.Ub),0<vt.L){var Tr=vt.ed;for(tr=0;4>tr;++tr){var sr;if(vt.Qa.Cb){var Ar=vt.Qa.Lb[tr];vt.Qa.Fb||(Ar+=Tr.Tb)}else Ar=Tr.Tb;for(sr=0;1>=sr;++sr){var Lr=vt.gd[tr][sr],Zr=Ar;if(Tr.Pc&&(Zr+=Tr.vd[0],sr&&(Zr+=Tr.od[0])),0<(Zr=0>Zr?0:63<Zr?63:Zr)){var Ur=Zr;0<Tr.wb&&(Ur=4<Tr.wb?Ur>>2:Ur>>1)>9-Tr.wb&&(Ur=9-Tr.wb),1>Ur&&(Ur=1),Lr.dd=Ur,Lr.tc=2*Zr+Ur,Lr.ld=40<=Zr?2:15<=Zr?1:0}else Lr.tc=0;Lr.La=sr}}}tr=0}else Pr(vt,6,"Frame setup failed"),tr=vt.a;if(tr=tr==0){if(tr){vt.$c=0,0<vt.Aa||(vt.Ic=Ed);t:{tr=vt.Ic,Tr=4*(Ur=vt.za);var zn=32*Ur,Cn=Ur+1,Si=0<vt.L?Ur*(0<vt.Aa?2:1):0,jn=(vt.Aa==2?2:1)*Ur;if((Lr=Tr+832+(sr=3*(16*tr+Xc[vt.L])/2*zn)+(Ar=vt.Fa!=null&&0<vt.Fa.length?vt.Kc.c*vt.Kc.i:0))!=Lr)tr=0;else{if(Lr>vt.Vb){if(vt.Vb=0,vt.Ec=o(Lr),vt.Fc=0,vt.Ec==null){tr=Pr(vt,1,"no memory during frame initialization.");break t}vt.Vb=Lr}Lr=vt.Ec,Zr=vt.Fc,vt.Ac=Lr,vt.Bc=Zr,Zr+=Tr,vt.Gd=s(zn,Eo),vt.Hd=0,vt.rb=s(Cn+1,is),vt.sb=1,vt.wa=Si?s(Si,Qn):null,vt.Y=0,vt.D.Nb=0,vt.D.wa=vt.wa,vt.D.Y=vt.Y,0<vt.Aa&&(vt.D.Y+=Ur),t(!0),vt.oc=Lr,vt.pc=Zr,Zr+=832,vt.ya=s(jn,$s),vt.aa=0,vt.D.ya=vt.ya,vt.D.aa=vt.aa,vt.Aa==2&&(vt.D.aa+=Ur),vt.R=16*Ur,vt.B=8*Ur,Ur=(zn=Xc[vt.L])*vt.R,zn=zn/2*vt.B,vt.sa=Lr,vt.ta=Zr+Ur,vt.qa=vt.sa,vt.ra=vt.ta+16*tr*vt.R+zn,vt.Ha=vt.qa,vt.Ia=vt.ra+8*tr*vt.B+zn,vt.$c=0,Zr+=sr,vt.mb=Ar?Lr:null,vt.nb=Ar?Zr:null,t(Zr+Ar<=vt.Fc+vt.Vb),dl(vt),i(vt.Ac,vt.Bc,0,Tr),tr=1}}if(tr){if(Nt.ka=0,Nt.y=vt.sa,Nt.O=vt.ta,Nt.f=vt.qa,Nt.N=vt.ra,Nt.ea=vt.Ha,Nt.Vd=vt.Ia,Nt.fa=vt.R,Nt.Rc=vt.B,Nt.F=null,Nt.J=0,!Kc){for(tr=-255;255>=tr;++tr)da[255+tr]=0>tr?-tr:tr;for(tr=-1020;1020>=tr;++tr)Nl[1020+tr]=-128>tr?-128:127<tr?127:tr;for(tr=-112;112>=tr;++tr)ah[112+tr]=-16>tr?-16:15<tr?15:tr;for(tr=-255;510>=tr;++tr)Qu[255+tr]=0>tr?0:255<tr?255:tr;Kc=1}Fo=Tt,na=Uc,lu=Yt,$l=Ie,Hc=rt,wl=Dl,oh=re,yd=ze,cu=Qt,Y=Er,he=pt,Oe=Ut,Ke=jr,at=Sn,Ht=fl,gr=Yl,Wr=_c,cn=Ms,Ra[0]=ri,Ra[1]=Dt,Ra[2]=Xi,Ra[3]=Oi,Ra[4]=ma,Ra[5]=lo,Ra[6]=Ri,Ra[7]=Mi,Ra[8]=Ho,Ra[9]=di,ko[0]=Ln,ko[1]=Vr,ko[2]=en,ko[3]=Qr,ko[4]=Ii,ko[5]=vi,ko[6]=Ai,Ea[0]=ni,Ea[1]=yr,Ea[2]=bn,Ea[3]=Nn,Ea[4]=Qi,Ea[5]=Yi,Ea[6]=co,tr=1}else tr=0}tr&&(tr=function(Gi,Ro){for(Gi.M=0;Gi.M<Gi.Va;++Gi.M){var En,kn=Gi.Jc[Gi.M&Gi.Xb],mn=Gi.m,xa=Gi;for(En=0;En<xa.za;++En){var hi=mn,eo=xa,Zo=eo.Ac,Wo=eo.Bc+4*En,Ha=eo.zc,on=eo.ya[eo.aa+En];if(eo.Qa.Bb?on.$b=et(hi,eo.Pa.jb[0])?2+et(hi,eo.Pa.jb[2]):et(hi,eo.Pa.jb[1]):on.$b=0,eo.kc&&(on.Ad=et(hi,eo.Bd)),on.Za=!et(hi,145)+0,on.Za){var xn=on.Ob,cs=0;for(eo=0;4>eo;++eo){var Xo,Fi=Ha[0+eo];for(Xo=0;4>Xo;++Xo){Fi=rp[Zo[Wo+Xo]][Fi];for(var wi=tp[et(hi,Fi[0])];0<wi;)wi=tp[2*wi+et(hi,Fi[wi])];Fi=-wi,Zo[Wo+Xo]=Fi}n(xn,cs,Zo,Wo,4),cs+=4,Ha[0+eo]=Fi}}else Fi=et(hi,156)?et(hi,128)?1:3:et(hi,163)?2:0,on.Ob[0]=Fi,i(Zo,Wo,Fi,4),i(Ha,0,Fi,4);on.Dd=et(hi,142)?et(hi,114)?et(hi,183)?1:3:2:0}if(xa.m.Ka)return Pr(Gi,7,"Premature end-of-partition0 encountered.");for(;Gi.ja<Gi.za;++Gi.ja){if(xa=kn,hi=(mn=Gi).rb[mn.sb-1],Zo=mn.rb[mn.sb+mn.ja],En=mn.ya[mn.aa+mn.ja],Wo=mn.kc?En.Ad:0)hi.la=Zo.la=0,En.Za||(hi.Na=Zo.Na=0),En.Hc=0,En.Gc=0,En.ia=0;else{var _a,Li;if(hi=Zo,Zo=xa,Wo=mn.Pa.Xc,Ha=mn.ya[mn.aa+mn.ja],on=mn.pb[Ha.$b],eo=Ha.ad,xn=0,cs=mn.rb[mn.sb-1],Fi=Xo=0,i(eo,xn,0,384),Ha.Za)var Ps=0,Bs=Wo[3];else{wi=o(16);var si=hi.Na+cs.Na;if(si=Sc(Zo,Wo[1],si,on.Eb,0,wi,0),hi.Na=cs.Na=(0<si)+0,1<si)Fo(wi,0,eo,xn);else{var no=wi[0]+3>>3;for(wi=0;256>wi;wi+=16)eo[xn+wi]=no}Ps=1,Bs=Wo[0]}var Io=15&hi.la,ia=15&cs.la;for(wi=0;4>wi;++wi){var us=1&ia;for(no=Li=0;4>no;++no)Io=Io>>1|(us=(si=Sc(Zo,Bs,si=us+(1&Io),on.Sc,Ps,eo,xn))>Ps)<<7,Li=Li<<2|(3<si?3:1<si?2:eo[xn+0]!=0),xn+=16;Io>>=4,ia=ia>>1|us<<7,Xo=(Xo<<8|Li)>>>0}for(Bs=Io,Ps=ia>>4,_a=0;4>_a;_a+=2){for(Li=0,Io=hi.la>>4+_a,ia=cs.la>>4+_a,wi=0;2>wi;++wi){for(us=1&ia,no=0;2>no;++no)si=us+(1&Io),Io=Io>>1|(us=0<(si=Sc(Zo,Wo[2],si,on.Qc,0,eo,xn)))<<3,Li=Li<<2|(3<si?3:1<si?2:eo[xn+0]!=0),xn+=16;Io>>=2,ia=ia>>1|us<<5}Fi|=Li<<4*_a,Bs|=Io<<4<<_a,Ps|=(240&ia)<<_a}hi.la=Bs,cs.la=Ps,Ha.Hc=Xo,Ha.Gc=Fi,Ha.ia=43690&Fi?0:on.ia,Wo=!(Xo|Fi)}if(0<mn.L&&(mn.wa[mn.Y+mn.ja]=mn.gd[En.$b][En.Za],mn.wa[mn.Y+mn.ja].La|=!Wo),xa.Ka)return Pr(Gi,7,"Premature end-of-file encountered.")}if(dl(Gi),mn=Ro,xa=1,En=(kn=Gi).D,hi=0<kn.L&&kn.M>=kn.zb&&kn.M<=kn.Va,kn.Aa==0)t:{if(En.M=kn.M,En.uc=hi,Jl(kn,En),xa=1,En=(Li=kn.D).Nb,hi=(Fi=Xc[kn.L])*kn.R,Zo=Fi/2*kn.B,wi=16*En*kn.R,no=8*En*kn.B,Wo=kn.sa,Ha=kn.ta-hi+wi,on=kn.qa,eo=kn.ra-Zo+no,xn=kn.Ha,cs=kn.Ia-Zo+no,ia=(Io=Li.M)==0,Xo=Io>=kn.Va-1,kn.Aa==2&&Jl(kn,Li),Li.uc)for(us=(si=kn).D.M,t(si.D.uc),Li=si.yb;Li<si.Hb;++Li){Ps=Li,Bs=us;var Es=(Ka=(A=si).D).Nb;_a=A.R;var Ka=Ka.wa[Ka.Y+Ps],Za=A.sa,ds=A.ta+16*Es*_a+16*Ps,Us=Ka.dd,mo=Ka.tc;if(mo!=0)if(t(3<=mo),A.L==1)0<Ps&&gr(Za,ds,_a,mo+4),Ka.La&&cn(Za,ds,_a,mo),0<Bs&&Ht(Za,ds,_a,mo+4),Ka.La&&Wr(Za,ds,_a,mo);else{var Qs=A.B,jl=A.qa,Ec=A.ra+8*Es*Qs+8*Ps,Ac=A.Ha,A=A.Ia+8*Es*Qs+8*Ps;Es=Ka.ld,0<Ps&&(yd(Za,ds,_a,mo+4,Us,Es),Y(jl,Ec,Ac,A,Qs,mo+4,Us,Es)),Ka.La&&(Oe(Za,ds,_a,mo,Us,Es),at(jl,Ec,Ac,A,Qs,mo,Us,Es)),0<Bs&&(oh(Za,ds,_a,mo+4,Us,Es),cu(jl,Ec,Ac,A,Qs,mo+4,Us,Es)),Ka.La&&(he(Za,ds,_a,mo,Us,Es),Ke(jl,Ec,Ac,A,Qs,mo,Us,Es))}}if(kn.ia&&alert("todo:DitherRow"),mn.put!=null){if(Li=16*Io,Io=16*(Io+1),ia?(mn.y=kn.sa,mn.O=kn.ta+wi,mn.f=kn.qa,mn.N=kn.ra+no,mn.ea=kn.Ha,mn.W=kn.Ia+no):(Li-=Fi,mn.y=Wo,mn.O=Ha,mn.f=on,mn.N=eo,mn.ea=xn,mn.W=cs),Xo||(Io-=Fi),Io>mn.o&&(Io=mn.o),mn.F=null,mn.J=null,kn.Fa!=null&&0<kn.Fa.length&&Li<Io&&(mn.J=Oa(kn,mn,Li,Io-Li),mn.F=kn.mb,mn.F==null&&mn.F.length==0)){xa=Pr(kn,3,"Could not decode alpha data.");break t}Li<mn.j&&(Fi=mn.j-Li,Li=mn.j,t(!(1&Fi)),mn.O+=kn.R*Fi,mn.N+=kn.B*(Fi>>1),mn.W+=kn.B*(Fi>>1),mn.F!=null&&(mn.J+=mn.width*Fi)),Li<Io&&(mn.O+=mn.v,mn.N+=mn.v>>1,mn.W+=mn.v>>1,mn.F!=null&&(mn.J+=mn.v),mn.ka=Li-mn.j,mn.U=mn.va-mn.v,mn.T=Io-Li,xa=mn.put(mn))}En+1!=kn.Ic||Xo||(n(kn.sa,kn.ta-hi,Wo,Ha+16*kn.R,hi),n(kn.qa,kn.ra-Zo,on,eo+8*kn.B,Zo),n(kn.Ha,kn.Ia-Zo,xn,cs+8*kn.B,Zo))}if(!xa)return Pr(Gi,6,"Output aborted.")}return 1}(vt,Nt)),Nt.bc!=null&&Nt.bc(Nt),tr&=1}return tr?(vt.cb=0,tr):0})(B,we)||(q=B.a)}}else q=B.a}q==0&&Re.Oa!=null&&Re.Oa.fd&&(q=Ts(Re.ba))}Re=q}Ze=Re!=0?null:11>Ze?nt.f.RGBA.eb:nt.f.kb.y}else Ze=null;return Ze};var om=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(U,G){for(var H="",X=0;X<4;X++)H+=String.fromCharCode(U[G++]);return H}function m(U,G){return U[G+0]|U[G+1]<<8}function g(U,G){return(U[G+0]|U[G+1]<<8|U[G+2]<<16)>>>0}function _(U,G){return(U[G+0]|U[G+1]<<8|U[G+2]<<16|U[G+3]<<24)>>>0}new u;var y=[0],M=[0],x=[],E=new u,T=e,P=function(U,G){var H={},X=0,ee=!1,ae=0,de=0;if(H.frames=[],!function(K,te){for(var ve=0;ve<4;ve++)if(K[te+ve]!="RIFF".charCodeAt(ve))return!0;return!1}(U,G)){for(_(U,G+=4),G+=8;G<U.length;){var ye=d(U,G),_e=_(U,G+=4);G+=4;var ue=_e+(1&_e);switch(ye){case"VP8 ":case"VP8L":H.frames[X]===void 0&&(H.frames[X]={}),(pe=H.frames[X]).src_off=ee?de:G-8,pe.src_size=ae+_e+8,X++,ee&&(ee=!1,ae=0,de=0);break;case"VP8X":(pe=H.header={}).feature_flags=U[G];var fe=G+4;pe.canvas_width=1+g(U,fe),fe+=3,pe.canvas_height=1+g(U,fe),fe+=3;break;case"ALPH":ee=!0,ae=ue+8,de=G-8;break;case"ANIM":(pe=H.header).bgcolor=_(U,G),fe=G+4,pe.loop_count=m(U,fe),fe+=2;break;case"ANMF":var De,pe;(pe=H.frames[X]={}).offset_x=2*g(U,G),G+=3,pe.offset_y=2*g(U,G),G+=3,pe.width=1+g(U,G),G+=3,pe.height=1+g(U,G),G+=3,pe.duration=g(U,G),G+=3,De=U[G++],pe.dispose=1&De,pe.blend=De>>1&1}ye!="ANMF"&&(G+=ue)}return H}}(T,0);P.response=T,P.rgbaoutput=!0,P.dataurl=!1;var C=P.header?P.header:null,D=P.frames?P.frames:null;if(C){C.loop_counter=C.loop_count,y=[C.canvas_height],M=[C.canvas_width];for(var L=0;L<D.length&&D[L].blend!=0;L++);}var N=D[0],j=E.WebPDecodeRGBA(T,N.src_off,N.src_size,M,y);N.rgba=j,N.imgwidth=M[0],N.imgheight=y[0];for(var $=0;$<M[0]*y[0]*4;$++)x[$]=j[$];return this.width=M,this.height=y,this.data=x,this}(function(e){var t,r,n,i,o,s,a,u,d,m=function(K){return K=K||{},this.isStrokeTransparent=K.isStrokeTransparent||!1,this.strokeOpacity=K.strokeOpacity||1,this.strokeStyle=K.strokeStyle||"#000000",this.fillStyle=K.fillStyle||"#000000",this.isFillTransparent=K.isFillTransparent||!1,this.fillOpacity=K.fillOpacity||1,this.font=K.font||"10px sans-serif",this.textBaseline=K.textBaseline||"alphabetic",this.textAlign=K.textAlign||"left",this.lineWidth=K.lineWidth||1,this.lineJoin=K.lineJoin||"miter",this.lineCap=K.lineCap||"butt",this.path=K.path||[],this.transform=K.transform!==void 0?K.transform.clone():new u,this.globalCompositeOperation=K.globalCompositeOperation||"normal",this.globalAlpha=K.globalAlpha||1,this.clip_path=K.clip_path||[],this.currentPoint=K.currentPoint||new s,this.miterLimit=K.miterLimit||10,this.lastPoint=K.lastPoint||new s,this.lineDashOffset=K.lineDashOffset||0,this.lineDash=K.lineDash||[],this.margin=K.margin||[0,0,0,0],this.prevPageLastElemOffset=K.prevPageLastElemOffset||0,this.ignoreClearRect=typeof K.ignoreClearRect!="boolean"||K.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new g(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,o=this.internal.getVerticalCoordinate,s=this.internal.Point,a=this.internal.Rectangle,u=this.internal.Matrix,d=new m}]);var g=function(K){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var te=K;Object.defineProperty(this,"pdf",{get:function(){return te}});var ve=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return ve},set:function(Xe){ve=!!Xe}});var $e=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return $e},set:function(Xe){$e=!!Xe}});var Ce=0;Object.defineProperty(this,"posX",{get:function(){return Ce},set:function(Xe){isNaN(Xe)||(Ce=Xe)}});var Ge=0;Object.defineProperty(this,"posY",{get:function(){return Ge},set:function(Xe){isNaN(Xe)||(Ge=Xe)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(Xe){var Ne;typeof Xe=="number"?Ne=[Xe,Xe,Xe,Xe]:((Ne=new Array(4))[0]=Xe[0],Ne[1]=Xe.length>=2?Xe[1]:Ne[0],Ne[2]=Xe.length>=3?Xe[2]:Ne[0],Ne[3]=Xe.length>=4?Xe[3]:Ne[1]),d.margin=Ne}});var ot=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ot},set:function(Xe){ot=Xe}});var Ye=0;Object.defineProperty(this,"lastBreak",{get:function(){return Ye},set:function(Xe){Ye=Xe}});var et=[];Object.defineProperty(this,"pageBreaks",{get:function(){return et},set:function(Xe){et=Xe}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(Xe){Xe instanceof m&&(d=Xe)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(Xe){d.path=Xe}});var Te=[];Object.defineProperty(this,"ctxStack",{get:function(){return Te},set:function(Xe){Te=Xe}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Xe){var Ne;Ne=_(Xe),this.ctx.fillStyle=Ne.style,this.ctx.isFillTransparent=Ne.a===0,this.ctx.fillOpacity=Ne.a,this.pdf.setFillColor(Ne.r,Ne.g,Ne.b,{a:Ne.a}),this.pdf.setTextColor(Ne.r,Ne.g,Ne.b,{a:Ne.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Xe){var Ne=_(Xe);this.ctx.strokeStyle=Ne.style,this.ctx.isStrokeTransparent=Ne.a===0,this.ctx.strokeOpacity=Ne.a,Ne.a===0?this.pdf.setDrawColor(255,255,255):(Ne.a,this.pdf.setDrawColor(Ne.r,Ne.g,Ne.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Xe){["butt","round","square"].indexOf(Xe)!==-1&&(this.ctx.lineCap=Xe,this.pdf.setLineCap(Xe))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Xe){isNaN(Xe)||(this.ctx.lineWidth=Xe,this.pdf.setLineWidth(Xe))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Xe){["bevel","round","miter"].indexOf(Xe)!==-1&&(this.ctx.lineJoin=Xe,this.pdf.setLineJoin(Xe))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Xe){isNaN(Xe)||(this.ctx.miterLimit=Xe,this.pdf.setMiterLimit(Xe))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Xe){this.ctx.textBaseline=Xe}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Xe){["right","end","center","left","start"].indexOf(Xe)!==-1&&(this.ctx.textAlign=Xe)}});var Le=null,ke=null;Object.defineProperty(this,"fontFaces",{get:function(){return ke},set:function(Xe){Le=null,ke=Xe}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Xe){var Ne;if(this.ctx.font=Xe,(Ne=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Xe))!==null){var Ot=Ne[1];Ne[2];var Lt=Ne[3],kt=Ne[4];Ne[5];var mt=Ne[6],Zt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(kt)[2];kt=Math.floor(Zt==="px"?parseFloat(kt)*this.pdf.internal.scaleFactor:Zt==="em"?parseFloat(kt)*this.pdf.getFontSize():parseFloat(kt)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(kt);var Kt=function(Se){var Pe,Ve,Qe=[],dt=Se.trim();if(dt==="")return JO;if(dt in jK)return[jK[dt]];for(;dt!=="";){switch(Ve=null,Pe=(dt=FK(dt)).charAt(0)){case'"':case"'":Ve=ZJe(dt.substring(1),Pe);break;default:Ve=XJe(dt)}if(Ve===null||(Qe.push(Ve[0]),(dt=FK(Ve[1]))!==""&&dt.charAt(0)!==","))return JO;dt=dt.replace(/^,/,"")}return Qe}(mt);if(this.fontFaces){var dr=function(Se,Pe){if(Le===null){var Ve=function(Qe){var dt=[];return Object.keys(Qe).forEach(function(Pt){Qe[Pt].forEach(function(Vt){var At=null;switch(Vt){case"bold":At={family:Pt,weight:"bold"};break;case"italic":At={family:Pt,style:"italic"};break;case"bolditalic":At={family:Pt,weight:"bold",style:"italic"};break;case"":case"normal":At={family:Pt}}At!==null&&(At.ref={name:Pt,style:Vt},dt.push(At))})}),dt}(Se.getFontList());Le=function(Qe){for(var dt={},Pt=0;Pt<Qe.length;++Pt){var Vt=QO(Qe[Pt]),At=Vt.family,qt=Vt.stretch,er=Vt.style,fr=Vt.weight;dt[At]=dt[At]||{},dt[At][qt]=dt[At][qt]||{},dt[At][qt][er]=dt[At][qt][er]||{},dt[At][qt][er][fr]=Vt}return dt}(Ve.concat(Pe))}return Le}(this.pdf,this.fontFaces),Bt=Kt.map(function(Se){return{family:Se,stretch:"normal",weight:Lt,style:Ot}}),wr=function(Se,Pe,Ve){for(var Qe=(Ve=Ve||{}).defaultFontFamily||"times",dt=Object.assign({},KJe,Ve.genericFontFamilies||{}),Pt=null,Vt=null,At=0;At<Pe.length;++At)if(dt[(Pt=QO(Pe[At])).family]&&(Pt.family=dt[Pt.family]),Se.hasOwnProperty(Pt.family)){Vt=Se[Pt.family];break}if(!(Vt=Vt||Se[Qe]))throw new Error("Could not find a font-family for the rule '"+RK(Pt)+"' and default family '"+Qe+"'.");if(Vt=function(qt,er){if(er[qt])return er[qt];var fr=JN[qt],Jr=fr<=JN.normal?-1:1,$t=NK(er,yhe,fr,Jr);if(!$t)throw new Error("Could not find a matching font-stretch value for "+qt);return $t}(Pt.stretch,Vt),Vt=function(qt,er){if(er[qt])return er[qt];for(var fr=_he[qt],Jr=0;Jr<fr.length;++Jr)if(er[fr[Jr]])return er[fr[Jr]];throw new Error("Could not find a matching font-style for "+qt)}(Pt.style,Vt),!(Vt=function(qt,er){if(er[qt])return er[qt];if(qt===400&&er[500])return er[500];if(qt===500&&er[400])return er[400];var fr=HJe[qt],Jr=NK(er,vhe,fr,qt<400?-1:1);if(!Jr)throw new Error("Could not find a matching font-weight for value "+qt);return Jr}(Pt.weight,Vt)))throw new Error("Failed to resolve a font for the rule '"+RK(Pt)+"'.");return Vt}(dr,Bt);this.pdf.setFont(wr.ref.name,wr.ref.style)}else{var mr="";(Lt==="bold"||parseInt(Lt,10)>=700||Ot==="bold")&&(mr="bold"),Ot==="italic"&&(mr+="italic"),mr.length===0&&(mr="normal");for(var hr="",xr={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},or=0;or<Kt.length;or++){if(this.pdf.internal.getFont(Kt[or],mr,{noFallback:!0,disableWarning:!0})!==void 0){hr=Kt[or];break}if(mr==="bolditalic"&&this.pdf.internal.getFont(Kt[or],"bold",{noFallback:!0,disableWarning:!0})!==void 0)hr=Kt[or],mr="bold";else if(this.pdf.internal.getFont(Kt[or],"normal",{noFallback:!0,disableWarning:!0})!==void 0){hr=Kt[or],mr="normal";break}}if(hr===""){for(var tt=0;tt<Kt.length;tt++)if(xr[Kt[tt]]){hr=xr[Kt[tt]];break}}hr=hr===""?"Times":hr,this.pdf.setFont(hr,mr)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Xe){this.ctx.globalCompositeOperation=Xe}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Xe){this.ctx.globalAlpha=Xe}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Xe){this.ctx.lineDashOffset=Xe,pe.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Xe){this.ctx.lineDash=Xe,pe.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Xe){this.ctx.ignoreClearRect=!!Xe}})};g.prototype.setLineDash=function(K){this.lineDash=K},g.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},g.prototype.fill=function(){D.call(this,"fill",!1)},g.prototype.stroke=function(){D.call(this,"stroke",!1)},g.prototype.beginPath=function(){this.path=[{type:"begin"}]},g.prototype.moveTo=function(K,te){if(isNaN(K)||isNaN(te))throw Ba.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var ve=this.ctx.transform.applyToPoint(new s(K,te));this.path.push({type:"mt",x:ve.x,y:ve.y}),this.ctx.lastPoint=new s(K,te)},g.prototype.closePath=function(){var K=new s(0,0),te=0;for(te=this.path.length-1;te!==-1;te--)if(this.path[te].type==="begin"&&Ma(this.path[te+1])==="object"&&typeof this.path[te+1].x=="number"){K=new s(this.path[te+1].x,this.path[te+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(K.x,K.y)},g.prototype.lineTo=function(K,te){if(isNaN(K)||isNaN(te))throw Ba.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var ve=this.ctx.transform.applyToPoint(new s(K,te));this.path.push({type:"lt",x:ve.x,y:ve.y}),this.ctx.lastPoint=new s(ve.x,ve.y)},g.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),D.call(this,null,!0)},g.prototype.quadraticCurveTo=function(K,te,ve,$e){if(isNaN(ve)||isNaN($e)||isNaN(K)||isNaN(te))throw Ba.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Ce=this.ctx.transform.applyToPoint(new s(ve,$e)),Ge=this.ctx.transform.applyToPoint(new s(K,te));this.path.push({type:"qct",x1:Ge.x,y1:Ge.y,x:Ce.x,y:Ce.y}),this.ctx.lastPoint=new s(Ce.x,Ce.y)},g.prototype.bezierCurveTo=function(K,te,ve,$e,Ce,Ge){if(isNaN(Ce)||isNaN(Ge)||isNaN(K)||isNaN(te)||isNaN(ve)||isNaN($e))throw Ba.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ot=this.ctx.transform.applyToPoint(new s(Ce,Ge)),Ye=this.ctx.transform.applyToPoint(new s(K,te)),et=this.ctx.transform.applyToPoint(new s(ve,$e));this.path.push({type:"bct",x1:Ye.x,y1:Ye.y,x2:et.x,y2:et.y,x:ot.x,y:ot.y}),this.ctx.lastPoint=new s(ot.x,ot.y)},g.prototype.arc=function(K,te,ve,$e,Ce,Ge){if(isNaN(K)||isNaN(te)||isNaN(ve)||isNaN($e)||isNaN(Ce))throw Ba.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(Ge=!!Ge,!this.ctx.transform.isIdentity){var ot=this.ctx.transform.applyToPoint(new s(K,te));K=ot.x,te=ot.y;var Ye=this.ctx.transform.applyToPoint(new s(0,ve)),et=this.ctx.transform.applyToPoint(new s(0,0));ve=Math.sqrt(Math.pow(Ye.x-et.x,2)+Math.pow(Ye.y-et.y,2))}Math.abs(Ce-$e)>=2*Math.PI&&($e=0,Ce=2*Math.PI),this.path.push({type:"arc",x:K,y:te,radius:ve,startAngle:$e,endAngle:Ce,counterclockwise:Ge})},g.prototype.arcTo=function(K,te,ve,$e,Ce){throw new Error("arcTo not implemented.")},g.prototype.rect=function(K,te,ve,$e){if(isNaN(K)||isNaN(te)||isNaN(ve)||isNaN($e))throw Ba.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(K,te),this.lineTo(K+ve,te),this.lineTo(K+ve,te+$e),this.lineTo(K,te+$e),this.lineTo(K,te),this.lineTo(K+ve,te),this.lineTo(K,te)},g.prototype.fillRect=function(K,te,ve,$e){if(isNaN(K)||isNaN(te)||isNaN(ve)||isNaN($e))throw Ba.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!y.call(this)){var Ce={};this.lineCap!=="butt"&&(Ce.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Ce.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(K,te,ve,$e),this.fill(),Ce.hasOwnProperty("lineCap")&&(this.lineCap=Ce.lineCap),Ce.hasOwnProperty("lineJoin")&&(this.lineJoin=Ce.lineJoin)}},g.prototype.strokeRect=function(K,te,ve,$e){if(isNaN(K)||isNaN(te)||isNaN(ve)||isNaN($e))throw Ba.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");M.call(this)||(this.beginPath(),this.rect(K,te,ve,$e),this.stroke())},g.prototype.clearRect=function(K,te,ve,$e){if(isNaN(K)||isNaN(te)||isNaN(ve)||isNaN($e))throw Ba.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(K,te,ve,$e))},g.prototype.save=function(K){K=typeof K!="boolean"||K;for(var te=this.pdf.internal.getCurrentPageInfo().pageNumber,ve=0;ve<this.pdf.internal.getNumberOfPages();ve++)this.pdf.setPage(ve+1),this.pdf.internal.out("q");if(this.pdf.setPage(te),K){this.ctx.fontSize=this.pdf.internal.getFontSize();var $e=new m(this.ctx);this.ctxStack.push(this.ctx),this.ctx=$e}},g.prototype.restore=function(K){K=typeof K!="boolean"||K;for(var te=this.pdf.internal.getCurrentPageInfo().pageNumber,ve=0;ve<this.pdf.internal.getNumberOfPages();ve++)this.pdf.setPage(ve+1),this.pdf.internal.out("Q");this.pdf.setPage(te),K&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},g.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var _=function(K){var te,ve,$e,Ce;if(K.isCanvasGradient===!0&&(K=K.getColor()),!K)return{r:0,g:0,b:0,a:0,style:K};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(K))te=0,ve=0,$e=0,Ce=0;else{var Ge=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(K);if(Ge!==null)te=parseInt(Ge[1]),ve=parseInt(Ge[2]),$e=parseInt(Ge[3]),Ce=1;else if((Ge=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(K))!==null)te=parseInt(Ge[1]),ve=parseInt(Ge[2]),$e=parseInt(Ge[3]),Ce=parseFloat(Ge[4]);else{if(Ce=1,typeof K=="string"&&K.charAt(0)!=="#"){var ot=new uhe(K);K=ot.ok?ot.toHex():"#000000"}K.length===4?(te=K.substring(1,2),te+=te,ve=K.substring(2,3),ve+=ve,$e=K.substring(3,4),$e+=$e):(te=K.substring(1,3),ve=K.substring(3,5),$e=K.substring(5,7)),te=parseInt(te,16),ve=parseInt(ve,16),$e=parseInt($e,16)}}return{r:te,g:ve,b:$e,a:Ce,style:K}},y=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},M=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};g.prototype.fillText=function(K,te,ve,$e){if(isNaN(te)||isNaN(ve)||typeof K!="string")throw Ba.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if($e=isNaN($e)?void 0:$e,!y.call(this)){var Ce=ue(this.ctx.transform.rotation),Ge=this.ctx.transform.scaleX;X.call(this,{text:K,x:te,y:ve,scale:Ge,angle:Ce,align:this.textAlign,maxWidth:$e})}},g.prototype.strokeText=function(K,te,ve,$e){if(isNaN(te)||isNaN(ve)||typeof K!="string")throw Ba.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!M.call(this)){$e=isNaN($e)?void 0:$e;var Ce=ue(this.ctx.transform.rotation),Ge=this.ctx.transform.scaleX;X.call(this,{text:K,x:te,y:ve,scale:Ge,renderingMode:"stroke",angle:Ce,align:this.textAlign,maxWidth:$e})}},g.prototype.measureText=function(K){if(typeof K!="string")throw Ba.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var te=this.pdf,ve=this.pdf.internal.scaleFactor,$e=te.internal.getFontSize(),Ce=te.getStringUnitWidth(K)*$e/te.internal.scaleFactor;return new function(Ge){var ot=(Ge=Ge||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ot}}),this}({width:Ce*=Math.round(96*ve/72*1e4)/1e4})},g.prototype.scale=function(K,te){if(isNaN(K)||isNaN(te))throw Ba.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var ve=new u(K,0,0,te,0,0);this.ctx.transform=this.ctx.transform.multiply(ve)},g.prototype.rotate=function(K){if(isNaN(K))throw Ba.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var te=new u(Math.cos(K),Math.sin(K),-Math.sin(K),Math.cos(K),0,0);this.ctx.transform=this.ctx.transform.multiply(te)},g.prototype.translate=function(K,te){if(isNaN(K)||isNaN(te))throw Ba.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var ve=new u(1,0,0,1,K,te);this.ctx.transform=this.ctx.transform.multiply(ve)},g.prototype.transform=function(K,te,ve,$e,Ce,Ge){if(isNaN(K)||isNaN(te)||isNaN(ve)||isNaN($e)||isNaN(Ce)||isNaN(Ge))throw Ba.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ot=new u(K,te,ve,$e,Ce,Ge);this.ctx.transform=this.ctx.transform.multiply(ot)},g.prototype.setTransform=function(K,te,ve,$e,Ce,Ge){K=isNaN(K)?1:K,te=isNaN(te)?0:te,ve=isNaN(ve)?0:ve,$e=isNaN($e)?1:$e,Ce=isNaN(Ce)?0:Ce,Ge=isNaN(Ge)?0:Ge,this.ctx.transform=new u(K,te,ve,$e,Ce,Ge)};var x=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};g.prototype.drawImage=function(K,te,ve,$e,Ce,Ge,ot,Ye,et){var Te=this.pdf.getImageProperties(K),Le=1,ke=1,Xe=1,Ne=1;$e!==void 0&&Ye!==void 0&&(Xe=Ye/$e,Ne=et/Ce,Le=Te.width/$e*Ye/$e,ke=Te.height/Ce*et/Ce),Ge===void 0&&(Ge=te,ot=ve,te=0,ve=0),$e!==void 0&&Ye===void 0&&(Ye=$e,et=Ce),$e===void 0&&Ye===void 0&&(Ye=Te.width,et=Te.height);for(var Ot,Lt=this.ctx.transform.decompose(),kt=ue(Lt.rotate.shx),mt=new u,Zt=(mt=(mt=(mt=mt.multiply(Lt.translate)).multiply(Lt.skew)).multiply(Lt.scale)).applyToRectangle(new a(Ge-te*Xe,ot-ve*Ne,$e*Le,Ce*ke)),Kt=E.call(this,Zt),dr=[],Bt=0;Bt<Kt.length;Bt+=1)dr.indexOf(Kt[Bt])===-1&&dr.push(Kt[Bt]);if(C(dr),this.autoPaging)for(var wr=dr[0],mr=dr[dr.length-1],hr=wr;hr<mr+1;hr++){this.pdf.setPage(hr);var xr=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],or=hr===1?this.posY+this.margin[0]:this.margin[0],tt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Se=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Pe=hr===1?0:tt+(hr-2)*Se;if(this.ctx.clip_path.length!==0){var Ve=this.path;Ot=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=P(Ot,this.posX+this.margin[3],-Pe+or+this.ctx.prevPageLastElemOffset),L.call(this,"fill",!0),this.path=Ve}var Qe=JSON.parse(JSON.stringify(Zt));Qe=P([Qe],this.posX+this.margin[3],-Pe+or+this.ctx.prevPageLastElemOffset)[0];var dt=(hr>wr||hr<mr)&&x.call(this);dt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],xr,Se,null).clip().discardPath()),this.pdf.addImage(K,"JPEG",Qe.x,Qe.y,Qe.w,Qe.h,null,null,kt),dt&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(K,"JPEG",Zt.x,Zt.y,Zt.w,Zt.h,null,null,kt)};var E=function(K,te,ve){var $e=[];te=te||this.pdf.internal.pageSize.width,ve=ve||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Ce=this.posY+this.ctx.prevPageLastElemOffset;switch(K.type){default:case"mt":case"lt":$e.push(Math.floor((K.y+Ce)/ve)+1);break;case"arc":$e.push(Math.floor((K.y+Ce-K.radius)/ve)+1),$e.push(Math.floor((K.y+Ce+K.radius)/ve)+1);break;case"qct":var Ge=fe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,K.x1,K.y1,K.x,K.y);$e.push(Math.floor((Ge.y+Ce)/ve)+1),$e.push(Math.floor((Ge.y+Ge.h+Ce)/ve)+1);break;case"bct":var ot=De(this.ctx.lastPoint.x,this.ctx.lastPoint.y,K.x1,K.y1,K.x2,K.y2,K.x,K.y);$e.push(Math.floor((ot.y+Ce)/ve)+1),$e.push(Math.floor((ot.y+ot.h+Ce)/ve)+1);break;case"rect":$e.push(Math.floor((K.y+Ce)/ve)+1),$e.push(Math.floor((K.y+K.h+Ce)/ve)+1)}for(var Ye=0;Ye<$e.length;Ye+=1)for(;this.pdf.internal.getNumberOfPages()<$e[Ye];)T.call(this);return $e},T=function(){var K=this.fillStyle,te=this.strokeStyle,ve=this.font,$e=this.lineCap,Ce=this.lineWidth,Ge=this.lineJoin;this.pdf.addPage(),this.fillStyle=K,this.strokeStyle=te,this.font=ve,this.lineCap=$e,this.lineWidth=Ce,this.lineJoin=Ge},P=function(K,te,ve){for(var $e=0;$e<K.length;$e++)switch(K[$e].type){case"bct":K[$e].x2+=te,K[$e].y2+=ve;case"qct":K[$e].x1+=te,K[$e].y1+=ve;default:K[$e].x+=te,K[$e].y+=ve}return K},C=function(K){return K.sort(function(te,ve){return te-ve})},D=function(K,te){for(var ve,$e,Ce=this.fillStyle,Ge=this.strokeStyle,ot=this.lineCap,Ye=this.lineWidth,et=Math.abs(Ye*this.ctx.transform.scaleX),Te=this.lineJoin,Le=JSON.parse(JSON.stringify(this.path)),ke=JSON.parse(JSON.stringify(this.path)),Xe=[],Ne=0;Ne<ke.length;Ne++)if(ke[Ne].x!==void 0)for(var Ot=E.call(this,ke[Ne]),Lt=0;Lt<Ot.length;Lt+=1)Xe.indexOf(Ot[Lt])===-1&&Xe.push(Ot[Lt]);for(var kt=0;kt<Xe.length;kt++)for(;this.pdf.internal.getNumberOfPages()<Xe[kt];)T.call(this);if(C(Xe),this.autoPaging)for(var mt=Xe[0],Zt=Xe[Xe.length-1],Kt=mt;Kt<Zt+1;Kt++){this.pdf.setPage(Kt),this.fillStyle=Ce,this.strokeStyle=Ge,this.lineCap=ot,this.lineWidth=et,this.lineJoin=Te;var dr=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Bt=Kt===1?this.posY+this.margin[0]:this.margin[0],wr=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],mr=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],hr=Kt===1?0:wr+(Kt-2)*mr;if(this.ctx.clip_path.length!==0){var xr=this.path;ve=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=P(ve,this.posX+this.margin[3],-hr+Bt+this.ctx.prevPageLastElemOffset),L.call(this,K,!0),this.path=xr}if($e=JSON.parse(JSON.stringify(Le)),this.path=P($e,this.posX+this.margin[3],-hr+Bt+this.ctx.prevPageLastElemOffset),te===!1||Kt===0){var or=(Kt>mt||Kt<Zt)&&x.call(this);or&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],dr,mr,null).clip().discardPath()),L.call(this,K,te),or&&this.pdf.restoreGraphicsState()}this.lineWidth=Ye}else this.lineWidth=et,L.call(this,K,te),this.lineWidth=Ye;this.path=Le},L=function(K,te){if((K!=="stroke"||te||!M.call(this))&&(K==="stroke"||te||!y.call(this))){for(var ve,$e,Ce=[],Ge=this.path,ot=0;ot<Ge.length;ot++){var Ye=Ge[ot];switch(Ye.type){case"begin":Ce.push({begin:!0});break;case"close":Ce.push({close:!0});break;case"mt":Ce.push({start:Ye,deltas:[],abs:[]});break;case"lt":var et=Ce.length;if(Ge[ot-1]&&!isNaN(Ge[ot-1].x)&&(ve=[Ye.x-Ge[ot-1].x,Ye.y-Ge[ot-1].y],et>0)){for(;et>=0;et--)if(Ce[et-1].close!==!0&&Ce[et-1].begin!==!0){Ce[et-1].deltas.push(ve),Ce[et-1].abs.push(Ye);break}}break;case"bct":ve=[Ye.x1-Ge[ot-1].x,Ye.y1-Ge[ot-1].y,Ye.x2-Ge[ot-1].x,Ye.y2-Ge[ot-1].y,Ye.x-Ge[ot-1].x,Ye.y-Ge[ot-1].y],Ce[Ce.length-1].deltas.push(ve);break;case"qct":var Te=Ge[ot-1].x+2/3*(Ye.x1-Ge[ot-1].x),Le=Ge[ot-1].y+2/3*(Ye.y1-Ge[ot-1].y),ke=Ye.x+2/3*(Ye.x1-Ye.x),Xe=Ye.y+2/3*(Ye.y1-Ye.y),Ne=Ye.x,Ot=Ye.y;ve=[Te-Ge[ot-1].x,Le-Ge[ot-1].y,ke-Ge[ot-1].x,Xe-Ge[ot-1].y,Ne-Ge[ot-1].x,Ot-Ge[ot-1].y],Ce[Ce.length-1].deltas.push(ve);break;case"arc":Ce.push({deltas:[],abs:[],arc:!0}),Array.isArray(Ce[Ce.length-1].abs)&&Ce[Ce.length-1].abs.push(Ye)}}$e=te?null:K==="stroke"?"stroke":"fill";for(var Lt=!1,kt=0;kt<Ce.length;kt++)if(Ce[kt].arc)for(var mt=Ce[kt].abs,Zt=0;Zt<mt.length;Zt++){var Kt=mt[Zt];Kt.type==="arc"?$.call(this,Kt.x,Kt.y,Kt.radius,Kt.startAngle,Kt.endAngle,Kt.counterclockwise,void 0,te,!Lt):ee.call(this,Kt.x,Kt.y),Lt=!0}else if(Ce[kt].close===!0)this.pdf.internal.out("h"),Lt=!1;else if(Ce[kt].begin!==!0){var dr=Ce[kt].start.x,Bt=Ce[kt].start.y;ae.call(this,Ce[kt].deltas,dr,Bt),Lt=!0}$e&&U.call(this,$e),te&&G.call(this)}},N=function(K){var te=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,ve=te*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return K-ve;case"top":return K+te-ve;case"hanging":return K+te-2*ve;case"middle":return K+te/2-ve;default:return K}},j=function(K){return K+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};g.prototype.createLinearGradient=function(){var K=function(){};return K.colorStops=[],K.addColorStop=function(te,ve){this.colorStops.push([te,ve])},K.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},K.isCanvasGradient=!0,K},g.prototype.createPattern=function(){return this.createLinearGradient()},g.prototype.createRadialGradient=function(){return this.createLinearGradient()};var $=function(K,te,ve,$e,Ce,Ge,ot,Ye,et){for(var Te=ye.call(this,ve,$e,Ce,Ge),Le=0;Le<Te.length;Le++){var ke=Te[Le];Le===0&&(et?H.call(this,ke.x1+K,ke.y1+te):ee.call(this,ke.x1+K,ke.y1+te)),de.call(this,K,te,ke.x2,ke.y2,ke.x3,ke.y3,ke.x4,ke.y4)}Ye?G.call(this):U.call(this,ot)},U=function(K){switch(K){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},G=function(){this.pdf.clip(),this.pdf.discardPath()},H=function(K,te){this.pdf.internal.out(r(K)+" "+n(te)+" m")},X=function(K){var te;switch(K.align){case"right":case"end":te="right";break;case"center":te="center";break;default:te="left"}var ve=this.pdf.getTextDimensions(K.text),$e=N.call(this,K.y),Ce=j.call(this,$e)-ve.h,Ge=this.ctx.transform.applyToPoint(new s(K.x,$e)),ot=this.ctx.transform.decompose(),Ye=new u;Ye=(Ye=(Ye=Ye.multiply(ot.translate)).multiply(ot.skew)).multiply(ot.scale);for(var et,Te,Le,ke=this.ctx.transform.applyToRectangle(new a(K.x,$e,ve.w,ve.h)),Xe=Ye.applyToRectangle(new a(K.x,Ce,ve.w,ve.h)),Ne=E.call(this,Xe),Ot=[],Lt=0;Lt<Ne.length;Lt+=1)Ot.indexOf(Ne[Lt])===-1&&Ot.push(Ne[Lt]);if(C(Ot),this.autoPaging)for(var kt=Ot[0],mt=Ot[Ot.length-1],Zt=kt;Zt<mt+1;Zt++){this.pdf.setPage(Zt);var Kt=Zt===1?this.posY+this.margin[0]:this.margin[0],dr=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Bt=this.pdf.internal.pageSize.height-this.margin[2],wr=Bt-this.margin[0],mr=this.pdf.internal.pageSize.width-this.margin[1],hr=mr-this.margin[3],xr=Zt===1?0:dr+(Zt-2)*wr;if(this.ctx.clip_path.length!==0){var or=this.path;et=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=P(et,this.posX+this.margin[3],-1*xr+Kt),L.call(this,"fill",!0),this.path=or}var tt=P([JSON.parse(JSON.stringify(Xe))],this.posX+this.margin[3],-xr+Kt+this.ctx.prevPageLastElemOffset)[0];K.scale>=.01&&(Te=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Te*K.scale),Le=this.lineWidth,this.lineWidth=Le*K.scale);var Se=this.autoPaging!=="text";if(Se||tt.y+tt.h<=Bt){if(Se||tt.y>=Kt&&tt.x<=mr){var Pe=Se?K.text:this.pdf.splitTextToSize(K.text,K.maxWidth||mr-tt.x)[0],Ve=P([JSON.parse(JSON.stringify(ke))],this.posX+this.margin[3],-xr+Kt+this.ctx.prevPageLastElemOffset)[0],Qe=Se&&(Zt>kt||Zt<mt)&&x.call(this);Qe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],hr,wr,null).clip().discardPath()),this.pdf.text(Pe,Ve.x,Ve.y,{angle:K.angle,align:te,renderingMode:K.renderingMode}),Qe&&this.pdf.restoreGraphicsState()}}else tt.y<Bt&&(this.ctx.prevPageLastElemOffset+=Bt-tt.y);K.scale>=.01&&(this.pdf.setFontSize(Te),this.lineWidth=Le)}else K.scale>=.01&&(Te=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Te*K.scale),Le=this.lineWidth,this.lineWidth=Le*K.scale),this.pdf.text(K.text,Ge.x+this.posX,Ge.y+this.posY,{angle:K.angle,align:te,renderingMode:K.renderingMode,maxWidth:K.maxWidth}),K.scale>=.01&&(this.pdf.setFontSize(Te),this.lineWidth=Le)},ee=function(K,te,ve,$e){ve=ve||0,$e=$e||0,this.pdf.internal.out(r(K+ve)+" "+n(te+$e)+" l")},ae=function(K,te,ve){return this.pdf.lines(K,te,ve,null,null)},de=function(K,te,ve,$e,Ce,Ge,ot,Ye){this.pdf.internal.out([t(i(ve+K)),t(o($e+te)),t(i(Ce+K)),t(o(Ge+te)),t(i(ot+K)),t(o(Ye+te)),"c"].join(" "))},ye=function(K,te,ve,$e){for(var Ce=2*Math.PI,Ge=Math.PI/2;te>ve;)te-=Ce;var ot=Math.abs(ve-te);ot<Ce&&$e&&(ot=Ce-ot);for(var Ye=[],et=$e?-1:1,Te=te;ot>1e-5;){var Le=Te+et*Math.min(ot,Ge);Ye.push(_e.call(this,K,Te,Le)),ot-=Math.abs(Le-Te),Te=Le}return Ye},_e=function(K,te,ve){var $e=(ve-te)/2,Ce=K*Math.cos($e),Ge=K*Math.sin($e),ot=Ce,Ye=-Ge,et=ot*ot+Ye*Ye,Te=et+ot*Ce+Ye*Ge,Le=4/3*(Math.sqrt(2*et*Te)-Te)/(ot*Ge-Ye*Ce),ke=ot-Le*Ye,Xe=Ye+Le*ot,Ne=ke,Ot=-Xe,Lt=$e+te,kt=Math.cos(Lt),mt=Math.sin(Lt);return{x1:K*Math.cos(te),y1:K*Math.sin(te),x2:ke*kt-Xe*mt,y2:ke*mt+Xe*kt,x3:Ne*kt-Ot*mt,y3:Ne*mt+Ot*kt,x4:K*Math.cos(ve),y4:K*Math.sin(ve)}},ue=function(K){return 180*K/Math.PI},fe=function(K,te,ve,$e,Ce,Ge){var ot=K+.5*(ve-K),Ye=te+.5*($e-te),et=Ce+.5*(ve-Ce),Te=Ge+.5*($e-Ge),Le=Math.min(K,Ce,ot,et),ke=Math.max(K,Ce,ot,et),Xe=Math.min(te,Ge,Ye,Te),Ne=Math.max(te,Ge,Ye,Te);return new a(Le,Xe,ke-Le,Ne-Xe)},De=function(K,te,ve,$e,Ce,Ge,ot,Ye){var et,Te,Le,ke,Xe,Ne,Ot,Lt,kt,mt,Zt,Kt,dr,Bt,wr=ve-K,mr=$e-te,hr=Ce-ve,xr=Ge-$e,or=ot-Ce,tt=Ye-Ge;for(Te=0;Te<41;Te++)kt=(Ot=(Le=K+(et=Te/40)*wr)+et*((Xe=ve+et*hr)-Le))+et*(Xe+et*(Ce+et*or-Xe)-Ot),mt=(Lt=(ke=te+et*mr)+et*((Ne=$e+et*xr)-ke))+et*(Ne+et*(Ge+et*tt-Ne)-Lt),Te==0?(Zt=kt,Kt=mt,dr=kt,Bt=mt):(Zt=Math.min(Zt,kt),Kt=Math.min(Kt,mt),dr=Math.max(dr,kt),Bt=Math.max(Bt,mt));return new a(Math.round(Zt),Math.round(Kt),Math.round(dr-Zt),Math.round(Bt-Kt))},pe=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var K,te,ve=(K=this.ctx.lineDash,te=this.ctx.lineDashOffset,JSON.stringify({lineDash:K,lineDashOffset:te}));this.prevLineDash!==ve&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=ve)}}})(ai.API),function(e){var t=function(s){var a,u,d,m,g,_,y,M,x,E;for(u=[],d=0,m=(s+=a="\0\0\0\0".slice(s.length%4||4)).length;m>d;d+=4)(g=(s.charCodeAt(d)<<24)+(s.charCodeAt(d+1)<<16)+(s.charCodeAt(d+2)<<8)+s.charCodeAt(d+3))!==0?(_=(g=((g=((g=((g=(g-(E=g%85))/85)-(x=g%85))/85)-(M=g%85))/85)-(y=g%85))/85)%85,u.push(_+33,y+33,M+33,x+33,E+33)):u.push(122);return function(T,P){for(var C=P;C>0;C--)T.pop()}(u,a.length),String.fromCharCode.apply(String,u)+"~>"},r=function(s){var a,u,d,m,g,_=String,y="length",M=255,x="charCodeAt",E="slice",T="replace";for(s[E](-2),s=s[E](0,-2)[T](/\s/g,"")[T]("z","!!!!!"),d=[],m=0,g=(s+=a="uuuuu"[E](s[y]%5||5))[y];g>m;m+=5)u=52200625*(s[x](m)-33)+614125*(s[x](m+1)-33)+7225*(s[x](m+2)-33)+85*(s[x](m+3)-33)+(s[x](m+4)-33),d.push(M&u>>24,M&u>>16,M&u>>8,M&u);return function(P,C){for(var D=C;D>0;D--)P.pop()}(d,a[y]),_.fromCharCode.apply(_,d)},n=function(s){return s.split("").map(function(a){return("0"+a.charCodeAt().toString(16)).slice(-2)}).join("")+">"},i=function(s){var a=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),a.test(s)===!1)return"";for(var u="",d=0;d<s.length;d+=2)u+=String.fromCharCode("0x"+(s[d]+s[d+1]));return u},o=function(s){for(var a=new Uint8Array(s.length),u=s.length;u--;)a[u]=s.charCodeAt(u);return(a=zN(a)).reduce(function(d,m){return d+String.fromCharCode(m)},"")};e.processDataByFilters=function(s,a){var u=0,d=s||"",m=[];for(typeof(a=a||[])=="string"&&(a=[a]),u=0;u<a.length;u+=1)switch(a[u]){case"ASCII85Decode":case"/ASCII85Decode":d=r(d),m.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":d=t(d),m.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":d=i(d),m.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":d=n(d),m.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":d=o(d),m.push("/FlateDecode");break;default:throw new Error('The filter: "'+a[u]+'" is not implemented')}return{data:d,reverseChain:m.reverse().join(" ")}}}(ai.API),function(e){e.loadFile=function(t,r,n){return function(i,o,s){o=o!==!1,s=typeof s=="function"?s:function(){};var a=void 0;try{a=function(u,d,m){var g=new XMLHttpRequest,_=0,y=function(M){var x=M.length,E=[],T=String.fromCharCode;for(_=0;_<x;_+=1)E.push(T(255&M.charCodeAt(_)));return E.join("")};if(g.open("GET",u,!d),g.overrideMimeType("text/plain; charset=x-user-defined"),d===!1&&(g.onload=function(){g.status===200?m(y(this.responseText)):m(void 0)}),g.send(null),d&&g.status===200)return y(g.responseText)}(i,o,s)}catch{}return a}(t,r,n)},e.loadImageFile=e.loadFile}(ai.API),function(e){function t(){return(Ni.html2canvas?Promise.resolve(Ni.html2canvas):AO(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(a){return Promise.reject(new Error("Could not load html2canvas: "+a))}).then(function(a){return a.default?a.default:a})}function r(){return(Ni.DOMPurify?Promise.resolve(Ni.DOMPurify):AO(()=>import("./purify.es-BFmuJLeH.js"),[])).catch(function(a){return Promise.reject(new Error("Could not load dompurify: "+a))}).then(function(a){return a.default?a.default:a})}var n=function(a){var u=Ma(a);return u==="undefined"?"undefined":u==="string"||a instanceof String?"string":u==="number"||a instanceof Number?"number":u==="function"||a instanceof Function?"function":a&&a.constructor===Array?"array":a&&a.nodeType===1?"element":u==="object"?"object":"unknown"},i=function(a,u){var d=document.createElement(a);for(var m in u.className&&(d.className=u.className),u.innerHTML&&u.dompurify&&(d.innerHTML=u.dompurify.sanitize(u.innerHTML)),u.style)d.style[m]=u.style[m];return d},o=function a(u,d){for(var m=u.nodeType===3?document.createTextNode(u.nodeValue):u.cloneNode(!1),g=u.firstChild;g;g=g.nextSibling)d!==!0&&g.nodeType===1&&g.nodeName==="SCRIPT"||m.appendChild(a(g,d));return u.nodeType===1&&(u.nodeName==="CANVAS"?(m.width=u.width,m.height=u.height,m.getContext("2d").drawImage(u,0,0)):u.nodeName!=="TEXTAREA"&&u.nodeName!=="SELECT"||(m.value=u.value),m.addEventListener("load",function(){m.scrollTop=u.scrollTop,m.scrollLeft=u.scrollLeft},!0)),m},s=function a(u){var d=Object.assign(a.convert(Promise.resolve()),JSON.parse(JSON.stringify(a.template))),m=a.convert(Promise.resolve(),d);return(m=m.setProgress(1,a,1,[a])).set(u)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(a,u){return a.__proto__=u||s.prototype,a},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(a,u){return this.then(function(){switch(u=u||function(d){switch(n(d)){case"string":return"string";case"element":return d.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(a),u){case"string":return this.then(r).then(function(d){return this.set({src:i("div",{innerHTML:a,dompurify:d})})});case"element":return this.set({src:a});case"canvas":return this.set({canvas:a});case"img":return this.set({img:a});default:return this.error("Unknown source type.")}})},s.prototype.to=function(a){switch(a){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var a={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},u=o(this.prop.src,this.opt.html2canvas.javascriptEnabled);u.tagName==="BODY"&&(a.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:a}),this.prop.container.appendChild(u),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(t).then(function(u){var d=Object.assign({},this.opt.html2canvas);return delete d.onrendered,u(this.prop.container,d)}).then(function(u){(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(t).then(function(u){var d=this.opt.jsPDF,m=this.opt.fontFaces,g=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,_=Object.assign({async:!0,allowTaint:!0,scale:g,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete _.onrendered,d.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,d.context2d.posX=this.opt.x,d.context2d.posY=this.opt.y,d.context2d.margin=this.opt.margin,d.context2d.fontFaces=m,m)for(var y=0;y<m.length;++y){var M=m[y],x=M.src.find(function(E){return E.format==="truetype"});x&&d.addFont(x.url,M.ref.name,M.ref.style)}return _.windowHeight=_.windowHeight||0,_.windowHeight=_.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):_.windowHeight,d.context2d.save(!0),u(this.prop.container,_)}).then(function(u){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var a=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=a})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(a,u,d){return(d=d||"pdf").toLowerCase()==="img"||d.toLowerCase()==="image"?this.outputImg(a,u):this.outputPdf(a,u)},s.prototype.outputPdf=function(a,u){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(a,u)})},s.prototype.outputImg=function(a){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(a){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+a+'" is not supported.'}})},s.prototype.save=function(a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(a?{filename:a}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(a){if(n(a)!=="object")return this;var u=Object.keys(a||{}).map(function(d){if(d in s.template.prop)return function(){this.prop[d]=a[d]};switch(d){case"margin":return this.setMargin.bind(this,a.margin);case"jsPDF":return function(){return this.opt.jsPDF=a.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,a.pageSize);default:return function(){this.opt[d]=a[d]}}},this);return this.then(function(){return this.thenList(u)})},s.prototype.get=function(a,u){return this.then(function(){var d=a in s.template.prop?this.prop[a]:this.opt[a];return u?u(d):d})},s.prototype.setMargin=function(a){return this.then(function(){switch(n(a)){case"number":a=[a,a,a,a];case"array":if(a.length===2&&(a=[a[0],a[1],a[0],a[1]]),a.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=a}).then(this.setPageSize)},s.prototype.setPageSize=function(a){function u(d,m){return Math.floor(d*m/72*96)}return this.then(function(){(a=a||ai.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(a.inner={width:a.width-this.opt.margin[1]-this.opt.margin[3],height:a.height-this.opt.margin[0]-this.opt.margin[2]},a.inner.px={width:u(a.inner.width,a.k),height:u(a.inner.height,a.k)},a.inner.ratio=a.inner.height/a.inner.width),this.prop.pageSize=a})},s.prototype.setProgress=function(a,u,d,m){return a!=null&&(this.progress.val=a),u!=null&&(this.progress.state=u),d!=null&&(this.progress.n=d),m!=null&&(this.progress.stack=m),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(a,u,d,m){return this.setProgress(a?this.progress.val+a:null,u||null,d?this.progress.n+d:null,m?this.progress.stack.concat(m):null)},s.prototype.then=function(a,u){var d=this;return this.thenCore(a,u,function(m,g){return d.updateProgress(null,null,1,[m]),Promise.prototype.then.call(this,function(_){return d.updateProgress(null,m),_}).then(m,g).then(function(_){return d.updateProgress(1),_})})},s.prototype.thenCore=function(a,u,d){d=d||Promise.prototype.then;var m=this;a&&(a=a.bind(m)),u&&(u=u.bind(m));var g=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?m:s.convert(Object.assign({},m),Promise.prototype),_=d.call(g,a,u);return s.convert(_,m.__proto__)},s.prototype.thenExternal=function(a,u){return Promise.prototype.then.call(this,a,u)},s.prototype.thenList=function(a){var u=this;return a.forEach(function(d){u=u.thenCore(d)}),u},s.prototype.catch=function(a){a&&(a=a.bind(this));var u=Promise.prototype.catch.call(this,a);return s.convert(u,this)},s.prototype.catchExternal=function(a){return Promise.prototype.catch.call(this,a)},s.prototype.error=function(a){return this.then(function(){throw new Error(a)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,ai.getPageSize=function(a,u,d){if(Ma(a)==="object"){var m=a;a=m.orientation,u=m.unit||u,d=m.format||d}u=u||"mm",d=d||"a4",a=(""+(a||"P")).toLowerCase();var g,_=(""+d).toLowerCase(),y={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(u){case"pt":g=1;break;case"mm":g=72/25.4;break;case"cm":g=72/2.54;break;case"in":g=72;break;case"px":g=.75;break;case"pc":case"em":g=12;break;case"ex":g=6;break;default:throw"Invalid unit: "+u}var M,x=0,E=0;if(y.hasOwnProperty(_))x=y[_][1]/g,E=y[_][0]/g;else try{x=d[1],E=d[0]}catch{throw new Error("Invalid format: "+d)}if(a==="p"||a==="portrait")a="p",E>x&&(M=E,E=x,x=M);else{if(a!=="l"&&a!=="landscape")throw"Invalid orientation: "+a;a="l",x>E&&(M=E,E=x,x=M)}return{width:E,height:x,unit:u,k:g,orientation:a}},e.html=function(a,u){(u=u||{}).callback=u.callback||function(){},u.html2canvas=u.html2canvas||{},u.html2canvas.canvas=u.html2canvas.canvas||this.canvas,u.jsPDF=u.jsPDF||this,u.fontFaces=u.fontFaces?u.fontFaces.map(QO):null;var d=new s(u);return u.worker?d:d.from(a).doCallback()}}(ai.API),ai.API.addJS=function(e){return BK=e,this.internal.events.subscribe("postPutResources",function(){aE=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(aE+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),zK=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+BK+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){aE!==void 0&&zK!==void 0&&this.internal.out("/Names <</JavaScript "+aE+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=r.outline.render().split(/\r\n/),o=0;o<i.length;o++){var s=i[o],a=n.exec(s);if(a!=null){var u=a[1];r.internal.newObjectDeferredBegin(u,!1)}r.internal.write(s)}if(this.outline.createNamedDestinations){var d=this.internal.pages.length,m=[];for(o=0;o<d;o++){var g=r.internal.newObject();m.push(g);var _=r.internal.getPageInfo(o+1);r.internal.write("<< /D["+_.objId+" 0 R /XYZ null null null]>> endobj")}var y=r.internal.newObject();for(r.internal.write("<< /Names [ "),o=0;o<m.length;o++)r.internal.write("(page_"+(o+1)+")"+m[o]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+y+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,i,o){var s={title:i,options:o,children:[]};return n==null&&(n=this.root),n.children.push(s),s},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var i=0;i<n.children.length;i++)this.genIds_r(n.children[i])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,o=0;o<n.children.length;o++){var s=n.children[o];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(n)),o>0&&this.line("/Prev "+this.makeRef(n.children[o-1])),o<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[o+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var a=this.count=this.count_r({count:0},s);if(a>0&&this.line("/Count "+a),s.options&&s.options.pageNumber){var u=r.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+u.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var d=0;d<n.children.length;d++)this.renderItems(n.children[d])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,i){for(var o=0;o<i.children.length;o++)n.count++,this.count_r(n,i.children[o]);return n.count}}])}(ai.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,i,o,s,a){var u,d=this.decode.DCT_DECODE,m=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=s||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,u=function(g){for(var _,y=256*g.charCodeAt(4)+g.charCodeAt(5),M=g.length,x={width:0,height:0,numcomponents:1},E=4;E<M;E+=2){if(E+=y,t.indexOf(g.charCodeAt(E+1))!==-1){_=256*g.charCodeAt(E+5)+g.charCodeAt(E+6),x={width:256*g.charCodeAt(E+7)+g.charCodeAt(E+8),height:_,numcomponents:g.charCodeAt(E+9)};break}y=256*g.charCodeAt(E+2)+g.charCodeAt(E+3)}return x}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),u.numcomponents){case 1:a=this.color_spaces.DEVICE_GRAY;break;case 4:a=this.color_spaces.DEVICE_CMYK;break;case 3:a=this.color_spaces.DEVICE_RGB}m={data:r,width:u.width,height:u.height,colorSpace:a,bitsPerComponent:8,filter:d,index:n,alias:i}}return m}}(ai.API),ai.API.processPNG=function(e,t,r,n){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var i,o=LJe(e,{checkCrc:!0}),s=o.width,a=o.height,u=o.channels,d=o.palette,m=o.depth;i=d&&u===1?function(j){for(var $=j.width,U=j.height,G=j.data,H=j.palette,X=j.depth,ee=!1,ae=[],de=[],ye=void 0,_e=!1,ue=0,fe=0;fe<H.length;fe++){var De=$H(H[fe],4),pe=De[0],K=De[1],te=De[2],ve=De[3];ae.push(pe,K,te),ve!=null&&(ve===0?(ue++,de.length<1&&de.push(fe)):ve<255&&(_e=!0))}if(_e||ue>1){ee=!0,de=void 0;var $e=$*U;ye=new Uint8Array($e);for(var Ce=new DataView(G.buffer),Ge=0;Ge<$e;Ge++){var ot=eL(Ce,Ge,X),Ye=$H(H[ot],4)[3];ye[Ge]=Ye}}return{colorSpace:"Indexed",colorsPerPixel:1,colorBytes:G,alphaBytes:ye,needSMask:ee,palette:ae,mask:de}}(o):u===2||u===4?function(j){for(var $=j.data,U=j.width,G=j.height,H=j.channels,X=j.depth,ee=H===2?"DeviceGray":"DeviceRGB",ae=H-1,de=U*G,ye=ae,_e=de*ye,ue=1*de,fe=Math.ceil(_e*X/8),De=Math.ceil(ue*X/8),pe=new Uint8Array(fe),K=new Uint8Array(De),te=new DataView($.buffer),ve=new DataView(pe.buffer),$e=new DataView(K.buffer),Ce=!1,Ge=0;Ge<de;Ge++){for(var ot=Ge*H,Ye=0;Ye<ye;Ye++)XK(ve,eL(te,ot+Ye,X),Ge*ye+Ye,X);var et=eL(te,ot+ye,X);et<(1<<X)-1&&(Ce=!0),XK($e,et,1*Ge,X)}return{colorSpace:ee,colorsPerPixel:ae,colorBytes:pe,alphaBytes:K,needSMask:Ce}}(o):function(j){var $=j.data,U=j.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:U,colorsPerPixel:U==="DeviceGray"?1:3,colorBytes:$ instanceof Uint8Array?$:new Uint8Array($.buffer),needSMask:!1}}(o);var g,_,y,M=i,x=M.colorSpace,E=M.colorsPerPixel,T=M.colorBytes,P=M.alphaBytes,C=M.needSMask,D=M.palette,L=M.mask,N=null;return n!==ai.API.image_compression.NONE&&typeof zN=="function"?(N=function(j){var $;switch(j){case ai.API.image_compression.FAST:$=11;break;case ai.API.image_compression.MEDIUM:$=13;break;case ai.API.image_compression.SLOW:$=14;break;default:$=12}return $}(n),g=this.decode.FLATE_DECODE,_="/Predictor ".concat(N," "),e=GK(T,s*E,E,n),C&&(y=GK(P,s,1,n))):(g=void 0,_="",e=T,C&&(y=P)),_+="/Colors ".concat(E," /BitsPerComponent ").concat(m," /Columns ").concat(s),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(y&&this.__addimage__.isArrayBuffer(y)||this.__addimage__.isArrayBufferView(y))&&(y=this.__addimage__.arrayBufferToBinaryString(y)),{alias:r,data:e,index:t,filter:g,decodeParameters:_,transparency:L,palette:D,sMask:y,predictor:N,width:s,height:a,bitsPerComponent:m,colorSpace:x}}},function(e){e.processGIF89A=function(t,r,n,i){var o=new eet(t),s=o.width,a=o.height,u=[];o.decodeAndBlitFrameRGBA(0,u);var d={data:u,width:s,height:a},m=new tL(100).encode(d,100);return e.processJPEG.call(this,m,r,n,i)},e.processGIF87A=e.processGIF89A}(ai.API),xf.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:i,green:n,blue:r,quad:o}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},xf.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){Ba.log("bit decode error:"+r)}},xf.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,i=0;i<t;i++)for(var o=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+8*i*4,a=0;a<8&&8*i+a<this.width;a++){var u=this.palette[o>>7-a&1];this.data[s+4*a]=u.blue,this.data[s+4*a+1]=u.green,this.data[s+4*a+2]=u.red,this.data[s+4*a+3]=255}r!==0&&(this.pos+=4-r)}},xf.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<e;i++){var o=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+2*i*4,a=o>>4,u=15&o,d=this.palette[a];if(this.data[s]=d.blue,this.data[s+1]=d.green,this.data[s+2]=d.red,this.data[s+3]=255,2*i+1>=this.width)break;d=this.palette[u],this.data[s+4]=d.blue,this.data[s+4+1]=d.green,this.data[s+4+2]=d.red,this.data[s+4+3]=255}t!==0&&(this.pos+=4-t)}},xf.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+4*n;if(i<this.palette.length){var s=this.palette[i];this.data[o]=s.red,this.data[o+1]=s.green,this.data[o+2]=s.blue,this.data[o+3]=255}else this.data[o]=255,this.data[o+1]=255,this.data[o+2]=255,this.data[o+3]=255}e!==0&&(this.pos+=4-e)}},xf.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(o&t)/t*255|0,a=(o>>5&t)/t*255|0,u=(o>>10&t)/t*255|0,d=o>>15?255:0,m=n*this.width*4+4*i;this.data[m]=u,this.data[m+1]=a,this.data[m+2]=s,this.data[m+3]=d}this.pos+=e}},xf.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,o=0;o<this.width;o++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(s&t)/t*255|0,u=(s>>5&r)/r*255|0,d=(s>>11)/t*255|0,m=i*this.width*4+4*o;this.data[m]=d,this.data[m+1]=u,this.data[m+2]=a,this.data[m+3]=255}this.pos+=e}},xf.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*r;this.data[s]=o,this.data[s+1]=i,this.data[s+2]=n,this.data[s+3]=255}this.pos+=this.width%4}},xf.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=t*this.width*4+4*r;this.data[a]=o,this.data[a+1]=i,this.data[a+2]=n,this.data[a+3]=s}},xf.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,i){var o=new xf(t,!1),s=o.width,a=o.height,u={data:o.getData(),width:s,height:a},d=new tL(100).encode(u,100);return e.processJPEG.call(this,d,r,n,i)}}(ai.API),QK.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,i){var o=new QK(t),s=o.width,a=o.height,u={data:o.getData(),width:s,height:a},d=new tL(100).encode(u,100);return e.processJPEG.call(this,d,r,n,i)}}(ai.API),ai.API.processRGBA=function(e,t,r){for(var n=e.data,i=n.length,o=new Uint8Array(i/4*3),s=new Uint8Array(i/4),a=0,u=0,d=0;d<i;d+=4){var m=n[d],g=n[d+1],_=n[d+2],y=n[d+3];o[a++]=m,o[a++]=g,o[a++]=_,s[u++]=y}var M=this.__addimage__.arrayBufferToBinaryString(o);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:M,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},ai.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Dv=ai.API,sE=Dv.getCharWidthsArray=function(e,t){var r,n,i=(t=t||{}).font||this.internal.getFont(),o=t.fontSize||this.internal.getFontSize(),s=t.charSpace||this.internal.getCharSpace(),a=t.widths?t.widths:i.metadata.Unicode.widths,u=a.fof?a.fof:1,d=t.kerning?t.kerning:i.metadata.Unicode.kerning,m=d.fof?d.fof:1,g=t.doKerning!==!1,_=0,y=e.length,M=0,x=a[0]||u,E=[];for(r=0;r<y;r++)n=e.charCodeAt(r),typeof i.metadata.widthOfString=="function"?E.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(n))+s*(1e3/o)||0)/1e3):(_=g&&Ma(d[n])==="object"&&!isNaN(parseInt(d[n][M],10))?d[n][M]/m:0,E.push((a[n]||x)/u+_)),M=n;return E},UK=Dv.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),i=t.charSpace||this.internal.getCharSpace();return Dv.processArabic&&(e=Dv.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,i)/r:sE.apply(this,arguments).reduce(function(o,s){return o+s},0)},VK=function(e,t,r,n){for(var i=[],o=0,s=e.length,a=0;o!==s&&a+t[o]<r;)a+=t[o],o++;i.push(e.slice(0,o));var u=o;for(a=0;o!==s;)a+t[o]>n&&(i.push(e.slice(u,o)),a=0,u=o),a+=t[o],o++;return u!==o&&i.push(e.slice(u,o)),i},WK=function(e,t,r){r||(r={});var n,i,o,s,a,u,d,m=[],g=[m],_=r.textIndent||0,y=0,M=0,x=e.split(" "),E=sE.apply(this,[" ",r])[0];if(u=r.lineIndent===-1?x[0].length+2:r.lineIndent||0){var T=Array(u).join(" "),P=[];x.map(function(D){(D=D.split(/\s*\n/)).length>1?P=P.concat(D.map(function(L,N){return(N&&L.length?`
`:"")+L})):P.push(D[0])}),x=P,u=UK.apply(this,[T,r])}for(o=0,s=x.length;o<s;o++){var C=0;if(n=x[o],u&&n[0]==`
`&&(n=n.substr(1),C=1),_+y+(M=(i=sE.apply(this,[n,r])).reduce(function(D,L){return D+L},0))>t||C){if(M>t){for(a=VK.apply(this,[n,i,t-(_+y),t]),m.push(a.shift()),m=[a.pop()];a.length;)g.push([a.shift()]);M=i.slice(n.length-(m[0]?m[0].length:0)).reduce(function(D,L){return D+L},0)}else m=[n];g.push(m),_=M+u,y=E}else m.push(n),_+=y+M,y=E}return d=u?function(D,L){return(L?T:"")+D.join(" ")}:function(D){return D.join(" ")},g.map(d)},Dv.splitTextToSize=function(e,t,r){var n,i=(r=r||{}).fontSize||this.internal.getFontSize(),o=(function(m){if(m.widths&&m.kerning)return{widths:m.widths,kerning:m.kerning};var g=this.internal.getFont(m.fontName,m.fontStyle),_="Unicode";return g.metadata[_]?{widths:g.metadata[_].widths||{0:1},kerning:g.metadata[_].kerning||{}}:{font:g.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var s=1*this.internal.scaleFactor*t/i;o.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/i:0,o.lineIndent=r.lineIndent;var a,u,d=[];for(a=0,u=n.length;a<u;a++)d=d.concat(WK.apply(this,[n[a],s,o]));return d},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",n={},i={},o=0;o<16;o++)n[r[o]]=t[o],i[t[o]]=r[o];var s=function(_){return"0x"+parseInt(_,10).toString(16)},a=e.__fontmetrics__.compress=function(_){var y,M,x,E,T=["{"];for(var P in _){if(y=_[P],isNaN(parseInt(P,10))?M="'"+P+"'":(P=parseInt(P,10),M=(M=s(P).slice(2)).slice(0,-1)+i[M.slice(-1)]),typeof y=="number")y<0?(x=s(y).slice(3),E="-"):(x=s(y).slice(2),E=""),x=E+x.slice(0,-1)+i[x.slice(-1)];else{if(Ma(y)!=="object")throw new Error("Don't know what to do with value type "+Ma(y)+".");x=a(y)}T.push(M+x)}return T.push("}"),T.join("")},u=e.__fontmetrics__.uncompress=function(_){if(typeof _!="string")throw new Error("Invalid argument passed to uncompress.");for(var y,M,x,E,T={},P=1,C=T,D=[],L="",N="",j=_.length-1,$=1;$<j;$+=1)(E=_[$])=="'"?y?(x=y.join(""),y=void 0):y=[]:y?y.push(E):E=="{"?(D.push([C,x]),C={},x=void 0):E=="}"?((M=D.pop())[0][M[1]]=C,x=void 0,C=M[0]):E=="-"?P=-1:x===void 0?n.hasOwnProperty(E)?(L+=n[E],x=parseInt(L,16)*P,P=1,L=""):L+=E:n.hasOwnProperty(E)?(N+=n[E],C[x]=parseInt(N,16)*P,P=1,x=void 0,N=""):N+=E;return T},d={codePages:["WinAnsiEncoding"],WinAnsiEncoding:u("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},m={Unicode:{Courier:d,"Courier-Bold":d,"Courier-BoldOblique":d,"Courier-Oblique":d,Helvetica:d,"Helvetica-Bold":d,"Helvetica-BoldOblique":d,"Helvetica-Oblique":d,"Times-Roman":d,"Times-Bold":d,"Times-BoldItalic":d,"Times-Italic":d}},g={Unicode:{"Courier-Oblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":u("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":u("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:u("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:u("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":u("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":u("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(_){var y=_.font,M=g.Unicode[y.postScriptName];M&&(y.metadata.Unicode={},y.metadata.Unicode.widths=M.widths,y.metadata.Unicode.kerning=M.kerning);var x=m.Unicode[y.postScriptName];x&&(y.metadata.Unicode.encoding=x,y.encoding=x.codePages[0])}])}(ai.API),function(e){var t=function(r){for(var n=r.length,i=new Uint8Array(n),o=0;o<n;o++)i[o]=r.charCodeAt(o);return i};e.API.events.push(["addFont",function(r){var n=void 0,i=r.font,o=r.instance;if(!i.isStandardFont){if(o===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(n=o.existsFileInVFS(i.postScriptName)===!1?o.loadFile(i.postScriptName):o.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(s,a){a=/^\x00\x01\x00\x00/.test(a)?t(a):t(RE(a)),s.metadata=e.API.TTFFont.open(a),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(i,n)}}])}(ai),ai.API.addSvgAsImage=function(e,t,r,n,i,o,s,a){if(isNaN(t)||isNaN(r))throw Ba.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(i))throw Ba.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var u=document.createElement("canvas");u.width=n,u.height=i;var d=u.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,u.width,u.height);var m={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},g=this;return(Ni.canvg?Promise.resolve(Ni.canvg):AO(()=>import("./index.es-BLYqzLG_.js"),[])).catch(function(_){return Promise.reject(new Error("Could not load canvg: "+_))}).then(function(_){return _.default?_.default:_}).then(function(_){return _.fromString(d,e,m)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(_){return _.render(m)}).then(function(){g.addImage(u.toDataURL("image/jpeg",1),t,r,n,i,s,a)})},ai.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(t,r);return this},ai.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,i,o,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},a=Object.keys(s),u=[],d=0,m=0,g=0;function _(M,x){var E,T=!1;for(E=0;E<M.length;E+=1)M[E]===x&&(T=!0);return T}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var y=a.length;for(g=0;g<y;g+=1)r[a[g]].value=r[a[g]].defaultValue,r[a[g]].explicitSet=!1}if(Ma(e)==="object"){for(i in e)if(o=e[i],_(a,i)&&o!==void 0){if(r[i].type==="boolean"&&typeof o=="boolean")r[i].value=o;else if(r[i].type==="name"&&_(r[i].valueSet,o))r[i].value=o;else if(r[i].type==="integer"&&Number.isInteger(o))r[i].value=o;else if(r[i].type==="array"){for(d=0;d<o.length;d+=1)if(n=!0,o[d].length===1&&typeof o[d][0]=="number")u.push(String(o[d]-1));else if(o[d].length>1){for(m=0;m<o[d].length;m+=1)typeof o[d][m]!="number"&&(n=!1);n===!0&&u.push([o[d][0]-1,o[d][1]-1].join(" "))}r[i].value="["+u.join(" ")+"]"}else r[i].value=r[i].defaultValue;r[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var M,x=[];for(M in r)r[M].explicitSet===!0&&(r[M].type==="name"?x.push("/"+M+" /"+r[M].value):x.push("/"+M+" "+r[M].value));x.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+x.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),o=unescape(encodeURIComponent(n)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),a=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),u=unescape(encodeURIComponent("</x:xmpmeta>")),d=o.length+s.length+a.length+i.length+u.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+d+" >>"),this.internal.write("stream"),this.internal.write(i+o+s+a+u),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(ai.API),function(e){var t=e.API,r=t.pdfEscape16=function(o,s){for(var a,u=s.metadata.Unicode.widths,d=["","0","00","000","0000"],m=[""],g=0,_=o.length;g<_;++g){if(a=s.metadata.characterToGlyph(o.charCodeAt(g)),s.metadata.glyIdsUsed.push(a),s.metadata.toUnicode[a]=o.charCodeAt(g),u.indexOf(a)==-1&&(u.push(a),u.push([parseInt(s.metadata.widthOfGlyph(a),10)])),a=="0")return m.join("");a=a.toString(16),m.push(d[4-a.length],a)}return m.join("")},n=function(o){var s,a,u,d,m,g,_;for(m=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,u=[],g=0,_=(a=Object.keys(o).sort(function(y,M){return y-M})).length;g<_;g++)s=a[g],u.length>=100&&(m+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar`,u=[]),o[s]!==void 0&&o[s]!==null&&typeof o[s].toString=="function"&&(d=("0000"+o[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),u.push("<"+s+"><"+d+">"));return u.length&&(m+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar
`),m+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(o){(function(s){var a=s.font,u=s.out,d=s.newObject,m=s.putStream;if(a.metadata instanceof e.API.TTFFont&&a.encoding==="Identity-H"){for(var g=a.metadata.Unicode.widths,_=a.metadata.subset.encode(a.metadata.glyIdsUsed,1),y="",M=0;M<_.length;M++)y+=String.fromCharCode(_[M]);var x=d();m({data:y,addLength1:!0,objectId:x}),u("endobj");var E=d();m({data:n(a.metadata.toUnicode),addLength1:!0,objectId:E}),u("endobj");var T=d();u("<<"),u("/Type /FontDescriptor"),u("/FontName /"+Rv(a.fontName)),u("/FontFile2 "+x+" 0 R"),u("/FontBBox "+e.API.PDFObject.convert(a.metadata.bbox)),u("/Flags "+a.metadata.flags),u("/StemV "+a.metadata.stemV),u("/ItalicAngle "+a.metadata.italicAngle),u("/Ascent "+a.metadata.ascender),u("/Descent "+a.metadata.decender),u("/CapHeight "+a.metadata.capHeight),u(">>"),u("endobj");var P=d();u("<<"),u("/Type /Font"),u("/BaseFont /"+Rv(a.fontName)),u("/FontDescriptor "+T+" 0 R"),u("/W "+e.API.PDFObject.convert(g)),u("/CIDToGIDMap /Identity"),u("/DW 1000"),u("/Subtype /CIDFontType2"),u("/CIDSystemInfo"),u("<<"),u("/Supplement 0"),u("/Registry (Adobe)"),u("/Ordering ("+a.encoding+")"),u(">>"),u(">>"),u("endobj"),a.objectNumber=d(),u("<<"),u("/Type /Font"),u("/Subtype /Type0"),u("/ToUnicode "+E+" 0 R"),u("/BaseFont /"+Rv(a.fontName)),u("/Encoding /"+a.encoding),u("/DescendantFonts ["+P+" 0 R]"),u(">>"),u("endobj"),a.isAlreadyPutted=!0}})(o)}]),t.events.push(["putFont",function(o){(function(s){var a=s.font,u=s.out,d=s.newObject,m=s.putStream;if(a.metadata instanceof e.API.TTFFont&&a.encoding==="WinAnsiEncoding"){for(var g=a.metadata.rawData,_="",y=0;y<g.length;y++)_+=String.fromCharCode(g[y]);var M=d();m({data:_,addLength1:!0,objectId:M}),u("endobj");var x=d();m({data:n(a.metadata.toUnicode),addLength1:!0,objectId:x}),u("endobj");var E=d();u("<<"),u("/Descent "+a.metadata.decender),u("/CapHeight "+a.metadata.capHeight),u("/StemV "+a.metadata.stemV),u("/Type /FontDescriptor"),u("/FontFile2 "+M+" 0 R"),u("/Flags 96"),u("/FontBBox "+e.API.PDFObject.convert(a.metadata.bbox)),u("/FontName /"+Rv(a.fontName)),u("/ItalicAngle "+a.metadata.italicAngle),u("/Ascent "+a.metadata.ascender),u(">>"),u("endobj"),a.objectNumber=d();for(var T=0;T<a.metadata.hmtx.widths.length;T++)a.metadata.hmtx.widths[T]=parseInt(a.metadata.hmtx.widths[T]*(1e3/a.metadata.head.unitsPerEm));u("<</Subtype/TrueType/Type/Font/ToUnicode "+x+" 0 R/BaseFont/"+Rv(a.fontName)+"/FontDescriptor "+E+" 0 R/Encoding/"+a.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(a.metadata.hmtx.widths)+">>"),u("endobj"),a.isAlreadyPutted=!0}})(o)}]);var i=function(o){var s,a=o.text||"",u=o.x,d=o.y,m=o.options||{},g=o.mutex||{},_=g.pdfEscape,y=g.activeFontKey,M=g.fonts,x=y,E="",T=0,P="",C=M[x].encoding;if(M[x].encoding!=="Identity-H")return{text:a,x:u,y:d,options:m,mutex:g};for(P=a,x=y,Array.isArray(a)&&(P=a[0]),T=0;T<P.length;T+=1)M[x].metadata.hasOwnProperty("cmap")&&(s=M[x].metadata.cmap.unicode.codeMap[P[T].charCodeAt(0)]),s||P[T].charCodeAt(0)<256&&M[x].metadata.hasOwnProperty("Unicode")?E+=P[T]:E+="";var D="";return parseInt(x.slice(1))<14||C==="WinAnsiEncoding"?D=_(E,x).split("").map(function(L){return L.charCodeAt(0).toString(16)}).join(""):C==="Identity-H"&&(D=r(E,M[x])),g.isHex=!0,{text:D,x:u,y:d,options:m,mutex:g}};t.events.push(["postProcessText",function(o){var s=o.text||"",a=[],u={text:s,x:o.x,y:o.y,options:o.options,mutex:o.mutex};if(Array.isArray(s)){var d=0;for(d=0;d<s.length;d+=1)Array.isArray(s[d])&&s[d].length===3?a.push([i(Object.assign({},u,{text:s[d][0]})).text,s[d][1],s[d][2]]):a.push(i(Object.assign({},u,{text:s[d]})).text);o.text=a}else o.text=i(Object.assign({},u,{text:s})).text}])}(ai),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(ai.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var i,o,s,a,u,d,m,g=t,_=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],y=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],M={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},x={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},E=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],T=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),P=!1,C=0;this.__bidiEngine__={};var D=function(H){var X=H.charCodeAt(),ee=X>>8,ae=x[ee];return ae!==void 0?g[256*ae+(255&X)]:ee===252||ee===253?"AL":T.test(ee)?"L":ee===8?"R":"N"},L=function(H){for(var X,ee=0;ee<H.length;ee++){if((X=D(H.charAt(ee)))==="L")return!1;if(X==="R")return!0}return!1},N=function(H,X,ee,ae){var de,ye,_e,ue,fe=X[ae];switch(fe){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":P=!1;break;case"N":case"AN":break;case"EN":P&&(fe="AN");break;case"AL":P=!0,fe="R";break;case"WS":case"BN":fe="N";break;case"CS":ae<1||ae+1>=X.length||(de=ee[ae-1])!=="EN"&&de!=="AN"||(ye=X[ae+1])!=="EN"&&ye!=="AN"?fe="N":P&&(ye="AN"),fe=ye===de?ye:"N";break;case"ES":fe=(de=ae>0?ee[ae-1]:"B")==="EN"&&ae+1<X.length&&X[ae+1]==="EN"?"EN":"N";break;case"ET":if(ae>0&&ee[ae-1]==="EN"){fe="EN";break}if(P){fe="N";break}for(_e=ae+1,ue=X.length;_e<ue&&X[_e]==="ET";)_e++;fe=_e<ue&&X[_e]==="EN"?"EN":"N";break;case"NSM":if(s&&!a){for(ue=X.length,_e=ae+1;_e<ue&&X[_e]==="NSM";)_e++;if(_e<ue){var De=H[ae],pe=De>=1425&&De<=2303||De===64286;if(de=X[_e],pe&&(de==="R"||de==="AL")){fe="R";break}}}fe=ae<1||(de=X[ae-1])==="B"?"N":ee[ae-1];break;case"B":P=!1,i=!0,fe=C;break;case"S":o=!0,fe="N"}return fe},j=function(H,X,ee){var ae=H.split("");return ee&&$(ae,ee,{hiLevel:C}),ae.reverse(),X&&X.reverse(),ae.join("")},$=function(H,X,ee){var ae,de,ye,_e,ue,fe=-1,De=H.length,pe=0,K=[],te=C?y:_,ve=[];for(P=!1,i=!1,o=!1,de=0;de<De;de++)ve[de]=D(H[de]);for(ye=0;ye<De;ye++){if(ue=pe,K[ye]=N(H,ve,K,ye),ae=240&(pe=te[ue][M[K[ye]]]),pe&=15,X[ye]=_e=te[pe][5],ae>0)if(ae===16){for(de=fe;de<ye;de++)X[de]=1;fe=-1}else fe=-1;if(te[pe][6])fe===-1&&(fe=ye);else if(fe>-1){for(de=fe;de<ye;de++)X[de]=_e;fe=-1}ve[ye]==="B"&&(X[ye]=0),ee.hiLevel|=_e}o&&function($e,Ce,Ge){for(var ot=0;ot<Ge;ot++)if($e[ot]==="S"){Ce[ot]=C;for(var Ye=ot-1;Ye>=0&&$e[Ye]==="WS";Ye--)Ce[Ye]=C}}(ve,X,De)},U=function(H,X,ee,ae,de){if(!(de.hiLevel<H)){if(H===1&&C===1&&!i)return X.reverse(),void(ee&&ee.reverse());for(var ye,_e,ue,fe,De=X.length,pe=0;pe<De;){if(ae[pe]>=H){for(ue=pe+1;ue<De&&ae[ue]>=H;)ue++;for(fe=pe,_e=ue-1;fe<_e;fe++,_e--)ye=X[fe],X[fe]=X[_e],X[_e]=ye,ee&&(ye=ee[fe],ee[fe]=ee[_e],ee[_e]=ye);pe=ue}pe++}}},G=function(H,X,ee){var ae=H.split(""),de={hiLevel:C};return ee||(ee=[]),$(ae,ee,de),function(ye,_e,ue){if(ue.hiLevel!==0&&m)for(var fe,De=0;De<ye.length;De++)_e[De]===1&&(fe=E.indexOf(ye[De]))>=0&&(ye[De]=E[fe+1])}(ae,ee,de),U(2,ae,X,ee,de),U(1,ae,X,ee,de),ae.join("")};return this.__bidiEngine__.doBidiReorder=function(H,X,ee){if(function(de,ye){if(ye)for(var _e=0;_e<de.length;_e++)ye[_e]=_e;a===void 0&&(a=L(de)),d===void 0&&(d=L(de))}(H,X),s||!u||d)if(s&&u&&a^d)C=a?1:0,H=j(H,X,ee);else if(!s&&u&&d)C=a?1:0,H=G(H,X,ee),H=j(H,X);else if(!s||a||u||d){if(s&&!u&&a^d)H=j(H,X),a?(C=0,H=G(H,X,ee)):(C=1,H=G(H,X,ee),H=j(H,X));else if(s&&a&&!u&&d)C=1,H=G(H,X,ee),H=j(H,X);else if(!s&&!u&&a^d){var ae=m;a?(C=1,H=G(H,X,ee),C=0,m=!1,H=G(H,X,ee),m=ae):(C=0,H=G(H,X,ee),H=j(H,X),C=1,m=!1,H=G(H,X,ee),m=ae,H=j(H,X))}}else C=0,H=G(H,X,ee);else C=a?1:0,H=G(H,X,ee);return H},this.__bidiEngine__.setOptions=function(H){H&&(s=H.isInputVisual,u=H.isOutputVisual,a=H.isInputRtl,d=H.isOutputRtl,m=H.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var i=n.text;n.x,n.y;var o=n.options||{};n.mutex,o.lang;var s=[];if(o.isInputVisual=typeof o.isInputVisual!="boolean"||o.isInputVisual,r.setOptions(o),Object.prototype.toString.call(i)==="[object Array]"){var a=0;for(s=[],a=0;a<i.length;a+=1)Object.prototype.toString.call(i[a])==="[object Array]"?s.push([r.doBidiReorder(i[a][0]),i[a][1],i[a][2]]):s.push([r.doBidiReorder(i[a])]);n.text=s}else n.text=r.doBidiReorder(i);r.setOptions({isInputVisual:!0})}])}(ai),ai.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new A_(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new get(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new tet(this.contents),this.head=new net(this),this.name=new cet(this),this.cmap=new xhe(this),this.toUnicode={},this.hhea=new iet(this),this.maxp=new uet(this),this.hmtx=new det(this),this.post=new aet(this),this.os2=new oet(this),this.loca=new met(this),this.glyf=new het(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,i,o;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var s,a,u,d;for(d=[],s=0,a=(u=this.bbox).length;s<a;s++)t=u[s],d.push(Math.round(t*this.scaleFactor));return d}).call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),32768&(r=i>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(o=this.familyClass)===1||o===2||o===3||o===4||o===5||o===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var i,o,s,a;for(s=0,o=0,a=(t=""+t).length;0<=a?o<a:o>a;o=0<=a?++o:--o)i=t.charCodeAt(o),s+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/r)||0;return s*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var Qf,A_=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,i;for(i=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)i.push(this.writeByte(t.charCodeAt(r)));return i},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,i,o,s,a,u;return t=this.readByte(),r=this.readByte(),n=this.readByte(),i=this.readByte(),o=this.readByte(),s=this.readByte(),a=this.readByte(),u=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^o)+65536*(255^s)+256*(255^a)+(255^u)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*i+16777216*o+65536*s+256*a+u},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,i,o;for(o=[],n=0,i=t.length;n<i;n++)r=t[n],o.push(this.writeByte(r));return o},e}(),tet=function(){var e;function t(r){var n,i,o;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},i=0,o=this.tableCount;0<=o?i<o:i>o;i=0<=o?++i:--i)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,i,o,s,a,u,d,m,g,_,y,M,x;for(x in y=Object.keys(r).length,u=Math.log(2),g=16*Math.floor(Math.log(y)/u),s=Math.floor(g/u),m=16*y-g,(i=new A_).writeInt(this.scalarType),i.writeShort(y),i.writeShort(g),i.writeShort(s),i.writeShort(m),o=16*y,d=i.pos+o,a=null,M=[],r)for(_=r[x],i.writeString(x),i.writeInt(e(_)),i.writeInt(d),i.writeInt(_.length),M=M.concat(_),x==="head"&&(a=d),d+=_.length;d%4;)M.push(0),d++;return i.write(M),n=2981146554-e(i.data),i.pos=a+8,i.writeUInt32(n),i.data},e=function(r){var n,i,o,s;for(r=whe.call(r);r.length%4;)r.push(0);for(o=new A_(r),i=0,n=0,s=r.length;n<s;n=n+=4)i+=o.readUInt32();return 4294967295&i},t}(),ret={}.hasOwnProperty,em=function(e,t){for(var r in t)ret.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};Qf=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var net=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return em(e,Qf),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new A_).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e}(),JK=function(){function e(t,r){var n,i,o,s,a,u,d,m,g,_,y,M,x,E,T,P,C;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),g=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(u=0;u<256;++u)this.codeMap[u]=t.readByte();break;case 4:for(y=t.readUInt16(),_=y/2,t.pos+=6,o=function(){var D,L;for(L=[],u=D=0;0<=_?D<_:D>_;u=0<=_?++D:--D)L.push(t.readUInt16());return L}(),t.pos+=2,x=function(){var D,L;for(L=[],u=D=0;0<=_?D<_:D>_;u=0<=_?++D:--D)L.push(t.readUInt16());return L}(),d=function(){var D,L;for(L=[],u=D=0;0<=_?D<_:D>_;u=0<=_?++D:--D)L.push(t.readUInt16());return L}(),m=function(){var D,L;for(L=[],u=D=0;0<=_?D<_:D>_;u=0<=_?++D:--D)L.push(t.readUInt16());return L}(),i=(this.length-t.pos+this.offset)/2,a=function(){var D,L;for(L=[],u=D=0;0<=i?D<i:D>i;u=0<=i?++D:--D)L.push(t.readUInt16());return L}(),u=T=0,C=o.length;T<C;u=++T)for(E=o[u],n=P=M=x[u];M<=E?P<=E:P>=E;n=M<=E?++P:--P)m[u]===0?s=n+d[u]:(s=a[m[u]/2+(n-M)-(_-u)]||0)!==0&&(s+=d[u]),this.codeMap[n]=65535&s}t.pos=g}return e.encode=function(t,r){var n,i,o,s,a,u,d,m,g,_,y,M,x,E,T,P,C,D,L,N,j,$,U,G,H,X,ee,ae,de,ye,_e,ue,fe,De,pe,K,te,ve,$e,Ce,Ge,ot,Ye,et,Te,Le;switch(ae=new A_,s=Object.keys(t).sort(function(ke,Xe){return ke-Xe}),r){case"macroman":for(x=0,E=function(){var ke=[];for(M=0;M<256;++M)ke.push(0);return ke}(),P={0:0},o={},de=0,fe=s.length;de<fe;de++)P[Ye=t[i=s[de]]]==null&&(P[Ye]=++x),o[i]={old:t[i],new:P[t[i]]},E[i]=P[t[i]];return ae.writeUInt16(1),ae.writeUInt16(0),ae.writeUInt32(12),ae.writeUInt16(0),ae.writeUInt16(262),ae.writeUInt16(0),ae.write(E),{charMap:o,subtable:ae.data,maxGlyphID:x+1};case"unicode":for(X=[],g=[],C=0,P={},n={},T=d=null,ye=0,De=s.length;ye<De;ye++)P[L=t[i=s[ye]]]==null&&(P[L]=++C),n[i]={old:L,new:P[L]},a=P[L]-i,T!=null&&a===d||(T&&g.push(T),X.push(i),d=a),T=i;for(T&&g.push(T),g.push(65535),X.push(65535),G=2*(U=X.length),$=2*Math.pow(Math.log(U)/Math.LN2,2),_=Math.log($/2)/Math.LN2,j=2*U-$,u=[],N=[],y=[],M=_e=0,pe=X.length;_e<pe;M=++_e){if(H=X[M],m=g[M],H===65535){u.push(0),N.push(0);break}if(H-(ee=n[H].new)>=32768)for(u.push(0),N.push(2*(y.length+U-M)),i=ue=H;H<=m?ue<=m:ue>=m;i=H<=m?++ue:--ue)y.push(n[i].new);else u.push(ee-H),N.push(0)}for(ae.writeUInt16(3),ae.writeUInt16(1),ae.writeUInt32(12),ae.writeUInt16(4),ae.writeUInt16(16+8*U+2*y.length),ae.writeUInt16(0),ae.writeUInt16(G),ae.writeUInt16($),ae.writeUInt16(_),ae.writeUInt16(j),Ge=0,K=g.length;Ge<K;Ge++)i=g[Ge],ae.writeUInt16(i);for(ae.writeUInt16(0),ot=0,te=X.length;ot<te;ot++)i=X[ot],ae.writeUInt16(i);for(et=0,ve=u.length;et<ve;et++)a=u[et],ae.writeUInt16(a);for(Te=0,$e=N.length;Te<$e;Te++)D=N[Te],ae.writeUInt16(D);for(Le=0,Ce=y.length;Le<Ce;Le++)x=y[Le],ae.writeUInt16(x);return{charMap:n,subtable:ae.data,maxGlyphID:C+1}}},e}(),xhe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return em(e,Qf),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,n,i;for(t.pos=this.offset,this.version=t.readUInt16(),i=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=i?n<i:n>i;n=0<=i?++n:--n)r=new JK(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var n,i;return r==null&&(r="macroman"),n=JK.encode(t,r),(i=new A_).writeUInt16(0),i.writeUInt16(1),n.table=i.data.concat(n.subtable),n},e}(),iet=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return em(e,Qf),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),oet=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return em(e,Qf),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(t.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(t.readInt());return n}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(t.readInt());return n}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),aet=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return em(e,Qf),e.prototype.tag="post",e.prototype.parse=function(t){var r,n,i;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var o;for(n=t.readUInt16(),this.glyphNameIndex=[],o=0;0<=n?o<n:o>n;o=0<=n?++o:--o)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],i=[];t.pos<this.offset+this.length;)r=t.readByte(),i.push(this.names.push(t.readString(r)));return i;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 262144:return this.map=(function(){var s,a,u;for(u=[],o=s=0,a=this.file.maxp.numGlyphs;0<=a?s<a:s>a;o=0<=a?++s:--s)u.push(t.readUInt32());return u}).call(this)}},e}(),set=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},cet=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return em(e,Qf),e.prototype.tag="name",e.prototype.parse=function(t){var r,n,i,o,s,a,u,d,m,g,_;for(t.pos=this.offset,t.readShort(),r=t.readShort(),a=t.readShort(),n=[],o=0;0<=r?o<r:o>r;o=0<=r?++o:--o)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+a+t.readShort()});for(u={},o=m=0,g=n.length;m<g;o=++m)i=n[o],t.pos=i.offset,d=t.readString(i.length),s=new set(d,i),u[_=i.nameID]==null&&(u[_]=[]),u[i.nameID].push(s);this.strings=u,this.copyright=u[0],this.fontFamily=u[1],this.fontSubfamily=u[2],this.uniqueSubfamily=u[3],this.fontName=u[4],this.version=u[5];try{this.postscriptName=u[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=u[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=u[7],this.manufacturer=u[8],this.designer=u[9],this.description=u[10],this.vendorUrl=u[11],this.designerUrl=u[12],this.license=u[13],this.licenseUrl=u[14],this.preferredFamily=u[15],this.preferredSubfamily=u[17],this.compatibleFull=u[18],this.sampleText=u[19]},e}(),uet=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return em(e,Qf),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),det=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return em(e,Qf),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,n,i,o,s,a,u;for(t.pos=this.offset,this.metrics=[],r=0,a=this.file.hhea.numberOfMetrics;0<=a?r<a:r>a;r=0<=a?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var d,m;for(m=[],r=d=0;0<=i?d<i:d>i;r=0<=i?++d:--d)m.push(t.readInt16());return m}(),this.widths=(function(){var d,m,g,_;for(_=[],d=0,m=(g=this.metrics).length;d<m;d++)o=g[d],_.push(o.advance);return _}).call(this),n=this.widths[this.widths.length-1],u=[],r=s=0;0<=i?s<i:s>i;r=0<=i?++s:--s)u.push(this.widths.push(n));return u},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),whe=[].slice,het=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return em(e,Qf),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,n,i,o,s,a,u,d,m,g;return t in this.cache?this.cache[t]:(o=this.file.loca,r=this.file.contents,n=o.indexOf(t),(i=o.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+n,s=(a=new A_(r.read(i))).readShort(),d=a.readShort(),g=a.readShort(),u=a.readShort(),m=a.readShort(),this.cache[t]=s===-1?new pet(a,d,g,u,m):new fet(a,s,d,g,u,m),this.cache[t]))},e.prototype.encode=function(t,r,n){var i,o,s,a,u;for(s=[],o=[],a=0,u=r.length;a<u;a++)i=t[r[a]],o.push(s.length),i&&(s=s.concat(i.encode(n)));return o.push(s.length),{table:s,offsets:o}},e}(),fet=function(){function e(t,r,n,i,o,s){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=i,this.xMax=o,this.yMax=s,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),pet=function(){function e(t,r,n,i,o){var s,a;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=i,this.yMax=o,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;a=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&a;)s.pos+=1&a?4:2,128&a?s.pos+=8:64&a?s.pos+=4:8&a&&(s.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new A_(whe.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),met=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return em(e,Qf),e.prototype.tag="loca",e.prototype.parse=function(t){var r,n;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var i,o;for(o=[],n=0,i=this.length;n<i;n+=2)o.push(2*t.readUInt16());return o}).call(this):(function(){var i,o;for(o=[],n=0,i=this.length;n<i;n+=4)o.push(t.readUInt32());return o}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var n=new Uint32Array(this.offsets.length),i=0,o=0,s=0;s<n.length;++s)if(n[s]=i,o<r.length&&r[o]==s){++o,n[s]=i;var a=this.offsets[s],u=this.offsets[s+1]-a;u>0&&(i+=u)}for(var d=new Array(4*n.length),m=0;m<n.length;++m)d[4*m+3]=255&n[m],d[4*m+2]=(65280&n[m])>>8,d[4*m+1]=(16711680&n[m])>>16,d[4*m]=(4278190080&n[m])>>24;return d},e}(),get=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,i,o;for(r in i=this.font.cmap.tables[0].codeMap,t={},o=this.subset)n=o[r],t[r]=i[n];return t},e.prototype.glyphsFor=function(t){var r,n,i,o,s,a,u;for(i={},s=0,a=t.length;s<a;s++)i[o=t[s]]=this.font.glyf.glyphFor(o);for(o in r=[],i)(n=i[o])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(o in u=this.glyphsFor(r))n=u[o],i[o]=n;return i},e.prototype.encode=function(t,r){var n,i,o,s,a,u,d,m,g,_,y,M,x,E,T;for(i in n=xhe.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(t),y={0:0},T=n.charMap)y[(u=T[i]).old]=u.new;for(M in _=n.maxGlyphID,s)M in y||(y[M]=_++);return m=function(P){var C,D;for(C in D={},P)D[P[C]]=C;return D}(y),g=Object.keys(m).sort(function(P,C){return P-C}),x=function(){var P,C,D;for(D=[],P=0,C=g.length;P<C;P++)a=g[P],D.push(m[a]);return D}(),o=this.font.glyf.encode(s,x,y),d=this.font.loca.encode(o.offsets,x),E={cmap:this.font.cmap.raw(),glyf:o.table,loca:d,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(E["OS/2"]=this.font.os2.raw()),this.font.directory.encode(E)},e}();ai.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,i,o,s;if(Array.isArray(r))return"["+function(){var a,u,d;for(d=[],a=0,u=r.length;a<u;a++)n=r[a],d.push(t.convert(n));return d}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(i in o=["<<"],r)s=r[i],o.push("/"+i+" "+t.convert(s));return o.push(">>"),o.join(`
`)}return""+r},t}();var Mhe={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(e,t){((r,n)=>{e.exports=n()})(Fv,function r(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},i,o=!n.document&&!!n.postMessage,s=n.IS_PAPA_WORKER||!1,a={},u=0,d={};function m($){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(U){var G=L(U);G.chunkSize=parseInt(G.chunkSize),U.step||U.chunk||(G.chunkSize=null),this._handle=new x(G),(this._handle.streamer=this)._config=G}).call(this,$),this.parseChunk=function(U,G){var H=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<H){let ee=this._config.newline;ee||(X=this._config.quoteChar||'"',ee=this._handle.guessLineEndings(U,X)),U=[...U.split(ee).slice(H)].join(ee)}this.isFirstChunk&&j(this._config.beforeFirstChunk)&&(X=this._config.beforeFirstChunk(U))!==void 0&&(U=X),this.isFirstChunk=!1,this._halted=!1;var H=this._partialLine+U,X=(this._partialLine="",this._handle.parse(H,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(U=X.meta.cursor,H=(this._finished||(this._partialLine=H.substring(U-this._baseIndex),this._baseIndex=U),X&&X.data&&(this._rowCount+=X.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),s)n.postMessage({results:X,workerId:d.WORKER_ID,finished:H});else if(j(this._config.chunk)&&!G){if(this._config.chunk(X,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=X=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(X.data),this._completeResults.errors=this._completeResults.errors.concat(X.errors),this._completeResults.meta=X.meta),this._completed||!H||!j(this._config.complete)||X&&X.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),H||X&&X.meta.paused||this._nextChunk(),X}this._halted=!0},this._sendError=function(U){j(this._config.error)?this._config.error(U):s&&this._config.error&&n.postMessage({workerId:d.WORKER_ID,error:U,finished:!1})}}function g($){var U;($=$||{}).chunkSize||($.chunkSize=d.RemoteChunkSize),m.call(this,$),this._nextChunk=o?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(G){this._input=G,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(U=new XMLHttpRequest,this._config.withCredentials&&(U.withCredentials=this._config.withCredentials),o||(U.onload=N(this._chunkLoaded,this),U.onerror=N(this._chunkError,this)),U.open(this._config.downloadRequestBody?"POST":"GET",this._input,!o),this._config.downloadRequestHeaders){var G,H=this._config.downloadRequestHeaders;for(G in H)U.setRequestHeader(G,H[G])}var X;this._config.chunkSize&&(X=this._start+this._config.chunkSize-1,U.setRequestHeader("Range","bytes="+this._start+"-"+X));try{U.send(this._config.downloadRequestBody)}catch(ee){this._chunkError(ee.message)}o&&U.status===0&&this._chunkError()}},this._chunkLoaded=function(){U.readyState===4&&(U.status<200||400<=U.status?this._chunkError():(this._start+=this._config.chunkSize||U.responseText.length,this._finished=!this._config.chunkSize||this._start>=(G=>(G=G.getResponseHeader("Content-Range"))!==null?parseInt(G.substring(G.lastIndexOf("/")+1)):-1)(U),this.parseChunk(U.responseText)))},this._chunkError=function(G){G=U.statusText||G,this._sendError(new Error(G))}}function _($){($=$||{}).chunkSize||($.chunkSize=d.LocalChunkSize),m.call(this,$);var U,G,H=typeof FileReader<"u";this.stream=function(X){this._input=X,G=X.slice||X.webkitSlice||X.mozSlice,H?((U=new FileReader).onload=N(this._chunkLoaded,this),U.onerror=N(this._chunkError,this)):U=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var X=this._input,ee=(this._config.chunkSize&&(ee=Math.min(this._start+this._config.chunkSize,this._input.size),X=G.call(X,this._start,ee)),U.readAsText(X,this._config.encoding));H||this._chunkLoaded({target:{result:ee}})},this._chunkLoaded=function(X){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(X.target.result)},this._chunkError=function(){this._sendError(U.error)}}function y($){var U;m.call(this,$=$||{}),this.stream=function(G){return U=G,this._nextChunk()},this._nextChunk=function(){var G,H;if(!this._finished)return G=this._config.chunkSize,U=G?(H=U.substring(0,G),U.substring(G)):(H=U,""),this._finished=!U,this.parseChunk(H)}}function M($){m.call(this,$=$||{});var U=[],G=!0,H=!1;this.pause=function(){m.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){m.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(X){this._input=X,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){H&&U.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),U.length?this.parseChunk(U.shift()):G=!0},this._streamData=N(function(X){try{U.push(typeof X=="string"?X:X.toString(this._config.encoding)),G&&(G=!1,this._checkIsFinished(),this.parseChunk(U.shift()))}catch(ee){this._streamError(ee)}},this),this._streamError=N(function(X){this._streamCleanUp(),this._sendError(X)},this),this._streamEnd=N(function(){this._streamCleanUp(),H=!0,this._streamData("")},this),this._streamCleanUp=N(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function x($){var U,G,H,X,ee=Math.pow(2,53),ae=-ee,de=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,ye=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,_e=this,ue=0,fe=0,De=!1,pe=!1,K=[],te={data:[],errors:[],meta:{}};function ve(ot){return $.skipEmptyLines==="greedy"?ot.join("").trim()==="":ot.length===1&&ot[0].length===0}function $e(){if(te&&H&&(Ge("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+d.DefaultDelimiter+"'"),H=!1),$.skipEmptyLines&&(te.data=te.data.filter(function(Te){return!ve(Te)})),Ce()){let Te=function(Le,ke){j($.transformHeader)&&(Le=$.transformHeader(Le,ke)),K.push(Le)};if(te)if(Array.isArray(te.data[0])){for(var ot=0;Ce()&&ot<te.data.length;ot++)te.data[ot].forEach(Te);te.data.splice(0,1)}else te.data.forEach(Te)}function Ye(Te,Le){for(var ke=$.header?{}:[],Xe=0;Xe<Te.length;Xe++){var Ne=Xe,Ot=Te[Xe],Ot=((Lt,kt)=>(mt=>($.dynamicTypingFunction&&$.dynamicTyping[mt]===void 0&&($.dynamicTyping[mt]=$.dynamicTypingFunction(mt)),($.dynamicTyping[mt]||$.dynamicTyping)===!0))(Lt)?kt==="true"||kt==="TRUE"||kt!=="false"&&kt!=="FALSE"&&((mt=>{if(de.test(mt)&&(mt=parseFloat(mt),ae<mt&&mt<ee))return 1})(kt)?parseFloat(kt):ye.test(kt)?new Date(kt):kt===""?null:kt):kt)(Ne=$.header?Xe>=K.length?"__parsed_extra":K[Xe]:Ne,Ot=$.transform?$.transform(Ot,Ne):Ot);Ne==="__parsed_extra"?(ke[Ne]=ke[Ne]||[],ke[Ne].push(Ot)):ke[Ne]=Ot}return $.header&&(Xe>K.length?Ge("FieldMismatch","TooManyFields","Too many fields: expected "+K.length+" fields but parsed "+Xe,fe+Le):Xe<K.length&&Ge("FieldMismatch","TooFewFields","Too few fields: expected "+K.length+" fields but parsed "+Xe,fe+Le)),ke}var et;te&&($.header||$.dynamicTyping||$.transform)&&(et=1,!te.data.length||Array.isArray(te.data[0])?(te.data=te.data.map(Ye),et=te.data.length):te.data=Ye(te.data,0),$.header&&te.meta&&(te.meta.fields=K),fe+=et)}function Ce(){return $.header&&K.length===0}function Ge(ot,Ye,et,Te){ot={type:ot,code:Ye,message:et},Te!==void 0&&(ot.row=Te),te.errors.push(ot)}j($.step)&&(X=$.step,$.step=function(ot){te=ot,Ce()?$e():($e(),te.data.length!==0&&(ue+=ot.data.length,$.preview&&ue>$.preview?G.abort():(te.data=te.data[0],X(te,_e))))}),this.parse=function(ot,Ye,et){var Te=$.quoteChar||'"',Te=($.newline||($.newline=this.guessLineEndings(ot,Te)),H=!1,$.delimiter?j($.delimiter)&&($.delimiter=$.delimiter(ot),te.meta.delimiter=$.delimiter):((Te=((Le,ke,Xe,Ne,Ot)=>{var Lt,kt,mt,Zt;Ot=Ot||[",","	","|",";",d.RECORD_SEP,d.UNIT_SEP];for(var Kt=0;Kt<Ot.length;Kt++){for(var dr,Bt=Ot[Kt],wr=0,mr=0,hr=0,xr=(mt=void 0,new T({comments:Ne,delimiter:Bt,newline:ke,preview:10}).parse(Le)),or=0;or<xr.data.length;or++)Xe&&ve(xr.data[or])?hr++:(dr=xr.data[or].length,mr+=dr,mt===void 0?mt=dr:0<dr&&(wr+=Math.abs(dr-mt),mt=dr));0<xr.data.length&&(mr/=xr.data.length-hr),(kt===void 0||wr<=kt)&&(Zt===void 0||Zt<mr)&&1.99<mr&&(kt=wr,Lt=Bt,Zt=mr)}return{successful:!!($.delimiter=Lt),bestDelimiter:Lt}})(ot,$.newline,$.skipEmptyLines,$.comments,$.delimitersToGuess)).successful?$.delimiter=Te.bestDelimiter:(H=!0,$.delimiter=d.DefaultDelimiter),te.meta.delimiter=$.delimiter),L($));return $.preview&&$.header&&Te.preview++,U=ot,G=new T(Te),te=G.parse(U,Ye,et),$e(),De?{meta:{paused:!0}}:te||{meta:{paused:!1}}},this.paused=function(){return De},this.pause=function(){De=!0,G.abort(),U=j($.chunk)?"":U.substring(G.getCharIndex())},this.resume=function(){_e.streamer._halted?(De=!1,_e.streamer.parseChunk(U,!0)):setTimeout(_e.resume,3)},this.aborted=function(){return pe},this.abort=function(){pe=!0,G.abort(),te.meta.aborted=!0,j($.complete)&&$.complete(te),U=""},this.guessLineEndings=function(Le,Te){Le=Le.substring(0,1048576);var Te=new RegExp(E(Te)+"([^]*?)"+E(Te),"gm"),et=(Le=Le.replace(Te,"")).split("\r"),Te=Le.split(`
`),Le=1<Te.length&&Te[0].length<et[0].length;if(et.length===1||Le)return`
`;for(var ke=0,Xe=0;Xe<et.length;Xe++)et[Xe][0]===`
`&&ke++;return ke>=et.length/2?`\r
`:"\r"}}function E($){return $.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function T($){var U=($=$||{}).delimiter,G=$.newline,H=$.comments,X=$.step,ee=$.preview,ae=$.fastMode,de=null,ye=!1,_e=$.quoteChar==null?'"':$.quoteChar,ue=_e;if($.escapeChar!==void 0&&(ue=$.escapeChar),(typeof U!="string"||-1<d.BAD_DELIMITERS.indexOf(U))&&(U=","),H===U)throw new Error("Comment character same as delimiter");H===!0?H="#":(typeof H!="string"||-1<d.BAD_DELIMITERS.indexOf(H))&&(H=!1),G!==`
`&&G!=="\r"&&G!==`\r
`&&(G=`
`);var fe=0,De=!1;this.parse=function(pe,K,te){if(typeof pe!="string")throw new Error("Input must be a string");var ve=pe.length,$e=U.length,Ce=G.length,Ge=H.length,ot=j(X),Ye=[],et=[],Te=[],Le=fe=0;if(!pe)return wr();if(ae||ae!==!1&&pe.indexOf(_e)===-1){for(var ke=pe.split(G),Xe=0;Xe<ke.length;Xe++){if(Te=ke[Xe],fe+=Te.length,Xe!==ke.length-1)fe+=G.length;else if(te)return wr();if(!H||Te.substring(0,Ge)!==H){if(ot){if(Ye=[],Zt(Te.split(U)),mr(),De)return wr()}else Zt(Te.split(U));if(ee&&ee<=Xe)return Ye=Ye.slice(0,ee),wr(!0)}}return wr()}for(var Ne=pe.indexOf(U,fe),Ot=pe.indexOf(G,fe),Lt=new RegExp(E(ue)+E(_e),"g"),kt=pe.indexOf(_e,fe);;)if(pe[fe]===_e)for(kt=fe,fe++;;){if((kt=pe.indexOf(_e,kt+1))===-1)return te||et.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:Ye.length,index:fe}),dr();if(kt===ve-1)return dr(pe.substring(fe,kt).replace(Lt,_e));if(_e===ue&&pe[kt+1]===ue)kt++;else if(_e===ue||kt===0||pe[kt-1]!==ue){Ne!==-1&&Ne<kt+1&&(Ne=pe.indexOf(U,kt+1));var mt=Kt((Ot=Ot!==-1&&Ot<kt+1?pe.indexOf(G,kt+1):Ot)===-1?Ne:Math.min(Ne,Ot));if(pe.substr(kt+1+mt,$e)===U){Te.push(pe.substring(fe,kt).replace(Lt,_e)),pe[fe=kt+1+mt+$e]!==_e&&(kt=pe.indexOf(_e,fe)),Ne=pe.indexOf(U,fe),Ot=pe.indexOf(G,fe);break}if(mt=Kt(Ot),pe.substring(kt+1+mt,kt+1+mt+Ce)===G){if(Te.push(pe.substring(fe,kt).replace(Lt,_e)),Bt(kt+1+mt+Ce),Ne=pe.indexOf(U,fe),kt=pe.indexOf(_e,fe),ot&&(mr(),De))return wr();if(ee&&Ye.length>=ee)return wr(!0);break}et.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:Ye.length,index:fe}),kt++}}else if(H&&Te.length===0&&pe.substring(fe,fe+Ge)===H){if(Ot===-1)return wr();fe=Ot+Ce,Ot=pe.indexOf(G,fe),Ne=pe.indexOf(U,fe)}else if(Ne!==-1&&(Ne<Ot||Ot===-1))Te.push(pe.substring(fe,Ne)),fe=Ne+$e,Ne=pe.indexOf(U,fe);else{if(Ot===-1)break;if(Te.push(pe.substring(fe,Ot)),Bt(Ot+Ce),ot&&(mr(),De))return wr();if(ee&&Ye.length>=ee)return wr(!0)}return dr();function Zt(hr){Ye.push(hr),Le=fe}function Kt(hr){var xr=0;return xr=hr!==-1&&(hr=pe.substring(kt+1,hr))&&hr.trim()===""?hr.length:xr}function dr(hr){return te||(hr===void 0&&(hr=pe.substring(fe)),Te.push(hr),fe=ve,Zt(Te),ot&&mr()),wr()}function Bt(hr){fe=hr,Zt(Te),Te=[],Ot=pe.indexOf(G,fe)}function wr(hr){if($.header&&!K&&Ye.length&&!ye){var xr=Ye[0],or=Object.create(null),tt=new Set(xr);let Se=!1;for(let Pe=0;Pe<xr.length;Pe++){let Ve=xr[Pe];if(or[Ve=j($.transformHeader)?$.transformHeader(Ve,Pe):Ve]){let Qe,dt=or[Ve];for(;Qe=Ve+"_"+dt,dt++,tt.has(Qe););tt.add(Qe),xr[Pe]=Qe,or[Ve]++,Se=!0,(de=de===null?{}:de)[Qe]=Ve}else or[Ve]=1,xr[Pe]=Ve;tt.add(Ve)}Se&&console.warn("Duplicate headers found and renamed."),ye=!0}return{data:Ye,errors:et,meta:{delimiter:U,linebreak:G,aborted:De,truncated:!!hr,cursor:Le+(K||0),renamedHeaders:de}}}function mr(){X(wr()),Ye=[],et=[]}},this.abort=function(){De=!0},this.getCharIndex=function(){return fe}}function P($){var U=$.data,G=a[U.workerId],H=!1;if(U.error)G.userError(U.error,U.file);else if(U.results&&U.results.data){var X={abort:function(){H=!0,C(U.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:D,resume:D};if(j(G.userStep)){for(var ee=0;ee<U.results.data.length&&(G.userStep({data:U.results.data[ee],errors:U.results.errors,meta:U.results.meta},X),!H);ee++);delete U.results}else j(G.userChunk)&&(G.userChunk(U.results,X,U.file),delete U.results)}U.finished&&!H&&C(U.workerId,U.results)}function C($,U){var G=a[$];j(G.userComplete)&&G.userComplete(U),G.terminate(),delete a[$]}function D(){throw new Error("Not implemented.")}function L($){if(typeof $!="object"||$===null)return $;var U,G=Array.isArray($)?[]:{};for(U in $)G[U]=L($[U]);return G}function N($,U){return function(){$.apply(U,arguments)}}function j($){return typeof $=="function"}return d.parse=function($,U){var G=(U=U||{}).dynamicTyping||!1;if(j(G)&&(U.dynamicTypingFunction=G,G={}),U.dynamicTyping=G,U.transform=!!j(U.transform)&&U.transform,!U.worker||!d.WORKERS_SUPPORTED)return G=null,d.NODE_STREAM_INPUT,typeof $=="string"?($=(H=>H.charCodeAt(0)!==65279?H:H.slice(1))($),G=new(U.download?g:y)(U)):$.readable===!0&&j($.read)&&j($.on)?G=new M(U):(n.File&&$ instanceof File||$ instanceof Object)&&(G=new _(U)),G.stream($);(G=(()=>{var H;return!!d.WORKERS_SUPPORTED&&(H=(()=>{var X=n.URL||n.webkitURL||null,ee=r.toString();return d.BLOB_URL||(d.BLOB_URL=X.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",ee,")();"],{type:"text/javascript"})))})(),(H=new n.Worker(H)).onmessage=P,H.id=u++,a[H.id]=H)})()).userStep=U.step,G.userChunk=U.chunk,G.userComplete=U.complete,G.userError=U.error,U.step=j(U.step),U.chunk=j(U.chunk),U.complete=j(U.complete),U.error=j(U.error),delete U.worker,G.postMessage({input:$,config:U,workerId:G.id})},d.unparse=function($,U){var G=!1,H=!0,X=",",ee=`\r
`,ae='"',de=ae+ae,ye=!1,_e=null,ue=!1,fe=((()=>{if(typeof U=="object"){if(typeof U.delimiter!="string"||d.BAD_DELIMITERS.filter(function(K){return U.delimiter.indexOf(K)!==-1}).length||(X=U.delimiter),typeof U.quotes!="boolean"&&typeof U.quotes!="function"&&!Array.isArray(U.quotes)||(G=U.quotes),typeof U.skipEmptyLines!="boolean"&&typeof U.skipEmptyLines!="string"||(ye=U.skipEmptyLines),typeof U.newline=="string"&&(ee=U.newline),typeof U.quoteChar=="string"&&(ae=U.quoteChar),typeof U.header=="boolean"&&(H=U.header),Array.isArray(U.columns)){if(U.columns.length===0)throw new Error("Option columns is empty");_e=U.columns}U.escapeChar!==void 0&&(de=U.escapeChar+ae),U.escapeFormulae instanceof RegExp?ue=U.escapeFormulae:typeof U.escapeFormulae=="boolean"&&U.escapeFormulae&&(ue=/^[=+\-@\t\r].*$/)}})(),new RegExp(E(ae),"g"));if(typeof $=="string"&&($=JSON.parse($)),Array.isArray($)){if(!$.length||Array.isArray($[0]))return De(null,$,ye);if(typeof $[0]=="object")return De(_e||Object.keys($[0]),$,ye)}else if(typeof $=="object")return typeof $.data=="string"&&($.data=JSON.parse($.data)),Array.isArray($.data)&&($.fields||($.fields=$.meta&&$.meta.fields||_e),$.fields||($.fields=Array.isArray($.data[0])?$.fields:typeof $.data[0]=="object"?Object.keys($.data[0]):[]),Array.isArray($.data[0])||typeof $.data[0]=="object"||($.data=[$.data])),De($.fields||[],$.data||[],ye);throw new Error("Unable to serialize unrecognized input");function De(K,te,ve){var $e="",Ce=(typeof K=="string"&&(K=JSON.parse(K)),typeof te=="string"&&(te=JSON.parse(te)),Array.isArray(K)&&0<K.length),Ge=!Array.isArray(te[0]);if(Ce&&H){for(var ot=0;ot<K.length;ot++)0<ot&&($e+=X),$e+=pe(K[ot],ot);0<te.length&&($e+=ee)}for(var Ye=0;Ye<te.length;Ye++){var et=(Ce?K:te[Ye]).length,Te=!1,Le=Ce?Object.keys(te[Ye]).length===0:te[Ye].length===0;if(ve&&!Ce&&(Te=ve==="greedy"?te[Ye].join("").trim()==="":te[Ye].length===1&&te[Ye][0].length===0),ve==="greedy"&&Ce){for(var ke=[],Xe=0;Xe<et;Xe++){var Ne=Ge?K[Xe]:Xe;ke.push(te[Ye][Ne])}Te=ke.join("").trim()===""}if(!Te){for(var Ot=0;Ot<et;Ot++){0<Ot&&!Le&&($e+=X);var Lt=Ce&&Ge?K[Ot]:Ot;$e+=pe(te[Ye][Lt],Ot)}Ye<te.length-1&&(!ve||0<et&&!Le)&&($e+=ee)}}return $e}function pe(K,te){var ve,$e;return K==null?"":K.constructor===Date?JSON.stringify(K).slice(1,25):($e=!1,ue&&typeof K=="string"&&ue.test(K)&&(K="'"+K,$e=!0),ve=K.toString().replace(fe,de),($e=$e||G===!0||typeof G=="function"&&G(K,te)||Array.isArray(G)&&G[te]||((Ce,Ge)=>{for(var ot=0;ot<Ge.length;ot++)if(-1<Ce.indexOf(Ge[ot]))return!0;return!1})(ve,d.BAD_DELIMITERS)||-1<ve.indexOf(X)||ve.charAt(0)===" "||ve.charAt(ve.length-1)===" ")?ae+ve+ae:ve)}},d.RECORD_SEP="",d.UNIT_SEP="",d.BYTE_ORDER_MARK="\uFEFF",d.BAD_DELIMITERS=["\r",`
`,'"',d.BYTE_ORDER_MARK],d.WORKERS_SUPPORTED=!o&&!!n.Worker,d.NODE_STREAM_INPUT=1,d.LocalChunkSize=10485760,d.RemoteChunkSize=5242880,d.DefaultDelimiter=",",d.Parser=T,d.ParserHandle=x,d.NetworkStreamer=g,d.FileStreamer=_,d.StringStreamer=y,d.ReadableStreamStreamer=M,n.jQuery&&((i=n.jQuery).fn.parse=function($){var U=$.config||{},G=[];return this.each(function(ee){if(!(i(this).prop("tagName").toUpperCase()==="INPUT"&&i(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var ae=0;ae<this.files.length;ae++)G.push({file:this.files[ae],inputElem:this,instanceConfig:i.extend({},U)})}),H(),this;function H(){if(G.length===0)j($.complete)&&$.complete();else{var ee,ae,de,ye,_e=G[0];if(j($.before)){var ue=$.before(_e.file,_e.inputElem);if(typeof ue=="object"){if(ue.action==="abort")return ee="AbortError",ae=_e.file,de=_e.inputElem,ye=ue.reason,void(j($.error)&&$.error({name:ee},ae,de,ye));if(ue.action==="skip")return void X();typeof ue.config=="object"&&(_e.instanceConfig=i.extend(_e.instanceConfig,ue.config))}else if(ue==="skip")return void X()}var fe=_e.instanceConfig.complete;_e.instanceConfig.complete=function(De){j(fe)&&fe(De,_e.file,_e.inputElem),X()},d.parse(_e.file,_e.instanceConfig)}}function X(){G.splice(0,1),H()}}),s&&(n.onmessage=function($){$=$.data,d.WORKER_ID===void 0&&$&&(d.WORKER_ID=$.workerId),typeof $.input=="string"?n.postMessage({workerId:d.WORKER_ID,results:d.parse($.input,$.config),finished:!0}):(n.File&&$.input instanceof File||$.input instanceof Object)&&($=d.parse($.input,$.config))&&n.postMessage({workerId:d.WORKER_ID,results:$,finished:!0})}),(g.prototype=Object.create(m.prototype)).constructor=g,(_.prototype=Object.create(m.prototype)).constructor=_,(y.prototype=Object.create(y.prototype)).constructor=y,(M.prototype=Object.create(m.prototype)).constructor=M,d})})(Mhe);var _et=Mhe.exports;const yet=sa(_et),vet=()=>{var N,j;const{user:e}=Xp(),{toast:t}=cS(),[r,n]=oe.useState("pdf"),[i,o]=oe.useState("claims"),[s,a]=oe.useState("2024"),[u,d]=oe.useState(!1),[m,g]=oe.useState(!0),[_,y]=oe.useState(!0),M=[{claimId:"FRA/CGH/BST/2024/001",beneficiary:"Ramesh Kumar",village:"Kondagaon",district:"Bastar",landArea:2.5,status:"Approved",submittedDate:"2024-01-15",approvedDate:"2024-02-20"},{claimId:"FRA/CGH/BST/2024/002",beneficiary:"Sunita Devi",village:"Tokapal",district:"Bastar",landArea:1.8,status:"Pending",submittedDate:"2024-02-10",approvedDate:""},{claimId:"FRA/CGH/BST/2024/003",beneficiary:"Mohan Lal",village:"Bhanupratappur",district:"Kanker",landArea:3.2,status:"Approved",submittedDate:"2024-01-25",approvedDate:"2024-03-05"}],x=[{metric:"Total Claims",value:156,change:"+12%"},{metric:"Approved Claims",value:89,change:"+8%"},{metric:"Pending Claims",value:42,change:"+15%"},{metric:"Rejected Claims",value:25,change:"-5%"},{metric:"Land Approved (acres)",value:245.8,change:"+18%"}],E=[{id:"claims",name:"FRA Claims Data",description:"Complete claims database with status and beneficiary details",icon:w_,records:M.length,access:["user","officer","admin"]},{id:"analytics",name:"Analytics Report",description:"Statistical analysis and performance metrics",icon:dge,records:x.length,access:["officer","admin"]},{id:"beneficiaries",name:"Beneficiary List",description:"Approved beneficiaries with land allocation details",icon:l0,records:89,access:["officer","admin"]},{id:"geographic",name:"Geographic Data",description:"Village-wise and district-wise distribution",icon:O_,records:28,access:["admin"]}],T=()=>E.filter($=>$.access.includes((e==null?void 0:e.role)||"user")),P=()=>{var X;const $=new ai,U=$.internal.pageSize.getWidth();$.setFontSize(20),$.text("FRA Atlas Portal - Export Report",U/2,20,{align:"center"}),$.setFontSize(12),$.text(`Generated by: ${e==null?void 0:e.name} (${(X=e==null?void 0:e.role)==null?void 0:X.toUpperCase()})`,20,35),$.text(`Date: ${new Date().toLocaleDateString()}`,20,45),$.text(`Report Type: ${i.toUpperCase()}`,20,55);let G=75;i==="claims"&&($.setFontSize(16),$.text("FRA Claims Summary",20,G),G+=15,$.setFontSize(10),$.text("Claim ID",20,G),$.text("Beneficiary",60,G),$.text("Village",100,G),$.text("Area",130,G),$.text("Status",155,G),G+=10,M.forEach(ee=>{G>270&&($.addPage(),G=20),$.text(ee.claimId,20,G),$.text(ee.beneficiary,60,G),$.text(ee.village,100,G),$.text(`${ee.landArea}`,130,G),$.text(ee.status,155,G),G+=8})),i==="analytics"&&_&&($.addPage(),$.setFontSize(16),$.text("Analytics Summary",20,30),G=50,x.forEach(ee=>{$.setFontSize(12),$.text(`${ee.metric}: ${ee.value} (${ee.change})`,20,G),G+=15}));const H=$.internal.getNumberOfPages();for(let ee=1;ee<=H;ee++)$.setPage(ee),$.setFontSize(8),$.text(`Page ${ee} of ${H}`,U-30,290),$.text("© FRA Atlas Portal - Government of India",20,290);return $},C=()=>{let $=[];return i==="claims"?$=M:i==="analytics"&&($=x),yet.unparse($)},D=async()=>{d(!0);try{if(await new Promise($=>setTimeout($,2e3)),r==="pdf")P().save(`FRA-${i}-${s}.pdf`);else if(r==="csv"){const $=C(),U=new Blob([$],{type:"text/csv;charset=utf-8;"}),G=document.createElement("a"),H=URL.createObjectURL(U);G.setAttribute("href",H),G.setAttribute("download",`FRA-${i}-${s}.csv`),G.style.visibility="hidden",document.body.appendChild(G),G.click(),document.body.removeChild(G)}t({title:"Export Successful",description:`${i.toUpperCase()} data exported as ${r.toUpperCase()}`})}catch{t({title:"Export Failed",description:"There was an error exporting the data. Please try again.",variant:"destructive"})}finally{d(!1)}},L=T();return F.jsx(jf.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"container mx-auto px-4 py-8",children:F.jsxs("div",{className:"space-y-6",children:[F.jsxs("div",{className:"bg-gradient-card rounded-lg p-6 border border-border",children:[F.jsxs("h1",{className:"text-3xl font-bold gov-heading flex items-center space-x-3 mb-2",children:[F.jsx(G2,{className:"w-8 h-8 text-primary"}),F.jsx("span",{children:"Data Export Center"})]}),F.jsx("p",{className:"text-muted-foreground",children:"Export FRA data and reports in PDF or CSV format"}),F.jsxs("div",{className:"flex items-center space-x-2 mt-3",children:[F.jsxs(Hd,{className:"bg-primary text-primary-foreground",children:[(N=e==null?void 0:e.role)==null?void 0:N.toUpperCase()," ACCESS"]}),F.jsx("span",{className:"text-sm text-muted-foreground",children:(e==null?void 0:e.role)==="user"?"Personal data only":(e==null?void 0:e.role)==="officer"?"District-level data":"State-level data"})]})]}),F.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[F.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[F.jsxs(ci,{children:[F.jsxs(oo,{children:[F.jsxs(ao,{className:"flex items-center space-x-2",children:[F.jsx(XY,{className:"w-5 h-5"}),F.jsx("span",{children:"Select Data to Export"})]}),F.jsx(Fc,{children:"Choose the type of data you want to export"})]}),F.jsx(ui,{className:"space-y-4",children:L.map($=>{const U=$.icon;return F.jsx("div",{className:`p-4 border rounded-lg cursor-pointer transition-all ${i===$.id?"border-primary bg-primary/5":"border-border hover:border-primary/50"}`,onClick:()=>o($.id),children:F.jsxs("div",{className:"flex items-start space-x-3",children:[F.jsx(U,{className:"w-6 h-6 text-primary mt-1"}),F.jsxs("div",{className:"flex-1",children:[F.jsxs("div",{className:"flex items-center justify-between",children:[F.jsx("h3",{className:"font-semibold",children:$.name}),F.jsxs(Hd,{variant:"secondary",children:[$.records," records"]})]}),F.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:$.description})]})]})},$.id)})})]}),F.jsxs(ci,{children:[F.jsxs(oo,{children:[F.jsx(ao,{children:"Export Format & Options"}),F.jsx(Fc,{children:"Configure your export settings"})]}),F.jsxs(ui,{className:"space-y-6",children:[F.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[F.jsxs("div",{className:"space-y-3",children:[F.jsx("label",{className:"text-sm font-medium",children:"Export Format"}),F.jsxs(VC,{value:r,onValueChange:n,children:[F.jsx(qM,{children:F.jsx(WC,{})}),F.jsxs(HM,{children:[F.jsx(ad,{value:"pdf",children:F.jsxs("div",{className:"flex items-center space-x-2",children:[F.jsx(w_,{className:"w-4 h-4"}),F.jsx("span",{children:"PDF Report"})]})}),F.jsx(ad,{value:"csv",children:F.jsxs("div",{className:"flex items-center space-x-2",children:[F.jsx(yge,{className:"w-4 h-4"}),F.jsx("span",{children:"CSV Data"})]})})]})]})]}),F.jsxs("div",{className:"space-y-3",children:[F.jsx("label",{className:"text-sm font-medium",children:"Date Range"}),F.jsxs(VC,{value:s,onValueChange:a,children:[F.jsx(qM,{children:F.jsx(WC,{})}),F.jsxs(HM,{children:[F.jsx(ad,{value:"2024",children:"Year 2024"}),F.jsx(ad,{value:"2023",children:"Year 2023"}),F.jsx(ad,{value:"all",children:"All Years"}),F.jsx(ad,{value:"custom",children:"Custom Range"})]})]})]})]}),r==="pdf"&&F.jsxs("div",{className:"space-y-4",children:[F.jsx("h4",{className:"font-medium",children:"PDF Options"}),F.jsxs("div",{className:"space-y-3",children:[F.jsxs("div",{className:"flex items-center space-x-2",children:[F.jsx(NN,{id:"charts",checked:m,onCheckedChange:$=>g($===!0)}),F.jsx("label",{htmlFor:"charts",className:"text-sm",children:"Include charts and graphs"})]}),F.jsxs("div",{className:"flex items-center space-x-2",children:[F.jsx(NN,{id:"stats",checked:_,onCheckedChange:$=>y($===!0)}),F.jsx("label",{htmlFor:"stats",className:"text-sm",children:"Include statistical summary"})]})]})]})]})]})]}),F.jsxs("div",{className:"space-y-6",children:[F.jsxs(ci,{children:[F.jsxs(oo,{children:[F.jsx(ao,{children:"Export Preview"}),F.jsx(Fc,{children:"Review your export configuration"})]}),F.jsxs(ui,{className:"space-y-4",children:[F.jsxs("div",{className:"space-y-3",children:[F.jsxs("div",{className:"flex justify-between",children:[F.jsx("span",{className:"text-sm text-muted-foreground",children:"Data Type:"}),F.jsx("span",{className:"text-sm font-medium",children:i.toUpperCase()})]}),F.jsxs("div",{className:"flex justify-between",children:[F.jsx("span",{className:"text-sm text-muted-foreground",children:"Format:"}),F.jsx("span",{className:"text-sm font-medium",children:r.toUpperCase()})]}),F.jsxs("div",{className:"flex justify-between",children:[F.jsx("span",{className:"text-sm text-muted-foreground",children:"Date Range:"}),F.jsx("span",{className:"text-sm font-medium",children:s})]}),F.jsxs("div",{className:"flex justify-between",children:[F.jsx("span",{className:"text-sm text-muted-foreground",children:"Records:"}),F.jsx("span",{className:"text-sm font-medium",children:((j=L.find($=>$.id===i))==null?void 0:j.records)||0})]})]}),F.jsx("div",{className:"pt-4 border-t",children:F.jsx(iu,{onClick:D,disabled:u,className:"w-full",children:u?F.jsx(F.Fragment,{children:"Processing..."}):F.jsxs(F.Fragment,{children:[F.jsx(G2,{className:"w-4 h-4 mr-2"}),"Export ",r.toUpperCase()]})})})]})]}),F.jsxs(ci,{children:[F.jsxs(oo,{children:[F.jsx(ao,{children:"Recent Exports"}),F.jsx(Fc,{children:"Your recent export history"})]}),F.jsx(ui,{className:"space-y-3",children:[{file:"FRA-claims-2024.pdf",date:"2024-03-15",status:"success"},{file:"FRA-analytics-2024.csv",date:"2024-03-10",status:"success"},{file:"FRA-beneficiaries-2024.pdf",date:"2024-03-05",status:"success"}].map(($,U)=>F.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[F.jsxs("div",{children:[F.jsx("p",{className:"text-sm font-medium",children:$.file}),F.jsx("p",{className:"text-xs text-muted-foreground",children:$.date})]}),F.jsx(Yd,{className:"w-4 h-4 text-success"})]},U))})]})]})]})]})})},bet=()=>{const e=k0();return oe.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname)},[e.pathname]),F.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:F.jsxs("div",{className:"text-center",children:[F.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),F.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),F.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})},xet=new X0e,zw=({children:e})=>{const{isAuthenticated:t}=Xp();return t?F.jsx(mTe,{children:e}):F.jsx(oJ,{to:"/login"})},wet=()=>F.jsx(Q0e,{client:xet,children:F.jsxs(P0e,{children:[F.jsx(u_e,{}),F.jsx(U_e,{}),F.jsx(Qve,{children:F.jsx(Kve,{children:F.jsxs(Bve,{children:[F.jsx(Dg,{path:"/login",element:F.jsx(bTe,{})}),F.jsx(Dg,{path:"/",element:F.jsx(zw,{children:F.jsx(AZe,{})})}),F.jsx(Dg,{path:"/atlas",element:F.jsx(zw,{children:F.jsx(aXe,{})})}),F.jsx(Dg,{path:"/ai-insights",element:F.jsx(zw,{children:F.jsx(sXe,{})})}),F.jsx(Dg,{path:"/dss",element:F.jsx(zw,{children:F.jsx(lXe,{})})}),F.jsx(Dg,{path:"/export",element:F.jsx(zw,{children:F.jsx(vet,{})})}),F.jsx(Dg,{path:"*",element:F.jsx(bet,{})})]})})})]})});xY(document.getElementById("root")).render(F.jsx(wet,{}));export{Ma as _,Fv as c,sa as g};
